<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.3" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.3">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.3" color="#222">





  <meta name="keywords" content="基础统计,基础知识," />










<meta name="description" content="简介两个样本率的比较通常是使用$\chi^2$检验（Chi-square test）。$\chi^2$检验是以$\chi^2$分布为理论依据，用途广泛的假设检验方法，卡方分析用于比较不同组之间的构成比，它的零假设是假定各组之间的构成是相同的，计算出理论每组的理论构成比，再计算理论值与实际值的差别，如果差别大的话，就拒绝零假设。它用于推断两个总体率或构成比之间有无差别、多个总体率或构成比之间有无差别">
<meta name="keywords" content="基础统计,基础知识">
<meta property="og:type" content="article">
<meta property="og:title" content="卡方检验">
<meta property="og:url" content="http://rvdsd.top/2017/08/18/医学统计学-第07章卡方分析/index.html">
<meta property="og:site_name" content="RVDSD的个人笔记本">
<meta property="og:description" content="简介两个样本率的比较通常是使用$\chi^2$检验（Chi-square test）。$\chi^2$检验是以$\chi^2$分布为理论依据，用途广泛的假设检验方法，卡方分析用于比较不同组之间的构成比，它的零假设是假定各组之间的构成是相同的，计算出理论每组的理论构成比，再计算理论值与实际值的差别，如果差别大的话，就拒绝零假设。它用于推断两个总体率或构成比之间有无差别、多个总体率或构成比之间有无差别">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="http://ortxpw68f.bkt.clouddn.com/chi01.png">
<meta property="og:image" content="http://ortxpw68f.bkt.clouddn.com/chi02.png">
<meta property="og:image" content="http://ortxpw68f.bkt.clouddn.com/chi03.png">
<meta property="og:image" content="http://ortxpw68f.bkt.clouddn.com/chi04.png">
<meta property="og:image" content="http://ortxpw68f.bkt.clouddn.com/chi05.png">
<meta property="og:image" content="http://ortxpw68f.bkt.clouddn.com/chi06.png">
<meta property="og:image" content="http://ortxpw68f.bkt.clouddn.com/chi07.png">
<meta property="og:image" content="http://ortxpw68f.bkt.clouddn.com/chi08.png">
<meta property="og:image" content="http://ortxpw68f.bkt.clouddn.com/chi09.png">
<meta property="og:image" content="http://ortxpw68f.bkt.clouddn.com/chi10.png">
<meta property="og:image" content="http://ortxpw68f.bkt.clouddn.com/chi11.png">
<meta property="og:image" content="http://ortxpw68f.bkt.clouddn.com/chi12.png">
<meta property="og:image" content="http://ortxpw68f.bkt.clouddn.com/chi13.png">
<meta property="og:image" content="http://ortxpw68f.bkt.clouddn.com/chi14.png">
<meta property="og:image" content="http://ortxpw68f.bkt.clouddn.com/chi15.png">
<meta property="og:image" content="http://ortxpw68f.bkt.clouddn.com/chi16.png">
<meta property="og:image" content="http://ortxpw68f.bkt.clouddn.com/chi17.png">
<meta property="og:image" content="http://ortxpw68f.bkt.clouddn.com/chi18.png">
<meta property="og:image" content="http://ortxpw68f.bkt.clouddn.com/chi19.png">
<meta property="og:image" content="http://ortxpw68f.bkt.clouddn.com/chi20.png">
<meta property="og:image" content="http://ortxpw68f.bkt.clouddn.com/chi21.png">
<meta property="og:image" content="http://ortxpw68f.bkt.clouddn.com/chi22.png">
<meta property="og:image" content="http://ortxpw68f.bkt.clouddn.com/chi23.png">
<meta property="og:image" content="http://ortxpw68f.bkt.clouddn.com/chi24.png">
<meta property="og:image" content="http://ortxpw68f.bkt.clouddn.com/chi25.png">
<meta property="og:image" content="http://ortxpw68f.bkt.clouddn.com/chi26.png">
<meta property="og:image" content="http://ortxpw68f.bkt.clouddn.com/chi27.png">
<meta property="og:image" content="http://ortxpw68f.bkt.clouddn.com/chi28.png">
<meta property="og:image" content="http://ortxpw68f.bkt.clouddn.com/chi29.png">
<meta property="og:image" content="http://ortxpw68f.bkt.clouddn.com/chi30.png">
<meta property="og:image" content="http://ortxpw68f.bkt.clouddn.com/chi31.png">
<meta property="og:image" content="http://ortxpw68f.bkt.clouddn.com/chi32.png">
<meta property="og:image" content="http://ortxpw68f.bkt.clouddn.com/chi33.png">
<meta property="og:image" content="http://ortxpw68f.bkt.clouddn.com/chi34.png">
<meta property="og:image" content="http://ortxpw68f.bkt.clouddn.com/chi35.png">
<meta property="og:image" content="http://ortxpw68f.bkt.clouddn.com/chi36.png">
<meta property="og:updated_time" content="2017-09-29T05:22:32.011Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="卡方检验">
<meta name="twitter:description" content="简介两个样本率的比较通常是使用$\chi^2$检验（Chi-square test）。$\chi^2$检验是以$\chi^2$分布为理论依据，用途广泛的假设检验方法，卡方分析用于比较不同组之间的构成比，它的零假设是假定各组之间的构成是相同的，计算出理论每组的理论构成比，再计算理论值与实际值的差别，如果差别大的话，就拒绝零假设。它用于推断两个总体率或构成比之间有无差别、多个总体率或构成比之间有无差别">
<meta name="twitter:image" content="http://ortxpw68f.bkt.clouddn.com/chi01.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.3',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://rvdsd.top/2017/08/18/医学统计学-第07章卡方分析/"/>





  <title>卡方检验 | RVDSD的个人笔记本</title><!-- hexo-inject:begin --><!-- hexo-inject:end -->
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">RVDSD的个人笔记本</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">学习过程中的输出</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2017/08/18/医学统计学-第07章卡方分析/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">卡方检验</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-08-18T12:02:00+08:00">
                2017-08-18
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/医学统计学/" itemprop="url" rel="index">
                    <span itemprop="name">医学统计学</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  6,347
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  25
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>两个样本率的比较通常是使用$\chi^2$检验（Chi-square test）。$\chi^2$检验是以$\chi^2$分布为理论依据，用途广泛的假设检验方法，卡方分析用于比较不同组之间的构成比，它的零假设是假定各组之间的构成是相同的，计算出理论每组的理论构成比，再计算理论值与实际值的差别，如果差别大的话，就拒绝零假设。它用于推断两个总体率或构成比之间有无差别、多个总体率或构成比之间有无差别、多个样品率间的多重比较、两个分类变量之间有无关联性、多维列联表的分析和频数分页拟合优度的$\chi^2$检验，它的扩展分析方法有Fisher精确分析，Ridit分析，CMH分析。</p>
<h3 id="卡方检验的基本思路"><a href="#卡方检验的基本思路" class="headerlink" title="卡方检验的基本思路"></a>卡方检验的基本思路</h3><p>（一）卡方分布（Chi-square distribution）是一种连续型分布，$\chi^2$分布只有一个参数，即自由度$\nu$。按$\chi^2$分布的密度函数$f(\chi^2)$可以给出自由度$\nu=1,2,3,\dots$的一簇$\chi^2$分布曲线，由$\chi^2$分布曲线可见，$\chi^2$分布的形状依赖于自由度$\nu$的大小：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">x &lt;- c(seq(0,15,length = 1000)) </div><div class="line">#生成从0到10之间的1000个数字</div><div class="line"></div><div class="line">y1 &lt;- dchisq(x,1) </div><div class="line"># 生成对x的卡方密度值，自由度为1</div><div class="line"></div><div class="line">y6 &lt;- dchisq(x,6) </div><div class="line"># 生成对x的卡方密度值，自由度为6</div><div class="line"></div><div class="line">y10 &lt;- dchisq(x,10) </div><div class="line"># 生成对x的卡方密度值，自由度为10</div><div class="line"></div><div class="line">plot(x,y1,type = &quot;l&quot;, ylim = c(0,0.5),xlim=c(0,15),xlab=&quot;&quot;, ylab=&quot;&quot;, lty = 1, main = expression(paste(chi^2,&quot;Distribution&quot;)))</div><div class="line"># type =&quot;l&quot;表示绘制线，如果是n则不绘线；lty=1表示绘制实线</div><div class="line"></div><div class="line">lines(x,y6, type = &quot;l&quot;, xlab = &quot;&quot;, ylab = &quot;&quot;, lty =2) </div><div class="line"># lty=2表示绘制虚线lines(x,y10, type = &quot;l&quot;, xlab = &quot;&quot;, ylab = &quot;&quot;, lty= 3) # lty=3表示绘制点线</div><div class="line"></div><div class="line">lines(x,y10, type = &quot;l&quot;, xlab = &quot;&quot;, ylab = &quot;&quot;, lty= 3) # lty=3表示绘制点线</div><div class="line"></div><div class="line">text(1,0.3, c(expression(chi^2*(1))))</div><div class="line">text(4,0.18, c(expression(chi^2*(6))))</div><div class="line">text(10,0.13, c(expression(chi^2*(10))))</div></pre></td></tr></table></figure>
<p>图片如下所示：<img src="http://ortxpw68f.bkt.clouddn.com/chi01.png" alt=""></p>
<ol>
<li>当自由度$\nu \leq 2$时，曲线呈L形；</li>
<li>随着$\nu$的增加，曲线逐渐趋于对称；</li>
<li>当自由度$\nu \rightarrow \infty$时，$\chi^2$分布趋于正态分布。</li>
</ol>
<p>（二）卡方分布的一个基本性质是它的可加性；如果两个独立的随机变量$X_{1}$和$X_{2}$分别服从自由度$\nu_{1}$和$\nu_{2}$的$\chi^2$分布，则它们的和$X_{1}+X_{2}$服从自由度$\nu_{1}$和$nu_{2}$的$\chi^2$分布，即$X_{1}+X_{2}~\chi^2_{\nu1+\nu2}$.</p>
<p>（三）$\chi^2$分布的界值：当自由度$\nu$确定后，$\chi^2$分布曲线下右侧尾部的面积为$\alpha$时，横轴上相应的$\chi^2$值记为$\chi^2_{\alpha,\nu}$，即$\chi^2$分布的界值。$\chi^2$值越大，p值越小，反之，$\chi^2$值越小，界值越大。</p>
<h2 id="四格表资料的-chi-2-检验"><a href="#四格表资料的-chi-2-检验" class="headerlink" title="四格表资料的$\chi^2$检验"></a>四格表资料的$\chi^2$检验</h2><h3 id="案例1"><a href="#案例1" class="headerlink" title="案例1"></a>案例1</h3><p>某医院欲比较异梨醇口服液（试验组）和氢氯噻嗪+地塞米松（对照组）降低颅内压的疗效。将200例颅内压增高症患者随机分为两组，结果见表7-1。问两组降低颅内压的总体有效率有无差别？（《医学统计学》第四版，孙振球，第七章 卡方检验 例7-1，P96）</p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/chi02.png" alt=""><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">data71&lt;-matrix(c(99,75,5,21),nr = 2,dimnames = list(c(&quot;试验组&quot;, &quot;对照组&quot;),c(&quot;有效&quot;, &quot;无效&quot;)))</div><div class="line">data71</div></pre></td></tr></table></figure></p>
<p>数据的四格表如下所示：<br><img src="http://ortxpw68f.bkt.clouddn.com/chi03.png" alt=""></p>
<p>这张图里的四个数是该表的基本数据，其余的数据都是由这4个基本数据推算出来的，称为四格表（fourfold table）资料。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">chi &lt;- chisq.test(data71)</div><div class="line">chi$expected #　显示理论数</div></pre></td></tr></table></figure>
<p>理论数如下所示：<br><img src="http://ortxpw68f.bkt.clouddn.com/chi04.png" alt=""></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">chisq.test(data71,correct=F) </div><div class="line"># correct = F表示不进行Yates连续性校正</div></pre></td></tr></table></figure>
<p><img src="http://ortxpw68f.bkt.clouddn.com/chi05.png" alt=""></p>
<p>结果：卡方值为12.8571，p值= 0.0003362小于0.01，按sig = 0.01的水准，拒绝原假设，接受备用假设，可以认为异山梨醇口服液降低颅内压的有效率高于氢氯噻嗪+地塞米松的有效率。这个结果与SAS计算的结果相同。R语言中默认的卡方检验是进行Yates连续性校正，因此上题中进行检验时，要加入correct=F。</p>
<h2 id="四格表资料的Fisher确切概率法"><a href="#四格表资料的Fisher确切概率法" class="headerlink" title="四格表资料的Fisher确切概率法"></a>四格表资料的Fisher确切概率法</h2><p>四格表中的计数资料的实际频数都是分类资料，是不连续的，因此计算出的卡方值都是离散型分布，而卡方界值表的依据是卡方分布，卡方分布是连续分布，因此在实际工作中，对于四格表资料，需要进行Yates校正，其规则如下：</p>
<ol>
<li>当$n\geq 40$，且所有的$T\geq 5$时，用卡方检验的基本公式。</li>
<li>当$n\geq 40$，但有$1\leq T \geq 5$时，用校正公式，或改用四格表资料的Fisher确切概率法。</li>
<li>当$n\leq 40$，或T \leq 1$时，用四格表资料的Fisher确切概率法。</li>
</ol>
<h3 id="案例2"><a href="#案例2" class="headerlink" title="案例2"></a>案例2</h3><p>某医师欲比较胞磷胆碱与神经节苷酯治疗脑血管疾病的疗效，将78例脑血管疾病患者随机分为两组，结果见表7-2。问两种药物治疗脑血管疾病的有效率是否有差别？（《医学统计学》第四版，孙振球，第七章 卡方检验，例7-2）</p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/chi06.png" alt=""></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">data72&lt;-matrix(c(46,18,6,8),</div><div class="line">               nr = 2,</div><div class="line">               dimnames = list(c(&quot;胞磷胆碱&quot;,&quot;神经节苷脂&quot;),c(&quot;有效&quot;,&quot;无效&quot;)))</div><div class="line">chisq.test(data72,correct=F) # 不进行Yates校正的结果</div><div class="line"></div><div class="line">chisq.test(data72,correct=T) # 进行Yates校正的结果</div><div class="line"></div><div class="line"># 这个结果与下面的结果一样</div><div class="line"># 因为R中进行卡方检验时是默认进行Yates连续性校正的</div><div class="line">chisq.test(data72)</div></pre></td></tr></table></figure>
<p>结果如下所示：<br><img src="http://ortxpw68f.bkt.clouddn.com/chi07.png" alt=""></p>
<p>不校正的情况下，卡方值为4.35，p值为0.03695小于0.05，进行卡方连续性校正的情况下，卡方值为3.1448,p=0.07617。校正与不校正得出的结果在0.05附近，因此下结论要谨慎。</p>
<h2 id="配对四格表卡方检验"><a href="#配对四格表卡方检验" class="headerlink" title="配对四格表卡方检验"></a>配对四格表卡方检验</h2><h3 id="案例3"><a href="#案例3" class="headerlink" title="案例3"></a>案例3</h3><p>某实验室分别用乳胶凝集法和免疫荧光法对58名可疑系统红斑狼疮患者血清中抗核抗体进行测定，结果见表7-3。问两种方法的检测结果有无差别？（《医学统计学》第三版，孙振球，第七章 卡方检验，例7-3）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">data73&lt;-matrix(c(11,2,12,33),</div><div class="line">               nr = 2,dimnames = list(c(&quot;+&quot;, &quot;-&quot;),c(&quot;+&quot;, &quot;-&quot;)))</div><div class="line"></div><div class="line">library(epiR) # 载入epiR包，使用其中的epi.kappa函数</div><div class="line"></div><div class="line">mcnemar.test(data73) # 配对检验</div><div class="line"></div><div class="line">chisq.test(data73)$expect</div><div class="line"></div><div class="line">epi.kappa(data73)$kappa </div><div class="line"># 一致性检验，即考察这两个方法在检验方面是否吻合</div><div class="line"></div><div class="line"># 或者使用vcd包中的Kappa</div><div class="line">library(vcd)</div><div class="line">Kappa(data73)</div></pre></td></tr></table></figure>
<p>结果如下所示：<br><img src="http://ortxpw68f.bkt.clouddn.com/chi08.png" alt=""></p>
<p>结果分析：McNemar配对卡方检验的p值为0.01616,在0.05水平上，有显著性差异，免疫荧光法的总体阳性检出率要高于乳胶凝集法。</p>
<p>Kappa检验结果的p值小于0.01，估计值为0.455，说明两种方法的吻合度有统计学意义，但吻合度一般。</p>
<p>简单来说，McNemar检验是比较两种方法A与B对同一个对象的检验是否有差异，判断哪种方法比较好，比较容易检验出来结果。而Kappa检验就是比较A与B这两种方法检验出来的结果是不是一致的。在有些配对案例中可能会出现A的方法优于B，但A与B检验的结果不一致的情况。</p>
<h2 id="四格表精确Fisher检验"><a href="#四格表精确Fisher检验" class="headerlink" title="四格表精确Fisher检验"></a>四格表精确Fisher检验</h2><h3 id="案例4"><a href="#案例4" class="headerlink" title="案例4:"></a>案例4:</h3><p>某医师为研究乙肝免疫球蛋白预防胎儿宫内感染HBV的效果，将33例HBsAg阳性孕妇随机分为预防注射组和非预防组，结果见表7-4。问两组新生儿的HBV总体感染率有无差别？（《医学统计学》第四版，孙振球，第七章 卡方检验，例7-4)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">data74&lt;-matrix(c(4,5,18,6),nr = 2,</div><div class="line">               dimnames = list(c(&quot;预防注射组&quot;, </div><div class="line">                                 &quot;非预防组&quot;),c(&quot;阳性&quot;, &quot;阴性&quot;)))</div><div class="line">chi&lt;-chisq.test(data74) </div><div class="line"># 理论频数小于5的情况，这里用Yates连续校正，</div><div class="line"># 默认的就是，不用添加correct = T</div><div class="line"></div><div class="line">chi$expected </div><div class="line"># 查看理论频数，有小于5的情况</div><div class="line"></div><div class="line">fisher.test(data74)</div></pre></td></tr></table></figure>
<p>结果如下所示：<br><img src="http://ortxpw68f.bkt.clouddn.com/chi09.png" alt=""></p>
<h3 id="案例5"><a href="#案例5" class="headerlink" title="案例5:"></a>案例5:</h3><p>某单位研究胆囊腺癌、腺瘤的P53基因表达，对同期手术切除的胆囊腺癌、腺瘤标本各10份，用免疫组化法检测P53基因，资料见表7-6。问胆囊腺癌和胆囊腺瘤的P53基因表达阳性率有无差别？（《医学统计学》第四版，孙振球，第七章 卡方检验，例7-5）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">data75&lt;-matrix(c(6,1,4,9),nr = 2,</div><div class="line">               dimnames = list(c(&quot;胆囊腺癌&quot;, &quot;胆囊腺瘤&quot;),</div><div class="line">                               c(&quot;阳性&quot;, &quot;阴性&quot;)))</div><div class="line"></div><div class="line">fisher.test(data75)</div></pre></td></tr></table></figure>
<p>结果如下所示：<br><img src="http://ortxpw68f.bkt.clouddn.com/chi10.png" alt=""></p>
<h2 id="无序R×C列表"><a href="#无序R×C列表" class="headerlink" title="无序R×C列表"></a>无序R×C列表</h2><h3 id="案例6-列与行的数目都大于2"><a href="#案例6-列与行的数目都大于2" class="headerlink" title="案例6:列与行的数目都大于2"></a>案例6:列与行的数目都大于2</h3><p>无序R×C列表这种情况是行、列都无序，并且行与列的数目都大于2，例如： 某医师研究物理疗法、药物治疗和外用膏药三种疗法治疗周围性面神经麻痹的疗效，资料见表7-8。问三种疗法的有效率有无差别（《医学统计学》第四版，孙振球，第七章 卡方检验，例7-6）？<br>如下所示：<br><img src="http://ortxpw68f.bkt.clouddn.com/chi11.png" alt=""></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">data76&lt;-matrix(c(199,164,118,7,18,26),</div><div class="line">               nr = 3,dimnames = list(c(&quot;物理疗法组&quot;, &quot;药物治疗组&quot;,&quot;外用膏药组&quot;),</div><div class="line">                                      c(&quot;有效&quot;, &quot;无效&quot;)))</div><div class="line">chi.result &lt;- chisq.test(data76)</div><div class="line">chi.result # 查看卡方分析结果</div></pre></td></tr></table></figure>
<p>结果如下所示：<br><img src="http://ortxpw68f.bkt.clouddn.com/chi12.png" alt=""></p>
<h2 id="双向无序R×C列表的卡方检验"><a href="#双向无序R×C列表的卡方检验" class="headerlink" title="双向无序R×C列表的卡方检验"></a>双向无序R×C列表的卡方检验</h2><h3 id="案例7"><a href="#案例7" class="headerlink" title="案例7:"></a>案例7:</h3><p>某医师在研究血管紧张素I转化酶(ACE)基因I/D多态与2型糖尿病肾病(DN)的关系时，将249例2型糖尿病患者按有无糖尿病肾病分为两组，资料见表7-9，问两组2型糖尿病患者的ACE基因型总体分布有无差别（《医学统计学》第四版，孙振球，第七章 卡方检验，例7-7）？<br><img src="http://ortxpw68f.bkt.clouddn.com/chi13.png" alt=""></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">data77 &lt;- matrix(c(42,30,48,72,21,36),</div><div class="line">                 nrow=2,dimnames=list(c(&quot;DN组&quot;,&quot;无DN组&quot;),</div><div class="line">                                      c(&quot;DD&quot;,&quot;ID&quot;,&quot;II&quot;)))</div><div class="line">chi.result77 &lt;- chisq.test(data77)</div><div class="line">chi.result77$expected</div><div class="line">chi.result77</div></pre></td></tr></table></figure>
<p>结果如下所示：<br><img src="http://ortxpw68f.bkt.clouddn.com/chi14.png" alt=""></p>
<h2 id="双向无序R×C列表的关联性检验"><a href="#双向无序R×C列表的关联性检验" class="headerlink" title="双向无序R×C列表的关联性检验"></a>双向无序R×C列表的关联性检验</h2><h3 id="案例8"><a href="#案例8" class="headerlink" title="案例8"></a>案例8</h3><p>测得某地5801人的ABO血型和MN血型结果如表7-10，问两种血型系统之间是否有关联？（《医学统计学》第四版，孙振球，第七章 卡方检验，例7-8）</p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/chi15.png" alt=""></p>
<p>没有找到关于Pearson列联系数的函数，手工计算如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">data78 &lt;- matrix(c(431,388,495,137,490,410,587,179,902,800,950,32),nrow=4,dimnames=list(c(&quot;O&quot;,&quot;A&quot;,&quot;B&quot;,&quot;AB&quot;),</div><div class="line">                                                                                        c(&quot;M&quot;,&quot;N&quot;,&quot;MN&quot;)))</div><div class="line">chi.result &lt;- chisq.test(data78)</div><div class="line">chi.result</div><div class="line"></div><div class="line">sqrt(chi.result$statistic/(sum(data78)+chi.result$statistic)) # 列联系数</div><div class="line"></div><div class="line"># 根据手工计算结果，可以构建一个计算Pearson列联系数的自定义函数，如下所示：</div><div class="line"></div><div class="line">Pearson_Continuity &lt;- function(x)&#123;</div><div class="line">  chisq_result &lt;- chisq.test(x)$statistic </div><div class="line">  # 提取计算的卡方值</div><div class="line">  Pcoc &lt;- sqrt(chisq_result/(sum(x)+chisq_result))</div><div class="line">  print.noquote(&quot;Persaon列联系数&quot;) </div><div class="line"># print.noquote的作用是显示字符，不带引号，</div><div class="line"># 而print则是带引号</div><div class="line">  return(as.numeric(Pcoc))&#125;</div><div class="line"></div><div class="line">Pearson_Continuity(data78)</div></pre></td></tr></table></figure></p>
<p>结果如下所示：<br><img src="http://ortxpw68f.bkt.clouddn.com/chi16.png" alt=""></p>
<h2 id="两两比较——所有组进行两两比较"><a href="#两两比较——所有组进行两两比较" class="headerlink" title="两两比较——所有组进行两两比较"></a>两两比较——所有组进行两两比较</h2><p>当对所有组进行两两比较时，通常采用的方法是Bonferroni法，此方法对原有的检验水平进行调整，即原有的检验水平α除以比较次数得到调整后的检验水平。书本（《医学统计学》第三版，孙振球，P122）中的公式在分母中加了1，不清楚为什么，没有提出采用的是Bonferroni法。而另外两本参考书，即《医学统计学》第6版，马斌荣，P91与《医学统计学》第6版，颜虹，2010年，P155这两本书中所用到的两两比较的方法是Bonferroni法，在下面的题目中使用Bonferroni法。</p>
<h3 id="案例9"><a href="#案例9" class="headerlink" title="案例9"></a>案例9</h3><p>对例7-6中的资料进行两两比较，以推断是否任两种疗法治疗周围性面神经麻痹的有效率均有差别？（《医学统计学》第四版，孙振球，第七章 卡方检验，例7-9）</p>
<p>例7-6中共有三组疗法，需要两两比较的次数是3次，因此检验水平是0.05/3=0.0167。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">data76&lt;-matrix(c(199,164,118,7,18,26),</div><div class="line">               nr = 3,</div><div class="line">               dimnames = list(c(&quot;物理疗法组&quot;, &quot;药物治疗组&quot;,&quot;外用膏药组&quot;),</div><div class="line">                               c(&quot;有效&quot;, &quot;无效&quot;)))</div><div class="line">chisq.test(data76[1:2,],correct=F) </div><div class="line"># 比较物理疗法组与药物治疗组，</div><div class="line"># R中默认四格表进行了Yates校正，</div><div class="line"># 此处设为F，不进行校正，因为实际值与观测值都大于5</div></pre></td></tr></table></figure>
<p>结果如下所示：<br><img src="http://ortxpw68f.bkt.clouddn.com/chi17.png" alt=""></p>
<p>从结果可以看出物理疗法组与药物治疗组有统计学差异。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">chisq.test(data76[2:3,], correct=F)</div><div class="line">#比较药物治疗组与外用膏药组</div></pre></td></tr></table></figure>
<p><img src="http://ortxpw68f.bkt.clouddn.com/chi18.png" alt=""><br>从结果来看，药物治疗组与外用膏药组无统计学上的差异。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">chisq.test(data76[-2,],correct=F)</div><div class="line"># 比较物理疗法组与外用膏药组</div></pre></td></tr></table></figure>
<p><img src="http://ortxpw68f.bkt.clouddn.com/chi19.png" alt=""></p>
<p>从结果来看，物理疗法组与外用膏药组有统计学上的差异。</p>
<h2 id="两两比较——各个实验组与一个对照组进行比较"><a href="#两两比较——各个实验组与一个对照组进行比较" class="headerlink" title="两两比较——各个实验组与一个对照组进行比较"></a>两两比较——各个实验组与一个对照组进行比较</h2><p>两两比较——各个实验组与一个对照组进行比较<br>当用各个实验组与一个对照组分别进行比较时，需要对检验水平α进行校正，即α/(k-1),其中k是组别。在此案例中，组别k=3,因此，调整后的检验水平=0.05/(3-2)=0.025。</p>
<h3 id="案例10"><a href="#案例10" class="headerlink" title="案例10:"></a>案例10:</h3><p>以表7-8资料中的药物治疗组为对照组，物理疗法组与外用膏药组为试验组，试分析两试验组与对照组的总体有效率有无差别？（《医学统计学》第四版，孙振球，第七章 卡方检验，例7-10）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">chisq.test(data76[1:2,],correct=F) </div><div class="line">#比较物理疗法组与药物治疗组</div><div class="line"></div><div class="line">chisq.test(data76[2:3,], correct=F) </div><div class="line">#比较药物治疗组与外用膏药组</div></pre></td></tr></table></figure>
<p><img src="http://ortxpw68f.bkt.clouddn.com/chi20.png" alt=""></p>
<p>第一个结果显示，P=0.009343小于0.025，表明物理疗法组与药物治疗组有统计学意义<br>第二个结果显示，P=0.03214大于0.025，表明药物治疗组与外用膏药组无统计学意义。</p>
<h2 id="单向R×C列联表分析——列有序"><a href="#单向R×C列联表分析——列有序" class="headerlink" title="单向R×C列联表分析——列有序"></a>单向R×C列联表分析——列有序</h2><h3 id="案例11"><a href="#案例11" class="headerlink" title="案例11"></a>案例11</h3><p>某公司研制一种治疗风湿性关节炎的中药，选择试验组和对照组各60例，试验组服用新药，对照组服用常规药物。以中医证侯疗效为主要疗效指标，分为无效、有效、显效、痊愈四个等级。治疗两个疗程后，两组的疗效情况如表5.4所示（略，见代码），欲分析两种药物的疗效是否有差异（《医学案例统计分析与SAS应用》第五章例5.4，冯国双，北京大学医学出版社，2010:93）。</p>
<h3 id="第一种方法：Ridit分析"><a href="#第一种方法：Ridit分析" class="headerlink" title="第一种方法：Ridit分析"></a>第一种方法：Ridit分析</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">data54 &lt;- c(33,18,24,31,1,9,2,2)</div><div class="line">data54m &lt;- matrix(data54,nrow=2,</div><div class="line">                  dimnames=list(c(&quot;对照组&quot;,&quot;实验组&quot;),</div><div class="line">                                c(&quot;无效&quot;,&quot;有效&quot;,&quot;显效&quot;,&quot;痊愈&quot;)))</div><div class="line">data54m</div><div class="line"></div><div class="line">#从数据来看，列变量，即无效、有效、显效、痊愈这四个等级是有序的，</div><div class="line"># 即越来越好，而行变量，对照组与实验组，这是无效的，适合采用Ridit分析：</div><div class="line"></div><div class="line">library(Ridit)</div><div class="line">ridit(data54m,1) </div><div class="line"># 函数ridit的参数中1表示分组信息是行，即行是无序的，列是有序的，</div><div class="line"># 如果是2，则表示分组信息在列，即列是无序的，行是有序的</div></pre></td></tr></table></figure>
<p><img src="http://ortxpw68f.bkt.clouddn.com/chi21.png" alt=""></p>
<h3 id="第二种方法：CMH分析"><a href="#第二种方法：CMH分析" class="headerlink" title="第二种方法：CMH分析"></a>第二种方法：CMH分析</h3><p>用CMH也能进行RC列联表的单向有序分析，CMHtest函数在vcdExtra包中，需要载入</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">library(vcdExtra)</div><div class="line">CMHtest(data54m)</div></pre></td></tr></table></figure>
<p><img src="http://ortxpw68f.bkt.clouddn.com/chi22.png" alt=""></p>
<p>CMH的单向有序分析参见第3行，即cmeans，这一行表示列有序，行无序的分析结果。</p>
<h2 id="双向有序R×C列联表分析-CMH检验"><a href="#双向有序R×C列联表分析-CMH检验" class="headerlink" title="双向有序R×C列联表分析-CMH检验"></a>双向有序R×C列联表分析-CMH检验</h2><p>对于双向有序的RC列联表进行分析，常用于CMH检验，卡方检验常用于分类变量资料的一种假设检验，该法主要用于两个或多个样本率的比较，也可以用于两变量间的关联分析、频属分析的拟合优度检验等。CMH检验是在1959年提出的mh统计方法的基础上提出来的，1988年才发展完善，现在习惯上称之为扩展的MH卡方检验。他们的主要区别在于，如果用同样的方法做同样的实验，由于实验的地点不同，若将这些不同地点的实验数据简单合并后有卡方检验，会参杂很多混杂因素，这会使检验结果产生很大的偏差—主要是由不同实验的点的软、硬条件不同造成的。采用CMH检验可以解决这类问题，采用的是多中心或分层分析方法，多用R×C列联表的分层统计处理1。此外，CMH还应用于双向有序的RC列联表的分析。如下所示：</p>
<h3 id="案例12"><a href="#案例12" class="headerlink" title="案例12"></a>案例12</h3><p>某研究者欲研究年龄与冠状动脉粥样硬化等级之间的关系，将278例尸解资料整理成表7-13，问年龄与冠状动脉粥样硬化等级之间是否存在线性变化趋势？（《医学统计学》第四版，孙振球，第七章 卡方检验，例7-9）</p>
<h4 id="第一种方法："><a href="#第一种方法：" class="headerlink" title="第一种方法："></a>第一种方法：</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">library(vcdExtra) </div><div class="line"># 载入vcdExtra包</div><div class="line">data711 &lt;- matrix(c(70,27,16,9,22,24,23,20,4,9,13,15,2,3,7,14),nrow=4)</div><div class="line">dimnames(data711) &lt;- list(age=c(&quot;20~&quot;,&quot;30~&quot;,&quot;40~&quot;,&quot;≥50&quot;),degree=c(&quot;-&quot;,&quot;+&quot;,&quot;++&quot;,&quot;+++&quot;))</div><div class="line">CMHtest(data711) # 分析数据</div><div class="line">chisq.test(data711)</div></pre></td></tr></table></figure>
<p><img src="http://ortxpw68f.bkt.clouddn.com/chi23.png" alt=""></p>
<h4 id="第二种方法："><a href="#第二种方法：" class="headerlink" title="第二种方法："></a>第二种方法：</h4><p>通过coin包中的lbl_test函数也能进行CMH双向有序表的计算：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">library(coin)</div><div class="line">data711t &lt;- as.table(data711)</div><div class="line">lbl_test(data711t,scores=list(age=c(1,2,3,4),degree=c(1,2,3,4)))</div></pre></td></tr></table></figure>
<p><img src="http://ortxpw68f.bkt.clouddn.com/chi24.png" alt=""></p>
<p>其中，scores是各个有序变量的得分，与教材中相同。</p>
<h4 id="第三种方法："><a href="#第三种方法：" class="headerlink" title="第三种方法："></a>第三种方法：</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">library(reshape2)</div><div class="line">datax &lt;- melt(data711)</div><div class="line">datax$age &lt;- factor(datax$age,order=T)</div><div class="line">datax$degree &lt;- factor(datax$degree,order=T)</div><div class="line">CMHtest(xtabs(value~age+degree,data=datax))</div></pre></td></tr></table></figure>
<p><img src="http://ortxpw68f.bkt.clouddn.com/chi25.png" alt=""></p>
<p>结果解读：(1)第1行的cor指的是行与列都为有序变量时的结果，即教材中的线性回归分量，为63.389，这个与教材的结果不一致，但R计算的结果与教材附带的SAS程序计算出来的结果一致，教材可能是印刷错误；(2)第2行的rmeans表示行是有序变量时的结果；(3)第3行的cmeans表示列是有序变量时的结果；(4)general表示列与行都是无序变量时的结果。</p>
<p>常规卡方计算的结果是71.4325。线性回归分量的结果是63.389，二者之差是教材中的偏离线性回归分量，即71.4325-63.389=8.0435，相应的P值为:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">1-pchisq(8.0435,8)</div></pre></td></tr></table></figure>
<p>p值结果为0.4292325，可以认为年龄与冠状动物粥样硬化之间不仅存在相关关系，并且为线性关系，从数据中可以看出来，冠状动脉粥样硬化的等级随着年龄的增加而增高。<br>注：pchisq(8.0435,8)表示，计算自由度为8，卡方值是8.0435的左侧卡方分布曲线下面积。</p>
<h2 id="CMH检验对多层分类资料的分析"><a href="#CMH检验对多层分类资料的分析" class="headerlink" title="CMH检验对多层分类资料的分析"></a>CMH检验对多层分类资料的分析</h2><h3 id="案例13"><a href="#案例13" class="headerlink" title="案例13"></a>案例13</h3><p>某公司推出一种治疗颈椎病的治疗仪，为评价其疗效，进行多中心的随机对照试验。共选择两家医院，每家医院60例研究对象，试验组与对照组各30例。以颈痛疗效作为主要疗效指标，根据缓解程度分为有效和无效。治疗20天后，各中心每组的疗效情况如下所示（参见代码），欲分析两种治疗仪的疗效是否有差异（《医学案例统计分析与SAS应用》第五章例5.4，冯国双，北京大学医学出版社，2010:97）。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">data56 &lt;- c(8,4,22,26,11,9,19,21)</div><div class="line">data56a &lt;- array(data56,dim=c(2,2,2))</div><div class="line">data56a</div><div class="line">dimnames(data56a) &lt;- list(</div><div class="line">  c(&quot;对照组&quot;,&quot;试验组&quot;),</div><div class="line">  c(&quot;无效&quot;,&quot;有效&quot;),</div><div class="line">  c(&quot;中心1&quot;,&quot;中心2&quot;))</div><div class="line"></div><div class="line">CMHtest(data56a,overall=TRUE)</div></pre></td></tr></table></figure>
<p><img src="http://ortxpw68f.bkt.clouddn.com/chi26.png" alt=""></p>
<p>结果由三部分构成，第一部分是中心1的结果，第二部分是中心2 的结果，第三部分是控制了中心的影响后，两组疗效差异无统计学意义。</p>
<h2 id="频数分布拟合优势的卡方检验"><a href="#频数分布拟合优势的卡方检验" class="headerlink" title="频数分布拟合优势的卡方检验"></a>频数分布拟合优势的卡方检验</h2><h3 id="案例14"><a href="#案例14" class="headerlink" title="案例14"></a>案例14</h3><p>观察某克山病区克山病患者的空间分布情况，调查者将该地区划分为279个取样单位，统计各取样单位历年累计病例数，资料见表7-15的第（1）、（2）栏，问此资料是否服从Poisson分布？（《医学统计学》第三版，孙振球，第七章 卡方检验，例7-13）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">x&lt;-0:6</div><div class="line">y&lt;-c(26,51,75,63,38,17,9)</div><div class="line">mean&lt;-mean(rep(x,y))</div><div class="line">q&lt;-ppois(x,mean)</div><div class="line">n&lt;-length(y)</div><div class="line">p&lt;-c()</div><div class="line">p[1]&lt;-q[1]</div><div class="line">p[n]&lt;-1-q[n-1]</div><div class="line">for(i in 2:(n-1))</div><div class="line">  p[i]&lt;-q[i]-q[i-1]</div><div class="line"></div><div class="line">chisq.test(y, p=p,correct=F)</div></pre></td></tr></table></figure>
<p><img src="http://ortxpw68f.bkt.clouddn.com/chi27.png" alt=""></p>
<h3 id="案例15-皮尔森拟合优度卡方检验"><a href="#案例15-皮尔森拟合优度卡方检验" class="headerlink" title="案例15 皮尔森拟合优度卡方检验"></a>案例15 皮尔森拟合优度卡方检验</h3><p>假设H0：总体具有某分布F 备择假设H1：总体不具有该分布。<br>我们将数轴分成若干个区间，所抽取的样本会分布在这些区间中。在原假设成立的条件下，我们便知道每个区间包含样本的个数的期望值。用实际值Ni 与期望值Npi可以构造统计量K 。皮尔森证明，n趋向于无穷时，k收敛于m-1的塔防分布。m为我们分组的个数。有了这个分布，我们就可以做假设检验。 </p>
<p>某消费者协会为了确定市场上消费者对5咎品牌啤酒的喜好情况，随机抽取了1000名啤酒爱好者作为样本进行如下试验：每个人得到5种品牌的啤酒各一瓶，但未标明牌子。这5种啤酒按分别写着A、B、C、D、E字母的5张纸片随机的顺序送给每一个人，下表是根据样本资料整理得的各种品牌啤酒爱好者的频数分页，试根据这些数据判断消费者对这5种品牌啤酒的爱好有无明显差异？<br><img src="http://ortxpw68f.bkt.clouddn.com/chi28.png" alt=""></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">x &lt;- c(210,312,170,85,223) </div><div class="line">n &lt;- sum(x); m &lt;- length(x) </div><div class="line">p &lt;- rep(1/m,m) </div><div class="line">K &lt;- sum((x-n*p)^2/(n*p)); K #计算出K值 </div><div class="line">p &lt;- 1-pchisq(K,m-1); p #计算出p值</div></pre></td></tr></table></figure>
<p><img src="http://ortxpw68f.bkt.clouddn.com/chi29.png" alt=""></p>
<p>在R语言中 chisq.test()，可以完成拟合优度检验。默认就是检验是否为均匀分布，如果是其他分布，需要自己分组，并在参数p中指出。上面题目的解法如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">chisq(x)</div></pre></td></tr></table></figure>
<p><img src="http://ortxpw68f.bkt.clouddn.com/chi30.png" alt=""></p>
<p>同样拒绝原假设。</p>
<h3 id="案例16-检验是否为正态分布"><a href="#案例16-检验是否为正态分布" class="headerlink" title="案例16 检验是否为正态分布"></a>案例16 检验是否为正态分布</h3><p>抽取31名学生的成绩，检验是否为正态分布。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">x &lt;- c(25,45,50,54,55,61,64,68,72,75,75,78,79,81,83,84,84,84,85,86,86,86,87,89,89,89,90,91,91,92,100) </div><div class="line">A &lt;- table(cut(x,breaks=c(0,69,79,89,100))) ;A#对样本数据进行分组。 </div><div class="line">p &lt;- pnorm(c(70,80,90,100),mean(x),sd(x)) #获得理论分布的概率值 </div><div class="line">p &lt;- c(p[1],p[2]-p[1],p[3]-p[2],1-p[3]) </div><div class="line">chisq.test(A,p=p)</div></pre></td></tr></table></figure>
<p><img src="http://ortxpw68f.bkt.clouddn.com/chi31.png" alt=""><br>结果显示，其p值小于0.05，成绩不属于正态分布。</p>
<p>再用shirpo.test()和qq图检验一下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">shapiro.test(x)</div><div class="line">qqnorm(x);qqline(x, col = 2)</div></pre></td></tr></table></figure>
<p><img src="http://ortxpw68f.bkt.clouddn.com/chi32.png" alt=""><br><img src="http://ortxpw68f.bkt.clouddn.com/chi33.png" alt=""></p>
<p>结果显示，p值小于0.05，不是正态分页，并且QQ图明显表示出成绩不符合正态分布。</p>
<h3 id="案例17-检验是否符合原比例"><a href="#案例17-检验是否符合原比例" class="headerlink" title="案例17 检验是否符合原比例"></a>案例17 检验是否符合原比例</h3><p>大麦杂交后关于芒性的比例应该是 无芒：长芒：短芒=9:3:4 。我们的实际观测值是335：125：160 。请问观测值是否符合预期？<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">p &lt;- c(9/16,3/16,4/16) </div><div class="line">x &lt;- c(335,125,160) </div><div class="line">chisq.test(x,p=p)</div></pre></td></tr></table></figure></p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/chi34.png" alt=""></p>
<p>在分组的时候要注意，每组的频数要大于等于5.如果理论分布依赖于多个未知参数，只能先由样本得到参数的估计量。然后构造统计量K，此时K的自由度减少位置参数的数量个。</p>
<h2 id="ks检验"><a href="#ks检验" class="headerlink" title="ks检验"></a>ks检验</h2><p>R语言中提供了ks.test()函数，理论上可以检验任何分布。他既能够做单样本检验，也能做双样本检验。 </p>
<h3 id="案例18"><a href="#案例18" class="headerlink" title="案例18"></a>案例18</h3><p>记录一台设备无故障工作时常，并从小到大排序420 500 920 1380 1510 1650 1760 2100 2300 2350。问这些时间是否服从拉姆达=1/1500的指数分布？<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">x &lt;- c(420,500,920,1380,1510,1650,1760,2100,2300,2350) </div><div class="line">ks.test(x,&quot;pexp&quot;,1/1500)</div></pre></td></tr></table></figure></p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/chi35.png" alt=""></p>
<h3 id="案例19："><a href="#案例19：" class="headerlink" title="案例19："></a>案例19：</h3><p>有两个分布，分别抽样了一些数据，问他们是否服从相同的分布。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">X&lt;-scan() </div><div class="line">0.61 0.29 0.06 0.59 -1.73 -0.74 0.51 -0.56 0.39 1.64 0.05 -0.06 0.64 -0.82 0.37 1.77 1.09 -1.28 2.36 1.31 1.05 -0.32 -0.40 1.06 -2.47</div><div class="line"></div><div class="line">Y&lt;-scan() </div><div class="line">2.20 1.66 1.38 0.20 0.36 0.00 0.96 1.56 0.44 1.50 -0.30 0.66 2.31 3.29 -0.27 -0.37 0.38 0.70 0.52 -0.71</div><div class="line"></div><div class="line">ks.test(X,Y)</div></pre></td></tr></table></figure></p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/chi36.png" alt=""></p>
<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><ol>
<li><a href="http://doctor.51daifu.com/2007/0305/1ADAD919C959T148648.shtml" target="_blank" rel="external">http://doctor.51daifu.com/2007/0305/1ADAD919C959T148648.shtml</a></li>
<li><a href="http://blog.sina.com.cn/s/blog_686dcf990100z9q3.html" target="_blank" rel="external">http://blog.sina.com.cn/s/blog_686dcf990100z9q3.html</a></li>
<li><a href="http://medstats.blog.163.com/blog/static/17974801620089108192736/" target="_blank" rel="external">http://medstats.blog.163.com/blog/static/17974801620089108192736/</a></li>
<li><a href="http://blog.sina.com.cn/s/blog_4b361fe00100y222.html" target="_blank" rel="external">http://blog.sina.com.cn/s/blog_4b361fe00100y222.html</a></li>
<li>孙振球. 医学统计学[M]. 人民卫生出版社, 2010.</li>
<li>徐俊晓. 统计学与R读书笔记(第六版)</li>
<li>葛毅, 胡良平. 高维列联表资料的统计分析与 SAS 软件实现 (一)[J]. 中西医结合学报, 2009, 7(11): 1086-1089.</li>
<li><a href="http://bbs.pinggu.org/thread-521307-1-1.html↩" target="_blank" rel="external">http://bbs.pinggu.org/thread-521307-1-1.html↩</a></li>
</ol>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/基础统计/" <i class="fa fa-tag"></i> 基础统计</a>
          
            <a href="/tags/基础知识/" <i class="fa fa-tag"></i> 基础知识</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2017/08/17/实验笔记-质粒构建/" rel="next" title="质粒构建">
                <i class="fa fa-chevron-left"></i> 质粒构建
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2017/09/20/生物信息学笔记-RNA-seq入门/" rel="prev" title="生信笔记-RNA-Seq分析简介">
                生信笔记-RNA-Seq分析简介 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">RVDSD</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">35</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">6</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">29</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          <div class="links-of-author motion-element">
            
          </div>

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#简介"><span class="nav-number">1.</span> <span class="nav-text">简介</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#卡方检验的基本思路"><span class="nav-number">1.1.</span> <span class="nav-text">卡方检验的基本思路</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#四格表资料的-chi-2-检验"><span class="nav-number">2.</span> <span class="nav-text">四格表资料的$\chi^2$检验</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#案例1"><span class="nav-number">2.1.</span> <span class="nav-text">案例1</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#四格表资料的Fisher确切概率法"><span class="nav-number">3.</span> <span class="nav-text">四格表资料的Fisher确切概率法</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#案例2"><span class="nav-number">3.1.</span> <span class="nav-text">案例2</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#配对四格表卡方检验"><span class="nav-number">4.</span> <span class="nav-text">配对四格表卡方检验</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#案例3"><span class="nav-number">4.1.</span> <span class="nav-text">案例3</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#四格表精确Fisher检验"><span class="nav-number">5.</span> <span class="nav-text">四格表精确Fisher检验</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#案例4"><span class="nav-number">5.1.</span> <span class="nav-text">案例4:</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#案例5"><span class="nav-number">5.2.</span> <span class="nav-text">案例5:</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#无序R×C列表"><span class="nav-number">6.</span> <span class="nav-text">无序R×C列表</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#案例6-列与行的数目都大于2"><span class="nav-number">6.1.</span> <span class="nav-text">案例6:列与行的数目都大于2</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#双向无序R×C列表的卡方检验"><span class="nav-number">7.</span> <span class="nav-text">双向无序R×C列表的卡方检验</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#案例7"><span class="nav-number">7.1.</span> <span class="nav-text">案例7:</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#双向无序R×C列表的关联性检验"><span class="nav-number">8.</span> <span class="nav-text">双向无序R×C列表的关联性检验</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#案例8"><span class="nav-number">8.1.</span> <span class="nav-text">案例8</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#两两比较——所有组进行两两比较"><span class="nav-number">9.</span> <span class="nav-text">两两比较——所有组进行两两比较</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#案例9"><span class="nav-number">9.1.</span> <span class="nav-text">案例9</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#两两比较——各个实验组与一个对照组进行比较"><span class="nav-number">10.</span> <span class="nav-text">两两比较——各个实验组与一个对照组进行比较</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#案例10"><span class="nav-number">10.1.</span> <span class="nav-text">案例10:</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#单向R×C列联表分析——列有序"><span class="nav-number">11.</span> <span class="nav-text">单向R×C列联表分析——列有序</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#案例11"><span class="nav-number">11.1.</span> <span class="nav-text">案例11</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#第一种方法：Ridit分析"><span class="nav-number">11.2.</span> <span class="nav-text">第一种方法：Ridit分析</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#第二种方法：CMH分析"><span class="nav-number">11.3.</span> <span class="nav-text">第二种方法：CMH分析</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#双向有序R×C列联表分析-CMH检验"><span class="nav-number">12.</span> <span class="nav-text">双向有序R×C列联表分析-CMH检验</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#案例12"><span class="nav-number">12.1.</span> <span class="nav-text">案例12</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#第一种方法："><span class="nav-number">12.1.1.</span> <span class="nav-text">第一种方法：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#第二种方法："><span class="nav-number">12.1.2.</span> <span class="nav-text">第二种方法：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#第三种方法："><span class="nav-number">12.1.3.</span> <span class="nav-text">第三种方法：</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#CMH检验对多层分类资料的分析"><span class="nav-number">13.</span> <span class="nav-text">CMH检验对多层分类资料的分析</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#案例13"><span class="nav-number">13.1.</span> <span class="nav-text">案例13</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#频数分布拟合优势的卡方检验"><span class="nav-number">14.</span> <span class="nav-text">频数分布拟合优势的卡方检验</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#案例14"><span class="nav-number">14.1.</span> <span class="nav-text">案例14</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#案例15-皮尔森拟合优度卡方检验"><span class="nav-number">14.2.</span> <span class="nav-text">案例15 皮尔森拟合优度卡方检验</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#案例16-检验是否为正态分布"><span class="nav-number">14.3.</span> <span class="nav-text">案例16 检验是否为正态分布</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#案例17-检验是否符合原比例"><span class="nav-number">14.4.</span> <span class="nav-text">案例17 检验是否符合原比例</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ks检验"><span class="nav-number">15.</span> <span class="nav-text">ks检验</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#案例18"><span class="nav-number">15.1.</span> <span class="nav-text">案例18</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#案例19："><span class="nav-number">15.2.</span> <span class="nav-text">案例19：</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#参考资料"><span class="nav-number">16.</span> <span class="nav-text">参考资料</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

<div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">RVDSD</span>

  
</div>



<div class="powered-by">
<i class="fa fa-user-md"></i><span id="busuanzi_container_site_uv">
  本站访客数:<span id="busuanzi_value_site_uv"></span>
</span>
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.3</div>




<div class="theme-info">
  <div class="powered-by"></div>
  <span class="post-count">博客全站共69.5k字</span>
</div>

        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.3"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.3"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.3"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.3"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.3"></script>



  


  




	





  





  












  





  

  

  
  

  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config("");
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="custom_mathjax_source">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->
  


  

  

</body>
</html>
