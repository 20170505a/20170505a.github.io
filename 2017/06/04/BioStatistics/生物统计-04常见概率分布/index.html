<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.3" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.3">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.3" color="#222">





  <meta name="keywords" content="数据分布," />










<meta name="description" content="前言 随机变量取一切可能值的概率的规律称为概率分布(probability distribution)，简称为分布，通常使用表格，图形，公式来表示这些分布，一个概率分布总是一和个总体(population)相关联的，这里的总体也称为样本空间(sample space)，它是由某种试验的所有可能结果构成的集合，这些结果的获取服从某种概率规律，因此， 一个总体（样本空间）是由一个取值范围及与之相连的">
<meta name="keywords" content="数据分布">
<meta property="og:type" content="article">
<meta property="og:title" content="常见概率分布笔记">
<meta property="og:url" content="http://rvdsd.top/2017/06/04/BioStatistics/生物统计-04常见概率分布/index.html">
<meta property="og:site_name" content="RVDSD的个人笔记本">
<meta property="og:description" content="前言 随机变量取一切可能值的概率的规律称为概率分布(probability distribution)，简称为分布，通常使用表格，图形，公式来表示这些分布，一个概率分布总是一和个总体(population)相关联的，这里的总体也称为样本空间(sample space)，它是由某种试验的所有可能结果构成的集合，这些结果的获取服从某种概率规律，因此， 一个总体（样本空间）是由一个取值范围及与之相连的">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190329101700.png">
<meta property="og:image" content="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190329101726.png">
<meta property="og:image" content="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190329101753.png">
<meta property="og:image" content="http://ortxpw68f.bkt.clouddn.com/professional/180816/B4ECgkBac3.png?imageslim">
<meta property="og:image" content="http://ortxpw68f.bkt.clouddn.com/professional/180801/4jGcihFbea.png?imageslim">
<meta property="og:image" content="http://ortxpw68f.bkt.clouddn.com/professional/180801/HjcKe9cHB1.png?imageslim">
<meta property="og:image" content="http://ortxpw68f.bkt.clouddn.com/professional/180816/k0DhlIhj8m.png?imageslim">
<meta property="og:image" content="http://ortxpw68f.bkt.clouddn.com/professional/180816/59jKHa8hfk.png?imageslim">
<meta property="og:image" content="http://ortxpw68f.bkt.clouddn.com/professional/180801/gcDa8laAGg.png?imageslim">
<meta property="og:image" content="http://ortxpw68f.bkt.clouddn.com/professional/180801/7jlJLk636K.png?imageslim">
<meta property="og:image" content="http://ortxpw68f.bkt.clouddn.com/professional/180801/86Hb6fjHDD.png?imageslim">
<meta property="og:image" content="http://ortxpw68f.bkt.clouddn.com/professional/180801/8dH4i22F99.png?imageslim">
<meta property="og:image" content="http://ortxpw68f.bkt.clouddn.com/professional/180801/BjD76CckKB.png?imageslim">
<meta property="og:image" content="http://ortxpw68f.bkt.clouddn.com/professional/180801/iK1JlBDjlG.png?imageslim">
<meta property="og:image" content="http://ortxpw68f.bkt.clouddn.com/professional/180801/DB40kife7i.png?imageslim">
<meta property="og:image" content="http://ortxpw68f.bkt.clouddn.com/professional/180801/6eD3LJkah5.jpg?imageslim">
<meta property="og:image" content="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190329101830.png">
<meta property="og:image" content="http://ortxpw68f.bkt.clouddn.com/professional/180801/FaGcCAi3lD.png?imageslim">
<meta property="og:image" content="http://ortxpw68f.bkt.clouddn.com/professional/180801/1GACKGGb94.png?imageslim">
<meta property="og:image" content="http://ortxpw68f.bkt.clouddn.com/professional/180801/5m93JHA38h.png?imageslim">
<meta property="og:image" content="http://ortxpw68f.bkt.clouddn.com/professional/180721/6bed6CC66m.png?imageslim">
<meta property="og:image" content="http://ortxpw68f.bkt.clouddn.com/professional/180720/4EjkaG80Km.png?imageslim">
<meta property="og:image" content="http://ortxpw68f.bkt.clouddn.com/professional/180720/GIlFbbElB8.png?imageslim">
<meta property="og:image" content="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190329103227.png">
<meta property="og:image" content="http://ortxpw68f.bkt.clouddn.com/professional/180814/29871IeHg8.png?imageslim">
<meta property="og:image" content="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190329102846.png">
<meta property="og:image" content="http://ortxpw68f.bkt.clouddn.com/professional/180817/all92Geej8.png?imageslim">
<meta property="og:image" content="http://ortxpw68f.bkt.clouddn.com/professional/180817/3KKfkDm5jG.png?imageslim">
<meta property="og:image" content="http://ortxpw68f.bkt.clouddn.com/professional/180817/1lblKmkJG6.png?imageslim">
<meta property="og:image" content="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190329102749.png">
<meta property="og:image" content="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190329102814.png">
<meta property="og:image" content="http://ortxpw68f.bkt.clouddn.com/professional/180817/ac51g6IjEK.png?imageslim">
<meta property="og:image" content="http://ortxpw68f.bkt.clouddn.com/professional/180817/A89BLKGgFK.png?imageslim">
<meta property="og:image" content="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190329102539.png">
<meta property="og:image" content="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190329102513.png">
<meta property="og:image" content="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190329102448.png">
<meta property="og:image" content="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190329102433.png">
<meta property="og:image" content="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190329102417.png">
<meta property="og:image" content="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190329102404.png">
<meta property="og:image" content="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190329102303.png">
<meta property="og:image" content="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190329102327.png">
<meta property="og:image" content="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190329102345.png">
<meta property="og:image" content="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190329102225.png">
<meta property="og:image" content="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190329102204.png">
<meta property="og:image" content="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190329102026.png">
<meta property="og:image" content="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190329102101.png">
<meta property="og:image" content="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190329102135.png">
<meta property="og:updated_time" content="2019-03-29T02:38:40.270Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="常见概率分布笔记">
<meta name="twitter:description" content="前言 随机变量取一切可能值的概率的规律称为概率分布(probability distribution)，简称为分布，通常使用表格，图形，公式来表示这些分布，一个概率分布总是一和个总体(population)相关联的，这里的总体也称为样本空间(sample space)，它是由某种试验的所有可能结果构成的集合，这些结果的获取服从某种概率规律，因此， 一个总体（样本空间）是由一个取值范围及与之相连的">
<meta name="twitter:image" content="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190329101700.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.3',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://rvdsd.top/2017/06/04/BioStatistics/生物统计-04常见概率分布/"/>





  <title>常见概率分布笔记 | RVDSD的个人笔记本</title><!-- hexo-inject:begin --><!-- hexo-inject:end -->
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">RVDSD的个人笔记本</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">学习过程中的输出</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2017/06/04/BioStatistics/生物统计-04常见概率分布/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">常见概率分布笔记</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-06-04T12:00:00+08:00">
                2017-06-04
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/生物统计/" itemprop="url" rel="index">
                    <span itemprop="name">生物统计</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  9,075
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  37
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h2 id="前言">前言</h2>
<p>随机变量取一切可能值的概率的规律称为<strong>概率分布(probability distribution)</strong>，简称为分布，通常使用表格，图形，公式来表示这些分布，一个概率分布总是一和个总体(population)相关联的，这里的总体也称为<strong>样本空间(sample space)</strong>，它是由某种试验的所有可能结果构成的集合，这些结果的获取服从某种概率规律，因此， 一个总体（样本空间）是由一个取值范围及与之相连的概率所组成。于是，给出了这个概率分布就等于知了总体，这些用数学语言表示的概率分布有一些理论参数，称为<strong>总体参数(population parameter)</strong>，对于一个样本来说，它有自己的一些参数，例如样本均值、样本方差、样本标准差、样本分位数等。相对于总体，它也有总体均值、总体方差、总体标准差，总体分位数等参数。只是对于不同的总体，这些参数可能不同，并且对于某些总体，某些参数可能就不存在。</p>
<h2 id="离散型分布">离散型分布</h2>
<p>离散变量很常见，例如在一批产品的质量检查中可能发现的次品数目、一日内通过某电话总体的通话次数、在若干次试验中成功的次数等，这些变量取离散值，而且按照某种概率来取每个值，取每个值的概率应该大于或等于0、小于或等于1，并且取各种值的概率之和应该等于1，用符号来表示就是，假定离散随机变量X的取值范围为<span class="math inline">\(x_{1},x_{2},\cdots,\)</span>而且取可能值<span class="math inline">\(x_{i}\)</span>的概率记为<span class="math inline">\(P(x_{i})\equiv P(X=x_{i})\)</span>，那么这些概率应该同时满足下面的关系：</p>
<p><span class="math inline">\(\sum_{i}P(x_{i})=1,\qquad 0 \leq P(x_{i})\)</span></p>
<p>满足这样关系的概率<span class="math inline">\(P(x_{i})​\)</span>的总和就是该离散变量的概率分布。离散变量的取值不一定是有穷的，例如Poisson分布的取值范围就是所有的非负整数，因而有无穷多可能的值。</p>
<p>除了分布函数<span class="math inline">\(P(X=x_{i})\)</span>外，还有<strong>累积分布函数(cumulative distribution function, CDF)</strong>的概念，离散随机变量的累积分布函数的定义如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190329101700.png">

</div>
<p><strong>统计教科书上的各种概率分布表，通常都是累积分布函数的值</strong>，在计算时，这往往比原始的概率分布要方便，例如我要计算<span class="math inline">\(P(a&lt;X \leq b)\)</span>，那么或者用求和来计算，即如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190329101726.png">

</div>
<p>或者是通过相减来计算，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190329101753.png">

</div>
<p>显然，通过相减计算要容易得多，只需要找到F(b)和F(a)即可。</p>
<p>对于离散分布随机变量X来说，它的总体均值（通常用<span class="math inline">\(\mu\)</span>表示）定义如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180816/B4ECgkBac3.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>它又称为X的数学期望，这里的符号<span class="math inline">\(E(x)\)</span>就是X的期望(expectation)的意思。</p>
<p>变量X的总体方差通常用<span class="math inline">\(\delta^2\)</span>表示，它的公式如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180801/4jGcihFbea.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>这里的符号<span class="math inline">\(Var(X)\)</span>就是X的方差(variance)的意思，总体标准差定义为总体方差的平方根，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180801/HjcKe9cHB1.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>显然，这里的均值、方差等概率和样本均值、样本方差很相似，只要把这里的<span class="math inline">\(x_{i}\)</span>换成样本点，而把<span class="math inline">\(P(x_{i})\)</span>换成<span class="math inline">\(1/n\)</span>（在样本方差经常使用<span class="math inline">\(1/(n-1)\)</span>，在样本量大的时候<span class="math inline">\(1/n\)</span>和<span class="math inline">\(1/(n-1)\)</span>差别不大），就和样本量为n的情况下的样本均值和样本方差一致了，需要注意的是，总体均值和总体方差有可能是无穷或者不存在的（总体的数据很难得到，只能根据样本来推测总体），但样本均值和样本方差总是存在的。</p>
<p>下面看一些常见的离散型分布</p>
<h2 id="二项分布">二项分布</h2>
<p>先看一个案例描述。</p>
<p>某项考虑有10道题，假定某考生答对每道题的概率是0.6，并假定各个题目的答案独立，而及格的标准则是至少答对6道题，那么至少答对6道题的概率就是事件“通过考试“的概率，这时，如果把答对题目的数目记为X，那么X是一个定量变量，而通过考虑的或者考试及格的概率就可以用以下公式来表示，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180816/k0DhlIhj8m.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>而没有一道题答对的概率为<span class="math inline">\(P(X=0)\)</span>，这就是说10道题都答错，根据题目中的描述，我们知道答错题的概率是0.4，10道全错的概率就是<span class="math inline">\(0.4^{10} \approx 0.0001048576\)</span>，</p>
<p>这个案例中描述的变量就是一个二项分布随机变量，每回答一道题就是一个试验，每次试验成功的概率是固定的，这里是0.6，这10次试验（答10道题）是互相独立的，在重复的独立试验中，如查每个试验仅可能为两种可能结果之一，而且得到相应结果的概率在每次试验中保持不变，则称这些重复独立试验为Bernoulli试验，一般用<span class="math inline">\(p\)</span>和<span class="math inline">\(q=(1-p)\)</span>分别表示每次试验得到的两种结果的概率，这两种结果通常被抽象地称为”成功“和”失败“，这当然不是实际意义上的成功和失败，仅仅是两种结果的代号而已。</p>
<p>人们一般会关心，如果进行n次Bernoulli试验，每次成功的概率是p，那么某中成功次数X=k次的概率是多少？</p>
<p>我们用下面的抽球案例来理解这个问题。</p>
<h3 id="抽球实验">抽球实验</h3>
<p>Bernoulli试验：一个罐子中，含有1个红球，3个蓝球，每次随机取出1个球，观察其颜色，再放回，再抽取下一个球（这是有放回的抽样），每次抽得的红球的概率为p=1/4，蓝球的概率是q=1-p=3/4，用R表示红球的事件，用B表示蓝球的事件，而用P(RB)表示第一次得到的是红球，第二次得到的蓝球的概率等，用X表示在n次试验中观测到红球的次数，下面以n=2和n=3为例说明一下这个概率。</p>
<p>其中下面的这个公式</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180816/59jKHa8hfk.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>它表示从n个元素中选取k个元素的组合数。</p>
<p>现在看n=2的情况。</p>
<p>n=2表示是我们抽取2次，这里面又分3种情况。</p>
<p>第1种情况：2次抽取，抽到0个红球，也就是两次都是蓝球，这种情况的概率如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180801/gcDa8laAGg.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>第2种：2次抽取，刚好有一次观测到红球的概率（这种情况可以理解为，第1次红球，第2次蓝球或第1次蓝球，第2次红球），如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180801/7jlJLk636K.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>第3种：2次抽取，均是红球的概率：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180801/86Hb6fjHDD.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>现在看n=3的情况。</p>
<p>n=3表示是我们抽取3次，这里面又分4种情况。</p>
<p>第1种情况：抽取3次，只有0个红球，概率如下：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180801/8dH4i22F99.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>第2种情况：抽取3次，只抽到1个红球，概率如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180801/BjD76CckKB.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>第3种情况：抽取3次，抽到2个红球，概率如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180801/iK1JlBDjlG.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>第4种情况：抽取3次，抽到3个红球，概率如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180801/DB40kife7i.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>从这个问题的描述中我们可以知道下面的信息：</p>
<p>当n=2时，对于<span class="math inline">\(k=0,1,2,P(X=k)=C_{2}^kp^kq^{2-k}\)</span></p>
<p>当n=3时，对于<span class="math inline">\(k=0,1,2,3,P(X=k)=C_{3}^kp^kq^{3-k}\)</span></p>
<p>因此，我们可以把它们放在一起，如下所示：</p>
<p><span class="math inline">\(P(X=k)=C_{n}^kp^k(1-p)^{n-k},\quad k=0,1,\cdots,n,\)</span></p>
<p>这里的<span class="math inline">\(C_{n}^k\)</span>就是<span class="math inline">\((a+b)^n\)</span>展开的系数，我们把在成功概率为p的n次Bernoulli试验中成功次数X称为具有参数(n,p)的二项分布(binomial distribution)的随机变量，可以用B(n,p)、Bin(n,p)或Binomial(n,p)等表示这样的二项分布，由于参数中的n和p可能取不同的值，因此二项分布是一族分布，称为二项分布族，在n=1时的二项分布又称为bernoulli分布，它的概率分布如下所示：</p>
<p><span class="math inline">\(P(X=1)=p,\quad P(X=0)=1-p\)</span></p>
<p>可以利用排列组合和二项式展开的性质证明：二项分布Binomial(n,p)变量的总体均值为<span class="math inline">\(\mu=np\)</span>，方差为<span class="math inline">\(\delta^2=np(1-p)\)</span>，标准差为<span class="math inline">\(\delta=\sqrt{np(1-np)}\)</span>。</p>
<p>下图就是二项分布Binomial(5,p)的图，这里p取0.1，0.2，，，一直到0.9，可以看出，当p=0.5时，分布是对称的，当p为0.1或0.9时，分布概率偏向左边或右边，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">k &lt;- seq(<span class="number">0.1</span>,<span class="number">0.9</span>,<span class="number">0.1</span>)</div><div class="line">par(mfrow=c(<span class="number">3</span>,<span class="number">3</span>))</div><div class="line"><span class="keyword">for</span>(i <span class="keyword">in</span> <span class="number">1</span>:<span class="number">9</span>)</div><div class="line">  barplot(dbinom(<span class="number">0</span>:<span class="number">5</span>,<span class="number">5</span>,k[i]),xlab=<span class="string">"x"</span>,</div><div class="line">          ylab=<span class="string">"Probability"</span>,</div><div class="line">          ylim=c(<span class="number">0</span>,<span class="number">0.6</span>),</div><div class="line">          main=substitute(Binomial(<span class="number">5</span>,b),</div><div class="line">                          list(b=k[i])))</div></pre></td></tr></table></figure>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180801/6eD3LJkah5.jpg?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>案例分析</p>
<p>假定在一项外语考试中，如果每题有四个选项，只有1个是对的，一共有5道题，这些题目相互独立，如果答题者没有任何知识，全凭随机猜测，那么答对一道题的概率应该是0.25，此时答题就像是一系列bernoulli试验，每次试验成功的概率是0.25，失败的概率为1-0.25=0.75，如果用X表示答对的题目，则X可以看成是参数为n=5，p=0.25的二项分布，下表就给出了对于k=0,1,2,3,4,5，X的概率分布函数P(X=k)和累积分布函数<span class="math inline">\(P(X\leq x)\)</span>，如下所示：</p>
<table>
<thead>
<tr class="header">
<th>k</th>
<th>0</th>
<th>1</th>
<th>2</th>
<th>3</th>
<th>4</th>
<th>5</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(P(X=k)\)</span></td>
<td>0.2373</td>
<td>0.3955</td>
<td>0.2637</td>
<td>0.08789</td>
<td>0.01465</td>
<td>0.00098</td>
</tr>
<tr class="even">
<td><span class="math inline">\(P(X\leq x)\)</span></td>
<td>0.2373</td>
<td>0.6328</td>
<td>0.8965</td>
<td>0.98438</td>
<td>0.99902</td>
<td>1</td>
</tr>
</tbody>
</table>
<p>此时，<span class="math inline">\(P(X=k)=C_{5}^k\times0.25^k\times0.75^{5-k},\quad k=0,1,2,3,4,5\)</span></p>
<p>下图的左图显示的是概率分布图，下图的右图是累积分布函数图，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">par(mfrow=c(<span class="number">1</span>,<span class="number">2</span>))</div><div class="line">x &lt;- dbinom(<span class="number">0</span>:<span class="number">5</span>,<span class="number">5</span>,<span class="number">0.25</span>)</div><div class="line">barplot(x,xlab=<span class="string">"X"</span>,</div><div class="line">        ylab=<span class="string">"Probability Function"</span>,</div><div class="line">        ylim=c(<span class="number">0</span>,<span class="number">0.4</span>),</div><div class="line">        main=<span class="string">"Binomial(5,0.25)"</span>)</div><div class="line">plot(<span class="number">0</span>:<span class="number">5</span>,pbinom(<span class="number">0</span>:<span class="number">5</span>,<span class="number">5</span>,<span class="number">0.25</span>),</div><div class="line">     ylim = c(<span class="number">0</span>,<span class="number">1</span>),</div><div class="line">     type=<span class="string">"s"</span>,</div><div class="line">     xlab=<span class="string">"X"</span>,</div><div class="line">     ylab=<span class="string">"Cumulative Distribution Function"</span>,</div><div class="line">     main=<span class="string">"Binomial(5,0.25)"</span>)</div><div class="line">points(<span class="number">0</span>:<span class="number">5</span>,pbinom(<span class="number">0</span>:<span class="number">5</span>,<span class="number">5</span>,<span class="number">0.25</span>))</div></pre></td></tr></table></figure>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190329101830.png">

</div>
<h2 id="多项分布">多项分布</h2>
<p>二项分布是基于每次的实验有两个可能结果的重复独立Bernoulli试验，如果把二项分布进行拓展，例如每次实验不是有2个结果，而有k个结果，并且针对每个结果的概率分别为<span class="math inline">\((p_{1},p_{2},\cdots,p_{k})\)</span>，并且这些概率都是固定的，其实可以简单地理解为掷骰子，这样在n次实验中，得到的k个可能的结果数目为<span class="math inline">\((X_{1},X_{2},\cdots,X_{k})\)</span>的概率分布为多项分布（multinomial distribution），显然约束条件为：</p>
<p><span class="math inline">\(X_{1}+X_{2}+\cdots+X_{k}=n\)</span></p>
<p><span class="math inline">\(p_{1}+p_{2}+\cdots+p_{k}=1\)</span></p>
<p>多项分布可以用<span class="math inline">\(M(n,p_{1},\cdots,p_{k})\)</span>表示，多项分布为多元分布，也就是说我们感兴趣的随机变量有k个<span class="math inline">\((X_{1},X_{2},\cdots,X_{k})\)</span>，这是一个k维随机向量，如果用<span class="math inline">\(P(X_{1}=n_{1},X_{2}=n_{2},\cdots,X_{k}=n_{k})=p(n_{1},\cdots,n_{k})\)</span>代表多项分布k的可能结果在n次试验中分别出现<span class="math inline">\(n_{1},\cdots,n_{k}\)</span>次的概率，而<span class="math inline">\(p_{1},\cdots,p_{k}\)</span>分别为一次试验时各种结果出现的概率，于是多项分布可以用下面的公式来表示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180801/FaGcCAi3lD.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>其中下面就是多项式系数：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180801/1GACKGGb94.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>它就是多项式展开，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180801/5m93JHA38h.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>多面项分布的一个典型就是掷骰子，此时k=6，而对于一个正常的骰子来说，每掷一次，它的6个面朝上的概率是一样的，即<span class="math inline">\(p_{1}=p_{2}=\cdots =p_{k}=1/6\)</span>，显然，多项分布是一个分布族，用不同的参数来区分。</p>
<h2 id="超几何分布">超几何分布</h2>
<p>超几何分布是一种离散概率分布，它描述的是不放回抽样的问题。例如在一批产品里，一共有N件产品，其中有M件次品，那么当我们任何取n件产品，其中恰有X件次品的概率P就可以按归照下面的公式进行计算：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180721/6bed6CC66m.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>其实超几何分布就是不放回的Bernoulli试验。此处我们回忆一下二项分布，如下所示：</p>
<blockquote>
<p>二项分布：一个罐子里有m个白球，n个黑球，如果每次随机取出1个，记录下颜色后放回，重复这样的试验就形成了一系列独立的Bernoulli试验，每次摸到白球的概率是p=m/(m=n)，在取了k次后，取到白球的总次数X就服从参数k和p的二项分布。</p>
</blockquote>
<p>如果我们不放回白球，我们在取了k后后，取到白球的总次数X就服从超几何分布(hypergeometric distribution)。</p>
<p>R语言中与超几何分布有关的函数为<code>phyper</code>，<code>dhyper</code>，<code>rhyper</code>，<code>qhyper</code>。</p>
<p>其中dhyper的参数为dhyper(x, m, n, k)，这几个参数的含义如下所示： x：从一个含有白球和黑球的盒子里不放回取出的白球数目。 m：白球的数量 n：黑球的数量 k：抽取的次数</p>
<h3 id="超几何分布的计算">超几何分布的计算</h3>
<p>现在计算一下，有100个白球，400个黑球，不放回取50个球，有10个白球的概率，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; dhyper(<span class="number">10</span>,<span class="number">100</span>,<span class="number">400</span>,<span class="number">50</span>,log = <span class="literal">FALSE</span>)</div><div class="line">[<span class="number">1</span>] <span class="number">0.1474</span></div></pre></td></tr></table></figure>
<p>现在计算一下，有100个白球，400个黑球，不放回取50个球，小于等于10个白球的概率，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; phyper(<span class="number">10</span>, <span class="number">100</span>, <span class="number">400</span>, <span class="number">50</span>)</div><div class="line">[<span class="number">1</span>] <span class="number">0.5851</span></div></pre></td></tr></table></figure>
<h3 id="超几何分布的概率密度曲线">超几何分布的概率密度曲线</h3>
<p>现在绘制超几何分布的概率密度曲线，如下所示：</p>
<p>参数说明：其中N表示的是总的球的数目，即<code>N=m+n</code>，这里设定的数目是500个，k表示抽取的次数，这里分别绘制了白球为100个抽取50次，白球为200个抽取60次，白球为300个抽取70次的情况，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">set.seed(<span class="number">1000</span>)</div><div class="line">x&lt;-seq(<span class="number">0</span>,<span class="number">50</span>)</div><div class="line">y1&lt;-dhyper(x,<span class="number">100</span>, <span class="number">400</span>, <span class="number">50</span>)</div><div class="line">y2&lt;-dhyper(x,<span class="number">200</span>, <span class="number">300</span>, <span class="number">60</span>)</div><div class="line">y3&lt;-dhyper(x,<span class="number">300</span>, <span class="number">200</span>, <span class="number">70</span>)</div><div class="line">plot(x,y1)</div><div class="line">plot(x,y1,col=<span class="string">"red"</span>,ylab=<span class="string">"density"</span>,</div><div class="line">     xlim=c(<span class="number">0</span>,<span class="number">55</span>),xlab=<span class="string">""</span>,</div><div class="line">     main=<span class="string">"Hypergeometric distribution"</span>)</div><div class="line">lines(x,y1,col=<span class="string">"red"</span>)</div><div class="line">points(x,y2,col=<span class="string">"blue"</span>)</div><div class="line">lines(x,y2,col=<span class="string">"blue"</span>)</div><div class="line">points(x,y3,col=<span class="string">"orange"</span>)</div><div class="line">lines(x,y3,col=<span class="string">"orange"</span>)</div><div class="line">legend(<span class="string">"topright"</span>,legend=paste(<span class="string">"N="</span>,c(<span class="number">500</span>,<span class="number">500</span>,<span class="number">500</span>),</div><div class="line">                               <span class="string">"k="</span>,c(<span class="number">50</span>,<span class="number">60</span>,<span class="number">70</span>)),</div><div class="line">       lwd=<span class="number">1</span>,col=c(<span class="string">"red"</span>,<span class="string">"blue"</span>,<span class="string">"orange"</span>))</div></pre></td></tr></table></figure>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180720/4EjkaG80Km.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h3 id="超几何分布的概率积累分布曲线">超几何分布的概率积累分布曲线</h3>
<p>现在绘制超几何分布的概率积累分布曲线，参数说明：其中N表示的是总的球的数目，即<code>N=m+n</code>，这里设定的数目是500个，k表示抽取的次数，这里分别绘制了白球为100个抽取50次，白球为200个抽取60次，白球为300个抽取70次的情况，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">set.seed(<span class="number">1000</span>)</div><div class="line">x&lt;-seq(<span class="number">0</span>,<span class="number">50</span>)</div><div class="line">y1&lt;-phyper(x,<span class="number">100</span>, <span class="number">400</span>, <span class="number">50</span>)</div><div class="line">y2&lt;-phyper(x,<span class="number">200</span>, <span class="number">300</span>, <span class="number">60</span>)</div><div class="line">y3&lt;-phyper(x,<span class="number">300</span>, <span class="number">200</span>, <span class="number">70</span>)</div><div class="line">plot(x,y1)</div><div class="line">plot(x,y1,col=<span class="string">"red"</span>,ylab=<span class="string">"density"</span>,</div><div class="line">     xlim=c(<span class="number">0</span>,<span class="number">55</span>),xlab=<span class="string">""</span>,</div><div class="line">     main=<span class="string">"Hypergeometric Cumulative distribution"</span>)</div><div class="line">lines(x,y1,col=<span class="string">"red"</span>)</div><div class="line">points(x,y2,col=<span class="string">"blue"</span>)</div><div class="line">lines(x,y2,col=<span class="string">"blue"</span>)</div><div class="line">points(x,y3,col=<span class="string">"orange"</span>)</div><div class="line">lines(x,y3,col=<span class="string">"orange"</span>)</div><div class="line">legend(<span class="string">"bottomright"</span>,legend=paste(<span class="string">"N="</span>,c(<span class="number">500</span>,<span class="number">500</span>,<span class="number">500</span>),</div><div class="line">                               <span class="string">"k="</span>,c(<span class="number">50</span>,<span class="number">60</span>,<span class="number">70</span>)),</div><div class="line">       lwd=<span class="number">1</span>,col=c(<span class="string">"red"</span>,<span class="string">"blue"</span>,<span class="string">"orange"</span>))</div></pre></td></tr></table></figure>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180720/GIlFbbElB8.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>案例分析</p>
<p>假定在一个20个人的研究生班中，有12个女生（用m表示，即m=12），有8个男生（用n表示，即n=8），因此，女生的比例是60%，如果随机抽取10个学生进行论文主审查，那么X=8篇女生的论文被抽中的概率是多少呢？</p>
<p>按照超几何分布Hyper(12,8,10)来计算，容易得出，其概率为0.0750，如果按照二项分布Binomial(10,0.6)来计算，则得出的概率是0.1209，显然这两种计算的差异很大，但是如果有120个女生和80个男生，那么随机抽取10个学生的论文，其中有8篇是女生的论文的概率就基本上差不多了，用超几何分布过计算，此概率是0.1183，用二项分布来计算，是0.1209。</p>
<p>现在计算一下这两个概率。</p>
<p>第1个概率（女生12个，男生8个），如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&gt; m=<span class="number">12</span>;n=<span class="number">8</span>;k=<span class="number">10</span>;x=<span class="number">8</span></div><div class="line">&gt; dhyper(x,m,n,k)</div><div class="line">[<span class="number">1</span>] <span class="number">0.07501786</span></div><div class="line">&gt; dbinom(x,k,m/(m+n))</div><div class="line">[<span class="number">1</span>] <span class="number">0.1209324</span></div></pre></td></tr></table></figure>
<p>dhyper的参数前面了解了，现在看一下dbinom的参数，它的参数有3个，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">dbinom(x, size, prob, log = <span class="literal">FALSE</span>)</div></pre></td></tr></table></figure>
<p>其中x表示目标事件的次数，我们的目标事件是”论文中是女生论文“，目标次数是8篇，此处x就等于8，k表示抽样的次数，这里是取了10个同学，prob表示目标事件的概率，我们的目标事件是”论文中是女生论文“，因此这个prob此处为0.6，也就是m/(m+n)。</p>
<p>现在扩大一下样本，女生120个，男生80个，抽10份论文，女生论文是8篇的概率，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&gt; m=<span class="number">120</span>;n=<span class="number">80</span>;k=<span class="number">10</span>;x=<span class="number">8</span></div><div class="line">&gt; dhyper(x,m,n,k)</div><div class="line">[<span class="number">1</span>] <span class="number">0.1182677</span></div><div class="line">&gt; dbinom(x,k,m/(m+n))</div><div class="line">[<span class="number">1</span>] <span class="number">0.1209324</span></div></pre></td></tr></table></figure>
<p>在这个案例中，我们研究的是具体的某个事件的概率，也就是抽到女生论文是8篇的概率，如果我们要研究至少投到8篇是女生论文的概率，那么就需要求出8，9，10篇是女生论文的概率之和（女生人数为120人，男生80个），如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; dhyper(<span class="number">8</span>,<span class="number">120</span>,<span class="number">80</span>,<span class="number">10</span>)+dhyper(<span class="number">9</span>,<span class="number">120</span>,<span class="number">80</span>,<span class="number">10</span>)+dhyper(<span class="number">10</span>,<span class="number">120</span>,<span class="number">80</span>,<span class="number">10</span>)</div><div class="line">[<span class="number">1</span>] <span class="number">0.1606976</span></div></pre></td></tr></table></figure>
<p>这里使用到了一个phyper函数，它的用法如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">phyper(q, m, n, k, lower.tail = TRUE, log.p = FALSE)</div></pre></td></tr></table></figure>
<p>q就是目标事件的次数，这里是8，因此使用这个函数计算出来的结果其实就是，抽取10篇，其中小于等于8篇是女生论文的概率，因此这个概率并不是我们想要的，我们想要的概率是至少8篇是女生论文的概率，也就是8，9，10篇。因此，此处我们计算出小于等于7篇是女生论文的概率，再用1减去就是我们要想的概率，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; <span class="number">1</span>-phyper(<span class="number">7</span>,m,n,k)</div><div class="line">[<span class="number">1</span>] <span class="number">0.1606976</span></div></pre></td></tr></table></figure>
<p>现在用dhyper函数来验证下，分别计算出8，9，10篇是女生论文的概率，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">&gt; dhyper(<span class="number">8</span>,m,n,k)</div><div class="line">[<span class="number">1</span>] <span class="number">0.1182677</span></div><div class="line">&gt; dhyper(<span class="number">9</span>,m,n,k)</div><div class="line">[<span class="number">1</span>] <span class="number">0.03726013</span></div><div class="line">&gt; dhyper(<span class="number">10</span>,m,n,k)</div><div class="line">[<span class="number">1</span>] <span class="number">0.005169843</span></div><div class="line">&gt; dhyper(<span class="number">8</span>,m,n,k)+dhyper(<span class="number">9</span>,m,n,k)+dhyper(<span class="number">10</span>,m,n,k)</div><div class="line">[<span class="number">1</span>] <span class="number">0.1606976</span></div></pre></td></tr></table></figure>
<p>结果是一样的。</p>
<h2 id="二项分布与超几何分布的联系与区别">二项分布与超几何分布的联系与区别</h2>
<p>在抽样调查的实践中，一般不会重复调查同一个人，这相当于不放回抽样。严格来说应该用超几何分布来描述，但对于很大的总体，通常都考虑二项分布模型。这是因为，在一个很大的一群人中进行随机调查，就相当于从有大量黑白球的罐子中摸球，无论是放回抽样，还是不放回抽样，抽样时待抽取的黑白球所点的比例不会有显著的区别，由于二项分布计算简单，所以都用二项分布来近似。但是如果仅仅在一个人数不多的单位中进行调查，就相当于上面的不放回摸球，而且由于球的总数不多，每次抽样后，待抽取的黑白球所占的比例变化会很大，因此就应该考虑用超几何分布。</p>
<p>附图：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190329103227.png">

</div>
<h2 id="负二项分布">负二项分布</h2>
<h2 id="poisson分布">Poisson分布</h2>
<p>在二战中，德国的导弹不断袭击英国，为了研究导弹袭击的规律，英国的统计学家R.D. Clarke把一个地区划分为许多小块，使得每个小块被击中的概率极小，在袭击是随机的假定下，各个小块被击中的概率在整个区域假定是一个常数，这样，一个小块被南路的次数就大致相当于在大量重复的成功概率很小的独立Bernoulli试验中成功的次数，他于是就导出了Poisson分布，而实际观测的导弹袭击的频数和用Poisson分布预测的频率相当吻合，在许多事件中，例如某种疾病的发生数目，一个自动生产线出现的废品数，某种事故发生的数目等，只要出现一次的概率很小，一般被看成近似地服从Poisson分布，Poisson分布的总体参数是其均值，而且其总体均值和总体方差相等，这里用λ表示该总体均值，Poission分布常用P(λ)或Poisson(λ)表示，此分布P(λ)的概率分布为：对于<span class="math inline">\(x=0,1,\cdots\)</span>，以及<span class="math inline">\(\lambda&gt;0\)</span>，有：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180814/29871IeHg8.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>下图就是参数为3、6、10的Poission分布图（只标出了20之内的部分），Poisson分布是一个分布族，其成员用不同的λ来区分，若干个独立的Poisson分布变量的和也服从Poisson分布，其参数等于那些Poisson分布的参数之和。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">x&lt;-<span class="number">0</span>:<span class="number">20</span></div><div class="line">z&lt;-cbind(dpois(x,<span class="number">3</span>),dpois(x,<span class="number">6</span>),dpois(x,<span class="number">10</span>))</div><div class="line">matplot(x,z,</div><div class="line">        pch=c(<span class="number">19</span>,<span class="number">8</span>,<span class="number">17</span>),</div><div class="line">        cex=<span class="number">1.5</span>,</div><div class="line">        xlab=<span class="string">"x"</span>,ylab=<span class="string">"P(X=x)"</span>,</div><div class="line">        col=<span class="number">1</span>,</div><div class="line">        main=<span class="string">"Poisson Distribution"</span>,</div><div class="line">        type=<span class="string">"b"</span>)</div><div class="line">legend(<span class="number">15</span>,<span class="number">0.23</span>,</div><div class="line">       c(<span class="string">"P(3)"</span>,<span class="string">"P(6)"</span>,<span class="string">"P(10)"</span>),</div><div class="line">       cex=<span class="number">1.5</span>,</div><div class="line">       pch=c(<span class="number">19</span>,<span class="number">8</span>,<span class="number">17</span>),</div><div class="line">       col=<span class="number">1</span>)</div></pre></td></tr></table></figure>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190329102846.png">

</div>
<p>正如前面的导弹袭击案例所说，当Bernoulli试验的次数很大，而每次成功概率很小时，可以用Poisson分布来近似二项分布，数学上，如果二项分布Binomial(n,p)的p趋于0，而np趋于常数λ时，该二项分布则趋于Poisson分布P(λ)，由于当n很大，以及p很小时，二项分布计算很麻烦，因此在计算机出现之前，人们在计算概率时，往往用P(np)来对二项分布Binomial(n,p)做近似。</p>
<p>看一个案例，现在使用不同的n（例如取值10，100，1000，10000，100000，这里的n就是试验次数）和p（例如取值0.1，0.01，0.001，0.0001，0.00001，这里的p就是某事件发生的概率）分别利用二项分布和Poisson分布近似来计算X=2的概率，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">&gt; n&lt;-c(<span class="number">10</span>,<span class="number">100</span>,<span class="number">1000</span>,<span class="number">10000</span>,<span class="number">100000</span>)</div><div class="line">&gt; p&lt;-c(<span class="number">0.1</span>,<span class="number">0.01</span>,<span class="number">0.001</span>,<span class="number">0.0001</span>,<span class="number">0.00001</span>)</div><div class="line">&gt; cbind(dbinom(<span class="number">2</span>,n,p),dpois(<span class="number">2</span>,n*p))</div><div class="line">          [,<span class="number">1</span>]      [,<span class="number">2</span>]</div><div class="line">[<span class="number">1</span>,] <span class="number">0.1937102</span> <span class="number">0.1839397</span></div><div class="line">[<span class="number">2</span>,] <span class="number">0.1848648</span> <span class="number">0.1839397</span></div><div class="line">[<span class="number">3</span>,] <span class="number">0.1840317</span> <span class="number">0.1839397</span></div><div class="line">[<span class="number">4</span>,] <span class="number">0.1839489</span> <span class="number">0.1839397</span></div><div class="line">[<span class="number">5</span>,] <span class="number">0.1839406</span> <span class="number">0.1839397</span></div></pre></td></tr></table></figure>
<p>从上面的这个结果我们可以看到，随着试验次数的增加，以及p值的降低，那么二项分布与Poisson的结果就非常接近了。</p>
<h2 id="正态分布">正态分布</h2>
<p>正态分布内容参见这篇笔记《正态分布笔记》</p>
<h2 id="伽玛分布gamma分布">伽玛分布（<span class="math inline">\(\Gamma\)</span>分布）</h2>
<p>这里介绍伽玛分布是因为它与卡方分布和指数分布有关，卡方分布与指数分布可以视为一种特殊的伽玛分布。</p>
<p>许多随机变量，例如计算机使用寿命的长度，假定仅取非负值，这种类型数据的相对频率分布通过用<span class="math inline">\(\Gamma\)</span>型密度函数建模，<span class="math inline">\(\Gamma\)</span>密度函数公式如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180817/all92Geej8.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>其中，</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180817/3KKfkDm5jG.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p><span class="math inline">\(\Gamma\)</span>型随机变量的均值和方差分别如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180817/1lblKmkJG6.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>当α是正整数时，可以证明（略）Γ(α)=(α-1)Γ(α-1)以及Γ(α)=(α-1)！</p>
<p>Γ密度函数公式中包含两个参数α和β，参数β称作尺度参数，反映了Y度量单位的大小（它和出现在正态密度函数公式中的参数σ有相同的功能），参数α称作形状参数，改变它的值会改变Γ分布的形状，这就使得我们在建立试验数据的相对频率分布模型时，能得到许多不同形状的密度函数，下图就给出了α=1,3和5，β=1时的Γ密度函数图形：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">set.seed(<span class="number">1</span>)</div><div class="line">x&lt;-seq(<span class="number">0</span>,<span class="number">10</span>,length.out=<span class="number">100</span>)</div><div class="line">y1&lt;-data.frame(x,y=dgamma(x,<span class="number">1</span>,<span class="number">1</span>),g=<span class="string">"alpha=1,beta=1"</span>)</div><div class="line">y3&lt;-data.frame(x,y=dgamma(x,<span class="number">3</span>,<span class="number">1</span>),g=<span class="string">"alpha=3,beta=1"</span>)</div><div class="line">y5&lt;-data.frame(x,y=dgamma(x,<span class="number">5</span>,<span class="number">1</span>),g=<span class="string">"alpha=5,beta=1"</span>)</div><div class="line"></div><div class="line">y&lt;-sqldf(<span class="string">"</span></div><div class="line"><span class="string">         select x,y,g from y1</span></div><div class="line"><span class="string">         union all</span></div><div class="line"><span class="string">         select x,y,g from y3</span></div><div class="line"><span class="string">         union all</span></div><div class="line"><span class="string">         select x,y,g from y5"</span>)</div><div class="line"></div><div class="line">ggplot(y,aes(x=x,y=y,group=factor(g),colour=factor(g)))+geom_line()</div></pre></td></tr></table></figure>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190329102749.png">

</div>
<p>以下是累积分布函数密度图，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">set.seed(<span class="number">1</span>)</div><div class="line">x&lt;-seq(<span class="number">0</span>,<span class="number">10</span>,length.out=<span class="number">100</span>)</div><div class="line">y1&lt;-data.frame(x,y=pgamma(x,<span class="number">1</span>,<span class="number">1</span>),g=<span class="string">"alpha=1,beta=1"</span>)</div><div class="line">y3&lt;-data.frame(x,y=pgamma(x,<span class="number">3</span>,<span class="number">1</span>),g=<span class="string">"alpha=3,beta=1"</span>)</div><div class="line">y5&lt;-data.frame(x,y=pgamma(x,<span class="number">5</span>,<span class="number">1</span>),g=<span class="string">"alpha=5,beta=1"</span>)</div><div class="line"></div><div class="line">y&lt;-sqldf(<span class="string">"</span></div><div class="line"><span class="string">         select x,y,g from y1</span></div><div class="line"><span class="string">         union all</span></div><div class="line"><span class="string">         select x,y,g from y3</span></div><div class="line"><span class="string">         union all</span></div><div class="line"><span class="string">         select x,y,g from y5"</span>)</div><div class="line"></div><div class="line">ggplot(y,aes(x=x,y=y,group=factor(g),colour=factor(g)))+geom_line()</div></pre></td></tr></table></figure>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190329102814.png">

</div>
<p>除了α作为整数的特殊情况外，我们不能得到Γ密度函数积分的显式表示，因此Γ随机变量的累积分布函数称作不完全Γ函数，必须在计算机帮助下用近似方法得到，在统计学中，重要的Γ型随机变量是卡方随机变量。</p>
<p>卡方随机变量是α=ν/2和β=2的Γ型随机变量，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180817/ac51g6IjEK.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>其中，</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180817/A89BLKGgFK.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>卡方随机变量的均值和方差分别为：<span class="math inline">\(\mu=\nu \quad \delta^2=2\nu\)</span>，参数<span class="math inline">\(\nu\)</span>称为卡方分布的自由度个数。</p>
<h2 id="指数分布">指数分布</h2>
<p>指数分布可以用来描述电子产品的寿命，例如一个灯光的平均寿命是2500个小时，我们要叫嚷认为这个灯泡的寿命服从均值为2500的指数分布，如果一个变量x服从指数分布，就记为<span class="math inline">\(~exp(\lambda)\)</span>，其中<span class="math inline">\(\lambda\)</span>等于均值的倒数。</p>
<p>在R中，生成指数分布随机数的函数是<code>rexp()</code>，其用法是<code>rexp(n,lambda = 1)</code>，其中n表示生成的随机数，<code>lambda=1/mean</code>，例如：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">x &lt;- rexp(<span class="number">100</span>,<span class="number">1</span>/<span class="number">10</span>)</div><div class="line">hist(x,prob=<span class="literal">T</span>,col=gray(<span class="number">0.9</span>),main=<span class="string">"均值为10的指数分布随机数"</span>)</div><div class="line">curve(dexp(x,<span class="number">1</span>/<span class="number">10</span>),add=<span class="literal">T</span>)</div></pre></td></tr></table></figure>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190329102539.png">

</div>
<p>使用<code>rexp()</code>和逆变换法生成<code>X~Exp(1)</code>的随机数，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">Nsim = <span class="number">10000</span></div><div class="line">U &lt;- runif(Nsim)</div><div class="line">x = -log(U)</div><div class="line">y &lt;- rexp(Nsim)</div><div class="line">par(mfrow=c(<span class="number">1</span>,<span class="number">2</span>))</div><div class="line">hist(x,freq=<span class="literal">F</span>,main=<span class="string">"Exp from Uniform"</span>)</div><div class="line">curve(dexp(x,<span class="number">1</span>),add=<span class="literal">T</span>,col=<span class="string">"red"</span>)</div><div class="line">hist(y,freq=<span class="literal">F</span>,main=<span class="string">"Exp from R"</span>)</div><div class="line">curve(dexp(x,<span class="number">1</span>),add=<span class="literal">T</span>,col=<span class="string">"red"</span>)</div></pre></td></tr></table></figure>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190329102513.png">

</div>
<h2 id="卡方分布">卡方分布</h2>
<p>正态分布内容参见这篇笔记<a href="http://rvdsd.top/2017/06/06/BioStatistics/%E7%94%9F%E7%89%A9%E7%BB%9F%E8%AE%A1-08%E5%8D%A1%E6%96%B9%E5%88%86%E6%9E%90%E4%B8%8E%E5%8D%A1%E6%96%B9%E5%88%86%E5%B8%83/">《卡方检验》</a>。</p>
<h2 id="t分布">t分布</h2>
<p>正态分布内容参见这篇笔记<a href="http://rvdsd.top/2017/06/03/BioStatistics/%E7%94%9F%E7%89%A9%E7%BB%9F%E8%AE%A1-03-T%E5%88%86%E5%B8%83%E4%B8%8E%E6%A3%80%E9%AA%8C/">《T分布与t检验》</a>。</p>
<h2 id="f分布">F分布</h2>
<p>F-分布（F-distribution）是一种连续概率分布，被广泛应用于似然比率检验，特别是ANOVA中。F分布定义为：设X、Y为两个独立的随机变量，X服从自由度为k1的卡方分布，Y服从自由度为k2的卡方分布，这2个独立的卡方分布被各自的自由度除以后的比率这一统计量的分布。用公式表示就是下面的样子：</p>
<p>如果X是<span class="math inline">\(\chi^2(m)\)</span>变量，Y是<span class="math inline">\(\chi^2(n)\)</span>变量，而且X和Y独立，那么就有下面的这个公式，即 <span class="math inline">\(F=\frac{X/m}{Y/n}\)</span> 这个公式可以称为具有自由度(m,n)的F分布，记为F(m,n)，也就是说，两个独立<span class="math inline">\(\chi^2\)</span>分布变量（在除以它们各自的自由度后）的比为F分布变量。</p>
<p>F分布的概率密度函数为：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190329102448.png">

</div>
<p>在F分布中，两个<span class="math inline">\(\chi^2\)</span>分布的自由度则为F分布的自由度，因此，F分布有两个自由度，第一个自由度等于在分子上的<span class="math inline">\(\chi^2\)</span>分布的自由度，第二个自由度等于在分母的<span class="math inline">\(\chi^2\)</span>分布的自由度，下图显著了自由度分别为(3,20)，(10,20)和(50,20)的三条F分布密度曲线：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">x &lt;-c(seq(<span class="number">0</span>,<span class="number">4.5</span>,length=<span class="number">1000</span>))</div><div class="line">y2 &lt;- df(x,<span class="number">50</span>,<span class="number">20</span>)</div><div class="line">y3 &lt;- df(x,<span class="number">10</span>,<span class="number">20</span>)</div><div class="line">y5 &lt;- df(x,<span class="number">3</span>,<span class="number">20</span>)</div><div class="line">plot(x,y2,type=<span class="string">"l"</span>,xlab=<span class="string">""</span>,ylab=<span class="string">""</span>,lty=<span class="number">1</span>,main=<span class="string">""</span>)</div><div class="line">lines(x,y3,type=<span class="string">"l"</span>,xlab=<span class="string">""</span>,ylab=<span class="string">""</span>,lty=<span class="number">2</span>)</div><div class="line">lines(x,y5,type=<span class="string">"l"</span>,xlab=<span class="string">""</span>,ylab=<span class="string">""</span>,lty=<span class="number">3</span>)</div><div class="line">legend(<span class="number">3</span>,<span class="number">1.1</span>,c(<span class="string">"F(50,20)"</span>,<span class="string">"F(10,20)"</span>,<span class="string">"F(3,20)"</span>),lty=<span class="number">1</span>:<span class="number">3</span>)</div><div class="line">text(<span class="number">0</span>,<span class="number">0.6</span>,<span class="string">"F(3,20)"</span>)</div><div class="line">text(<span class="number">0.8</span>,<span class="number">0.85</span>,<span class="string">"F(10,20)"</span>)</div><div class="line">text(<span class="number">1</span>,<span class="number">1.0</span>,<span class="string">"F(50,20)"</span>)</div></pre></td></tr></table></figure>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190329102433.png">

</div>
<p>从图上可以看出，当第二个自由度相时，第一个自由度越小，峰越靠近左边。</p>
<h2 id="均匀分布">均匀分布</h2>
<p>均匀分布(uniform distribution)是最简单的连续型分布，它的聚会范围是一个区间，例如(a,b)，均匀颁同随机变量X聚会在该区间的一个子区间的概率等于该子区间宽度与区间(a,b)宽度b-1的比值，如果区间(a,b)为(0,1)区间，那么X落入(0.3,0.7)的概率为(0.7-0.3)/(1-0)=0.4，显然，均匀分布的密度函数在(a,b)区间为常数1/(b-a)，而在该区间外为零，用公式就是以下表示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190329102417.png">

</div>
<p>这种形状为一个矩形，因此均匀分布也称为矩形分布(rectangular distribution)，定义在(a,b)区间上的均匀分布通常用U(a,b)或Unif(a,b)表示，下图是均匀分布U(0,1)的密度函数（左）和一个来自U(a,b)的样本的直方图（右），如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># uniform distribution</span></div><div class="line">par(mfrow=c(<span class="number">1</span>,<span class="number">2</span>))</div><div class="line">plot(-<span class="number">10</span>,<span class="number">10</span>,xlab=<span class="string">"X"</span>,ylab=<span class="string">""</span>,xlim=c(-<span class="number">0.3</span>,<span class="number">1.3</span>),ylim=c(<span class="number">0</span>,<span class="number">1.2</span>),main=<span class="string">"U(0,1)"</span>)</div><div class="line">segments(-<span class="number">0.3</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>)</div><div class="line">segments(<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>)</div><div class="line">segments(<span class="number">1</span>,<span class="number">0</span>,<span class="number">1.3</span>,<span class="number">0</span>)</div><div class="line">segments(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,lty=<span class="number">2</span>)</div><div class="line">segments(<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,lty=<span class="number">2</span>)</div><div class="line">x&lt;-runif(<span class="number">10000</span>)</div><div class="line">hist(x)</div></pre></td></tr></table></figure>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190329102404.png">

</div>
<h2 id="样本函数的分布">样本函数的分布</h2>
<p>我们希望利用样本，尤其是通过作为样本函数的样本统计量来了解总体，并对总体参数进行推断。这些统计量包括閒贩蛭过的样本均值、样本中位数、样本标准差以及由它们组成的函数。统计量对不同的样本（但有相同的样本量）会取不同的值，作为随机样本的函数，它们也是随机的，也有自己的分布，这些分布就称为抽样分布(sampling distribution)， 我们来看一个案例。 我们有一个正常的色子，看一下每次投掷10次的试验（样本量为10），看一下这个均值的变化，下表记录了15次试验每次得到的结果和该次的样本均值，而和该表相应的左边为15条10个点的拆线，显示了15次共150个点数，右边为掷色子点数的15个均值，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">a &lt;- <span class="literal">NULL</span></div><div class="line"><span class="keyword">for</span> (i <span class="keyword">in</span> <span class="number">1</span>:<span class="number">15</span>)&#123;</div><div class="line">  x &lt;- sample(<span class="number">1</span>:<span class="number">6</span>,<span class="number">10</span>,rep=<span class="literal">T</span>)</div><div class="line">  a &lt;- rbind(a,c(x,mean(x)))&#125;</div><div class="line">par(mfrow=c(<span class="number">1</span>,<span class="number">2</span>))</div><div class="line">matplot(<span class="number">1</span>:<span class="number">10</span>,t(a[,-<span class="number">11</span>]),type=<span class="string">"l"</span>,xlab=<span class="string">""</span>,main=<span class="string">"每次掷10次色子，重复15遍"</span>,ylab=<span class="string">"点数"</span>)</div><div class="line">plot(<span class="number">1</span>:<span class="number">15</span>,a[,<span class="number">11</span>],type=<span class="string">"l"</span>,xlab=<span class="string">""</span>,main=<span class="string">"15个均值（每个来自10次掷色子结果)"</span>,ylab=<span class="string">"点数"</span>,ylim=c(<span class="number">1</span>,<span class="number">6</span>))</div></pre></td></tr></table></figure>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190329102303.png">

</div>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190329102327.png">

</div>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190329102345.png">

</div>
<p>这些样本均值都和真正的总体均值(1+2+3+4+5+6)/6=3.5不完全一样，它们比较稳定，而不像那些原先的150个样本点，显然，这些均值有其自己的分布，与掷色子原先的多项分布不同，这使得人们对这些样本均值的分布感兴趣，前面介绍的<span class="math inline">\(\chi^2\)</span>分布，t分布和F分布都可以是正态分布总体有关的抽样分布。</p>
<h2 id="样本均值的性质和中心极限定理">样本均值的性质和中心极限定理</h2>
<p>我们把前面的掷色子试验的样本量从10增加到5000，而抽取1000个样本（原来是15个），结果得到1000个均值，这些均值的直方图如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">a&lt;-<span class="literal">NULL</span></div><div class="line"><span class="keyword">for</span>(i <span class="keyword">in</span> <span class="number">1</span>:<span class="number">1000</span>)&#123;</div><div class="line">x&lt;-sample(<span class="number">1</span>:<span class="number">6</span>,<span class="number">5000</span>,rep=<span class="literal">T</span>)</div><div class="line">a&lt;-rbind(a,mean(x))&#125;</div><div class="line">hist(a,xlab=<span class="string">""</span>,<span class="number">15</span>,freq=<span class="literal">F</span>)</div><div class="line">lines(density(a))</div><div class="line">rug(a)</div><div class="line">mean(a)</div></pre></td></tr></table></figure>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190329102225.png">

</div>
<p>上图解释：做1000次试验，每次掷5000次色子，这样就得到了1000个均值的直方图，图中的曲线是对这1000个均值的密度估计，下面小的短线标出了这1000个均值的实际位置。</p>
<p>这看上去很像正态分布的形状，这些均值的均值为3.500001，接近掷色子的总体均值3.5。这就意味着，当样本量增加时，多项分布（掷色子）的总体均值或许可能用正态分布来近似。其实，在一定条件下，在样本量趋于无穷时，一般分布的样本均值的分布趋于正态分布，这就是关于样本均值的中心极限定量。</p>
<h2 id="中心极限定理">中心极限定理</h2>
<p>假定随机变量X的n个独立观测值组成一个样本，假定X的总体均值为μ，而总体标准差为σ，这两个总体参数通常是未知的，从这个样本，我们还可以计算样本均值<span class="math inline">\(\bar{x}\)</span>和样本标准差x，当然样本均值可以用来估计μ的值，具体这种估计的好坏，依赖于样本均值有什么样的抽样分布。样本均值作为随机变量有如下性质（注：这里没有假定X的分布）：</p>
<ol style="list-style-type: decimal">
<li>样本均值<span class="math inline">\(\bar{x}\)</span>的抽样分布的总体均值等于μ；</li>
<li>样本均值<span class="math inline">\(\bar{x}\)</span>的抽样分布的总体标准差等于<span class="math inline">\(\delta/\sqrt{n}\)</span>，样本量越大，<span class="math inline">\(\bar{x}\)</span>的集中程度越大；</li>
<li>即使X的分布不是正态，那么在很一般的条件下（中心极限定理成立的一个充分条件是：样本点是独立的，来自一个总体（同一个分布），总体均值存在，并且有非零有限总体方差。），当样本量增加时，<span class="math inline">\(\bar{x}\)</span>的分布走近于正态分布<span class="math inline">\(N(\mu,\delta/\sqrt{n})\)</span>，这就是中心极限定理（CLT,central limit theorem)。</li>
</ol>
<p>把上面第二条中的样本均值<span class="math inline">\(\bar{x}\)</span>的抽样分布的总体标准差公式中的σ换成样本标准差s，得到<span class="math inline">\(s/\sqrt{n}\)</span>就是均值的标准误差(standard error of mean,SEM)，它是对<span class="math inline">\(\delta/\sqrt{n}\)</span>的一个近似。现在我们从U(0,1)，<span class="math inline">\(\chi^2(2)\)</span>和F(0,10)这三种分布对于三种样本量大小n=1，3，100分别取600个样本，再计算出每个样本的均值，这样对每一种样本量都有600个均值，用这些均值画直方图，如下所示，可以看出，样本量越大，均值的直方图就越像正态分布，并且数据的分散程度也越小（越集中）。</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190329102204.png">

</div>
<p>下面代码是《R语言与统计分析》（汤银才）书中的代码来模拟中心极限定理，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">limite.central &lt;- <span class="keyword">function</span>(r=runif,distpar=c(<span class="number">0</span>,<span class="number">1</span>),m=<span class="number">0.5</span>,</div><div class="line">                           s=<span class="number">1</span>/sqrt(<span class="number">12</span>),</div><div class="line">                           n=c(<span class="number">1</span>,<span class="number">3</span>,<span class="number">100</span>),N=<span class="number">600</span>)</div><div class="line">  <span class="keyword">for</span> (i <span class="keyword">in</span> n)&#123;</div><div class="line">    <span class="keyword">if</span> (length(distpar)==<span class="number">2</span>)&#123;</div><div class="line">      x&lt;-matrix(r(i*N,distpar[<span class="number">1</span>],distpar[<span class="number">2</span>]),nc=i)</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">else</span>&#123;</div><div class="line">      x&lt;-matrix(r(i*N,distpar),nc=i)</div><div class="line">    &#125;</div><div class="line">    x&lt;-(apply(x,<span class="number">1</span>,sum)-i*m)/(sqrt(i)*s)</div><div class="line">    hist(x,col=<span class="string">'Light blue'</span>,probability=<span class="literal">T</span>,main=paste(<span class="string">"n="</span>,i),</div><div class="line">         ylim=c(<span class="number">0</span>,max(<span class="number">0.4</span>,density(x)$y)))</div><div class="line">    lines(density(x),col=<span class="string">'red'</span>,lwd=<span class="number">3</span>)</div><div class="line">    curve(dnorm(x),col=<span class="string">'blue'</span>,lwd=<span class="number">3</span>,lty=<span class="number">3</span>,add=<span class="literal">T</span>)</div><div class="line">    <span class="keyword">if</span>(N&gt;<span class="number">100</span>)&#123;</div><div class="line">      rug(sample(x,<span class="number">100</span>))</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">else</span>&#123;</div><div class="line">      rug(x)</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line"></div><div class="line"></div><div class="line">op &lt;- par(mfrow=c(<span class="number">1</span>,<span class="number">3</span>))</div><div class="line">limite.central(runif,distpar = c(<span class="number">0</span>,<span class="number">1</span>))</div><div class="line"></div><div class="line">op &lt;- par(mfrow=c(<span class="number">1</span>,<span class="number">3</span>))</div><div class="line">limite.central(rchisq,distpar = c(<span class="number">2</span>))</div><div class="line"></div><div class="line">op &lt;- par(mfrow=c(<span class="number">1</span>,<span class="number">3</span>))</div><div class="line">limite.central(rf,distpar = c(<span class="number">2</span>,<span class="number">10</span>))</div></pre></td></tr></table></figure>
<p>均匀分布：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190329102026.png">

</div>
<p>卡方分布：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190329102101.png">

</div>
<p>F分布：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190329102135.png">

</div>
<h2 id="参考资料">参考资料</h2>
<ol style="list-style-type: decimal">
<li><a href="http://blog.sina.com.cn/s/blog_670445240101m4z3.html" target="_blank" rel="external">每日一生信–富集分析（超几何分布）（Fisher’s Exact Test）</a></li>
<li><a href="http://blog.sina.com.cn/s/blog_5d1edf6a0100ujcv.html" target="_blank" rel="external">R 超几何分布</a></li>
<li><a href="https://en.wikipedia.org/wiki/Hypergeometric_distribution" target="_blank" rel="external">Wikipedia:Hypergeometric distribution</a></li>
<li>DawnGriffiths. 深入浅出统计学[M]. 电子工业出版社, 2012.</li>
<li>高桥信陈刚. 漫画统计学[M]. 科学出版社, 2009.</li>
<li>拉里·戈尼克, 沃尔科特·史密斯. 漫画统计学入门[M]. 辽宁教育出版社, 2002.</li>
<li>陈希孺.概率论与数理统计[M].中国科学技术大学出版社,1992.</li>
<li><a href="http://blog.fens.me/r-density/" target="_blank" rel="external">常用连续型分布介绍及R语言实现</a></li>
<li><a href="https://zhuanlan.zhihu.com/p/32932782" target="_blank" rel="external">一张图说明二项分布、泊松分布、指数分布、几何分布、负二项分布、伽玛分布的联系</a></li>
</ol>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/数据分布/" <i class="fa fa-tag"></i> 数据分布</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2017/06/03/BioStatistics/生物统计-03假设检验笔记/" rel="next" title="假设检验笔记">
                <i class="fa fa-chevron-left"></i> 假设检验笔记
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2017/06/05/BioStatistics/生物统计-07协方差分析/" rel="prev" title="协方差分析笔记">
                协方差分析笔记 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  
    <div class="comments" id="comments">
      <div id="vcomments"></div>
    </div>
  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">RVDSD</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">146</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">13</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">38</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          <div class="links-of-author motion-element">
            
          </div>

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#前言"><span class="nav-number">1.</span> <span class="nav-text">前言</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#离散型分布"><span class="nav-number">2.</span> <span class="nav-text">离散型分布</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#二项分布"><span class="nav-number">3.</span> <span class="nav-text">二项分布</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#抽球实验"><span class="nav-number">3.1.</span> <span class="nav-text">抽球实验</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#多项分布"><span class="nav-number">4.</span> <span class="nav-text">多项分布</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#超几何分布"><span class="nav-number">5.</span> <span class="nav-text">超几何分布</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#超几何分布的计算"><span class="nav-number">5.1.</span> <span class="nav-text">超几何分布的计算</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#超几何分布的概率密度曲线"><span class="nav-number">5.2.</span> <span class="nav-text">超几何分布的概率密度曲线</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#超几何分布的概率积累分布曲线"><span class="nav-number">5.3.</span> <span class="nav-text">超几何分布的概率积累分布曲线</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#二项分布与超几何分布的联系与区别"><span class="nav-number">6.</span> <span class="nav-text">二项分布与超几何分布的联系与区别</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#负二项分布"><span class="nav-number">7.</span> <span class="nav-text">负二项分布</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#poisson分布"><span class="nav-number">8.</span> <span class="nav-text">Poisson分布</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#正态分布"><span class="nav-number">9.</span> <span class="nav-text">正态分布</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#伽玛分布gamma分布"><span class="nav-number">10.</span> <span class="nav-text">伽玛分布（\(\Gamma\)分布）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#指数分布"><span class="nav-number">11.</span> <span class="nav-text">指数分布</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#卡方分布"><span class="nav-number">12.</span> <span class="nav-text">卡方分布</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#t分布"><span class="nav-number">13.</span> <span class="nav-text">t分布</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#f分布"><span class="nav-number">14.</span> <span class="nav-text">F分布</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#均匀分布"><span class="nav-number">15.</span> <span class="nav-text">均匀分布</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#样本函数的分布"><span class="nav-number">16.</span> <span class="nav-text">样本函数的分布</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#样本均值的性质和中心极限定理"><span class="nav-number">17.</span> <span class="nav-text">样本均值的性质和中心极限定理</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#中心极限定理"><span class="nav-number">18.</span> <span class="nav-text">中心极限定理</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#参考资料"><span class="nav-number">19.</span> <span class="nav-text">参考资料</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

<div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">RVDSD</span>

  
</div>



<div class="powered-by">
<i class="fa fa-user-md"></i><span id="busuanzi_container_site_pv">
  本站访客数:<span id="busuanzi_value_site_uv"></span>
</span>
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.3</div>




<div class="theme-info">
  <div class="powered-by"></div>
  <span class="post-count">博客全站共548.6k字</span>
</div>

        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.3"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.3"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.3"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.3"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.3"></script>



  


  




	





  





  












  





  

  

  
  

  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config("");
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="custom_mathjax_source">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->
  


  

  

</body>
</html>
