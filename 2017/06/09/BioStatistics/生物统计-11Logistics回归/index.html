<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.3" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.3">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.3" color="#222">





  <meta name="keywords" content="基础统计,基础知识," />










<meta name="description" content="一般线性模型与广义线性模型由于统计模型的多样性和各种模型的适应性，针对因变量（也就是我们常用于回归方程中的y）和解释变量（就是自变量，也就是我们常用于回归的x）的取值性质，可以将统计模型分为多种类型。通常自变量为定性变量的线性模型称为一般线性模型（general linear model，GLM），如实验设计模型、方差分析模型。因变量为非正态分布的线性模型为广义线性模型（Generalized l">
<meta name="keywords" content="基础统计,基础知识">
<meta property="og:type" content="article">
<meta property="og:title" content="广义线性模型与Logistics回归笔记">
<meta property="og:url" content="http://rvdsd.top/2017/06/09/BioStatistics/生物统计-11Logistics回归/index.html">
<meta property="og:site_name" content="RVDSD的个人笔记本">
<meta property="og:description" content="一般线性模型与广义线性模型由于统计模型的多样性和各种模型的适应性，针对因变量（也就是我们常用于回归方程中的y）和解释变量（就是自变量，也就是我们常用于回归的x）的取值性质，可以将统计模型分为多种类型。通常自变量为定性变量的线性模型称为一般线性模型（general linear model，GLM），如实验设计模型、方差分析模型。因变量为非正态分布的线性模型为广义线性模型（Generalized l">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="http://ortxpw68f.bkt.clouddn.com/professional/180726/cblf06iB27.png?imageslim">
<meta property="og:image" content="http://ortxpw68f.bkt.clouddn.com/professional/180726/5ekdJ13eik.png?imageslim">
<meta property="og:image" content="http://ortxpw68f.bkt.clouddn.com/professional/180726/2HEiLjbAjK.png?imageslim">
<meta property="og:image" content="http://ortxpw68f.bkt.clouddn.com/professional/180726/G0jKg4aH0E.png?imageslim">
<meta property="og:image" content="http://ortxpw68f.bkt.clouddn.com/professional/180726/BCLLk6g26i.png?imageslim">
<meta property="og:image" content="http://ortxpw68f.bkt.clouddn.com/professional/180726/ca1ifm2laf.png?imageslim">
<meta property="og:image" content="http://ortxpw68f.bkt.clouddn.com/professional/180726/5iAFH48fd5.png?imageslim">
<meta property="og:image" content="http://ortxpw68f.bkt.clouddn.com/professional/180726/8ghGBC6Kaf.png?imageslim">
<meta property="og:image" content="http://ortxpw68f.bkt.clouddn.com/professional/180726/4fi9JCGKgL.png?imageslim">
<meta property="og:image" content="http://ortxpw68f.bkt.clouddn.com/professional/180726/eB0cgmF84B.png?imageslim">
<meta property="og:image" content="http://ortxpw68f.bkt.clouddn.com/professional/180726/21e8gfChkI.png?imageslim">
<meta property="og:image" content="http://ortxpw68f.bkt.clouddn.com/professional/180726/B338JCG4gA.png?imageslim">
<meta property="og:image" content="http://ortxpw68f.bkt.clouddn.com/professional/180726/mfI8e4D6gg.png?imageslim">
<meta property="og:image" content="http://ortxpw68f.bkt.clouddn.com/professional/180726/GEj57Gk3Cf.png?imageslim">
<meta property="og:updated_time" content="2018-09-20T08:15:33.574Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="广义线性模型与Logistics回归笔记">
<meta name="twitter:description" content="一般线性模型与广义线性模型由于统计模型的多样性和各种模型的适应性，针对因变量（也就是我们常用于回归方程中的y）和解释变量（就是自变量，也就是我们常用于回归的x）的取值性质，可以将统计模型分为多种类型。通常自变量为定性变量的线性模型称为一般线性模型（general linear model，GLM），如实验设计模型、方差分析模型。因变量为非正态分布的线性模型为广义线性模型（Generalized l">
<meta name="twitter:image" content="http://ortxpw68f.bkt.clouddn.com/professional/180726/cblf06iB27.png?imageslim">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.3',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://rvdsd.top/2017/06/09/BioStatistics/生物统计-11Logistics回归/"/>





  <title>广义线性模型与Logistics回归笔记 | RVDSD的个人笔记本</title><!-- hexo-inject:begin --><!-- hexo-inject:end -->
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">RVDSD的个人笔记本</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">学习过程中的输出</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2017/06/09/BioStatistics/生物统计-11Logistics回归/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">广义线性模型与Logistics回归笔记</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-06-09T12:02:00+08:00">
                2017-06-09
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/生物统计/" itemprop="url" rel="index">
                    <span itemprop="name">生物统计</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  6,671
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  29
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h2 id="一般线性模型与广义线性模型"><a href="#一般线性模型与广义线性模型" class="headerlink" title="一般线性模型与广义线性模型"></a>一般线性模型与广义线性模型</h2><p>由于统计模型的多样性和各种模型的适应性，针对因变量（也就是我们常用于回归方程中的y）和解释变量（就是自变量，也就是我们常用于回归的x）的取值性质，可以将统计模型分为多种类型。通常自变量为定性变量的线性模型称为一般线性模型（general linear model，GLM），如实验设计模型、方差分析模型。因变量为非正态分布的线性模型为广义线性模型（Generalized linear model,GENMOD），如Logistic回归模型、对数线性模型和Cox比例风险模型。</p>
<p>对于一般线性线性模型，其基本假定是y服从正态分布，或至少y的方差$\sigma^2$为有限常数。但是在实际研究中，情况并非总是如此，例如当y是发病率(y=k/n)时，y服从二项分布，期望值和方差分别为E(y)=π，Var(y)=1/n x π(1-π)，其方差与倒数呈反比，且是π的函数。又如，当y是单位时间内的放射性计数时，y服从Poisson分布，期望值和方差分别为E(y)=μ,Var(y)=μ，方差是μ的函数。实际数据中有很多资料均不符合一般线性模型的基本假定。尽管也可以将频率或频数作为y代入一般线性模型，但拟合结果往往不能令人满意，例如会出现频率的拟合值y&gt;1、频数的拟合值y&lt;0这种奇怪现象。</p>
<p>后来有人在一般线性模型的基础上，对$\sigma^2$为有限常数的假定作了进一步的推广，提出了广义线性模型的概念和拟似然函数(quasi-likelihood function)的方法，用于求解满足下列条件的线性模型：</p>
<p>$E(y) = \mu $</p>
<p>$m(\mu) = X\beta$</p>
<p>$cov(y) = \sigma^2 V(\mu) \quad （一）$</p>
<p>其中m为连接函数组成的向量，将$\mu$转化为$\beta$的线性表达式，$V(\mu)$为$n \times n$矩阵，其中每个元素均为$\mu$的函数，当处$y_{i}$值相互独立时，$V(\mu)$为对角矩阵。当$m(\mu)=\mu$，$V(\mu)=I$时，(一)中的三个公式为一般线性模型，也就是说，（一）中包括了一般线性模型。在广义线性模型中，均假定观察值y具有指数族概率密度函数，如下所示：</p>
<p>$f(y|\theta,\phi) = exp{[y\theta -b(\theta)]/a(\phi)=c(y,\phi)} \quad (二)$</p>
<p>其中，a、b和c是三种函数形式，θ为典则参数，如果给定φ（散布参数，有时写作$\sigma^2$），<code>（二）</code>式就是具有参数θ的指数族密度函数，以正式分布为例：</p>
<p>m</p>
<p>与<code>（二）</code>式对照，如下所示：</p>
<p>$\theta=\mu$</p>
<p>$b(\theta)=\mu^2/2$</p>
<p>$\phi=\sigma^2$</p>
<p>$a(\phi)=\sigma^2$</p>
<p>$c(y,\phi)=-\frac{1}{2}[y^2/\sigma^2 + ln(2\pi\sigma^2) ]$</p>
<p>根据样本和y的函数可建立对数似然函数，并可导出y的期望值和方差。在广义线性模型中，<code>（二）</code>式中的典则参数不仅仅是μ的函数，还是参数β0，β1,..βp的线性表达式，因此对μ作变换，则可得到下面三种分布连接函数的形式：</p>
<p>正态分布：$m(\mu)=\mu=\sum\beta_{j}x_{j}$</p>
<p>二项分布：$m(\mu)=ln(\frac{\mu}{1-\mu})=\sum\beta_{j}x_{j}$</p>
<p>Poisson分布：$mu(\mu)=ln(\mu)=\sum\beta_{j}x_{j}$</p>
<p>Logistic属于广义线性模式的一种，它是通常的正态线性模型的推广，它要求应变量只能通过线性形式依赖于自变量。上述推广体现在以下两个方面：</p>
<ol>
<li><p>通过一个连接函数，将应变量与自变量建立线性关系</p>
<p>$m(E(y))=\beta_{0}+\beta_{1}x_{1}+\beta_{2}x_{2}+\cdots+\beta_{p}x_{p}$</p>
</li>
<li><p>通过一个误差函数，说明广义线性模型的最后一部分随机项。</p>
</li>
</ol>
<p>因此，Logistic是关于应变量为0到1定性变量的广义线性回归问题，且广义线性模型的分布族为二项分布。</p>
<p>广义线性模型中常用的分布族如下所示：</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>分布</th>
<th>函数</th>
<th>模型</th>
</tr>
</thead>
<tbody>
<tr>
<td>正态(Gaussian)</td>
<td>$E(y)=X’\beta$</td>
<td>普通线性模型</td>
</tr>
<tr>
<td>二项(Binomial)</td>
<td>$E(y)=\frac{exp(X’\beta)}{1+exp(X’\beta)}$</td>
<td>Logistic模型和概率模型单位(probit)模型</td>
</tr>
<tr>
<td>泊松(Poisson)</td>
<td>$E(y)=exp(X’\beta)$</td>
<td>对数线性模型</td>
</tr>
</tbody>
</table>
</div>
<p>在R语言中，正态分布（也叫高斯分布）的广义线性模型事实上同线性模型是相同的，即</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">gm &lt;- glm(formula,family = gaussian, data)</div></pre></td></tr></table></figure>
<p>与线性模型<code>fm &lt;- lm(formula, data)</code>得到的结论是一致的，当然，其效率会差很多。下面是广义线性模型函数<code>glm()</code>的用法：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">glm(formula, family = gaussian, data,<span class="keyword">...</span>)</div><div class="line">formula为公式，即为要拟合的模型；</div><div class="line">family为分布族，包括正态分布(Gaussian)、二项分布(Binomial)、泊松分布(Poisson)和伽玛分布(Gamma)，分布族还可以通过选项link=来指定使用的连接函数</div><div class="line">data为可选择的数据框</div></pre></td></tr></table></figure>
<p>这样，在广义线性意义下，我们不仅知道了一般线性模型是广义线性模型的一个特例，而且导出了处理频率资料的Logistic模型和处理频数资料的对数线性模型。这个重要结果还说明，虽然Logistic模型和对数线性模型都是非线性模型，即μ和β呈非线性关系，但通过连接函数使m(μ)和β呈线性关系，从而使我们可以用线性拟合的方法求解这类非线性模型。更有意义的是，实际研究中的主要数据形式无非是计量资料、频率资料和频数资料（半计量资料实际上可以看做有序的频数资料），因此，掌握了广义线性模型的思想和方法，就可以使用统一的方法处理各种类型的统计数据。</p>
<h2 id="Logistic回归简介"><a href="#Logistic回归简介" class="headerlink" title="Logistic回归简介"></a>Logistic回归简介</h2><p>在回归中，如果因变量不是数量型的，而是取两个可能值的分类变量，而自变量可以为定性变量及定量变量，那么此时普通的线性回归模型就不适用了，至少回归方程的左边不能是分类变量。我们回忆一下二项分布Bin(n,p)，取两个值的二分布变量和二项分布有关，满足二项分布的变量取两种可能的值，处理过程可以看成为n次独立的随机试验（Bernoulli试验），每次试验只可能取两个可能的值之一，如果称一个试验结果为“成功”，而另一个为“不成功”，并记每次试验成功的概率为p，那么不成功的概率则为1-p。在这里，在所有n次试验中，成功概率p保持不变，然而在初中中，概率在所有情况下都不变的假定往往不成立，概率p可能是一些自变量的函数，此时，回归方程的右边与普通的回归方程的类似，而左边则是概率p的函数，而不是p（因变量成功概率）本身，这种回归就是Logistic回归。</p>
<p><code>Logistic回归（logistic regression）</code>属于概率型线性回归，它是研究二分类（可以扩展到多类）观察结果与一些影响因素之间关系的一种多变量分析方法。在流行病学研究中，经常需要分析疾病与各危险因素之间的定量关系，如食管癌的发生与吸烟、饮酒、不良包含习惯等危险因素的关系，为了正确说明这种关系，需要排除一些混杂因素的影响，传统上常使用<code>Mantel-Haenszel分层分析方法</code>，但这一方法适用于样本含量大、分析因素较少的情况。如果用线性回归，由于应变量Y是一个二值变量（通常取值为1或0），不满足应用条件，尤其当各因素都处于低水平或高水平时，预测值$\hat{Y}$可能超出0~1的范围，出现不合理的现象，用Logistic回归分析就是为了解决上述问题的。</p>
<h2 id="基本概念"><a href="#基本概念" class="headerlink" title="基本概念"></a>基本概念</h2><h4 id="logistic回归模型"><a href="#logistic回归模型" class="headerlink" title="logistic回归模型"></a>logistic回归模型</h4><p>设应变量是一个二值变量，取值为0或1，如下所示：</p>
<p>$Y=<br>\begin{cases}<br>1 &amp;出现阳性结果（发病、有效、死亡等） \\<br>0 &amp;出现阴性结果（未发病、无效、存活等）<br>\end{cases}$</p>
<p>另有影响Y取值的m个奕变量，分别为$X_{1},X_{2},\dots,X_{m}$，记作$P=P(Y=1|X_{1},X_{2},\dots,X_{m})$，表示在m个自变量作用下阳性结果发生的概率，logistic回归模型就可以表示为下面的公式，如下所示：</p>
<p>$P=\frac{1}{1+exp[-(\beta_{0}+\beta_{1}X_{1}+\beta_{2}X_{2}+\cdots+\beta_{m}X_{m})]}$</p>
<p>其中$\beta_{0}$是常数项，$\beta_{1},\beta_{2},\cdots,\beta_{m}$是回归系数，如果用Z表示m个自变量的线性组合，就是下面的样子：</p>
<p>$Z=\beta_{0}+\beta_{1}X_{1}+\beta_{2}X_{2}+\cdots+\beta_{m}X_{m}$</p>
<p>则Z与P之间的logistic曲线就是下面的图形，如下所示：</p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/professional/180726/cblf06iB27.png?imageslim" alt="mark"></p>
<p>从图中可以看出：当Z趋于$+\infty$时，P值逐渐趋于1；当Z趋于$-\infty$时，P值逐渐趋于0；P值的变化在0~1这个范围内，并且随着Z的增加或减少，以点$(0,0.5)$为中心呈对称S形变化，logistic模型的这些特点能够较好地配合生物学反应资料，对(16-1)的公式作对数变量，logistic回归模型就成了下面的线性形式，如下所示：</p>
<p>$ln(\frac{P}{1-P})=\beta_{0}+\beta_{1}X_{1}+\beta_{2}X_{2}+\cdots+\beta_{m}X_{m}$</p>
<p>上述公式的左端为阳性与阴性结果发生概率之比的自然对数，称为P的logit变换，称为logitP，这就可以看出，虽然概率P的取值范围是0~1，但是logitP却没有数值界限。</p>
<h4 id="模型参数意义"><a href="#模型参数意义" class="headerlink" title="模型参数意义"></a>模型参数意义</h4><p>以流行病学来说明一下模型参数的意义，从公式(16-2)可以看出，常数项$\beta_{0}$表示暴露剂量为0时，个体发病与不发病概率比之的自然对数，回归系数$\beta_{j}(j=1,2,\cdots,m)$表示自变量$X_{j}$改变一个单位时，logitP的改变量，它与称量危险因素作用大小的比数变称<code>优势比</code>（<code>odds ratio</code>，<code>OR</code>，也有教材译为<code>比数比</code>）有一个对应的关系，对比某一危险因素两个不同暴露水平$X_{j}=c_{1}$与$X_{j}=c_{0}$的发病情况（假定其他因素的水平相同），其优势比的自然对数如下所示：</p>
<p>$ \begin{align<em>}lnOR_{j}&amp;=ln[\frac{P_{1}/(1-P_{1})}{P_{0}/(1-P_{0})}]\\<br>&amp;=logitP_{1}-logitP_{0}\\&amp;=(\beta_{0}+\beta_{j}c_{1}+\sum \limits_{t\neq j}^m \beta_{t}X_{t}-(\beta_{0}+\beta_{j}c_{0}+\sum \limits_{t\neq j}^m \beta_{t}X_{t}) \\&amp;=\beta_{j}(c_{1}-c_{0}) \end{align</em>}$</p>
<p>转换成真数，则是如下的样子：</p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/professional/180726/5ekdJ13eik.png?imageslim" alt="mark"></p>
<p>在上面的这些公式中，$P_{1}$和$P_{2}$分别表示在$X_{j}$取值为$c_{1}$及$c_{0}$时的发病概率，$OR_{j}$称作多变量调整后的<code>优势比（adjusted odds ratio）</code>，表示扣除了其他自变量影响后危险因素的作用，如果$X_{j}$赋值上为1，如下所示：</p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/professional/180726/2HEiLjbAjK.png?imageslim" alt="mark"></p>
<p>那么，暴露组与非暴露组发病的优势比则为</p>
<p>$OR_{j}=exp(\beta_{j}) \qquad $(<strong>16-5</strong>)</p>
<p>当$\beta_{j}=0$时，$OR_{j}=1$，说明因素$X_{j}$对产生的发生不起作用；当$\beta_{j}&gt;0$时，$OR_{j}&gt;1$，说明$X_{j}$是一个危险因子；当$\beta_{j}&lt;1$时，$OR_{j}&lt;1$，说明$X_{j}$是一个保护因子。</p>
<p>由于$OR_{j}$值与模型中的常数项无关，$\beta_{0}$在危险因素分析中视为无效参数，对于发病率较低的慢性疾病如心脑血管疾病、恶性中肿瘤等，由于P很小，优势比可以作用相对危险度（relative risk，RR）的近似估计，如：</p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/professional/180726/G0jKg4aH0E.png?imageslim" alt="mark"></p>
<p>这是logistic回归用于流行病学调查资料的优势之一，即得到某一因素的回归系数估计值后，便可以得到该因素不同水平下优势比的估计值和相对危险度的近似估计值。</p>
<h3 id="logistic回归模型的参数估计"><a href="#logistic回归模型的参数估计" class="headerlink" title="logistic回归模型的参数估计"></a>logistic回归模型的参数估计</h3><h4 id="参数估计"><a href="#参数估计" class="headerlink" title="参数估计"></a>参数估计</h4><p>根据一组实际观察资料估计logistic回归模型的参数时，通常采用<strong>最大似然法估计（maximum likelihood estimate, MLE）</strong>，关于最大似然法，可以参考这篇笔记<a href="http://rvdsd.top/2018/06/08/BioStatistics/%E7%94%9F%E7%89%A9%E7%BB%9F%E8%AE%A1-StatQuest%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B007-%E6%9C%80%E5%A4%A7%E4%BC%BC%E7%84%B6%E6%B3%95%E8%AF%A6%E8%A7%A3/">《最大似然法详解》</a>。</p>
<p>最大似然法即建立一个样本似然函数，如下所示：</p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/professional/180726/BCLLk6g26i.png?imageslim" alt="mark"></p>
<p>式中$P_{i}$表示第$i$例观察对象在暴露条件下阳性结果发生的概率，如果实际出现的是阳性结果，取$Y_{i}=1$，否则取$Y_{i}=0$，根据最大似然原理，在一次抽样中，获得现有样本的概率应该最大，即似然函数L应该达到最大值，为了简化计算，通常取似然函数的对数形式，如下所示：</p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/professional/180726/ca1ifm2laf.png?imageslim" alt="mark"></p>
<p>形成要计算的目标函数lnL，然后采用Newton-Raphson迭代方法使对数似然函数达到极大值，此时参数的取值$b_{0},b_{1},b_{2},\cdots,b_{m}$即为$\beta_{0},\beta_{1},\beta_{2},\cdots,\beta_{m}$的最大似然估计值，同时得到参数估计值的方差，即协方差矩阵（对角线元素开平方为标准误$S_{b_{0}},S_{b_{1}},S_{b_{2}},\cdots,S_{b_{m}}$。</p>
<p>如果我们有下述的分层资料，如下所示：</p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/professional/180726/5iAFH48fd5.png?imageslim" alt="mark"></p>
<p>高有g层，每层有$n_{k}(k=1,2,\cdots,g)$例观察以对象，其中有$d_{k}$个病例，则似然函数为：</p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/professional/180726/8ghGBC6Kaf.png?imageslim" alt="mark"></p>
<p>其中，$P_{k}$表示第k层阳性结果发生的概率，上述求解过程现在都是通过软件来完成的。</p>
<h4 id="优势比估计"><a href="#优势比估计" class="headerlink" title="优势比估计"></a>优势比估计</h4><p>根据公式(16-4)，其一因素两个不同水平$(c_{1},c_{0})$优势比的估计值如下所示：</p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/professional/180726/4fi9JCGKgL.png?imageslim" alt="mark"></p>
<p>$OR_{j}$的可信区间可以利用$b_{j}$的抽样分布来估计，在样本含量比较大的情况下，它近似服从正态分布，特殊情况下，若自变量$X_{j}$只有暴露和非暴露两个水平，则优势比$OR_{j}$的$1-\alpha$可信区间计算公式如下所示：</p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/professional/180726/eB0cgmF84B.png?imageslim" alt="mark"></p>
<h3 id="案例A"><a href="#案例A" class="headerlink" title="案例A"></a>案例A</h3><p>对前面所述的表格（16-1）做logistic回归分析，也就是下面的这个表格</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>分层</th>
<th>吸烟$X_{1}$</th>
<th>饮酒$X_{2}$</th>
<th>观察例数$n_{k}$</th>
<th>阳性数$d_{k}$</th>
<th>阴性数$n_{k}-d_{k}$</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>0</td>
<td>0</td>
<td>199</td>
<td>63</td>
<td>136</td>
</tr>
<tr>
<td>2</td>
<td>0</td>
<td>1</td>
<td>170</td>
<td>63</td>
<td>107</td>
</tr>
<tr>
<td>3</td>
<td>1</td>
<td>0</td>
<td>101</td>
<td>44</td>
<td>57</td>
</tr>
<tr>
<td>4</td>
<td>1</td>
<td>1</td>
<td>416</td>
<td>265</td>
<td>151</td>
</tr>
</tbody>
</table>
</div>
<p>确定各变量的赋值或编码，如下所示：</p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/professional/180726/21e8gfChkI.png?imageslim" alt="mark"></p>
<p>进行logistic回归计算，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">smoke &lt;- c(<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>) <span class="comment"># 0表示不吸烟，1表示吸烟</span></div><div class="line">wine &lt;- c(<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>)</div><div class="line">n1 &lt;- c(<span class="number">199</span>,<span class="number">170</span>,<span class="number">101</span>,<span class="number">416</span>) <span class="comment"># 0表示不饮酒，1表示饮酒</span></div><div class="line">positive1 &lt;- c(<span class="number">63</span>,<span class="number">63</span>,<span class="number">44</span>,<span class="number">265</span>)</div><div class="line">negative1 &lt;- c(<span class="number">136</span>,<span class="number">107</span>,<span class="number">57</span>,<span class="number">151</span>)</div><div class="line">data1 &lt;- positive1/n1 <span class="comment"># data1用来计算阳性率</span></div><div class="line">result1 &lt;- glm(data1~smoke+wine,binomial,weights=n1) <span class="comment"># data1为百分比，需要加上总数</span></div><div class="line">con1 &lt;- as.matrix(confint(result1))[<span class="number">2</span>,] <span class="comment"># confint(result1)查看各个系数对应的置信区间</span></div><div class="line">exp(con1) <span class="comment"># 计算吸烟与不吸烟优势比的可信区间</span></div><div class="line">con2 &lt;- as.matrix(confint(result1))[<span class="number">3</span>,] </div><div class="line">exp(con2) <span class="comment"># 计算饮酒与不饮酒优势比的可信区间</span></div><div class="line">summary(result1) <span class="comment"># 查看各个系数,z值的平方即为Wald检验值</span></div><div class="line">anova(result1,test=<span class="string">"Chisq"</span>) <span class="comment">#</span></div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div></pre></td><td class="code"><pre><div class="line">&gt; exp(con1) # 计算吸烟与不吸烟优势比的可信区间</div><div class="line">   2.5 %   97.5 % </div><div class="line">1.809052 3.258006 </div><div class="line">&gt; con2 &lt;- as.matrix(confint(result1))[3,] </div><div class="line">Waiting for profiling to be done...</div><div class="line">&gt; exp(con2) # 计算饮酒与不饮酒优势比的可信区间</div><div class="line">   2.5 %   97.5 % </div><div class="line">1.244161 2.304882 </div><div class="line">&gt; summary(result1) # 查看各个系数,z值的平方即为Wald检验值</div><div class="line"></div><div class="line">Call:</div><div class="line">glm(formula = data1 ~ smoke + wine, family = binomial, weights = n1)</div><div class="line"></div><div class="line">Deviance Residuals: </div><div class="line">      1        2        3        4  </div><div class="line"> 0.9133  -0.9240  -1.1731   0.5968  </div><div class="line"></div><div class="line">Coefficients:</div><div class="line">            Estimate Std. Error z value Pr(&gt;|z|)    </div><div class="line">(Intercept)  -0.9099     0.1358  -6.699 2.11e-11 ***</div><div class="line">smoke         0.8856     0.1500   5.904 3.54e-09 ***</div><div class="line">wine          0.5261     0.1572   3.348 0.000815 ***</div><div class="line">---</div><div class="line">Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</div><div class="line"></div><div class="line">(Dispersion parameter for binomial family taken to be 1)</div><div class="line"></div><div class="line">    Null deviance: 71.9659  on 3  degrees of freedom</div><div class="line">Residual deviance:  3.4202  on 1  degrees of freedom</div><div class="line">AIC: 32.005</div><div class="line"></div><div class="line">Number of Fisher Scoring iterations: 3</div><div class="line"></div><div class="line">&gt; anova(result1,test=&quot;Chisq&quot;) # </div><div class="line">Analysis of Deviance Table</div><div class="line"></div><div class="line">Model: binomial, link: logit</div><div class="line"></div><div class="line">Response: data1</div><div class="line"></div><div class="line">Terms added sequentially (first to last)</div><div class="line"></div><div class="line"></div><div class="line">      Df Deviance Resid. Df Resid. Dev  Pr(&gt;Chi)    </div><div class="line">NULL                      3     71.966              </div><div class="line">smoke  1   57.315         2     14.651 3.713e-14 ***</div><div class="line">wine   1   11.230         1      3.420 0.0008047 ***</div><div class="line">---</div><div class="line">Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</div></pre></td></tr></table></figure>
<p>从上面结果可以看出：</p>
<p>$b_{0}=-0.9099,S_{b_{0}}=0.1358,b_{1}=0.8856,S_{b_{1}}=0.1500,b_{2}=0.5261,S_{b_{2}}=0.1572$</p>
<p>吸烟与不吸烟的优势比为：</p>
<p>$ \widehat{OR_{1}}=exp(b_{1})=exp(0.8856)=2.42 $ </p>
<p>$OR_{1}$的95%可信区间如下所示：</p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/professional/180726/B338JCG4gA.png?imageslim" alt="mark"></p>
<p>饮酒与不饮酒的优势比为：</p>
<p>$ \widehat{OR_{2}}=exp(b_{1})=exp(0.5261)=1.69 $ </p>
<p>$OR_{2}$的95%可信区间如下所示：</p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/professional/180726/mfI8e4D6gg.png?imageslim" alt="mark"></p>
<h3 id="logistic回归模型的假设检验"><a href="#logistic回归模型的假设检验" class="headerlink" title="logistic回归模型的假设检验"></a>logistic回归模型的假设检验</h3><p>得到logistic回归方程后，还需要对其回归系数进行假设检验，用于说明所研究的自变量对于应变量Y的是影响是否有统计学意义，为此，需要对模型中的回归系数是否不全为0作出检验，这个跟多重线性回归的检验是一样的，检验假设条件如下所示：</p>
<p>$H_{0}:\beta_{1}=\beta_{1}=\cdots=\beta_{m}=0$</p>
<p>$H_{1}:$各$\beta_{j}(j=1,2,\cdots,m)$不全为0</p>
<p>更典型的问题是对一个回归系数的检验，检验假设为$H_{0}:\beta_{j}=0,H_{1}:\beta \neq 0$。常用的检验验方法有似然比检验（likelihood ratio test），Wald检验和计分检验（score test）。</p>
<h4 id="似然比检验"><a href="#似然比检验" class="headerlink" title="似然比检验"></a>似然比检验</h4><p>似然比检验的基本思想是比较在两种不同假设条件下的对数似然函数值，看其差别大小。具体做法是，先拟合一个不包含准备检测的变量在内的logistic回归模型，求出它的对数似然函数值$lnL_{0}$，然后把需要检验的变量加入模型中去，再检验配合，得到一个新的对数似然函数值$lnL_{1}$，假设前后两个模型分别包含$l$个自变量和$p$个自变量，似然比统计量G的计算公式为：</p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/professional/180726/GEj57Gk3Cf.png?imageslim" alt="mark"></p>
<p>当样本含量较大时，在零假设下得到的G统计量近似服从自由度为$d(d=p-l)$的$\chi^2$分布，若$G\geq{\chi^2_{\alpha,d}}$时，𩇡新加入的$d$个自变量对回归方程有统计学意义，如果只对一个回归系数检验，则$d=1$，由上面的案例可以计算出来：</p>
<p>$lnL(X_{1})=-585.326,lnL(X_{2})=-597.436,lnL(X_{1},X_{2})=-579.711$</p>
<p>符号$L(X_{1})$和$L(X_{2})$分别表示模型中只含有$X_{1}$和$X_{2}$的最大似然函数值，而$L(X_{1},X_{2})$则表示模型中同时含有$X_{1}$和$X_{2}$的最大似然函数。</p>
<p>对于$H_{0}:\beta_{1}=0,H_{1}:\beta \neq 0$，则有：</p>
<p>$G=2[lnL(X_{1},X_{2})-lnL(X_{2})]=2[-579.711-(-597.436)]=35.45$</p>
<p>查$\chi^2$界值表可以得，$\chi^2_{0.05,1}=3.84$，$G&gt;3.84$，因此在$\alpha=0.05$检验水平上拒绝$H_{0}$，接受$H_{1}$，说明控制了饮酒因素是呼后，食管癌与吸烟有显著性关系。</p>
<p>同理，对于$H_{0}:\beta_{2}=0,H_{1}:\beta_{2} \neq 0$，则有</p>
<p>$G=2[lnL(X_{1},X_{2})-lnL(X_{2})]=2[-579.711-(-585.326)]=11.23$</p>
<p>$G&gt;3.84$，拒绝$H_{0}$，接受$H_{1}$，说明控制了吸烟因素的影响后，食管癌与饮酒有显著性关系。</p>
<h4 id="Wald检验"><a href="#Wald检验" class="headerlink" title="Wald检验"></a>Wald检验</h4><p>Wald检验的原理可以再看一下这篇笔记<a href="http://rvdsd.top/2018/06/09/BioStatistics/%E7%94%9F%E7%89%A9%E7%BB%9F%E8%AE%A1-StatQuest%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B008-%E6%AF%94%E6%95%B0%E4%B8%8E%E6%AF%94%E6%95%B0%E6%AF%94/">《比数与比数比》。</a></p>
<p>Wald只需要将各参数$\beta_{j}$的估计值$b_{j}$与0比较，并且它的标准误$S_{b_{j}}$作为参照；为检验$H_{0}:\beta_{j}=0,H_{1}:\beta_{j} \neq0$，计算如下统计量</p>
<p>$\mu=\frac{b_{j}}{S_{b_{j}}} \qquad (16-13)$</p>
<p>或</p>
<p>$\chi^2=(\frac{b_{j}}{S_{b_{j}}})^2 \qquad (16-14)$</p>
<p>对于大样本资料，在零假设下$\mu$近似服从标准正态分布，而$\chi^2$则近似服从自由度$\nu=1$的$\chi^2$分布，在本例中，对于$H_{0}:\beta_{1}=0,H_{1}:\beta_{2} \neq 0$，则有：</p>
<p>$\chi^2=(\frac{0.8856}{0.1500})^2=34.86$</p>
<p>对于$H_{0}:\beta_{2}=0,H_{1}:\beta_{2} \neq 0$，则有：</p>
<p>$\chi^2=(\frac{0.5261}{0.1572})^2=11.20$</p>
<p>$\chi^2$值均大于3.84，说明食管癌与吸烟、吸烟有显著性关系，结论同前。</p>
<p>现在在R中计算一下这个案例，如下所示：</p>
<p>第一步：原始数据</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">smoke &lt;- rep(c(<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>),c(<span class="number">199</span>,<span class="number">170</span>,<span class="number">101</span>,<span class="number">416</span>))</div><div class="line">alcohol &lt;- rep(c(<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>),c(<span class="number">199</span>,<span class="number">170</span>,<span class="number">101</span>,<span class="number">416</span>))</div><div class="line">Y &lt;- rep(c(<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>),c(<span class="number">136</span>,<span class="number">63</span>,<span class="number">107</span>,<span class="number">63</span>,<span class="number">57</span>,<span class="number">44</span>,<span class="number">151</span>,<span class="number">265</span>))</div><div class="line">logistic_raw &lt;- data.frame(smoke,alcohol,Y)</div><div class="line">head(logistic_raw)</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">&gt; head(logistic_raw)</div><div class="line">  smoke alcohol Y</div><div class="line">1     0       0 0</div><div class="line">2     0       0 0</div><div class="line">3     0       0 0</div><div class="line">4     0       0 0</div><div class="line">5     0       0 0</div><div class="line">6     0       0 0</div></pre></td></tr></table></figure>
<p>第二步：logistic回归计算</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">logistic_glm &lt;- glm(Y ~ smoke + alcohol, family=binomial(link=<span class="string">'logit'</span>), data=logistic_raw)</div><div class="line">logistic_glm</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">&gt; logistic_glm</div><div class="line"></div><div class="line">Call:  glm(formula = Y ~ smoke + alcohol, family = binomial(link = &quot;logit&quot;), </div><div class="line">    data = logistic_raw)</div><div class="line"></div><div class="line">Coefficients:</div><div class="line">(Intercept)        smoke      alcohol  </div><div class="line">    -0.9099       0.8856       0.5261  </div><div class="line"></div><div class="line">Degrees of Freedom: 885 Total (i.e. Null);  883 Residual</div><div class="line">Null Deviance:	    1228 </div><div class="line">Residual Deviance: 1159 	AIC: 1165</div></pre></td></tr></table></figure>
<p>从这个结果我们可以发现，logistic的截矩为-0.9099，smoke的系数为0.8856，alcohol为0.5261，与书中结果相同。</p>
<p>第三步：OR与95% IC</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">## OR 与 95% CI</span></div><div class="line">OR &lt;- exp(coef(logistic_result))</div><div class="line">CI &lt;- exp(confint(logistic_glm,level = <span class="number">0.95</span>))</div><div class="line"></div><div class="line"></div><div class="line">coef_result &lt;- exp(cbind(OR = coef(logistic_result)[<span class="number">2</span>:<span class="number">3</span>,<span class="number">1</span>], </div><div class="line">                         CI_low = confint(logistic_glm ,level=<span class="number">0.95</span>)[<span class="number">2</span>:<span class="number">3</span>,<span class="number">1</span>],</div><div class="line">                         CI_up = confint(logistic_glm ,level=<span class="number">0.95</span>)[<span class="number">2</span>:<span class="number">3</span>,<span class="number">2</span>]))</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&gt; coef_result</div><div class="line">              OR   CI_low    CI_up</div><div class="line">smoke   <span class="number">2.424399</span> <span class="number">1.809052</span> <span class="number">3.258006</span></div><div class="line">alcohol <span class="number">1.692359</span> <span class="number">1.244161</span> <span class="number">2.304882</span></div></pre></td></tr></table></figure>
<h2 id="Logistic回归变量筛选"><a href="#Logistic回归变量筛选" class="headerlink" title="Logistic回归变量筛选"></a>Logistic回归变量筛选</h2><p>与多元线性回归分析类似，当自变量的个数较多时，为了使建立的logistic回归模型比较稳定和便于解释，应尽可能将回归效果显著的自变量选入模型中，将作用不显著的自变量排除在外，具体的算法有前进法、后退法和逐步法。logistic逐步回归与线性逐步回归过程非常相似，使用其中所用的检验统计量不再是F统计量，而是似然比统计量、Wald统计量和计分统计量之一，例如使用似然比统计量，即利用如下的公式：</p>
<p>$G=2(lnL_{1}^{(l)}-lnL_{0}^{(l)})$</p>
<p>在进行到第$l$步时，通过比较含有某一自变量$X_{j}$和不含有$X_{j}$的模型，决定$X_{j}$是否引入模型或从模型中剔除。</p>
<p>看下面的案例（《医学统计学》，第四版，孙振球）：</p>
<h3 id="案例B"><a href="#案例B" class="headerlink" title="案例B"></a>案例B</h3><p>为了探讨冠心病的有关危险因素，对26例冠心病患者和28便对照者进行病例对照研究，各因素的说明及资料见下表1和表2，试用logistic逐步回归分析法筛选危险因素（$\alpha_{入}=0.10$，$\alpha_{出}=0.15$），如下所示：</p>
<div class="table-container">
<table>
<thead>
<tr>
<th></th>
<th>表1</th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>因素</td>
<td>变量名</td>
<td>赋值说明</td>
</tr>
<tr>
<td>年龄（岁）</td>
<td>X1</td>
<td>&lt;45=1,45~=2,55~=3,65~=4</td>
</tr>
<tr>
<td>高血压史</td>
<td>X2</td>
<td>无=0,有=1</td>
</tr>
<tr>
<td>高血压家族史</td>
<td>X3</td>
<td>无=0,有=1</td>
</tr>
<tr>
<td>吸烟</td>
<td>X4</td>
<td>不吸=0,吸=1</td>
</tr>
<tr>
<td>高血脂史</td>
<td>X5</td>
<td>无=0,有=1</td>
</tr>
<tr>
<td>动物脂肪摄入</td>
<td>X6</td>
<td>低=0,高=1</td>
</tr>
<tr>
<td>体重指数（BMI）</td>
<td>X7</td>
<td>&lt;24~=1,24~=2,26~=3</td>
</tr>
<tr>
<td>A型性格</td>
<td>X8</td>
<td>否=0,是=1</td>
</tr>
<tr>
<td>冠心病</td>
<td>Y</td>
<td>对照=0,病例=1</td>
</tr>
</tbody>
</table>
</div>
<div class="table-container">
<table>
<thead>
<tr>
<th>表2</th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>序号</td>
<td>X1</td>
<td>X2</td>
<td>X3</td>
<td>…</td>
<td>X7</td>
<td>X8</td>
<td>Y</td>
</tr>
<tr>
<td>1</td>
<td>3</td>
<td>1</td>
<td>0</td>
<td>…</td>
<td>1</td>
<td>1</td>
<td>0</td>
</tr>
<tr>
<td>2</td>
<td>2</td>
<td>0</td>
<td>1</td>
<td>…</td>
<td>1</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td>3</td>
<td>2</td>
<td>1</td>
<td>0</td>
<td>…</td>
<td>1</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
<tr>
<td>54</td>
<td>3</td>
<td>1</td>
<td>1</td>
<td>…</td>
<td>3</td>
<td>1</td>
<td>1</td>
</tr>
</tbody>
</table>
</div>
<p>（原始数据已放github上）</p>
<p>计算过程如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">No &lt;- <span class="number">1</span>:<span class="number">54</span></div><div class="line">X1 &lt;- c(<span class="number">3</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">4</span>,<span class="number">3</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">3</span>,<span class="number">3</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">3</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">3</span>)</div><div class="line">X2 &lt;- c(<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>)</div><div class="line">X3 &lt;- c(<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>)</div><div class="line">X4 &lt;- c(<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>)</div><div class="line">X5 &lt;- c(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>)</div><div class="line">X6 &lt;- c(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>)</div><div class="line">X7 &lt;- c(<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">3</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">3</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">3</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">3</span>,<span class="number">3</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">3</span>)</div><div class="line">X8 &lt;- c(<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>)</div><div class="line">Y &lt;- c(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>)</div><div class="line">data2 &lt;- data.frame(No,X1,X2,X3,X4,X5,X6,X7,X8,Y)</div><div class="line">y.glm &lt;- glm(Y~X1+X2+X5+X6+X7+X8,family=binomial,data=data2)</div><div class="line">summary(y.glm)</div><div class="line">y.step2 &lt;- step(y.glm)</div><div class="line">summary(y.step2)</div><div class="line">y.glm2 &lt;- glm(Y~X1+X5+X6+X8,family=binomial,data=data2)</div><div class="line">summary(y.glm2)</div></pre></td></tr></table></figure>
<p>计算结果如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line">&gt; summary(y.glm)</div><div class="line"></div><div class="line">Call:</div><div class="line">glm(formula = Y ~ X1 + X2 + X5 + X6 + X7 + X8, family = binomial, </div><div class="line">    data = data2)</div><div class="line"></div><div class="line">Deviance Residuals: </div><div class="line">    Min       1Q   Median       3Q      Max  </div><div class="line">-2.3631  -0.6437  -0.2306   0.5883   2.2950  </div><div class="line"></div><div class="line">Coefficients:</div><div class="line">            Estimate Std. Error z value Pr(&gt;|z|)   </div><div class="line">(Intercept)  -5.0195     1.6820  -2.984  0.00284 **</div><div class="line">X1            0.7242     0.4883   1.483  0.13805   </div><div class="line">X2            1.1076     0.8171   1.356  0.17524   </div><div class="line">X5            1.2089     0.7808   1.548  0.12158   </div><div class="line">X6            3.3788     1.3397   2.522  0.01167 * </div><div class="line">X7            0.2881     0.5714   0.504  0.61419   </div><div class="line">X8            1.9090     0.8973   2.128  0.03338 * </div><div class="line">---</div><div class="line">Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</div><div class="line"></div><div class="line">(Dispersion parameter for binomial family taken to be 1)</div><div class="line"></div><div class="line">    Null deviance: 74.786  on 53  degrees of freedom</div><div class="line">Residual deviance: 43.907  on 47  degrees of freedom</div><div class="line">AIC: 57.907</div><div class="line"></div><div class="line">Number of Fisher Scoring iterations: 5</div></pre></td></tr></table></figure>
<p>从结果来看，X6，X8这2项的P值小于0.05，现在再对这2项进行回归拟合，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"></div></pre></td></tr></table></figure>
<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><ol>
<li>孙振球. 医学统计学.第4版[M]. 人民卫生出版社, 2014.</li>
<li>王斌会. 多元统计分析及R语言建模[M]. 暨南大学出版社, 2010.</li>
</ol>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/基础统计/" <i class="fa fa-tag"></i> 基础统计</a>
          
            <a href="/tags/基础知识/" <i class="fa fa-tag"></i> 基础知识</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2017/06/08/BioStatistics/生物统计-10相关分析/" rel="next" title="相关分析笔记">
                <i class="fa fa-chevron-left"></i> 相关分析笔记
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2017/06/21/BioStatistics/生物统计-11生存分析/" rel="prev" title="生存分析笔记">
                生存分析笔记 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  
    <div class="comments" id="comments">
      <div id="vcomments"></div>
    </div>
  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">RVDSD</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">147</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">12</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">61</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          <div class="links-of-author motion-element">
            
          </div>

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#一般线性模型与广义线性模型"><span class="nav-number">1.</span> <span class="nav-text">一般线性模型与广义线性模型</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Logistic回归简介"><span class="nav-number">2.</span> <span class="nav-text">Logistic回归简介</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#基本概念"><span class="nav-number">3.</span> <span class="nav-text">基本概念</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#logistic回归模型"><span class="nav-number">3.0.1.</span> <span class="nav-text">logistic回归模型</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#模型参数意义"><span class="nav-number">3.0.2.</span> <span class="nav-text">模型参数意义</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#logistic回归模型的参数估计"><span class="nav-number">3.1.</span> <span class="nav-text">logistic回归模型的参数估计</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#参数估计"><span class="nav-number">3.1.1.</span> <span class="nav-text">参数估计</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#优势比估计"><span class="nav-number">3.1.2.</span> <span class="nav-text">优势比估计</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#案例A"><span class="nav-number">3.2.</span> <span class="nav-text">案例A</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#logistic回归模型的假设检验"><span class="nav-number">3.3.</span> <span class="nav-text">logistic回归模型的假设检验</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#似然比检验"><span class="nav-number">3.3.1.</span> <span class="nav-text">似然比检验</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Wald检验"><span class="nav-number">3.3.2.</span> <span class="nav-text">Wald检验</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Logistic回归变量筛选"><span class="nav-number">4.</span> <span class="nav-text">Logistic回归变量筛选</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#案例B"><span class="nav-number">4.1.</span> <span class="nav-text">案例B</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#参考资料"><span class="nav-number">5.</span> <span class="nav-text">参考资料</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

<div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">RVDSD</span>

  
</div>



<div class="powered-by">
<i class="fa fa-user-md"></i><span id="busuanzi_container_site_uv">
  本站访客数:<span id="busuanzi_value_site_uv"></span>
</span>
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.3</div>




<div class="theme-info">
  <div class="powered-by"></div>
  <span class="post-count">博客全站共552.3k字</span>
</div>

        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.3"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.3"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.3"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.3"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.3"></script>



  


  




	





  





  










  
  <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/valine@1.1.4/dist/Valine.min.js"></script>
  <script type="text/javascript">
    new Valine({
        av: AV,
        el: '#vcomments' ,
        verify: true,
        notify: true,
        app_id: '4ORLDMxXCFDLSHPJ4wSSDkkw-gzGzoHsz',
        app_key: 'HSWpCY7XlN0pGV5DCrKoC0ic',
        placeholder: 'Comment input placeholder'
    });
  </script>



  





  

  

  
  

  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config("");
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="custom_mathjax_source">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->
  


  

  

</body>
</html>
