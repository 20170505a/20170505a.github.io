<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.3" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.3">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.3" color="#222">





  <meta name="keywords" content="ggplot2," />










<meta name="description" content="前言 这一篇笔记主要是翻译国外的一个网站的教程，它对ggplot2的绘图做了很好的汇总，原文地址：R: basic graphs 2 (with ggplot2)，原始数据在原文上有。 第一部分：导入数据 原始数据文件有7个，我已经下载到本地硬盘，如下所示：   mark  直接导入即可，如下所示： 1234567891011121314151617library(ggplot2">
<meta name="keywords" content="ggplot2">
<meta property="og:type" content="article">
<meta property="og:title" content="ggplot2(14)-ggplot2练习">
<meta property="og:url" content="http://rvdsd.top/2017/04/24/R/ggplot2(14)-练习/index.html">
<meta property="og:site_name" content="RVDSD的个人笔记本">
<meta property="og:description" content="前言 这一篇笔记主要是翻译国外的一个网站的教程，它对ggplot2的绘图做了很好的汇总，原文地址：R: basic graphs 2 (with ggplot2)，原始数据在原文上有。 第一部分：导入数据 原始数据文件有7个，我已经下载到本地硬盘，如下所示：   mark  直接导入即可，如下所示： 1234567891011121314151617library(ggplot2">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="http://ortxpw68f.bkt.clouddn.com/professional/180820/0gHKJDKL6c.png?imageslim">
<meta property="og:image" content="http://ortxpw68f.bkt.clouddn.com/professional/180820/JiFGiGi39i.png?imageslim">
<meta property="og:image" content="http://ortxpw68f.bkt.clouddn.com/professional/180820/GI0gJc50De.png?imageslim">
<meta property="og:image" content="http://ortxpw68f.bkt.clouddn.com/professional/180820/55FLjcD9LL.png?imageslim">
<meta property="og:image" content="http://ortxpw68f.bkt.clouddn.com/professional/180820/2ak0mja935.png?imageslim">
<meta property="og:image" content="http://ortxpw68f.bkt.clouddn.com/professional/180820/2i7D593k3E.png?imageslim">
<meta property="og:image" content="http://ortxpw68f.bkt.clouddn.com/professional/180820/H5I1Ckim3m.png?imageslim">
<meta property="og:image" content="http://ortxpw68f.bkt.clouddn.com/professional/180820/b8dBaFd5lh.png?imageslim">
<meta property="og:updated_time" content="2018-09-01T04:18:39.522Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="ggplot2(14)-ggplot2练习">
<meta name="twitter:description" content="前言 这一篇笔记主要是翻译国外的一个网站的教程，它对ggplot2的绘图做了很好的汇总，原文地址：R: basic graphs 2 (with ggplot2)，原始数据在原文上有。 第一部分：导入数据 原始数据文件有7个，我已经下载到本地硬盘，如下所示：   mark  直接导入即可，如下所示： 1234567891011121314151617library(ggplot2">
<meta name="twitter:image" content="http://ortxpw68f.bkt.clouddn.com/professional/180820/0gHKJDKL6c.png?imageslim">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.3',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://rvdsd.top/2017/04/24/R/ggplot2(14)-练习/"/>





  <title>ggplot2(14)-ggplot2练习 | RVDSD的个人笔记本</title><!-- hexo-inject:begin --><!-- hexo-inject:end -->
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">RVDSD的个人笔记本</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">学习过程中的输出</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2017/04/24/R/ggplot2(14)-练习/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">ggplot2(14)-ggplot2练习</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-04-24T12:00:00+08:00">
                2017-04-24
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/R/" itemprop="url" rel="index">
                    <span itemprop="name">R</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  3,899
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  20
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h2 id="前言">前言</h2>
<p>这一篇笔记主要是翻译国外的一个网站的教程，它对<code>ggplot2</code>的绘图做了很好的汇总，原文地址：<a href="http://egret.psychol.cam.ac.uk/statistics/R/graphs2.html" target="_blank" rel="external">R: basic graphs 2 (with ggplot2)</a>，原始数据在原文上有。</p>
<h2 id="第一部分导入数据">第一部分：导入数据</h2>
<p>原始数据文件有7个，我已经下载到本地硬盘，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180820/0gHKJDKL6c.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>直接导入即可，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">library</span>(ggplot2)</div><div class="line"></div><div class="line">phdfig21a &lt;- read.table(<span class="string">"D:\\Personal\\R_code\\data\\ggplot2\\PhD_fig21A.csv"</span>,header=<span class="literal">TRUE</span>, sep=<span class="string">","</span>, na.strings=<span class="string">"NA"</span>, dec=<span class="string">"."</span>, strip.white=<span class="literal">TRUE</span>)</div><div class="line"><span class="comment"># header=TRUE表示要读取标题</span></div><div class="line"><span class="comment"># sep=","表示数据文件PhD_fig21A.csv中的数据是以逗号分割的，csv文件默认都是以逗号分割的，如果是以空格分割的，则用sep=" "（中间空一格）。</span></div><div class="line"><span class="comment"># na.strings="NA"是将空白的数据用NA替代</span></div><div class="line"><span class="comment"># dec="."用来表示小数点</span></div><div class="line"><span class="comment"># strip.white=TRUE 表示当指定了sep时，则将字符元素前后的空格去掉（而数值元素则默认是去掉前后的空格）</span></div><div class="line"></div><div class="line"></div><div class="line">phdfig37b &lt;- read.table(<span class="string">"D:\\Personal\\R_code\\data\\ggplot2\\PhD_fig37B.csv"</span>, header=<span class="literal">TRUE</span>, sep=<span class="string">","</span>, na.strings=<span class="string">"NA"</span>, dec=<span class="string">"."</span>, strip.white=<span class="literal">TRUE</span>)</div><div class="line"></div><div class="line">phdfig22d &lt;- read.table(<span class="string">"D:\\Personal\\R_code\\data\\ggplot2\\PhD_fig22D.csv"</span>, header=<span class="literal">TRUE</span>, sep=<span class="string">","</span>, na.strings=<span class="string">"NA"</span>, dec=<span class="string">"."</span>, strip.white=<span class="literal">TRUE</span>)</div><div class="line">phdfig23 &lt;- read.table(<span class="string">"D:\\Personal\\R_code\\data\\ggplot2\\PhD_fig23.csv"</span>, header=<span class="literal">TRUE</span>, sep=<span class="string">","</span>, na.strings=<span class="string">"NA"</span>, dec=<span class="string">"."</span>, strip.white=<span class="literal">TRUE</span>)</div><div class="line">phdfig28c &lt;- read.table(<span class="string">"D:\\Personal\\R_code\\data\\ggplot2\\PhD_fig28C.csv"</span>, header=<span class="literal">TRUE</span>, sep=<span class="string">","</span>, na.strings=<span class="string">"NA"</span>, dec=<span class="string">"."</span>, strip.white=<span class="literal">TRUE</span>)</div><div class="line">mdfig30a &lt;- read.table(<span class="string">"D:\\Personal\\R_code\\data\\ggplot2\\MD_fig30A.csv"</span>, header=<span class="literal">TRUE</span>, sep=<span class="string">","</span>, na.strings=<span class="string">"NA"</span>, dec=<span class="string">"."</span>, strip.white=<span class="literal">TRUE</span>)</div><div class="line">mdfig30b &lt;- read.table(<span class="string">"D:\\Personal\\R_code\\data\\ggplot2\\MD_fig30B.csv"</span>, header=<span class="literal">TRUE</span>, sep=<span class="string">","</span>, na.strings=<span class="string">"NA"</span>, dec=<span class="string">"."</span>, strip.white=<span class="literal">TRUE</span>)</div></pre></td></tr></table></figure>
<p>查看一下其中的某个数据，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">&gt; head(phdfig37b) <span class="comment"># 先查看一下phdfig37b的数据集</span></div><div class="line">  session       sham ACCX  SEM_sham  SEM_accx</div><div class="line"><span class="number">1</span>       <span class="number">1</span>  <span class="number">0.0000000</span> -<span class="number">0.2</span> <span class="number">0.7881701</span> <span class="number">0.4163332</span></div><div class="line"><span class="number">2</span>       <span class="number">2</span>  <span class="number">0.6666667</span> -<span class="number">0.3</span> <span class="number">0.4819992</span> <span class="number">0.3666667</span></div><div class="line"><span class="number">3</span>       <span class="number">3</span> -<span class="number">0.3333333</span> -<span class="number">0.2</span> <span class="number">0.7212503</span> <span class="number">0.5333333</span></div><div class="line"><span class="number">4</span>       <span class="number">4</span>  <span class="number">1.5833333</span>  <span class="number">1.0</span> <span class="number">0.5833333</span> <span class="number">0.4714045</span></div><div class="line"><span class="number">5</span>       <span class="number">5</span> -<span class="number">0.2500000</span> -<span class="number">0.3</span> <span class="number">0.7699370</span> <span class="number">0.5174725</span></div><div class="line"><span class="number">6</span>       <span class="number">6</span>  <span class="number">1.7500000</span> -<span class="number">0.8</span> <span class="number">0.6410810</span> <span class="number">0.4898979</span></div><div class="line">&gt; tail(phdfig37b)</div><div class="line">   session     sham ACCX  SEM_sham  SEM_accx</div><div class="line"><span class="number">7</span>        <span class="number">7</span> <span class="number">1.000000</span> -<span class="number">1.1</span> <span class="number">0.8438727</span> <span class="number">0.7951240</span></div><div class="line"><span class="number">8</span>        <span class="number">8</span> <span class="number">4.083333</span>  <span class="number">0.2</span> <span class="number">1.0405297</span> <span class="number">0.6463573</span></div><div class="line"><span class="number">9</span>        <span class="number">9</span> <span class="number">4.666667</span>  <span class="number">1.6</span> <span class="number">0.6999278</span> <span class="number">0.5617433</span></div><div class="line"><span class="number">10</span>      <span class="number">10</span> <span class="number">3.333333</span>  <span class="number">3.3</span> <span class="number">1.0249415</span> <span class="number">1.0005554</span></div><div class="line"><span class="number">11</span>      <span class="number">11</span> <span class="number">4.500000</span>  <span class="number">5.3</span> <span class="number">0.7229988</span> <span class="number">1.0857665</span></div><div class="line"><span class="number">12</span>      <span class="number">12</span> <span class="number">4.416667</span>  <span class="number">3.9</span> <span class="number">0.6331539</span> <span class="number">0.7063207</span></div></pre></td></tr></table></figure>
<p>现在构建ggplot2能够识别的数据框，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">phdfig37b_long = with(phdfig37b,</div><div class="line">                      rbind( data.frame( lesion = <span class="string">"sham"</span>, session = session, diffscore = sham, sem = SEM_sham ),</div><div class="line">                             data.frame( lesion = <span class="string">"ACCX"</span>, session = session, diffscore = ACCX, sem = SEM_accx ) )</div><div class="line">)</div><div class="line"><span class="comment"># 建立一个数据框，第1列为lesion，并且为"sham"</span></div><div class="line"><span class="comment"># 第2列为session，值等于phdfig37b中的session</span></div><div class="line"><span class="comment"># 第3列为diffscore，值等于sham,第4列为sem，值等于SEM_sham</span></div></pre></td></tr></table></figure>
<p>查看一下数据框，如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">&gt; head(phdfig37b_long)</div><div class="line">  lesion session  diffscore       sem</div><div class="line">1   sham       1  0.0000000 0.7881701</div><div class="line">2   sham       2  0.6666667 0.4819992</div><div class="line">3   sham       3 -0.3333333 0.7212503</div><div class="line">4   sham       4  1.5833333 0.5833333</div><div class="line">5   sham       5 -0.2500000 0.7699370</div><div class="line">6   sham       6  1.7500000 0.6410810</div></pre></td></tr></table></figure>
<h2 id="第二部分-qplot快速制图">第二部分 qplot快速制图</h2>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">p&lt;-qplot(session, diffscore, colour=lesion, data=phdfig37b_long) </div><div class="line">p&lt;-p+ geom_line() </div><div class="line">p&lt;-p+ geom_errorbar(aes(ymin = diffscore - sem, ymax = diffscore + sem))</div><div class="line">p</div><div class="line"><span class="comment"># 绘制数据集phdfig37b_long的图形，使x轴=session,y轴=diffscore,颜色属性=lesion</span></div><div class="line"><span class="comment"># geom_line() 添加折线图</span></div><div class="line"><span class="comment"># geom_errorbar 添加误差线</span></div></pre></td></tr></table></figure>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180820/JiFGiGi39i.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h2 id="第三部分ggplot制图">第三部分：ggplot制图</h2>
<p>目标：</p>
<ol style="list-style-type: decimal">
<li>绘制折线图；</li>
<li>添加误差线；</li>
<li>分类；</li>
<li>添加参考线。</li>
</ol>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">library</span>(grid) <span class="comment"># 后面要用到unit函数</span></div><div class="line"></div><div class="line">f1 &lt;- ggplot(data = phdfig37b_long, aes(x = session, y = diffscore, group = lesion) ) + <span class="comment"># 绘图phdfig37b_long数据集的图形，使x轴=session,y轴=diffscore,group在这里的意思是，desion中的数据不属于一组</span></div><div class="line">  geom_errorbar(aes(ymin = diffscore - sem, ymax = diffscore + sem), width=<span class="number">0.3</span>) +</div><div class="line">  <span class="comment"># 添加误差线，指定宽度为0.4</span></div><div class="line">  geom_line() + <span class="comment"># 添加折线</span></div><div class="line">  geom_point(aes(shape=lesion, fill=lesion), size=<span class="number">5</span>) + <span class="comment"># 添加数据点，将lesion映射到形状属性上，将将lesion映射到填充属性上（即数据点内部的颜色，非轮廓）</span></div><div class="line">  scale_x_continuous(<span class="string">"Session"</span>, breaks=<span class="number">1</span>:<span class="number">12</span>) + <span class="comment"># 对x轴上的sesssion指定刻度，从1到12</span></div><div class="line">  scale_y_continuous(<span class="string">"Difference score"</span>, limits = c(-<span class="number">4</span>, <span class="number">8</span>), breaks=seq(-<span class="number">4</span>, <span class="number">8</span>, by = <span class="number">2</span>)) + <span class="comment"># 指定y轴的刻度</span></div><div class="line">  scale_shape_manual(values=c(<span class="number">24</span>,<span class="number">21</span>)) + <span class="comment"># 设置数据点的形状，一个是24,一个是21,24表示正三角，21表示圆形</span></div><div class="line">  scale_fill_manual(values=c(<span class="string">"white"</span>,<span class="string">"black"</span>)) + <span class="comment"># 指定数据点的颜色，一个是白色，一个是黑色</span></div><div class="line">  geom_abline(intercept=<span class="number">0</span>, slope=<span class="number">0</span>, linetype=<span class="string">"dotted"</span>) + <span class="comment"># 添加参考线，截距是0，斜率是0，点的类型是点状</span></div><div class="line">  annotate(<span class="string">"text"</span>, x=<span class="number">11</span>, y=-<span class="number">0.25</span>, label=<span class="string">"chance"</span>) + <span class="comment"># 添加注释，坐标为(11,-0.25)，文字为"chance"</span></div><div class="line">  theme_bw() + <span class="comment"># 将绘图的主题改为白色</span></div><div class="line">  ggtitle(<span class="string">"Two-stimulus discriminated approach task"</span>)+ <span class="comment"># 添加图形的标题</span></div><div class="line">  theme(</div><div class="line">    plot.title = element_text(face=<span class="string">"bold"</span>, size=<span class="number">14</span>), <span class="comment"># 修改标题文本的属性</span></div><div class="line">    axis.title.x = element_text(face=<span class="string">"bold"</span>, size=<span class="number">12</span>), <span class="comment"># 修改x轴标签文本的属性</span></div><div class="line">    axis.title.y = element_text(face=<span class="string">"bold"</span>, size=<span class="number">12</span>, angle=<span class="number">90</span>),<span class="comment"># 修改y轴标签文本的属性</span></div><div class="line">    axis.text.x=element_text(size=<span class="number">15</span>), <span class="comment"># 修改x轴坐标轴刻度的大小</span></div><div class="line">    panel.grid.major = element_blank(), <span class="comment"># 移除绘图区域的主要网格线</span></div><div class="line">    panel.grid.minor = element_blank(), <span class="comment"># 移除绘图区域的次要网格线</span></div><div class="line">    legend.position = c(<span class="number">0.2</span>,<span class="number">0.8</span>), <span class="comment"># 图例的位置坐标</span></div><div class="line">    legend.title = element_blank(), <span class="comment"># 图例标题为空</span></div><div class="line">    legend.text = element_text(size=<span class="number">12</span>), <span class="comment"># 图例中项目文本的大小</span></div><div class="line">    legend.key.size = unit(<span class="number">1.5</span>, <span class="string">"lines"</span>), <span class="comment"># 图例中项目的间隔，需要grid包</span></div><div class="line">    legend.key = element_blank() <span class="comment"># 移除图例中项目的边框</span></div><div class="line">  )</div><div class="line">print(f1)</div></pre></td></tr></table></figure>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180820/GI0gJc50De.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h2 id="第四部分输出图形">第四部分：输出图形</h2>
<p>保存图形命令如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">ggsave(filename=<span class="string">"d:\\我的图形.pdf"</span>,plot=f1)形为f1</div><div class="line"><span class="comment">## Saving 5 x 4 in image</span></div><div class="line"><span class="comment"># 另外一些保存图形的方法，如下所示：</span></div><div class="line">ggsave(<span class="string">"d:\\f1.pdf"</span>)</div><div class="line"><span class="comment">## Saving 5 x 4 in image</span></div><div class="line">ggsave(<span class="string">"d:\\f1.png"</span>,dpi=<span class="number">300</span>) <span class="comment"># 保存f1，分辨率为300dpi</span></div><div class="line"><span class="comment">## Saving 5 x 4 in image</span></div></pre></td></tr></table></figure>
<h2 id="第五部分自由浮动的sed">第五部分：自由浮动的SED</h2>
<h3 id="a.构建数据框">A.构建数据框</h3>
<p>如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">phdfig21a_long &lt;- with(phdfig21a,</div><div class="line">                       rbind( data.frame( lesion = <span class="string">"sham"</span>, lever = <span class="string">"CRf"</span>, dose = dose, sqrtpresses = shamCR, sem = SEMshamCR, halfSED = halfSED[<span class="number">1</span>] ),</div><div class="line">                              data.frame( lesion = <span class="string">"sham"</span>, lever = <span class="string">"NCRf"</span>, dose = dose, sqrtpresses = shamNCR, sem = SEMshamNCR, halfSED = halfSED[<span class="number">1</span>] ),</div><div class="line">                              data.frame( lesion = <span class="string">"ACCX"</span>, lever = <span class="string">"CRf"</span>, dose = dose, sqrtpresses = ACCXCR, sem = SEMACCXCR, halfSED = halfSED[<span class="number">1</span>] ),</div><div class="line">                              data.frame( lesion = <span class="string">"ACCX"</span>, lever = <span class="string">"NCRf"</span>, dose = dose, sqrtpresses = ACCXNCR, sem = SEMACCXNCR, halfSED = halfSED[<span class="number">1</span>] ) )</div><div class="line">)</div><div class="line">head(phdfig21a_long)</div></pre></td></tr></table></figure>
<p>数据如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">&gt; head(phdfig21a_long)</div><div class="line">  lesion lever dose sqrtpresses       sem halfSED</div><div class="line">1   sham   CRf    0    5.112528 0.5539816  0.9396</div><div class="line">2   sham   CRf    3    6.829842 1.0673567  0.9396</div><div class="line">3   sham   CRf   10    9.230089 0.9947341  0.9396</div><div class="line">4   sham   CRf   20    8.563017 0.8215663  0.9396</div><div class="line">5   sham  NCRf    0    3.685772 0.4961057  0.9396</div><div class="line">6   sham  NCRf    3    4.024871 0.6831637  0.9396</div></pre></td></tr></table></figure>
<h3 id="b.-再添加一个新的变量并查看数据如下所示">B. 再添加一个新的变量，并查看数据，如下所示：</h3>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">phdfig21a_long &lt;- within(phdfig21a_long, &#123;</div><div class="line">  <span class="comment"># 加入一列新的变量 </span></div><div class="line">  lesion_lever &lt;- do.call(paste, c(phdfig21a_long[c(<span class="string">"lesion"</span>, <span class="string">"lever"</span>)], sep = <span class="string">" "</span>))</div><div class="line">  <span class="comment"># do.call表示，运行函数paste,将phdfig21a_long中的lession与lever用空格连接起来，并生成一列新的变量 </span></div><div class="line">  lesion_lever &lt;- factor(lesion_lever, levels=unique(lesion_lever))</div><div class="line">  <span class="comment"># unique(lesion_lever)返回phdfig21a_long数据集中的lesion_lever中的重复元素，即提取出互不相同的元素（如果有相同的几个则取一个，只有一个的，也取一个）</span></div><div class="line">  dose &lt;- factor(dose)</div><div class="line">&#125;)</div><div class="line">head(phdfig21a_long)</div></pre></td></tr></table></figure>
<p>修改后的数据框如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">&gt; head(phdfig21a_long)</div><div class="line">  lesion lever dose sqrtpresses       sem halfSED lesion_lever</div><div class="line"><span class="number">1</span>   sham   CRf    <span class="number">0</span>    <span class="number">5.112528</span> <span class="number">0.5539816</span>  <span class="number">0.9396</span>     sham CRf</div><div class="line"><span class="number">2</span>   sham   CRf    <span class="number">3</span>    <span class="number">6.829842</span> <span class="number">1.0673567</span>  <span class="number">0.9396</span>     sham CRf</div><div class="line"><span class="number">3</span>   sham   CRf   <span class="number">10</span>    <span class="number">9.230089</span> <span class="number">0.9947341</span>  <span class="number">0.9396</span>     sham CRf</div><div class="line"><span class="number">4</span>   sham   CRf   <span class="number">20</span>    <span class="number">8.563017</span> <span class="number">0.8215663</span>  <span class="number">0.9396</span>     sham CRf</div><div class="line"><span class="number">5</span>   sham  NCRf    <span class="number">0</span>    <span class="number">3.685772</span> <span class="number">0.4961057</span>  <span class="number">0.9396</span>    sham NCRf</div><div class="line"><span class="number">6</span>   sham  NCRf    <span class="number">3</span>    <span class="number">4.024871</span> <span class="number">0.6831637</span>  <span class="number">0.9396</span>    sham NCRf</div></pre></td></tr></table></figure>
<h3 id="c.绘图">C.绘图</h3>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line">f2 &lt;- ggplot(data = phdfig21a_long, aes(x = dose, y = sqrtpresses, group = lesion_lever ) ) +</div><div class="line">  geom_line() +</div><div class="line">  geom_point(aes(shape=lesion_lever, fill=lesion_lever), size=<span class="number">5</span>) + <span class="comment"># 将变量lesion_lever映射到shape上，将lesion_lever映射到填充色上</span></div><div class="line">  geom_errorbar(aes(x=<span class="number">1</span>, ymin=<span class="number">10</span> - phdfig21a$halfSED[<span class="number">1</span>], ymax=<span class="number">10</span> + phdfig21a$halfSED[<span class="number">1</span>], width = <span class="number">0.2</span>)) + <span class="comment"># 绘制一个误差棒，位置是x=1，宽度为0.2</span></div><div class="line">  scale_shape_manual(values=c(<span class="number">21</span>,<span class="number">24</span>,<span class="number">21</span>,<span class="number">24</span>)) + <span class="comment"># 指定shamCR, shamNCR, ACCXCR, ACCXNCR这四种类型的形状，分别为圆、三角、圆、三角</span></div><div class="line">  scale_fill_manual(values=c(<span class="string">"white"</span>,<span class="string">"white"</span>,<span class="string">"black"</span>,<span class="string">"black"</span>)) + <span class="comment"># 指定shamCR, shamNCR, ACCXCR, ACCXNCR这四种类型的颜色，分别为白、白、黑、黑</span></div><div class="line">  xlab(substitute(paste(<span class="string">"Intra-Acb amphetamine ("</span>,mu,<span class="string">"g)"</span>))) + <span class="comment">#添加x轴标签，substitute用来显示公式，</span></div><div class="line">  scale_y_continuous(expression(sqrt(<span class="string">"lever presses"</span>)), expand=c(<span class="number">0</span>,<span class="number">0</span>), limits = c(<span class="number">0</span>, <span class="number">14</span>), breaks=seq(<span class="number">0</span>, <span class="number">14</span>, by = <span class="number">2</span>)) + <span class="comment"># the "expand" bit prevents ggplot2 from expanding the axis a little beyond what you specify</span></div><div class="line">  annotate(<span class="string">"text"</span>, x=<span class="number">1.4</span>, y=<span class="number">10</span>, label=<span class="string">"SED"</span>) +</div><div class="line">  theme_bw() +</div><div class="line">  ggtitle(<span class="string">"Conditioned reinforcement"</span>)+ <span class="comment"># 添加图形的标题</span></div><div class="line">  theme(plot.title = element_text(face=<span class="string">"bold"</span>, size=<span class="number">14</span>),</div><div class="line">        axis.title.x = element_text(face=<span class="string">"bold"</span>, size=<span class="number">12</span>),</div><div class="line">        axis.title.y = element_text(face=<span class="string">"bold"</span>, size=<span class="number">12</span>, angle=<span class="number">90</span>),</div><div class="line">        panel.grid.major = element_blank(),</div><div class="line">        panel.grid.minor = element_blank(),</div><div class="line">        panel.border=element_blank(), <span class="comment"># 取消绘图区域四周的边框</span></div><div class="line">        axis.line=element_line(colour=<span class="string">"black"</span>), <span class="comment"># 添加坐标轴（即x轴与y轴）的直线</span></div><div class="line">        legend.position = c(<span class="number">0.8</span>,<span class="number">0.2</span>),</div><div class="line">        legend.title = element_blank(),</div><div class="line">        legend.text = element_text(size=<span class="number">10</span>),</div><div class="line">        legend.key.size = unit(<span class="number">1</span>, <span class="string">"lines"</span>),</div><div class="line">        legend.key = element_blank()</div><div class="line">  )</div><div class="line">print(f2)</div></pre></td></tr></table></figure>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180820/55FLjcD9LL.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h2 id="第六部分-绘制双变量的条形图及误差棒">第六部分 绘制双变量的条形图及误差棒</h2>
<h3 id="a.整理数据">A.整理数据</h3>
<p>查看数据，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&gt; phdfig22d</div><div class="line">  group CSpluslatency CSminuslatency CSplusSEM CSminusSEM</div><div class="line"><span class="number">1</span>  sham      <span class="number">3.884335</span>       <span class="number">4.212531</span> <span class="number">0.2248404</span>  <span class="number">0.2593122</span></div><div class="line"><span class="number">2</span>  ACCX      <span class="number">4.672486</span>       <span class="number">3.619434</span> <span class="number">0.3476289</span>  <span class="number">0.4902273</span></div></pre></td></tr></table></figure>
<p>整理数据，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">phdfig22d_long = with(phdfig22d,</div><div class="line">                      rbind( data.frame( lesion=group, stimulus=<span class="string">"CS+"</span>, latency=CSpluslatency, sem=CSplusSEM ),</div><div class="line">                             data.frame( lesion=group, stimulus=<span class="string">"CS-"</span>, latency=CSminuslatency, sem=CSminusSEM ) )</div><div class="line">)</div><div class="line">phdfig22d_long$lesion = factor(phdfig22d_long$lesion, levels=unique(phdfig22d_long$lesion))</div></pre></td></tr></table></figure>
<p>上述代码是生成phdfig22d_long数据框，这个数据框有四列变量，分别为lesion,stimulus,lantency，sem，查看数据，如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&gt; phdfig22d_long</div><div class="line">  lesion stimulus  latency       sem</div><div class="line">1   sham      CS+ 3.884335 0.2248404</div><div class="line">2   ACCX      CS+ 4.672486 0.3476289</div><div class="line">3   sham      CS- 4.212531 0.2593122</div><div class="line">4   ACCX      CS- 3.619434 0.4902273</div></pre></td></tr></table></figure>
<h3 id="b.绘图">B.绘图</h3>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">f3 &lt;- ggplot(data = phdfig22d_long, aes(x=lesion, y=latency, fill=stimulus) ) +</div><div class="line">  geom_errorbar(aes(ymin=latency, ymax=latency+sem, width = <span class="number">0.2</span>),position=position_dodge(width=<span class="number">0.90</span>)) + <span class="comment"># 误差棒只添加上部分，因此误差棒的最低部是latency，最上部是lantency + sem，宽度是0.2，最低部与最上部进行堆叠(position_dodge)</span></div><div class="line">  geom_bar(stat=<span class="string">"identity"</span>, position=<span class="string">"dodge"</span>) +</div><div class="line">  geom_bar(stat=<span class="string">"identity"</span>, position=<span class="string">"dodge"</span>, colour=<span class="string">"black"</span>) +</div><div class="line">  scale_fill_manual(values=c(<span class="string">"grey80"</span>, <span class="string">"white"</span>)) + <span class="comment"># 对两个变量进行颜色填充，分别为灰度80与白色</span></div><div class="line">  xlab(<span class="string">""</span>) + <span class="comment"># x轴不添加标签</span></div><div class="line">  scale_y_continuous(<span class="string">"Latency to approach (s)"</span>, expand=c(<span class="number">0</span>,<span class="number">0</span>), limits = c(<span class="number">0</span>, <span class="number">5.5</span>)) + <span class="comment"># expand=c(0,0) 表示将y轴从0开始</span></div><div class="line">  theme_bw() +</div><div class="line">  ggtitle(<span class="string">"Autoshaping approach latencies"</span>)+</div><div class="line">  theme(</div><div class="line">    panel.grid.major = element_blank(),</div><div class="line">    panel.grid.minor = element_blank(),</div><div class="line">    panel.border = element_blank(),</div><div class="line">    axis.line=element_line(colour=<span class="string">"black"</span>),</div><div class="line">    axis.text.y=element_text(angle=<span class="number">90</span>, hjust=<span class="number">0.5</span>),</div><div class="line">    legend.position = c(<span class="number">0.25</span>,<span class="number">0.85</span>),</div><div class="line">    legend.key = element_rect()</div><div class="line">  )</div><div class="line">print(f3)</div></pre></td></tr></table></figure>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180820/2ak0mja935.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h2 id="第七部分带有注释线的误差棒">第七部分：带有注释线的误差棒</h2>
<h3 id="a.查看数据">A.查看数据</h3>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"></div></pre></td></tr></table></figure>
<h3 id="b.整理数据">B.整理数据</h3>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">phdfig23_long = with(phdfig23,</div><div class="line">rbind( data.frame( lesion=group, stimulus=<span class="string">"CS+"</span>, approaches=CSplus, sem=SEMCSplus ),</div><div class="line">data.frame( lesion=group, stimulus=<span class="string">"CS-"</span>, approaches=CSminus, sem=SEMCSminus ) )</div><div class="line">)</div></pre></td></tr></table></figure>
<p>查看数据，如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&gt; phdfig23_long</div><div class="line">  lesion stimulus approaches       sem</div><div class="line">1   sham      CS+  14.000000 0.9309493</div><div class="line">2   ACCX      CS+   9.857143 1.0785478</div><div class="line">3   sham      CS-   4.500000 0.8595865</div><div class="line">4   ACCX      CS-   6.428571 1.0658585</div></pre></td></tr></table></figure>
<h3 id="c.绘图-1">C.绘图</h3>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line">f4 &lt;- ggplot(data = phdfig23_long, aes(x=lesion, y=approaches, fill=stimulus, width=<span class="number">0.5</span>) ) +</div><div class="line">geom_errorbar(aes(ymin=approaches, ymax=approaches+sem, width = <span class="number">0.2</span>), position=position_dodge(width=<span class="number">0.8</span>)) +</div><div class="line">geom_bar(stat=<span class="string">"identity"</span>, position=position_dodge(width=<span class="number">0.8</span>)) +</div><div class="line">geom_bar(stat=<span class="string">"identity"</span>, position=position_dodge(width=<span class="number">0.8</span>), colour=<span class="string">"black"</span>) +</div><div class="line">scale_fill_manual(values=c(<span class="string">"grey80"</span>, <span class="string">"white"</span>)) +</div><div class="line">scale_x_discrete(<span class="string">"Group"</span>, limits=c(<span class="string">"sham"</span>, <span class="string">"ACCX"</span>)) + <span class="comment"># 设置x轴上的分类变量，顺序为sham,ACCX</span></div><div class="line">scale_y_continuous(<span class="string">"Number of approaches"</span>, expand=c(<span class="number">0</span>,<span class="number">0</span>), limits = c(<span class="number">0</span>, <span class="number">17</span>), breaks=seq(<span class="number">0</span>, <span class="number">16</span>, by=<span class="number">2</span>)) +</div><div class="line">geom_segment(aes(x=<span class="number">0.8</span>, y=<span class="number">15.3</span>, xend=<span class="number">0.8</span>, yend=<span class="number">16</span>)) +</div><div class="line">geom_segment(aes(x=<span class="number">0.8</span>, y=<span class="number">16</span>, xend=<span class="number">1.2</span>, yend=<span class="number">16</span>)) +</div><div class="line">geom_segment(aes(x=<span class="number">1.2</span>, y=<span class="number">6</span>, xend=<span class="number">1.2</span>, yend=<span class="number">16</span>)) + <span class="comment"># 添加注释线，注意坐标</span></div><div class="line">annotate(<span class="string">"text"</span>, x=<span class="number">1</span>, y=<span class="number">15.5</span>, label=<span class="string">"***"</span>) +</div><div class="line">theme_bw() +</div><div class="line">ggtitle(<span class="string">"Autoshaping probe test"</span>)+</div><div class="line">theme( plot.title = element_text(face=<span class="string">"bold"</span>, size=<span class="number">14</span>),</div><div class="line">axis.title.x = element_text(face=<span class="string">"bold"</span>, size=<span class="number">12</span>),</div><div class="line">axis.title.y = element_text(face=<span class="string">"bold"</span>, size=<span class="number">12</span>, angle=<span class="number">90</span>),</div><div class="line">panel.grid.major = element_blank(),</div><div class="line">panel.grid.minor = element_blank(),</div><div class="line">panel.border = element_blank(),</div><div class="line">axis.line=element_line(colour=<span class="string">"black"</span>),</div><div class="line">axis.text.y=element_text(angle=<span class="number">90</span>, hjust=<span class="number">0.5</span>),</div><div class="line">legend.title = element_blank(),</div><div class="line">legend.position = c(<span class="number">0.85</span>,<span class="number">0.85</span>),</div><div class="line">legend.key.size = unit(<span class="number">1.5</span>, <span class="string">"lines"</span>),</div><div class="line">legend.key = element_rect()</div><div class="line">)</div><div class="line">print(f4)</div></pre></td></tr></table></figure>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180820/2i7D593k3E.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>代码解释：</p>
<p>上述代码中有一部分是添加注释线的，就是与三个星号在一起的一段线。代码为：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">geom_segment(aes(x=<span class="number">0.8</span>, y=<span class="number">15.3</span>, xend=<span class="number">0.8</span>, yend=<span class="number">16</span>)) +</div><div class="line">geom_segment(aes(x=<span class="number">0.8</span>, y=<span class="number">16</span>, xend=<span class="number">1.2</span>, yend=<span class="number">16</span>)) +</div><div class="line">geom_segment(aes(x=<span class="number">1.2</span>, y=<span class="number">6</span>, xend=<span class="number">1.2</span>, yend=<span class="number">16</span>)) + <span class="comment"># 添加注释线，注意坐标</span></div><div class="line">annotate(<span class="string">"text"</span>, x=<span class="number">1</span>, y=<span class="number">15.5</span>, label=<span class="string">"***"</span>) +</div></pre></td></tr></table></figure>
<p>在添加注释线的时候，如果要精确地绘制，需要知道x轴上条形图中心的坐标，可以用str(print(f4))查看，str(print(f4))，前5行的数字为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">List of 3</div><div class="line">$ data :List of 7</div><div class="line">..$ :&apos;data.frame&apos;: 4 obs. of 9 variables:</div><div class="line">.. ..$ fill : chr [1:4] &quot;grey80&quot; &quot;white&quot; &quot;grey80&quot; &quot;white&quot;</div><div class="line">.. ..$ x : num [1:4] 0.8 1.2 1.8 2.2</div></pre></td></tr></table></figure>
<p>其中第5行是：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">.. ..$ x : num [1:4] 0.8 1.2 1.8 2.2</div></pre></td></tr></table></figure>
<p>可以发现，条形图第一个条带的中心处，对应的x轴坐标为0.8，因此在绘制注释线的时候，x的起点为是0.8。</p>
<h2 id="第八部分含有双向x轴的绘图">第八部分：含有双向x轴的绘图</h2>
<h3 id="a.查看原始数据">A.查看原始数据</h3>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">&gt; phdfig28c</div><div class="line">  block      sham      ACCX    SEMsham    SEMACCX</div><div class="line">1    -3 0.8905724 0.8648725 0.04328269 0.05561053</div><div class="line">2    -2 0.9212121 0.8789751 0.03030303 0.03002131</div><div class="line">3    -1 0.9237374 0.9204775 0.02654952 0.02897810</div><div class="line">4     0        NA        NA         NA         NA</div><div class="line">5     1 0.7755162 0.6273393 0.04621826 0.05090232</div><div class="line">6     2 0.8674289 0.6453398 0.05521676 0.05800651</div><div class="line">7     3 0.8327228 0.6989440 0.07589090 0.06084011</div><div class="line">8     4 0.9145688 0.8424770 0.03463735 0.03901640</div><div class="line">9     5 0.8874644 0.8592287 0.03880296 0.04260364</div></pre></td></tr></table></figure>
<h3 id="b.整理数据-1">B.整理数据</h3>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">phdfig28c_long &lt;- with(phdfig28c,</div><div class="line">rbind( data.frame( block=block, lesion=<span class="string">"sham"</span>, diffscore=sham, sem=SEMsham ),</div><div class="line">data.frame( block=block, lesion=<span class="string">"ACCX"</span>, diffscore=ACCX, sem=SEMACCX ) ) )</div><div class="line">phdfig28c_long <span class="comment"># 查看整理后的数据</span></div></pre></td></tr></table></figure>
<p>整理后的数据如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">&gt; phdfig28c_long # 查看整理后的数据</div><div class="line">   block lesion diffscore        sem</div><div class="line">1     -3   sham 0.8905724 0.04328269</div><div class="line">2     -2   sham 0.9212121 0.03030303</div><div class="line">3     -1   sham 0.9237374 0.02654952</div><div class="line">4      0   sham        NA         NA</div><div class="line">5      1   sham 0.7755162 0.04621826</div><div class="line">6      2   sham 0.8674289 0.05521676</div><div class="line">7      3   sham 0.8327228 0.07589090</div><div class="line">8      4   sham 0.9145688 0.03463735</div><div class="line">9      5   sham 0.8874644 0.03880296</div><div class="line">10    -3   ACCX 0.8648725 0.05561053</div><div class="line">11    -2   ACCX 0.8789751 0.03002131</div><div class="line">12    -1   ACCX 0.9204775 0.02897810</div><div class="line">13     0   ACCX        NA         NA</div><div class="line">14     1   ACCX 0.6273393 0.05090232</div><div class="line">15     2   ACCX 0.6453398 0.05800651</div><div class="line">16     3   ACCX 0.6989440 0.06084011</div><div class="line">17     4   ACCX 0.8424770 0.03901640</div><div class="line">18     5   ACCX 0.8592287 0.04260364</div></pre></td></tr></table></figure>
<h3 id="c.绘图-2">C.绘图</h3>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line">f5 &lt;- ggplot(data = phdfig28c_long, aes(x = block, y = diffscore, group = lesion) ) +</div><div class="line">geom_errorbar(aes(ymin = diffscore - sem, ymax = diffscore + sem), width=<span class="number">0.3</span>) +</div><div class="line">geom_line() +</div><div class="line">geom_point(aes(shape=lesion, fill=lesion), size=<span class="number">5</span>) +</div><div class="line">scale_x_continuous(<span class="string">"Trial block"</span>, expand=c(<span class="number">0</span>,<span class="number">0</span>), limits=c(-<span class="number">3.5</span>,<span class="number">5.5</span>), breaks=-<span class="number">3</span>:<span class="number">5</span>, labels=c(<span class="string">"-3"</span>,<span class="string">"-2"</span>,<span class="string">"-1"</span>,<span class="string">"surgery"</span>,<span class="string">"1"</span>,<span class="string">"2"</span>,<span class="string">"3"</span>,<span class="string">"4"</span>,<span class="string">"5"</span>)) +</div><div class="line">scale_y_continuous(<span class="string">"Difference score"</span>, expand=c(<span class="number">0</span>,<span class="number">0</span>), limits = c(<span class="number">0.4</span>, <span class="number">1</span>), breaks=seq(<span class="number">0.4</span>, <span class="number">1</span>, by = <span class="number">0.1</span>)) +</div><div class="line">scale_shape_manual(values=c(<span class="number">24</span>,<span class="number">21</span>)) +</div><div class="line">scale_fill_manual(values=c(<span class="string">"white"</span>,<span class="string">"black"</span>)) +</div><div class="line">geom_abline(intercept=<span class="number">0.5</span>, slope=<span class="number">0</span>, linetype=<span class="string">"dotted"</span>) + <span class="comment"># 截距为0.5，斜率为0的虚线</span></div><div class="line">annotate(<span class="string">"text"</span>, x=-<span class="number">2</span>, y=<span class="number">0.48</span>, label=<span class="string">"chance"</span>) +</div><div class="line">theme_bw() +</div><div class="line">theme(plot.margin=unit(c(<span class="number">1</span>,<span class="number">1</span>,<span class="number">1.5</span>,<span class="number">1.5</span>), <span class="string">"lines"</span>), <span class="comment"># 分别指的是整个绘图区域（包括x轴与y轴的标签）距离顶边，右边，底边，左边的距离（默认是1，1，0.5，0.5）</span></div><div class="line">axis.ticks.margin=unit(<span class="number">0.25</span>,<span class="string">"lines"</span>), <span class="comment"># 坐标轴刻度的值距离刻度线的距离</span></div><div class="line">axis.title.x = element_text(face=<span class="string">"bold"</span>, size=<span class="number">12</span>, vjust=-<span class="number">1</span>), <span class="comment"># use vjust to move text away from the axis</span></div><div class="line">axis.title.y = element_text(face=<span class="string">"bold"</span>, size=<span class="number">12</span>, angle=<span class="number">90</span>, vjust=<span class="number">0</span>), <span class="comment"># likewise</span></div><div class="line">panel.grid.major = element_blank(),</div><div class="line">panel.grid.minor = element_blank(),</div><div class="line">legend.position = c(<span class="number">0.2</span>,<span class="number">0.4</span>),</div><div class="line">legend.title = element_blank(),</div><div class="line">legend.text = element_text(size=<span class="number">12</span>),</div><div class="line">legend.key.size = unit(<span class="number">1.5</span>, <span class="string">"lines"</span>),</div><div class="line">legend.key = element_blank() <span class="comment"># switch off the rectangle around symbols in the legend</span></div><div class="line">)</div><div class="line">print(f5)</div></pre></td></tr></table></figure>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180820/H5I1Ckim3m.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h2 id="第九部分分面折线星号">第九部分：分面、折线、星号</h2>
<h3 id="a.查看原始数据-1">A.查看原始数据</h3>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&gt; mdfig30a</div><div class="line">  delay     sham    SEMsham     AcbC    SEMAcbC</div><div class="line"><span class="number">1</span>     <span class="number">0</span> <span class="number">2.640708</span> <span class="number">0.09574035</span> <span class="number">3.015727</span> <span class="number">0.07431359</span></div><div class="line"><span class="number">2</span>    <span class="number">10</span> <span class="number">2.276907</span> <span class="number">0.07223806</span> <span class="number">1.977225</span> <span class="number">0.12287066</span></div><div class="line"><span class="number">3</span>    <span class="number">20</span> <span class="number">1.956931</span> <span class="number">0.07676898</span> <span class="number">1.400463</span> <span class="number">0.11313513</span></div></pre></td></tr></table></figure>
<h3 id="b.整理数据-2">B.整理数据</h3>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">mdfig30_long &lt;- rbind( data.frame( type=<span class="string">"programmed"</span>, delay=mdfig30a$delay, lesion=<span class="string">"sham"</span>, sqrtpresses = mdfig30a$sham, ysem = mdfig30a$SEMsham, xsem = <span class="number">0</span> ),</div><div class="line">data.frame( type=<span class="string">"programmed"</span>, delay=mdfig30a$delay, lesion=<span class="string">"AcbC"</span>, sqrtpresses = mdfig30a$AcbC, ysem = mdfig30a$SEMAcbC, xsem = <span class="number">0</span> ),</div><div class="line">data.frame( type=<span class="string">"experienced"</span>, delay=mdfig30b$shamdelay, lesion=<span class="string">"sham"</span>, sqrtpresses = mdfig30b$shamresponses, ysem = mdfig30b$SEMshamresponses, xsem = mdfig30b$SEMshamdelay ),</div><div class="line">data.frame( type=<span class="string">"experienced"</span>, delay=mdfig30b$AcbCdelay, lesion=<span class="string">"AcbC"</span>, sqrtpresses = mdfig30b$AcbCresponses, ysem = mdfig30b$SEMAcbCresponses, xsem = mdfig30b$SEMAcbCdelay ) )</div><div class="line"></div><div class="line">mdfig30_annotations &lt;- data.frame(</div><div class="line">x = c(<span class="number">0</span>,<span class="number">10</span>,<span class="number">20</span>,<span class="number">10</span>),</div><div class="line">y = c(<span class="number">3.2</span>,<span class="number">1.7</span>,<span class="number">1.2</span>,<span class="number">1.4</span>),</div><div class="line">type = c(<span class="string">"programmed"</span>, <span class="string">"programmed"</span>, <span class="string">"programmed"</span>, <span class="string">"experienced"</span>),</div><div class="line">label = c(<span class="string">"*"</span>, <span class="string">"*"</span>, <span class="string">"***"</span>, <span class="string">"###"</span>),</div><div class="line">lesion = c(<span class="string">"sham"</span>, <span class="string">"sham"</span>, <span class="string">"sham"</span>, <span class="string">"sham"</span>) )</div></pre></td></tr></table></figure>
<p>查看整整后的数据，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">&gt; mdfig30_long</div><div class="line">          type     delay lesion sqrtpresses       ysem      xsem</div><div class="line"><span class="number">1</span>   programmed  <span class="number">0.000000</span>   sham    <span class="number">2.640708</span> <span class="number">0.09574035</span> <span class="number">0.0000000</span></div><div class="line"><span class="number">2</span>   programmed <span class="number">10.000000</span>   sham    <span class="number">2.276907</span> <span class="number">0.07223806</span> <span class="number">0.0000000</span></div><div class="line"><span class="number">3</span>   programmed <span class="number">20.000000</span>   sham    <span class="number">1.956931</span> <span class="number">0.07676898</span> <span class="number">0.0000000</span></div><div class="line"><span class="number">4</span>   programmed  <span class="number">0.000000</span>   AcbC    <span class="number">3.015727</span> <span class="number">0.07431359</span> <span class="number">0.0000000</span></div><div class="line"><span class="number">5</span>   programmed <span class="number">10.000000</span>   AcbC    <span class="number">1.977225</span> <span class="number">0.12287066</span> <span class="number">0.0000000</span></div><div class="line"><span class="number">6</span>   programmed <span class="number">20.000000</span>   AcbC    <span class="number">1.400463</span> <span class="number">0.11313513</span> <span class="number">0.0000000</span></div><div class="line"><span class="number">7</span>  experienced  <span class="number">2.127342</span>   sham    <span class="number">2.640708</span> <span class="number">0.09574035</span> <span class="number">0.3954407</span></div><div class="line"><span class="number">8</span>  experienced  <span class="number">9.483373</span>   sham    <span class="number">2.276907</span> <span class="number">0.07223806</span> <span class="number">0.4826215</span></div><div class="line"><span class="number">9</span>  experienced <span class="number">15.812267</span>   sham    <span class="number">1.956931</span> <span class="number">0.07676898</span> <span class="number">1.0514280</span></div><div class="line"><span class="number">10</span> experienced  <span class="number">2.307076</span>   AcbC    <span class="number">3.015727</span> <span class="number">0.07431359</span> <span class="number">0.3887686</span></div><div class="line"><span class="number">11</span> experienced <span class="number">11.680260</span>   AcbC    <span class="number">1.977225</span> <span class="number">0.12287066</span> <span class="number">0.5989249</span></div><div class="line"><span class="number">12</span> experienced <span class="number">20.936766</span>   AcbC    <span class="number">1.400463</span> <span class="number">0.11313513</span> <span class="number">1.8152600</span></div><div class="line"></div><div class="line">&gt; mdfig30_annotations</div><div class="line">   x   y        type label lesion</div><div class="line"><span class="number">1</span>  <span class="number">0</span> <span class="number">3.2</span>  programmed     *   sham</div><div class="line"><span class="number">2</span> <span class="number">10</span> <span class="number">1.7</span>  programmed     *   sham</div><div class="line"><span class="number">3</span> <span class="number">20</span> <span class="number">1.2</span>  programmed   ***   sham</div><div class="line"><span class="number">4</span> <span class="number">10</span> <span class="number">1.4</span> experienced   <span class="comment">###   sham</span></div></pre></td></tr></table></figure>
<h3 id="c.绘图-3">C.绘图</h3>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">f6 &lt;- ggplot(data = mdfig30_long, aes(x = delay, y = sqrtpresses, fill = lesion) ) +</div><div class="line">facet_grid(. ~ type) +</div><div class="line">geom_line() +</div><div class="line">geom_errorbar(aes(ymin=sqrtpresses - ysem, ymax=sqrtpresses + ysem), width=<span class="number">0.8</span>) +</div><div class="line">geom_errorbarh(aes(xmin=delay - xsem, xmax=delay + xsem), height=<span class="number">0.05</span>) +</div><div class="line">geom_point(shape=<span class="number">21</span>, colour=<span class="string">"black"</span>, size=<span class="number">5</span>) +</div><div class="line">scale_fill_manual(values=c(<span class="string">"white"</span>,<span class="string">"black"</span>)) +</div><div class="line">scale_x_continuous(<span class="string">"Delay from response to reinforcer (s)"</span>) +</div><div class="line">scale_y_continuous(expression(sqrt(<span class="string">"active lever presses per minute in session 10"</span>)), expand=c(<span class="number">0</span>,<span class="number">0</span>), limits = c(<span class="number">0</span>, <span class="number">3.5</span>), breaks=<span class="number">0</span>:<span class="number">3</span>) +</div><div class="line">geom_text(data = mdfig30_annotations, aes(x = x, y = y, label = label) ) +</div><div class="line">theme_bw() +</div><div class="line">theme(plot.margin=unit(c(<span class="number">1</span>,<span class="number">1</span>,<span class="number">1.5</span>,<span class="number">2</span>), <span class="string">"lines"</span>),</div><div class="line">axis.title.x = element_text(size=<span class="number">12</span>, vjust=-<span class="number">1</span>),</div><div class="line">axis.title.y = element_text(size=<span class="number">12</span>, angle=<span class="number">90</span>, vjust=<span class="number">0</span>), <span class="comment"># likewise</span></div><div class="line">legend.title = element_blank(),</div><div class="line">legend.key.size = unit(<span class="number">1.5</span>, <span class="string">"lines"</span>),</div><div class="line">legend.key = element_blank()</div><div class="line">)</div><div class="line">print(f6)</div></pre></td></tr></table></figure>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180820/b8dBaFd5lh.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h2 id="参考资料">参考资料</h2>
<p>http://egret.psychol.cam.ac.uk/statistics/R/graphs2.html</p>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/ggplot2/" <i class="fa fa-tag"></i> ggplot2</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2017/04/23/R/ggplot2(13) - 其它图形/" rel="next" title="ggplot2(13)-其它图形">
                <i class="fa fa-chevron-left"></i> ggplot2(13)-其它图形
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2017/06/01/BioStatistics/生物统计-01统计学基础/" rel="prev" title="统计学基础汇总">
                统计学基础汇总 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  
    <div class="comments" id="comments">
      <div id="vcomments"></div>
    </div>
  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">RVDSD</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">145</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">13</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">38</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          <div class="links-of-author motion-element">
            
          </div>

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#前言"><span class="nav-number">1.</span> <span class="nav-text">前言</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#第一部分导入数据"><span class="nav-number">2.</span> <span class="nav-text">第一部分：导入数据</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#第二部分-qplot快速制图"><span class="nav-number">3.</span> <span class="nav-text">第二部分 qplot快速制图</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#第三部分ggplot制图"><span class="nav-number">4.</span> <span class="nav-text">第三部分：ggplot制图</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#第四部分输出图形"><span class="nav-number">5.</span> <span class="nav-text">第四部分：输出图形</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#第五部分自由浮动的sed"><span class="nav-number">6.</span> <span class="nav-text">第五部分：自由浮动的SED</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#a.构建数据框"><span class="nav-number">6.1.</span> <span class="nav-text">A.构建数据框</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#b.-再添加一个新的变量并查看数据如下所示"><span class="nav-number">6.2.</span> <span class="nav-text">B. 再添加一个新的变量，并查看数据，如下所示：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#c.绘图"><span class="nav-number">6.3.</span> <span class="nav-text">C.绘图</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#第六部分-绘制双变量的条形图及误差棒"><span class="nav-number">7.</span> <span class="nav-text">第六部分 绘制双变量的条形图及误差棒</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#a.整理数据"><span class="nav-number">7.1.</span> <span class="nav-text">A.整理数据</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#b.绘图"><span class="nav-number">7.2.</span> <span class="nav-text">B.绘图</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#第七部分带有注释线的误差棒"><span class="nav-number">8.</span> <span class="nav-text">第七部分：带有注释线的误差棒</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#a.查看数据"><span class="nav-number">8.1.</span> <span class="nav-text">A.查看数据</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#b.整理数据"><span class="nav-number">8.2.</span> <span class="nav-text">B.整理数据</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#c.绘图-1"><span class="nav-number">8.3.</span> <span class="nav-text">C.绘图</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#第八部分含有双向x轴的绘图"><span class="nav-number">9.</span> <span class="nav-text">第八部分：含有双向x轴的绘图</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#a.查看原始数据"><span class="nav-number">9.1.</span> <span class="nav-text">A.查看原始数据</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#b.整理数据-1"><span class="nav-number">9.2.</span> <span class="nav-text">B.整理数据</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#c.绘图-2"><span class="nav-number">9.3.</span> <span class="nav-text">C.绘图</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#第九部分分面折线星号"><span class="nav-number">10.</span> <span class="nav-text">第九部分：分面、折线、星号</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#a.查看原始数据-1"><span class="nav-number">10.1.</span> <span class="nav-text">A.查看原始数据</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#b.整理数据-2"><span class="nav-number">10.2.</span> <span class="nav-text">B.整理数据</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#c.绘图-3"><span class="nav-number">10.3.</span> <span class="nav-text">C.绘图</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#参考资料"><span class="nav-number">11.</span> <span class="nav-text">参考资料</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

<div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">RVDSD</span>

  
</div>



<div class="powered-by">
<i class="fa fa-user-md"></i><span id="busuanzi_container_site_uv">
  本站访客数:<span id="busuanzi_value_site_uv"></span>
</span>
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.3</div>




<div class="theme-info">
  <div class="powered-by"></div>
  <span class="post-count">博客全站共548.7k字</span>
</div>

        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.3"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.3"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.3"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.3"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.3"></script>



  


  




	





  





  












  





  

  

  
  

  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config("");
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="custom_mathjax_source">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->
  


  

  

</body>
</html>
