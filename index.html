<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.3" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.3">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.3" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta property="og:type" content="website">
<meta property="og:title" content="RVDSD的个人笔记本">
<meta property="og:url" content="http://rvdsd.top/index.html">
<meta property="og:site_name" content="RVDSD的个人笔记本">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="RVDSD的个人笔记本">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.3',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://rvdsd.top/"/>





  <title>RVDSD的个人笔记本</title><!-- hexo-inject:begin --><!-- hexo-inject:end -->
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">RVDSD的个人笔记本</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">学习过程中的输出</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2017/10/13/MiRNA/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/10/13/MiRNA/" itemprop="url">microRNA笔记</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-10-13T12:00:00+08:00">
                2017-10-13
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/生物笔记/" itemprop="url" rel="index">
                    <span itemprop="name">生物笔记</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  1,639
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  6
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="背景资料">背景资料</h2>
<p>MicroRNA (miRNA) 是一类由内源基因编码的长度约为22 nt的非编码单链RNA 分子,它们在动植物中参与转录后基因表达调控。大意就是，Micro RNA就是一条不会翻译蛋白的小的RNA。其单位是22nt，而不是22bp，因为nt是核苷酸，bp是碱基对，Micro RNA是用nt作为单位的，起码说明了Micro RNA是单链的。</p>
<h2 id="命名">命名</h2>
<h3 id="mirna的转录">miRNA的转录</h3>
<p>MiRNA首先是由MiRNA的host gene转录获得的，host gene转录，形成了primary microRNA（<strong>pri-MiRNA</strong>），然后通过Drosha–Pasha 复合体，形成了precursor microRNA（也就是<strong>pre-MiRNA</strong>），接着pre-MiRNA被Dicer剪切成双链的RNA，然后双链RNA被AGO1保护起来，其中一条链被降解，另一条链就被保留下来了。 <img src="http://ortxpw68f.bkt.clouddn.com/rnatrans.png"> 被降解的链一般被称之为“Passenger strand（过客链）”，这条链一般不容易被检测到，因为被降解了，这条链也被称之为星号链，一般会表示为“miR-×××*”。另一条链被称之为“Guide strand”，也就是先导链，这条就是我们通常所说的miRNA。</p>
<p>注：从图上就可以看出，Passenger strand和Guide strand链都是来源于一个基因，但它们两个还能互补。</p>
<h3 id="pri-mirna">pri-miRNA</h3>
<p><strong>pri-miRNA：</strong>长度从几百到几千个碱基不等，带有5‘帽子和3’polyA尾巴，以及1到数个发夹径环结构，如下所示<img src="http://ortxpw68f.bkt.clouddn.com/rna2.png">：</p>
<p>用上述的命名方法的话，比如我们说MiRNA-21和MiRNA-21*，就大概是这样的，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/m21.png">

</div>
<p>这个图上，我们可以看到MiRNA-21是产生在precursor microRNA的5’臂上的，而MiRNA-21*是产生于precursor microRNA的3’臂上的。“*”这个标志，主要告诉我们，这条链是“Passenger strand”，也就是miRNA-21产生的一个副产品，表达量超低，所以星号链经常被认为是没有功能的。</p>
<h3 id="mirna的5p端与3p端">miRNA的5p端与3p端</h3>
<p>但是，问题来了，2011年开始，有很多文献，开始表明miRNA星号链是有功能的（Widespread regulatory activity of vertebrate microRNA* species.，Yang，2011），星号链的功能，也有可能比先导链更为高级。那这样用“*”来标记就有点过时了。于是就产生了这样的命名方法，就是按照microRNA产生于precursor microRNA的5’臂或者是3’臂，来将miRNA表示成“MiR-×××-5p”或者“MiR-×××-3p”，这样的话miR-21，就被命名成为了“miR-21-5p”，它的星号链就被命名成为了“miR-21-3p”。之前还有用“-s”（sence）“-as”（antisence）来对先导链（先导链是-s）和星号链（星号链是-as）来命名，主要是dsRNA形成过程时的正向和反向。但由于很容易搞混，所以已经被取消了。可能看到老一点的文献中会有。</p>
<h3 id="mirna的编号">miRNA的编号</h3>
<p>pre-miRNA以“mir”命名，其编号以“MI”编号，如人的miRNA 122的前体ID为hsa-mir-122，Accession为MI0000442；而miRNA的成熟链以“miR”命名，其编号以“MIMAT”编号，如人的miR-122的一个成熟体的ID为hsa-miR-122-5p ，Accession为 MIMAT0000421。</p>
<p>因此，miRNA的命令示意图如下所示： <img src="http://mmbiz.qpic.cn/mmbiz/09BV4Hibpk83eDr6NmIKbMOr1rzMIBEIfclrxreZEUqo7p97Et92gu6KExNliaRCpDyHoCwrgt6vicGVlvuEMJeAg/0?tp=webp&amp;wxfrom=5&amp;wx_lazy=1"></p>
<h3 id="mirna命名方式的汇总">miRNA命名方式的汇总</h3>
<ol style="list-style-type: decimal">
<li>一个系统命名包含三部分内容，即物种，microRNA类别，序号。三者间用短线连接。</li>
<li>物种一般用三个小写字母表示，如hsa,mmu和rno分别代表人，小鼠和大鼠。</li>
<li>MicroRNA类别是指所命名的microRNA是pre-miRNA还是mature miRNA。pre-miRNA用mir表示，mature miRNA用miR表示。</li>
<li>序号为一阿拉伯数字，代表microRNA发现的先后。一般而言，数字越小，发现越早</li>
<li>高度同源的miRNA在No.其后加英文字母(小写,一般从a开始) 如miR-199a 和miR-199b</li>
<li>由不同染色体上的DNA序列转录加工而成的具有相同成熟体序列的miRNA，则在后面加上阿拉伯数字以区分, 如miR-199a-1和miR-199a-2；</li>
<li>如果一个前体的2个臂分别加产生miRNA，则根据克隆实验，在表达水平较低的miRNA 后面加“<em>” ，如miR-199amiR-199a</em>，或进行如下命名，miR-142-5p(也可命名为miR-142-s，表示从5’ 端的臂加工而来)和miR-142-3p(也可命名为miR-142-as，表示从3’端的臂加工而来)；</li>
<li>确定命名规则之前发现的miRNA，如let-7，则保留原来名字。</li>
</ol>
<h2 id="作用机理">作用机理</h2>
<p>作用机理的图片如下所示： <img src="http://mmbiz.qpic.cn/mmbiz/09BV4Hibpk83eDr6NmIKbMOr1rzMIBEIfPMMdeNg9D0kID2flmIMTne2be77JZmohWKz32DbF791fW5ys1f0jibA/0?tp=webp&amp;wxfrom=5&amp;wx_lazy=1"></p>
<blockquote>
<p>要说MiRNA具体是咋起作用的？好吧，给你举个例子，你感受一下。普通的mRNA就好比是一条高速公路，路上会有很多会排出尾气的汽车（核糖体，它们在mRNA上边走边翻译蛋白），一条高速路上会有很多辆车（多聚核糖体Polysome），车越多、开得越快，尾气就越大（蛋白表达量就越高），这个时候，在路快到尽头的地方（mRNA的3’UTR上）就出现了一个交警（MiRNA聚合一些蛋白的RISC，RNA-Induced SilencingComplex，RNA诱导沉默复合体），他稳稳地站在路的最后（通过RISC中的MiRNA与3’UTR互补，结合到mRNA的3’UTR上），整个车队就停下来了，尾气也没了（蛋白表达降低）。好了，现在也明白为啥过表达MiRNA之后下游基因的mRNA变化不大，但蛋白会有变化了吧？因为警察是不会拆路的……</p>
</blockquote>
<p>比较详细的图</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/rna6.jpg">

</div>
<h3 id="mirna种子区seedregion">miRNA种子区（“seed”region）</h3>
<p>5’端2-8个碱基被称为种子序列 <img src="http://ortxpw68f.bkt.clouddn.com/rna3.jpg"></p>
<h3 id="mirna与mirna靶标的结合">miRNA与miRNA靶标的结合</h3>
<p>主要有两类：5’-dominant Site和3’-compensatory Site。 1. <strong>5‘显性位点：满足经典种子区2-8完全互补结合的方式</strong>。如下所示<img src="http://ortxpw68f.bkt.clouddn.com/rna4.jpg">： 2. <strong>3’端补偿位点：5‘端并非满足2-8经典完全互补，知识部分互补，这样3‘端补偿位点结合，增强了miRNA与标靶结合稳定性，如下所示：5’-dominant Site和3’-compensatory Site，如下所示</strong><img src="http://ortxpw68f.bkt.clouddn.com/rna5.jpg"></p>
<h2 id="rna的靶点预测">RNA的靶点预测</h2>
<h3 id="工具汇总如下">工具汇总如下</h3>
<p>miEAA 网址：https://ccb-compute2.cs.uni-saarland.de/mieaa_tool/ 分析microRNA的功能、信号通路、疾病等进行分析</p>
<p>YM500v2： http://ngs.ym.edu.tw/ym500v2/index.php</p>
<p>Starbase（http://starbase.sysu.edu.cn/index.php） 交叉预测网站，既可以通过靶基因预测microRNA也可以通过microRNA预测靶基因。</p>
<p>miRPathDB（https://mpd.bioinf.uni-sb.de/overview.html） 查询参与通路内调控的miRNAs，包含了人、鼠两类数据。</p>
<p>mirbase（mirbase：http://www.mirbase.org/）</p>
<h2 id="参考资料">参考资料：</h2>
<ol style="list-style-type: decimal">
<li><a href="https://mp.weixin.qq.com/s?__biz=MzA3ODU1NjUyNw==&amp;mid=404311107&amp;idx=1&amp;sn=85308a8ad9806f65072de4c8ed79f54c&amp;scene=1&amp;srcid=0314tK0Lw7HkKyoJRoAjwPmg#rd" target="_blank" rel="external">miRNA到底是怎么命名的？</a></li>
<li><a href="https://mp.weixin.qq.com/s?__biz=MzA3ODU1NjUyNw==&amp;mid=200526001&amp;idx=1&amp;sn=ae82f47928f8cd4c519c89f69ab8d103&amp;scene=21#wechat_redirect" target="_blank" rel="external">Micro RNA，从一窍不通到略知一二</a></li>
<li><a href="http://mp.weixin.qq.com/s?__biz=MzA5ODQ1NDIyMQ==&amp;mid=2649602388&amp;idx=2&amp;sn=6097b6c76944a795a628bce7fbbac934&amp;chksm=888846f6bfffcfe0a579d0a9bd1dd24083a28937c4057db9e25abd3c006858b8d2675690f5ae&amp;mpshare=1&amp;scene=1&amp;srcid=0901fXzOX8InCPG3nb2oSiDS#rd" target="_blank" rel="external">搞懂RNA命名，miRNA、lncRNA、circRN不再傻傻分不清</a></li>
<li><a href="https://mp.weixin.qq.com/profile?src=3&amp;timestamp=1507870340&amp;ver=1&amp;signature=y-Qin6PEYzPl9NMOQjgJYLIB1ca8JQ1JnnITRYLuVFI*N2jLLUI74CFzvPaSyi-PVLDYcUEOeEIiXXC4QtOf4w==" target="_blank" rel="external">艾博思生物（公众号： ibsbio）</a></li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2017/10/08/转录组学习笔记08差异基因结果注释/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/10/08/转录组学习笔记08差异基因结果注释/" itemprop="url">转录组学习笔记08-差异基因结果注释</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-10-08T12:00:00+08:00">
                2017-10-08
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/生物信息学/" itemprop="url" rel="index">
                    <span itemprop="name">生物信息学</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  0
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  1
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2017/10/07/转录组学习笔记07差异基因分析/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/10/07/转录组学习笔记07差异基因分析/" itemprop="url">转录组学习笔记07-差异基因分析</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-10-07T12:00:00+08:00">
                2017-10-07
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/生物信息学/" itemprop="url" rel="index">
                    <span itemprop="name">生物信息学</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  152
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  1
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="前言">前言</h2>
<p>原文中人类的样本只有3个，一个对照，两个实验。由于DESeq2分析时，样本必须要有重复，因此我们自己再生成一个对照（这里只是为了学习而自己生成一个，实际分析过程中我觉得这种方法不行）。</p>
<p>必须得要有重复的问题亟待解决，没办法我只能自己瞎编了。虽然是编，我们也要有模有样，不能直接复制一份，要考虑到高通量测序的read是默认符合泊松分布的。我是这样编的。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2017/10/06/转录组学习笔记06reads计数/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/10/06/转录组学习笔记06reads计数/" itemprop="url">转录组学习笔记06-reads计数</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-10-06T12:00:00+08:00">
                2017-10-06
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/生物信息学/" itemprop="url" rel="index">
                    <span itemprop="name">生物信息学</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  0
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  1
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2017/10/05/转录组学习笔记05序列比对/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/10/05/转录组学习笔记05序列比对/" itemprop="url">转录组学习笔记05-序列比对</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-10-05T12:00:00+08:00">
                2017-10-05
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/生物信息学/" itemprop="url" rel="index">
                    <span itemprop="name">生物信息学</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  931
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  4
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="任务">任务：</h2>
<blockquote>
<ol style="list-style-type: decimal">
<li>搞懂hisat2的用法。</li>
<li>直接去hisat2的主页下载index文件即可，然后把fastq格式的reads比对上去得到sam文件。</li>
<li>接着用samtools把它转为bam文件，并且排序(注意N和P两种排序区别)索引好，载入IGV，再截图几个基因看看。</li>
<li>顺便对bam文件进行简单QC，参考直播我的基因组系列。 来源于生信技能树：http://www.biotrainee.com/forum.php?mod=viewthread&amp;tid=1750#lastpost</li>
</ol>
</blockquote>
<h2 id="比对软件">比对软件</h2>
<p>HISAT2：http://ccb.jhu.edu/software/hisat2/index.shtml 参考资料：http://blog.biochen.com/archives/337</p>
<p>STAR：https://codeload.github.com/alexdobin/STAR/zip/master 参考资料：http://www.bio-info-trainee.com/727.html</p>
<p>TopHat：http://ccb.jhu.edu/software/tophat/index.shtml 参考资料：http://blog.sina.com.cn/s/blog_8808cae20101amqp.html</p>
<p>RapMap：https://github.com/COMBINE-lab/RapMap 参考：https://academic.oup.com/bioinformatics/article/32/12/i192/2288985/RapMap-a-rapid-sensitive-and-accurate-tool-for</p>
<p>CIDANE：http://ccb.jhu.edu/software/cidane/ 参考文献：https://genomebiology.biomedcentral.com/articles/10.1186/s13059-015-0865-0</p>
<p>CLASS2 ：https://sourceforge.net/projects/splicebox/files/?source=navbar 参考文献：https://academic.oup.com/nar/article/44/10/e98/2516329/CLASS2-accurate-and-efficient-splice-variant</p>
<blockquote>
<p>内容主要参考：http://www.360doc.com/content/16/1223/13/29483982_617058719.shtml</p>
</blockquote>
<h3 id="hisat2的使用">1. HISAT2的使用</h3>
<p>人类和小鼠的索引有现成的，HISAT2官网可以直接下载进行序列比对。如下图所示：选择hg19和mm10的index，文章中RNA-Seq测序数据，可以包括人类的3个数据和小鼠的4个数据，因此需要小鼠和人类的索引。</p>
<h3 id="人类和小鼠index下载">人类和小鼠index下载</h3>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">mkdir -p ~/disk2/data/reference/index</div><div class="line">cd ~/disk2/data/reference/index</div><div class="line">wget ftp://ftp.ccb.jhu.edu/pub/infphilo/hisat2/data/hg19.tar.gz</div><div class="line"> wget ftp://ftp.ccb.jhu.edu/pub/infphilo/hisat2/data/mm10.tar.gz</div><div class="line"># 解压得到两个目录，hg19和mm10</div><div class="line">tar -zxvf *.tar.gz</div><div class="line"># 删除压缩包</div><div class="line">rm -rf *.tar.gz</div></pre></td></tr></table></figure>
<h3 id="比对序列得到sam文件">比对序列，得到sam文件</h3>
<p>Usage：hisat2 [options]* -x {-1 -2 | -U | –sra-acc } [-S ]</p>
<p>参数： &gt; -x 指定index文件 -1 双端测序第一个文件 -2 双端测序第二个文件 -U 单端测序文件 –sra-acc SRA accession number -S 指定输出的格式，一般指定为sam</p>
<p>代码如下： <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">for ((i=56;i&lt;=58;i++));do hisat2 -t -x /media/w/新加卷/Download/reference/hg19/genome -1 /media/w/新加卷/Download/outdata/_media_w_新加卷_Download_data_SRR35899$&#123;i&#125;.sra_1.fastq.gz -2 /media/w/新加卷/Download/outdata/_media_w_新加卷_Download_data_SRR35899$&#123;i&#125;.sra_2.fastq.gz -S /media/w/新加卷/Download/align/SRR35899$&#123;i&#125;.sam;donefor ((i=56;i&lt;=58;i++));do hisat2 -t -x /media/w/新加卷/Download/reference/hg19/genome -1 /media/w/新加卷/Download/outdata/_media_w_新加卷_Download_data_SRR35899$&#123;i&#125;.sra_1.fastq.gz -2 /media/w/新加卷/Download/outdata/_media_w_新加卷_Download_data_SRR35899$&#123;i&#125;.sra_2.fastq.gz -S /media/w/新加卷/Download/align/SRR35899$&#123;i&#125;.sam;done</div></pre></td></tr></table></figure></p>
<h3 id="samtools">SAMTools</h3>
<p>SAM（sequence Alignment/mapping)数据格式是目前高通量测序中存放比对数据的标准格式，当然他可以用于存放未比对的数据。所以，SAM的格式说明</p>
<p>而目前处理SAM格式的工具主要是SAMTools，这是Heng Li大神写的，除了C语言版本，还有Java的Picard，Python的Pysam，Common lisp的cl-sam等其他版本。SAMTools的主要功能如下：</p>
<blockquote>
<p>view: BAM-SAM/SAM-BAM 转换和提取部分比对 sort: 比对排序 merge: 聚合多个排序比对 index: 索引排序比对 faidx: 建立FASTA索引，提取部分序列 tview: 文本格式查看序列 pileup: 产生基于位置的结果和 consensus/indel calling 最常用的三板斧就是格式转换，排序，索引。而进阶教程就是看文档提高。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">for i in `seq 56 58`</div><div class="line">do</div><div class="line">    samtools view -S SRR35899$&#123;i&#125;.sam -b &gt; SRR35899$&#123;i&#125;.bam </div><div class="line">    # 将sam文件转化为bam文件；参数-S表示输入sam文件，参数-b表示输出文件为bam，最后重定向输入bam文件</div><div class="line">    </div><div class="line">    samtools sort SRR35899$&#123;i&#125;.bam -o SRR35899$&#123;i&#125;_sorted.bam</div><div class="line">    # 对所有的bam文件进行排序；</div><div class="line">    </div><div class="line">    samtools index SRR35899$&#123;i&#125;_sorted.bam</div><div class="line">    将所有的排序文件建立索引，索引文件</div><div class="line">done</div></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2017/10/04/转录组学习笔记04了解参考基因组及基因注释/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/10/04/转录组学习笔记04了解参考基因组及基因注释/" itemprop="url">转录组学习笔记04-了解参考基因组及基因注释</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-10-04T12:02:00+08:00">
                2017-10-04
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/生物信息学/" itemprop="url" rel="index">
                    <span itemprop="name">生物信息学</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  1,909
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  7
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="目标">目标</h2>
<blockquote>
<p>在UCSC下载hg19参考基因组，群主博客有详细说明，从gencode数据库下载基因注释文件，并且用IGV去查看你感兴趣的基因的结构，例如TP53，EGFR等等。 截图几个基因的IGV可视化结构！还可以下载ENSEMBL，NCBI的GTF，也导入IGV看看，截图基因结构。了解IGV常识。 来源于生信技能树：http://www.biotrainee.com/forum.php?mod=viewthread&amp;tid=1750#lastpost</p>
</blockquote>
<h2 id="什么是参考基因组">什么是参考基因组？</h2>
<blockquote>
<p>测序得到的是几百bp的短read， 相当于把拼图打散了给你。如果没有参考基因组，从头(de novo)组装等于是重走人类基因组计划的老路，也就是打散了拼图，却不告诉你原来是什么样子，那么任务将会及其艰巨。还好人类基因组已经组装好了，我们只需要把我们测得序列回贴（mapping)回去，毕竟人与人之间的差距只有不到1%差异, 允许mismatch就行。</p>
</blockquote>
<blockquote>
<p>参考基因组对新手来说，是一个很大的坑，hg19、GRCH37、 ensembl 75这3种基因组版本应该是大家见得比较多的了，国际通用的人类参考基因组，其实他们储存的是同样的fasta序列，只是分别对应着三种国际生物信息学数据库资源收集存储单位，即NCBI，UCSC及ENSEMBL各自发布的基因组信息而已。有一些参考基因组比较小众，存储的序列也不一样，比如BGI做的炎黄基因组，还有DNA双螺旋结构提出者沃森（Watson）的基因组，还有2016年发表在nature上面的号称最完善的韩国人做的基因组。前期我们先不考虑这些小众基因组，主要就下载hg19和hg38，都是UCSC提供的，虽然hg38相比hg19来说，做了很多改进，优点也不少，但因为目前为止很多注释信息都是针对于hg19的坐标系统来的，我们就都下载了，正好自己探究一下。也顺便下载一个小鼠的最新版参考基因组吧，反正比对也就是睡个觉的功夫，顺便分析一下结果，看看比对率是不是很低。</p>
</blockquote>
<h3 id="参考基因组hg19下载">参考基因组hg19下载</h3>
<p>这里下载的是USCS版本的参考基因组。</p>
<h4 id="下载uscs版本的hg19">下载USCS版本的hg19</h4>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">mkdir -p ~/disk2/data/reference/genome</div><div class="line">cd ~/disk2/data/reference/genome</div><div class="line">nohup wget http://hgdownload.soe.ucsc.edu/goldenPath/hg19/bigZips/chromFa.tar.gz &amp;</div><div class="line"># 解压，得到所有染色体的信息</div><div class="line">tar -zxvf chromFa.tar.gz</div><div class="line"># 将所有的染色体信息整合在一起，重定向写入hg19.fa文件，得到参考基因组</div><div class="line">cat *.fa &gt; hg19.fa</div><div class="line"># 将多余的染色体信息文件删除，节省空间</div><div class="line">$ rm -rf chr*</div></pre></td></tr></table></figure>
<p>由于下载速度慢，我就改用迅雷下载了，将所有染色体信息整合后，得到新的hg19.fa文件。</p>
<h2 id="什么是参考基因组注释">什么是参考基因组注释？</h2>
<blockquote>
<p>参考基因组是一部无字天书，要想解读书中的内容，需要额外的注释信息协助。因此下载完参考基因后，就是去gencode数据库（http://www.gencodegenes.org/)下载基因组注释文件。简单来讲注释文件就是基因组的说明书，告诉我们哪些序列是编码蛋白的基因，哪些是非编码基因，外显子、内含子、UTR等的位置等等。注释文件在以上三个提供参考基因组的网站中都有提供，比如Ensemble。但是现在最权威的人类和小鼠基因组的注释还属Gencode数据库。</p>
</blockquote>
<h3 id="参考基因组注释下载">参考基因组注释下载</h3>
<p>进入人和小鼠基因组注释信息官网<a href="http://www.gencodegenes.org/" target="_blank" rel="external">GENCODE</a>，选择data-&gt;human-&gt;GRCh37-mapped Releases，下载最新第26版本的hg19人类基因组注释信息。点击进入下载页面，将GTF和GFF3全部下载，解压，如下所示： <img src="http://ortxpw68f.bkt.clouddn.com/rnqseqresult15.png"></p>
<p>可以看到已经有新的参考基因组注释了，不过现在还用老的，跟参考资料中的保持一致一样，单击26，进入下载界面，下载第一行的注释信息，即Comprehensive gene annotaton中的GTF和GFF3，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/rnqseqresult16.png">

</div>
<h4 id="gff文件与gtf文件的区别">GFF文件与GTF文件的区别</h4>
<p>GFF全称为general feature format，这种格式主要是用来注释基因组。 GTF全称为gene transfer format，主要是用来对基因进行注释。</p>
<h5 id="gff">GFF</h5>
<p>GFF文件是一种用来描述基因组特征的文件，现在我们所使用的大部分都是第三版）（GFF3）。GFF允许使用#作为注释符号，例如很多GFF文件都会使用如下的两行来表明其版本其创建日期： <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">##gff-version 2</div><div class="line">##created 11/11/11</div></pre></td></tr></table></figure></p>
<p>GFF文件每一列所代表的含义后面表格中有，但请注意，它的第3列feature type是不受约束的，你可以使用任意的名称。我们需要注意的是GFF文件的第9列，从第二版开始(GFF2)，所有的属性都以标签=值的方式呈现，各个属性之间以;作为分隔符 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ID=geneAExon1;Name=geneA;Parent=geneA;Organism=human</div></pre></td></tr></table></figure></p>
<p>在最新版本的GFF文件中(GFF3)，有一些是已经预先定义的属性特征，并且这些特征往往还有特殊的含义：ID这个标签实在各行都要有的；另外有一个Parent的属性，它表明了当前的特征是Parent特征的子集。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">Contig01  PFAM  gene  501  750  .  +  0  ID=geneA;Name=geneA</div><div class="line">Contig01  PFAM  exon  501  650  .  +  2  ID=exonA1;Parent=geneA</div><div class="line">Contig01  PFAM  exon  700  750  .  +  2  ID=exonA2;Parent=geneA</div></pre></td></tr></table></figure>
<h5 id="gtf">GTF</h5>
<p>当前所广泛使用的GTF格式为第二版(GTF2)，它主要是用来描述基因的注释。GTF格式有两个硬性标准：</p>
<ul>
<li>根据所使用的软件的不同，feature types是必须注明的。</li>
<li>第9列必须以gene_id以及transcript_id开头,GTF文件的第9列同GFF文件不同，虽然同样是标签与值配对的情况，但标签与值之间以空格分开，且每个特征之后都要有分号;（包括最后一个特征）</li>
</ul>
<table>
<thead>
<tr class="header">
<th align="center">列</th>
<th align="center">GTF2</th>
<th align="center">GFF3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">1.reference sequence name</td>
<td align="center">same</td>
<td align="center">same</td>
</tr>
<tr class="even">
<td align="center">2.annotation source</td>
<td align="center">same</td>
<td align="center">same</td>
</tr>
<tr class="odd">
<td align="center">3.feature type</td>
<td align="center">feature requirements depend on software</td>
<td align="center">can be anything</td>
</tr>
<tr class="even">
<td align="center">4.start coordinate</td>
<td align="center">same</td>
<td align="center">same</td>
</tr>
<tr class="odd">
<td align="center">5. end coordinate</td>
<td align="center">same</td>
<td align="center">same</td>
</tr>
<tr class="even">
<td align="center">6.score</td>
<td align="center">not used</td>
<td align="center">optional</td>
</tr>
<tr class="odd">
<td align="center">7.strand</td>
<td align="center">same</td>
<td align="center">same</td>
</tr>
<tr class="even">
<td align="center">8.frame</td>
<td align="center">same</td>
<td align="center">same</td>
</tr>
<tr class="odd">
<td align="center">9.attributes</td>
<td align="center">空格分隔</td>
<td align="center">=分隔</td>
</tr>
</tbody>
</table>
<h2 id="igv下载及使用">IGV下载及使用</h2>
<p>Integrative Genomics Viewer(IGV)是一种探索大型综合基因组数据的高性能交互式可视化工具。它支持各种各样的数据类型，包括基于芯片测序、二代测序数据和基因组注释数据等。</p>
<h3 id="igv下载">IGV下载</h3>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">wget http://data.broadinstitute.org/igv/projects/downloads/IGV_2.3.97.zip</div><div class="line">unzip IGV_2.3.97.zip &amp;&amp; mv IGV_2.3.97 ~/biosoft</div><div class="line"># 添加环境变量</div><div class="line">vim ~/.bashrc</div><div class="line">PATH=$PATH:~/biosoft/IGV_2.3.97</div><div class="line">source ~/.bashrc</div><div class="line"># 运行IGV，Linux直接运行igv.sh可以开启IGV窗口，但是会比较慢，要耐心等待。</div><div class="line">igv.sh</div></pre></td></tr></table></figure>
<p>如下所示： <img src="http://ortxpw68f.bkt.clouddn.com/gene.png"></p>
<ol start="2" style="list-style-type: decimal">
<li>将gff3进行排序，选择Tools-Run igvtools，进入以下igvtools窗口：</li>
<li>获得sorted文件：command选择sort，再选择输入的注释文件，点击Run，就可以生成sorted.gff3文件。</li>
<li>通过file-&gt;load from file…选择sorted文件，打开。选择区域的大小，来看某些基因的信息，蓝色的粗线条就是代表基因。说到底，IGV就是一个将基因组及其注释信息可视化的工具。</li>
<li>载入基因组，选择Genome菜单，load我们之前已经下载好的hg19.fa基因组。 <a href="http://" target="_blank" rel="external"></a> ## 参考资料</li>
<li><a href="http://www.jianshu.com/p/48b5a0972301" title="GTF/GFF文件的差异及其相互转换" target="_blank" rel="external">西瓜要吃我：GTF/GFF文件的差异及其相互转换</a></li>
<li><a href="https://mp.weixin.qq.com/s?src=11&amp;timestamp=1506517822&amp;ver=418&amp;signature=QNwxvwkv4bNMDcJz2vUTLviJoBKxkHbGxGJ43uI7BYy-A-mFegoSGjQzA8bAabAaTG8i-UrJUfAN9-urbdwOdAMRKD6YjHdEhSrEwJbFrDju6T-hNaTlF3jyI3GM32yi&amp;new=1" target="_blank" rel="external">从零开始学转录组：了解参考基因组及基因注释</a></li>
<li><a href="http://www.bio-info-trainee.com/1985.html" target="_blank" rel="external">【直播】我的基因组（五）:测试数据及参考基因组的准备</a></li>
<li><a href="https://mp.weixin.qq.com/s?src=11&amp;timestamp=1506519445&amp;ver=418&amp;signature=zsljCkmEwtWskZsTgvrZWMFje3IV1oND44lIkV9hNPFUoDJNlQXu7VHE51HlLImOwXDgcZjHZG9eGoetHpDFjXQiB0qoCfrIt8tw8IUNYwNDPja2pskXJaEfltNzU7Xp&amp;new=1" target="_blank" rel="external">如何下载注释文件并查看基因结构</a></li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2017/10/03/转录组学习笔记03了解fastq测序数据/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/10/03/转录组学习笔记03了解fastq测序数据/" itemprop="url">转录组学习笔记03-了解fastq测序数据</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-10-03T12:00:00+08:00">
                2017-10-03
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/生物信息学/" itemprop="url" rel="index">
                    <span itemprop="name">生物信息学</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  2,275
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  9
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="任务">任务：</h2>
<blockquote>
<p>需要用安装好的sratoolkit把sra文件转换为fastq格式的测序文件，并且用fastqc软件测试测序文件的质量！ 作业，理解测序reads，GC含量，质量值，接头，index，fastqc的全部报告，搜索中文教程，并发在论坛上面。 来源于生信技能树：http://www.biotrainee.com/forum.php?mod=viewthread&amp;tid=1750#lastpost</p>
</blockquote>
<h3 id="将sra转换为fastq格式">将sra转换为fastq格式</h3>
<h4 id="sra格式">sra格式</h4>
<p>下载的原始数据是sra格式，SRA（Sequence ReadArchive）数据库是用于存储二代测序的原始数据，包括 454，Illumina，SOLiD，IonTorrent，Helicos 和 CompleteGenomics。除了原始序列数据外，SRA现在也存在raw reads在参考基因的比对信息。</p>
<h4 id="fastq格式">fastq格式：</h4>
<p>Fastq格式是一种基于文本的存储生物序列和对应碱基（或氨基酸）质量的文件格式。最初由桑格研究所（Wellcome Trust Sanger Institute）开发出来，现已成为存储高通量测序数据的事实标准。</p>
<h4 id="fastq格式说明">fastq格式说明</h4>
<p>FASTQ文件中每个序列通常有四行： 1. 序列标识以及相关的描述信息，以‘@’开头；后面跟着序列的唯一ID以及相关说明内容。 2. 第二行是核酸序列，是有ATCGN字符组成 3. 第三行以‘+’开头，后面是序列标示符、描述信息，或者什么也不加 4. 第四行，每个测序碱基质量，是用ASCII码来表示的，与第二行的字符数一致。 碱基质量得分与错误率的换算关系： Q = -10log10p（p表示测序的错误率，Q表示碱基质量分数） ASCII值与碱基质量得分之间的关系： Phred64 Q=ASCII转换后的数值-64 Phred33 Q=ASCII转换后的数值-33</p>
<h5 id="一个典型的fastq文件如下所示">一个典型的fastq文件如下所示：</h5>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">@SEQ_ID</div><div class="line">GATTTGGGGTTCAAAGCAGTATCGATCAAATAGTAAATCCATTTGTTCAACTCACAGTTT</div><div class="line">+</div><div class="line">!&apos;&apos;*((((***+))%%%++)(%%%%).1***-+*&apos;&apos;))**55CCF&gt;&gt;&gt;&gt;&gt;&gt;CCCCCCC65</div></pre></td></tr></table></figure>
<blockquote>
<p>如何判断是Phred64 还是 Phred33 ？ ASCII值小于等于58（相应的质量得分小于等于25）对应的字符只有在Phred+33的编码中被使用，所有Phred+64所使用的字符的ASCII值都大于等于59。在通常情况下，ASCII值大于等于74的字符只出现在Phred+64中。如果是最近两年的测序数据，一般都是Phred33形式的。参考文章：http://blog.csdn.net/huyongfeijoe/article/details/51613827</p>
</blockquote>
<h4 id="转换工具fastq-dump">转换工具：fastq-dump</h4>
<p>将sra格式转换为fastq格式的工具是sratoolkit的fastq-dump，可以先用fastq-dump -h看一下帮助文件，分为如下几个部分：</p>
<blockquote>
<p>输入： -A|—accession 序列号 处理中: Read Splitting, Full Spot Filters, Common Filters, Filters based on alignments, Filters for individual reads。 基本都是些过滤参数。不太常用 输出： -O|—outdir 输出文件夹， -Z|—stdout 输出到标准输出， —gzip/—bzip2 输出为压缩格式 多文件选项： 常用的就是—split-3，split-3表示如果是单端测序则一个sra文件出来一个fastq文件，如果是双末端，则一个sra问件对应两个fastq问件SRRXXXXXX_1.fastq,SRRXXXXXX_2.fastq 格式化： 分为序列， 质量等，不常用 –gzip 使得输出的结果是.gz 的格式</p>
</blockquote>
<p>现在将disk2/sra下的sra文件转化为fastq格式，其中输入目录为disk2/sra，输出目录为/disk2/data/rna-seq，命令如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">for ((i=56;i&lt;=62;i++))</div><div class="line">do fastq-dump --gzip --split-3 -A ~/disk2/sra/SRR35899$i.sra -O ~/disk2/data/rna-seq</div><div class="line">done</div></pre></td></tr></table></figure>
<p>转换后的结果如下所示： <img src="http://ortxpw68f.bkt.clouddn.com/rnqseqfastq.png"></p>
<h3 id="对fastqc格式进行质控">对fastqc格式进行质控</h3>
<h4 id="工具fastqc">工具：Fastqc</h4>
<p>用法如下所示：</p>
<blockquote>
<p>fastqc [-o output dir] [–(no)extract] [-f fastq|bam|sam] [-c contaminant file] seqfile1 .. seqfileN 1. 参数： -o 输出目录，需自己创建目录 2. –(no)extract 是否解压输出文件，默认是自动解压缩zip文件。加上–noextract不解压文件。 3. -f 指定输入文件的类型，支持fastq|bam|sam三种格式的文件，默认自动识别。 4. -t 同时处理的文件数目。 5. -c 是contaminant 文件，会从中搜索overpresent 序列。</p>
</blockquote>
<p>代码如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">mkdir -p ~/disk2/data/QC</div><div class="line">cd ~/disk2/data/rna-seq</div><div class="line"># 将所有的数据进行质控，得到zip的压缩文件和html文件</div><div class="line">fastqc -o ~/disk2/data/QC *.fastq.gz</div></pre></td></tr></table></figure>
<h4 id="质控结果查看">质控结果查看：</h4>
<h5 id="质控后的文件如下所示">1. 质控后的文件如下所示：</h5>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/rnqseqqc.png">

</div>
<p>质控结果有14个html文件，可以选择用浏览器打开查看最终的QC reports。随便打开一个质控结果文件，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/rnaseqqc1.png">

</div>
<h5 id="质控报告的内容">2. 质控报告的内容</h5>
<p>左边是目录概要，一共12项内容，如下所示：</p>
<ol style="list-style-type: decimal">
<li>Basic Statistics</li>
<li>Per base sequence quality</li>
<li>Per tile sequence quality</li>
<li>Per sequence quality scores</li>
<li>Per base sequence content</li>
<li>Per sequence GC content</li>
<li>Per base N content</li>
<li>Sequence Length Distribution</li>
<li>Sequence Duplication Levels</li>
<li>Overrepresented sequences</li>
<li>Adapter Content</li>
<li>Kmer Content</li>
</ol>
<p>可以点击想要看的结果，右边会跳转到特定详细的可视化结果。绿色代表“通过”，黄色代表“警告”，红色代表“不通过，失败”，如下所示： <img src="http://ortxpw68f.bkt.clouddn.com/rnaseqresult1.png"></p>
<h6 id="basic-statistics">2.1 Basic Statistics</h6>
<p>基本的数据统计包括文件名，文件类型，编码形式，总的序列数，质量差的序列，序列平均长度，GC含量。 <img src="http://ortxpw68f.bkt.clouddn.com/rnaseqresult2.png"></p>
<h6 id="per-base-sequence-quality">2.2 Per base sequence quality</h6>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/rnqseqresult3.png">

</div>
<p>图片太大，下部图片如下所示：</p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/rnqseqresult4.png"> 每个read各位置碱基的测序质量。横轴碱基的位置，纵轴是质量分数，Quality score=-10log10p（p代表错误率），所以当质量分数为40的时候，p就是0.0001，质量算高了。红色线代表中位数，蓝色代表平均数，黄色是25%-75%区间，触须是10%-90%区间（黄色和触须我不是特别明白）。若任一位置的下四分位数低于10或者中位数低于25，出现“警告”；若任一位置的下四分位数低于5或者中位数低于20，出现“失败，Fail”。</p>
<h6 id="per-tile-sequence-quality">2.3 Per tile sequence quality</h6>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/rnaseqresult5.png">

</div>
<p>检查reads中每一个碱基位置在不同的测序小孔之间的偏离度，蓝色代表偏离度小，质量好，越红代表偏离度越大，质量越差。</p>
<h6 id="per-sequence-quality-scoresreads">2.4 Per sequence quality scores，reads</h6>
<p>质量的分布，当峰值小于27时，警告；当峰值小于20时，fail。可以看出这个测序的报告峰值在38左右。</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/rnaseqresult6.png">

</div>
<h6 id="per-base-sequence-content">2.5 Per base sequence content</h6>
<p>对所有reads的每一个位置，统计ATCG四种碱基的分布，横轴为位置，纵轴为碱基含量，正常情况下每个位置每种碱基出现的概率是相近的，四条线应该平行且相近。当部分位置碱基的比例出现bias时，即四条线在某些位置纷乱交织，往往提示我们有overrepresented sequence的污染。本结果前10个位置，每种碱基频率有明显的差别，说明有污染。当任一位置的A/T比例与G/C比例相差超过10%，报“WARN”；当任一位置的A/T比例与G/C比例相差超过20%，报“FAIL”。</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/rnqseqresult7.png">

</div>
<h6 id="per-sequence-gc-content">2.6 Per Sequence GC Content</h6>
<p>统计reads的平均GC含量的分布。红线是实际情况，蓝线是理论分布（正态分布，均值不一定在50%，而是由平均GC含量推断的）。 曲线形状的偏差往往是由于文库的污染或是部分reads构成的子集有偏差（overrepresented reads）。形状接近正态但偏离理论分布的情况提示我们可能有系统偏差。偏离理论分布的reads超过15%时，报“WARN”；偏离理论分布的reads超过30%时，报“FAIL”。</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/rnqseqresult8.png">

</div>
<h6 id="per-base-n-content">2.7 Per base N content</h6>
<p>当测序仪器不能辨别某条reads的某个位置到底是什么碱基时，就会产生“N”，统计N的比率。正常情况下，N值非常小。当任意位置的N的比例超过5%，报“WARN”；当任意位置的N的比例超过20%，报“FAIL”。 <img src="http://ortxpw68f.bkt.clouddn.com/rnqseqresult9.png"></p>
<h6 id="sequence-length-distribution">2.8 Sequence Length Distribution</h6>
<p>reads长度分布，当reads长度不一致时报“WARN”；当有长度为0的read时报“FAIL”。</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/rnqseqresult10.png">

</div>
<h6 id="sequence-duplication-levels">2.9 Sequence Duplication Levels</h6>
<p>统计不同拷贝数的reads的频率。测序深度越高，越容易产生一定程度的duplication，这是正常的现象，但如果duplication的程度很高，就提示我们可能有bias的存在。横坐标是duplication的次数，纵坐标是duplicated reads的数目，以unique reads的总数作为100%。下图中，大于10个重复的reads占总序列的20%以上，其他依次类推。当非unique的reads占总数的比例大于20%时，报“WARN”；当非unique的reads占总数的比例大于50%时，报“FAIL“。</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/rnqseqresult11.png">

</div>
<h6 id="overrepresented-sequences">2.10 Overrepresented sequences</h6>
<p>一条序列的重复数，因为一个转录组中有非常多的转录本，一条序列再怎么多也不太会占整个转录组的一小部分（比如1%），如果出现这种情况，不是这种转录本巨量表达，就是样品被污染。这个模块列出来大于全部转录组1%的reads序列，但是因为用的是前200,000条，所以其实参考意义不大，完全可以忽略。</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/rnqseqresult12.png">

</div>
<h6 id="adapter-content">2.11 Adapter content</h6>
<p>接头含量</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/rnqseqresult13.png">

</div>
<h6 id="kmer-content">2.12 Kmer content</h6>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/rnqseqresult14.png">

</div>
<h3 id="批量质控结果查看multiqc">批量质控结果查看MultiQC</h3>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"># 安装multiqc</div><div class="line">$ conda install -c bioconda multiqc</div><div class="line"># 测试</div><div class="line">$ multiqc --help</div><div class="line"># 进入存放QC结果的文件夹，空白处右键“在终端打开”</div><div class="line"></div><div class="line"># 扫描结果文件，忽略html文件</div><div class="line">$ multiqc ./*fastqc.zip --ignore *.html</div><div class="line"># 最后会默认生成一个名为multiqc_report.html文件，用浏览器查看</div></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2017/10/02/转录组学习笔记02-读文章获取测序数据/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/10/02/转录组学习笔记02-读文章获取测序数据/" itemprop="url">转录组学习笔记02-读文献下载测序数据</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-10-02T12:00:00+08:00">
                2017-10-02
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/生物信息学/" itemprop="url" rel="index">
                    <span itemprop="name">生物信息学</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  2,002
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  8
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="任务目标">任务目标：</h2>
<blockquote>
<p>本系列课程学习的文章是：AKAP95 regulates splicing through scaffolding RNAs and RNA processing factors. Nat Commun 2016 Nov 8;7:13347. PMID: 27824034 很容易在文章里面找到数据地址GSE81916 这样就可以下载sra。</p>
</blockquote>
<h2 id="文章主要内容">文章主要内容</h2>
<h3 id="测序物种">测序物种</h3>
<p>人类，小鼠； ###实验类型 高通量测序 ###摘要 pre-mRNA的可变剪切与高等生物基因表达的复杂性有关，但是可变剪切位点的选择却未研究清楚。作者在以前的研究中发现了一个染色质相关的蛋白AKAP95（AKAP8）在强化染色质转录方向有着明显的影响。在本文的研究中，APAKP95能与许多涉及转录和RNA加工的因子相互作用，调节pre-mRNA的剪接。AKAP95直接促进内源基因FAM126A的特异性外显子的体外剪接和包含。 AKAP95N-末端富含YG的结构域在与RNA加工因子（例如hnRNP蛋白）结合的过程中有着重要的作用，它的锌指结构域对于pre-mRNA的结合至关重要。基因组结合的分析显示，AKAP95优先结合人类转录组中大量pre-mRNA的近端内含子区域，AKAP95的敲除能导致多外显子增加的减少。AKAP95还可以选择性地协调hnRNP H/ F和U蛋白来调节可变剪接事件。进一步表明，AKAP95与自身直接相互作用。总之，实验的研究结果表明，AKAP95是pre-mRNA剪接的新型，并且是正向调节因子，它有可能是一个转录和剪接调节整合子，并且实验提出了一个模型，即AKAP95通过支架RNA和RNA加工因子调节pre-mRNA剪接，并促进剪接位点之间的信息交流。</p>
<p>原英文摘要： &gt;Alternative splicing of pre-mRNAs significantly contributes to the complexity of gene expression in higher organisms, but the regulation of the splice site selection remains incompletely understood. We have previously demonstrated that a chromatin-associated protein, AKAP95 (AKAP8), has a remarkable activity in enhancing chromatin transcription. In this study, we have shown that AKAP95 physically interacts with many factors involved in transcription and RNA processing, and functionally regulates pre-mRNA splicing. AKAP95 directly promotes splicing in vitro and the inclusion of a specific exon of an endogenous gene FAM126A. The N-terminal YG-rich domain of AKAP95 is important for its binding to RNA processing factors including selective groups of hnRNP proteins, and its zinc finger domains are critical for pre-mRNA binding. Genome-wide binding assays revealed that AKAP95 bound preferentially to proximal intronic regions on a large number of pre-mRNAs in human transcriptome, and AKAP95 depletion predominantly resulted in reduced inclusion of many exons. AKAP95 also selectively coordinates with hnRNP H/F and U proteins in regulating alternative splicing events. We have further shown that AKAP95 directly interacts with itself. Taken together, our results establish AKAP95 as a novel and mostly positive regulator of pre-mRNA splicing and a possible integrator of transcription and splicing regulation, and support a model that AKAP95 regulates pre-mRNA splicing via through scaffolding RNAs and RNA processing factors and facilitating the splice site communication.</p>
<h3 id="样本信息">样本信息</h3>
<p>样本1-8是RIP-seq的数据，研究的是AKAP95与转录组的结合，样本9-15是mRNA-seq的数据，研究的是在293细胞或小鼠ES细胞中敲减了AKAP95的数据（其中9-11是293细胞的数据，有3个，12-15是小鼠ES细胞的数据，有4个）。</p>
<h3 id="文章思路">文章思路</h3>
<p>1.AKAP95的N末端区域参与该蛋白与RNA加工因子的结合，这些RNA加工因子包括hnRNPs。 2.APAK95与许多RNA加工因子的结合暗示了AKAP95在RNA加工方面发挥了作用，这些作用包括pre-RNA剪接。实验结果表明，AKAP95直接调控minigene pre-mRNA剪接，AKAP95的N末端与ZFs是其功能发挥的结构域。 3.为了寻找AKAP95剪接调控的内源靶点。经过一系列实验表明：AKAP95和hnRNP F参与调节FAM126A外显子11的剪接（实验中提到了敲减AKAP95后，FAM126A的外显子11会被跳过，而在野生型中则正常剪接）。 4.利用深度测序的方法寻的找内源AKAP95与人类转录组的结合。测序手段是RIP，其结果是发现AKAp95能与pre-mRNAs结合。 <strong>5. （核心，也就是这个笔记学习的部分）问题：评估AKAP95对可变剪接的全局影响，实验手段是：①人类294细胞和小鼠ES细胞中敲减了AKAP95基因-&gt;②RNA-seq-&gt;③DEXseq分析。</strong>AKAP95的敲减会导致更多的外显子使用（exon）减少，这表明AKAP95会全局促进外显子增加（exon inclusion）。看文献我的理解是，有了AKAP95基因后，该基因的表达产物会导致FAM126A的外显子10，11，12连接起来，如果敲低了AKAP95这个基因，FAM126A的外显子10与12连接起来，会跳过外显子11。因此AKAP95的功能就在于调节FAM126A的可变剪接。exon inclusion我的理解是，外显子的利用，以此文献为例说明，exon inclusion指的就是FAM126A的外显子11的利用，AKAP95会促进AKAP95外显子11的利用，如果没有AKAP95，则FAM126A的外显子10就会跳过外显子11，与外显子12连接起来，exon inclusion就降低。 6.后续的实验作者又研究了AKA95的一些作用机理，略。</p>
<h3 id="文章结果">文章结果</h3>
<h4 id="a.b图">a.b图</h4>
<p>a图是火山图。火山图常用于展示显著差异表达的基因，这里有两个关键词：显著是指P&lt;0.05，差异表达一般我们按照Fold Change(倍数变化)&gt;=2.0作为标准。 当我们拿到基因表达的P值和倍数后，为了用火山图展示结果，一般需要把倍数进行Log2的转化（下图a的x轴），比如某基因在实验组表达水平是对照组的4倍，log2（4）=2，同样的如果是1/4，也就是0.25，转换后的结果就是-2。 P值进行-log10的转化，-log10（0.01）约等于2，由于P值越小表示越显著，所以我们进行-log10（P value）转化后，转化值越大表示差异约显著，比如-log10（0.001）=3 &gt; -log10(0.01)=2 &gt; -log10(0.05)=1.30（下图a的y轴）。 <img src="http://ortxpw68f.bkt.clouddn.com/rnaseq001a.png"> 火山图有三种颜色，黄色与红色都是Padj小于0.01的基因（P值经过了FDR校正，即false discovery rate）。红色又表示基因变化超过2倍的基因。b图是饼图，它表示外显子使用(exon usage)的增加与降低数目。</p>
<h4 id="c.d图">c.d图</h4>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/rnaseq002a.png">

</div>
<h4 id="e图">e图</h4>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/rnaseq003a.png">

</div>
<h4 id="f图">f图</h4>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/rnaseq004a.png">

</div>
<h3 id="文章所用的生信方法">文章所用的生信方法</h3>
<p>在后文的Bioinformatic analyses部分</p>
<h4 id="比对">比对</h4>
<p>比对软件：TopHat (v2.0.13) 参考基因组：human reference genome (GRCh37/hg19) GTF文件： GTF version GRCh37.70 只保留MQ &gt;30的map结果 Picard-tools (v1.126)： 计算平均插入大小(mean insert sizes)和标准差 read count: 软件：HTSeq v0.6.0</p>
<h4 id="差异表达分析">差异表达分析</h4>
<p>DESeq (v3.0) DEXSeq (v3.1)</p>
<h4 id="富集分析">富集分析</h4>
<p>GO分析：DAVID (http://david.ncifcrf.gov/)</p>
<h1 id="数据下载">数据下载</h1>
<p>进入NCBI的GEO数据库https://www.ncbi.nlm.nih.gov/geo/ 搜索GSE81916，如下所示： <img src="http://ortxpw68f.bkt.clouddn.com/RNAseq001.png"></p>
<p>输入GSE81916，单击Search即可，见到数据说明及下载页面，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/rnaseq002c.png">

</div>
<p>下面有一段话是对这些数据的描述，即：</p>
<blockquote>
<p>Overall design Samples 1-8 are RNA-immunoprecipitation &gt; (RIP)-seq to determine AKAP95 binding to the transcriptome. Samples 9-15 are mRNA-seq to determine effect of AKAP95 knockdown in human 293 cells (9-11) or &gt; mouse ES cells (12-15).</p>
</blockquote>
<p>大意就是样本9-15是mRNA-seq的数据，而样本1-8是RNA免疫组化的数据。我们只需要9-15的数据，单击红框链接即可进入数据下载页面，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/rnaseq002d.png">

</div>
<p>单击第一行的SRP/SRP075/SRP075747右侧的ftp，即可进入数据下载界面： <img src="http://ortxpw68f.bkt.clouddn.com/rnaseq003.png"></p>
<p>现在下载SRR3589956-SRR3589962的7个数据（3个人类，4个小鼠），命令如下：</p>
<p>此命令是将数据下载到disk2/sra的目录下，</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">cd ~/disk2 &amp;&amp; mkdir sra</div><div class="line">for ((i=56;i&lt;=62;i=i++));do wget ftp://ftp-trace.ncbi.nlm.nih.gov/sra/sra-instant/reads/ByStudy/sra/SRP/SRP075/SRP075747/SRR35899$i/SRR35899$i.sra ;done</div></pre></td></tr></table></figure>
<p>当时觉得数据下载慢，我就直接用迅雷下载了，数据下载后如下所示： <img src="http://ortxpw68f.bkt.clouddn.com/rnaseq004.png"></p>
<h2 id="参考资料">参考资料</h2>
<ol style="list-style-type: decimal">
<li><a href="https://mp.weixin.qq.com/s?src=11&amp;timestamp=1507359643&amp;ver=437&amp;signature=cWtmQqrEoi7fnwdGF63u2mcQ0P6cJpcV4aDJ6AHHSJBEDxuP2Wb65am9apJEQaPs1U6NBoVE5EJ0XK1MEatZyKjd9OlDcpEB0T3-abbjsFTl01OZznhVOV-eQh1gW8n1&amp;new=1" target="_blank" rel="external">浙大植物学小白的转录组笔记</a></li>
<li><a href="http://www.jianshu.com/p/d717957828c8" target="_blank" rel="external">转录组入门（2）：读文章拿到测序数据</a></li>
<li><a href="https://mp.weixin.qq.com/s?src=11&amp;timestamp=1507611528&amp;ver=443&amp;signature=s4y*meB6oWf0zVZIxQ9EEpNJ5P0whexjL2DcoTcwbgYBOqzhv-2jZk2U86FRlrGFW*6XSnTwgcVLt7HXwvLGWSF9z4qErLcHhdtjy6V0Qz3fa*VQAmLJGou2QXklqI-a&amp;new=1" target="_blank" rel="external">如何看懂和绘制火山图？</a></li>
<li><a href="https://mp.weixin.qq.com/s?src=3&amp;timestamp=1507708087&amp;ver=1&amp;signature=sDBGiyaFarX9G5wtSOQZmeNuqVjXrtAwT3TPqeKPH3B9tyOi4-U3kaq2-5g6xncNA1WKDJrGvJdfB995Br2sSem-IImvEgNWliDhuFDKxHojoVe5DioWWgBDBR7xLSWz-yUqZnnXKXLamRkn598rPLLCf5fRp-0KTirlcjpl1fw=" target="_blank" rel="external">人气推文p值、E值、FDR、q值…你晕菜了吗？续集来啦！</a></li>
<li><a href="https://mp.weixin.qq.com/s?src=3&amp;timestamp=1507708087&amp;ver=1&amp;signature=YQpqTHl4WpYahQH2jvnkPWMm3-T9BnyoL5l9GZy2AhftTiyYF6Oq7lLBfskA8f6Po3rBZY4qSWogpaGi233BtEoRvexLfcbp-PcbWjrKu-XduuIMh136EjzWY*57k9brIInLLwcPx*QLsHkpvkiOHHMv-SrKCyVPf38TWe-Dl70=" target="_blank" rel="external">揭秘：FDR背后的真相</a></li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2017/10/01/转录组学习笔记01-计算机及软件安装/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/10/01/转录组学习笔记01-计算机及软件安装/" itemprop="url">转录组学习笔记01-计算机及软件安装</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-10-01T12:00:00+08:00">
                2017-10-01
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/生物信息学/" itemprop="url" rel="index">
                    <span itemprop="name">生物信息学</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  1,967
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  9
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="前言">前言</h2>
<p>转录组的这几篇入门笔记主要是参照了生信技能树论坛，公众号，生信媛公众号，徐更洲的博客，沈梦圆的博客及公众号，Jimmy等人的博客完成的。</p>
<h2 id="软件安装一miniconda">软件安装（一）——miniconda</h2>
<h3 id="首先要安装miniconda">首先要安装：Miniconda</h3>
<p>先了解一下conda，Anaconda,Miniconda。 <strong>conda</strong>是一个工具，也是一个可执行命令，其核心功能是包管理与环境管理。包管理与pip的使用类似，环境管理则允许用户方便地安装不同版本的python并可以快速切换。 <strong><a href="https://www.anaconda.com/download/#download" target="_blank" rel="external">Anaconda</a></strong>是一个用于科学计算的Python发行版，支持 Linux, Mac, Windows系统，提供了包管理与环境管理的功能，可以很方便地解决多版本python并存、切换以及各种第三方包安装问题。Anaconda则是一个打包的集合，里面预装好了conda、某个版本的python、众多packages、科学计算工具等等，所以也称为Python的一种发行版。 <strong><a href="https://conda.io/miniconda.html" target="_blank" rel="external">Miniconda</a></strong>则是Anaconda的微缩版，它只包含最基本的内容，即python与conda，以及相关的必须依赖项，对于空间要求严格的用户，Miniconda是一种选择。 <strong><a href="https://bioconda.github.io/index.html" target="_blank" rel="external">bioconda</a></strong>是conda上一个分发生物信息软件的频道。多数软件都可以通过conda来安装，可查看<a href="https://bioconda.github.io/recipes.html#recipes" target="_blank" rel="external">可用软件列表</a>。</p>
<h4 id="第一步下载miniconda2">第一步：下载miniconda2</h4>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">wget https://repo.continuum.io/miniconda/Miniconda2-latest-Linux-x86_64.sh</div></pre></td></tr></table></figure>
<h4 id="第二步安装miniconda2">第二步：安装miniconda2</h4>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">bash Miniconda2-latest-Linux-x86_64.sh</div></pre></td></tr></table></figure>
<p>安装过程基本上就是按Enter或输入yes，仔细看说明就行。</p>
<h4 id="第三步将miniconda2保存到环境变量">第三步：将miniconda2保存到环境变量</h4>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">echo &quot;export PATH=/home/bio/miniconda2/bin:&quot;&apos;$PATH&apos; &gt;&gt; ~/.bashrc</div><div class="line">source ~/.bashrc</div></pre></td></tr></table></figure>
<h4 id="第四步添加通道">第四步：添加通道</h4>
<p>Conda默认的源访问速度有些慢，可以增加国内的源（国内的源是清华源，其中参考文献中给出的；另外还可以增加几个源，以便于安装更多的软件，尤其是bioconda安装生信类工具。conda-forge通道是Conda社区维护的包含很多不在默认通道里面的通用型软件。r通道是向后兼容性通道，尤其是使用R3.3.1版本时会用到。后添加的通道优先级更高，因此一般用下面列出的顺序添加。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">conda config --set show_channel_urls yes</div><div class="line">conda config --add channels r # Optional, lowest priority</div><div class="line">conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/free</div><div class="line">conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/conda-forge</div><div class="line">conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/bioconda</div></pre></td></tr></table></figure>
<p>如果命令行添加不了，可以用<code>vim ~/.condarc</code>来进行安装，如果安装错误了，可以删除.condarc文件，然后再用命令行来安装。用<code>conda config --get channels</code>可以查看已经添加的频道，而用<code>conda config --show</code>可查看已有的配置。如下所示： <img src="http://ortxpw68f.bkt.clouddn.com/conda002a.png"></p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/conda001a.png">

</div>
<h3 id="conda基本使用">Conda基本使用</h3>
<h4 id="列出安装的软件包">列出安装的软件包</h4>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">conda list</div></pre></td></tr></table></figure>
<p>如下所示： <img src="http://ortxpw68f.bkt.clouddn.com/conda003a.png"></p>
<h4 id="搜索需要安装的软件包获取其完成名字">搜索需要安装的软件包，获取其完成名字</h4>
<p>命令是<code>conda search &lt;package ambigious name&gt;</code> ，以搜索fastqc为例： <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">conda search fastqc  # * 表示对于版本的包已安装</div></pre></td></tr></table></figure></p>
<p>如下所示： <img src="http://ortxpw68f.bkt.clouddn.com/conda004a.png"></p>
<h4 id="安装包">安装包</h4>
<p>命令为<code>conda install &lt;package name&gt;</code> 以安装 numpy=1.7.2为例说明</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">conda install numpy=1.7.2 </div><div class="line"># 安装特定版本的软件包</div><div class="line"># 也可以不加</div></pre></td></tr></table></figure>
<h4 id="更新软件包">更新软件包</h4>
<p><code>conda update &lt;package name&gt;</code></p>
<h4 id="移除软件包">移除软件包</h4>
<p><code>conda remove &lt;package name&gt;</code></p>
<h4 id="获取帮助信息">获取帮助信息</h4>
<p><code>conda -h # 查看conda可用的命令</code> <code>conda install -h #查看install子命令的帮助</code></p>
<h3 id="关于环境">关于环境</h3>
<p>condas可以创建多个分析环境，这是它的优势之一，不过目前用不到，以后用到了再学。</p>
<h4 id="查看已有环境">查看已有环境</h4>
<p>虚拟<strong>环境管理</strong>：conda比较好用的就是它能够建立多个互不干扰的分析环境。通过<code>conda info --envs</code>可以查看环境，如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">conda info --envs</div><div class="line"># 或 conda info -e</div></pre></td></tr></table></figure>
<p>目前就只有一个默认环境，也就是root： <img src="http://ortxpw68f.bkt.clouddn.com/minicoda2.png"></p>
<h3 id="卸载miniconda">卸载miniconda</h3>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">rm -rf ~/miniconda2</div></pre></td></tr></table></figure>
<p>从环境变量中去掉miniconda：打开~/.bash_profile文件，删掉其中miniconda的路径，关闭并保存 删除隐藏的.condarc 、.conda以及.continuum文件</p>
<h2 id="软件安装二其它生信工具">软件安装（二）——其它生信工具</h2>
<p>目前所用的生信工具如下所示：</p>
<h3 id="sratoolkit">(1)sratoolkit</h3>
<p><a href="https://trace.ncbi.nlm.nih.gov/Traces/sra/sra.cgi?view=software" title="sratoolkit" target="_blank" rel="external">sratoolkit</a>：把NCBI SRA（Sequence Read Archive）数据库中的NGS序列数据从 sra 格式转换到 fastq 格式。</p>
<p>conda安装：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">conda install -c jfear sratoolkit=2.8.1</div></pre></td></tr></table></figure>
<p>如果安装不成功，可采用下列安装方式（<strong>我的笔记本上上基本上都是conda安装，对于下面的安装方式并没有试过</strong>）：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">cd mynotes</div><div class="line">cd src</div><div class="line">wget https://ftp-trace.ncbi.nlm.nih.gov/sra/sdk/2.8.2-1/sratoolkit.2.8.2-1-ubuntu64.tar.gz</div><div class="line">tar -zxvf sratoolkit.2.8.2-1-ubuntu64.tar.gz</div><div class="line">mv sratoolkit.2.8.2-1-ubuntu64 ~/biosoft</div><div class="line"></div><div class="line"># 加入环境变量</div><div class="line">echo &apos;PATH=$PATH:~/biosoft/sratoolkit.2.8.2-1-ubuntu64/bin&apos; &gt;&gt; ~/.bashrc</div><div class="line"></div><div class="line"># 测试</div><div class="line">prefetch -v</div><div class="line"># 尝试下载，默认存放在家目录下的ncbi文件夹中</div><div class="line">prefetch -c SRR390728</div></pre></td></tr></table></figure>
<h3 id="fastqc">fastqc</h3>
<p><a href="http://www.bioinformatics.babraham.ac.uk/projects/fastqc/" title="fastqc" target="_blank" rel="external">fastqc</a>:二代测序数据质量分析软件。</p>
<p>安装如下： <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">conda install fastqc</div></pre></td></tr></table></figure></p>
<p>或者是采用常规的安装方式： <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"># 判断系统是否安装java</div><div class="line">java -version</div><div class="line"># 安装java， 请改成openjdk-9-jdk，下面的是错误演示</div><div class="line">sudo apt install  openjdk-9-jre-headless</div><div class="line"># 验证</div><div class="line">java -version</div><div class="line"># openjdk version &quot;9-internal&quot;</div><div class="line"># OpenJDK Runtime Environment (build 9-internal+0-2016-04-14-195246.buildd.src)</div><div class="line"># OpenJDK 64-Bit Server VM (build 9-internal+0-2016-04-14-195246.buildd.src, mixed mode)</div><div class="line"># 安装fastqc</div><div class="line">cd src</div><div class="line">wget http://www.bioinformatics.babraham.ac.uk/projects/fastqc/fastqc_v0.11.5.zip</div><div class="line">unzip fastqc_v0.11.5.zip</div><div class="line">mv FastQC/ ~/biosoft/</div><div class="line">cd ~/biosoft/FastQC/</div><div class="line">chmod 770 fastqc</div><div class="line"># 添加环境变量， 我用sed修改</div><div class="line">sed -i &apos;/^PATH/s/\(.*\)/\1:~\/biosoft\/FastQC\//&apos; ~/.bashrc</div><div class="line">source ~/.bashrc</div><div class="line">fastqc -v</div><div class="line"># FastQC v0.11.5</div></pre></td></tr></table></figure></p>
<h3 id="hisats">hisats</h3>
<p><a href="http://ccb.jhu.edu/software/hisat2/index.shtml" title="hisats" target="_blank" rel="external">hisats</a>：将测序结果比对到人类参考基因组上。HISAT2是TopHat2/Bowti2的继任者，使用改进的BWT算法，实现了更快的速度和更少的资源占用。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">conda install -c bioconda hisat2</div></pre></td></tr></table></figure>
<h3 id="samtools">samtools</h3>
<p><a href="http://www.htslib.org/" title="samtools" target="_blank" rel="external">samtools</a>:处理SAM、BAM文件的工具软件。BAM格式文件是存放高通量测序中比对结果的标准格式文件。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">conda install -c bioiconda samtools</div></pre></td></tr></table></figure>
<p>或者如下安装： <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line">cd src</div><div class="line">#  prerequsite</div><div class="line">## system requirement</div><div class="line">sudo apt install autoconf libz-dev libbz2-dev liblzma-dev libssl-dev</div><div class="line"></div><div class="line">### zlib2</div><div class="line">wget http://zlib.net/zlib-1.2.11.tar.gz</div><div class="line">tar -zxvf zlib-1.2.11.tar.gz &amp;&amp; cd zlib-1.2.11 &amp;&amp; make &amp;&amp; sudo make install &amp;&amp; cd .. &amp;&amp; rm -rf zlib-1.2.11</div><div class="line"></div><div class="line">### bzip2</div><div class="line">wget http://bzip.org/1.0.6/bzip2-1.0.6.tar.gz</div><div class="line">tar -zxvf bzip2-1.0.6.tar.gz &amp;&amp; cd bzip2-1.0.6 &amp;&amp; make &amp;&amp; sudo make install &amp;&amp; cd .. &amp;&amp; rm -rf  bzip2-1.0.6</div><div class="line"></div><div class="line">### curses</div><div class="line">sudo apt-get install libncurses5-dev </div><div class="line"></div><div class="line">### htslib</div><div class="line">git clone https://github.com/samtools/htslib.git</div><div class="line">cd htslib</div><div class="line">autoreconf</div><div class="line"></div><div class="line"># building samtools</div><div class="line">git clone https://github.com/samtools/samtools.git</div><div class="line">cd samtools</div><div class="line">autoconf -Wno-syntax</div><div class="line">./configure </div><div class="line">make &amp;&amp; make install prefix=$HOME/biosoft/samtools</div><div class="line"></div><div class="line">## add PATH</div><div class="line">sed  &apos;/^PATH/s/\(.*\)/\1:~\/biosoft\/samtools\/bin/&apos; .bashrc -i</div><div class="line">source ~/.bashrc</div><div class="line">samtools --help</div></pre></td></tr></table></figure></p>
<h3 id="htseq-count">htseq-count</h3>
<p><a href="http://htseq.readthedocs.io/en/release_0.9.1/" title="htseq-count" target="_blank" rel="external">htseq-count</a>：用于reads计数的软件，他能对位于基因组上的一些单位的reads数进行统计，这里所说的单位主要是指染色体上的一组位置区间（我们常见的就是gene exon）</p>
<p>优先conda安装</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">conda install -c bioconda htseq=0.7.2</div></pre></td></tr></table></figure>
<p>如果conda无法安装，采用下列安装方式：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">## Download and install HISAT </div><div class="line"># https://ccb.jhu.edu/software/hisat2/index.shtml</div><div class="line">cd ~/biosoft</div><div class="line">mkdir HISAT  &amp;&amp;  cd HISAT </div><div class="line">#### readme: https://ccb.jhu.edu/software/hisat2/manual.shtml</div><div class="line">wget ftp://ftp.ccb.jhu.edu/pub/infphilo/hisat2/downloads/hisat2-2.0.4-Linux_x86_64.zip</div><div class="line">unzip hisat2-2.0.4-Linux_x86_64.zip</div><div class="line">ln -s hisat2-2.0.4  current </div><div class="line">## ~/biosoft/HISAT/current/hisat2-build</div><div class="line">## ~/biosoft/HISAT/current/hisat2</div></pre></td></tr></table></figure>
<p>或者如下： <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"># prerequsites</div><div class="line">sudo apt-get install python-pip</div><div class="line">pip install --upgrade pip</div><div class="line">sudo apt-get install build-essential python2.7-dev python-numpy python-matplotlib</div><div class="line">## 验证， 保证无报错</div><div class="line">python -V</div><div class="line">## python</div><div class="line">python</div><div class="line">&gt;&gt;&gt; import numpy </div><div class="line">&gt;&gt;&gt; import matplotlib </div><div class="line"></div><div class="line">## install HTSeq</div><div class="line">pip install htseq</div><div class="line"></div><div class="line">## 验证</div><div class="line">python</div><div class="line">&gt;&gt;&gt; import HTSeq</div></pre></td></tr></table></figure></p>
<h3 id="r">R</h3>
<p><a href="https://www.r-project.org/" title="R" target="_blank" rel="external">R</a>：统计与数据可视化工具。 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">conda install -c r r-base</div><div class="line">R #运行的时候要大写</div><div class="line"></div><div class="line">## conda install -c r r-essentials </div><div class="line">## -essentials表示安装R,及80多个常用的数据分析包, 包括idplyr, shiny, ggplot2, tidyr, caret 和 nnet</div></pre></td></tr></table></figure></p>
<h4 id="rstudio的安装">Rstudio的安装</h4>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">conda install rstudio</div><div class="line">rstudio</div></pre></td></tr></table></figure>
<p>后面涉及有关R的分析是在Sindows平台下完成的，并没有用到Linux下的R工具。</p>
<h2 id="参考资料">参考资料：</h2>
<ol start="2" style="list-style-type: decimal">
<li><a href="https://zhuanlan.zhihu.com/p/25085567" target="_blank" rel="external">使用Bioconda管理Linux系统中的生物信息软件</a></li>
<li><a href="http://www.jianshu.com/p/2f3be7781451" target="_blank" rel="external">PeterYuan，Anaconda使用总结</a></li>
<li><a href="http://www.jianshu.com/p/b16ae34f9012" target="_blank" rel="external">hoptop.转录组入门（1）：软件准备</a></li>
<li><a href="https://mp.weixin.qq.com/s?src=3&amp;timestamp=1507534977&amp;ver=1&amp;signature=uauB8*AHbC91QJFzs7AVO9vdeU92DPB9L4J5qT67AiaQtvdg0nvRCGJo1yaciFx3pF3slW4Zh0w8GUAecvQJmBKc2I0xX2q7IBvD2ha0T-uFJ1xlINQNb-VM40mZZOkP3rVn78KVvAFtVqYCxeSdjGBoYw23piWH50rts95D6iU=" target="_blank" rel="external">生信软件的好帮手-bioconda</a></li>
<li><a href="http://www.dxy.cn/bbs/topic/37352184" target="_blank" rel="external">中国科大开源镜像站的bioconda新镜像申请</a></li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2017/09/23/医学统计学-因子分析/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/09/23/医学统计学-因子分析/" itemprop="url">因子分析</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-09-23T12:02:00+08:00">
                2017-09-23
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/医学统计学/" itemprop="url" rel="index">
                    <span itemprop="name">医学统计学</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  599
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  2
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="因子分析思想">因子分析思想</h2>
<p>在医学研究中有一些现象是难以直接观测的，通常称为不可测现象，它们只能通过其他多个可观测的指标来间接地反映。例如，脑部疾病患者的意识清醒状态是一个不可测现象，但可以通过患者的语言能力、辨识能力、记忆能力、理解能力、思维的逻辑能力等一系列可观测的指标来反映。这里，由于各个可观测指标都不同程度地反映了意识清醒状态这一不可测现象，因此这些可观测指标之间呈现出一定的相关性。很自然地，人们可能认为这些可观测指标之间的相关性主要是由它们反共同反映的不可测现象支配的。 一般地，对于多指标数据中呈现出来的相关性，是否存在对这种相关性起支配作用的潜在因素？如果存在，如何找出这些潜在因素？这些潜在因素是怎样对原始指标起支配作用的？这些问题，都可以通过因子分析来解决。事实上，因子分析是一种从分析多个原始指标的相关关系入手，找到支配这种相关关系的有限个不可观测的潜在变量，并用这些潜在变量来解释原始指标之间的相关性或协方差关系的多元统计分析方法。</p>
<h2 id="因子分析的数学模型">因子分析的数学模型</h2>
<h2 id="因子模型的性质">因子模型的性质</h2>
<h3 id="公共度">公共度</h3>
<h3 id="因子贡献及因子贡献率">因子贡献及因子贡献率</h3>
<h3 id="因子载荷及因子载荷阵">因子载荷及因子载荷阵</h3>
<h2 id="因子载荷阵的求解及计算步骤">因子载荷阵的求解及计算步骤</h2>
<p>案例如下： 例22-2 某医院为了合理地评价该院各月的医疗工作质量，搜集了三年有关门诊人次、出院人数、病床利用率、病床周转次数、平均住院天数、治愈好转率、病死率、诊断符合率、抢救成功率等9个指标数据，如表22-8。现采用因子分析方法，探讨其综合评价指标体系。<img src="http://ortxpw68f.bkt.clouddn.com/efa001.png"></p>
<h2 id="参考资料">参考资料</h2>
<ol style="list-style-type: decimal">
<li><a href="https://zhuanlan.zhihu.com/p/26305845" target="_blank" rel="external">《R语言实战》第四部分第十四章-主成分分析和因子分析学习笔记</a></li>
<li><a href="https://zhuanlan.zhihu.com/p/23981354" target="_blank" rel="external">Learn R | 数据降维之因子分析（上）</a></li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/4/">4</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">RVDSD</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">32</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">6</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">26</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          <div class="links-of-author motion-element">
            
          </div>

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

<div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">RVDSD</span>

  
</div>



<div class="powered-by">
<i class="fa fa-user-md"></i><span id="busuanzi_container_site_uv">
  本站访客数:<span id="busuanzi_value_site_uv"></span>
</span>
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.3</div>




<div class="theme-info">
  <div class="powered-by"></div>
  <span class="post-count">博客全站共60.7k字</span>
</div>

        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.3"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.3"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.3"></script>



  


  




	





  





  












  





  

  

  
  

  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config("");
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="custom_mathjax_source">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->
  


  

  

</body>
</html>
