<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.2" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.2" />






<meta name="description" content="test">
<meta property="og:type" content="website">
<meta property="og:title" content="我的笔记">
<meta property="og:url" content="http://rvdsd.top/index.html">
<meta property="og:site_name" content="我的笔记">
<meta property="og:description" content="test">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="我的笔记">
<meta name="twitter:description" content="test">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.2',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://rvdsd.top/"/>





  <title>我的笔记</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">我的笔记</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">学习过程中的输出</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2017/09/28/hello-world/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="我的笔记">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/09/28/hello-world/" itemprop="url">Hello World</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-09-28T22:03:31+08:00">
                2017-09-28
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Welcome to <a href="https://hexo.io/" target="_blank" rel="external">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="external">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="external">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="external">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo new <span class="string">"My New Post"</span></div></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="external">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo server</div></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="external">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo generate</div></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="external">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo deploy</div></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/deployment.html" target="_blank" rel="external">Deployment</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2017/08/18/医学统计学-第07章卡方分析/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="我的笔记">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/08/18/医学统计学-第07章卡方分析/" itemprop="url">卡方检验</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-08-18T12:02:00+08:00">
                2017-08-18
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/医学统计学/" itemprop="url" rel="index">
                    <span itemprop="name">医学统计学</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>两个样本率的比较通常是使用$\chi^2$检验（Chi-square test）。$\chi^2$检验是以$\chi^2$分布为理论依据，用途广泛的假设检验方法，卡方分析用于比较不同组之间的构成比，它的零假设是假定各组之间的构成是相同的，计算出理论每组的理论构成比，再计算理论值与实际值的差别，如果差别大的话，就拒绝零假设。它用于推断两个总体率或构成比之间有无差别、多个总体率或构成比之间有无差别、多个样品率间的多重比较、两个分类变量之间有无关联性、多维列联表的分析和频数分页拟合优度的$\chi^2$检验，它的扩展分析方法有Fisher精确分析，Ridit分析，CMH分析。</p>
<h3 id="卡方检验的基本思路"><a href="#卡方检验的基本思路" class="headerlink" title="卡方检验的基本思路"></a>卡方检验的基本思路</h3><p>（一）卡方分布（Chi-square distribution）是一种连续型分布，$\chi^2$分布只有一个参数，即自由度$\nu$。按$\chi^2$分布的密度函数$f(\chi^2)$可以给出自由度$\nu=1,2,3,\dots$的一簇$\chi^2$分布曲线，由$\chi^2$分布曲线可见，$\chi^2$分布的形状依赖于自由度$\nu$的大小：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">x &lt;- c(seq(0,15,length = 1000)) </div><div class="line">#生成从0到10之间的1000个数字</div><div class="line"></div><div class="line">y1 &lt;- dchisq(x,1) </div><div class="line"># 生成对x的卡方密度值，自由度为1</div><div class="line"></div><div class="line">y6 &lt;- dchisq(x,6) </div><div class="line"># 生成对x的卡方密度值，自由度为6</div><div class="line"></div><div class="line">y10 &lt;- dchisq(x,10) </div><div class="line"># 生成对x的卡方密度值，自由度为10</div><div class="line"></div><div class="line">plot(x,y1,type = &quot;l&quot;, ylim = c(0,0.5),xlim=c(0,15),xlab=&quot;&quot;, ylab=&quot;&quot;, lty = 1, main = expression(paste(chi^2,&quot;Distribution&quot;)))</div><div class="line"># type =&quot;l&quot;表示绘制线，如果是n则不绘线；lty=1表示绘制实线</div><div class="line"></div><div class="line">lines(x,y6, type = &quot;l&quot;, xlab = &quot;&quot;, ylab = &quot;&quot;, lty =2) </div><div class="line"># lty=2表示绘制虚线lines(x,y10, type = &quot;l&quot;, xlab = &quot;&quot;, ylab = &quot;&quot;, lty= 3) # lty=3表示绘制点线</div><div class="line"></div><div class="line">lines(x,y10, type = &quot;l&quot;, xlab = &quot;&quot;, ylab = &quot;&quot;, lty= 3) # lty=3表示绘制点线</div><div class="line"></div><div class="line">text(1,0.3, c(expression(chi^2*(1))))</div><div class="line">text(4,0.18, c(expression(chi^2*(6))))</div><div class="line">text(10,0.13, c(expression(chi^2*(10))))</div></pre></td></tr></table></figure>
<p>图片如下所示：<img src="http://ortxpw68f.bkt.clouddn.com/chi01.png" alt=""></p>
<ol>
<li>当自由度$\nu \leq 2$时，曲线呈L形；</li>
<li>随着$\nu$的增加，曲线逐渐趋于对称；</li>
<li>当自由度$\nu \rightarrow \infty$时，$\chi^2$分布趋于正态分布。</li>
</ol>
<p>（二）卡方分布的一个基本性质是它的可加性；如果两个独立的随机变量$X<em>{1}$和$X</em>{2}$分别服从自由度$\nu<em>{1}$和$\nu</em>{2}$的$\chi^2$分布，则它们的和$X<em>{1}+X</em>{2}$服从自由度$\nu<em>{1}$和$nu</em>{2}$的$\chi^2$分布，即$X<em>{1}+X</em>{2}~\chi^2_{\nu1+\nu2}$.</p>
<p>（三）$\chi^2$分布的界值：当自由度$\nu$确定后，$\chi^2$分布曲线下右侧尾部的面积为$\alpha$时，横轴上相应的$\chi^2$值记为$\chi^2_{\alpha,\nu}$，即$\chi^2$分布的界值。$\chi^2$值越大，p值越小，反之，$\chi^2$值越小，界值越大。</p>
<h2 id="四格表资料的-chi-2-检验"><a href="#四格表资料的-chi-2-检验" class="headerlink" title="四格表资料的$\chi^2$检验"></a>四格表资料的$\chi^2$检验</h2><h3 id="案例1"><a href="#案例1" class="headerlink" title="案例1"></a>案例1</h3><p>某医院欲比较异梨醇口服液（试验组）和氢氯噻嗪+地塞米松（对照组）降低颅内压的疗效。将200例颅内压增高症患者随机分为两组，结果见表7-1。问两组降低颅内压的总体有效率有无差别？（《医学统计学》第四版，孙振球，第七章 卡方检验 例7-1，P96）</p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/chi02.png" alt=""><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">data71&lt;-matrix(c(99,75,5,21),nr = 2,dimnames = list(c(&quot;试验组&quot;, &quot;对照组&quot;),c(&quot;有效&quot;, &quot;无效&quot;)))</div><div class="line">data71</div></pre></td></tr></table></figure></p>
<p>数据的四格表如下所示：<br><img src="http://ortxpw68f.bkt.clouddn.com/chi03.png" alt=""></p>
<p>这张图里的四个数是该表的基本数据，其余的数据都是由这4个基本数据推算出来的，称为四格表（fourfold table）资料。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">chi &lt;- chisq.test(data71)</div><div class="line">chi$expected #　显示理论数</div></pre></td></tr></table></figure>
<p>理论数如下所示：<br><img src="http://ortxpw68f.bkt.clouddn.com/chi04.png" alt=""></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">chisq.test(data71,correct=F) </div><div class="line"># correct = F表示不进行Yates连续性校正</div></pre></td></tr></table></figure>
<p><img src="http://ortxpw68f.bkt.clouddn.com/chi05.png" alt=""></p>
<p>结果：卡方值为12.8571，p值= 0.0003362小于0.01，按sig = 0.01的水准，拒绝原假设，接受备用假设，可以认为异山梨醇口服液降低颅内压的有效率高于氢氯噻嗪+地塞米松的有效率。这个结果与SAS计算的结果相同。R语言中默认的卡方检验是进行Yates连续性校正，因此上题中进行检验时，要加入correct=F。</p>
<h2 id="四格表资料的Fisher确切概率法"><a href="#四格表资料的Fisher确切概率法" class="headerlink" title="四格表资料的Fisher确切概率法"></a>四格表资料的Fisher确切概率法</h2><p>四格表中的计数资料的实际频数都是分类资料，是不连续的，因此计算出的卡方值都是离散型分布，而卡方界值表的依据是卡方分布，卡方分布是连续分布，因此在实际工作中，对于四格表资料，需要进行Yates校正，其规则如下：</p>
<ol>
<li>当$n\geq 40$，且所有的$T\geq 5$时，用卡方检验的基本公式。</li>
<li>当$n\geq 40$，但有$1\leq T \geq 5$时，用校正公式，或改用四格表资料的Fisher确切概率法。</li>
<li>当$n\leq 40$，或T \leq 1$时，用四格表资料的Fisher确切概率法。</li>
</ol>
<h3 id="案例2"><a href="#案例2" class="headerlink" title="案例2"></a>案例2</h3><p>某医师欲比较胞磷胆碱与神经节苷酯治疗脑血管疾病的疗效，将78例脑血管疾病患者随机分为两组，结果见表7-2。问两种药物治疗脑血管疾病的有效率是否有差别？（《医学统计学》第四版，孙振球，第七章 卡方检验，例7-2）</p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/chi06.png" alt=""></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">data72&lt;-matrix(c(46,18,6,8),</div><div class="line">               nr = 2,</div><div class="line">               dimnames = list(c(&quot;胞磷胆碱&quot;,&quot;神经节苷脂&quot;),c(&quot;有效&quot;,&quot;无效&quot;)))</div><div class="line">chisq.test(data72,correct=F) # 不进行Yates校正的结果</div><div class="line"></div><div class="line">chisq.test(data72,correct=T) # 进行Yates校正的结果</div><div class="line"></div><div class="line"># 这个结果与下面的结果一样</div><div class="line"># 因为R中进行卡方检验时是默认进行Yates连续性校正的</div><div class="line">chisq.test(data72)</div></pre></td></tr></table></figure>
<p>结果如下所示：<br><img src="http://ortxpw68f.bkt.clouddn.com/chi07.png" alt=""></p>
<p>不校正的情况下，卡方值为4.35，p值为0.03695小于0.05，进行卡方连续性校正的情况下，卡方值为3.1448,p=0.07617。校正与不校正得出的结果在0.05附近，因此下结论要谨慎。</p>
<h2 id="配对四格表卡方检验"><a href="#配对四格表卡方检验" class="headerlink" title="配对四格表卡方检验"></a>配对四格表卡方检验</h2><h3 id="案例3"><a href="#案例3" class="headerlink" title="案例3"></a>案例3</h3><p>某实验室分别用乳胶凝集法和免疫荧光法对58名可疑系统红斑狼疮患者血清中抗核抗体进行测定，结果见表7-3。问两种方法的检测结果有无差别？（《医学统计学》第三版，孙振球，第七章 卡方检验，例7-3）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">data73&lt;-matrix(c(11,2,12,33),</div><div class="line">               nr = 2,dimnames = list(c(&quot;+&quot;, &quot;-&quot;),c(&quot;+&quot;, &quot;-&quot;)))</div><div class="line"></div><div class="line">library(epiR) # 载入epiR包，使用其中的epi.kappa函数</div><div class="line"></div><div class="line">mcnemar.test(data73) # 配对检验</div><div class="line"></div><div class="line">chisq.test(data73)$expect</div><div class="line"></div><div class="line">epi.kappa(data73)$kappa </div><div class="line"># 一致性检验，即考察这两个方法在检验方面是否吻合</div><div class="line"></div><div class="line"># 或者使用vcd包中的Kappa</div><div class="line">library(vcd)</div><div class="line">Kappa(data73)</div></pre></td></tr></table></figure>
<p>结果如下所示：<br><img src="http://ortxpw68f.bkt.clouddn.com/chi08.png" alt=""></p>
<p>结果分析：McNemar配对卡方检验的p值为0.01616,在0.05水平上，有显著性差异，免疫荧光法的总体阳性检出率要高于乳胶凝集法。</p>
<p>Kappa检验结果的p值小于0.01，估计值为0.455，说明两种方法的吻合度有统计学意义，但吻合度一般。</p>
<p>简单来说，McNemar检验是比较两种方法A与B对同一个对象的检验是否有差异，判断哪种方法比较好，比较容易检验出来结果。而Kappa检验就是比较A与B这两种方法检验出来的结果是不是一致的。在有些配对案例中可能会出现A的方法优于B，但A与B检验的结果不一致的情况。</p>
<h2 id="四格表精确Fisher检验"><a href="#四格表精确Fisher检验" class="headerlink" title="四格表精确Fisher检验"></a>四格表精确Fisher检验</h2><h3 id="案例4"><a href="#案例4" class="headerlink" title="案例4:"></a>案例4:</h3><p>某医师为研究乙肝免疫球蛋白预防胎儿宫内感染HBV的效果，将33例HBsAg阳性孕妇随机分为预防注射组和非预防组，结果见表7-4。问两组新生儿的HBV总体感染率有无差别？（《医学统计学》第四版，孙振球，第七章 卡方检验，例7-4)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">data74&lt;-matrix(c(4,5,18,6),nr = 2,</div><div class="line">               dimnames = list(c(&quot;预防注射组&quot;, </div><div class="line">                                 &quot;非预防组&quot;),c(&quot;阳性&quot;, &quot;阴性&quot;)))</div><div class="line">chi&lt;-chisq.test(data74) </div><div class="line"># 理论频数小于5的情况，这里用Yates连续校正，</div><div class="line"># 默认的就是，不用添加correct = T</div><div class="line"></div><div class="line">chi$expected </div><div class="line"># 查看理论频数，有小于5的情况</div><div class="line"></div><div class="line">fisher.test(data74)</div></pre></td></tr></table></figure>
<p>结果如下所示：<br><img src="http://ortxpw68f.bkt.clouddn.com/chi09.png" alt=""></p>
<h3 id="案例5"><a href="#案例5" class="headerlink" title="案例5:"></a>案例5:</h3><p>某单位研究胆囊腺癌、腺瘤的P53基因表达，对同期手术切除的胆囊腺癌、腺瘤标本各10份，用免疫组化法检测P53基因，资料见表7-6。问胆囊腺癌和胆囊腺瘤的P53基因表达阳性率有无差别？（《医学统计学》第四版，孙振球，第七章 卡方检验，例7-5）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">data75&lt;-matrix(c(6,1,4,9),nr = 2,</div><div class="line">               dimnames = list(c(&quot;胆囊腺癌&quot;, &quot;胆囊腺瘤&quot;),</div><div class="line">                               c(&quot;阳性&quot;, &quot;阴性&quot;)))</div><div class="line"></div><div class="line">fisher.test(data75)</div></pre></td></tr></table></figure>
<p>结果如下所示：<br><img src="http://ortxpw68f.bkt.clouddn.com/chi10.png" alt=""></p>
<h2 id="无序R×C列表"><a href="#无序R×C列表" class="headerlink" title="无序R×C列表"></a>无序R×C列表</h2><h3 id="案例6-列与行的数目都大于2"><a href="#案例6-列与行的数目都大于2" class="headerlink" title="案例6:列与行的数目都大于2"></a>案例6:列与行的数目都大于2</h3><p>无序R×C列表这种情况是行、列都无序，并且行与列的数目都大于2，例如： 某医师研究物理疗法、药物治疗和外用膏药三种疗法治疗周围性面神经麻痹的疗效，资料见表7-8。问三种疗法的有效率有无差别（《医学统计学》第四版，孙振球，第七章 卡方检验，例7-6）？<br>如下所示：<br><img src="http://ortxpw68f.bkt.clouddn.com/chi11.png" alt=""></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">data76&lt;-matrix(c(199,164,118,7,18,26),</div><div class="line">               nr = 3,dimnames = list(c(&quot;物理疗法组&quot;, &quot;药物治疗组&quot;,&quot;外用膏药组&quot;),</div><div class="line">                                      c(&quot;有效&quot;, &quot;无效&quot;)))</div><div class="line">chi.result &lt;- chisq.test(data76)</div><div class="line">chi.result # 查看卡方分析结果</div></pre></td></tr></table></figure>
<p>结果如下所示：<br><img src="http://ortxpw68f.bkt.clouddn.com/chi12.png" alt=""></p>
<h2 id="双向无序R×C列表的卡方检验"><a href="#双向无序R×C列表的卡方检验" class="headerlink" title="双向无序R×C列表的卡方检验"></a>双向无序R×C列表的卡方检验</h2><h3 id="案例7"><a href="#案例7" class="headerlink" title="案例7:"></a>案例7:</h3><p>某医师在研究血管紧张素I转化酶(ACE)基因I/D多态与2型糖尿病肾病(DN)的关系时，将249例2型糖尿病患者按有无糖尿病肾病分为两组，资料见表7-9，问两组2型糖尿病患者的ACE基因型总体分布有无差别（《医学统计学》第四版，孙振球，第七章 卡方检验，例7-7）？<br><img src="http://ortxpw68f.bkt.clouddn.com/chi13.png" alt=""></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">data77 &lt;- matrix(c(42,30,48,72,21,36),</div><div class="line">                 nrow=2,dimnames=list(c(&quot;DN组&quot;,&quot;无DN组&quot;),</div><div class="line">                                      c(&quot;DD&quot;,&quot;ID&quot;,&quot;II&quot;)))</div><div class="line">chi.result77 &lt;- chisq.test(data77)</div><div class="line">chi.result77$expected</div><div class="line">chi.result77</div></pre></td></tr></table></figure>
<p>结果如下所示：<br><img src="http://ortxpw68f.bkt.clouddn.com/chi14.png" alt=""></p>
<h2 id="双向无序R×C列表的关联性检验"><a href="#双向无序R×C列表的关联性检验" class="headerlink" title="双向无序R×C列表的关联性检验"></a>双向无序R×C列表的关联性检验</h2><h3 id="案例8"><a href="#案例8" class="headerlink" title="案例8"></a>案例8</h3><p>测得某地5801人的ABO血型和MN血型结果如表7-10，问两种血型系统之间是否有关联？（《医学统计学》第四版，孙振球，第七章 卡方检验，例7-8）</p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/chi15.png" alt=""></p>
<p>没有找到关于Pearson列联系数的函数，手工计算如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">data78 &lt;- matrix(c(431,388,495,137,490,410,587,179,902,800,950,32),nrow=4,dimnames=list(c(&quot;O&quot;,&quot;A&quot;,&quot;B&quot;,&quot;AB&quot;),</div><div class="line">                                                                                        c(&quot;M&quot;,&quot;N&quot;,&quot;MN&quot;)))</div><div class="line">chi.result &lt;- chisq.test(data78)</div><div class="line">chi.result</div><div class="line"></div><div class="line">sqrt(chi.result$statistic/(sum(data78)+chi.result$statistic)) # 列联系数</div><div class="line"></div><div class="line"># 根据手工计算结果，可以构建一个计算Pearson列联系数的自定义函数，如下所示：</div><div class="line"></div><div class="line">Pearson_Continuity &lt;- function(x)&#123;</div><div class="line">  chisq_result &lt;- chisq.test(x)$statistic </div><div class="line">  # 提取计算的卡方值</div><div class="line">  Pcoc &lt;- sqrt(chisq_result/(sum(x)+chisq_result))</div><div class="line">  print.noquote(&quot;Persaon列联系数&quot;) </div><div class="line"># print.noquote的作用是显示字符，不带引号，</div><div class="line"># 而print则是带引号</div><div class="line">  return(as.numeric(Pcoc))&#125;</div><div class="line"></div><div class="line">Pearson_Continuity(data78)</div></pre></td></tr></table></figure></p>
<p>结果如下所示：<br><img src="http://ortxpw68f.bkt.clouddn.com/chi16.png" alt=""></p>
<h2 id="两两比较——所有组进行两两比较"><a href="#两两比较——所有组进行两两比较" class="headerlink" title="两两比较——所有组进行两两比较"></a>两两比较——所有组进行两两比较</h2><p>当对所有组进行两两比较时，通常采用的方法是Bonferroni法，此方法对原有的检验水平进行调整，即原有的检验水平α除以比较次数得到调整后的检验水平。书本（《医学统计学》第三版，孙振球，P122）中的公式在分母中加了1，不清楚为什么，没有提出采用的是Bonferroni法。而另外两本参考书，即《医学统计学》第6版，马斌荣，P91与《医学统计学》第6版，颜虹，2010年，P155这两本书中所用到的两两比较的方法是Bonferroni法，在下面的题目中使用Bonferroni法。</p>
<h3 id="案例9"><a href="#案例9" class="headerlink" title="案例9"></a>案例9</h3><p>对例7-6中的资料进行两两比较，以推断是否任两种疗法治疗周围性面神经麻痹的有效率均有差别？（《医学统计学》第四版，孙振球，第七章 卡方检验，例7-9）</p>
<p>例7-6中共有三组疗法，需要两两比较的次数是3次，因此检验水平是0.05/3=0.0167。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">data76&lt;-matrix(c(199,164,118,7,18,26),</div><div class="line">               nr = 3,</div><div class="line">               dimnames = list(c(&quot;物理疗法组&quot;, &quot;药物治疗组&quot;,&quot;外用膏药组&quot;),</div><div class="line">                               c(&quot;有效&quot;, &quot;无效&quot;)))</div><div class="line">chisq.test(data76[1:2,],correct=F) </div><div class="line"># 比较物理疗法组与药物治疗组，</div><div class="line"># R中默认四格表进行了Yates校正，</div><div class="line"># 此处设为F，不进行校正，因为实际值与观测值都大于5</div></pre></td></tr></table></figure>
<p>结果如下所示：<br><img src="http://ortxpw68f.bkt.clouddn.com/chi17.png" alt=""></p>
<p>从结果可以看出物理疗法组与药物治疗组有统计学差异。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">chisq.test(data76[2:3,], correct=F)</div><div class="line">#比较药物治疗组与外用膏药组</div></pre></td></tr></table></figure>
<p><img src="http://ortxpw68f.bkt.clouddn.com/chi18.png" alt=""><br>从结果来看，药物治疗组与外用膏药组无统计学上的差异。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">chisq.test(data76[-2,],correct=F)</div><div class="line"># 比较物理疗法组与外用膏药组</div></pre></td></tr></table></figure>
<p><img src="http://ortxpw68f.bkt.clouddn.com/chi19.png" alt=""></p>
<p>从结果来看，物理疗法组与外用膏药组有统计学上的差异。</p>
<h2 id="两两比较——各个实验组与一个对照组进行比较"><a href="#两两比较——各个实验组与一个对照组进行比较" class="headerlink" title="两两比较——各个实验组与一个对照组进行比较"></a>两两比较——各个实验组与一个对照组进行比较</h2><p>两两比较——各个实验组与一个对照组进行比较<br>当用各个实验组与一个对照组分别进行比较时，需要对检验水平α进行校正，即α/(k-1),其中k是组别。在此案例中，组别k=3,因此，调整后的检验水平=0.05/(3-2)=0.025。</p>
<h3 id="案例10"><a href="#案例10" class="headerlink" title="案例10:"></a>案例10:</h3><p>以表7-8资料中的药物治疗组为对照组，物理疗法组与外用膏药组为试验组，试分析两试验组与对照组的总体有效率有无差别？（《医学统计学》第四版，孙振球，第七章 卡方检验，例7-10）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">chisq.test(data76[1:2,],correct=F) </div><div class="line">#比较物理疗法组与药物治疗组</div><div class="line"></div><div class="line">chisq.test(data76[2:3,], correct=F) </div><div class="line">#比较药物治疗组与外用膏药组</div></pre></td></tr></table></figure>
<p><img src="http://ortxpw68f.bkt.clouddn.com/chi20.png" alt=""></p>
<p>第一个结果显示，P=0.009343小于0.025，表明物理疗法组与药物治疗组有统计学意义<br>第二个结果显示，P=0.03214大于0.025，表明药物治疗组与外用膏药组无统计学意义。</p>
<h2 id="单向R×C列联表分析——列有序"><a href="#单向R×C列联表分析——列有序" class="headerlink" title="单向R×C列联表分析——列有序"></a>单向R×C列联表分析——列有序</h2><h3 id="案例11"><a href="#案例11" class="headerlink" title="案例11"></a>案例11</h3><p>某公司研制一种治疗风湿性关节炎的中药，选择试验组和对照组各60例，试验组服用新药，对照组服用常规药物。以中医证侯疗效为主要疗效指标，分为无效、有效、显效、痊愈四个等级。治疗两个疗程后，两组的疗效情况如表5.4所示（略，见代码），欲分析两种药物的疗效是否有差异（《医学案例统计分析与SAS应用》第五章例5.4，冯国双，北京大学医学出版社，2010:93）。</p>
<h3 id="第一种方法：Ridit分析"><a href="#第一种方法：Ridit分析" class="headerlink" title="第一种方法：Ridit分析"></a>第一种方法：Ridit分析</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">data54 &lt;- c(33,18,24,31,1,9,2,2)</div><div class="line">data54m &lt;- matrix(data54,nrow=2,</div><div class="line">                  dimnames=list(c(&quot;对照组&quot;,&quot;实验组&quot;),</div><div class="line">                                c(&quot;无效&quot;,&quot;有效&quot;,&quot;显效&quot;,&quot;痊愈&quot;)))</div><div class="line">data54m</div><div class="line"></div><div class="line">#从数据来看，列变量，即无效、有效、显效、痊愈这四个等级是有序的，</div><div class="line"># 即越来越好，而行变量，对照组与实验组，这是无效的，适合采用Ridit分析：</div><div class="line"></div><div class="line">library(Ridit)</div><div class="line">ridit(data54m,1) </div><div class="line"># 函数ridit的参数中1表示分组信息是行，即行是无序的，列是有序的，</div><div class="line"># 如果是2，则表示分组信息在列，即列是无序的，行是有序的</div></pre></td></tr></table></figure>
<p><img src="http://ortxpw68f.bkt.clouddn.com/chi21.png" alt=""></p>
<h3 id="第二种方法：CMH分析"><a href="#第二种方法：CMH分析" class="headerlink" title="第二种方法：CMH分析"></a>第二种方法：CMH分析</h3><p>用CMH也能进行RC列联表的单向有序分析，CMHtest函数在vcdExtra包中，需要载入</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">library(vcdExtra)</div><div class="line">CMHtest(data54m)</div></pre></td></tr></table></figure>
<p><img src="http://ortxpw68f.bkt.clouddn.com/chi22.png" alt=""></p>
<p>CMH的单向有序分析参见第3行，即cmeans，这一行表示列有序，行无序的分析结果。</p>
<h2 id="双向有序R×C列联表分析-CMH检验"><a href="#双向有序R×C列联表分析-CMH检验" class="headerlink" title="双向有序R×C列联表分析-CMH检验"></a>双向有序R×C列联表分析-CMH检验</h2><p>对于双向有序的RC列联表进行分析，常用于CMH检验，卡方检验常用于分类变量资料的一种假设检验，该法主要用于两个或多个样本率的比较，也可以用于两变量间的关联分析、频属分析的拟合优度检验等。CMH检验是在1959年提出的mh统计方法的基础上提出来的，1988年才发展完善，现在习惯上称之为扩展的MH卡方检验。他们的主要区别在于，如果用同样的方法做同样的实验，由于实验的地点不同，若将这些不同地点的实验数据简单合并后有卡方检验，会参杂很多混杂因素，这会使检验结果产生很大的偏差—主要是由不同实验的点的软、硬条件不同造成的。采用CMH检验可以解决这类问题，采用的是多中心或分层分析方法，多用R×C列联表的分层统计处理1。此外，CMH还应用于双向有序的RC列联表的分析。如下所示：</p>
<h3 id="案例12"><a href="#案例12" class="headerlink" title="案例12"></a>案例12</h3><p>某研究者欲研究年龄与冠状动脉粥样硬化等级之间的关系，将278例尸解资料整理成表7-13，问年龄与冠状动脉粥样硬化等级之间是否存在线性变化趋势？（《医学统计学》第四版，孙振球，第七章 卡方检验，例7-9）</p>
<h4 id="第一种方法："><a href="#第一种方法：" class="headerlink" title="第一种方法："></a>第一种方法：</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">library(vcdExtra) </div><div class="line"># 载入vcdExtra包</div><div class="line">data711 &lt;- matrix(c(70,27,16,9,22,24,23,20,4,9,13,15,2,3,7,14),nrow=4)</div><div class="line">dimnames(data711) &lt;- list(age=c(&quot;20~&quot;,&quot;30~&quot;,&quot;40~&quot;,&quot;≥50&quot;),degree=c(&quot;-&quot;,&quot;+&quot;,&quot;++&quot;,&quot;+++&quot;))</div><div class="line">CMHtest(data711) # 分析数据</div><div class="line">chisq.test(data711)</div></pre></td></tr></table></figure>
<p><img src="http://ortxpw68f.bkt.clouddn.com/chi23.png" alt=""></p>
<h4 id="第二种方法："><a href="#第二种方法：" class="headerlink" title="第二种方法："></a>第二种方法：</h4><p>通过coin包中的lbl_test函数也能进行CMH双向有序表的计算：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">library(coin)</div><div class="line">data711t &lt;- as.table(data711)</div><div class="line">lbl_test(data711t,scores=list(age=c(1,2,3,4),degree=c(1,2,3,4)))</div></pre></td></tr></table></figure>
<p><img src="http://ortxpw68f.bkt.clouddn.com/chi24.png" alt=""></p>
<p>其中，scores是各个有序变量的得分，与教材中相同。</p>
<h4 id="第三种方法："><a href="#第三种方法：" class="headerlink" title="第三种方法："></a>第三种方法：</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">library(reshape2)</div><div class="line">datax &lt;- melt(data711)</div><div class="line">datax$age &lt;- factor(datax$age,order=T)</div><div class="line">datax$degree &lt;- factor(datax$degree,order=T)</div><div class="line">CMHtest(xtabs(value~age+degree,data=datax))</div></pre></td></tr></table></figure>
<p><img src="http://ortxpw68f.bkt.clouddn.com/chi25.png" alt=""></p>
<p>结果解读：(1)第1行的cor指的是行与列都为有序变量时的结果，即教材中的线性回归分量，为63.389，这个与教材的结果不一致，但R计算的结果与教材附带的SAS程序计算出来的结果一致，教材可能是印刷错误；(2)第2行的rmeans表示行是有序变量时的结果；(3)第3行的cmeans表示列是有序变量时的结果；(4)general表示列与行都是无序变量时的结果。</p>
<p>常规卡方计算的结果是71.4325。线性回归分量的结果是63.389，二者之差是教材中的偏离线性回归分量，即71.4325-63.389=8.0435，相应的P值为:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">1-pchisq(8.0435,8)</div></pre></td></tr></table></figure>
<p>p值结果为0.4292325，可以认为年龄与冠状动物粥样硬化之间不仅存在相关关系，并且为线性关系，从数据中可以看出来，冠状动脉粥样硬化的等级随着年龄的增加而增高。<br>注：pchisq(8.0435,8)表示，计算自由度为8，卡方值是8.0435的左侧卡方分布曲线下面积。</p>
<h2 id="CMH检验对多层分类资料的分析"><a href="#CMH检验对多层分类资料的分析" class="headerlink" title="CMH检验对多层分类资料的分析"></a>CMH检验对多层分类资料的分析</h2><h3 id="案例13"><a href="#案例13" class="headerlink" title="案例13"></a>案例13</h3><p>某公司推出一种治疗颈椎病的治疗仪，为评价其疗效，进行多中心的随机对照试验。共选择两家医院，每家医院60例研究对象，试验组与对照组各30例。以颈痛疗效作为主要疗效指标，根据缓解程度分为有效和无效。治疗20天后，各中心每组的疗效情况如下所示（参见代码），欲分析两种治疗仪的疗效是否有差异（《医学案例统计分析与SAS应用》第五章例5.4，冯国双，北京大学医学出版社，2010:97）。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">data56 &lt;- c(8,4,22,26,11,9,19,21)</div><div class="line">data56a &lt;- array(data56,dim=c(2,2,2))</div><div class="line">data56a</div><div class="line">dimnames(data56a) &lt;- list(</div><div class="line">  c(&quot;对照组&quot;,&quot;试验组&quot;),</div><div class="line">  c(&quot;无效&quot;,&quot;有效&quot;),</div><div class="line">  c(&quot;中心1&quot;,&quot;中心2&quot;))</div><div class="line"></div><div class="line">CMHtest(data56a,overall=TRUE)</div></pre></td></tr></table></figure>
<p><img src="http://ortxpw68f.bkt.clouddn.com/chi26.png" alt=""></p>
<p>结果由三部分构成，第一部分是中心1的结果，第二部分是中心2 的结果，第三部分是控制了中心的影响后，两组疗效差异无统计学意义。</p>
<h2 id="频数分布拟合优势的卡方检验"><a href="#频数分布拟合优势的卡方检验" class="headerlink" title="频数分布拟合优势的卡方检验"></a>频数分布拟合优势的卡方检验</h2><h3 id="案例14"><a href="#案例14" class="headerlink" title="案例14"></a>案例14</h3><p>观察某克山病区克山病患者的空间分布情况，调查者将该地区划分为279个取样单位，统计各取样单位历年累计病例数，资料见表7-15的第（1）、（2）栏，问此资料是否服从Poisson分布？（《医学统计学》第三版，孙振球，第七章 卡方检验，例7-13）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">x&lt;-0:6</div><div class="line">y&lt;-c(26,51,75,63,38,17,9)</div><div class="line">mean&lt;-mean(rep(x,y))</div><div class="line">q&lt;-ppois(x,mean)</div><div class="line">n&lt;-length(y)</div><div class="line">p&lt;-c()</div><div class="line">p[1]&lt;-q[1]</div><div class="line">p[n]&lt;-1-q[n-1]</div><div class="line">for(i in 2:(n-1))</div><div class="line">  p[i]&lt;-q[i]-q[i-1]</div><div class="line"></div><div class="line">chisq.test(y, p=p,correct=F)</div></pre></td></tr></table></figure>
<p><img src="http://ortxpw68f.bkt.clouddn.com/chi27.png" alt=""></p>
<h3 id="案例15-皮尔森拟合优度卡方检验"><a href="#案例15-皮尔森拟合优度卡方检验" class="headerlink" title="案例15 皮尔森拟合优度卡方检验"></a>案例15 皮尔森拟合优度卡方检验</h3><p>假设H0：总体具有某分布F 备择假设H1：总体不具有该分布。<br>我们将数轴分成若干个区间，所抽取的样本会分布在这些区间中。在原假设成立的条件下，我们便知道每个区间包含样本的个数的期望值。用实际值Ni 与期望值Npi可以构造统计量K 。皮尔森证明，n趋向于无穷时，k收敛于m-1的塔防分布。m为我们分组的个数。有了这个分布，我们就可以做假设检验。 </p>
<p>某消费者协会为了确定市场上消费者对5咎品牌啤酒的喜好情况，随机抽取了1000名啤酒爱好者作为样本进行如下试验：每个人得到5种品牌的啤酒各一瓶，但未标明牌子。这5种啤酒按分别写着A、B、C、D、E字母的5张纸片随机的顺序送给每一个人，下表是根据样本资料整理得的各种品牌啤酒爱好者的频数分页，试根据这些数据判断消费者对这5种品牌啤酒的爱好有无明显差异？<br><img src="http://ortxpw68f.bkt.clouddn.com/chi28.png" alt=""></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">x &lt;- c(210,312,170,85,223) </div><div class="line">n &lt;- sum(x); m &lt;- length(x) </div><div class="line">p &lt;- rep(1/m,m) </div><div class="line">K &lt;- sum((x-n*p)^2/(n*p)); K #计算出K值 </div><div class="line">p &lt;- 1-pchisq(K,m-1); p #计算出p值</div></pre></td></tr></table></figure>
<p><img src="http://ortxpw68f.bkt.clouddn.com/chi29.png" alt=""></p>
<p>在R语言中 chisq.test()，可以完成拟合优度检验。默认就是检验是否为均匀分布，如果是其他分布，需要自己分组，并在参数p中指出。上面题目的解法如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">chisq(x)</div></pre></td></tr></table></figure>
<p><img src="http://ortxpw68f.bkt.clouddn.com/chi30.png" alt=""></p>
<p>同样拒绝原假设。</p>
<h3 id="案例16-检验是否为正态分布"><a href="#案例16-检验是否为正态分布" class="headerlink" title="案例16 检验是否为正态分布"></a>案例16 检验是否为正态分布</h3><p>抽取31名学生的成绩，检验是否为正态分布。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">x &lt;- c(25,45,50,54,55,61,64,68,72,75,75,78,79,81,83,84,84,84,85,86,86,86,87,89,89,89,90,91,91,92,100) </div><div class="line">A &lt;- table(cut(x,breaks=c(0,69,79,89,100))) ;A#对样本数据进行分组。 </div><div class="line">p &lt;- pnorm(c(70,80,90,100),mean(x),sd(x)) #获得理论分布的概率值 </div><div class="line">p &lt;- c(p[1],p[2]-p[1],p[3]-p[2],1-p[3]) </div><div class="line">chisq.test(A,p=p)</div></pre></td></tr></table></figure>
<p><img src="http://ortxpw68f.bkt.clouddn.com/chi31.png" alt=""><br>结果显示，其p值小于0.05，成绩不属于正态分布。</p>
<p>再用shirpo.test()和qq图检验一下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">shapiro.test(x)</div><div class="line">qqnorm(x);qqline(x, col = 2)</div></pre></td></tr></table></figure>
<p><img src="http://ortxpw68f.bkt.clouddn.com/chi32.png" alt=""><br><img src="http://ortxpw68f.bkt.clouddn.com/chi33.png" alt=""></p>
<p>结果显示，p值小于0.05，不是正态分页，并且QQ图明显表示出成绩不符合正态分布。</p>
<h3 id="案例17-检验是否符合原比例"><a href="#案例17-检验是否符合原比例" class="headerlink" title="案例17 检验是否符合原比例"></a>案例17 检验是否符合原比例</h3><p>大麦杂交后关于芒性的比例应该是 无芒：长芒：短芒=9:3:4 。我们的实际观测值是335：125：160 。请问观测值是否符合预期？<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">p &lt;- c(9/16,3/16,4/16) </div><div class="line">x &lt;- c(335,125,160) </div><div class="line">chisq.test(x,p=p)</div></pre></td></tr></table></figure></p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/chi34.png" alt=""></p>
<p>在分组的时候要注意，每组的频数要大于等于5.如果理论分布依赖于多个未知参数，只能先由样本得到参数的估计量。然后构造统计量K，此时K的自由度减少位置参数的数量个。</p>
<h2 id="ks检验"><a href="#ks检验" class="headerlink" title="ks检验"></a>ks检验</h2><p>R语言中提供了ks.test()函数，理论上可以检验任何分布。他既能够做单样本检验，也能做双样本检验。 </p>
<h3 id="案例18"><a href="#案例18" class="headerlink" title="案例18"></a>案例18</h3><p>记录一台设备无故障工作时常，并从小到大排序420 500 920 1380 1510 1650 1760 2100 2300 2350。问这些时间是否服从拉姆达=1/1500的指数分布？<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">x &lt;- c(420,500,920,1380,1510,1650,1760,2100,2300,2350) </div><div class="line">ks.test(x,&quot;pexp&quot;,1/1500)</div></pre></td></tr></table></figure></p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/chi35.png" alt=""></p>
<h3 id="案例19："><a href="#案例19：" class="headerlink" title="案例19："></a>案例19：</h3><p>有两个分布，分别抽样了一些数据，问他们是否服从相同的分布。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">X&lt;-scan() </div><div class="line">0.61 0.29 0.06 0.59 -1.73 -0.74 0.51 -0.56 0.39 1.64 0.05 -0.06 0.64 -0.82 0.37 1.77 1.09 -1.28 2.36 1.31 1.05 -0.32 -0.40 1.06 -2.47</div><div class="line"></div><div class="line">Y&lt;-scan() </div><div class="line">2.20 1.66 1.38 0.20 0.36 0.00 0.96 1.56 0.44 1.50 -0.30 0.66 2.31 3.29 -0.27 -0.37 0.38 0.70 0.52 -0.71</div><div class="line"></div><div class="line">ks.test(X,Y)</div></pre></td></tr></table></figure></p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/chi36.png" alt=""></p>
<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><ol>
<li><a href="http://doctor.51daifu.com/2007/0305/1ADAD919C959T148648.shtml" target="_blank" rel="external">http://doctor.51daifu.com/2007/0305/1ADAD919C959T148648.shtml</a></li>
<li><a href="http://blog.sina.com.cn/s/blog_686dcf990100z9q3.html" target="_blank" rel="external">http://blog.sina.com.cn/s/blog_686dcf990100z9q3.html</a></li>
<li><a href="http://medstats.blog.163.com/blog/static/17974801620089108192736/" target="_blank" rel="external">http://medstats.blog.163.com/blog/static/17974801620089108192736/</a></li>
<li><a href="http://blog.sina.com.cn/s/blog_4b361fe00100y222.html" target="_blank" rel="external">http://blog.sina.com.cn/s/blog_4b361fe00100y222.html</a></li>
<li>孙振球. 医学统计学[M]. 人民卫生出版社, 2010.</li>
<li>徐俊晓. 统计学与R读书笔记(第六版)</li>
<li>葛毅, 胡良平. 高维列联表资料的统计分析与 SAS 软件实现 (一)[J]. 中西医结合学报, 2009, 7(11): 1086-1089.</li>
<li><a href="http://bbs.pinggu.org/thread-521307-1-1.html↩" target="_blank" rel="external">http://bbs.pinggu.org/thread-521307-1-1.html↩</a></li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2017/08/17/实验笔记-质粒构建/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="我的笔记">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/08/17/实验笔记-质粒构建/" itemprop="url">质粒构建</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-08-17T12:02:00+08:00">
                2017-08-17
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/生物实验笔记/" itemprop="url" rel="index">
                    <span itemprop="name">生物实验笔记</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2017/08/11/文献笔记-斑马鱼/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="我的笔记">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/08/11/文献笔记-斑马鱼/" itemprop="url">斑马鱼</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-08-11T12:00:00+08:00">
                2017-08-11
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/文献笔记/" itemprop="url" rel="index">
                    <span itemprop="name">文献笔记</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2017/08/10/实验笔记-cas9/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="我的笔记">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/08/10/实验笔记-cas9/" itemprop="url">Crispr/Cas9笔记</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-08-10T12:01:00+08:00">
                2017-08-10
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/生物实验笔记/" itemprop="url" rel="index">
                    <span itemprop="name">生物实验笔记</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>##来源<br>Crispr/Cas9在微生物中起到的作用就是识别入侵、将病毒的DNA录入自己的基因组，当病毒再次入侵时候，切割病毒DNA、RNA进而消除病毒的感染。CRISPR（Clustered regularly interspaced short palindromic repeats）是生命进化历史上，细菌和病毒进行斗争产生的免疫武器，简单说就是病毒能把自己的基因整合到细菌，利用细菌的细胞工具为自己的基因复制服务，细菌为了将病毒的外来入侵基因清除，进化出CRISPR系统，利用这个细菌免疫系统，细菌地把病毒基因从自己的染色体上切除，这是细菌特有的免疫系统。</p>
<h2 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h2><h3 id="结构"><a href="#结构" class="headerlink" title="结构"></a>结构</h3><p>Crispr技术有两个分子在参与：Cas9核酸酶+sgRNA（自行设计）。其中Cas9核酸酶的基因已经被整合到商业化载体中，只要自行设计sgRNA，然后构建Cas9/sgRNA表达载体，转染细胞，就可以行使基因组的定点基因编辑任务。sgRNA（small-guided RNA）是CRISPR基因敲除敲入系统中重要的组成部分，由两部分组成—tracRNA和crRNA，两部分融合表达后，即sgRNA，与cas9蛋白结合，引导cas9酶靶向基因组DNA进行剪切。示意图如下所示：<br><img src="http://ortxpw68f.bkt.clouddn.com/cas9%20%281%29.jpg" alt=""></p>
<h3 id="各原件作用"><a href="#各原件作用" class="headerlink" title="各原件作用"></a>各原件作用</h3><p>Crispr各原件的组成如下所示：<br><img src="http://ortxpw68f.bkt.clouddn.com/cas9%20%283%29.png" alt=""><br>CRISPR簇是一个广泛存在于细菌和古生菌基因组中的特殊DNA重复序列家族，其序列由一个<strong>前导区(Leader)</strong>、多个短而高度保守的<strong>重复序列区(Repeat)</strong>和<strong>多个间隔区(Spacer)</strong>组成。</p>
<p>前导区一般位于CRISPR簇上游，是富含AT长度为300～500bp的区域，被认为可能是CRISPR簇的<strong>启动子序列</strong>。</p>
<p>重复序列区长度为21～48bp，含有回文序列，可形成发卡结构。重复序列之间被长度为26～72bp的<strong>间隔区</strong>隔开。</p>
<p>间隔区域由俘获的外源DNA组成，类似免疫记忆，当含有同样序列的外源DNA入侵时，可被细菌机体识别，并进行剪切使之表达沉默，达到保护自身安全的目的。</p>
<h3 id="如何发挥作用"><a href="#如何发挥作用" class="headerlink" title="如何发挥作用"></a>如何发挥作用</h3><p>作用示意图如下所示：<br><img src="http://ortxpw68f.bkt.clouddn.com/cas9%20%285%29.jpg" alt=""></p>
<h4 id="阶段-1：外源-DNA-采集"><a href="#阶段-1：外源-DNA-采集" class="headerlink" title="阶段 1：外源 DNA 采集"></a>阶段 1：外源 DNA 采集</h4><p>外源核苷酸是通过Cas 蛋白识别，入侵的短片段DNA（30-50个碱基对）被称为protospacers，作为间隔序列插入宿 主CRISPR 位点中，由重复序列隔开。对于I型和II型系统来说，protospacers来自入侵 DNA 中两侧出现2-5 个核酸结构（PAM，protospacer adjacent motif）的区域。一般 protospacers 连接在CRISPR 位点的一端，并且后者通过涉及 Cas1、Cas2 和 游离3’-hydroxyls 等元件的机制，牵引序列。Protospacer 的整合过程中也出现了牵引末端重新序列复制，这可能涉及宿主聚合酶和DNA修复机制。如下所示：<br><img src="http://ortxpw68f.bkt.clouddn.com/cas9_1.png" alt=""></p>
<h4 id="阶段-2：crRNA-合成"><a href="#阶段-2：crRNA-合成" class="headerlink" title="阶段 2：crRNA 合成"></a>阶段 2：crRNA 合成</h4><p>CRISPR RNA 在转录之后，生成初级转录产物：pre-crRNA，之后经过加工，又成为一组短小的 CRISPR衍生RNAs（crRNAs），这些crRNAs 每一个都包含有对应于之前遇到的外源DNA的对应序列。<br><img src="http://ortxpw68f.bkt.clouddn.com/cas9_2.png" alt=""></p>
<h4 id="阶段-3：靶向干扰"><a href="#阶段-3：靶向干扰" class="headerlink" title="阶段 3：靶向干扰"></a>阶段 3：靶向干扰</h4><p>在pre-crRNA转录的同时，与其重复序列互补的反式激活tracrRNA(Trans-activating crRNA，tracrRNA)也转录出来，并且激发Cas9和双链RNA特异性RNase III核酸酶对pre-crRNA进行加工。加工成熟后，crRNA、tracrRNA和Cas9组成复合体，识别并结合于crRNA互补的序列，然后解开DNA双链，形成R-loop，使crRNA与互补链杂交，另一条链保持游离的单链状态，然后由Cas9中的HNH活性位点剪切crRNA的互补DNA链，RuvC活性位点剪切非互补链，最终引入DNA双链断裂(DSB)。CRISPR／Cas9的剪切位点位于crRNA互补序列下游邻近的PAM区(Protospacer Adjacent Motif)的5’-GG-N18-NGG-3’特征区域中的NGG位点，而这种特征的序列在每128bp的随机DNA序列中就重复出现一次。<br><img src="http://ortxpw68f.bkt.clouddn.com/cas9_3.png" alt=""></p>
<h4 id="补充：cas9解螺旋的过程"><a href="#补充：cas9解螺旋的过程" class="headerlink" title="补充：cas9解螺旋的过程"></a>补充：cas9解螺旋的过程</h4><p>Cas9可以解开DNA，gRNA和target dsDNA配对是在解旋之后所进行（文献为：Sternberg, S. H., et al. (2014). “DNA interrogation by the CRISPR RNA-guided endonuclease Cas9.” Nature 507(7490): 62-67.）。步骤如下：</p>
<ol>
<li>gRNA和Cas9形成Cas9:gRNA complex.</li>
<li>这个complex来寻找双链DNA上的PAM位点。因为crisper/cas9源于细菌的防御机制，为了定点清除进入细胞内的“异己DNA而设计”，PAM就是evolutionary conserved关于“异己DNA”的特异标志，所以Cas9需要识别PAM也就不难解释了。现在分子生物学常用的Cas9源自S. Pyogenes这个细菌种属，这种Cas9的特异PAM是5’ NGG(N可以是任何nucleotide)。在人类基因组上GG占5%（每42bp就有一个），因此人的绝大多数基因都在PAM附近，也就意味着几乎所有人的基因都可以被Cas9识别。</li>
<li>当Cas9:gRNA complex识别到PAM的时候，Cas9就会把下游的双链DNA解旋，然后这个complex来根据gRNA的序列“扫描”解旋的DNA，一旦发现和gRNA序列互补的DNA，Cas9就会把DNA切开，完成操作。</li>
</ol>
<p>下图是Doudna那篇paper的原理解释的figure<img src="http://ortxpw68f.bkt.clouddn.com/cas9_4.png" alt=""></p>
<h2 id="SgRNA的序列特征和设计"><a href="#SgRNA的序列特征和设计" class="headerlink" title="SgRNA的序列特征和设计"></a>SgRNA的序列特征和设计</h2><h3 id="SgRNA的序列设计原理"><a href="#SgRNA的序列设计原理" class="headerlink" title="SgRNA的序列设计原理"></a>SgRNA的序列设计原理</h3><p>  SgRNA 设计靶序列选择：在NCBI找到该基因CDS区，分析相应的基因组结构，明确CDS的外显子部分。按照基因本身的性质，选择候选的待敲除位点，确定待敲除位点。对于蛋白编码基因，如果该蛋白具重要结构功能域，可考虑将基因敲除位点设计在编码该结构域的外显子。可选择将待敲除位点放在起始密码子ATG后的外显子上。如果被敲除的靶标基因是microRNA或者lncRNA，可以将待敲除位点设计在编码成熟microRNA的外显子或在编码成熟microRNA的外显子的5’和3’侧翼序列。</p>
<p>gRNA设计：通常情况下我们仅需要在你的目的位置附近找到PAM序列：NGG（N代表任意核苷酸），然后找到其紧邻的上游20 nt即可 （如下图所示）。<br><img src="http://ortxpw68f.bkt.clouddn.com/cas9.1.1.jpg" alt=""></p>
<p>目的位置的选择：我们绝大部分时候的目的是完全敲除一个基因，其原理是利用移码突变（CRISPR/Cas系统诱导产生indel）。</p>
<blockquote>
<p>注：indel全称为insertion，deletion，即插入，缺失，缩写为indel，<br>插入如下：<br>生物原始基因序列：ATCGTCGAATCCGGTTG<br>发生突变基因序列：ATCGTCGAAatcgTCCGGTTG，其中的小写字母atcg为插入的序列，为插入突变；</p>
<p>缺失：<br>生物原始基因序列：ATCGTCGAAtccgGTTG<br>发生突变基因序列：ATCGTCGAAGTTG，其中，原始序列里的小写字母tccg为缺失的序列，为缺失突变；<br>  插入和缺失都相对于原始序列来说：缺失指，在原始序列中的某一段丢失；插入指，相对于原始序列在某个位置多了一段序列，即在这个位置插入了一段序列</p>
</blockquote>
<p>因此我们一般选择距离起始密码子ATG下游200bp范围内的exon区域。另外，通常一个基因往往会转录成2个以上的转录本，所以请选择尽量靠近5’端的公共部分，保证每个转录本都会成功移码突变。</p>
<p>通常情况下，为了便于下游KO mutants的鉴定，我们往往可以作如下设计：即Cas9的切割位点刚好被一个酶切位点跨过，且附近至少100 bp内酶切位点唯一（下游的敲除突变也能通过测序的手段来鉴定）。<br><img src="http://ortxpw68f.bkt.clouddn.com/cas9.1.2.jpg" alt=""></p>
<p>上图的酶切示意图就显示了，敲除突变无法被酶切，而野生型的则能够进行酶切。</p>
<h3 id="sgRNA的设计流程"><a href="#sgRNA的设计流程" class="headerlink" title="sgRNA的设计流程"></a>sgRNA的设计流程</h3><p>在数据中找到自己的目的序列，通过在线网站设计(<a href="http://crispr.mit.edu)来设计要敲除的靶序列，如下所示：" target="_blank" rel="external">http://crispr.mit.edu)来设计要敲除的靶序列，如下所示：</a><br><img src="http://ortxpw68f.bkt.clouddn.com/cas9.1.5.jpg" alt=""></p>
<p>分析中，显示你所键入的基因序列里有22对可选的guide序列，如下所示。<br><img src="http://ortxpw68f.bkt.clouddn.com/cas9.1.6.png" alt=""></p>
<p>分析结束，点击Download as genbank查看结果，此时也会收到邮件，如下所示。<br><img src="http://ortxpw68f.bkt.clouddn.com/cas9.1.7.png" alt=""></p>
<p>单击<code>Download as genbank1</code>，能够查看所有guide序列的评分，如下所示：<br><img src="http://ortxpw68f.bkt.clouddn.com/cas9.1.9.png" alt=""></p>
<blockquote>
<h3 id="降低脱靶概率原则如下："><a href="#降低脱靶概率原则如下：" class="headerlink" title="降低脱靶概率原则如下："></a>降低脱靶概率原则如下：</h3><ol>
<li>sgRNA的长度一般应为20 nt左右；</li>
<li>对于sgRNA序列的碱基组成，可选3’末端含GG的sgRNA，同时sgRNA种子序列尽量避免以4个以上的T结尾，GC%含量最佳为40%~60%；</li>
<li>sgRNA在设计网站上的评分越高，越容易脱靶；</li>
<li>如需造成基因knockout，需尽量选择包含有ATG的外显子或靠近ATG的外显子；</li>
<li>检查sgRNA靶向结合位点基因组序列是否存在SNPs；</li>
<li>如采用Cas9单切口，设计paired-gRNA需考虑sgRNA之间的间距；</li>
<li>全基因脱靶效应分析，需考虑脱靶位点最大允许几个错配碱基数，建议最少5个碱基。重点考察种子序列和非种子序列碱基错配数。</li>
</ol>
</blockquote>
<p>通常选择分数较高的Guide序列，以Guide#1序列为例，2条单链oligo的序列如下：oligo1：5’-<strong>caccG</strong>CTGTTTGTGCAGGGCTCCGA -3’； oligo2：5’- <strong>aaac</strong>TCGGAGCCCTGCACAAACAG<strong>c</strong>-3’。加粗部分与经BsmBI酶切后的载体互补配对。BsmBI又名BbsI，它的酶切位点如下所示：<img src="https://www.neb.com/~/media/Catalog/All-Products/8FD67221124342CCB2F58C64960B66EC/Cut%20Site%20Image/BsmB-I-cutsite_1.gif" alt=""></p>
<p><strong>注：有关与BsmBI酶切的一些信息</strong><br>现在使用Cas9技术时，通常使用的是<a href="https://www.addgene.org/52961/" target="_blank" rel="external">lentiCRISPR v2载体</a>，这个载体中插入外源基因的序列如下所示：</p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/cas9.1.10.png" alt=""></p>
<p>当质粒经过BsmBI酶切后，产生的缺口如下所示：<br><img src="http://ortxpw68f.bkt.clouddn.com/cas9.1.11.png" alt=""></p>
<p>因此，在上述的靶序列中，有一条是5’-CTGTTTGTGCAGGGCTCCGA-3’，它要在两边加上caccG，这个cacc与BsmBI酶切后的gtgg配对，加G是因为这个转录起始位点，必须要加上，如果本身第一个是G，则不需要添加，另一条是5’-TCGGAGCCCTGCACAAACAG-3’，它的两端要加上aaac与gttt配对，其模式如下所示：<img src="http://ortxpw68f.bkt.clouddn.com/cas9.1.12.png" alt=""></p>
<h2 id="实验流程"><a href="#实验流程" class="headerlink" title="实验流程"></a>实验流程</h2><h3 id="载体构建流程"><a href="#载体构建流程" class="headerlink" title="载体构建流程"></a>载体构建流程</h3><p><strong>1. Oligo退火形成duplex</strong></p>
<table>
<thead>
<tr>
<th>Component</th>
<th style="text-align:center">Volume</th>
</tr>
</thead>
<tbody>
<tr>
<td>oligo1</td>
<td style="text-align:center">1ul(100uM)</td>
</tr>
<tr>
<td>oligo2</td>
<td style="text-align:center">1uL(100uM)</td>
</tr>
<tr>
<td>H2O</td>
<td style="text-align:center">8uL</td>
</tr>
<tr>
<td>total</td>
<td style="text-align:center">10uL</td>
</tr>
</tbody>
</table>
<p>PCR仪 95℃ 5 min，缓慢降温至室温1h，1：200稀释duplex。PCR仪 95℃ 5 min，缓慢降温至室温1h，1：200稀释duplex。</p>
<p><strong>2. 质粒酶切</strong></p>
<table>
<thead>
<tr>
<th>Component</th>
<th style="text-align:center">Volume</th>
</tr>
</thead>
<tbody>
<tr>
<td>lentiCRISPR plasmid</td>
<td style="text-align:center">2ug</td>
</tr>
<tr>
<td>BsmBI</td>
<td style="text-align:center">1uL</td>
</tr>
<tr>
<td>10X buffer</td>
<td style="text-align:center">2uL</td>
</tr>
<tr>
<td>H2O</td>
<td style="text-align:center">X uL</td>
</tr>
<tr>
<td>total</td>
<td style="text-align:center">10 uL</td>
</tr>
</tbody>
</table>
<p><strong>3. 胶回收</strong><br>大片段约11kb 回收；小片段约2kb为切下来的filler，不要。</p>
<p><strong>4. 连接</strong></p>
<table>
<thead>
<tr>
<th>Component</th>
<th style="text-align:center">Volume</th>
</tr>
</thead>
<tbody>
<tr>
<td>T4 DNA ligase</td>
<td style="text-align:center">2ug</td>
</tr>
<tr>
<td>5X DNA ligase buffer</td>
<td style="text-align:center">1uL</td>
</tr>
<tr>
<td>digested lentiCRISPR plasmid</td>
<td style="text-align:center">2uL</td>
</tr>
<tr>
<td>duplex</td>
<td style="text-align:center">6 uL</td>
</tr>
<tr>
<td>total</td>
<td style="text-align:center">10 uL</td>
</tr>
</tbody>
</table>
<p>室温连接4-6h。</p>
<h3 id="病毒包装体系"><a href="#病毒包装体系" class="headerlink" title="病毒包装体系"></a>病毒包装体系</h3><table>
<thead>
<tr>
<th>Component</th>
<th style="text-align:center">Volume</th>
</tr>
</thead>
<tbody>
<tr>
<td>lentiCRISPR v2-gDNA plasmid</td>
<td style="text-align:center">4ug</td>
</tr>
<tr>
<td>psPAX2 packaging plasmid</td>
<td style="text-align:center">3ug</td>
</tr>
<tr>
<td>pMD2.G envelope plasmid</td>
<td style="text-align:center">1ug</td>
</tr>
</tbody>
</table>
<h3 id="转染"><a href="#转染" class="headerlink" title="转染"></a>转染</h3><p>转染条件与常规的病毒转染相同。</p>
<p>转染48h后，加入puromycin来筛选细胞。</p>
<h3 id="测序"><a href="#测序" class="headerlink" title="测序"></a>测序</h3><p>经puromycin来筛选细胞后的细胞的提取DNA，测序，切割位点处的产生的套峰表示有效编辑的效应为50%，如下所示：<br><img src="http://ortxpw68f.bkt.clouddn.com/cas9.1.13.png" alt=""></p>
<h3 id="单克隆的获取"><a href="#单克隆的获取" class="headerlink" title="单克隆的获取"></a>单克隆的获取</h3><p><strong>单克隆的挑取</strong><br>可以有限稀释到96-well plate（～30 cells/plate）（293T、HeLa、MEF等细胞系推荐使用）。如果编辑效率50%，推荐分两块plate即可，最终拿到20-30个单克隆一般可以得到成功KO的细胞系；或者铺到100 mm dish里，一周后挑取单克隆（这种方法适合单细胞不容易成活的细胞系如，但是挑取的单克隆偶尔不纯，有时需要重新亚克隆）。</p>
<p><strong>单克隆的鉴定</strong></p>
<p>根据设计，推荐使用酶切鉴定的方法（见设计部分），通量高；如果抗体比较好用，推荐使用WB检测蛋白，这种方法最彻底；最末一种方法就是直接测序鉴定，该种方法费时费力费钱，建议设计时尽量避开。</p>
<p><strong>有限稀释法</strong>（悬浮细胞适用此法）—50-100 cells 均匀分到96-well plate</p>
<h3 id="KO-单克隆的鉴定"><a href="#KO-单克隆的鉴定" class="headerlink" title="KO 单克隆的鉴定"></a>KO 单克隆的鉴定</h3><p>抽取genomic DNA，然后PCR测序或者或者酶切鉴定</p>
<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><ol>
<li><a href="https://mp.weixin.qq.com/s?__biz=MzIwMzA1MzU5Mg==&amp;mid=2652130380&amp;idx=1&amp;sn=bef6d7313ccb3f12be7016ff9a9904b2&amp;chksm=8d35a33bba422a2d5b1b8c584c867f6bc6d58171abcc0ebd9396425548de7fafba56dd4525a6&amp;mpshare=1&amp;scene=1&amp;srcid=0601Rzuo25J14J1qV3dGnt2X#rd" target="_blank" rel="external">CRISPR-Cas9全程实操教程：从gRNA设计到挑单克隆全程指导</a></li>
<li><a href="https://mp.weixin.qq.com/s?__biz=MzI1NjM1MTI5Ng==&amp;mid=2247483920&amp;idx=1&amp;sn=e5ca3f72224f6969a47d045dac524a3d&amp;chksm=ea294f3fdd5ec629922c95bccb834a5de614dea239b2ecb8068f481e025ae713e26bd817bde0&amp;mpshare=1&amp;scene=1&amp;srcid=0601BWh4Ddc7rKy2EQdgQ673#rd" target="_blank" rel="external">CRISPR是啥？有啥用呢？</a></li>
<li><a href="https://mp.weixin.qq.com/s?__biz=MzIwMzA1MzU5Mg==&amp;mid=2652129836&amp;idx=1&amp;sn=6de31effa8067e9ad0aa37cb853730bd&amp;chksm=8d35a55bba422c4db5895861874342c941f0d5328a752d403367f1bc25dcc101157ce0f82a8b&amp;mpshare=1&amp;scene=1&amp;srcid=0601o4qI8nI9LrvSy8MQJuI4#rd" target="_blank" rel="external">一文掌握CRISPR/Cas9系统操作方法，超详细protocol来袭！</a></li>
<li><a href="https://mp.weixin.qq.com/s?__biz=MzA3ODU1NjUyNw==&amp;mid=2652327260&amp;idx=1&amp;sn=7911a3fe8b1bb21585dfd7814487fe07&amp;chksm=84a3115cb3d4984a676eef8095378cdef62129e302a7117df0671cedf5b6fb809a7c26469cbb&amp;mpshare=1&amp;scene=1&amp;srcid=0402E74Gygnekd7PjPsxnYTt#rd" target="_blank" rel="external">CRISPR是什么鬼？</a></li>
<li><a href="http://mp.weixin.qq.com/s?__biz=MzA4OTQ1MTQxNg==&amp;mid=2652035754&amp;idx=3&amp;sn=5199f544cb35d48feceb5afe9756a016&amp;chksm=8bfcc45dbc8b4d4bef6b38762c7ef396e5bece9c3bce93c698ef136430c2b924eb9cbba7b1d7&amp;mpshare=1&amp;scene=1&amp;srcid=1118LOtqMnGmnCvH8AyAqX0F#rd" target="_blank" rel="external">手把手教你搞定 CRISPR/Cas9 系统操作</a></li>
<li><a href="http://mp.weixin.qq.com/s?__biz=MzIwMzA1MzU5Mg==&amp;mid=2652130074&amp;idx=1&amp;sn=f968e2adc98c46d1ed8635137080bccd&amp;chksm=8d35a46dba422d7bc7780de61641534d80ad8339341ef2f5f48ae640a811c0e156c054c087ed&amp;mpshare=1&amp;scene=1&amp;srcid=0308HdSWMpPPvWyUxeKS5NgY#rd" target="_blank" rel="external">一文掌握gRNA的设计，常用方法汇总解析</a></li>
<li><a href="http://mp.weixin.qq.com/s?__biz=MzIwMzA1MzU5Mg==&amp;mid=2652130160&amp;idx=1&amp;sn=75d4973ba598a18ec83a7ac16a40aeea&amp;chksm=8d35a407ba422d119dd11efe3e1d8b920a9952953b8d9ec7a3b4bbe4dc4cc714c50247fd2e18&amp;mpshare=1&amp;scene=1&amp;srcid=1215mEkQv3xNCdRr7Nr4btVZ#rd" target="_blank" rel="external">手把手教你利用CRISPR-Cas9系统精准敲除靶标基因</a></li>
<li><a href="https://mp.weixin.qq.com/s?__biz=MzI0NzExMTg0NQ==&amp;mid=2649394829&amp;idx=1&amp;sn=2455a14b541c3c1ee193e933b5a63d36&amp;mpshare=1&amp;scene=1&amp;srcid=0308tQUjqA03Kq46VpXqJuEv#rd" target="_blank" rel="external">白友“冰糖”分享：CRISPR/Cas9系统操作实例</a></li>
<li><a href="https://mp.weixin.qq.com/s?__biz=MzI0NzExMTg0NQ==&amp;mid=2649394843&amp;idx=1&amp;sn=1199decf9215e2e93e471fcf7baec00f&amp;mpshare=1&amp;scene=1&amp;srcid=1012EzBZX1Z6UqfvCCQxH827#rd" target="_blank" rel="external">CRISPR/Cas9系统操作实例分享之二：LentiCRISPR v2</a></li>
<li><a href="https://mp.weixin.qq.com/s?__biz=MzA4OTQ1MTQxNg==&amp;mid=2652034666&amp;idx=1&amp;sn=4915148f19dc76e2f7c9e8aa29a58228&amp;scene=1&amp;srcid=06256AxjFUm6DsklabrlylIN#rd" target="_blank" rel="external">手把手教你搞定 CRISPR/Cas9 系统操作</a></li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2017/08/01/生物信息学笔记-计算机配置/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="我的笔记">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/08/01/生物信息学笔记-计算机配置/" itemprop="url">生信笔记-计算机配置</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-08-01T12:02:00+08:00">
                2017-08-01
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/生物信息学/" itemprop="url" rel="index">
                    <span itemprop="name">生物信息学</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="操作系统"><a href="#操作系统" class="headerlink" title="操作系统"></a>操作系统</h3><p>Linux</p>
<h3 id="硬件"><a href="#硬件" class="headerlink" title="硬件"></a>硬件</h3><p>8G+内存，500G以上空间</p>
<h2 id="应用软件"><a href="#应用软件" class="headerlink" title="应用软件"></a>应用软件</h2><p>sratoolkit<br>fastqc<br>hisats<br>samtools<br>htseq-count<br>R<br>…<br>如有需要，继续补充…</p>
<h3 id="Linux安装（虚拟机形式）"><a href="#Linux安装（虚拟机形式）" class="headerlink" title="Linux安装（虚拟机形式）"></a>Linux安装（虚拟机形式）</h3><p>此处所用的版本为Ubunt<br>参考以下文献：<br><a href="http://blog.sina.com.cn/s/blog_757fc71d0102v1j4.html" target="_blank" rel="external">http://blog.sina.com.cn/s/blog_757fc71d0102v1j4.html</a><br><a href="http://blog.sina.com.cn/s/blog_757fc71d0101r95q.html" target="_blank" rel="external">http://blog.sina.com.cn/s/blog_757fc71d0101r95q.html</a></p>
<p><a href="http://blog.sina.com.cn/s/blog_757fc71d0101r7kd.html" target="_blank" rel="external">http://blog.sina.com.cn/s/blog_757fc71d0101r7kd.html</a><br><a href="https://zhuanlan.zhihu.com/c_67761129" target="_blank" rel="external">https://zhuanlan.zhihu.com/c_67761129</a></p>
<h3 id="应用软件的安装及介绍"><a href="#应用软件的安装及介绍" class="headerlink" title="应用软件的安装及介绍"></a>应用软件的安装及介绍</h3><h4 id="anaconda"><a href="#anaconda" class="headerlink" title="anaconda"></a>anaconda</h4><p>参考：<a href="https://zhuanlan.zhihu.com/p/25085567" target="_blank" rel="external">https://zhuanlan.zhihu.com/p/25085567</a></p>
<h4 id="sratoolkit"><a href="#sratoolkit" class="headerlink" title="sratoolkit"></a>sratoolkit</h4><p><a href="https://trace.ncbi.nlm.nih.gov/Traces/sra/sra.cgi?view=software" title="sratoolkit" target="_blank" rel="external">sratoolkit</a>：把NCBI SRA（Sequence Read Archive）数据库中的NGS序列数据从 sra 格式转换到 fastq 格式。</p>
<h4 id="fastqc"><a href="#fastqc" class="headerlink" title="fastqc"></a>fastqc</h4><p><a href="http://www.bioinformatics.babraham.ac.uk/projects/fastqc/" title="fastqc" target="_blank" rel="external">fastqc</a>:二代测序数据质量分析软件。</p>
<p>看一篇：<a href="https://zhuanlan.zhihu.com/p/24608131" target="_blank" rel="external">https://zhuanlan.zhihu.com/p/24608131</a></p>
<p><a href="https://zhuanlan.zhihu.com/p/20731723" target="_blank" rel="external">https://zhuanlan.zhihu.com/p/20731723</a></p>
<p><a href="http://www.biotrainee.com/thread-1796-1-1.html" target="_blank" rel="external">http://www.biotrainee.com/thread-1796-1-1.html</a></p>
<h4 id="hisats"><a href="#hisats" class="headerlink" title="hisats"></a>hisats</h4><p><a href="http://ccb.jhu.edu/software/hisat2/index.shtml" title="hisats" target="_blank" rel="external">hisats</a>：将测序结果比对到人类参考基因组上。HISAT2是TopHat2/Bowti2的继任者，使用改进的BWT算法，实现了更快的速度和更少的资源占用。</p>
<h4 id="samtools"><a href="#samtools" class="headerlink" title="samtools"></a>samtools</h4><p><a href="http://www.htslib.org/" title="samtools" target="_blank" rel="external">samtools</a>:处理SAM、BAM文件的工具软件。BAM格式文件是存放高通量测序中比对结果的标准格式文件。</p>
<h4 id="htseq-count"><a href="#htseq-count" class="headerlink" title="htseq-count"></a>htseq-count</h4><p><a href="http://htseq.readthedocs.io/en/release_0.9.1/" title="htseq-count" target="_blank" rel="external">htseq-count</a>：用于reads计数的软件，他能对位于基因组上的一些单位的reads数进行统计，这里所说的单位主要是指染色体上的一组位置区间（我们常见的就是gene exon） </p>
<h4 id="R"><a href="#R" class="headerlink" title="R"></a>R</h4><p><a href="https://www.r-project.org/" title="R" target="_blank" rel="external">R</a>：统计与数据可视化工具。</p>
<p>#### </p>
<p><strong>软件安装</strong></p>
<hr>
<p>conda install -c bioconda samtools=1.5<br>conda install -c bioconda htseq=0.7.2<br>conda install -c bioconda hisat2=2.1.0<br>conda install -c bioconda fastqc=0.11.5<br>conda install -c jfear sratoolkit=2.8.1</p>
<p>bioconda唯一的问题就是网络问题  ,如果有国内镜像源 就非常完美了 ! 所有的软件都是可以去查询：<a href="https://bioconda.github.io/recipes.html#recipes" target="_blank" rel="external">https://bioconda.github.io/recipes.html#recipes</a></p>
<p>进阶作业，每个软件都收集一个中文教程链接，并自己阅读，发在论坛里面。<br>这个是优秀作业，请大家向他学习：<a href="http://www.biotrainee.com/thread-1796-1-1.html" target="_blank" rel="external">http://www.biotrainee.com/thread-1796-1-1.html</a><br>写清楚自己是如何安装软件的，初学者体验，慢慢进步</p>
<h3 id="参考资料："><a href="#参考资料：" class="headerlink" title="参考资料："></a>参考资料：</h3><ol>
<li>沈梦园博客</li>
<li>生信技能树公众号</li>
<li><a href="http://www.biotrainee.com/thread-1796-1-1.html" target="_blank" rel="external">http://www.biotrainee.com/thread-1796-1-1.html</a></li>
<li><a href="https://zhuanlan.zhihu.com/p/25085567" target="_blank" rel="external">https://zhuanlan.zhihu.com/p/25085567</a></li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2017/08/01/生物信息学笔记-RNA-seq入门/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="我的笔记">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/08/01/生物信息学笔记-RNA-seq入门/" itemprop="url">生信笔记-RNA-Seq分析简介</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-08-01T12:00:00+08:00">
                2017-08-01
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/生物信息学/" itemprop="url" rel="index">
                    <span itemprop="name">生物信息学</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>这是对<a href="http://mp.weixin.qq.com/s/KQ7wfCTCT1UIEeMfJBC78Q" target="_blank" rel="external">沈梦圆PPT</a>的整理。是一篇非常好的关于RNA-seq数据分析的文章。</p>
<h3 id="RNA-seq到底测的是什么？"><a href="#RNA-seq到底测的是什么？" class="headerlink" title="RNA-seq到底测的是什么？"></a>RNA-seq到底测的是什么？</h3><p>mRNA在生物个体内RNA的组分中只占很小的一部分，rRNA占绝大多数。一般我们说RNA-seq指的都是mRNA-seq，后面的流程也都是主要针对mRNA-seq数据分析的。在科学家们的努力下，可以把那些非编码RNA提取出来建库，进行测序。<br>一个成功的RNA-seq研究，起决定性因素的是一个好的实验设计。还依赖于建库的类型、测序深度和设置适于的生物重复。并且尽量减少测序本身以外带来的数据误差。</p>
<h4 id="真核生物与原核生物的mRNA结构差异"><a href="#真核生物与原核生物的mRNA结构差异" class="headerlink" title="真核生物与原核生物的mRNA结构差异"></a>真核生物与原核生物的mRNA结构差异</h4><ol>
<li>真核生物mRNA由5’端帽子结构、5’端非翻译区、翻译区、3’端聚腺苷酸尾巴构成。</li>
<li>原核生物mRNA无5’端帽子结构和3’端聚腺苷酸尾巴。<br><img src="http://ortxpw68f.bkt.clouddn.com/rnaseq3.png" alt=""></li>
</ol>
<h3 id="数据分析前工作"><a href="#数据分析前工作" class="headerlink" title="数据分析前工作"></a>数据分析前工作</h3><p>如下所示：<br><img src="http://ortxpw68f.bkt.clouddn.com/rnaseq4.png" alt=""></p>
<h4 id="实验设计"><a href="#实验设计" class="headerlink" title="实验设计"></a>实验设计</h4><p>需要注意的问题：</p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/rnaseq5.png" alt=""></p>
<ol>
<li>单端测序还是双端测序？</li>
<li>测序读长是多少？</li>
<li>是否建链特异性文库？</li>
<li>需要多少数据量？（测序深度）</li>
<li>设置多少个生物学重复比较合适？</li>
<li>如果我们做了生物重复还要做技术重复么？</li>
</ol>
<h3 id="文库构建"><a href="#文库构建" class="headerlink" title="文库构建"></a>文库构建</h3><p>1.一般生物体中的的RNA中，rRNA占绝大多数，含量超过90%，而mRNA的含量在1-2%左右。对于真核生物，一般使用加poly(A)选择性富集mRNA或者而原核生物则是通过去除rRNA；<br>2.是否建stand-preserving库；<br>3.对于Illumina，测序插入片段一般小于500bp。确定合适长度的插入片段是后续测序和分析的关键；<br>4.单端还是双端测序毫无疑问的是，单端测序更便宜一些，如果你研究的某个物种的基因表达水平，并且它的转录组已经被注释很好了，单端测序产生的数据量一般是足够的了。双端测序呢，它的读长更长，更适合于那些没有被注释的转录组物种的研究，便于其转录本的从头拼接。<br><img src="http://ortxpw68f.bkt.clouddn.com/rnaseq6.png" alt=""></p>
<h3 id="测序深度和重复数"><a href="#测序深度和重复数" class="headerlink" title="测序深度和重复数"></a>测序深度和重复数</h3><ol>
<li>测序深度和数据量不能一味加大。测序深度虽然可以提高基因定量和检测的敏感性（低丰度的基因），但是同时也会增加一些噪音和一些无用的转录本。</li>
<li>重复数，很重要。（举例子：比较两个班的语文成绩，抽取一个人代表一个班来比较，显然是不科学的。）增加重复数可以减少实验误差，对提高结果的可靠性，是非常有意义的。<br><img src="http://ortxpw68f.bkt.clouddn.com/rnaseq7.png" alt=""></li>
</ol>
<p>误差分为技术误差和生物学差异。技术误差-可以通过选择最优化的实验测序程序；生物误差-三个生物学重复。<br>然后设定生物学重复对差异基因的检出率（真阳性率，TPR）的提高具有明显效果。上面说增加测序深度可以检测到低丰度基因，但是对任何样品来说的当测序深度增加再增加，它就会到达平台期。由于科研经费有限，无法无限制地增加样本数或数据量。<br>所以在生物学重复数和单个样本测序量上必须找到平衡点。在总数据量不变的情况下，将总数据量分配到更多的生物学重复样本中，差异分析结果的可靠性在不断提升。对于RNA-seq，生物学重复数的价值要大于单个样本测序量。但增加生物学重复的样本数，意味着要增加建库费用。因此，即使总数据不变，设置过多的生物学重复也是不合理的。<br>我们最终确定设置多少生物学重复还是需要看样本个体之间的差异大不大，这点我们一般都很清楚，在测序之前，如果你所研究的现象在两个实验样本之间差异很稳定的话，就可以少设置一些重复，差异不稳定的话有时候设置10个/20个都不够。具体问题具体分析.</p>
<p><strong>测序深度（Sequencing depth），也叫乘数</strong>，指每个碱基被测序的平均次数，是用来衡量测序量的首要参数。研究表明，增加测序深度，测序量从1.6M条reads增加到20M条reads,（75bp）但到10M条reads时就已经达到平衡了，80%的基因转录本被检测到。在此基础上增加测序量，它们会比对到已经存在的转录本上。因此即使提高测序深度，低表达水平的基因的检测是比较困难的。并且提高测序深度确实能够增加基因差异表达的敏感度，但是并不能保证检测到的差异具有生物学意义。</p>
<p>直观一些说，如果某个基因在RNA-seq结果显示差异表达，但QPCR结果表明这个基因表达差异不显著，可以认为这个基因RNA-seq结果为假阳性；反之，这个结果就是真阳性。</p>
<p><strong>生物学重复对差异表达分析的影响</strong></p>
<p>在单样本测序量保持不变的情况下，随着生物学重复(n)的提高，差异分析的假阳性率（FP R）基本稳定，但真阳性率（TPR）在不断提高。也就是说提高生物学重复数，实验对差异基因的检测更加敏感，那些差异倍数较小或差异量较低的差异表达基因（此类基因的差异检测难度较大）能够更加容易被检测到。</p>
<p><strong>判定差异分析结果可靠性的指标</strong></p>
<p>假阳性与真阳性<br>假阳性率（FPR）：真实非差异表达的基因中，被错误判定为差异表达的比例，FPR越低越好。<br>真阳性率（TRP）：真实差异表达的基因中，能够正确判定为差异表达的比例，TRP越高越好。</p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/rnaseq1.png" alt=""></p>
<p>提高生物学重复数，实验对差异基因的检验更加敏感。那些差异倍数较小或差异量较低的差异表达基因（此类基因的差异检测难度较大）能够更加容易被检测到。</p>
<p>在一定的生物学重复数（n）的情况下，随着单样本测序量（Depth）的提高（25% → 100%），真阳性率（TPR）都只有有限的提高（图1）。例如在n=3的情况下，单个样本的测序量从25%提高到100%，TPR仅仅从6.24%提高到8.95%。在表3中，如果Depth等于25%不变，当n从2提高到12，TPR的提高则是非常明显的。因此测序深度对结果改善效果不如增加生物学重复。<br><img src="http://ortxpw68f.bkt.clouddn.com/rnaseq8.png" alt=""></p>
<p>总数据量不变，生物学重复数与单样品测序量最佳组合<br>如果保持总测序量不变（即如果生物量重复数为n,则单个样品的测序量降低为1/n,总数据量为n*1/n=1,保持不变）。如图A,灰色实线代表不同的生物学重复数（n）和单样本数据量（1/n）组合的情况下，真阳性率（TPR）的变化。结果表明，随着n的提高，TPR率不断提高。例如n=2,TPR约为3%，如果n=6,TPR则提高到24.3%。<br><img src="http://ortxpw68f.bkt.clouddn.com/rnaseq9.png" alt=""></p>
<p>同时我们也可以对“单样本测序量对差异表达分析的影响”再进行深入观察。如果n保持不变，但单个样本的数据量不断降低，TPR的降低十分缓慢。例如，n=3,单个样本的数据量从100%降低到15%，TPR的值一直处于平台期，仅仅从9%降低到5%。 但是不同的生物学重复数和单样本测序量的组合，对假阳性率（ FPR）的影响却较小。如图B，灰色实线代表不同生物学重复数（n）和单样本数据量（1/n）组合的情况下，真阳性率（FPR）的变化。虽然 n 从2 变化到 96，FPR 基本没有太大变化。</p>
<p>从图中我们很容易发现，基于负二项分布的差异分析检验（P value），FPR 对生物学重复数和单个样本数据量均不敏感，始终保持低于 0.1%水平。或者说，这个算法对 FPR 的控制还是非常理想的。</p>
<h3 id="讨论"><a href="#讨论" class="headerlink" title="讨论"></a>讨论</h3><p>随着测序单价的下降，目前市场上 RNA-seq 类项目的单样本测序量正在不断提高。以 2G，PE100 测序的表达谱项目为例，其对应的测序量为 20M 条 reads。如果一条长度为 1kbp 的低表达基因的表达量为 RPKM=0.5，其理论上可以检测到的 reads 数为 20×0.5=10。所以低丰度基因的检测，对 RNA-seq 这个技术来说并非最大问题。</p>
<p>第二个问题“转录本表达量的高低变化”比“转录本的有无”更具有普遍的生物学意义。虽然个别基因的表达量变化程度，可以使用 Qpcr 来验证。但我们往往也使用所有差异基因来统计某些规律。例如使用差异基因的 pathway 富集分析来寻找与性状相关的 pathway。如果在全局水平的差异基因集并不可靠，那么 pathway富集分析得出的结论的可靠性自然也受到影响。而全局水平的差异基因数量巨大，是难以使用 Qpcr 验证的。因此，定量以及差异分析的准确性是在 RNA-seq 中更值得关心的问题。</p>
<h4 id="测序设计"><a href="#测序设计" class="headerlink" title="测序设计"></a>测序设计</h4><p>RNA-seq文库的制备和测序过程：RNA碎裂，cDNA合成，接头连接，PCR扩增，加标签（多样品混合测序），上泳池测序;<br><img src="http://ortxpw68f.bkt.clouddn.com/rnaseq10.png" alt=""></p>
<h5 id="如何减少误差："><a href="#如何减少误差：" class="headerlink" title="如何减少误差："></a>如何减少误差：</h5><ol>
<li>使用末端带随机核酸的接头或者使用化学碎裂法代替Rnase III碎裂法；</li>
<li>不同批次实验或者不同runs。<br>a. 如果样品太多在一个批次或者一个run跑不完，为了避免技术误差造成太大的实验误差，要把样品随机分配到每个批次或runs中;(到底怎么设计，我们要讨论一下！！)<br>b. 如果你的样品是多样品混合测序，每个样品要单独加上标签，每个lanes要保证足够的测序深度，为了保证所有的样品在每个lane中都有。如果送给公司去做的话，我们要选择建库水平好些的，并且要求他们这么去做，应该会更好。</li>
</ol>
<h4 id="质量控制"><a href="#质量控制" class="headerlink" title="质量控制"></a>质量控制</h4><h5 id="重复数："><a href="#重复数：" class="headerlink" title="重复数："></a>重复数：</h5><ol>
<li>技术重复（spearman秩相关系数R²&gt;0.9）;</li>
<li>生物重复（主成分分析PCA）</li>
</ol>
<h5 id="原始数据的质量控制："><a href="#原始数据的质量控制：" class="headerlink" title="原始数据的质量控制："></a>原始数据的质量控制：</h5><p>原始数据回来后，你做完备份以后，做的第一件事情就是看看数据质量如何，一般来自llumina测序平台用软件FastQC看；其他平台的数据用软件NGSQC。一般会有原始数据的序列质量，GC含量，存在的接头以及K-mers子串图并且重复序列太多的reads。并且reads 3‘末端的质量低于前段，原因是随着测序读长的增加，酶活性下降，荧光强度也在下降，因此测序数据质量逐渐降低乃是自然趋势。常用的数据过滤的软件有FASTX-Toolkit and Trimmomatic，其他还有许多，你也可以自己写代码处理数据。<br><img src="http://ortxpw68f.bkt.clouddn.com/rnaseq11.png" alt=""></p>
<h5 id="Reads比对后的质量控制-评估比对质量的指标-："><a href="#Reads比对后的质量控制-评估比对质量的指标-：" class="headerlink" title="Reads比对后的质量控制(评估比对质量的指标)："></a>Reads比对后的质量控制(评估比对质量的指标)：</h5><p>比对上的reads占总reads的百分比； Reads比对到外显子和参考链上的覆盖度是否一致；比对到基因组序列：多重比对reads？比对到转录组序列：来自未被注释的转录本的reads会丢失； 产生更多的多重比对reads; 转录本被定量以后，应该看一下GC含量和基因长度偏差，确定定量的方法是否适用。<br><img src="http://ortxpw68f.bkt.clouddn.com/rnaseq12.png" alt=""></p>
<h5 id="数据分析"><a href="#数据分析" class="headerlink" title="数据分析"></a>数据分析</h5><p><img src="http://ortxpw68f.bkt.clouddn.com/rnaseq13.png" alt=""></p>
<h5 id="转录本分析"><a href="#转录本分析" class="headerlink" title="转录本分析"></a>转录本分析</h5><p>需要注意的问题：</p>
<ol>
<li>比对到基因组序列、比对到转录组序列？</li>
<li>一条reads比对到多个地方？</li>
<li>用什么来表示表达量的高低？</li>
</ol>
<p><img src="http://ortxpw68f.bkt.clouddn.com/rnaseq14.png" alt=""></p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/rnaseq15.png" alt=""></p>
<p>把所有样本的reads混合用于转录本的拼接。二代测序的转录组reads用于拼接还是存在一些问题的，最终拼接结果不太理想。一个转录本的拼接结果会是10~100contigs。三代测序的读长直接可以把一个转录本读完了，完全不需要拼接。<br><img src="http://ortxpw68f.bkt.clouddn.com/rnaseq16.png" alt=""></p>
<h5 id="表达定量"><a href="#表达定量" class="headerlink" title="表达定量"></a>表达定量</h5><p><img src="http://ortxpw68f.bkt.clouddn.com/rnaseq17.png" alt=""></p>
<p>RPKM/FPKM/TPM用来表示RNA-seq基因表达水平的值；对于单端测序RPKM和FPKM值是一样的，FPKM可以转换成TPM。Cufflinks(支持双端测序数据，并且需要GTF格式的注释文件)。</p>
<h5 id="表达差异分析"><a href="#表达差异分析" class="headerlink" title="表达差异分析"></a>表达差异分析</h5><p><img src="http://ortxpw68f.bkt.clouddn.com/rnaseq18.png" alt=""></p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/rnaseq19.png" alt=""></p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/rnaseq20.png" alt=""></p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/rnaseq21.png" alt=""></p>
<h4 id="功能分析"><a href="#功能分析" class="headerlink" title="功能分析"></a>功能分析</h4><p>功能分析是标准转录组分析流程的最后一步，分析差异表达基因的分子功能和代谢通路。<br><img src="http://ortxpw68f.bkt.clouddn.com/rnaseq22.png" alt=""></p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/rnaseq23.png" alt=""></p>
<p>参考资料：</p>
<ol>
<li><a href="http://www.biotrainee.com/thread-166-1-1.html" target="_blank" rel="external">http://www.biotrainee.com/thread-166-1-1.html</a></li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2017/07/06/病毒包装笔记(6)-病毒包装问题收集/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="我的笔记">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/07/06/病毒包装笔记(6)-病毒包装问题收集/" itemprop="url">病毒包装笔记(6)-病毒包装问题收集</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-07-06T12:02:00+08:00">
                2017-07-06
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/生物实验笔记/" itemprop="url" rel="index">
                    <span itemprop="name">生物实验笔记</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <ol>
<li><p>慢病毒如何保存？<br>答 ：慢病毒可在-80°C条件下保存6个月，滴度不会出现明显下降，但如果保存时间超过6~12月，滴度可能降至原来十分一，使用前请重新测病毒滴度。慢病毒应避免反复冻融，冻融一次病毒滴度会下降20~50%以上，甚至更多。建议不要在-20°C下长期保存慢病毒；如果冻融后需于短期内（一周以内）使用，建议置于4°C保存；若在4°C保存超过一周，病毒滴度会下降5倍以上。</p>
</li>
<li><p>从负80度中取出的病毒如何解冻？<br>答 ：冰上溶解-80 °C取出的慢病毒。如需稀释病毒，可加入适当比例的PBS（PH7.4）或培养基（ph7.2），混匀分装后  4 °C保存，并最好当天用完。操作时用枪头吸取慢病毒时，应尽量避免慢病毒暴露于空气中，避免起泡。 </p>
</li>
<li><p>病毒的单位是什么？<br>答：病毒的单位是TU/ml，即每毫升中含有具有生物活性的病毒颗粒数。如： 病毒滴度为&gt;1×10e8  TU/ml，即每毫升病毒液中至少含有1×10e8个具有生物活性的慢病毒颗粒。</p>
</li>
<li><p>慢病毒感染时培养基体积与正常培养体积是多少？<br>答：如下所示：<br><img src="http://ortxpw68f.bkt.clouddn.com/virus%20volume.png" alt=""></p>
</li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2017/07/05/病毒包装笔记(5)-293FT的病毒包装/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="我的笔记">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/07/05/病毒包装笔记(5)-293FT的病毒包装/" itemprop="url">病毒包装笔记(5)-293FT的病毒包装</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-07-05T11:00:00+08:00">
                2017-07-05
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/生物实验笔记/" itemprop="url" rel="index">
                    <span itemprop="name">生物实验笔记</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="实验原理"><a href="#实验原理" class="headerlink" title="实验原理"></a>实验原理</h2><h3 id="293细胞简介"><a href="#293细胞简介" class="headerlink" title="293细胞简介"></a>293细胞简介</h3><p>293FT细胞系非常适应用于慢病毒的生产。该细胞系是由293F细胞系培育而来的，293FT能稳定地表达SV40大T抗原（来源于 pCMVSPORT6TAg.neo plasmid）。此细胞表达SV40大T抗原是由CMV启动子控制。</p>
<h3 id="293FT细胞的培养基："><a href="#293FT细胞的培养基：" class="headerlink" title="293FT细胞的培养基："></a>293FT细胞的培养基：</h3><ol>
<li>DMEM（高糖）；</li>
<li>10%FBS（不能热灭活）；</li>
<li>0.1 mM MEM Non-Essential Amino Acids (NEAA)；</li>
<li>6 mM L-glutamine；</li>
<li>1 mM MEM Sodium Pyruvate；</li>
<li>1% Pen-Strep (optional)</li>
</ol>
<h3 id="293FT细胞的冻存"><a href="#293FT细胞的冻存" class="headerlink" title="293FT细胞的冻存"></a>293FT细胞的冻存</h3><p>90% 完全培养基+10% DMSO（实验室通常是用90%FBS+10% DMSO）</p>
<h2 id="实验材料"><a href="#实验材料" class="headerlink" title="实验材料"></a>实验材料</h2><p>293FT细胞，PSPAx2；PMD2G；目的质粒</p>
<h2 id="实验流程"><a href="#实验流程" class="headerlink" title="实验流程"></a>实验流程</h2><ol>
<li>第1天：用无抗生素DMEM+10% FBS血清铺板293FT细胞（6孔板），细胞接种数量约为5X10e5，确保第2天细胞密度达到80-90%的融合。</li>
<li>第2天：溶液【1】240ul OPTI-MEM+10ul lipofectamine 2000 per well  （总体积 250ul）（室温下静置5min）；溶液【2】OPTI-MEM+4ug质粒per well（总体积250ul）； </li>
<li>将溶液【1】加入到溶液【2】（顺序不能加错），轻轻吹吸 3 - 5 次混匀，室温下静置 20 min； </li>
<li>与此同时，将6孔板中的培养基更换为<strong>无抗生素无血清</strong>的培养基，约1mL；</li>
<li>将溶液【1】和溶液【2】的混合液逐滴加入到孔中，轻轻援培养板，混匀，后将细胞放入 37℃，5%的CO2中保温5-6 小时； </li>
<li>6小时后，更换含有血清的全培养基，继续放在 37℃，5％的CO2中培养48~72h；</li>
<li>转染24h后，荧光显微镜下观察，转染效率应达到70%以上；</li>
<li>经过48小时后，收集含病毒的培养液（每个孔里包一种病毒）至1.5mL EP管中，8000rpm室温离心3分钟，然后取上清(1mL)（离心是为了清除293FT细胞，如果不离心，容易在宿主细胞中混入293FT）。</li>
<li>将6孔板中的宿主细胞的培养基吸掉1mL（原来是2mL，除去一半），将含有病毒颗粒的1mL上清加入到宿主细胞中（6孔板，宿主细胞放到6孔板中，每孔5E5细胞，细胞密度不能太高，一般20-30%）中进行感染，并同时加入10uL的polybrene（终浓度为2-5µg/ml polybrene）， 充分摇匀后置于37℃温箱孵育;</li>
<li>如果目的质粒带有抗性如Ppuro，则用含嘌呤霉素抗性的培养基进行筛选，如果目的质粒带有荧光，则用FACS筛选。</li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2017/07/04/病毒包装笔记(4)-质粒的提取与测序/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="我的笔记">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/07/04/病毒包装笔记(4)-质粒的提取与测序/" itemprop="url">病毒包装笔记(4)-质粒的提取与测序</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-07-04T12:00:00+08:00">
                2017-07-04
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/生物实验笔记/" itemprop="url" rel="index">
                    <span itemprop="name">生物实验笔记</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="实验原理"><a href="#实验原理" class="headerlink" title="实验原理"></a>实验原理</h2><p>细菌质粒是一类双链、闭环的DNA，大小范围从1kb至200kb以上不等。各种质粒都是存在于细胞质中、独立于细胞染色体之外的自主复制的遗传成份，通常情况下可持续稳定地处于染色体外的游离状态，但在一定条件下也会可逆地整合到寄主染色体上，随着染色体的复制而复制， 并通过细胞分裂传递到后代。质粒已成为目前最常用的基因克隆的载体分子，重要的条件是可获得大量纯化的质粒DNA分子。目前已有许多方法可用于质粒DNA的提取，下面主要介绍碱裂解法提取质粒DNA的方法。</p>
<p>在 pH 12.0～12.6 碱性环境中，细菌的线性大分子量染色体 DNA 变性分开，而共价闭环的质粒 DNA 虽然变性但仍处于拓扑缠绕状态。将 pH 调至中性并有高盐存在及低温的条件下，大部分染色体 DNA 、大分子量的 RNA 和蛋白质在去污剂 SDS 的作用下形成沉淀，而质粒 DNA 仍然为可溶状态。通过离心，可除去大部分细胞碎片、染色体 DNA 、 RNA 及蛋白质，质粒 DNA 尚在上清中，然后用硅酸纤维膜吸附或者酚、氯仿抽提进一步纯化质粒 DNA 。</p>
<h2 id="实验材料："><a href="#实验材料：" class="headerlink" title="实验材料："></a>实验材料：</h2><p>试剂盒E.Z.N.A.® Plasmid DNA Mini Kit I（OMEGA　Bio-tek）<br>Epoch微孔板分光光度计（BioTek）<br>1.5mL管<br>5mL 离心管</p>
<h2 id="实验流程："><a href="#实验流程：" class="headerlink" title="实验流程："></a>实验流程：</h2><ol>
<li>自新鲜划痕选择培养板中分离单菌落，接种含适当选择性抗生素的5ml的LB培养基进行培养。37℃强力摇动（~300rpm）孵育16h。括DH5α。</li>
<li>将5.0ml细菌室温10,000 g离心1min，放到5 mL的EP管中，如果菌液多，则分两次加入。</li>
<li>轻轻倒出或吸走培养基并丢弃。</li>
<li>加入250μL 的溶液I/Rnase A重悬沉淀，涡旋或用移液器反复吹打。充分重悬沉淀对于获得高质量的DNA非常重要。（<strong>注：溶液Ⅰ的成分及作用为：①50mM 葡萄糖—增稠，使悬浮后的大肠杆菌不会快速沉积到管子的底部；②10mM EDTA—抑制DNase的活性。这一步溶液中还可以加入RNase，③25mM Tris-HCl，pH=8.0—提取适当的缓冲液体系和PH；④RNase—除去RNA，此成分不受EDTA影响，并且可以在后续步骤中被除去</strong>）</li>
<li>加入250μL溶液II（在孵箱中预热），倒置、转动试管数次使之轻轻混匀，得到透明的裂解产物。可能需要孵育2min。不要用力混合，以免使染色体DNA断裂，减低质粒的纯度。该步反应不要超过5min。溶液II不用时要拧紧瓶盖，以免试剂被空气中的CO2酸化。（<strong>溶液II的成分及作用为为①0.2M NaOH—裂解细菌，使双层膜变化为micelle微囊；②1%SDS—-结合蛋白质（平均2个氨基酸结合上一个SDS），和钾离子形成十二烷基硫酸钾PDS,进而形成大量的沉淀。</strong>）</li>
<li>加入350μL溶液III，立即倒置试管数次混匀，直至白色絮状沉淀物形成。为避免形成局部沉淀，加入溶液III后应立即、充分混匀溶液。（<strong>溶液III的成分及作用为：①3M醋酸钾—钾离子和SDS形成PDS，大量的沉淀；②2M醋酸—中和NaOH，防止基因组DNA断裂。</strong>）</li>
<li>室温≥13,000g离心10分钟。白色沉淀物形成，立即进行下一步操作。</li>
<li>将HiBindDNAMini Column 加入到2mL的收集管上。</li>
<li>小心翼翼的吸取上清液（注意不要吸到沉淀，如果不放心，可以将上清吸到另一新的EP管，然后再离心一次，吸取上清），加入装配在2ml收集管中的小量纯化柱I中。确保离心沉淀未受扰动，确保没有细胞碎片加入到柱子中。</li>
<li>室温下10,000g离心1分钟，使裂解液完全通过柱子。再将裂解液加回柱子，再离心一次。</li>
<li>丢弃滤过液，重新使用2ml收集管。</li>
<li>加入500μL HBC缓冲液清洗柱子。(<strong> HBC的成分没有查到，但根据相关的信息，HBC的成分应该是酚，氯仿，异戊醇的混合用；它们的作用分为：①酚—使残余的蛋白质变性（远强于氯仿）；②氯仿—和酚混合使用，增加比重。酞与氯仿是非极性分子，水是极性分子，当蛋白水溶液与酚或氯仿混合时，蛋白质分子之间的水分子就被酚或氯仿挤去，使蛋白失去水合状态而变性过离心，变性蛋白质的密度比水的密度为大，因而与水分离，沉淀在水相下面，从而与溶解在水相中的DNA分开；③异戊醇—可以使用酚：氯仿：异戊醇=25:24:1的比例抽提质粒DNA，在抽提DNA时，为了混合均匀，必须剧烈振荡容器数次，这时在混合液内易产生气泡，气泡会阻止相互间的充分作用。加入异戊醇能降低分子表面张力，所以能减少抽提过程中的泡沫产生。</strong>)</li>
<li>室温13,000 g离心1分钟，使溶液完成通过柱子。该步操作需确保残余的蛋白质污染被去除，以保证获得高品质的DNA以适合于下游的应用。</li>
<li>丢弃滤过液，重新使用2ml收集管。</li>
<li>加入700μL DNA Wash Buffer。DNA清洗液的浓缩液使用前必须用无水乙醇稀释（5倍稀释），如果DNA清洗液稀释液经过冷藏，则使用之前必须置于室温。(<strong>wash buffer的作用：加入无水乙醇后,终浓度差不多就是70%的乙醇溶液了,在沉淀的DNA中,由于过多的盐杂质存在,影响DNA的酶切等反应,wash buffer就是洗去这些盐杂质的。</strong>)</li>
<li>室温10,000g离心1分钟。</li>
<li>丢弃滤过液。</li>
<li>将空柱子≥13,000 x g离心2min，使柱子的基质干燥。此步骤为关键操作，不可遗漏。</li>
<li>将柱子放入干净的1.5ml微量离心管中，60℃孵育5min。</li>
<li>将80μL无菌去离子水直接加入柱子基质上。</li>
<li>60℃孵育5min。</li>
<li>≥13,000 x g离心1min洗脱DNA。可以进行二次洗脱，以收集残存的DNA。</li>
<li>检测质粒浓度，A260/A280的比率可以反映核酸的纯度。比值大于1.8表明核算的纯度在90%以上。将质粒稀释到400ng/uL。</li>
</ol>
<h2 id="测序"><a href="#测序" class="headerlink" title="测序"></a>测序</h2><p>取10uL的质粒样品，送到测序公司即可。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          
            <p class="site-author-name" itemprop="name">RVDSD</p>
            <p class="site-description motion-element" itemprop="description">test</p>
        </div>

        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
            
              <a href="/archives/">
            
                <span class="site-state-item-count">21</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              
                <span class="site-state-item-count">4</span>
                <span class="site-state-item-name">分类</span>
              
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              
                <span class="site-state-item-count">19</span>
                <span class="site-state-item-name">标签</span>
              
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">RVDSD</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动</div>

  <span class="post-meta-divider">|</span>

  <div class="theme-info">主题 &mdash; <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.2</div>


        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.2"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.2"></script>



  
  

  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.2"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.2"></script>


  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.2"></script>



  


  




	





  





  








  





  

  

  

  

  

  

</body>
</html>
