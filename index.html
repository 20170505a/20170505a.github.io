<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.3" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.3">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.3" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta property="og:type" content="website">
<meta property="og:title" content="RVDSD的个人笔记本">
<meta property="og:url" content="http://rvdsd.top/index.html">
<meta property="og:site_name" content="RVDSD的个人笔记本">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="RVDSD的个人笔记本">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.3',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://rvdsd.top/"/>





  <title>RVDSD的个人笔记本</title><!-- hexo-inject:begin --><!-- hexo-inject:end -->
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">RVDSD的个人笔记本</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">学习过程中的输出</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2017/10/13/MiRNA/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/10/13/MiRNA/" itemprop="url">microRNA笔记</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-10-13T12:00:00+08:00">
                2017-10-13
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/生物笔记/" itemprop="url" rel="index">
                    <span itemprop="name">生物笔记</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  1,639
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  6
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="背景资料">背景资料</h2>
<p>MicroRNA (miRNA) 是一类由内源基因编码的长度约为22 nt的非编码单链RNA 分子,它们在动植物中参与转录后基因表达调控。大意就是，Micro RNA就是一条不会翻译蛋白的小的RNA。其单位是22nt，而不是22bp，因为nt是核苷酸，bp是碱基对，Micro RNA是用nt作为单位的，起码说明了Micro RNA是单链的。</p>
<h2 id="命名">命名</h2>
<h3 id="mirna的转录">miRNA的转录</h3>
<p>MiRNA首先是由MiRNA的host gene转录获得的，host gene转录，形成了primary microRNA（<strong>pri-MiRNA</strong>），然后通过Drosha–Pasha 复合体，形成了precursor microRNA（也就是<strong>pre-MiRNA</strong>），接着pre-MiRNA被Dicer剪切成双链的RNA，然后双链RNA被AGO1保护起来，其中一条链被降解，另一条链就被保留下来了。 <img src="http://ortxpw68f.bkt.clouddn.com/rnatrans.png"> 被降解的链一般被称之为“Passenger strand（过客链）”，这条链一般不容易被检测到，因为被降解了，这条链也被称之为星号链，一般会表示为“miR-×××*”。另一条链被称之为“Guide strand”，也就是先导链，这条就是我们通常所说的miRNA。</p>
<p>注：从图上就可以看出，Passenger strand和Guide strand链都是来源于一个基因，但它们两个还能互补。</p>
<h3 id="pri-mirna">pri-miRNA</h3>
<p><strong>pri-miRNA：</strong>长度从几百到几千个碱基不等，带有5‘帽子和3’polyA尾巴，以及1到数个发夹径环结构，如下所示<img src="http://ortxpw68f.bkt.clouddn.com/rna2.png">：</p>
<p>用上述的命名方法的话，比如我们说MiRNA-21和MiRNA-21*，就大概是这样的，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/m21.png">
</div>
<p>这个图上，我们可以看到MiRNA-21是产生在precursor microRNA的5’臂上的，而MiRNA-21*是产生于precursor microRNA的3’臂上的。“*”这个标志，主要告诉我们，这条链是“Passenger strand”，也就是miRNA-21产生的一个副产品，表达量超低，所以星号链经常被认为是没有功能的。</p>
<h3 id="mirna的5p端与3p端">miRNA的5p端与3p端</h3>
<p>但是，问题来了，2011年开始，有很多文献，开始表明miRNA星号链是有功能的（Widespread regulatory activity of vertebrate microRNA* species.，Yang，2011），星号链的功能，也有可能比先导链更为高级。那这样用“*”来标记就有点过时了。于是就产生了这样的命名方法，就是按照microRNA产生于precursor microRNA的5’臂或者是3’臂，来将miRNA表示成“MiR-×××-5p”或者“MiR-×××-3p”，这样的话miR-21，就被命名成为了“miR-21-5p”，它的星号链就被命名成为了“miR-21-3p”。之前还有用“-s”（sence）“-as”（antisence）来对先导链（先导链是-s）和星号链（星号链是-as）来命名，主要是dsRNA形成过程时的正向和反向。但由于很容易搞混，所以已经被取消了。可能看到老一点的文献中会有。</p>
<h3 id="mirna的编号">miRNA的编号</h3>
<p>pre-miRNA以“mir”命名，其编号以“MI”编号，如人的miRNA 122的前体ID为hsa-mir-122，Accession为MI0000442；而miRNA的成熟链以“miR”命名，其编号以“MIMAT”编号，如人的miR-122的一个成熟体的ID为hsa-miR-122-5p ，Accession为 MIMAT0000421。</p>
<p>因此，miRNA的命令示意图如下所示： <img src="http://mmbiz.qpic.cn/mmbiz/09BV4Hibpk83eDr6NmIKbMOr1rzMIBEIfclrxreZEUqo7p97Et92gu6KExNliaRCpDyHoCwrgt6vicGVlvuEMJeAg/0?tp=webp&amp;wxfrom=5&amp;wx_lazy=1"></p>
<h3 id="mirna命名方式的汇总">miRNA命名方式的汇总</h3>
<ol style="list-style-type: decimal">
<li>一个系统命名包含三部分内容，即物种，microRNA类别，序号。三者间用短线连接。</li>
<li>物种一般用三个小写字母表示，如hsa,mmu和rno分别代表人，小鼠和大鼠。</li>
<li>MicroRNA类别是指所命名的microRNA是pre-miRNA还是mature miRNA。pre-miRNA用mir表示，mature miRNA用miR表示。</li>
<li>序号为一阿拉伯数字，代表microRNA发现的先后。一般而言，数字越小，发现越早</li>
<li>高度同源的miRNA在No.其后加英文字母(小写,一般从a开始) 如miR-199a 和miR-199b</li>
<li>由不同染色体上的DNA序列转录加工而成的具有相同成熟体序列的miRNA，则在后面加上阿拉伯数字以区分, 如miR-199a-1和miR-199a-2；</li>
<li>如果一个前体的2个臂分别加产生miRNA，则根据克隆实验，在表达水平较低的miRNA 后面加“<em>” ，如miR-199amiR-199a</em>，或进行如下命名，miR-142-5p(也可命名为miR-142-s，表示从5’ 端的臂加工而来)和miR-142-3p(也可命名为miR-142-as，表示从3’端的臂加工而来)；</li>
<li>确定命名规则之前发现的miRNA，如let-7，则保留原来名字。</li>
</ol>
<h2 id="作用机理">作用机理</h2>
<p>作用机理的图片如下所示： <img src="http://mmbiz.qpic.cn/mmbiz/09BV4Hibpk83eDr6NmIKbMOr1rzMIBEIfPMMdeNg9D0kID2flmIMTne2be77JZmohWKz32DbF791fW5ys1f0jibA/0?tp=webp&amp;wxfrom=5&amp;wx_lazy=1"></p>
<blockquote>
<p>要说MiRNA具体是咋起作用的？好吧，给你举个例子，你感受一下。普通的mRNA就好比是一条高速公路，路上会有很多会排出尾气的汽车（核糖体，它们在mRNA上边走边翻译蛋白），一条高速路上会有很多辆车（多聚核糖体Polysome），车越多、开得越快，尾气就越大（蛋白表达量就越高），这个时候，在路快到尽头的地方（mRNA的3’UTR上）就出现了一个交警（MiRNA聚合一些蛋白的RISC，RNA-Induced SilencingComplex，RNA诱导沉默复合体），他稳稳地站在路的最后（通过RISC中的MiRNA与3’UTR互补，结合到mRNA的3’UTR上），整个车队就停下来了，尾气也没了（蛋白表达降低）。好了，现在也明白为啥过表达MiRNA之后下游基因的mRNA变化不大，但蛋白会有变化了吧？因为警察是不会拆路的……</p>
</blockquote>
<p>比较详细的图</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/rna6.jpg">
</div>
<h3 id="mirna种子区seedregion">miRNA种子区（“seed”region）</h3>
<p>5’端2-8个碱基被称为种子序列 <img src="http://ortxpw68f.bkt.clouddn.com/rna3.jpg"></p>
<h3 id="mirna与mirna靶标的结合">miRNA与miRNA靶标的结合</h3>
<p>主要有两类：5’-dominant Site和3’-compensatory Site。 1. <strong>5‘显性位点：满足经典种子区2-8完全互补结合的方式</strong>。如下所示<img src="http://ortxpw68f.bkt.clouddn.com/rna4.jpg">： 2. <strong>3’端补偿位点：5‘端并非满足2-8经典完全互补，知识部分互补，这样3‘端补偿位点结合，增强了miRNA与标靶结合稳定性，如下所示：5’-dominant Site和3’-compensatory Site，如下所示</strong><img src="http://ortxpw68f.bkt.clouddn.com/rna5.jpg"></p>
<h2 id="rna的靶点预测">RNA的靶点预测</h2>
<h3 id="工具汇总如下">工具汇总如下</h3>
<p>miEAA 网址：https://ccb-compute2.cs.uni-saarland.de/mieaa_tool/ 分析microRNA的功能、信号通路、疾病等进行分析</p>
<p>YM500v2： http://ngs.ym.edu.tw/ym500v2/index.php</p>
<p>Starbase（http://starbase.sysu.edu.cn/index.php） 交叉预测网站，既可以通过靶基因预测microRNA也可以通过microRNA预测靶基因。</p>
<p>miRPathDB（https://mpd.bioinf.uni-sb.de/overview.html） 查询参与通路内调控的miRNAs，包含了人、鼠两类数据。</p>
<p>mirbase（mirbase：http://www.mirbase.org/）</p>
<h2 id="参考资料">参考资料：</h2>
<ol style="list-style-type: decimal">
<li><a href="https://mp.weixin.qq.com/s?__biz=MzA3ODU1NjUyNw==&amp;mid=404311107&amp;idx=1&amp;sn=85308a8ad9806f65072de4c8ed79f54c&amp;scene=1&amp;srcid=0314tK0Lw7HkKyoJRoAjwPmg#rd" target="_blank" rel="external">miRNA到底是怎么命名的？</a></li>
<li><a href="https://mp.weixin.qq.com/s?__biz=MzA3ODU1NjUyNw==&amp;mid=200526001&amp;idx=1&amp;sn=ae82f47928f8cd4c519c89f69ab8d103&amp;scene=21#wechat_redirect" target="_blank" rel="external">Micro RNA，从一窍不通到略知一二</a></li>
<li><a href="http://mp.weixin.qq.com/s?__biz=MzA5ODQ1NDIyMQ==&amp;mid=2649602388&amp;idx=2&amp;sn=6097b6c76944a795a628bce7fbbac934&amp;chksm=888846f6bfffcfe0a579d0a9bd1dd24083a28937c4057db9e25abd3c006858b8d2675690f5ae&amp;mpshare=1&amp;scene=1&amp;srcid=0901fXzOX8InCPG3nb2oSiDS#rd" target="_blank" rel="external">搞懂RNA命名，miRNA、lncRNA、circRN不再傻傻分不清</a></li>
<li><a href="https://mp.weixin.qq.com/profile?src=3&amp;timestamp=1507870340&amp;ver=1&amp;signature=y-Qin6PEYzPl9NMOQjgJYLIB1ca8JQ1JnnITRYLuVFI*N2jLLUI74CFzvPaSyi-PVLDYcUEOeEIiXXC4QtOf4w==" target="_blank" rel="external">艾博思生物（公众号： ibsbio）</a></li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2017/10/02/转录组学习笔记02-读文章获取测序数据/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/10/02/转录组学习笔记02-读文章获取测序数据/" itemprop="url">转录组学习笔记02-读文献下载测序数据</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-10-02T12:00:00+08:00">
                2017-10-02
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/生物信息学/" itemprop="url" rel="index">
                    <span itemprop="name">生物信息学</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  2,002
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  8
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="任务目标">任务目标：</h2>
<blockquote>
<p>本系列课程学习的文章是：AKAP95 regulates splicing through scaffolding RNAs and RNA processing factors. Nat Commun 2016 Nov 8;7:13347. PMID: 27824034 很容易在文章里面找到数据地址GSE81916 这样就可以下载sra。</p>
</blockquote>
<h2 id="文章主要内容">文章主要内容</h2>
<h3 id="测序物种">测序物种</h3>
<p>人类，小鼠； ###实验类型 高通量测序 ###摘要 pre-mRNA的可变剪切与高等生物基因表达的复杂性有关，但是可变剪切位点的选择却未研究清楚。作者在以前的研究中发现了一个染色质相关的蛋白AKAP95（AKAP8）在强化染色质转录方向有着明显的影响。在本文的研究中，APAKP95能与许多涉及转录和RNA加工的因子相互作用，调节pre-mRNA的剪接。AKAP95直接促进内源基因FAM126A的特异性外显子的体外剪接和包含。 AKAP95N-末端富含YG的结构域在与RNA加工因子（例如hnRNP蛋白）结合的过程中有着重要的作用，它的锌指结构域对于pre-mRNA的结合至关重要。基因组结合的分析显示，AKAP95优先结合人类转录组中大量pre-mRNA的近端内含子区域，AKAP95的敲除能导致多外显子增加的减少。AKAP95还可以选择性地协调hnRNP H/ F和U蛋白来调节可变剪接事件。进一步表明，AKAP95与自身直接相互作用。总之，实验的研究结果表明，AKAP95是pre-mRNA剪接的新型，并且是正向调节因子，它有可能是一个转录和剪接调节整合子，并且实验提出了一个模型，即AKAP95通过支架RNA和RNA加工因子调节pre-mRNA剪接，并促进剪接位点之间的信息交流。</p>
<p>原英文摘要： &gt;Alternative splicing of pre-mRNAs significantly contributes to the complexity of gene expression in higher organisms, but the regulation of the splice site selection remains incompletely understood. We have previously demonstrated that a chromatin-associated protein, AKAP95 (AKAP8), has a remarkable activity in enhancing chromatin transcription. In this study, we have shown that AKAP95 physically interacts with many factors involved in transcription and RNA processing, and functionally regulates pre-mRNA splicing. AKAP95 directly promotes splicing in vitro and the inclusion of a specific exon of an endogenous gene FAM126A. The N-terminal YG-rich domain of AKAP95 is important for its binding to RNA processing factors including selective groups of hnRNP proteins, and its zinc finger domains are critical for pre-mRNA binding. Genome-wide binding assays revealed that AKAP95 bound preferentially to proximal intronic regions on a large number of pre-mRNAs in human transcriptome, and AKAP95 depletion predominantly resulted in reduced inclusion of many exons. AKAP95 also selectively coordinates with hnRNP H/F and U proteins in regulating alternative splicing events. We have further shown that AKAP95 directly interacts with itself. Taken together, our results establish AKAP95 as a novel and mostly positive regulator of pre-mRNA splicing and a possible integrator of transcription and splicing regulation, and support a model that AKAP95 regulates pre-mRNA splicing via through scaffolding RNAs and RNA processing factors and facilitating the splice site communication.</p>
<h3 id="样本信息">样本信息</h3>
<p>样本1-8是RIP-seq的数据，研究的是AKAP95与转录组的结合，样本9-15是mRNA-seq的数据，研究的是在293细胞或小鼠ES细胞中敲减了AKAP95的数据（其中9-11是293细胞的数据，有3个，12-15是小鼠ES细胞的数据，有4个）。</p>
<h3 id="文章思路">文章思路</h3>
<p>1.AKAP95的N末端区域参与该蛋白与RNA加工因子的结合，这些RNA加工因子包括hnRNPs。 2.APAK95与许多RNA加工因子的结合暗示了AKAP95在RNA加工方面发挥了作用，这些作用包括pre-RNA剪接。实验结果表明，AKAP95直接调控minigene pre-mRNA剪接，AKAP95的N末端与ZFs是其功能发挥的结构域。 3.为了寻找AKAP95剪接调控的内源靶点。经过一系列实验表明：AKAP95和hnRNP F参与调节FAM126A外显子11的剪接（实验中提到了敲减AKAP95后，FAM126A的外显子11会被跳过，而在野生型中则正常剪接）。 4.利用深度测序的方法寻的找内源AKAP95与人类转录组的结合。测序手段是RIP，其结果是发现AKAp95能与pre-mRNAs结合。 <strong>5. （核心，也就是这个笔记学习的部分）问题：评估AKAP95对可变剪接的全局影响，实验手段是：①人类294细胞和小鼠ES细胞中敲减了AKAP95基因-&gt;②RNA-seq-&gt;③DEXseq分析。</strong>AKAP95的敲减会导致更多的外显子使用（exon）减少，这表明AKAP95会全局促进外显子增加（exon inclusion）。看文献我的理解是，有了AKAP95基因后，该基因的表达产物会导致FAM126A的外显子10，11，12连接起来，如果敲低了AKAP95这个基因，FAM126A的外显子10与12连接起来，会跳过外显子11。因此AKAP95的功能就在于调节FAM126A的可变剪接。exon inclusion我的理解是，外显子的利用，以此文献为例说明，exon inclusion指的就是FAM126A的外显子11的利用，AKAP95会促进AKAP95外显子11的利用，如果没有AKAP95，则FAM126A的外显子10就会跳过外显子11，与外显子12连接起来，exon inclusion就降低。 6.后续的实验作者又研究了AKA95的一些作用机理，略。</p>
<h3 id="文章结果">文章结果</h3>
<h4 id="a.b图">a.b图</h4>
<p>a图是火山图。火山图常用于展示显著差异表达的基因，这里有两个关键词：显著是指P&lt;0.05，差异表达一般我们按照Fold Change(倍数变化)&gt;=2.0作为标准。 当我们拿到基因表达的P值和倍数后，为了用火山图展示结果，一般需要把倍数进行Log2的转化（下图a的x轴），比如某基因在实验组表达水平是对照组的4倍，log2（4）=2，同样的如果是1/4，也就是0.25，转换后的结果就是-2。 P值进行-log10的转化，-log10（0.01）约等于2，由于P值越小表示越显著，所以我们进行-log10（P value）转化后，转化值越大表示差异约显著，比如-log10（0.001）=3 &gt; -log10(0.01)=2 &gt; -log10(0.05)=1.30（下图a的y轴）。 <img src="http://ortxpw68f.bkt.clouddn.com/rnaseq001a.png"> 火山图有三种颜色，黄色与红色都是Padj小于0.01的基因（P值经过了FDR校正，即false discovery rate）。红色又表示基因变化超过2倍的基因。b图是饼图，它表示外显子使用(exon usage)的增加与降低数目。</p>
<h4 id="c.d图">c.d图</h4>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/rnaseq002a.png">
</div>
<h4 id="e图">e图</h4>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/rnaseq003a.png">
</div>
<h4 id="f图">f图</h4>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/rnaseq004a.png">
</div>
<h3 id="文章所用的生信方法">文章所用的生信方法</h3>
<p>在后文的Bioinformatic analyses部分</p>
<h4 id="比对">比对</h4>
<p>比对软件：TopHat (v2.0.13) 参考基因组：human reference genome (GRCh37/hg19) GTF文件： GTF version GRCh37.70 只保留MQ &gt;30的map结果 Picard-tools (v1.126)： 计算平均插入大小(mean insert sizes)和标准差 read count: 软件：HTSeq v0.6.0</p>
<h4 id="差异表达分析">差异表达分析</h4>
<p>DESeq (v3.0) DEXSeq (v3.1)</p>
<h4 id="富集分析">富集分析</h4>
<p>GO分析：DAVID (http://david.ncifcrf.gov/)</p>
<h1 id="数据下载">数据下载</h1>
<p>进入NCBI的GEO数据库https://www.ncbi.nlm.nih.gov/geo/ 搜索GSE81916，如下所示： <img src="http://ortxpw68f.bkt.clouddn.com/RNAseq001.png"></p>
<p>输入GSE81916，单击Search即可，见到数据说明及下载页面，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/rnaseq002c.png">
</div>
<p>下面有一段话是对这些数据的描述，即：</p>
<blockquote>
<p>Overall design Samples 1-8 are RNA-immunoprecipitation &gt; (RIP)-seq to determine AKAP95 binding to the transcriptome. Samples 9-15 are mRNA-seq to determine effect of AKAP95 knockdown in human 293 cells (9-11) or &gt; mouse ES cells (12-15).</p>
</blockquote>
<p>大意就是样本9-15是mRNA-seq的数据，而样本1-8是RNA免疫组化的数据。我们只需要9-15的数据，单击红框链接即可进入数据下载页面，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/rnaseq002d.png">
</div>
<p>单击第一行的SRP/SRP075/SRP075747右侧的ftp，即可进入数据下载界面： <img src="http://ortxpw68f.bkt.clouddn.com/rnaseq003.png"></p>
<p>现在下载SRR3589956-SRR3589962的7个数据（3个人类，4个小鼠），命令如下：</p>
<p>此命令是将数据下载到disk2/sra的目录下，</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">cd ~/disk2 &amp;&amp; mkdir sra</div><div class="line">for ((i=56;i&lt;=62;i=i++));do wget ftp://ftp-trace.ncbi.nlm.nih.gov/sra/sra-instant/reads/ByStudy/sra/SRP/SRP075/SRP075747/SRR35899$i/SRR35899$i.sra ;done</div></pre></td></tr></table></figure>
<p>当时觉得数据下载慢，我就直接用迅雷下载了，数据下载后如下所示： <img src="http://ortxpw68f.bkt.clouddn.com/rnaseq004.png"></p>
<h2 id="参考资料">参考资料</h2>
<ol style="list-style-type: decimal">
<li><a href="https://mp.weixin.qq.com/s?src=11&amp;timestamp=1507359643&amp;ver=437&amp;signature=cWtmQqrEoi7fnwdGF63u2mcQ0P6cJpcV4aDJ6AHHSJBEDxuP2Wb65am9apJEQaPs1U6NBoVE5EJ0XK1MEatZyKjd9OlDcpEB0T3-abbjsFTl01OZznhVOV-eQh1gW8n1&amp;new=1" target="_blank" rel="external">浙大植物学小白的转录组笔记</a></li>
<li><a href="http://www.jianshu.com/p/d717957828c8" target="_blank" rel="external">转录组入门（2）：读文章拿到测序数据</a></li>
<li><a href="https://mp.weixin.qq.com/s?src=11&amp;timestamp=1507611528&amp;ver=443&amp;signature=s4y*meB6oWf0zVZIxQ9EEpNJ5P0whexjL2DcoTcwbgYBOqzhv-2jZk2U86FRlrGFW*6XSnTwgcVLt7HXwvLGWSF9z4qErLcHhdtjy6V0Qz3fa*VQAmLJGou2QXklqI-a&amp;new=1" target="_blank" rel="external">如何看懂和绘制火山图？</a></li>
<li><a href="https://mp.weixin.qq.com/s?src=3&amp;timestamp=1507708087&amp;ver=1&amp;signature=sDBGiyaFarX9G5wtSOQZmeNuqVjXrtAwT3TPqeKPH3B9tyOi4-U3kaq2-5g6xncNA1WKDJrGvJdfB995Br2sSem-IImvEgNWliDhuFDKxHojoVe5DioWWgBDBR7xLSWz-yUqZnnXKXLamRkn598rPLLCf5fRp-0KTirlcjpl1fw=" target="_blank" rel="external">人气推文p值、E值、FDR、q值…你晕菜了吗？续集来啦！</a></li>
<li><a href="https://mp.weixin.qq.com/s?src=3&amp;timestamp=1507708087&amp;ver=1&amp;signature=YQpqTHl4WpYahQH2jvnkPWMm3-T9BnyoL5l9GZy2AhftTiyYF6Oq7lLBfskA8f6Po3rBZY4qSWogpaGi233BtEoRvexLfcbp-PcbWjrKu-XduuIMh136EjzWY*57k9brIInLLwcPx*QLsHkpvkiOHHMv-SrKCyVPf38TWe-Dl70=" target="_blank" rel="external">揭秘：FDR背后的真相</a></li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2017/10/01/转录组学习笔记01-计算机及软件安装/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/10/01/转录组学习笔记01-计算机及软件安装/" itemprop="url">转录组学习笔记01-计算机及软件安装</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-10-01T12:00:00+08:00">
                2017-10-01
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/生物信息学/" itemprop="url" rel="index">
                    <span itemprop="name">生物信息学</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  1,967
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  9
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="前言">前言</h2>
<p>转录组的这几篇入门笔记主要是参照了生信技能树论坛，公众号，生信媛公众号，徐更洲的博客，沈梦圆的博客及公众号，Jimmy等人的博客完成的。</p>
<h2 id="软件安装一miniconda">软件安装（一）——miniconda</h2>
<h3 id="首先要安装miniconda">首先要安装：Miniconda</h3>
<p>先了解一下conda，Anaconda,Miniconda。 <strong>conda</strong>是一个工具，也是一个可执行命令，其核心功能是包管理与环境管理。包管理与pip的使用类似，环境管理则允许用户方便地安装不同版本的python并可以快速切换。 <strong><a href="https://www.anaconda.com/download/#download" target="_blank" rel="external">Anaconda</a></strong>是一个用于科学计算的Python发行版，支持 Linux, Mac, Windows系统，提供了包管理与环境管理的功能，可以很方便地解决多版本python并存、切换以及各种第三方包安装问题。Anaconda则是一个打包的集合，里面预装好了conda、某个版本的python、众多packages、科学计算工具等等，所以也称为Python的一种发行版。 <strong><a href="https://conda.io/miniconda.html" target="_blank" rel="external">Miniconda</a></strong>则是Anaconda的微缩版，它只包含最基本的内容，即python与conda，以及相关的必须依赖项，对于空间要求严格的用户，Miniconda是一种选择。 <strong><a href="https://bioconda.github.io/index.html" target="_blank" rel="external">bioconda</a></strong>是conda上一个分发生物信息软件的频道。多数软件都可以通过conda来安装，可查看<a href="https://bioconda.github.io/recipes.html#recipes" target="_blank" rel="external">可用软件列表</a>。</p>
<h4 id="第一步下载miniconda2">第一步：下载miniconda2</h4>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">wget https://repo.continuum.io/miniconda/Miniconda2-latest-Linux-x86_64.sh</div></pre></td></tr></table></figure>
<h4 id="第二步安装miniconda2">第二步：安装miniconda2</h4>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">bash Miniconda2-latest-Linux-x86_64.sh</div></pre></td></tr></table></figure>
<p>安装过程基本上就是按Enter或输入yes，仔细看说明就行。</p>
<h4 id="第三步将miniconda2保存到环境变量">第三步：将miniconda2保存到环境变量</h4>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">echo &quot;export PATH=/home/bio/miniconda2/bin:&quot;&apos;$PATH&apos; &gt;&gt; ~/.bashrc</div><div class="line">source ~/.bashrc</div></pre></td></tr></table></figure>
<h4 id="第四步添加通道">第四步：添加通道</h4>
<p>Conda默认的源访问速度有些慢，可以增加国内的源（国内的源是清华源，其中参考文献中给出的；另外还可以增加几个源，以便于安装更多的软件，尤其是bioconda安装生信类工具。conda-forge通道是Conda社区维护的包含很多不在默认通道里面的通用型软件。r通道是向后兼容性通道，尤其是使用R3.3.1版本时会用到。后添加的通道优先级更高，因此一般用下面列出的顺序添加。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">conda config --set show_channel_urls yes</div><div class="line">conda config --add channels r # Optional, lowest priority</div><div class="line">conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/free</div><div class="line">conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/conda-forge</div><div class="line">conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/bioconda</div></pre></td></tr></table></figure>
<p>如果命令行添加不了，可以用<code>vim ~/.condarc</code>来进行安装，如果安装错误了，可以删除.condarc文件，然后再用命令行来安装。用<code>conda config --get channels</code>可以查看已经添加的频道，而用<code>conda config --show</code>可查看已有的配置。如下所示： <img src="http://ortxpw68f.bkt.clouddn.com/conda002a.png"></p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/conda001a.png">
</div>
<h3 id="conda基本使用">Conda基本使用</h3>
<h4 id="列出安装的软件包">列出安装的软件包</h4>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">conda list</div></pre></td></tr></table></figure>
<p>如下所示： <img src="http://ortxpw68f.bkt.clouddn.com/conda003a.png"></p>
<h4 id="搜索需要安装的软件包获取其完成名字">搜索需要安装的软件包，获取其完成名字</h4>
<p>命令是<code>conda search &lt;package ambigious name&gt;</code> ，以搜索fastqc为例： <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">conda search fastqc  # * 表示对于版本的包已安装</div></pre></td></tr></table></figure></p>
<p>如下所示： <img src="http://ortxpw68f.bkt.clouddn.com/conda004a.png"></p>
<h4 id="安装包">安装包</h4>
<p>命令为<code>conda install &lt;package name&gt;</code> 以安装 numpy=1.7.2为例说明</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">conda install numpy=1.7.2 </div><div class="line"># 安装特定版本的软件包</div><div class="line"># 也可以不加</div></pre></td></tr></table></figure>
<h4 id="更新软件包">更新软件包</h4>
<p><code>conda update &lt;package name&gt;</code></p>
<h4 id="移除软件包">移除软件包</h4>
<p><code>conda remove &lt;package name&gt;</code></p>
<h4 id="获取帮助信息">获取帮助信息</h4>
<p><code>conda -h # 查看conda可用的命令</code> <code>conda install -h #查看install子命令的帮助</code></p>
<h3 id="关于环境">关于环境</h3>
<p>condas可以创建多个分析环境，这是它的优势之一，不过目前用不到，以后用到了再学。</p>
<h4 id="查看已有环境">查看已有环境</h4>
<p>虚拟<strong>环境管理</strong>：conda比较好用的就是它能够建立多个互不干扰的分析环境。通过<code>conda info --envs</code>可以查看环境，如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">conda info --envs</div><div class="line"># 或 conda info -e</div></pre></td></tr></table></figure>
<p>目前就只有一个默认环境，也就是root： <img src="http://ortxpw68f.bkt.clouddn.com/minicoda2.png"></p>
<h3 id="卸载miniconda">卸载miniconda</h3>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">rm -rf ~/miniconda2</div></pre></td></tr></table></figure>
<p>从环境变量中去掉miniconda：打开~/.bash_profile文件，删掉其中miniconda的路径，关闭并保存 删除隐藏的.condarc 、.conda以及.continuum文件</p>
<h2 id="软件安装二其它生信工具">软件安装（二）——其它生信工具</h2>
<p>目前所用的生信工具如下所示：</p>
<h3 id="sratoolkit">(1)sratoolkit</h3>
<p><a href="https://trace.ncbi.nlm.nih.gov/Traces/sra/sra.cgi?view=software" title="sratoolkit" target="_blank" rel="external">sratoolkit</a>：把NCBI SRA（Sequence Read Archive）数据库中的NGS序列数据从 sra 格式转换到 fastq 格式。</p>
<p>conda安装：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">conda install -c jfear sratoolkit=2.8.1</div></pre></td></tr></table></figure>
<p>如果安装不成功，可采用下列安装方式（<strong>我的笔记本上上基本上都是conda安装，对于下面的安装方式并没有试过</strong>）：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">cd mynotes</div><div class="line">cd src</div><div class="line">wget https://ftp-trace.ncbi.nlm.nih.gov/sra/sdk/2.8.2-1/sratoolkit.2.8.2-1-ubuntu64.tar.gz</div><div class="line">tar -zxvf sratoolkit.2.8.2-1-ubuntu64.tar.gz</div><div class="line">mv sratoolkit.2.8.2-1-ubuntu64 ~/biosoft</div><div class="line"></div><div class="line"># 加入环境变量</div><div class="line">echo &apos;PATH=$PATH:~/biosoft/sratoolkit.2.8.2-1-ubuntu64/bin&apos; &gt;&gt; ~/.bashrc</div><div class="line"></div><div class="line"># 测试</div><div class="line">prefetch -v</div><div class="line"># 尝试下载，默认存放在家目录下的ncbi文件夹中</div><div class="line">prefetch -c SRR390728</div></pre></td></tr></table></figure>
<h3 id="fastqc">fastqc</h3>
<p><a href="http://www.bioinformatics.babraham.ac.uk/projects/fastqc/" title="fastqc" target="_blank" rel="external">fastqc</a>:二代测序数据质量分析软件。</p>
<p>安装如下： <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">conda install fastqc</div></pre></td></tr></table></figure></p>
<p>或者是采用常规的安装方式： <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"># 判断系统是否安装java</div><div class="line">java -version</div><div class="line"># 安装java， 请改成openjdk-9-jdk，下面的是错误演示</div><div class="line">sudo apt install  openjdk-9-jre-headless</div><div class="line"># 验证</div><div class="line">java -version</div><div class="line"># openjdk version &quot;9-internal&quot;</div><div class="line"># OpenJDK Runtime Environment (build 9-internal+0-2016-04-14-195246.buildd.src)</div><div class="line"># OpenJDK 64-Bit Server VM (build 9-internal+0-2016-04-14-195246.buildd.src, mixed mode)</div><div class="line"># 安装fastqc</div><div class="line">cd src</div><div class="line">wget http://www.bioinformatics.babraham.ac.uk/projects/fastqc/fastqc_v0.11.5.zip</div><div class="line">unzip fastqc_v0.11.5.zip</div><div class="line">mv FastQC/ ~/biosoft/</div><div class="line">cd ~/biosoft/FastQC/</div><div class="line">chmod 770 fastqc</div><div class="line"># 添加环境变量， 我用sed修改</div><div class="line">sed -i &apos;/^PATH/s/\(.*\)/\1:~\/biosoft\/FastQC\//&apos; ~/.bashrc</div><div class="line">source ~/.bashrc</div><div class="line">fastqc -v</div><div class="line"># FastQC v0.11.5</div></pre></td></tr></table></figure></p>
<h3 id="hisats">hisats</h3>
<p><a href="http://ccb.jhu.edu/software/hisat2/index.shtml" title="hisats" target="_blank" rel="external">hisats</a>：将测序结果比对到人类参考基因组上。HISAT2是TopHat2/Bowti2的继任者，使用改进的BWT算法，实现了更快的速度和更少的资源占用。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">conda install -c bioconda hisat2</div></pre></td></tr></table></figure>
<h3 id="samtools">samtools</h3>
<p><a href="http://www.htslib.org/" title="samtools" target="_blank" rel="external">samtools</a>:处理SAM、BAM文件的工具软件。BAM格式文件是存放高通量测序中比对结果的标准格式文件。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">conda install -c bioiconda samtools</div></pre></td></tr></table></figure>
<p>或者如下安装： <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line">cd src</div><div class="line">#  prerequsite</div><div class="line">## system requirement</div><div class="line">sudo apt install autoconf libz-dev libbz2-dev liblzma-dev libssl-dev</div><div class="line"></div><div class="line">### zlib2</div><div class="line">wget http://zlib.net/zlib-1.2.11.tar.gz</div><div class="line">tar -zxvf zlib-1.2.11.tar.gz &amp;&amp; cd zlib-1.2.11 &amp;&amp; make &amp;&amp; sudo make install &amp;&amp; cd .. &amp;&amp; rm -rf zlib-1.2.11</div><div class="line"></div><div class="line">### bzip2</div><div class="line">wget http://bzip.org/1.0.6/bzip2-1.0.6.tar.gz</div><div class="line">tar -zxvf bzip2-1.0.6.tar.gz &amp;&amp; cd bzip2-1.0.6 &amp;&amp; make &amp;&amp; sudo make install &amp;&amp; cd .. &amp;&amp; rm -rf  bzip2-1.0.6</div><div class="line"></div><div class="line">### curses</div><div class="line">sudo apt-get install libncurses5-dev </div><div class="line"></div><div class="line">### htslib</div><div class="line">git clone https://github.com/samtools/htslib.git</div><div class="line">cd htslib</div><div class="line">autoreconf</div><div class="line"></div><div class="line"># building samtools</div><div class="line">git clone https://github.com/samtools/samtools.git</div><div class="line">cd samtools</div><div class="line">autoconf -Wno-syntax</div><div class="line">./configure </div><div class="line">make &amp;&amp; make install prefix=$HOME/biosoft/samtools</div><div class="line"></div><div class="line">## add PATH</div><div class="line">sed  &apos;/^PATH/s/\(.*\)/\1:~\/biosoft\/samtools\/bin/&apos; .bashrc -i</div><div class="line">source ~/.bashrc</div><div class="line">samtools --help</div></pre></td></tr></table></figure></p>
<h3 id="htseq-count">htseq-count</h3>
<p><a href="http://htseq.readthedocs.io/en/release_0.9.1/" title="htseq-count" target="_blank" rel="external">htseq-count</a>：用于reads计数的软件，他能对位于基因组上的一些单位的reads数进行统计，这里所说的单位主要是指染色体上的一组位置区间（我们常见的就是gene exon）</p>
<p>优先conda安装</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">conda install -c bioconda htseq=0.7.2</div></pre></td></tr></table></figure>
<p>如果conda无法安装，采用下列安装方式：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">## Download and install HISAT </div><div class="line"># https://ccb.jhu.edu/software/hisat2/index.shtml</div><div class="line">cd ~/biosoft</div><div class="line">mkdir HISAT  &amp;&amp;  cd HISAT </div><div class="line">#### readme: https://ccb.jhu.edu/software/hisat2/manual.shtml</div><div class="line">wget ftp://ftp.ccb.jhu.edu/pub/infphilo/hisat2/downloads/hisat2-2.0.4-Linux_x86_64.zip</div><div class="line">unzip hisat2-2.0.4-Linux_x86_64.zip</div><div class="line">ln -s hisat2-2.0.4  current </div><div class="line">## ~/biosoft/HISAT/current/hisat2-build</div><div class="line">## ~/biosoft/HISAT/current/hisat2</div></pre></td></tr></table></figure>
<p>或者如下： <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"># prerequsites</div><div class="line">sudo apt-get install python-pip</div><div class="line">pip install --upgrade pip</div><div class="line">sudo apt-get install build-essential python2.7-dev python-numpy python-matplotlib</div><div class="line">## 验证， 保证无报错</div><div class="line">python -V</div><div class="line">## python</div><div class="line">python</div><div class="line">&gt;&gt;&gt; import numpy </div><div class="line">&gt;&gt;&gt; import matplotlib </div><div class="line"></div><div class="line">## install HTSeq</div><div class="line">pip install htseq</div><div class="line"></div><div class="line">## 验证</div><div class="line">python</div><div class="line">&gt;&gt;&gt; import HTSeq</div></pre></td></tr></table></figure></p>
<h3 id="r">R</h3>
<p><a href="https://www.r-project.org/" title="R" target="_blank" rel="external">R</a>：统计与数据可视化工具。 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">conda install -c r r-base</div><div class="line">R #运行的时候要大写</div><div class="line"></div><div class="line">## conda install -c r r-essentials </div><div class="line">## -essentials表示安装R,及80多个常用的数据分析包, 包括idplyr, shiny, ggplot2, tidyr, caret 和 nnet</div></pre></td></tr></table></figure></p>
<h4 id="rstudio的安装">Rstudio的安装</h4>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">conda install rstudio</div><div class="line">rstudio</div></pre></td></tr></table></figure>
<p>后面涉及有关R的分析是在Sindows平台下完成的，并没有用到Linux下的R工具。</p>
<h2 id="参考资料">参考资料：</h2>
<ol start="2" style="list-style-type: decimal">
<li><a href="https://zhuanlan.zhihu.com/p/25085567" target="_blank" rel="external">使用Bioconda管理Linux系统中的生物信息软件</a></li>
<li><a href="http://www.jianshu.com/p/2f3be7781451" target="_blank" rel="external">PeterYuan，Anaconda使用总结</a></li>
<li><a href="http://www.jianshu.com/p/b16ae34f9012" target="_blank" rel="external">hoptop.转录组入门（1）：软件准备</a></li>
<li><a href="https://mp.weixin.qq.com/s?src=3&amp;timestamp=1507534977&amp;ver=1&amp;signature=uauB8*AHbC91QJFzs7AVO9vdeU92DPB9L4J5qT67AiaQtvdg0nvRCGJo1yaciFx3pF3slW4Zh0w8GUAecvQJmBKc2I0xX2q7IBvD2ha0T-uFJ1xlINQNb-VM40mZZOkP3rVn78KVvAFtVqYCxeSdjGBoYw23piWH50rts95D6iU=" target="_blank" rel="external">生信软件的好帮手-bioconda</a></li>
<li><a href="http://www.dxy.cn/bbs/topic/37352184" target="_blank" rel="external">中国科大开源镜像站的bioconda新镜像申请</a></li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2017/09/22/医学统计学-主成分分析/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/09/22/医学统计学-主成分分析/" itemprop="url">主成分分析（1）——理论部分</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-09-22T12:02:00+08:00">
                2017-09-22
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/医学统计学/" itemprop="url" rel="index">
                    <span itemprop="name">医学统计学</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  3,971
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  16
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="主成分分析简介及主要思想">主成分分析简介及主要思想</h2>
<p>主成分分析（principal components analysis，PCA），是由1901年被Pearson首先引入的，1933年由Hotelling作了进一步的发展，主成分分析是从多个数值变量（指标）之间的相互关系入手，利用降维的思想，将多个变量（指标）化为少数几个互不相关的综合变量（指标）的统计方法。</p>
<p>在医学研究中，为了客观、全面地分析问题，常要记录多个观察指标并考虑众多的影响因素，这样的数据虽然可以提供丰富的信息，但同时也使用数据的分析工作更趋复杂化。例如在儿童生长发育的评价中，收集到的数据包括每一个儿童的身高、体重、胸围、坐高、肺活量等十多个指标。怎样利用这类多指标的数据对每一个儿童的生长发育水平作出正常的评价？如果仅用其中任一指标来作评价，其结论显然是片面的，而且不能充分利用已有的数据信息。如果分别利用每一指标进行评价，然后再综合各指标评价的结论，这样做一是可能会出现各指标评价的结论不一致，甚至相互冲突，从而给最后的综合评价带来困难；二是工作量明显增大，不利于进一步的统计分析。事实上，在实际工作中，所涉及的众多指标之间经常是有相互联系和影响的，从这一点出发，希望通过对原始相互关系的研究，找出少数几个综合指标，这些综合指标是原始指标的纯属绵且，它既保留了原始指标的主要信息，且又互不相关。这样一种从众多原始指标之间相互关系入手，寻找少数综合指标以根据原始指标信息的多元统计方法称为主成分分析。</p>
<h2 id="主成分分析的数学模型及几何意义">主成分分析的数学模型及几何意义</h2>
<h3 id="一主成分分析的数学模型">（一）主成分分析的数学模型</h3>
<p>设有m个指标，即<span class="math">\(X_{1},X_{2},\dots,X_{m}\)</span>,欲寻找可以概括这m个指标主要信息的综合指标<span class="math">\(Z_{1},Z+{2},\dots,Z_{m}\)</span>，从数学上讲，就是寻找一组常数，即<span class="math">\(a_{i1},a_{i2},\dots,a_{im}(i=1,2,\dots,m）\)</span>，使这m个指标的线性组合为： <img src="http://ortxpw68f.bkt.clouddn.com/pca_f001.png"> 能够根据m个原始指标<span class="math">\(X_{1},X_{2},\dots,X_{m}\)</span>的主要信息，且各<span class="math">\(Z_{i}(i=1,2,\dots,m)\)</span>互不相关，为叙述方案，可以引入以下的矩阵形式，令</p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/pca_f002.png"> 则公式1-1可以表示为： <span class="math">\[
\bf {Z=AX} (1-2)
\]</span> 或者是</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/pca_f003.png">
</div>
<p>如果<span class="math">\(Z_{1}=\bf a&#39;_{1}X\)</span>满足<span class="math">\(\bf a&#39;_{1}a_{1}=1\)</span>，且 <span class="math">\(Var(Z_{1})=\mathop{Max}\limits_{\bf a&#39;a=1}^{}{Var(\bf a&#39;X)}\)</span>，刚称<span class="math">\(Z_{1}\)</span>是原始指标<span class="math">\(X_{1},X_{2},\dots,X_{m}\)</span>的第一主成分。</p>
<p>通常情况下，如果<span class="math">\(Z_{i}=\bf a&#39;X\)</span>满足： (1)<span class="math">\(\bf a&#39;_{i}a_{i}=1\)</span>，当i&gt;1时，<span class="math">\(\bf a&#39;_{i}a_{j}=0(i=1,2,\dots,i-1)\)</span> (2)<span class="math">\(Var(Z_{i})=\mathop{Max{Var(a&#39;\bf X)}}\limits_{\bf a&#39;a=1,\bf a&#39;a_{j}=0(j=1,2,\dots,i-1)}^{}\)</span> 刚称<span class="math">\(Z_{i}\)</span>是原始指标的第<span class="math">\(i\)</span>主成分（<span class="math">\(i=2,\dots,m\)</span>）。</p>
<p>由上述定义可知，当<span class="math">\(i\neq j\)</span>时，主成分<span class="math">\(Z_{i}\)</span>与<span class="math">\(Z_{j}\)</span>是互不相关的，并且<span class="math">\(Z_{1}\)</span>是原始指标<span class="math">\(X_{1},X_{2},\dots,X_{m}\)</span>的一切线性组合中方差最大者，<span class="math">\(Z_{2}\)</span>是与<span class="math">\(Z_{1}\)</span>不相关的、除<span class="math">\(Z_{1}\)</span>以外的<span class="math">\(X_{1},X_{2},\dots,X_{m}\)</span>一切线性组合中方差最大者，<span class="math">\(Z_{m}\)</span>是与<span class="math">\(Z_{1},Z_{2},\dots,Z_{m}-1\)</span>都不相关的，除<span class="math">\(Z_{1},Z_{2},\dots,Z_{m}-1\)</span>以外的<span class="math">\(X_{1},X_{2},\dots,X_{m}\)</span>一切线性组合中方差最大者。从理论上讲，求得的主成分个数最多可能有m个，这时，m个主成分就反映了全部原始指标所提供的信息，鉴于主成分分析的目的主要是用较少的综合指标来反映全部原始指标中的主要信息，因此在实际工作中，所确定的主成分个数总是小于原始指标的个数。</p>
<h3 id="二主成分的几何意义">（二）主成分的几何意义</h3>
<p>为方便讨论，以m=2为例说明主成分分析的几何意义，设个体具有两个观测指标X1和X2，它们之间具有较强的相关性，测量n例这样的个体的值，将所得的n对数据在以X1为横轴，X2为纵轴的二维坐标平面中的苫，得到如下的散点图： <img src="http://ortxpw68f.bkt.clouddn.com/pca.png"></p>
<p>由上图可以看出，由于<span class="math">\(X_{1}\)</span>和<span class="math">\(X_{2}\)</span>具有较强的相关性，这n个点的分页呈现出直接化的趋势；同时它们沿<span class="math">\(X_{1}\)</span>轴方向和<span class="math">\(X_{2}\)</span>轴方向都具有较大的变异变。个体在某个方向上的变异度可以用该方向上相应观测变量的方差来定量地表示。显然，如果只考虑<span class="math">\(X_{1}\)</span>和<span class="math">\(X_{2}\)</span>中任何一个方向上的言状，就将损失原始观测数据中很大一部分信息。如果我们将坐标轴<span class="math">\(X_{1}\)</span>和<span class="math">\(X_{2}\)</span>同时按逆时针方向作一个放置，得到新的坐标轴<span class="math">\(Z_{1}\)</span>和<span class="math">\(Z_{2}\)</span>，使得在亲折坐标平面上，这n个点的分布基本上不再具有有相关性，且它们的变异主要集中在Z1方向上，而在Z2方向上的变异较小，此时若取<span class="math">\(Z_{1}\)</span>作为第一主成分，则<span class="math">\(Z_{1}\)</span>就反应了原始指标<span class="math">\(X_{1}\)</span>和<span class="math">\(X_{2}\)</span>所包含的主要信息。</p>
<h2 id="主成分的求法及性质">主成分的求法及性质</h2>
<h3 id="一主成分的求法">（一）主成分的求法</h3>
<p>由主成分的定义可知，各主成分互不相关，即任意两个主成分<span class="math">\(Z_{i},Z_{j}\)</span>的协方差为0，即 <span class="math">\[
Cov(Z_{i},Z_{j})=0,i\neq j
\]</span></p>
<p>且各主成分的方差满足： <span class="math">\[
Var(Z_{1}) \geq Var(Z_{2}) \dots Var(Z_{m})  
\]</span></p>
<p>于是由公式(1-2)定义的随机向量<span class="math">\(Z\)</span>的协方差矩阵为： <img src="http://ortxpw68f.bkt.clouddn.com/pca_f004.png"></p>
<p>由主成分定义中的条件（1）可知，这里的方阵<span class="math">\(A\)</span>是正交阵，即<span class="math">\(A&#39;A=I\)</span>（I为单位矩阵），由此可得：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/pca_f005.png">
</div>
<p>由上述公式可知，求原始指标<span class="math">\(X_{1},X_{2},\dots,X_{m}\)</span>的主成分问题，实际上就是要求满足上述条件的正交阵<span class="math">\(A\)</span>，即随机微量<span class="math">\(X=(X_{1},X_{2},\dots,X_{m}\)</span>的协方差矩阵<span class="math">\(Cov(X)\)</span>的特征值（eigenvalue）与特征向量(eigenvector)。</p>
<h3 id="主成分的计算过程">主成分的计算过程</h3>
<p>下面讨论怎么由一组<span class="math">\(X_{1},X_{2},\dots,X_{m}\)</span>的样本观测值求出主成分，假设收集到的原始数据共有n例，每例测得m个指标的数值，记录如下所示： <img src="http://ortxpw68f.bkt.clouddn.com/pca003.png"></p>
<h4 id="对各原始指标数据进行标准化先按下式进行">1. 对各原始指标数据进行标准化，先按下式进行：</h4>
<p><span class="math">\[
X&#39;_{ij}=\frac{X_{ij}-\bar{X_{j}}}{S_{J}}(j=1,2,3,\dots,m)
\]</span></p>
<p>将原始指标标准化，然后用标准化的数据<span class="math">\(X&#39;_{ij}\)</span>来计算主成分，为了方便计算，下面的公式中仍用<span class="math">\(X_{ij}\)</span>表示标准化后的指标数据，<span class="math">\(\bf X\)</span>为标准化后的数据矩阵，则： <img src="http://ortxpw68f.bkt.clouddn.com/pca_f006.png"></p>
<h4 id="求出x的相关矩阵r">2. 求出<span class="math">\(X\)</span>的相关矩阵<span class="math">\(R\)</span></h4>
<p>标准化后，<span class="math">\(X\)</span>的相关矩阵即为协方差矩阵<span class="math">\(Cov({\bf X})\)</span> <img src="http://ortxpw68f.bkt.clouddn.com/pca_f007.png"></p>
<h4 id="求出相关矩阵的特征值和特征值对应的特征向量">3. 求出相关矩阵的特征值和特征值对应的特征向量</h4>
<p>由公式1-3得知，求主成分的问题，实际上是求出<span class="math">\(X\)</span>的协方差矩阵<span class="math">\(Cov(X)\)</span>（这里即为<span class="math">\(X\)</span>的相关矩阵<span class="math">\(R\)</span>）的特征值和特征向量，由于<span class="math">\(R\)</span>为半正定矩阵，故可由R的特征方程 <span class="math">\[
|{\bf R} -\lambda{\bf I|} 
= 0
\]</span></p>
<p>解得每一特征值<span class="math">\(\lambda_{i}\)</span>对应的单位特征向量<span class="math">\(a_{i}=(a_{i1} a_{i2} \dots a_{im}&#39;\)</span>，从而求得各主成分，即 <span class="math">\[
Z_{i}={\bf a&#39;_{i}X}={a_{i1}X_{1}+a_{i2}X_{2}+ \dots +a_{im}X_{m}} i=1,2,\dots,m
\]</span></p>
<h3 id="二主成分的性质">（二）主成分的性质</h3>
<h4 id="各主成分互不相关">1. 各主成分互不相关</h4>
<p>即<span class="math">\(Z_{i}\)</span>与<span class="math">\(Z_{j}\)</span>的相关系数为0，即： <span class="math">\[
r_{z_{i},z_{j}}=\frac{Cov(Z_{i},Z_{j})}{\sqrt{Cov(Z_{i},Z_{j})Cov(Z_{j},Z{j})}}=0(i \neq j)
\]</span> 因此各主成分间的相关系统矩阵为单位矩阵。</p>
<h4 id="主成分的贡献率和累积贡献率">2. 主成分的贡献率和累积贡献率</h4>
<p>可以证明，各原始指标<span class="math">\(X_{1},X_{2},\dots,X_{m}\)</span>的方差和与各主成分<span class="math">\(Z_{1},Z_{2},\dots,Z_{m}\)</span>的方差和相等，将数据标准化后，原始指标的方差和为<span class="math">\(\sum\limits_{i=1}^m \lambda_{i}\)</span>，即有<span class="math">\(m=\sum\limits_{i=1}^m \lambda_{i}\)</span></p>
<p>各指标所提供的信息量是用其方差来衡量的。由此可知，主成分分析是把m个原始指标<span class="math">\(X_{1},X_{2},\dots,X_{m}\)</span>的总方差分解为m个互不相关的综合指标<span class="math">\(Z_{1},Z_{2},\dots,Z_{m}\)</span>的方差之和，使第一主成分的方差达到最大，即变化最大的方向微量所相应的线性函数，最大方差为<span class="math">\(\lambda\)</span>。其中<span class="math">\({\lambda}/{\sum\limits_{i=1}^m \lambda_{i}}\)</span>表明了第一主成分<span class="math">\(Z_{1}\)</span>的方差在全部方差中所占的比值，称为第一主成分的贡献率，这个值越大，表明<span class="math">\(Z_{1}\)</span>这个指标综合原指标<span class="math">\(X_{1},X_{2},\dots,X_{m}\)</span>的能力越强，也可以说，由<span class="math">\(Z_{1}\)</span>的差异来解释<span class="math">\(X_{1},X_{2},\dots,X_{m}\)</span>的差异的能力越强，正是因为这一点，才把<span class="math">\(Z_{1}\)</span>称为<span class="math">\(X_{1},X_{2},\dots,X_{m}\)</span>的第一主成分，也就是<span class="math">\(X_{1},X_{2},\dots,X_{m}\)</span>的主要部分，了解到这一点，就可以知道为什么主成分是按特征值<span class="math">\(\lambda_{1},\lambda_{2},\dots,\lambda_{m}\)</span>进行排序的。</p>
<p>通常情况下 <span class="math">\[
\frac{\lambda_{i}}{\sum\limits_{i=1}^m}=\frac{\lambda_{i}}{m}(k=1,2,\dots,m)
\]</span> 为第i主成分的贡献率；而称 <span class="math">\[
\sum\limits_{i=1}^k \frac{\lambda_{i}}{m}(k \leq m)
\]</span> 为前k个主成分的累积贡献率。</p>
<h4 id="主成分个数的选取">3. 主成分个数的选取</h4>
<p>通常并不需要全部的主成分，只用其中的前几个，一般来说，主成分的保留个数按以下的原则来进行： ##### (1)以累积贡献率来确定：</p>
<p>当前k个主成分的累积贡献率达到某一特定值时（一般以大于70%为宜），则保留前k个主成分。 ##### (2)以特征值的大小来确定：</p>
<p>即若主成分<span class="math">\(Z_{i}\)</span>的特征值<span class="math">\(\lambda_{i} \geq 1\)</span>，则保留<span class="math">\(Z_{i}\)</span>，否则就去掉该主成分。</p>
<h4 id="因子载荷">4. 因子载荷</h4>
<p>为了了解各主成分与各原始指标之间的关系，在主成的表达式中，第<span class="math">\(i\)</span>主成分<span class="math">\(Z_{i}\)</span>的特征值的平方根<span class="math">\(\sqrt{\lambda_{i}}\)</span>与第<span class="math">\(j\)</span>原始指标<span class="math">\(X_{j}\)</span>的系数<span class="math">\(a_{ij}\)</span>的乘积，即 <span class="math">\[
q_{ij}=\sqrt{\lambda_{i}a_{ij}}
\]</span> 为因子载荷（factor loading），由因子载荷构成的矩阵称为因子载荷阵，事实上因子载荷<span class="math">\(q_{ij}\)</span>就是第<span class="math">\(i\)</span>主成分<span class="math">\(Z_{i}\)</span>与第<span class="math">\(j\)</span>原始指标<span class="math">\(X_{j}\)</span>之间的相关系数，它反映了主成分<span class="math">\(Z_{i}\)</span>与原始指标X_{i}$之间联系的密切程度与作用的方向。</p>
<h4 id="样品的主成得分">5. 样品的主成得分</h4>
<p>对于具有原始指标测定值<span class="math">\((X_{i1},X_{i2},\dots,X_{im})\)</span>的任一样品，可先用标准化变换式将原始数据标化，即：</p>
<p><span class="math">\[
X&#39;_{ij}=\frac{X_{ij}-\bar{X_{j}}}{S_{J}}(j=1,2,3,\dots,m)
\]</span></p>
<p>然后代入各主成分的表达式，即 <span class="math">\[
Z_{i}={\bf a&#39;_{i}X}={a_{i1}X_{1}+a_{i2}X_{2}+ \dots +a_{im}X_{m}} i=1,2,\dots,m
\]</span> 求出该样本各主成分值，这样求得的主成分值称为该样本的主成分得分，利用样品的主成分得分，可以对样品的特征进行推断和评价。</p>
<h2 id="案例分析">案例分析</h2>
<h3 id="案例一">案例一</h3>
<p>例22-1 某研究者测得84名10岁男孩的身高、坐高、体重、胸围、肩宽、肺活量等6项生长发育指标，数据见表22-2。试作主成分分析。 <img src="http://ortxpw68f.bkt.clouddn.com/pca001.png"></p>
<h4 id="第1步导入数据">第1步：导入数据</h4>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">raw_pca &lt;- read.csv(&quot;https://raw.githubusercontent.com/20170505a/raw_data/master/data_szq_2201.csv&quot;)</div><div class="line"># 这是原始数据，放在了github上</div><div class="line">head(raw_pca)</div><div class="line">str(raw_pca)</div><div class="line">raw_pca &lt;- raw_pca[-1]</div><div class="line">#第1列是序号，没用，剔除掉</div></pre></td></tr></table></figure>
<p><img src="http://ortxpw68f.bkt.clouddn.com/pca001a.png"> 剔除掉第1列后的数据： <img src="http://ortxpw68f.bkt.clouddn.com/pca002a.png"></p>
<h4 id="第2步-数据的简单统计量">第2步： 数据的简单统计量</h4>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">apply(raw_pca,2,sd) # 求各列的标准差</div><div class="line">apply(raw_pca,2,mean) # 求各列的均数</div></pre></td></tr></table></figure>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/pca003a.png">
</div>
<h4 id="第3步相关矩阵的特征值">第3步：相关矩阵的特征值</h4>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">raw.pr&lt;- prcomp(raw_pca, scale = TRUE) # 标准误、方差贡献率和累积贡献率</div><div class="line">summary(raw.pr,loadings=TRUE) # 标准误、方差贡献率和累积贡献率</div></pre></td></tr></table></figure>
<p><img src="http://ortxpw68f.bkt.clouddn.com/pca005a.png"> 在上图中，其中第二行，即Proportion of Variance表示的是贡献率；而第3行，即Cumulative Proportion表示的是累积贡献率；由这个表可以看出，主成分取3个比较合适，此时的累积贡献率为88.92%，接近于90.00%。</p>
<h4 id="第4步相关矩阵的特征向量">第4步：相关矩阵的特征向量</h4>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">prcomp(raw_pca, scale = TRUE)</div></pre></td></tr></table></figure>
<p><img src="http://ortxpw68f.bkt.clouddn.com/pca004a.png"> 这张表的结果可以得出各个主成分的与相应变量的系数，如果取3个主成分，则可以得出前三个主成分为： <img src="http://ortxpw68f.bkt.clouddn.com/pca006a.png"></p>
<h4 id="第5步因子载荷矩阵">第5步：因子载荷矩阵</h4>
<p>前面的第1到第5步用的是R中的base的函数，没有找到计算因载荷的矩阵，现在用psych包来进行计算。</p>
<h5 id="碎石图">碎石图</h5>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"># 利用paych包进行分析</div><div class="line">library(psych)</div><div class="line">fa.parallel(raw_pca,fa=&apos;pc&apos;,n.iter=100,show.legend = FALSE,main=&apos;PCA analysis&apos;)</div></pre></td></tr></table></figure>
<p>psych包中的fa.parallel用来提取主成分，绘制的图形如下所示： <img src="http://ortxpw68f.bkt.clouddn.com/pca007a.png"> 这种图叫碎石图，其中，蓝线是基于观测特征值的碎石检验，根据100个随机数据矩阵推导出来的特征值均值是红线，从图中可以看出：碎石检验图形最大变化处上面只有一个成分；特征值大于随机模拟数据的也只有一个主成分；特征值大于1的也只有一个主成分。所以这一组数据使用一个主成分即可保留数据集的大部分信息（这一点与书上的不符，但主成分的挑选我觉得参入了一定的主观成分在里面，选取几个主成分，要综合几个因素来看，书上选取的是3个主成分，为了保持一致，我们后面的分析也选3个主成分）。</p>
<h5 id="提取主成分">提取主成分</h5>
<p>提取3个主成分，如下所示： <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">raw2.pca &lt;- principal(r = raw_pca, nfactors = 3, rotate = &apos;none&apos;)</div><div class="line"># 提取3个主成分</div><div class="line">raw2.pca</div></pre></td></tr></table></figure></p>
<p>结果如下所示： <img src="http://ortxpw68f.bkt.clouddn.com/pca008a.png"> 红色框中就是因子载荷矩阵。 由因子载荷矩阵可知，第一主成分<span class="math">\(Z_{1}\)</span>在各原始指标上的因子载荷较为老花镜，帮可认为该主成分反映的是各原始指标的综合信息；第二主成分<span class="math">\(Z_{2}\)</span>在<span class="math">\(X_{1}\)</span>（身高）、<span class="math">\(X_{3}\)</span>（坐高）及<span class="math">\(X_{4}\)</span>（胸围）上的因子载荷较大，故可认为该主成分反映的是体型方面的信息；而第三主成分<span class="math">\(Z_{3}\)</span>则主要反映了来自原始指标<span class="math">\(X_{6}\)</span>（肺活量）的信息。此外，还可知道，第一主成分<span class="math">\(Z_{1}\)</span>与各原始变量之间的关系较为密切，第二主成分<span class="math">\(Z_{2}\)</span>与原始变量<span class="math">\(X_{1}\)</span>、<span class="math">\(X_{2}\)</span>及<span class="math">\(X_{4}\)</span>之间的关系较为密切，而第三主成分<span class="math">\(Z_{3}\)</span>与原始变量<span class="math">\(X_{6}\)</span>之间的关系较为密切。</p>
<h2 id="参考资料">参考资料</h2>
<ol style="list-style-type: decimal">
<li>医学统计学.孙振球.第4版</li>
<li><a href="https://www.zhihu.com/question/20852004" target="_blank" rel="external">如何通俗易懂地解释「协方差」与「相关系数」的概念？</a></li>
<li><a href="http://pinkyjie.com/2010/08/31/covariance/" target="_blank" rel="external">浅谈协方差矩阵</a></li>
<li><a href="https://mp.weixin.qq.com/s/-FuNX0LiKHNRysSdgenK_g" target="_blank" rel="external">如何理解矩阵特征值和特征向量？</a></li>
<li><a href="https://ask.hellobi.com/blog/dataman/3073" target="_blank" rel="external">数据挖掘系列篇(15):R语言VS主成分分析的案例</a></li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2017/09/22/hexo笔记/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/09/22/hexo笔记/" itemprop="url">hexo公式渲染</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-09-22T12:02:00+08:00">
                2017-09-22
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/工具笔记/" itemprop="url" rel="index">
                    <span itemprop="name">工具笔记</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  56
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  1
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <ol style="list-style-type: decimal">
<li>安装hexo-math</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install hexo-math --save</div></pre></td></tr></table></figure>
<p>2.<code>_config.yml</code>的配置 添加以下信息：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">math:</div><div class="line">  engine: &apos;mathjax&apos; # or &apos;katex&apos;</div><div class="line">  mathjax:</div><div class="line">    src: custom_mathjax_source</div><div class="line">    config:</div><div class="line">      # MathJax config</div><div class="line">  katex:</div><div class="line">    css: custom_css_source</div><div class="line">    js: custom_js_source # not used</div><div class="line">    config:</div><div class="line">      # KaTeX config</div></pre></td></tr></table></figure>
<p>参考资料： 1. https://github.com/hexojs/hexo-math</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2017/08/18/医学统计学-第07章卡方分析/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/08/18/医学统计学-第07章卡方分析/" itemprop="url">卡方检验</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-08-18T12:02:00+08:00">
                2017-08-18
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/医学统计学/" itemprop="url" rel="index">
                    <span itemprop="name">医学统计学</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  6,346
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  25
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="简介">简介</h2>
<p>两个样本率的比较通常是使用<span class="math">\(\chi^2\)</span>检验（Chi-square test）。<span class="math">\(\chi^2\)</span>检验是以<span class="math">\(\chi^2\)</span>分布为理论依据，用途广泛的假设检验方法，卡方分析用于比较不同组之间的构成比，它的零假设是假定各组之间的构成是相同的，计算出理论每组的理论构成比，再计算理论值与实际值的差别，如果差别大的话，就拒绝零假设。它用于推断两个总体率或构成比之间有无差别、多个总体率或构成比之间有无差别、多个样品率间的多重比较、两个分类变量之间有无关联性、多维列联表的分析和频数分页拟合优度的<span class="math">\(\chi^2\)</span>检验，它的扩展分析方法有Fisher精确分析，Ridit分析，CMH分析。</p>
<h3 id="卡方检验的基本思路">卡方检验的基本思路</h3>
<p>（一）卡方分布（Chi-square distribution）是一种连续型分布，<span class="math">\(\chi^2\)</span>分布只有一个参数，即自由度<span class="math">\(\nu\)</span>。按<span class="math">\(\chi^2\)</span>分布的密度函数<span class="math">\(f(\chi^2)\)</span>可以给出自由度<span class="math">\(\nu=1,2,3,\dots\)</span>的一簇<span class="math">\(\chi^2\)</span>分布曲线，由<span class="math">\(\chi^2\)</span>分布曲线可见，<span class="math">\(\chi^2\)</span>分布的形状依赖于自由度<span class="math">\(\nu\)</span>的大小：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">x &lt;- c(seq(0,15,length = 1000)) </div><div class="line">#生成从0到10之间的1000个数字</div><div class="line"></div><div class="line">y1 &lt;- dchisq(x,1) </div><div class="line"># 生成对x的卡方密度值，自由度为1</div><div class="line"></div><div class="line">y6 &lt;- dchisq(x,6) </div><div class="line"># 生成对x的卡方密度值，自由度为6</div><div class="line"></div><div class="line">y10 &lt;- dchisq(x,10) </div><div class="line"># 生成对x的卡方密度值，自由度为10</div><div class="line"></div><div class="line">plot(x,y1,type = &quot;l&quot;, ylim = c(0,0.5),xlim=c(0,15),xlab=&quot;&quot;, ylab=&quot;&quot;, lty = 1, main = expression(paste(chi^2,&quot;Distribution&quot;)))</div><div class="line"># type =&quot;l&quot;表示绘制线，如果是n则不绘线；lty=1表示绘制实线</div><div class="line"></div><div class="line">lines(x,y6, type = &quot;l&quot;, xlab = &quot;&quot;, ylab = &quot;&quot;, lty =2) </div><div class="line"># lty=2表示绘制虚线lines(x,y10, type = &quot;l&quot;, xlab = &quot;&quot;, ylab = &quot;&quot;, lty= 3) # lty=3表示绘制点线</div><div class="line"></div><div class="line">lines(x,y10, type = &quot;l&quot;, xlab = &quot;&quot;, ylab = &quot;&quot;, lty= 3) # lty=3表示绘制点线</div><div class="line"></div><div class="line">text(1,0.3, c(expression(chi^2*(1))))</div><div class="line">text(4,0.18, c(expression(chi^2*(6))))</div><div class="line">text(10,0.13, c(expression(chi^2*(10))))</div></pre></td></tr></table></figure>
<p>图片如下所示：<img src="http://ortxpw68f.bkt.clouddn.com/chi01.png"></p>
<ol style="list-style-type: decimal">
<li>当自由度<span class="math">\(\nu \leq 2\)</span>时，曲线呈L形；</li>
<li>随着<span class="math">\(\nu\)</span>的增加，曲线逐渐趋于对称；</li>
<li>当自由度<span class="math">\(\nu \rightarrow \infty\)</span>时，<span class="math">\(\chi^2\)</span>分布趋于正态分布。</li>
</ol>
<p>（二）卡方分布的一个基本性质是它的可加性；如果两个独立的随机变量<span class="math">\(X_{1}\)</span>和<span class="math">\(X_{2}\)</span>分别服从自由度<span class="math">\(\nu_{1}\)</span>和<span class="math">\(\nu_{2}\)</span>的<span class="math">\(\chi^2\)</span>分布，则它们的和<span class="math">\(X_{1}+X_{2}\)</span>服从自由度<span class="math">\(\nu_{1}\)</span>和<span class="math">\(nu_{2}\)</span>的<span class="math">\(\chi^2\)</span>分布，即<span class="math">\(X_{1}+X_{2}~\chi^2_{\nu1+\nu2}\)</span>.</p>
<p>（三）<span class="math">\(\chi^2\)</span>分布的界值：当自由度<span class="math">\(\nu\)</span>确定后，<span class="math">\(\chi^2\)</span>分布曲线下右侧尾部的面积为<span class="math">\(\alpha\)</span>时，横轴上相应的<span class="math">\(\chi^2\)</span>值记为<span class="math">\(\chi^2_{\alpha,\nu}\)</span>，即<span class="math">\(\chi^2\)</span>分布的界值。<span class="math">\(\chi^2\)</span>值越大，p值越小，反之，<span class="math">\(\chi^2\)</span>值越小，界值越大。</p>
<h2 id="四格表资料的chi2检验">四格表资料的<span class="math">\(\chi^2\)</span>检验</h2>
<h3 id="案例1">案例1</h3>
<p>某医院欲比较异梨醇口服液（试验组）和氢氯噻嗪+地塞米松（对照组）降低颅内压的疗效。将200例颅内压增高症患者随机分为两组，结果见表7-1。问两组降低颅内压的总体有效率有无差别？（《医学统计学》第四版，孙振球，第七章 卡方检验 例7-1，P96）</p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/chi02.png"> <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">data71&lt;-matrix(c(99,75,5,21),nr = 2,dimnames = list(c(&quot;试验组&quot;, &quot;对照组&quot;),c(&quot;有效&quot;, &quot;无效&quot;)))</div><div class="line">data71</div></pre></td></tr></table></figure></p>
<p>数据的四格表如下所示： <img src="http://ortxpw68f.bkt.clouddn.com/chi03.png"></p>
<p>这张图里的四个数是该表的基本数据，其余的数据都是由这4个基本数据推算出来的，称为四格表（fourfold table）资料。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">chi &lt;- chisq.test(data71)</div><div class="line">chi$expected #　显示理论数</div></pre></td></tr></table></figure>
<p>理论数如下所示： <img src="http://ortxpw68f.bkt.clouddn.com/chi04.png"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">chisq.test(data71,correct=F) </div><div class="line"># correct = F表示不进行Yates连续性校正</div></pre></td></tr></table></figure>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/chi05.png">
</div>
<p>结果：卡方值为12.8571，p值= 0.0003362小于0.01，按sig = 0.01的水准，拒绝原假设，接受备用假设，可以认为异山梨醇口服液降低颅内压的有效率高于氢氯噻嗪+地塞米松的有效率。这个结果与SAS计算的结果相同。R语言中默认的卡方检验是进行Yates连续性校正，因此上题中进行检验时，要加入correct=F。</p>
<h2 id="四格表资料的fisher确切概率法">四格表资料的Fisher确切概率法</h2>
<p>四格表中的计数资料的实际频数都是分类资料，是不连续的，因此计算出的卡方值都是离散型分布，而卡方界值表的依据是卡方分布，卡方分布是连续分布，因此在实际工作中，对于四格表资料，需要进行Yates校正，其规则如下： 1. 当<span class="math">\(n\geq 40\)</span>，且所有的<span class="math">\(T\geq 5\)</span>时，用卡方检验的基本公式。 2. 当<span class="math">\(n\geq 40\)</span>，但有<span class="math">\(1\leq T \geq 5\)</span>时，用校正公式，或改用四格表资料的Fisher确切概率法。 3. 当<span class="math">\(n\leq 40\)</span>，或T 1$时，用四格表资料的Fisher确切概率法。</p>
<h3 id="案例2">案例2</h3>
<p>某医师欲比较胞磷胆碱与神经节苷酯治疗脑血管疾病的疗效，将78例脑血管疾病患者随机分为两组，结果见表7-2。问两种药物治疗脑血管疾病的有效率是否有差别？（《医学统计学》第四版，孙振球，第七章 卡方检验，例7-2）</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/chi06.png">
</div>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">data72&lt;-matrix(c(46,18,6,8),</div><div class="line">               nr = 2,</div><div class="line">               dimnames = list(c(&quot;胞磷胆碱&quot;,&quot;神经节苷脂&quot;),c(&quot;有效&quot;,&quot;无效&quot;)))</div><div class="line">chisq.test(data72,correct=F) # 不进行Yates校正的结果</div><div class="line"></div><div class="line">chisq.test(data72,correct=T) # 进行Yates校正的结果</div><div class="line"></div><div class="line"># 这个结果与下面的结果一样</div><div class="line"># 因为R中进行卡方检验时是默认进行Yates连续性校正的</div><div class="line">chisq.test(data72)</div></pre></td></tr></table></figure>
<p>结果如下所示： <img src="http://ortxpw68f.bkt.clouddn.com/chi07.png"></p>
<p>不校正的情况下，卡方值为4.35，p值为0.03695小于0.05，进行卡方连续性校正的情况下，卡方值为3.1448,p=0.07617。校正与不校正得出的结果在0.05附近，因此下结论要谨慎。</p>
<h2 id="配对四格表卡方检验">配对四格表卡方检验</h2>
<h3 id="案例3">案例3</h3>
<p>某实验室分别用乳胶凝集法和免疫荧光法对58名可疑系统红斑狼疮患者血清中抗核抗体进行测定，结果见表7-3。问两种方法的检测结果有无差别？（《医学统计学》第三版，孙振球，第七章 卡方检验，例7-3）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">data73&lt;-matrix(c(11,2,12,33),</div><div class="line">               nr = 2,dimnames = list(c(&quot;+&quot;, &quot;-&quot;),c(&quot;+&quot;, &quot;-&quot;)))</div><div class="line"></div><div class="line">library(epiR) # 载入epiR包，使用其中的epi.kappa函数</div><div class="line"></div><div class="line">mcnemar.test(data73) # 配对检验</div><div class="line"></div><div class="line">chisq.test(data73)$expect</div><div class="line"></div><div class="line">epi.kappa(data73)$kappa </div><div class="line"># 一致性检验，即考察这两个方法在检验方面是否吻合</div><div class="line"></div><div class="line"># 或者使用vcd包中的Kappa</div><div class="line">library(vcd)</div><div class="line">Kappa(data73)</div></pre></td></tr></table></figure>
<p>结果如下所示： <img src="http://ortxpw68f.bkt.clouddn.com/chi08.png"></p>
<p>结果分析：McNemar配对卡方检验的p值为0.01616,在0.05水平上，有显著性差异，免疫荧光法的总体阳性检出率要高于乳胶凝集法。</p>
<p>Kappa检验结果的p值小于0.01，估计值为0.455，说明两种方法的吻合度有统计学意义，但吻合度一般。</p>
<p>简单来说，McNemar检验是比较两种方法A与B对同一个对象的检验是否有差异，判断哪种方法比较好，比较容易检验出来结果。而Kappa检验就是比较A与B这两种方法检验出来的结果是不是一致的。在有些配对案例中可能会出现A的方法优于B，但A与B检验的结果不一致的情况。</p>
<h2 id="四格表精确fisher检验">四格表精确Fisher检验</h2>
<h3 id="案例4">案例4:</h3>
<p>某医师为研究乙肝免疫球蛋白预防胎儿宫内感染HBV的效果，将33例HBsAg阳性孕妇随机分为预防注射组和非预防组，结果见表7-4。问两组新生儿的HBV总体感染率有无差别？（《医学统计学》第四版，孙振球，第七章 卡方检验，例7-4)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">data74&lt;-matrix(c(4,5,18,6),nr = 2,</div><div class="line">               dimnames = list(c(&quot;预防注射组&quot;, </div><div class="line">                                 &quot;非预防组&quot;),c(&quot;阳性&quot;, &quot;阴性&quot;)))</div><div class="line">chi&lt;-chisq.test(data74) </div><div class="line"># 理论频数小于5的情况，这里用Yates连续校正，</div><div class="line"># 默认的就是，不用添加correct = T</div><div class="line"></div><div class="line">chi$expected </div><div class="line"># 查看理论频数，有小于5的情况</div><div class="line"></div><div class="line">fisher.test(data74)</div></pre></td></tr></table></figure>
<p>结果如下所示： <img src="http://ortxpw68f.bkt.clouddn.com/chi09.png"></p>
<h3 id="案例5">案例5:</h3>
<p>某单位研究胆囊腺癌、腺瘤的P53基因表达，对同期手术切除的胆囊腺癌、腺瘤标本各10份，用免疫组化法检测P53基因，资料见表7-6。问胆囊腺癌和胆囊腺瘤的P53基因表达阳性率有无差别？（《医学统计学》第四版，孙振球，第七章 卡方检验，例7-5）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">data75&lt;-matrix(c(6,1,4,9),nr = 2,</div><div class="line">               dimnames = list(c(&quot;胆囊腺癌&quot;, &quot;胆囊腺瘤&quot;),</div><div class="line">                               c(&quot;阳性&quot;, &quot;阴性&quot;)))</div><div class="line"></div><div class="line">fisher.test(data75)</div></pre></td></tr></table></figure>
<p>结果如下所示： <img src="http://ortxpw68f.bkt.clouddn.com/chi10.png"></p>
<h2 id="无序rc列表">无序R×C列表</h2>
<h3 id="案例6列与行的数目都大于2">案例6:列与行的数目都大于2</h3>
<p>无序R×C列表这种情况是行、列都无序，并且行与列的数目都大于2，例如： 某医师研究物理疗法、药物治疗和外用膏药三种疗法治疗周围性面神经麻痹的疗效，资料见表7-8。问三种疗法的有效率有无差别（《医学统计学》第四版，孙振球，第七章 卡方检验，例7-6）？ 如下所示： <img src="http://ortxpw68f.bkt.clouddn.com/chi11.png"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">data76&lt;-matrix(c(199,164,118,7,18,26),</div><div class="line">               nr = 3,dimnames = list(c(&quot;物理疗法组&quot;, &quot;药物治疗组&quot;,&quot;外用膏药组&quot;),</div><div class="line">                                      c(&quot;有效&quot;, &quot;无效&quot;)))</div><div class="line">chi.result &lt;- chisq.test(data76)</div><div class="line">chi.result # 查看卡方分析结果</div></pre></td></tr></table></figure>
<p>结果如下所示： <img src="http://ortxpw68f.bkt.clouddn.com/chi12.png"></p>
<h2 id="双向无序rc列表的卡方检验">双向无序R×C列表的卡方检验</h2>
<h3 id="案例7">案例7:</h3>
<p>某医师在研究血管紧张素I转化酶(ACE)基因I/D多态与2型糖尿病肾病(DN)的关系时，将249例2型糖尿病患者按有无糖尿病肾病分为两组，资料见表7-9，问两组2型糖尿病患者的ACE基因型总体分布有无差别（《医学统计学》第四版，孙振球，第七章 卡方检验，例7-7）？ <img src="http://ortxpw68f.bkt.clouddn.com/chi13.png"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">data77 &lt;- matrix(c(42,30,48,72,21,36),</div><div class="line">                 nrow=2,dimnames=list(c(&quot;DN组&quot;,&quot;无DN组&quot;),</div><div class="line">                                      c(&quot;DD&quot;,&quot;ID&quot;,&quot;II&quot;)))</div><div class="line">chi.result77 &lt;- chisq.test(data77)</div><div class="line">chi.result77$expected</div><div class="line">chi.result77</div></pre></td></tr></table></figure>
<p>结果如下所示： <img src="http://ortxpw68f.bkt.clouddn.com/chi14.png"></p>
<h2 id="双向无序rc列表的关联性检验">双向无序R×C列表的关联性检验</h2>
<h3 id="案例8">案例8</h3>
<p>测得某地5801人的ABO血型和MN血型结果如表7-10，问两种血型系统之间是否有关联？（《医学统计学》第四版，孙振球，第七章 卡方检验，例7-8）</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/chi15.png">
</div>
<p>没有找到关于Pearson列联系数的函数，手工计算如下： <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">data78 &lt;- matrix(c(431,388,495,137,490,410,587,179,902,800,950,32),nrow=4,dimnames=list(c(&quot;O&quot;,&quot;A&quot;,&quot;B&quot;,&quot;AB&quot;),</div><div class="line">                                                                                        c(&quot;M&quot;,&quot;N&quot;,&quot;MN&quot;)))</div><div class="line">chi.result &lt;- chisq.test(data78)</div><div class="line">chi.result</div><div class="line"></div><div class="line">sqrt(chi.result$statistic/(sum(data78)+chi.result$statistic)) # 列联系数</div><div class="line"></div><div class="line"># 根据手工计算结果，可以构建一个计算Pearson列联系数的自定义函数，如下所示：</div><div class="line"></div><div class="line">Pearson_Continuity &lt;- function(x)&#123;</div><div class="line">  chisq_result &lt;- chisq.test(x)$statistic </div><div class="line">  # 提取计算的卡方值</div><div class="line">  Pcoc &lt;- sqrt(chisq_result/(sum(x)+chisq_result))</div><div class="line">  print.noquote(&quot;Persaon列联系数&quot;) </div><div class="line"># print.noquote的作用是显示字符，不带引号，</div><div class="line"># 而print则是带引号</div><div class="line">  return(as.numeric(Pcoc))&#125;</div><div class="line"></div><div class="line">Pearson_Continuity(data78)</div></pre></td></tr></table></figure></p>
<p>结果如下所示： <img src="http://ortxpw68f.bkt.clouddn.com/chi16.png"></p>
<h2 id="两两比较所有组进行两两比较">两两比较——所有组进行两两比较</h2>
<p>当对所有组进行两两比较时，通常采用的方法是Bonferroni法，此方法对原有的检验水平进行调整，即原有的检验水平α除以比较次数得到调整后的检验水平。书本（《医学统计学》第三版，孙振球，P122）中的公式在分母中加了1，不清楚为什么，没有提出采用的是Bonferroni法。而另外两本参考书，即《医学统计学》第6版，马斌荣，P91与《医学统计学》第6版，颜虹，2010年，P155这两本书中所用到的两两比较的方法是Bonferroni法，在下面的题目中使用Bonferroni法。</p>
<h3 id="案例9">案例9</h3>
<p>对例7-6中的资料进行两两比较，以推断是否任两种疗法治疗周围性面神经麻痹的有效率均有差别？（《医学统计学》第四版，孙振球，第七章 卡方检验，例7-9）</p>
<p>例7-6中共有三组疗法，需要两两比较的次数是3次，因此检验水平是0.05/3=0.0167。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">data76&lt;-matrix(c(199,164,118,7,18,26),</div><div class="line">               nr = 3,</div><div class="line">               dimnames = list(c(&quot;物理疗法组&quot;, &quot;药物治疗组&quot;,&quot;外用膏药组&quot;),</div><div class="line">                               c(&quot;有效&quot;, &quot;无效&quot;)))</div><div class="line">chisq.test(data76[1:2,],correct=F) </div><div class="line"># 比较物理疗法组与药物治疗组，</div><div class="line"># R中默认四格表进行了Yates校正，</div><div class="line"># 此处设为F，不进行校正，因为实际值与观测值都大于5</div></pre></td></tr></table></figure>
<p>结果如下所示： <img src="http://ortxpw68f.bkt.clouddn.com/chi17.png"></p>
<p>从结果可以看出物理疗法组与药物治疗组有统计学差异。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">chisq.test(data76[2:3,], correct=F)</div><div class="line">#比较药物治疗组与外用膏药组</div></pre></td></tr></table></figure>
<p><img src="http://ortxpw68f.bkt.clouddn.com/chi18.png"> 从结果来看，药物治疗组与外用膏药组无统计学上的差异。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">chisq.test(data76[-2,],correct=F)</div><div class="line"># 比较物理疗法组与外用膏药组</div></pre></td></tr></table></figure>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/chi19.png">
</div>
<p>从结果来看，物理疗法组与外用膏药组有统计学上的差异。</p>
<h2 id="两两比较各个实验组与一个对照组进行比较">两两比较——各个实验组与一个对照组进行比较</h2>
<p>两两比较——各个实验组与一个对照组进行比较 当用各个实验组与一个对照组分别进行比较时，需要对检验水平α进行校正，即α/(k-1),其中k是组别。在此案例中，组别k=3,因此，调整后的检验水平=0.05/(3-2)=0.025。</p>
<h3 id="案例10">案例10:</h3>
<p>以表7-8资料中的药物治疗组为对照组，物理疗法组与外用膏药组为试验组，试分析两试验组与对照组的总体有效率有无差别？（《医学统计学》第四版，孙振球，第七章 卡方检验，例7-10）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">chisq.test(data76[1:2,],correct=F) </div><div class="line">#比较物理疗法组与药物治疗组</div><div class="line"></div><div class="line">chisq.test(data76[2:3,], correct=F) </div><div class="line">#比较药物治疗组与外用膏药组</div></pre></td></tr></table></figure>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/chi20.png">
</div>
<p>第一个结果显示，P=0.009343小于0.025，表明物理疗法组与药物治疗组有统计学意义 第二个结果显示，P=0.03214大于0.025，表明药物治疗组与外用膏药组无统计学意义。</p>
<h2 id="单向rc列联表分析列有序">单向R×C列联表分析——列有序</h2>
<h3 id="案例11">案例11</h3>
<p>某公司研制一种治疗风湿性关节炎的中药，选择试验组和对照组各60例，试验组服用新药，对照组服用常规药物。以中医证侯疗效为主要疗效指标，分为无效、有效、显效、痊愈四个等级。治疗两个疗程后，两组的疗效情况如表5.4所示（略，见代码），欲分析两种药物的疗效是否有差异（《医学案例统计分析与SAS应用》第五章例5.4，冯国双，北京大学医学出版社，2010:93）。</p>
<h3 id="第一种方法ridit分析">第一种方法：Ridit分析</h3>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">data54 &lt;- c(33,18,24,31,1,9,2,2)</div><div class="line">data54m &lt;- matrix(data54,nrow=2,</div><div class="line">                  dimnames=list(c(&quot;对照组&quot;,&quot;实验组&quot;),</div><div class="line">                                c(&quot;无效&quot;,&quot;有效&quot;,&quot;显效&quot;,&quot;痊愈&quot;)))</div><div class="line">data54m</div><div class="line"></div><div class="line">#从数据来看，列变量，即无效、有效、显效、痊愈这四个等级是有序的，</div><div class="line"># 即越来越好，而行变量，对照组与实验组，这是无效的，适合采用Ridit分析：</div><div class="line"></div><div class="line">library(Ridit)</div><div class="line">ridit(data54m,1) </div><div class="line"># 函数ridit的参数中1表示分组信息是行，即行是无序的，列是有序的，</div><div class="line"># 如果是2，则表示分组信息在列，即列是无序的，行是有序的</div></pre></td></tr></table></figure>
<p><img src="http://ortxpw68f.bkt.clouddn.com/chi21.png"> ### 第二种方法：CMH分析</p>
<p>用CMH也能进行RC列联表的单向有序分析，CMHtest函数在vcdExtra包中，需要载入</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">library(vcdExtra)</div><div class="line">CMHtest(data54m)</div></pre></td></tr></table></figure>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/chi22.png">
</div>
<p>CMH的单向有序分析参见第3行，即cmeans，这一行表示列有序，行无序的分析结果。</p>
<h2 id="双向有序rc列联表分析-cmh检验">双向有序R×C列联表分析-CMH检验</h2>
<p>对于双向有序的RC列联表进行分析，常用于CMH检验，卡方检验常用于分类变量资料的一种假设检验，该法主要用于两个或多个样本率的比较，也可以用于两变量间的关联分析、频属分析的拟合优度检验等。CMH检验是在1959年提出的mh统计方法的基础上提出来的，1988年才发展完善，现在习惯上称之为扩展的MH卡方检验。他们的主要区别在于，如果用同样的方法做同样的实验，由于实验的地点不同，若将这些不同地点的实验数据简单合并后有卡方检验，会参杂很多混杂因素，这会使检验结果产生很大的偏差—主要是由不同实验的点的软、硬条件不同造成的。采用CMH检验可以解决这类问题，采用的是多中心或分层分析方法，多用R×C列联表的分层统计处理1。此外，CMH还应用于双向有序的RC列联表的分析。如下所示：</p>
<h3 id="案例12">案例12</h3>
<p>某研究者欲研究年龄与冠状动脉粥样硬化等级之间的关系，将278例尸解资料整理成表7-13，问年龄与冠状动脉粥样硬化等级之间是否存在线性变化趋势？（《医学统计学》第四版，孙振球，第七章 卡方检验，例7-9）</p>
<h4 id="第一种方法">第一种方法：</h4>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">library(vcdExtra) </div><div class="line"># 载入vcdExtra包</div><div class="line">data711 &lt;- matrix(c(70,27,16,9,22,24,23,20,4,9,13,15,2,3,7,14),nrow=4)</div><div class="line">dimnames(data711) &lt;- list(age=c(&quot;20~&quot;,&quot;30~&quot;,&quot;40~&quot;,&quot;≥50&quot;),degree=c(&quot;-&quot;,&quot;+&quot;,&quot;++&quot;,&quot;+++&quot;))</div><div class="line">CMHtest(data711) # 分析数据</div><div class="line">chisq.test(data711)</div></pre></td></tr></table></figure>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/chi23.png">
</div>
<h4 id="第二种方法">第二种方法：</h4>
<p>通过coin包中的lbl_test函数也能进行CMH双向有序表的计算：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">library(coin)</div><div class="line">data711t &lt;- as.table(data711)</div><div class="line">lbl_test(data711t,scores=list(age=c(1,2,3,4),degree=c(1,2,3,4)))</div></pre></td></tr></table></figure>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/chi24.png">
</div>
<p>其中，scores是各个有序变量的得分，与教材中相同。</p>
<h4 id="第三种方法">第三种方法：</h4>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">library(reshape2)</div><div class="line">datax &lt;- melt(data711)</div><div class="line">datax$age &lt;- factor(datax$age,order=T)</div><div class="line">datax$degree &lt;- factor(datax$degree,order=T)</div><div class="line">CMHtest(xtabs(value~age+degree,data=datax))</div></pre></td></tr></table></figure>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/chi25.png">
</div>
<p>结果解读：(1)第1行的cor指的是行与列都为有序变量时的结果，即教材中的线性回归分量，为63.389，这个与教材的结果不一致，但R计算的结果与教材附带的SAS程序计算出来的结果一致，教材可能是印刷错误；(2)第2行的rmeans表示行是有序变量时的结果；(3)第3行的cmeans表示列是有序变量时的结果；(4)general表示列与行都是无序变量时的结果。</p>
<p>常规卡方计算的结果是71.4325。线性回归分量的结果是63.389，二者之差是教材中的偏离线性回归分量，即71.4325-63.389=8.0435，相应的P值为:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">1-pchisq(8.0435,8)</div></pre></td></tr></table></figure>
<p>p值结果为0.4292325，可以认为年龄与冠状动物粥样硬化之间不仅存在相关关系，并且为线性关系，从数据中可以看出来，冠状动脉粥样硬化的等级随着年龄的增加而增高。 注：pchisq(8.0435,8)表示，计算自由度为8，卡方值是8.0435的左侧卡方分布曲线下面积。</p>
<h2 id="cmh检验对多层分类资料的分析">CMH检验对多层分类资料的分析</h2>
<h3 id="案例13">案例13</h3>
<p>某公司推出一种治疗颈椎病的治疗仪，为评价其疗效，进行多中心的随机对照试验。共选择两家医院，每家医院60例研究对象，试验组与对照组各30例。以颈痛疗效作为主要疗效指标，根据缓解程度分为有效和无效。治疗20天后，各中心每组的疗效情况如下所示（参见代码），欲分析两种治疗仪的疗效是否有差异（《医学案例统计分析与SAS应用》第五章例5.4，冯国双，北京大学医学出版社，2010:97）。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">data56 &lt;- c(8,4,22,26,11,9,19,21)</div><div class="line">data56a &lt;- array(data56,dim=c(2,2,2))</div><div class="line">data56a</div><div class="line">dimnames(data56a) &lt;- list(</div><div class="line">  c(&quot;对照组&quot;,&quot;试验组&quot;),</div><div class="line">  c(&quot;无效&quot;,&quot;有效&quot;),</div><div class="line">  c(&quot;中心1&quot;,&quot;中心2&quot;))</div><div class="line"></div><div class="line">CMHtest(data56a,overall=TRUE)</div></pre></td></tr></table></figure>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/chi26.png">
</div>
<p>结果由三部分构成，第一部分是中心1的结果，第二部分是中心2 的结果，第三部分是控制了中心的影响后，两组疗效差异无统计学意义。</p>
<h2 id="频数分布拟合优势的卡方检验">频数分布拟合优势的卡方检验</h2>
<h3 id="案例14">案例14</h3>
<p>观察某克山病区克山病患者的空间分布情况，调查者将该地区划分为279个取样单位，统计各取样单位历年累计病例数，资料见表7-15的第（1）、（2）栏，问此资料是否服从Poisson分布？（《医学统计学》第三版，孙振球，第七章 卡方检验，例7-13）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">x&lt;-0:6</div><div class="line">y&lt;-c(26,51,75,63,38,17,9)</div><div class="line">mean&lt;-mean(rep(x,y))</div><div class="line">q&lt;-ppois(x,mean)</div><div class="line">n&lt;-length(y)</div><div class="line">p&lt;-c()</div><div class="line">p[1]&lt;-q[1]</div><div class="line">p[n]&lt;-1-q[n-1]</div><div class="line">for(i in 2:(n-1))</div><div class="line">  p[i]&lt;-q[i]-q[i-1]</div><div class="line"></div><div class="line">chisq.test(y, p=p,correct=F)</div></pre></td></tr></table></figure>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/chi27.png">
</div>
<h3 id="案例15-皮尔森拟合优度卡方检验">案例15 皮尔森拟合优度卡方检验</h3>
<p>假设H0：总体具有某分布F 备择假设H1：总体不具有该分布。 我们将数轴分成若干个区间，所抽取的样本会分布在这些区间中。在原假设成立的条件下，我们便知道每个区间包含样本的个数的期望值。用实际值Ni 与期望值Npi可以构造统计量K 。皮尔森证明，n趋向于无穷时，k收敛于m-1的塔防分布。m为我们分组的个数。有了这个分布，我们就可以做假设检验。</p>
<p>某消费者协会为了确定市场上消费者对5咎品牌啤酒的喜好情况，随机抽取了1000名啤酒爱好者作为样本进行如下试验：每个人得到5种品牌的啤酒各一瓶，但未标明牌子。这5种啤酒按分别写着A、B、C、D、E字母的5张纸片随机的顺序送给每一个人，下表是根据样本资料整理得的各种品牌啤酒爱好者的频数分页，试根据这些数据判断消费者对这5种品牌啤酒的爱好有无明显差异？ <img src="http://ortxpw68f.bkt.clouddn.com/chi28.png"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">x &lt;- c(210,312,170,85,223) </div><div class="line">n &lt;- sum(x); m &lt;- length(x) </div><div class="line">p &lt;- rep(1/m,m) </div><div class="line">K &lt;- sum((x-n*p)^2/(n*p)); K #计算出K值 </div><div class="line">p &lt;- 1-pchisq(K,m-1); p #计算出p值</div></pre></td></tr></table></figure>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/chi29.png">
</div>
<p>在R语言中 chisq.test()，可以完成拟合优度检验。默认就是检验是否为均匀分布，如果是其他分布，需要自己分组，并在参数p中指出。上面题目的解法如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">chisq(x)</div></pre></td></tr></table></figure>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/chi30.png">
</div>
<p>同样拒绝原假设。</p>
<h3 id="案例16-检验是否为正态分布">案例16 检验是否为正态分布</h3>
<p>抽取31名学生的成绩，检验是否为正态分布。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">x &lt;- c(25,45,50,54,55,61,64,68,72,75,75,78,79,81,83,84,84,84,85,86,86,86,87,89,89,89,90,91,91,92,100) </div><div class="line">A &lt;- table(cut(x,breaks=c(0,69,79,89,100))) ;A#对样本数据进行分组。 </div><div class="line">p &lt;- pnorm(c(70,80,90,100),mean(x),sd(x)) #获得理论分布的概率值 </div><div class="line">p &lt;- c(p[1],p[2]-p[1],p[3]-p[2],1-p[3]) </div><div class="line">chisq.test(A,p=p)</div></pre></td></tr></table></figure>
<p><img src="http://ortxpw68f.bkt.clouddn.com/chi31.png"> 结果显示，其p值小于0.05，成绩不属于正态分布。</p>
<p>再用shirpo.test()和qq图检验一下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">shapiro.test(x)</div><div class="line">qqnorm(x);qqline(x, col = 2)</div></pre></td></tr></table></figure>
<p><img src="http://ortxpw68f.bkt.clouddn.com/chi32.png"> <img src="http://ortxpw68f.bkt.clouddn.com/chi33.png"></p>
<p>结果显示，p值小于0.05，不是正态分页，并且QQ图明显表示出成绩不符合正态分布。</p>
<h3 id="案例17-检验是否符合原比例">案例17 检验是否符合原比例</h3>
<p>大麦杂交后关于芒性的比例应该是 无芒：长芒：短芒=9:3:4 。我们的实际观测值是335：125：160 。请问观测值是否符合预期？ <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">p &lt;- c(9/16,3/16,4/16) </div><div class="line">x &lt;- c(335,125,160) </div><div class="line">chisq.test(x,p=p)</div></pre></td></tr></table></figure></p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/chi34.png">
</div>
<p>在分组的时候要注意，每组的频数要大于等于5.如果理论分布依赖于多个未知参数，只能先由样本得到参数的估计量。然后构造统计量K，此时K的自由度减少位置参数的数量个。</p>
<h2 id="ks检验">ks检验</h2>
<p>R语言中提供了ks.test()函数，理论上可以检验任何分布。他既能够做单样本检验，也能做双样本检验。</p>
<h3 id="案例18">案例18</h3>
<p>记录一台设备无故障工作时常，并从小到大排序420 500 920 1380 1510 1650 1760 2100 2300 2350。问这些时间是否服从拉姆达=1/1500的指数分布？ <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">x &lt;- c(420,500,920,1380,1510,1650,1760,2100,2300,2350) </div><div class="line">ks.test(x,&quot;pexp&quot;,1/1500)</div></pre></td></tr></table></figure></p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/chi35.png">
</div>
<h3 id="案例19">案例19：</h3>
<p>有两个分布，分别抽样了一些数据，问他们是否服从相同的分布。 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">X&lt;-scan() </div><div class="line">0.61 0.29 0.06 0.59 -1.73 -0.74 0.51 -0.56 0.39 1.64 0.05 -0.06 0.64 -0.82 0.37 1.77 1.09 -1.28 2.36 1.31 1.05 -0.32 -0.40 1.06 -2.47</div><div class="line"></div><div class="line">Y&lt;-scan() </div><div class="line">2.20 1.66 1.38 0.20 0.36 0.00 0.96 1.56 0.44 1.50 -0.30 0.66 2.31 3.29 -0.27 -0.37 0.38 0.70 0.52 -0.71</div><div class="line"></div><div class="line">ks.test(X,Y)</div></pre></td></tr></table></figure></p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/chi36.png">
</div>
<h2 id="参考资料">参考资料</h2>
<ol style="list-style-type: decimal">
<li>http://doctor.51daifu.com/2007/0305/1ADAD919C959T148648.shtml</li>
<li>http://blog.sina.com.cn/s/blog_686dcf990100z9q3.html</li>
<li>http://medstats.blog.163.com/blog/static/17974801620089108192736/</li>
<li>http://blog.sina.com.cn/s/blog_4b361fe00100y222.html</li>
<li>孙振球. 医学统计学[M]. 人民卫生出版社, 2010.</li>
<li>徐俊晓. 统计学与R读书笔记(第六版)</li>
<li>葛毅, 胡良平. 高维列联表资料的统计分析与 SAS 软件实现 (一)[J]. 中西医结合学报, 2009, 7(11): 1086-1089.</li>
<li>http://bbs.pinggu.org/thread-521307-1-1.html↩</li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2017/08/17/实验笔记-质粒构建/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/08/17/实验笔记-质粒构建/" itemprop="url">质粒构建</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-08-17T12:02:00+08:00">
                2017-08-17
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/生物实验笔记/" itemprop="url" rel="index">
                    <span itemprop="name">生物实验笔记</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  0
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  1
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2017/08/11/文献笔记-斑马鱼/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/08/11/文献笔记-斑马鱼/" itemprop="url">斑马鱼</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-08-11T12:00:00+08:00">
                2017-08-11
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/文献笔记/" itemprop="url" rel="index">
                    <span itemprop="name">文献笔记</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  0
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  1
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2017/08/10/实验笔记-cas9/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/08/10/实验笔记-cas9/" itemprop="url">Crispr/Cas9笔记</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-08-10T12:01:00+08:00">
                2017-08-10
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/生物实验笔记/" itemprop="url" rel="index">
                    <span itemprop="name">生物实验笔记</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  3,118
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  12
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="来源">来源</h2>
<p>Crispr/Cas9在微生物中起到的作用就是识别入侵、将病毒的DNA录入自己的基因组，当病毒再次入侵时候，切割病毒DNA、RNA进而消除病毒的感染。CRISPR（Clustered regularly interspaced short palindromic repeats）是生命进化历史上，细菌和病毒进行斗争产生的免疫武器，简单说就是病毒能把自己的基因整合到细菌，利用细菌的细胞工具为自己的基因复制服务，细菌为了将病毒的外来入侵基因清除，进化出CRISPR系统，利用这个细菌免疫系统，细菌地把病毒基因从自己的染色体上切除，这是细菌特有的免疫系统。</p>
<h2 id="原理">原理</h2>
<h3 id="结构">结构</h3>
<p>Crispr技术有两个分子在参与：Cas9核酸酶+sgRNA（自行设计）。其中Cas9核酸酶的基因已经被整合到商业化载体中，只要自行设计sgRNA，然后构建Cas9/sgRNA表达载体，转染细胞，就可以行使基因组的定点基因编辑任务。sgRNA（small-guided RNA）是CRISPR基因敲除敲入系统中重要的组成部分，由两部分组成—tracRNA和crRNA，两部分融合表达后，即sgRNA，与cas9蛋白结合，引导cas9酶靶向基因组DNA进行剪切。示意图如下所示： <img src="http://ortxpw68f.bkt.clouddn.com/cas9%20%281%29.jpg"></p>
<h3 id="各原件作用">各原件作用</h3>
<p>Crispr各原件的组成如下所示： <img src="http://ortxpw68f.bkt.clouddn.com/cas9%20%283%29.png"> CRISPR簇是一个广泛存在于细菌和古生菌基因组中的特殊DNA重复序列家族，其序列由一个<strong>前导区(Leader)</strong>、多个短而高度保守的<strong>重复序列区(Repeat)</strong>和<strong>多个间隔区(Spacer)</strong>组成。</p>
<p>前导区一般位于CRISPR簇上游，是富含AT长度为300～500bp的区域，被认为可能是CRISPR簇的<strong>启动子序列</strong>。</p>
<p>重复序列区长度为21～48bp，含有回文序列，可形成发卡结构。重复序列之间被长度为26～72bp的<strong>间隔区</strong>隔开。</p>
<p>间隔区域由俘获的外源DNA组成，类似免疫记忆，当含有同样序列的外源DNA入侵时，可被细菌机体识别，并进行剪切使之表达沉默，达到保护自身安全的目的。</p>
<h3 id="如何发挥作用">如何发挥作用</h3>
<p>作用示意图如下所示： <img src="http://ortxpw68f.bkt.clouddn.com/cas9%20%285%29.jpg"></p>
<h4 id="阶段-1外源-dna-采集">阶段 1：外源 DNA 采集</h4>
<p>外源核苷酸是通过Cas 蛋白识别，入侵的短片段DNA（30-50个碱基对）被称为protospacers，作为间隔序列插入宿 主CRISPR 位点中，由重复序列隔开。对于I型和II型系统来说，protospacers来自入侵 DNA 中两侧出现2-5 个核酸结构（PAM，protospacer adjacent motif）的区域。一般 protospacers 连接在CRISPR 位点的一端，并且后者通过涉及 Cas1、Cas2 和 游离3’-hydroxyls 等元件的机制，牵引序列。Protospacer 的整合过程中也出现了牵引末端重新序列复制，这可能涉及宿主聚合酶和DNA修复机制。如下所示： <img src="http://ortxpw68f.bkt.clouddn.com/cas9_1.png"></p>
<h4 id="阶段-2crrna-合成">阶段 2：crRNA 合成</h4>
<p>CRISPR RNA 在转录之后，生成初级转录产物：pre-crRNA，之后经过加工，又成为一组短小的 CRISPR衍生RNAs（crRNAs），这些crRNAs 每一个都包含有对应于之前遇到的外源DNA的对应序列。 <img src="http://ortxpw68f.bkt.clouddn.com/cas9_2.png"></p>
<h4 id="阶段-3靶向干扰">阶段 3：靶向干扰</h4>
<p>在pre-crRNA转录的同时，与其重复序列互补的反式激活tracrRNA(Trans-activating crRNA，tracrRNA)也转录出来，并且激发Cas9和双链RNA特异性RNase III核酸酶对pre-crRNA进行加工。加工成熟后，crRNA、tracrRNA和Cas9组成复合体，识别并结合于crRNA互补的序列，然后解开DNA双链，形成R-loop，使crRNA与互补链杂交，另一条链保持游离的单链状态，然后由Cas9中的HNH活性位点剪切crRNA的互补DNA链，RuvC活性位点剪切非互补链，最终引入DNA双链断裂(DSB)。CRISPR／Cas9的剪切位点位于crRNA互补序列下游邻近的PAM区(Protospacer Adjacent Motif)的5’-GG-N18-NGG-3’特征区域中的NGG位点，而这种特征的序列在每128bp的随机DNA序列中就重复出现一次。 <img src="http://ortxpw68f.bkt.clouddn.com/cas9_3.png"></p>
<h4 id="补充cas9解螺旋的过程">补充：cas9解螺旋的过程</h4>
<p>Cas9可以解开DNA，gRNA和target dsDNA配对是在解旋之后所进行（文献为：Sternberg, S. H., et al. (2014). “DNA interrogation by the CRISPR RNA-guided endonuclease Cas9.” Nature 507(7490): 62-67.）。步骤如下：</p>
<ol style="list-style-type: decimal">
<li>gRNA和Cas9形成Cas9:gRNA complex.</li>
<li>这个complex来寻找双链DNA上的PAM位点。因为crisper/cas9源于细菌的防御机制，为了定点清除进入细胞内的“异己DNA而设计”，PAM就是evolutionary conserved关于“异己DNA”的特异标志，所以Cas9需要识别PAM也就不难解释了。现在分子生物学常用的Cas9源自S. Pyogenes这个细菌种属，这种Cas9的特异PAM是5’ NGG(N可以是任何nucleotide)。在人类基因组上GG占5%（每42bp就有一个），因此人的绝大多数基因都在PAM附近，也就意味着几乎所有人的基因都可以被Cas9识别。</li>
<li>当Cas9:gRNA complex识别到PAM的时候，Cas9就会把下游的双链DNA解旋，然后这个complex来根据gRNA的序列“扫描”解旋的DNA，一旦发现和gRNA序列互补的DNA，Cas9就会把DNA切开，完成操作。</li>
</ol>
<p>下图是Doudna那篇paper的原理解释的figure<img src="http://ortxpw68f.bkt.clouddn.com/cas9_4.png"></p>
<h2 id="sgrna的序列特征和设计">SgRNA的序列特征和设计</h2>
<h3 id="sgrna的序列设计原理">SgRNA的序列设计原理</h3>
<p>SgRNA 设计靶序列选择：在NCBI找到该基因CDS区，分析相应的基因组结构，明确CDS的外显子部分。按照基因本身的性质，选择候选的待敲除位点，确定待敲除位点。对于蛋白编码基因，如果该蛋白具重要结构功能域，可考虑将基因敲除位点设计在编码该结构域的外显子。可选择将待敲除位点放在起始密码子ATG后的外显子上。如果被敲除的靶标基因是microRNA或者lncRNA，可以将待敲除位点设计在编码成熟microRNA的外显子或在编码成熟microRNA的外显子的5’和3’侧翼序列。</p>
<p>gRNA设计：通常情况下我们仅需要在你的目的位置附近找到PAM序列：NGG（N代表任意核苷酸），然后找到其紧邻的上游20 nt即可 （如下图所示）。 <img src="http://ortxpw68f.bkt.clouddn.com/cas9.1.1.jpg"></p>
<p>目的位置的选择：我们绝大部分时候的目的是完全敲除一个基因，其原理是利用移码突变（CRISPR/Cas系统诱导产生indel）。</p>
<blockquote>
<p>注：indel全称为insertion，deletion，即插入，缺失，缩写为indel， 插入如下： 生物原始基因序列：ATCGTCGAATCCGGTTG 发生突变基因序列：ATCGTCGAAatcgTCCGGTTG，其中的小写字母atcg为插入的序列，为插入突变；</p>
<p>缺失： 生物原始基因序列：ATCGTCGAAtccgGTTG 发生突变基因序列：ATCGTCGAAGTTG，其中，原始序列里的小写字母tccg为缺失的序列，为缺失突变； 插入和缺失都相对于原始序列来说：缺失指，在原始序列中的某一段丢失；插入指，相对于原始序列在某个位置多了一段序列，即在这个位置插入了一段序列</p>
</blockquote>
<p>因此我们一般选择距离起始密码子ATG下游200bp范围内的exon区域。另外，通常一个基因往往会转录成2个以上的转录本，所以请选择尽量靠近5’端的公共部分，保证每个转录本都会成功移码突变。</p>
<p>通常情况下，为了便于下游KO mutants的鉴定，我们往往可以作如下设计：即Cas9的切割位点刚好被一个酶切位点跨过，且附近至少100 bp内酶切位点唯一（下游的敲除突变也能通过测序的手段来鉴定）。 <img src="http://ortxpw68f.bkt.clouddn.com/cas9.1.2.jpg"></p>
<p>上图的酶切示意图就显示了，敲除突变无法被酶切，而野生型的则能够进行酶切。</p>
<h3 id="sgrna的设计流程">sgRNA的设计流程</h3>
<p>在数据中找到自己的目的序列，通过在线网站设计(http://crispr.mit.edu)来设计要敲除的靶序列，如下所示： <img src="http://ortxpw68f.bkt.clouddn.com/cas9.1.5.jpg"></p>
<p>分析中，显示你所键入的基因序列里有22对可选的guide序列，如下所示。 <img src="http://ortxpw68f.bkt.clouddn.com/cas9.1.6.png"></p>
<p>分析结束，点击Download as genbank查看结果，此时也会收到邮件，如下所示。 <img src="http://ortxpw68f.bkt.clouddn.com/cas9.1.7.png"></p>
<p>单击<code>Download as genbank1</code>，能够查看所有guide序列的评分，如下所示： <img src="http://ortxpw68f.bkt.clouddn.com/cas9.1.9.png"></p>
<blockquote>
<h3>降低脱靶概率原则如下：</h3>
<ol style="list-style-type: decimal">
<li>sgRNA的长度一般应为20 nt左右；</li>
<li>对于sgRNA序列的碱基组成，可选3’末端含GG的sgRNA，同时sgRNA种子序列尽量避免以4个以上的T结尾，GC%含量最佳为40%~60%；</li>
<li>sgRNA在设计网站上的评分越高，越容易脱靶；</li>
<li>如需造成基因knockout，需尽量选择包含有ATG的外显子或靠近ATG的外显子；</li>
<li>检查sgRNA靶向结合位点基因组序列是否存在SNPs；</li>
<li>如采用Cas9单切口，设计paired-gRNA需考虑sgRNA之间的间距；</li>
<li>全基因脱靶效应分析，需考虑脱靶位点最大允许几个错配碱基数，建议最少5个碱基。重点考察种子序列和非种子序列碱基错配数。</li>
</ol>
</blockquote>
<p>通常选择分数较高的Guide序列，以Guide#1序列为例，2条单链oligo的序列如下：oligo1：5’-<strong>caccG</strong>CTGTTTGTGCAGGGCTCCGA -3’； oligo2：5’- <strong>aaac</strong>TCGGAGCCCTGCACAAACAG<strong>c</strong>-3’。加粗部分与经BsmBI酶切后的载体互补配对。BsmBI又名BbsI，它的酶切位点如下所示：<img src="https://www.neb.com/~/media/Catalog/All-Products/8FD67221124342CCB2F58C64960B66EC/Cut%20Site%20Image/BsmB-I-cutsite_1.gif"></p>
<p><strong>注：有关与BsmBI酶切的一些信息</strong> 现在使用Cas9技术时，通常使用的是<a href="https://www.addgene.org/52961/" target="_blank" rel="external">lentiCRISPR v2载体</a>，这个载体中插入外源基因的序列如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/cas9.1.10.png">
</div>
<p>当质粒经过BsmBI酶切后，产生的缺口如下所示： <img src="http://ortxpw68f.bkt.clouddn.com/cas9.1.11.png"></p>
<p>因此，在上述的靶序列中，有一条是5’-CTGTTTGTGCAGGGCTCCGA-3’，它要在两边加上caccG，这个cacc与BsmBI酶切后的gtgg配对，加G是因为这个转录起始位点，必须要加上，如果本身第一个是G，则不需要添加，另一条是5’-TCGGAGCCCTGCACAAACAG-3’，它的两端要加上aaac与gttt配对，其模式如下所示：<img src="http://ortxpw68f.bkt.clouddn.com/cas9.1.12.png"></p>
<h2 id="实验流程">实验流程</h2>
<h3 id="载体构建流程">载体构建流程</h3>
<p><strong>1. Oligo退火形成duplex</strong></p>
<table>
<thead>
<tr class="header">
<th align="left">Component</th>
<th align="center">Volume</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">oligo1</td>
<td align="center">1ul(100uM)</td>
</tr>
<tr class="even">
<td align="left">oligo2</td>
<td align="center">1uL(100uM)</td>
</tr>
<tr class="odd">
<td align="left">H2O</td>
<td align="center">8uL</td>
</tr>
<tr class="even">
<td align="left">total</td>
<td align="center">10uL</td>
</tr>
</tbody>
</table>
<p>PCR仪 95℃ 5 min，缓慢降温至室温1h，1：200稀释duplex。PCR仪 95℃ 5 min，缓慢降温至室温1h，1：200稀释duplex。</p>
<p><strong>2. 质粒酶切</strong></p>
<table>
<thead>
<tr class="header">
<th align="left">Component</th>
<th align="center">Volume</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">lentiCRISPR plasmid</td>
<td align="center">2ug</td>
</tr>
<tr class="even">
<td align="left">BsmBI</td>
<td align="center">1uL</td>
</tr>
<tr class="odd">
<td align="left">10X buffer</td>
<td align="center">2uL</td>
</tr>
<tr class="even">
<td align="left">H2O</td>
<td align="center">X uL</td>
</tr>
<tr class="odd">
<td align="left">total</td>
<td align="center">10 uL</td>
</tr>
</tbody>
</table>
<p><strong>3. 胶回收</strong> 大片段约11kb 回收；小片段约2kb为切下来的filler，不要。</p>
<p><strong>4. 连接</strong></p>
<table>
<thead>
<tr class="header">
<th align="left">Component</th>
<th align="center">Volume</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">T4 DNA ligase</td>
<td align="center">2ug</td>
</tr>
<tr class="even">
<td align="left">5X DNA ligase buffer</td>
<td align="center">1uL</td>
</tr>
<tr class="odd">
<td align="left">digested lentiCRISPR plasmid</td>
<td align="center">2uL</td>
</tr>
<tr class="even">
<td align="left">duplex</td>
<td align="center">6 uL</td>
</tr>
<tr class="odd">
<td align="left">total</td>
<td align="center">10 uL</td>
</tr>
</tbody>
</table>
<p>室温连接4-6h。</p>
<h3 id="病毒包装体系">病毒包装体系</h3>
<table>
<thead>
<tr class="header">
<th align="left">Component</th>
<th align="center">Volume</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">lentiCRISPR v2-gDNA plasmid</td>
<td align="center">4ug</td>
</tr>
<tr class="even">
<td align="left">psPAX2 packaging plasmid</td>
<td align="center">3ug</td>
</tr>
<tr class="odd">
<td align="left">pMD2.G envelope plasmid</td>
<td align="center">1ug</td>
</tr>
</tbody>
</table>
<h3 id="转染">转染</h3>
<p>转染条件与常规的病毒转染相同。</p>
<p>转染48h后，加入puromycin来筛选细胞。</p>
<h3 id="测序">测序</h3>
<p>经puromycin来筛选细胞后的细胞的提取DNA，测序，切割位点处的产生的套峰表示有效编辑的效应为50%，如下所示： <img src="http://ortxpw68f.bkt.clouddn.com/cas9.1.13.png"></p>
<h3 id="单克隆的获取">单克隆的获取</h3>
<p><strong>单克隆的挑取</strong> 可以有限稀释到96-well plate（～30 cells/plate）（293T、HeLa、MEF等细胞系推荐使用）。如果编辑效率50%，推荐分两块plate即可，最终拿到20-30个单克隆一般可以得到成功KO的细胞系；或者铺到100 mm dish里，一周后挑取单克隆（这种方法适合单细胞不容易成活的细胞系如，但是挑取的单克隆偶尔不纯，有时需要重新亚克隆）。</p>
<p><strong>单克隆的鉴定</strong></p>
<p>根据设计，推荐使用酶切鉴定的方法（见设计部分），通量高；如果抗体比较好用，推荐使用WB检测蛋白，这种方法最彻底；最末一种方法就是直接测序鉴定，该种方法费时费力费钱，建议设计时尽量避开。</p>
<p><strong>有限稀释法</strong>（悬浮细胞适用此法）—50-100 cells 均匀分到96-well plate</p>
<h3 id="ko-单克隆的鉴定">KO 单克隆的鉴定</h3>
<p>抽取genomic DNA，然后PCR测序或者或者酶切鉴定</p>
<h2 id="参考资料">参考资料</h2>
<ol style="list-style-type: decimal">
<li><a href="https://mp.weixin.qq.com/s?__biz=MzIwMzA1MzU5Mg==&amp;mid=2652130380&amp;idx=1&amp;sn=bef6d7313ccb3f12be7016ff9a9904b2&amp;chksm=8d35a33bba422a2d5b1b8c584c867f6bc6d58171abcc0ebd9396425548de7fafba56dd4525a6&amp;mpshare=1&amp;scene=1&amp;srcid=0601Rzuo25J14J1qV3dGnt2X#rd" target="_blank" rel="external">CRISPR-Cas9全程实操教程：从gRNA设计到挑单克隆全程指导</a></li>
<li><a href="https://mp.weixin.qq.com/s?__biz=MzI1NjM1MTI5Ng==&amp;mid=2247483920&amp;idx=1&amp;sn=e5ca3f72224f6969a47d045dac524a3d&amp;chksm=ea294f3fdd5ec629922c95bccb834a5de614dea239b2ecb8068f481e025ae713e26bd817bde0&amp;mpshare=1&amp;scene=1&amp;srcid=0601BWh4Ddc7rKy2EQdgQ673#rd" target="_blank" rel="external">CRISPR是啥？有啥用呢？</a></li>
<li><a href="https://mp.weixin.qq.com/s?__biz=MzIwMzA1MzU5Mg==&amp;mid=2652129836&amp;idx=1&amp;sn=6de31effa8067e9ad0aa37cb853730bd&amp;chksm=8d35a55bba422c4db5895861874342c941f0d5328a752d403367f1bc25dcc101157ce0f82a8b&amp;mpshare=1&amp;scene=1&amp;srcid=0601o4qI8nI9LrvSy8MQJuI4#rd" target="_blank" rel="external">一文掌握CRISPR/Cas9系统操作方法，超详细protocol来袭！</a></li>
<li><a href="https://mp.weixin.qq.com/s?__biz=MzA3ODU1NjUyNw==&amp;mid=2652327260&amp;idx=1&amp;sn=7911a3fe8b1bb21585dfd7814487fe07&amp;chksm=84a3115cb3d4984a676eef8095378cdef62129e302a7117df0671cedf5b6fb809a7c26469cbb&amp;mpshare=1&amp;scene=1&amp;srcid=0402E74Gygnekd7PjPsxnYTt#rd" target="_blank" rel="external">CRISPR是什么鬼？</a></li>
<li><a href="http://mp.weixin.qq.com/s?__biz=MzA4OTQ1MTQxNg==&amp;mid=2652035754&amp;idx=3&amp;sn=5199f544cb35d48feceb5afe9756a016&amp;chksm=8bfcc45dbc8b4d4bef6b38762c7ef396e5bece9c3bce93c698ef136430c2b924eb9cbba7b1d7&amp;mpshare=1&amp;scene=1&amp;srcid=1118LOtqMnGmnCvH8AyAqX0F#rd" target="_blank" rel="external">手把手教你搞定 CRISPR/Cas9 系统操作</a></li>
<li><a href="http://mp.weixin.qq.com/s?__biz=MzIwMzA1MzU5Mg==&amp;mid=2652130074&amp;idx=1&amp;sn=f968e2adc98c46d1ed8635137080bccd&amp;chksm=8d35a46dba422d7bc7780de61641534d80ad8339341ef2f5f48ae640a811c0e156c054c087ed&amp;mpshare=1&amp;scene=1&amp;srcid=0308HdSWMpPPvWyUxeKS5NgY#rd" target="_blank" rel="external">一文掌握gRNA的设计，常用方法汇总解析</a></li>
<li><a href="http://mp.weixin.qq.com/s?__biz=MzIwMzA1MzU5Mg==&amp;mid=2652130160&amp;idx=1&amp;sn=75d4973ba598a18ec83a7ac16a40aeea&amp;chksm=8d35a407ba422d119dd11efe3e1d8b920a9952953b8d9ec7a3b4bbe4dc4cc714c50247fd2e18&amp;mpshare=1&amp;scene=1&amp;srcid=1215mEkQv3xNCdRr7Nr4btVZ#rd" target="_blank" rel="external">手把手教你利用CRISPR-Cas9系统精准敲除靶标基因</a></li>
<li><a href="https://mp.weixin.qq.com/s?__biz=MzI0NzExMTg0NQ==&amp;mid=2649394829&amp;idx=1&amp;sn=2455a14b541c3c1ee193e933b5a63d36&amp;mpshare=1&amp;scene=1&amp;srcid=0308tQUjqA03Kq46VpXqJuEv#rd" target="_blank" rel="external">白友“冰糖”分享：CRISPR/Cas9系统操作实例</a></li>
<li><a href="https://mp.weixin.qq.com/s?__biz=MzI0NzExMTg0NQ==&amp;mid=2649394843&amp;idx=1&amp;sn=1199decf9215e2e93e471fcf7baec00f&amp;mpshare=1&amp;scene=1&amp;srcid=1012EzBZX1Z6UqfvCCQxH827#rd" target="_blank" rel="external">CRISPR/Cas9系统操作实例分享之二：LentiCRISPR v2</a></li>
<li><a href="https://mp.weixin.qq.com/s?__biz=MzA4OTQ1MTQxNg==&amp;mid=2652034666&amp;idx=1&amp;sn=4915148f19dc76e2f7c9e8aa29a58228&amp;scene=1&amp;srcid=06256AxjFUm6DsklabrlylIN#rd" target="_blank" rel="external">手把手教你搞定 CRISPR/Cas9 系统操作</a></li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2017/07/06/病毒包装笔记(6)-病毒包装问题收集/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/07/06/病毒包装笔记(6)-病毒包装问题收集/" itemprop="url">病毒包装笔记(6)-病毒包装问题收集</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-07-06T12:02:00+08:00">
                2017-07-06
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/生物实验笔记/" itemprop="url" rel="index">
                    <span itemprop="name">生物实验笔记</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  352
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  1
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <ol style="list-style-type: decimal">
<li><p>慢病毒如何保存？ 答 ：慢病毒可在-80°C条件下保存6个月，滴度不会出现明显下降，但如果保存时间超过6<sub>12月，滴度可能降至原来十分一，使用前请重新测病毒滴度。慢病毒应避免反复冻融，冻融一次病毒滴度会下降20</sub>50%以上，甚至更多。建议不要在-20°C下长期保存慢病毒；如果冻融后需于短期内（一周以内）使用，建议置于4°C保存；若在4°C保存超过一周，病毒滴度会下降5倍以上。</p></li>
<li><p>从负80度中取出的病毒如何解冻？ 答 ：冰上溶解-80 °C取出的慢病毒。如需稀释病毒，可加入适当比例的PBS（PH7.4）或培养基（ph7.2），混匀分装后 4 °C保存，并最好当天用完。操作时用枪头吸取慢病毒时，应尽量避免慢病毒暴露于空气中，避免起泡。</p></li>
<li><p>病毒的单位是什么？ 答：病毒的单位是TU/ml，即每毫升中含有具有生物活性的病毒颗粒数。如： 病毒滴度为&gt;1×10e8 TU/ml，即每毫升病毒液中至少含有1×10e8个具有生物活性的慢病毒颗粒。</p></li>
<li><p>慢病毒感染时培养基体积与正常培养体积是多少？ 答：如下所示： <img src="http://ortxpw68f.bkt.clouddn.com/virus%20volume.png"></p></li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">RVDSD</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">24</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">6</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">26</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          <div class="links-of-author motion-element">
            
          </div>

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

<div class="copyright">&copy; <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">RVDSD</span>

  
</div>



<div class="powered-by">
<i class="fa fa-user-md"></i><span id="busuanzi_container_site_uv">
  本站访客数:<span id="busuanzi_value_site_uv"></span>
</span>
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.3</div>




<div class="theme-info">
  <div class="powered-by"></div>
  <span class="post-count">博客全站共50.6k字</span>
</div>

        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.3"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.3"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.3"></script>



  


  




	





  





  












  





  

  

  
  

  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config("");
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="custom_mathjax_source">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->
  


  

  

</body>
</html>
