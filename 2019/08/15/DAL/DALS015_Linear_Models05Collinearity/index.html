<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.3" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.3">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.3" color="#222">





  <meta name="keywords" content="线性模型,矩阵计算," />










<meta name="description" content="前言 这一部分是《Data Analysis for the life sciences》的第5章线性模型的第5小节，这一部分的主要内容涉及矩阵的共线性(Co-linearity)，秩(rank)，QR分解，有关共线性和秩的笔记R markdown文档可以参考作者的Github，QR分解见另外一篇。 共线性(Co-linearity) 如果一个实验设计不合理，那么我们就无法对目标参数进行估计">
<meta name="keywords" content="线性模型,矩阵计算">
<meta property="og:type" content="article">
<meta property="og:title" content="DALS015-Linear Models线性模型05共线性">
<meta property="og:url" content="http://rvdsd.top/2019/08/15/DAL/DALS015_Linear_Models05Collinearity/index.html">
<meta property="og:site_name" content="RVDSD的个人笔记本">
<meta property="og:description" content="前言 这一部分是《Data Analysis for the life sciences》的第5章线性模型的第5小节，这一部分的主要内容涉及矩阵的共线性(Co-linearity)，秩(rank)，QR分解，有关共线性和秩的笔记R markdown文档可以参考作者的Github，QR分解见另外一篇。 共线性(Co-linearity) 如果一个实验设计不合理，那么我们就无法对目标参数进行估计">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190826133645.jpeg">
<meta property="og:updated_time" content="2019-11-06T01:39:20.968Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="DALS015-Linear Models线性模型05共线性">
<meta name="twitter:description" content="前言 这一部分是《Data Analysis for the life sciences》的第5章线性模型的第5小节，这一部分的主要内容涉及矩阵的共线性(Co-linearity)，秩(rank)，QR分解，有关共线性和秩的笔记R markdown文档可以参考作者的Github，QR分解见另外一篇。 共线性(Co-linearity) 如果一个实验设计不合理，那么我们就无法对目标参数进行估计">
<meta name="twitter:image" content="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190826133645.jpeg">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.3',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://rvdsd.top/2019/08/15/DAL/DALS015_Linear_Models05Collinearity/"/>





  <title>DALS015-Linear Models线性模型05共线性 | RVDSD的个人笔记本</title><!-- hexo-inject:begin --><!-- hexo-inject:end -->
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">RVDSD的个人笔记本</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2019/08/15/DAL/DALS015_Linear_Models05Collinearity/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">DALS015-Linear Models线性模型05共线性</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-08-15T12:00:00+08:00">
                2019-08-15
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Data-Analysis-for-the-life-sciences/" itemprop="url" rel="index">
                    <span itemprop="name">Data Analysis for the life sciences</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  4,113
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  18
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h2 id="前言">前言</h2>
<p>这一部分是《Data Analysis for the life sciences》的第5章线性模型的第5小节，这一部分的主要内容涉及矩阵的共线性(Co-linearity)，秩(rank)，QR分解，有关共线性和秩的笔记R markdown文档可以参考作者的<a href="https://github.com/genomicsclass/labs/blob/master/linear/collinearity.Rmd" target="_blank" rel="external">Github</a>，QR分解见<a href="https://github.com/genomicsclass/labs/blob/master/linear/qr_and_regression.Rmd" target="_blank" rel="external">另外一篇</a>。</p>
<h2 id="共线性co-linearity">共线性(Co-linearity)</h2>
<p>如果一个实验设计不合理，那么我们就无法对目标参数进行估计。同样，当我们分析数据时，不合理地使用一个模型时也会得错误的结论。我们使用线性模型时，通过检查设计矩阵的共线性(collinearity)就能从数学角度来考虑我们选择的这个模型是否合理。</p>
<h2 id="方程组案例">方程组案例</h2>
<p>我们来看一个方程组，如下所示： <span class="math display">\[
\begin{align*}
a+c &amp;=1\\
b-c &amp;=1\\
a+b &amp;=2
\end{align*}
\]</span> 这个方程就不止一个解，因为有无数组数据满足<code>a=1-c</code>，<code>b=1+c</code>。例如<code>a=1, b=1, c=0</code>和<code>a=0,b=c,c=1</code>。</p>
<h2 id="矩阵代数方法">矩阵代数方法</h2>
<p>现在我们使用矩阵来说明一下上面的情况，上面的方程组我们写成矩阵形式如下所示： <span class="math display">\[
\,
\begin{pmatrix}
1&amp;0&amp;1\\
0&amp;1&amp;-1\\
1&amp;1&amp;0\\
\end{pmatrix}
\begin{pmatrix}
a\\
b\\
c
\end{pmatrix}
=
\begin{pmatrix}
1\\
1\\
2
\end{pmatrix}
\]</span> 从矩阵中我们可以发现，其实矩阵的第3列就是第1列和第2列的线性组合，如下所示： <span class="math display">\[
\,
\begin{pmatrix}
1\\
0\\
1
\end{pmatrix}
+
-1 \begin{pmatrix}
0\\
1\\
1
\end{pmatrix}
=
\begin{pmatrix}
1\\
-1\\
0
\end{pmatrix}
\]</span> 因此，我们可以说第3列与前2列共线性(collinear)，这也就是说，我们可以将上面的矩阵写成下面的这个形式： <span class="math display">\[
\,
\begin{pmatrix}
1&amp;0&amp;1\\
0&amp;1&amp;-1\\
1&amp;1&amp;0
\end{pmatrix}
\begin{pmatrix}
a\\
b\\
c
\end{pmatrix}
=
a
\begin{pmatrix}
1\\
0\\
1
\end{pmatrix}
+
b \begin{pmatrix}
0\\
1\\
1
\end{pmatrix}
+
c
\begin{pmatrix}
1-0\\
0-1\\
1-1
\end{pmatrix}
\]</span></p>
<p><span class="math display">\[
=(a+c)
\begin{pmatrix}
1\\
0\\
1\\
\end{pmatrix}
+
(b-c)
\begin{pmatrix}
0\\
1\\
1\\
\end{pmatrix}
\]</span></p>
<p>新的矩阵也就说明了，第3列其实没什么用，我们真正有的是3个方程和2个未知数，即<code>a+c</code>和<code>b+c</code>。一旦我们得到了这两个量（即<code>a+c</code>和<code>b+c</code>），那么<code>a, b, c</code>这个未知数就有无数种解。</p>
<h2 id="共线性和最小平方">共线性和最小平方</h2>
<p>现在我们考虑一个设计矩阵<span class="math inline">\(\mathbf{X}\)</span>，这个矩阵含有2个共线性列。我们创建一个极端的例子，在这个例子中，有两列互为相反，如下所示： <span class="math display">\[
\mathbf{X} = \begin{pmatrix}
\mathbf{1}&amp;\mathbf{X}_1&amp;\mathbf{X}_2&amp;\mathbf{X}_3\\
\end{pmatrix}
\mbox{ with, say, }
\mathbf{X}_3 = - \mathbf{X}_2
\]</span> 这就意味着，我们可以把上面的矩阵写为如下形式： <span class="math display">\[
\mathbf{Y}- \left\{ \mathbf{1}\beta_0 + \mathbf{X}_1\beta_1 + \mathbf{X}_2\beta_2 + \mathbf{X}_3\beta_3\right\}\\ 
= \mathbf{Y}- \left\{ \mathbf{1}\beta_0 + \mathbf{X}_1\beta_1 + \mathbf{X}_2\beta_2 - \mathbf{X}_2\beta_3\right\}\\
= \mathbf{Y}- \left\{\mathbf{1}\beta_0 + \mathbf{X}_1 \beta_1 + \mathbf{X}_2(\beta_2  - \beta_3)\right\}
\]</span></p>
<p>如果<span class="math inline">\(\hat{\beta}_1\)</span>, <span class="math inline">\(\hat{\beta}_2\)</span>, <span class="math inline">\(\hat{\beta}_3\)</span> 是一个最小平方解(least squares solution)，那么，例如<span class="math inline">\(\hat{\beta}_1\)</span>, <span class="math inline">\(\hat{\beta}_2+1\)</span>, <span class="math inline">\(\hat{\beta}_3+1\)</span>也是一个解。</p>
<h2 id="混淆confounding案例分析">混淆(confounding)案例分析</h2>
<p>现在我们将演示一下共线性是如何帮助我们解决当前实验设计中最常见的错误之一的：混淆(confounding)。 为了说明这个问题。现在我们设想一个实验，例如我们感兴趣的是四种处理因素，即A，B，C和D。我们给每种处理因素分配2只小鼠。当我们给A、B处理分配的是雌性小鼠后，我们意识到性别(sex)有可能对实验造成影响。我们决定给C和D两组雄性小鼠，从而估计性别对实验的影响。但是，通过这种方式我们能否估计出性别的影响呢，这个实验我们表示为矩阵形式，则如下所示： <span class="math display">\[
\,
\begin{pmatrix}
Sex &amp; A &amp; B &amp; C &amp; D\\
0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 \\
1 &amp; 0 &amp; 0 &amp; 1 &amp; 0 \\
1 &amp; 0 &amp; 0 &amp; 1 &amp; 0 \\
1 &amp; 0 &amp; 0 &amp; 0 &amp; 1 \\
1 &amp; 0 &amp; 0 &amp; 0 &amp; 1\\
\end{pmatrix}
\]</span> 在这个矩阵里，我们可以看到处理因素与性别产生了混淆(confound)，尤其是，性别这一列可以用C列和D列进行表示（也就是说共线性），如下所示： <span class="math display">\[
\,
\begin{pmatrix}
Sex \\
0\\
0 \\
0 \\
0 \\
1\\
1\\
1 \\
1 \\
\end{pmatrix}
=
\begin{pmatrix}
C \\
0\\
0\\
0\\
0\\
1\\
1\\
0\\
0\\
\end{pmatrix}
+
\begin{pmatrix}
D \\
0\\
0\\
0\\
0\\
0\\
0\\
1\\
1\\
\end{pmatrix}
\]</span> 这就说明了，无法使用最小平方和来对实验结果进行计算。</p>
<h2 id="秩rank">秩(rank)</h2>
<p>一个矩阵的秩(rank)表示的是，矩阵中独立于其他列的数目。如果矩阵的秩小于列的数目，那么LSE则不唯一。在R中，我们可以使用<code>qr()</code>函数来获取一个矩阵的秩，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">Sex &lt;- c(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>)</div><div class="line">A &lt;- c(<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>)</div><div class="line">B &lt;- c(<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>)</div><div class="line">C &lt;- c(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>)</div><div class="line">D &lt;- c(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>)</div><div class="line">X &lt;- model.matrix(~Sex+A+B+C+D-<span class="number">1</span>)</div><div class="line">cat(<span class="string">"ncol="</span>,ncol(X),<span class="string">"rank="</span>, qr(X)$rank,<span class="string">"\n"</span>)</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ncol= <span class="number">5</span> rank= <span class="number">4</span></div></pre></td></tr></table></figure>
<h2 id="移除混淆">移除混淆</h2>
<p>前面我们提到的那个实验可以设计得更加完全。使用相同数量的雄性小鼠和雌性小鼠可以很容易设计一个实验来研究性别影响与干预影响。具体来说就是，当我们平衡了性别与干预后，混淆就会被消除，也就是说，通过一定的合理实验设计，就是使秩与列的数目相同，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">Sex &lt;- c(<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>)</div><div class="line">A &lt;- c(<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>)</div><div class="line">B &lt;- c(<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>)</div><div class="line">C &lt;- c(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>)</div><div class="line">D &lt;- c(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>)</div><div class="line">X &lt;- model.matrix(~Sex+A+B+C+D-<span class="number">1</span>)</div><div class="line">cat(<span class="string">"ncol="</span>,ncol(X),<span class="string">"rank="</span>, qr(X)$rank,<span class="string">"\n"</span>)</div></pre></td></tr></table></figure>
<p>计算结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ncol= <span class="number">5</span> rank= <span class="number">5</span></div></pre></td></tr></table></figure>
<h2 id="练习">*练习</h2>
<p>P237</p>
<h2 id="矩阵的qr分解">矩阵的QR分解</h2>
<p>这一部分的R markdown参考文档见<a href="https://github.com/genomicsclass/labs/blob/master/linear/qr_and_regression.Rmd" target="_blank" rel="external">Github</a>。</p>
<p>前面我们已经了解到了通过逆转一个矩阵来计算LSE，前面使用了<code>solve()</code>函数。但是，这并非是一种稳定的解决方式方式。当我们进行LSE计算时，可以使用QR分解。</p>
<h2 id="逆转">逆转</h2>
<p>为了使RSS最小： <span class="math display">\[
(\mathbf{Y}-\mathbf{X}\boldsymbol{\beta})^\top
(\mathbf{Y}-\mathbf{X}\boldsymbol{\beta})
\]</span> 我们需要解下面方程： <span class="math display">\[
\mathbf{X}^\top \mathbf{X} \boldsymbol{\hat{\beta}} = \mathbf{X}^\top \mathbf{Y}
\]</span> 解为： <span class="math display">\[
\boldsymbol{\hat{\beta}} = (\mathbf{X}^\top \mathbf{X})^{-1} \mathbf{X}^\top \mathbf{Y}
\]</span> 因此，我们需要计算<span class="math inline">\((\mathbf{X}^\top \mathbf{X})^{-1}\)</span></p>
<p>这个解在数学上是不稳定的(solve is numerically unstable)。</p>
<p>为了说明什么叫<code>在数学上是不稳定的</code>，我们来看下面的代码：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">n &lt;- <span class="number">50</span>;M &lt;- <span class="number">500</span></div><div class="line">x &lt;- seq(<span class="number">1</span>,M,len=n)</div><div class="line">X &lt;- cbind(<span class="number">1</span>,x,x^<span class="number">2</span>,x^<span class="number">3</span>)</div><div class="line">colnames(X) &lt;- c(<span class="string">"Intercept"</span>,<span class="string">"x"</span>,<span class="string">"x2"</span>,<span class="string">"x3"</span>)</div><div class="line">beta &lt;- matrix(c(<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>),<span class="number">4</span>,<span class="number">1</span>)</div><div class="line">set.seed(<span class="number">1</span>)</div><div class="line">y &lt;- X%*%beta+rnorm(n,sd=<span class="number">1</span>)</div><div class="line">solve(crossprod(X)) %*% crossprod(X,y)</div></pre></td></tr></table></figure>
<p>运行后就出错了，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&gt; solve(crossprod(X)) %*% crossprod(X,y)</div><div class="line">Error <span class="keyword">in</span> solve.default(crossprod(X)) : </div><div class="line">  system is computationally singular: reciprocal condition number = <span class="number">2.93617e-17</span></div></pre></td></tr></table></figure>
<p>现在我们来看一下为什么会出现这种错误，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">options(digits=<span class="number">4</span>)</div><div class="line">log10(crossprod(X))</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">&gt; options(digits=<span class="number">4</span>)</div><div class="line">&gt; log10(crossprod(X))</div><div class="line">          Intercept      x     x2     x3</div><div class="line">Intercept     <span class="number">1.699</span>  <span class="number">4.098</span>  <span class="number">6.625</span>  <span class="number">9.203</span></div><div class="line">x             <span class="number">4.098</span>  <span class="number">6.625</span>  <span class="number">9.203</span> <span class="number">11.810</span></div><div class="line">x2            <span class="number">6.625</span>  <span class="number">9.203</span> <span class="number">11.810</span> <span class="number">14.434</span></div><div class="line">x3            <span class="number">9.203</span> <span class="number">11.810</span> <span class="number">14.434</span> <span class="number">17.070</span></div></pre></td></tr></table></figure>
<p>这里我们要注意一下数量级的差异。常用的数字计算机储存的数字范围有限。 当我们要要考虑使用非常大的数字时，这会使一些数字看起来像0。 这反过来又会导致由0划分导致的错误划分（原文是：This in turn leads to divisions that are practically divisions by 0 errors）。</p>
<h2 id="分解factorization">分解(factorization)</h2>
<p>QR分解是基于一种数学结果，它能告诉我们可以分解任意的全秩(any full rank)的<span class="math inline">\(N \times p\)</span>矩阵<span class="math inline">\(\mathbf{X}\)</span>，如下所示： <span class="math display">\[
\mathbf{X}=\mathbf{QR}
\]</span> 其中：</p>
<ul>
<li><span class="math inline">\(\mathbf{X}\)</span>是一个<span class="math inline">\(N \times p\)</span>矩阵，<span class="math inline">\(\mathbf{Q}^{T}\mathbf{Q}=I\)</span></li>
<li><span class="math inline">\(\mathbf{R}\)</span>是一个<span class="math inline">\(p \times p\)</span>矩阵，上三角矩阵。</li>
</ul>
<p>上三角矩阵在解方程组方面非常有用。</p>
<h3 id="什么是上三角矩阵">什么是上三角矩阵</h3>
<p>在下面的案例中，最左边的就是上三角矩阵：上三角矩阵的特点就是，矩阵对角线的左下方都是0，右上方不为零，根据矩阵的运算规则，这就很容易解方程组，如下所示： <span class="math display">\[
\,
\begin{pmatrix}
1&amp;2&amp;-1\\
0&amp;1&amp;2\\
0&amp;0&amp;1\\
\end{pmatrix}
\begin{pmatrix}
a\\
b\\
c\\
\end{pmatrix}
=
\begin{pmatrix}
6\\
4\\
1\\
\end{pmatrix}
\]</span> 从上面的形式我们就能马上看出来，<span class="math inline">\(c=1, b + 2 = 4, a = 3\)</span>。</p>
<h3 id="利用qr来计算lse">利用QR来计算LSE</h3>
<p>如果我们重新使用<span class="math inline">\(\mathbf{QR}\)</span>来替代<span class="math inline">\(\mathbf{X}\)</span>来写LSE的公式，则如下所示：</p>
<p><span class="math display">\[
\mathbf{X}^\top \mathbf{X} \boldsymbol{\beta} = \mathbf{X}^\top \mathbf{Y}
\]</span></p>
<p><span class="math display">\[
(\mathbf{Q}\mathbf{R})^\top (\mathbf{Q}\mathbf{R}) \boldsymbol{\beta} = (\mathbf{Q}\mathbf{R})^\top \mathbf{Y}
\]</span></p>
<p><span class="math display">\[
\mathbf{R}^\top (\mathbf{Q}^\top \mathbf{Q}) \mathbf{R} \boldsymbol{\beta} = \mathbf{R}^\top \mathbf{Q}^\top \mathbf{Y}
\]</span></p>
<p><span class="math display">\[
\mathbf{R}^\top \mathbf{R} \boldsymbol{\beta} = \mathbf{R}^\top \mathbf{Q}^\top \mathbf{Y}
\]</span></p>
<p><span class="math display">\[
(\mathbf{R}^\top)^{-1} \mathbf{R}^\top \mathbf{R} \boldsymbol{\beta} = (\mathbf{R}^\top)^{-1} \mathbf{R}^\top \mathbf{Q}^\top \mathbf{Y}
\]</span></p>
<p><span class="math display">\[
\mathbf{R} \boldsymbol{\beta} = \mathbf{Q}^\top \mathbf{Y}
\]</span></p>
<p>其中，<span class="math inline">\(\mathbf{R}\)</span>是上三角矩阵，它能够更加稳定地求出LSE。此外，由于<span class="math inline">\(\mathbf{Q}^T\mathbf{Q}=\mathbf{I}\)</span>，我们知道<span class="math inline">\(\mathbf{Q}\)</span>的列能够稳定右侧（这一段不太懂，原文：we know that the columns of Q are in the same scale which stabilizes the right side)。</p>
<p>现在我们就可以通过QR分解来计算LSE了，也就是解下面的这个方程：</p>
<p><span class="math display">\[
\mathbf{R} \boldsymbol{\beta} = \mathbf{Q}^\top \mathbf{Y}
\]</span></p>
<p>在R中我们使用<code>backsolve()</code>函数来角这个方程，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">QR &lt;- qr(X)</div><div class="line">Q &lt;- qr.Q( QR )</div><div class="line">R &lt;- qr.R( QR )</div><div class="line">(betahat &lt;- backsolve(R, crossprod(Q,y) ) )</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">&gt; QR &lt;- qr(X)</div><div class="line">&gt; Q &lt;- qr.Q( QR )</div><div class="line">&gt; R &lt;- qr.R( QR )</div><div class="line">&gt; (betahat &lt;- backsolve(R, crossprod(Q,y) ) )</div><div class="line">          [,<span class="number">1</span>]</div><div class="line">[<span class="number">1</span>,] <span class="number">0.9038372</span></div><div class="line">[<span class="number">2</span>,] <span class="number">1.0066440</span></div><div class="line">[<span class="number">3</span>,] <span class="number">0.9999622</span></div><div class="line">[<span class="number">4</span>,] <span class="number">1.0000001</span></div></pre></td></tr></table></figure>
<p>实际上，R中有内置函数<code>solve.qr()</code>也能实现此功能，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">QR &lt;- qr(X)</div><div class="line">(betahat &lt;- solve.qr(QR, y))</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">&gt; QR &lt;- qr(X)</div><div class="line">&gt; (betahat &lt;- solve.qr(QR, y))</div><div class="line">               [,<span class="number">1</span>]</div><div class="line">Intercept <span class="number">0.9038372</span></div><div class="line">x         <span class="number">1.0066440</span></div><div class="line">x2        <span class="number">0.9999622</span></div><div class="line">x3        <span class="number">1.0000001</span></div></pre></td></tr></table></figure>
<h3 id="拟合值">拟合值</h3>
<p>这种分解过程也能简化拟合值的计算，如下所示： <span class="math display">\[
\mathbf{X}\boldsymbol{\hat{\beta}} = 
(\mathbf{QR})\mathbf{R}^{-1}\mathbf{Q}^\top \mathbf{y}= \mathbf{Q}\mathbf{Q}^\top\mathbf{y}
\]</span></p>
<p>在R中，计算如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">library</span>(rafalib)</div><div class="line">mypar(<span class="number">1</span>,<span class="number">1</span>)</div><div class="line">plot(x,y)</div><div class="line">fitted &lt;- tcrossprod(Q)%*%y</div><div class="line">lines(x,fitted,col=<span class="number">2</span>)</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190826133645.jpeg">

</div>
<h3 id="标准误">标准误</h3>
<p>如果要计算LSE的标准误，需要考虑如下公式：</p>
<p><span class="math display">\[
(\mathbf{X^\top X})^{-1} = (\mathbf{R^\top Q^\top QR})^{-1} = (\mathbf{R^\top R})^{-1}
\]</span> 使用<code>chol12inv()</code>函数是专门用于计算这个逆矩阵的，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">df &lt;- length(y) - QR$rank</div><div class="line">sigma2 &lt;- sum((y-fitted)^<span class="number">2</span>)/df</div><div class="line">varbeta &lt;- sigma2*chol2inv(qr.R(QR))</div><div class="line">SE &lt;- sqrt(diag(varbeta))</div><div class="line">cbind(betahat,SE)</div><div class="line">summary(lm(y~<span class="number">0</span>+X))$coef</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">&gt; cbind(betahat,SE)</div><div class="line">                              SE</div><div class="line">Intercept <span class="number">0.9038372</span> <span class="number">4.508440e-01</span></div><div class="line">x         <span class="number">1.0066440</span> <span class="number">7.858164e-03</span></div><div class="line">x2        <span class="number">0.9999622</span> <span class="number">3.661705e-05</span></div><div class="line">x3        <span class="number">1.0000001</span> <span class="number">4.802429e-08</span></div><div class="line">&gt; summary(lm(y~<span class="number">0</span>+X))$coef</div><div class="line">            Estimate   Std. Error      t value      Pr(&gt;|t|)</div><div class="line">XIntercept <span class="number">0.9038372</span> <span class="number">4.508440e-01</span> <span class="number">2.004767e+00</span>  <span class="number">5.089408e-02</span></div><div class="line">Xx         <span class="number">1.0066440</span> <span class="number">7.858164e-03</span> <span class="number">1.281017e+02</span>  <span class="number">2.171355e-60</span></div><div class="line">Xx2        <span class="number">0.9999622</span> <span class="number">3.661705e-05</span> <span class="number">2.730865e+04</span> <span class="number">1.745091e-167</span></div><div class="line">Xx3        <span class="number">1.0000001</span> <span class="number">4.802429e-08</span> <span class="number">2.082280e+07</span> <span class="number">4.558613e-300</span></div></pre></td></tr></table></figure>
<h2 id="其它线性模型">其它线性模型</h2>
<p>这一部分的参考R markdown文档见<a href="https://github.com/genomicsclass/labs/blob/master/linear/linear_models_going_further.Rmd" target="_blank" rel="external">Github</a>。</p>
<p>线性模型的用途使用非常广，并且它还可以扩展到其它方面，后面就介绍一些线性模型的拓展。</p>
<h3 id="稳健线性模型robust-linear-models">稳健线性模型(Robust linear models)</h3>
<p>在标准线性模型里，我们在计算它的解以及估计误差时，我们通常会通过计算最小平方误差来实现目标。这就涉及所有点的平方和，同时，这也表明，一旦数据中存在着异常值，那么这些异常值就会对计算结果产生重要的影响。此外，我们在使用线性模型时，我们是假定误差是恒定的（也就是同方差性，或齐方差性，homoskedasticity），不过在实际运用过程中，这种假设并非总成立（如果误差不剂，我们称为异方差性，heteroskedasticity）。因此需要其它一些方法用于产生稳健的解决方案，这些新的方法可以很好地处理异常值，或者是当我们的假设（也是同方差时）不满足时，这些模型也能很好地实现目的。在R的官网上，有介绍这些方差的内容<a href="https://cran.r-project.org/web/views/Robust.html" target="_blank" rel="external">《CRAN Task View: Robust Statistical Methods》</a>。</p>
<h3 id="广义线性模型generalized-linear-modelsglm">广义线性模型(Generalized linear models,GLM)</h3>
<p>在标准线性模型里，我们对<span class="math inline">\(\mathbf{Y}\)</span>的分布没做任何假设，但是在某些情况下，如果我们知道了<span class="math inline">\(\mathbf{Y}\)</span>，例如<span class="math inline">\(\mathbf{Y}\)</span>仅限于非负整数 <span class="math inline">\(0,1,2,\dots\)</span>，或者是限于区间<span class="math inline">\([0,1]\)</span>。用于分析这类情况的框架被称为广义线性模型，通常缩写为GLMs。GLM的两个关键组成部分就是链接函数与概率分布。链接函数<span class="math inline">\(g\)</span>会通常以下方式将我们熟悉的矩阵乘积 <span class="math inline">\(\mathbf{X} \boldsymbol{\beta}\)</span> 与<span class="math inline">\(\mathbf{Y}\)</span>值链接起来：</p>
<p><span class="math display">\[
\textrm{E}(\mathbf{Y}) = g^{-1}( \mathbf{X} \boldsymbol{\beta} )
\]</span></p>
<p>在R中，使用<code>glm()</code>函数来拟合GLMs，并使用与<code>lm()</code>函数类似的形式来进行计算。其它的参数还包括<code>family</code>，它用于指定<span class="math inline">\(\mathbf{Y}\)</span>的分布假设。在<a href="https://www.statmethods.net/advstats/glm.html" target="_blank" rel="external">QuickR</a>网站上，我们可以看到很多GLM的使用案例。</p>
<h3 id="混合效应线性模型mixed-effects-linear-models">混合效应线性模型(Mixed effects linear models)</h3>
<p>在标准线性模型里，我们假设矩阵<span class="math inline">\(\mathbf{X}\)</span>是固定的(fixed)，并不随机。例如，我们检测了每对腿的摩擦系数，以及push和pull方向。在<span class="math inline">\(\mathbf{X}\)</span>矩阵中，如果在特定的列中含有1，那么这1列就不是随机的，而是由设计矩阵决定的。但是在父子高度的案例中，我们并没有固定父亲身高的数值，而是观察到了这些值（通过一些误差来对抽样数据进行检测）。用于研究<span class="math inline">\(\mathbf{X}\)</span>中各个列的随机性影响的框架被称为混合效应模型，这就意味着一些效应是固定的，一些是效应是随机的。R中用于拟合线性模型的一个包是<code>lme4</code>，这个包还发了相应的论文《 Fitting Linear Mixed-Effects Models using lme4》。</p>
<h3 id="贝叶斯线性模型bayesian-linear-models">贝叶斯线性模型(Bayesian linear models)</h3>
<p>这种方法呈现的是假设<span class="math inline">\(\beta\)</span>是一个固定参数（非随机）。我们提取了估计此参数的方法，以及估计过程中如何量化这些参数不确定性的标准误差。这种方法是就所谓的频率论方法(frequentist)。另一种方法是假设<span class="math inline">\(\beta\)</span>是随机的，它的分布可以对我们先前关于<span class="math inline">\(\beta\)</span>应该是什么进行量化。一旦我们观察到数据，那么我们通过计算给定数据的<span class="math inline">\(\beta\)</span>条件分布（称为后验分布,posterior)，我们就就更新我们先前的信息，这种方法称贝叶斯方法。例如，一旦我们计算了<span class="math inline">\(\beta\)</span>的后验分布，我们就可以计算出某事件最容易发生的一个区间（可信区间）。此外，许多模型可以连接在一起，也就是所谓的分层模型(hierarchical mode)。在后面的内容里，我们会介绍贝叶斯统计和层次模型。贝叶斯分层模型的一本很好的书是<a href="http://www.stat.columbia.edu/~gelman/book/" target="_blank" rel="external">《Bayesian Data Analysis》</a>，在CRAN里，也有计算贝叶斯线性模型的包。其它的一些计算贝叶斯模型的软件是stan和BUGS。</p>
<h3 id="惩罚线性模型penalized-linear-models">惩罚线性模型(Penalized linear models)</h3>
<p>如果我们在模型中包含足够的参数，我们就可以实现残差平方和为0。惩罚纯情模型引入了一个惩罚项到最小化的最小二乘方程里。这些惩罚项通常是<span class="math inline">\(\lambda \sum_{j=1}^p \|\beta_j\|^k\)</span>这个形式，它们对大的绝对值以及大量的参数进行惩罚。添加这个额外的参数的目的就是避免过拟合。如果要使用这些模型，我们需要选择使用哪种模式来决定我们的惩罚程度。当<span class="math inline">\(k=2\)</span>时，这种模型称为岭回归(ridge regression)，Tikhonov正则化(regularization)L2正则化。当<span class="math inline">\(k=1\)</span>时，被称为LASSO或L1正则化。有关这些惩罚线性模型的一本书是《Elements of Statistical Learn》（网上有免费的电子版）。与这些模型有关的R函数包括<code>MASS</code>包里的<code>lm.ridge</code>函数，还有<code>lars</code>包，<code>glmnet</code>包。</p>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/线性模型/" <i class="fa fa-tag"></i> 线性模型</a>
          
            <a href="/tags/矩阵计算/" <i class="fa fa-tag"></i> 矩阵计算</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2019/08/14/DAL/DALS014_Linear_Models04ANOVA/" rel="next" title="DALS014-Linear Models线性模型04方差分析">
                <i class="fa fa-chevron-left"></i> DALS014-Linear Models线性模型04方差分析
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2019/08/16/DAL/DALS016_InferenceForHighDimensionalData1_Basic/" rel="prev" title="DALS016-高维数据推断1-背景介绍">
                DALS016-高维数据推断1-背景介绍 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  
    <div class="comments" id="comments">
      <div id="vcomments"></div>
    </div>
  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">RVDSD</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">246</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">14</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">117</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          <div class="links-of-author motion-element">
            
          </div>

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#前言"><span class="nav-number">1.</span> <span class="nav-text">前言</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#共线性co-linearity"><span class="nav-number">2.</span> <span class="nav-text">共线性(Co-linearity)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#方程组案例"><span class="nav-number">3.</span> <span class="nav-text">方程组案例</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#矩阵代数方法"><span class="nav-number">4.</span> <span class="nav-text">矩阵代数方法</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#共线性和最小平方"><span class="nav-number">5.</span> <span class="nav-text">共线性和最小平方</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#混淆confounding案例分析"><span class="nav-number">6.</span> <span class="nav-text">混淆(confounding)案例分析</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#秩rank"><span class="nav-number">7.</span> <span class="nav-text">秩(rank)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#移除混淆"><span class="nav-number">8.</span> <span class="nav-text">移除混淆</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#练习"><span class="nav-number">9.</span> <span class="nav-text">*练习</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#矩阵的qr分解"><span class="nav-number">10.</span> <span class="nav-text">矩阵的QR分解</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#逆转"><span class="nav-number">11.</span> <span class="nav-text">逆转</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#分解factorization"><span class="nav-number">12.</span> <span class="nav-text">分解(factorization)</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#什么是上三角矩阵"><span class="nav-number">12.1.</span> <span class="nav-text">什么是上三角矩阵</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#利用qr来计算lse"><span class="nav-number">12.2.</span> <span class="nav-text">利用QR来计算LSE</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#拟合值"><span class="nav-number">12.3.</span> <span class="nav-text">拟合值</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#标准误"><span class="nav-number">12.4.</span> <span class="nav-text">标准误</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#其它线性模型"><span class="nav-number">13.</span> <span class="nav-text">其它线性模型</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#稳健线性模型robust-linear-models"><span class="nav-number">13.1.</span> <span class="nav-text">稳健线性模型(Robust linear models)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#广义线性模型generalized-linear-modelsglm"><span class="nav-number">13.2.</span> <span class="nav-text">广义线性模型(Generalized linear models,GLM)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#混合效应线性模型mixed-effects-linear-models"><span class="nav-number">13.3.</span> <span class="nav-text">混合效应线性模型(Mixed effects linear models)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#贝叶斯线性模型bayesian-linear-models"><span class="nav-number">13.4.</span> <span class="nav-text">贝叶斯线性模型(Bayesian linear models)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#惩罚线性模型penalized-linear-models"><span class="nav-number">13.5.</span> <span class="nav-text">惩罚线性模型(Penalized linear models)</span></a></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

<div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">RVDSD</span>

  
</div>



<div class="powered-by">
<i class="fa fa-user-md"></i><span id="busuanzi_container_site_pv">
  本站访客数:<span id="busuanzi_value_site_uv"></span>
</span>
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>


<div class="BbeiAn-info">
	<a target="_blank" href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=41018102000118" style="color:#909090;text-decoration:none;padding-left:0px;no-repeat left center" rel="nofollow">豫公网安备 41018102000118</a>	  <!--这里将图标作为了背景，以使得能和后面的文字在同一行-->
</div>

  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.3</div>




<div class="theme-info">
  <div class="powered-by"></div>
  <span class="post-count">博客全站共980.9k字</span>
</div>

        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.3"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.3"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.3"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.3"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.3"></script>



  


  




	





  





  












  





  

  

  
  

  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config("");
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="custom_mathjax_source">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->
  


  

  

</body>
</html>
