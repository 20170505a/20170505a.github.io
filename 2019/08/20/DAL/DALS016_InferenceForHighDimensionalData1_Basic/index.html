<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.3" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.3">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.3" color="#222">





  <meta name="keywords" content="高维数据," />










<meta name="description" content="前言 这一部分是《Data Analysis for the life sciences》的第6章线性高维数据推断(Inference For High Dimensional Data)的第1小节，这一部分的主要内容涉及高通量数据的介绍，统计学的一些注意事项，相应的R markdown文档可以参考作者的Github。 高通量技术 高通量技术已经将基础生物学和生物学从数据贫乏型学科尾成了数据">
<meta name="keywords" content="高维数据">
<meta property="og:type" content="article">
<meta property="og:title" content="DALS016-高维数据推断1-背景介绍">
<meta property="og:url" content="http://rvdsd.top/2019/08/20/DAL/DALS016_InferenceForHighDimensionalData1_Basic/index.html">
<meta property="og:site_name" content="RVDSD的个人笔记本">
<meta property="og:description" content="前言 这一部分是《Data Analysis for the life sciences》的第6章线性高维数据推断(Inference For High Dimensional Data)的第1小节，这一部分的主要内容涉及高通量数据的介绍，统计学的一些注意事项，相应的R markdown文档可以参考作者的Github。 高通量技术 高通量技术已经将基础生物学和生物学从数据贫乏型学科尾成了数据">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190828112405.jpeg">
<meta property="og:image" content="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190828180606.jpeg">
<meta property="og:image" content="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190828191526.jpeg">
<meta property="og:updated_time" content="2019-08-29T06:16:24.355Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="DALS016-高维数据推断1-背景介绍">
<meta name="twitter:description" content="前言 这一部分是《Data Analysis for the life sciences》的第6章线性高维数据推断(Inference For High Dimensional Data)的第1小节，这一部分的主要内容涉及高通量数据的介绍，统计学的一些注意事项，相应的R markdown文档可以参考作者的Github。 高通量技术 高通量技术已经将基础生物学和生物学从数据贫乏型学科尾成了数据">
<meta name="twitter:image" content="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190828112405.jpeg">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.3',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://rvdsd.top/2019/08/20/DAL/DALS016_InferenceForHighDimensionalData1_Basic/"/>





  <title>DALS016-高维数据推断1-背景介绍 | RVDSD的个人笔记本</title><!-- hexo-inject:begin --><!-- hexo-inject:end -->
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">RVDSD的个人笔记本</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2019/08/20/DAL/DALS016_InferenceForHighDimensionalData1_Basic/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">DALS016-高维数据推断1-背景介绍</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-08-20T12:00:00+08:00">
                2019-08-20
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/生物统计/" itemprop="url" rel="index">
                    <span itemprop="name">生物统计</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  3,781
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  16
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h2 id="前言">前言</h2>
<p>这一部分是《Data Analysis for the life sciences》的第6章线性高维数据推断(Inference For High Dimensional Data)的第1小节，这一部分的主要内容涉及高通量数据的介绍，统计学的一些注意事项，相应的R markdown文档可以参考作者的<a href="https://github.com/genomicsclass/labs/tree/master/advinference/intro_to_highthroughput_data.Rmd" target="_blank" rel="external">Github</a>。</p>
<h3 id="高通量技术">高通量技术</h3>
<p>高通量技术已经将基础生物学和生物学从数据贫乏型学科尾成了数据密集型学科。一个典型的例子就是那些对基因表达有兴趣的研究领域。基因表达是这样一个过程，将生命蓝图DNA复制到RNA，而RNA是蛋白质合成的模板，是构成生命的基石。在20世纪90年代，对基因表达数据的分析相当于在一张纸上画了几个点，或从标准曲线上提取了几个数字。随着微阵列等高通量技术的发展，这几个数据就突然变成了筛选成千上万的数字。最近，RNA测序技术又进一步增加了数据的复杂性。生物学家们从使用他们的肉眼或简单的方法来分析结果到每个样本有数千（现在则是数百万个）个数据的分析。在这一篇中，我们佬双重点关注高通量数量的统计推断。具体来说就是，我们会使用统计检验来检测不同组之间的差异，以及使用有意义的方法来量化不确定性问题。我们还公介绍探索性数据分析方法，这些方法会结合高通量数据进行使用。在后面的章节中，我们会研究聚类，机器学习，因子分析和多层级建模(multi-level)。</p>
<p>由于现在有大量可用的公共数据集，我们会使用这些公共数据集来作为我们的学习案例。尽量使用的是公共数据，但是当你学习了这些方法后，在使用了高通量数据技术的其它领域也会派上用场。这些高通量技术包括微阵列，NGS，fRMI与蛋白质谱等。</p>
<h3 id="数据包">数据包</h3>
<p>我们这里使用的数据文件已经在作者的Github上分享了，因此使用<code>devtools</code>包就可以直接下载，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">library</span>(devtools)</div><div class="line">install_github(<span class="string">"genomicsclass/GSE5859Subset"</span>)</div></pre></td></tr></table></figure>
<h3 id="张表">3张表</h3>
<p>我们用来做为案例学习的这些数据多数都是使用高通量技术生成的。这些技术会检测数千个特征值(feature)。这些特征值可以是基因，可以是基因组的单碱基位置，基因区域，以及图像的像素密度（芯片数据）。每个特定的检测产品被都会被相应地一组特定的功能所定义（我的理解就是，某公司的特定产品，例如检测miRNA的芯片，它的检测结果就是一些表达值，而这些表达值代表了哪些miRNA，就还需要另外一个miRNA名称的数据文件），例如特定基因表达的微阵列数据被一组其检测的基因所定义。一个特定的研究通常会使用一种产品对几个实验单元进行检验，例如几个人的样本。最常见的就是人，不过实验产单元也可以是其它的东西，例如肿瘤组织的一部分。按照实验术语，我们通常称实验单元为样本，这个样本与前面讲的随机样本不是一个东西，后者是统计学术语。</p>
<p>因此，一个高能被实验通常由3张表定义：一个是高通量数据的检测值，第二与第三表是关于列与行的信息。由于这些数据集通常是由一系列的实验单元，以及一些固定的特征构成，因此，高通量数据可以储存为<span class="math inline">\(n \times m\)</span>的形式，其中<span class="math inline">\(n\)</span>表示实验单元（样本），而<span class="math inline">\(m\)</span>表示特征值（通常就是基因），现在 我们来看一个案例：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">library</span>(GSE5859Subset)</div><div class="line">data(GSE5859Subset) <span class="comment">##this loads the three tables</span></div><div class="line">dim(geneExpression)</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; dim(geneExpression)</div><div class="line">[<span class="number">1</span>] <span class="number">8793</span>   <span class="number">24</span></div></pre></td></tr></table></figure>
<p>这个数据是RNA表达谱数据，它检测了24个人（实验单元）的8793个基因。对于大多数的统计分析来说，我们还需要实验样本的一些信息。例如，在这个案例中，最初收集的数据是用于比较不同种族群体的基因表达情况。但是，我们已经创建了这个数据集的一个子集用于说明样本的信息情况，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">dim(sampleInfo)</div><div class="line">head(sampleInfo)</div><div class="line">sampleInfo$group</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">&gt; dim(sampleInfo)</div><div class="line">[<span class="number">1</span>] <span class="number">24</span>  <span class="number">4</span></div><div class="line">&gt; head(sampleInfo)</div><div class="line">    ethnicity       date         filename group</div><div class="line"><span class="number">107</span>       ASN <span class="number">2005</span>-<span class="number">06</span>-<span class="number">23</span> GSM136508.CEL.gz     <span class="number">1</span></div><div class="line"><span class="number">122</span>       ASN <span class="number">2005</span>-<span class="number">06</span>-<span class="number">27</span> GSM136530.CEL.gz     <span class="number">1</span></div><div class="line"><span class="number">113</span>       ASN <span class="number">2005</span>-<span class="number">06</span>-<span class="number">27</span> GSM136517.CEL.gz     <span class="number">1</span></div><div class="line"><span class="number">163</span>       ASN <span class="number">2005</span>-<span class="number">10</span>-<span class="number">28</span> GSM136576.CEL.gz     <span class="number">1</span></div><div class="line"><span class="number">153</span>       ASN <span class="number">2005</span>-<span class="number">10</span>-<span class="number">07</span> GSM136566.CEL.gz     <span class="number">1</span></div><div class="line"><span class="number">161</span>       ASN <span class="number">2005</span>-<span class="number">10</span>-<span class="number">07</span> GSM136574.CEL.gz     <span class="number">1</span></div><div class="line">&gt; sampleInfo$group</div><div class="line"> [<span class="number">1</span>] <span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span></div></pre></td></tr></table></figure>
<p>关于样本信息中的一列是文件名，它可以让我们把这个表的行与表达谱的列连接起来，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">match(sampleInfo$filename,colnames(geneExpression))</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; match(sampleInfo$filename,colnames(geneExpression))</div><div class="line"> [<span class="number">1</span>]  <span class="number">1</span>  <span class="number">2</span>  <span class="number">3</span>  <span class="number">4</span>  <span class="number">5</span>  <span class="number">6</span>  <span class="number">7</span>  <span class="number">8</span>  <span class="number">9</span> <span class="number">10</span> <span class="number">11</span> <span class="number">12</span> <span class="number">13</span> <span class="number">14</span> <span class="number">15</span> <span class="number">16</span> <span class="number">17</span> <span class="number">18</span> <span class="number">19</span> <span class="number">20</span> <span class="number">21</span> <span class="number">22</span> <span class="number">23</span> <span class="number">24</span></div></pre></td></tr></table></figure>
<p>最后，我们还有一张描述特征值的表格，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">dim(geneAnnotation)</div><div class="line">head(geneAnnotation)</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">&gt; dim(geneAnnotation)</div><div class="line">[<span class="number">1</span>] <span class="number">8793</span>    <span class="number">4</span></div><div class="line">&gt; head(geneAnnotation)</div><div class="line">     PROBEID  CHR     CHRLOC SYMBOL</div><div class="line"><span class="number">1</span>  1007_s_at chr6   <span class="number">30852327</span>   DDR1</div><div class="line"><span class="number">30</span>   1053_at chr7  -<span class="number">73645832</span>   RFC2</div><div class="line"><span class="number">31</span>    117_at chr1  <span class="number">161494036</span>  HSPA6</div><div class="line"><span class="number">32</span>    121_at chr2 -<span class="number">113973574</span>   PAX8</div><div class="line"><span class="number">33</span> 1255_g_at chr6   <span class="number">42123144</span> GUCA1A</div><div class="line"><span class="number">34</span>   1294_at chr3  -<span class="number">49842638</span>   UBA7</div></pre></td></tr></table></figure>
<p>从上面的信息知道，<code>geneAnnotation</code>这个文件里含有ID，这个表的行可以与表达谱的行连接起来，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">head(match(geneAnnotation$PROBEID,rownames(geneExpression)))</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; head(match(geneAnnotation$PROBEID,rownames(geneExpression)))</div><div class="line">[<span class="number">1</span>] <span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">4</span> <span class="number">5</span> <span class="number">6</span></div></pre></td></tr></table></figure>
<h2 id="实际应用">实际应用</h2>
<p>现在假设我们已经拥有了一批高通量数据，这个数据是检测了两组中一些人的基因表达情况。现在我们的问题是：在这两组人中，哪些基因的表达均值存在差异？如果是一个基因，计算起来很简单，我们手工计算就行，但是，高通常数量通常都是几千个基因，显然手工算不太现实，但是寻找差异基因的方法跟前面我们提到的统计推断原理一样。例如，我们可以使用t检验或其它检验来寻找差异基因。</p>
<h3 id="随机变量的p值">随机变量的p值</h3>
<p>这里我们要强调的一个概念就是，p值是一个随机变量。为了能说明这一点，我们来看一个案例。在这个案例中，我们会使用CLT近似的原来生成大量的样本，并通过t检验来计算其p值。然后我们的p值被定义为，正态分布的随机变量的绝对值大于观察到的t检验r值的概率，被称为<span class="math inline">\(Z\)</span>（书中原话是：Then our p-value is defined as the probability that a normally distributed random variable is larger, in absolute value, than the observed t-test, call it Z.），因此，双尾检验的p值公式如下所示： <span class="math display">\[
p = 2 \{ 1 - \Phi(\mid Z \mid)\}
\]</span> 在R中则为：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="number">2</span>*(<span class="number">1</span>-pnorm(Z))</div></pre></td></tr></table></figure>
<p>因为<span class="math inline">\(Z\)</span>是一个随机变量，并且<span class="math inline">\(\Phi\)</span>是一个确定的函数，<span class="math inline">\(p\)</span>因此也是一个随机变量。我们现在使用Monte Carlo模拟来显示一下<span class="math inline">\(p\)</span>值的变化，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">set.seed(<span class="number">1</span>)</div><div class="line"></div><div class="line">dir &lt;- system.file(package = <span class="string">"dagdata"</span>)</div><div class="line">filename &lt;- file.path(dir,<span class="string">"extdata/femaleControlsPopulation.csv"</span>)</div><div class="line">population &lt;- read.csv(filename)</div><div class="line">population &lt;- unlist(population) <span class="comment"># turn it into a numeric</span></div><div class="line">N &lt;- <span class="number">12</span></div><div class="line">B &lt;- <span class="number">10000</span></div><div class="line">pvals &lt;- replicate(B,&#123;</div><div class="line">  control = sample(population,N)</div><div class="line">  treatment = sample(population,N)</div><div class="line">  t.test(treatment,control)$p.val</div><div class="line">&#125;)</div><div class="line">hist(pvals)</div></pre></td></tr></table></figure>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190828112405.jpeg">

</div>
<p>从直方图中我们可以看到，p值属于均匀分布。事实上，我们可以从理论上证明，当零假设为真是，情况确实如此。当我们使用CLT时，我们的零假设<span class="math inline">\(H_{0}\)</span>意味着我们的检验统计量Z服从均值为0，SD为1的正态分布，因此： <span class="math display">\[
p_a = \mbox{Pr}(Z &lt; a \mid H_0) = \Phi(a)
\]</span> 这也说明： <span class="math display">\[
\begin{align*}
\mbox{Pr}(p &lt; p_a) &amp;= \mbox{Pr}[ \Phi^{-1}(p) &lt; \Phi^{-1}(p_a) ] \\
  &amp; = \mbox{Pr}(Z &lt; a) = p_a
\end{align*}
\]</span> 这其实就是均匀分布(uniform distribution)的定义。</p>
<h3 id="千次检验">千次检验</h3>
<p>在上面的案例中，我们有两组数据，分别用0和1表示，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">library</span>(GSE5859Subset)</div><div class="line">data(GSE5859Subset)</div><div class="line">g &lt;- sampleInfo$group</div><div class="line">g</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&gt; <span class="keyword">library</span>(GSE5859Subset)</div><div class="line">&gt; data(GSE5859Subset)</div><div class="line">&gt; g &lt;- sampleInfo$group</div><div class="line">&gt; g</div><div class="line"> [<span class="number">1</span>] <span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span></div></pre></td></tr></table></figure>
<p>如果我们对某个特定的基因感兴趣，例如第25行的那个基因，那么我们就可以简单地使用t检验就行，为了计算p值，我们需要先看一下这个基因数据是否服从t分布，因此我们可以使用qq图来绘制，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">e &lt;- geneExpression[<span class="number">25</span>,]</div><div class="line">e</div><div class="line"><span class="keyword">library</span>(rafalib)</div><div class="line">mypar(<span class="number">1</span>,<span class="number">2</span>)</div><div class="line">qqnorm(e[g==<span class="number">1</span>])</div><div class="line">qqline(e[g==<span class="number">1</span>])</div><div class="line">qqnorm(e[g==<span class="number">0</span>])</div><div class="line">qqline(e[g==<span class="number">0</span>])</div></pre></td></tr></table></figure>
<p>结果如下所示： <figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">&gt; e</div><div class="line">GSM136508.CEL.gz GSM136530.CEL.gz GSM136517.CEL.gz GSM136576.CEL.gz GSM136566.CEL.gz GSM136574.CEL.gz GSM136575.CEL.gz </div><div class="line">        <span class="number">10.34172</span>         <span class="number">10.64662</span>         <span class="number">10.69198</span>         <span class="number">10.96155</span>         <span class="number">10.24889</span>         <span class="number">10.74414</span>         <span class="number">10.22206</span> </div><div class="line">GSM136569.CEL.gz GSM136568.CEL.gz GSM136559.CEL.gz GSM136565.CEL.gz GSM136573.CEL.gz GSM136523.CEL.gz GSM136509.CEL.gz </div><div class="line">        <span class="number">10.49094</span>         <span class="number">10.57574</span>         <span class="number">10.47758</span>         <span class="number">10.43493</span>         <span class="number">10.46440</span>         <span class="number">10.58358</span>         <span class="number">10.39607</span> </div><div class="line">GSM136727.CEL.gz GSM136510.CEL.gz GSM136515.CEL.gz GSM136522.CEL.gz GSM136507.CEL.gz GSM136524.CEL.gz GSM136514.CEL.gz </div><div class="line">        <span class="number">10.75837</span>         <span class="number">10.37383</span>         <span class="number">10.57540</span>         <span class="number">10.51203</span>         <span class="number">10.39952</span>         <span class="number">10.70539</span>         <span class="number">10.77077</span> </div><div class="line">GSM136563.CEL.gz GSM136564.CEL.gz GSM136572.CEL.gz </div><div class="line">        <span class="number">10.38333</span>         <span class="number">10.31405</span>         <span class="number">10.25655</span></div></pre></td></tr></table></figure></p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190828180606.jpeg">

</div>
<p>qq显示，这个数据比较接近于正态分布，但是t检验发现，这个基因在两组之间并无差异，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">t.test(e[g==<span class="number">1</span>],e[g==<span class="number">0</span>])$p.value</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; t.test(e[g==<span class="number">1</span>],e[g==<span class="number">0</span>])$p.value</div><div class="line">[<span class="number">1</span>] <span class="number">0.779303</span></div></pre></td></tr></table></figure>
<p>上面是只计算1个基因的情况，如果要计算所有的基因，那么就需要对每个基因进行t检验，我们来构建一个函数，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">myttest &lt;- <span class="keyword">function</span>(x) t.test(x[g==<span class="number">1</span>],x[g==<span class="number">0</span>],var.equal=<span class="literal">TRUE</span>)$p.value</div><div class="line">pvals &lt;- apply(geneExpression,<span class="number">1</span>,myttest)</div><div class="line">head(pvals)</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&gt; head(pvals)</div><div class="line"> 1007_s_at    1053_at     117_at     121_at  1255_g_at    1294_at </div><div class="line"><span class="number">0.04553344</span> <span class="number">0.03370683</span> <span class="number">0.13604026</span> <span class="number">0.59413846</span> <span class="number">0.96849102</span> <span class="number">0.08489586</span></div></pre></td></tr></table></figure>
<p>现在我们来看一下，p值小于0.05的基因有多少个，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sum(pvals&lt;<span class="number">0.05</span>)</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; sum(pvals&lt;<span class="number">0.05</span>)</div><div class="line">[<span class="number">1</span>] <span class="number">1383</span></div></pre></td></tr></table></figure>
<p>也就是说，有1383个基因有差异。</p>
<p>但是，正如我们随后即将详细描述的那样，对于这个结果，我们要谨慎对待。因为这个结果是我们经过8000多次比较后得到的结果（数据集里一共有个8793基因）。如果我们对一批随机数据执行相同的计算过程，在零假设成立的前提下，我们也能计算出一批p值，并且这批p值小于0.05的数目为：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">set.seed(<span class="number">1</span>)</div><div class="line">m &lt;- nrow(geneExpression)</div><div class="line">n &lt;- ncol(geneExpression)</div><div class="line">randomData &lt;- matrix(rnorm(n*m),m,n)</div><div class="line">nullpvals &lt;- apply(randomData,<span class="number">1</span>,myttest)</div><div class="line">sum(nullpvals&lt;<span class="number">0.05</span>)</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; sum(nullpvals&lt;<span class="number">0.05</span>)</div><div class="line">[<span class="number">1</span>] <span class="number">419</span></div></pre></td></tr></table></figure>
<p>随后，我们会解释一下这个数值是怎么一回事，实际上，这个数字大概就是8192*0.05的结果（大约为409.6），后面会详细介绍这个原理。</p>
<h3 id="加快t检验的计算">加快t检验的计算</h3>
<p>在我们开始之前，我们需要知道，前面我们构建了一个做t检验的函数，虽然它能计算出相应的p值，但是这种方法比较低效。我们还有其它更快的方法实现这一目的，在Bioconductor项目中就有这样的函数，此时我们要用到<code>rafalib</code>包中的<code>install_bioc()</code>函数，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">install_bioc(<span class="string">"genefilter"</span>)</div></pre></td></tr></table></figure>
<p>现在我们使用<code>rowttests()</code>函数来计算一下p值，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">library</span>(genefilter)</div><div class="line">results &lt;- rowttests(geneExpression,factor(g))</div><div class="line">max(abs(pvals-results$p))</div><div class="line">sum(results$p&lt;<span class="number">0.05</span>)</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&gt; max(abs(pvals-results$p))</div><div class="line">[<span class="number">1</span>] <span class="number">6.528111e-14</span></div><div class="line">&gt; sum(results$p&lt;<span class="number">0.05</span>)</div><div class="line">[<span class="number">1</span>] <span class="number">1383</span></div></pre></td></tr></table></figure>
<h2 id="p值计算练习">p值计算练习</h2>
<p>为了更好地理解p值是一个随机变量，现在我们再来看一些案例，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">set.seed(<span class="number">1</span>)</div><div class="line"><span class="keyword">library</span>(downloader)</div><div class="line">url = <span class="string">"https://raw.githubusercontent.com/genomicsclass/dagdata/master/inst/extda\</span></div><div class="line"><span class="string">ta/femaleControlsPopulation.csv"</span></div><div class="line">filename = <span class="string">"femaleControlsPopulation.csv"</span></div><div class="line"><span class="keyword">if</span> (!file.exists(filename)) download(url,destfile=filename)</div><div class="line">population = read.csv(filename)</div><div class="line"></div><div class="line">pvals &lt;- replicate(<span class="number">1000</span>,&#123;</div><div class="line">  control = sample(population,<span class="number">12</span>)</div><div class="line">  treatment = sample(population,<span class="number">12</span>)</div><div class="line">  t.test(treatment,control)$p.val&#125;)</div><div class="line">head(pvals)</div><div class="line">hist(pvals)</div></pre></td></tr></table></figure>
<p>结果如下所示： <figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; head(pvals)</div><div class="line">[<span class="number">1</span>] <span class="number">0.76454370</span> <span class="number">0.60237592</span> <span class="number">0.49679830</span> <span class="number">0.23518016</span> <span class="number">0.20882028</span> <span class="number">0.06812489</span></div></pre></td></tr></table></figure></p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190828191526.jpeg">

</div>
<p>现在回答以下几个问题：</p>
<p><strong>问题一</strong>：小于0.05的p值所占的比例是多少？</p>
<p>答：4.1%，代码如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; sum(pvals &lt; <span class="number">0.05</span>)/length(pvals)*<span class="number">100</span></div><div class="line">[<span class="number">1</span>] <span class="number">4.1</span></div></pre></td></tr></table></figure>
<p><strong>问题二</strong>：小于0.01的p值所占的比例是多少？</p>
<p>答：0.8%，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; sum(pvals &lt; <span class="number">0.01</span>)/length(pvals)*<span class="number">100</span></div><div class="line">[<span class="number">1</span>] <span class="number">0.8</span></div></pre></td></tr></table></figure>
<p><strong>问题三</strong>：假设你正在测试20种饮食对小鼠体重影响的效应。对于20种饮食中的每一种，我们都使用10只对照小鼠和10只实验小鼠。在零假设成立时，也就是说饮食对小鼠的体重没有影响，另外，小鼠的体重是服从正态分布的（均值为30g，SD为2g）。我们对其中的一项进行Monte Carlo模拟：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">cases = rnorm(<span class="number">10</span>,<span class="number">30</span>,<span class="number">2</span>)</div><div class="line">controls = rnorm(<span class="number">10</span>,<span class="number">30</span>,<span class="number">2</span>)</div><div class="line">t.test(cases,controls)</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">&gt; cases = rnorm(<span class="number">10</span>,<span class="number">30</span>,<span class="number">2</span>)</div><div class="line">&gt; controls = rnorm(<span class="number">10</span>,<span class="number">30</span>,<span class="number">2</span>)</div><div class="line">&gt; t.test(cases,controls)</div><div class="line"></div><div class="line">	Welch Two Sample t-test</div><div class="line"></div><div class="line">data:  cases and controls</div><div class="line">t = <span class="number">0.16473</span>, df = <span class="number">17.934</span>, p-value = <span class="number">0.871</span></div><div class="line">alternative hypothesis: true difference <span class="keyword">in</span> means is not equal to <span class="number">0</span></div><div class="line"><span class="number">95</span> percent confidence interval:</div><div class="line"> -<span class="number">1.708669</span>  <span class="number">1.999327</span></div><div class="line">sample estimates:</div><div class="line">mean of x mean of y </div><div class="line"> <span class="number">30.23172</span>  <span class="number">30.08639</span></div></pre></td></tr></table></figure>
<p>问题：现在进行Monte Carlo模拟，模拟所有20种包含的实验结果，如果我们将种子设置为<code>set.seed(100)</code>，那么有多少值低于0.05？</p>
<p>答案是：5%，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">set.seed(<span class="number">100</span>)</div><div class="line">pvals &lt;- replicate(<span class="number">20</span>,&#123;</div><div class="line">  cases = rnorm(<span class="number">10</span>,<span class="number">30</span>,<span class="number">2</span>)</div><div class="line">  controls = rnorm(<span class="number">10</span>,<span class="number">30</span>,<span class="number">2</span>)</div><div class="line">  t.test(cases,controls)$p.val&#125;)</div><div class="line">sum(pvals&lt;<span class="number">0.05</span>)/length(pvals)*<span class="number">100</span></div></pre></td></tr></table></figure>
<p>结果如下：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; sum(pvals&lt;<span class="number">0.05</span>)/length(pvals)*<span class="number">100</span></div><div class="line">[<span class="number">1</span>] <span class="number">5</span></div></pre></td></tr></table></figure>
<p><strong>问题四</strong>：现在我们通过模拟数据了解了p值的分布情况，也就是说了解了小于0.05的p值的比例。在问题三中，我们一次运行了20种饮食的实验。现在我们运行1000次实验，并且每次保存下那些p值小于0.05的数目。</p>
<p>操作如下：</p>
<p>随机种子数设为100，即<code>set.seed(100)</code>，运行问题三中的代码1000次，并保存p值小于0.05的次数，计算一下这些数字的平均值，这就是我们拒绝零假设为真时的次数，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">set.seed(<span class="number">100</span>)</div><div class="line">pvals &lt;- replicate(<span class="number">1000</span>,&#123;</div><div class="line">  cases = rnorm(<span class="number">10</span>,<span class="number">30</span>,<span class="number">2</span>)</div><div class="line">  controls = rnorm(<span class="number">10</span>,<span class="number">30</span>,<span class="number">2</span>)</div><div class="line">  t.test(cases,controls)$p.val&#125;)</div><div class="line">sum(pvals&lt;<span class="number">0.05</span>)</div><div class="line">sum(pvals&lt;<span class="number">0.05</span>)/length(pvals)*<span class="number">100</span></div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&gt; sum(pvals&lt;<span class="number">0.05</span>)</div><div class="line">[<span class="number">1</span>] <span class="number">40</span></div><div class="line">&gt; sum(pvals&lt;<span class="number">0.05</span>)/length(pvals)*<span class="number">100</span></div><div class="line">[<span class="number">1</span>] <span class="number">4</span></div></pre></td></tr></table></figure>
<p><strong>问题五</strong>：这说明，就平均数而言，即使所有的饮食对小鼠的体重都没有影响，我们还能得到一些小于0.05的p值。使用相同的模拟数据来做1000次计算，我们能得到多少假阳性的比例？</p>
<p>答：大概是5%。</p>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/高维数据/" <i class="fa fa-tag"></i> 高维数据</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2019/08/19/DAL/DALS013_Linear_Models03ContrastInteraction/" rel="next" title="DALS013-Linear Models线性模型03比较(contrast)与交互项">
                <i class="fa fa-chevron-left"></i> DALS013-Linear Models线性模型03比较(contrast)与交互项
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2019/08/20/DAL/DALS014_Linear_Models04ANOVA/" rel="prev" title="DALS014-Linear Models线性模型04方差分析">
                DALS014-Linear Models线性模型04方差分析 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  
    <div class="comments" id="comments">
      <div id="vcomments"></div>
    </div>
  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">RVDSD</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">211</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">12</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">98</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          <div class="links-of-author motion-element">
            
          </div>

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#前言"><span class="nav-number">1.</span> <span class="nav-text">前言</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#高通量技术"><span class="nav-number">1.1.</span> <span class="nav-text">高通量技术</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#数据包"><span class="nav-number">1.2.</span> <span class="nav-text">数据包</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#张表"><span class="nav-number">1.3.</span> <span class="nav-text">3张表</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#实际应用"><span class="nav-number">2.</span> <span class="nav-text">实际应用</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#随机变量的p值"><span class="nav-number">2.1.</span> <span class="nav-text">随机变量的p值</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#千次检验"><span class="nav-number">2.2.</span> <span class="nav-text">千次检验</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#加快t检验的计算"><span class="nav-number">2.3.</span> <span class="nav-text">加快t检验的计算</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#p值计算练习"><span class="nav-number">3.</span> <span class="nav-text">p值计算练习</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

<div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">RVDSD</span>

  
</div>



<div class="powered-by">
<i class="fa fa-user-md"></i><span id="busuanzi_container_site_pv">
  本站访客数:<span id="busuanzi_value_site_uv"></span>
</span>
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>


<div class="BbeiAn-info">
	<a target="_blank" href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=41018102000118" style="color:#909090;text-decoration:none;padding-left:0px;no-repeat left center" rel="nofollow">豫公网安备 41018102000118</a>	  <!--这里将图标作为了背景，以使得能和后面的文字在同一行-->
</div>

  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.3</div>




<div class="theme-info">
  <div class="powered-by"></div>
  <span class="post-count">博客全站共837.1k字</span>
</div>

        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.3"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.3"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.3"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.3"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.3"></script>



  


  




	





  





  












  





  

  

  
  

  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config("");
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="custom_mathjax_source">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->
  


  

  

</body>
</html>
