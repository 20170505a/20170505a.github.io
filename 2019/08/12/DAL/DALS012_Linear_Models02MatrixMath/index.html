<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.3" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.3">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.3" color="#222">





  <meta name="keywords" content="线性代数," />










<meta name="description" content="前言 这一部分是《Data Analysis for the life sciences》的第5章线性模型的第2小节。这一部分的主要内容涉及矩阵的数学计算原理。 先来看一下前面的一个案例。 小鼠饲料案例 在前面的内容中，我们使用了t检验来研究高脂饲料(hf)饲喂的小鼠与普通饲料(chow)饲喂的小鼠体重的差异，现在我们使用线性模型来研究一下这两种小鼠的体重是否有差异，最终我们会发现，这两种">
<meta name="keywords" content="线性代数">
<meta property="og:type" content="article">
<meta property="og:title" content="DALS012-Linear Models线性模型02矩阵知识">
<meta property="og:url" content="http://rvdsd.top/2019/08/12/DAL/DALS012_Linear_Models02MatrixMath/index.html">
<meta property="og:site_name" content="RVDSD的个人笔记本">
<meta property="og:description" content="前言 这一部分是《Data Analysis for the life sciences》的第5章线性模型的第2小节。这一部分的主要内容涉及矩阵的数学计算原理。 先来看一下前面的一个案例。 小鼠饲料案例 在前面的内容中，我们使用了t检验来研究高脂饲料(hf)饲喂的小鼠与普通饲料(chow)饲喂的小鼠体重的差异，现在我们使用线性模型来研究一下这两种小鼠的体重是否有差异，最终我们会发现，这两种">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190817104902.jpeg">
<meta property="og:image" content="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190817114032.jpeg">
<meta property="og:image" content="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190817124445.jpeg">
<meta property="og:image" content="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190817130758.jpeg">
<meta property="og:updated_time" content="2019-09-14T09:05:01.130Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="DALS012-Linear Models线性模型02矩阵知识">
<meta name="twitter:description" content="前言 这一部分是《Data Analysis for the life sciences》的第5章线性模型的第2小节。这一部分的主要内容涉及矩阵的数学计算原理。 先来看一下前面的一个案例。 小鼠饲料案例 在前面的内容中，我们使用了t检验来研究高脂饲料(hf)饲喂的小鼠与普通饲料(chow)饲喂的小鼠体重的差异，现在我们使用线性模型来研究一下这两种小鼠的体重是否有差异，最终我们会发现，这两种">
<meta name="twitter:image" content="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190817104902.jpeg">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.3',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://rvdsd.top/2019/08/12/DAL/DALS012_Linear_Models02MatrixMath/"/>





  <title>DALS012-Linear Models线性模型02矩阵知识 | RVDSD的个人笔记本</title><!-- hexo-inject:begin --><!-- hexo-inject:end -->
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">RVDSD的个人笔记本</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2019/08/12/DAL/DALS012_Linear_Models02MatrixMath/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">DALS012-Linear Models线性模型02矩阵知识</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-08-12T12:00:00+08:00">
                2019-08-12
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Data-Analysis-for-the-life-sciences/" itemprop="url" rel="index">
                    <span itemprop="name">Data Analysis for the life sciences</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  3,904
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  17
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h2 id="前言">前言</h2>
<p>这一部分是《Data Analysis for the life sciences》的第5章线性模型的第2小节。这一部分的主要内容涉及矩阵的数学计算原理。</p>
<p>先来看一下前面的一个案例。</p>
<h2 id="小鼠饲料案例">小鼠饲料案例</h2>
<p>在前面的内容中，我们使用了t检验来研究高脂饲料(hf)饲喂的小鼠与普通饲料(chow)饲喂的小鼠体重的差异，现在我们使用线性模型来研究一下这两种小鼠的体重是否有差异，最终我们会发现，这两种统计方法在本质上是一样的，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">dir &lt;- system.file(package = <span class="string">"dagdata"</span>)</div><div class="line">list.files(dir)</div><div class="line">dir</div><div class="line">filename &lt;- file.path(dir,<span class="string">"extdata/femaleMiceWeights.csv"</span>)</div><div class="line">dat &lt;- read.csv(filename)</div><div class="line"><span class="comment"># input raw data</span></div><div class="line">head(dat)</div><div class="line">str(dat)</div><div class="line">stripchart(dat$Bodyweight ~ dat$Diet, vertical=<span class="literal">TRUE</span>, method=<span class="string">"jitter"</span>,</div><div class="line">main=<span class="string">"Bodyweight over Diet"</span>)</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">&gt; head(dat)</div><div class="line">  Diet Bodyweight</div><div class="line"><span class="number">1</span> chow      <span class="number">21.51</span></div><div class="line"><span class="number">2</span> chow      <span class="number">28.14</span></div><div class="line"><span class="number">3</span> chow      <span class="number">24.04</span></div><div class="line"><span class="number">4</span> chow      <span class="number">23.45</span></div><div class="line"><span class="number">5</span> chow      <span class="number">23.68</span></div><div class="line"><span class="number">6</span> chow      <span class="number">19.79</span></div><div class="line">&gt; str(dat)</div><div class="line"><span class="string">'data.frame'</span>:	<span class="number">24</span> obs. of  <span class="number">2</span> variables:</div><div class="line"> $ Diet      : Factor w/ <span class="number">2</span> levels <span class="string">"chow"</span>,<span class="string">"hf"</span>: <span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="keyword">...</span></div><div class="line"> $ Bodyweight: num  <span class="number">21.5</span> <span class="number">28.1</span> <span class="number">24</span> <span class="number">23.4</span> <span class="number">23.7</span> <span class="keyword">...</span></div></pre></td></tr></table></figure>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190817104902.jpeg">

</div>
<p>从这张图上我们大致可以看出来，hf组的小鼠体重比chow组的小鼠体重高一些。现在我们使用设计矩阵<span class="math inline">\(\mathbf{X}\)</span>（公式为<code>~Diet</code>）来计算一下这个结果，在设计矩阵中，第2列是分组信息，也就是饲料的类型，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">levels(dat$Diet)</div><div class="line">X &lt;- model.matrix(~ Diet, data=dat)</div><div class="line">X</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line">&gt; X</div><div class="line">   (Intercept) Diethf</div><div class="line"><span class="number">1</span>            <span class="number">1</span>      <span class="number">0</span></div><div class="line"><span class="number">2</span>            <span class="number">1</span>      <span class="number">0</span></div><div class="line"><span class="number">3</span>            <span class="number">1</span>      <span class="number">0</span></div><div class="line"><span class="number">4</span>            <span class="number">1</span>      <span class="number">0</span></div><div class="line"><span class="number">5</span>            <span class="number">1</span>      <span class="number">0</span></div><div class="line"><span class="number">6</span>            <span class="number">1</span>      <span class="number">0</span></div><div class="line"><span class="number">7</span>            <span class="number">1</span>      <span class="number">0</span></div><div class="line"><span class="number">8</span>            <span class="number">1</span>      <span class="number">0</span></div><div class="line"><span class="number">9</span>            <span class="number">1</span>      <span class="number">0</span></div><div class="line"><span class="number">10</span>           <span class="number">1</span>      <span class="number">0</span></div><div class="line"><span class="number">11</span>           <span class="number">1</span>      <span class="number">0</span></div><div class="line"><span class="number">12</span>           <span class="number">1</span>      <span class="number">0</span></div><div class="line"><span class="number">13</span>           <span class="number">1</span>      <span class="number">1</span></div><div class="line"><span class="number">14</span>           <span class="number">1</span>      <span class="number">1</span></div><div class="line"><span class="number">15</span>           <span class="number">1</span>      <span class="number">1</span></div><div class="line"><span class="number">16</span>           <span class="number">1</span>      <span class="number">1</span></div><div class="line"><span class="number">17</span>           <span class="number">1</span>      <span class="number">1</span></div><div class="line"><span class="number">18</span>           <span class="number">1</span>      <span class="number">1</span></div><div class="line"><span class="number">19</span>           <span class="number">1</span>      <span class="number">1</span></div><div class="line"><span class="number">20</span>           <span class="number">1</span>      <span class="number">1</span></div><div class="line"><span class="number">21</span>           <span class="number">1</span>      <span class="number">1</span></div><div class="line"><span class="number">22</span>           <span class="number">1</span>      <span class="number">1</span></div><div class="line"><span class="number">23</span>           <span class="number">1</span>      <span class="number">1</span></div><div class="line"><span class="number">24</span>           <span class="number">1</span>      <span class="number">1</span></div><div class="line">attr(,<span class="string">"assign"</span>)</div><div class="line">[<span class="number">1</span>] <span class="number">0</span> <span class="number">1</span></div><div class="line">attr(,<span class="string">"contrasts"</span>)</div><div class="line">attr(,<span class="string">"contrasts"</span>)$Diet</div><div class="line">[<span class="number">1</span>] <span class="string">"contr.treatment"</span></div></pre></td></tr></table></figure>
<h2 id="lm函数背后的数学原理"><code>lm()</code>函数背后的数学原理</h2>
<p>现在我们先不用<code>lm()</code>来进行计算，先用设计矩阵%<span class="math inline">\(来计算一下\)</span>$，这个值能够使线性模型的平方和最小，公式如下所示： <span class="math display">\[
\hat{\boldsymbol{\beta}} = (\mathbf{X}^\top \mathbf{X})^{-1} \mathbf{X}^\top \mathbf{Y}
\]</span> 在R中，可以使用矩阵相乘的符号<code>%*%</code>，以及<code>solve()</code>函数来求解上述方程，如下所示： <figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">Y &lt;- dat$Bodyweight</div><div class="line">X &lt;- model.matrix(~ Diet, data=dat)</div><div class="line">solve(t(X) %*% X) %*% t(X) %*% Y</div></pre></td></tr></table></figure></p>
<p>结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&gt; Y &lt;- dat$Bodyweight</div><div class="line">&gt; X &lt;- model.matrix(~ Diet, data=dat)</div><div class="line">&gt; solve(t(X) %*% X) %*% t(X) %*% Y</div><div class="line">                 [,<span class="number">1</span>]</div><div class="line">(Intercept) <span class="number">23.813333</span></div><div class="line">Diethf       <span class="number">3.020833</span></div></pre></td></tr></table></figure>
<p>这些系数是对照组的平均值（23.813333），以及两组的差值（3.020833），计算一下，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">s &lt;- split(dat$Bodyweight, dat$Diet)</div><div class="line">mean(s[[<span class="string">"chow"</span>]])</div><div class="line">mean(s[[<span class="string">"hf"</span>]]) - mean(s[[<span class="string">"chow"</span>]])</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&gt; s &lt;- split(dat$Bodyweight, dat$Diet)</div><div class="line">&gt; mean(s[[<span class="string">"chow"</span>]])</div><div class="line">[<span class="number">1</span>] <span class="number">23.81333</span></div><div class="line">&gt; mean(s[[<span class="string">"hf"</span>]]) - mean(s[[<span class="string">"chow"</span>]])</div><div class="line">[<span class="number">1</span>] <span class="number">3.020833</span></div></pre></td></tr></table></figure>
<p>现在我们使用<code>lm()</code>函数两周来计算一下，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">fit &lt;- lm(Bodyweight ~ Diet, data=dat)</div><div class="line">summary(fit)</div><div class="line">(coefs &lt;- coef(fit))</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">&gt; summary(fit)</div><div class="line"></div><div class="line">Call:</div><div class="line">lm(formula = Bodyweight ~ Diet, data = dat)</div><div class="line"></div><div class="line">Residuals:</div><div class="line">    Min      1Q  Median      3Q     Max </div><div class="line">-<span class="number">6.1042</span> -<span class="number">2.4358</span> -<span class="number">0.4138</span>  <span class="number">2.8335</span>  <span class="number">7.1858</span> </div><div class="line"></div><div class="line">Coefficients:</div><div class="line">            Estimate Std. Error t value Pr(&gt;|t|)    </div><div class="line">(Intercept)   <span class="number">23.813</span>      <span class="number">1.039</span>  <span class="number">22.912</span>   &lt;<span class="number">2e-16</span> ***</div><div class="line">Diethf         <span class="number">3.021</span>      <span class="number">1.470</span>   <span class="number">2.055</span>   <span class="number">0.0519</span> .  </div><div class="line">---</div><div class="line">Signif. codes:  <span class="number">0</span> ‘***’ <span class="number">0.001</span> ‘**’ <span class="number">0.01</span> ‘*’ <span class="number">0.05</span> ‘.’ <span class="number">0.1</span> ‘ ’ <span class="number">1</span></div><div class="line"></div><div class="line">Residual standard error: <span class="number">3.6</span> on <span class="number">22</span> degrees of freedom</div><div class="line">Multiple R-squared:  <span class="number">0.1611</span>,	Adjusted R-squared:  <span class="number">0.1229</span> </div><div class="line"><span class="literal">F</span>-statistic: <span class="number">4.224</span> on <span class="number">1</span> and <span class="number">22</span> DF,  p-value: <span class="number">0.05192</span></div><div class="line">&gt; (coefs &lt;- coef(fit))</div><div class="line">(Intercept)      Diethf </div><div class="line">  <span class="number">23.813333</span>    <span class="number">3.020833</span></div></pre></td></tr></table></figure>
<h2 id="线性回归系数">线性回归系数</h2>
<p>下图说明了前面我们计算出来的2个系数，即对照组小鼠的平均体重，以及hf组的小鼠体重与对照组的差异，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">stripchart(dat$Bodyweight ~ dat$Diet, vertical=<span class="literal">TRUE</span>, method=<span class="string">"jitter"</span>,</div><div class="line">           main=<span class="string">"Bodyweight over Diet"</span>, ylim=c(<span class="number">0</span>,<span class="number">40</span>), xlim=c(<span class="number">0</span>,<span class="number">3</span>))</div><div class="line">a &lt;- -<span class="number">0.25</span></div><div class="line">lgth &lt;- <span class="number">.1</span></div><div class="line"><span class="keyword">library</span>(RColorBrewer)</div><div class="line">cols &lt;- brewer.pal(<span class="number">3</span>,<span class="string">"Dark2"</span>)</div><div class="line">abline(h=<span class="number">0</span>)</div><div class="line">arrows(<span class="number">1</span>+a,<span class="number">0</span>,<span class="number">1</span>+a,coefs[<span class="number">1</span>],lwd=<span class="number">3</span>,col=cols[<span class="number">1</span>],length=lgth)</div><div class="line">abline(h=coefs[<span class="number">1</span>],col=cols[<span class="number">1</span>])</div><div class="line">arrows(<span class="number">2</span>+a,coefs[<span class="number">1</span>],<span class="number">2</span>+a,coefs[<span class="number">1</span>]+coefs[<span class="number">2</span>],lwd=<span class="number">3</span>,col=cols[<span class="number">2</span>],length=lgth)</div><div class="line">abline(h=coefs[<span class="number">1</span>]+coefs[<span class="number">2</span>],col=cols[<span class="number">2</span>])</div><div class="line">legend(<span class="string">"right"</span>,names(coefs),fill=cols,cex=<span class="number">.75</span>,bg=<span class="string">"white"</span>)</div></pre></td></tr></table></figure>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190817114032.jpeg">

</div>
<p>在这里使用前面的小鼠案例主要是为了说明了回归与t检验在本质上是一样的，这个简单的线性回归模型给出了与特定类型t检验相同的结果（t统计量与p值）。这是两组之间的t检验，前提是两组的总体标准差相同。当我们假设误差<span class="math inline">\(\boldsymbol{\varepsilon}\)</span>都是均匀分布时，这些误差被编码到线性模型中。虽然在这种情况下的线性模相当于t检验，但我们可以对线性模型进行拓展，将其扩展到复杂的形式。在下面的内容中，我们将会说明线性模型能够得到几乎相同的结果：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&gt; summary(fit)$coefficients</div><div class="line">             Estimate Std. Error   t value     Pr(&gt;|t|)</div><div class="line">(Intercept) <span class="number">23.813333</span>   <span class="number">1.039353</span> <span class="number">22.911684</span> <span class="number">7.642256e-17</span></div><div class="line">Diethf       <span class="number">3.020833</span>   <span class="number">1.469867</span>  <span class="number">2.055174</span> <span class="number">5.192480e-02</span></div></pre></td></tr></table></figure>
<p>t检验的结果与之相同：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">ttest &lt;- t.test(s[[<span class="string">"hf"</span>]], s[[<span class="string">"chow"</span>]], var.equal=<span class="literal">TRUE</span>)</div><div class="line">summary(fit)$coefficients[<span class="number">2</span>,<span class="number">3</span>]</div><div class="line">ttest$statistic</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&gt; summary(fit)$coefficients[<span class="number">2</span>,<span class="number">3</span>]</div><div class="line">[<span class="number">1</span>] <span class="number">2.055174</span></div><div class="line">&gt; ttest$statistic</div><div class="line">       t </div><div class="line"><span class="number">2.055174</span></div></pre></td></tr></table></figure>
<h2 id="练习">练习</h2>
<p>P189</p>
<h2 id="标准误">标准误</h2>
<p>使用矩阵代数来计算最小二乘估计时，所得到的估计值是取机变量。我们还能计算这些值的标准误。线性代数也能满足这些任务，先看一些案例。</p>
<h2 id="自由落体">自由落体</h2>
<p>在学习统计学的过程中，了解随机源于何处是有必要的。在自由落体这个案例中，当我们对落下来的球进行测量时，就会出现检测误差，这就是自由落体运行中随机的来源。假设我们做了好几次实验，每次实验我们都会得到一组测量误差。这就意味着，我们得到的数据基本是随机变化的，这反过来，也意味着，我们计算得到的估计值也是随机变化的。在这个案例中，每次我们进行实验时，引力常数的估计值也都在发生变化。引力常数是一个确定的值，但是我们对它的估计不是。为了说明这一步，我们可以使用Monte Carlo模拟一下。具体来说，我们将会重复地生成数据，并对每次的二次项(quadratic term)进行估计，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">set.seed(<span class="number">1</span>)</div><div class="line">B &lt;- <span class="number">10000</span></div><div class="line">h0 &lt;- <span class="number">56.67</span></div><div class="line">v0 &lt;- <span class="number">0</span></div><div class="line">g &lt;- <span class="number">9.8</span> <span class="comment">##meters per second</span></div><div class="line">n &lt;- <span class="number">25</span></div><div class="line">tt &lt;- seq(<span class="number">0</span>,<span class="number">3.4</span>,len=n) <span class="comment">##time in secs, t is a base function</span></div><div class="line">X &lt;-cbind(<span class="number">1</span>,tt,tt^<span class="number">2</span>)</div><div class="line"><span class="comment">##create X'X^-1 X'</span></div><div class="line">A &lt;- solve(crossprod(X)) %*% t(X)</div><div class="line">betahat&lt;-replicate(B,&#123;</div><div class="line">y &lt;- h0 + v0*tt - <span class="number">0.5</span>*g*tt^<span class="number">2</span> + rnorm(n,sd=<span class="number">1</span>)</div><div class="line">betahats &lt;- A%*%y</div><div class="line"><span class="keyword">return</span>(betahats[<span class="number">3</span>])</div><div class="line">&#125;)</div><div class="line">head(betahat)</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; head(betahat)</div><div class="line">[<span class="number">1</span>] -<span class="number">5.038646</span> -<span class="number">4.894362</span> -<span class="number">5.143756</span> -<span class="number">5.220960</span> -<span class="number">5.063322</span> -<span class="number">4.777521</span></div></pre></td></tr></table></figure>
<p>从上面结果我们可以发现，每次的估计值都不一样，这是因为估计值<span class="math inline">\(\hat{\beta}\)</span>是一个随机变量，它其实是服从正态分布的，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">library</span>(rafalib)</div><div class="line">mypar(<span class="number">1</span>,<span class="number">2</span>)</div><div class="line">hist(betahat)</div><div class="line">qqnorm(betahat)</div><div class="line">qqline(betahat)</div></pre></td></tr></table></figure>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190817124445.jpeg">

</div>
<p>上图显示的是，通过Monte Carlo模拟生成的自由落体运行数据对回归系数的估计值的分布。左侧是直方图，右侧是qq图。</p>
<p>由于<span class="math inline">\(\hat{\beta}\)</span>是我们生成的那些服从正态分布的数据的线性组合，因此从QQ图上我们也可以看出，<span class="math inline">\(\hat{\beta}\)</span>也服从正态分布。此外，这个分布的均值的真实参数0.5g，可以通过Monte Carlo模拟来所证实，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">round(mean(betahat),<span class="number">1</span>)</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; round(mean(betahat),<span class="number">1</span>)</div><div class="line">[<span class="number">1</span>] -<span class="number">4.9</span></div></pre></td></tr></table></figure>
<p>但是，当我们对估计值进行计算时，无法得到精确的数值，这是因为我们估计值的标准误大约是：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; sd(betahat)</div><div class="line">[<span class="number">1</span>] <span class="number">0.2129976</span></div></pre></td></tr></table></figure>
<p>在接下来的案例中，我们将会演示一下，不通过Monte Carlo模拟来计算标准误的方法，因为在实际的分析中，我们无法精确地知道误差是如何产生的。</p>
<h2 id="父子身高">父子身高</h2>
<p>在父母身高的案例中，我们也遇到了随机问题，因为我们是对父子身高的总体进行随机抽样。为了说明这个问题，现在假设我们已经有了这个总体：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">library</span>(UsingR)</div><div class="line">x &lt;- father.son$fheight</div><div class="line">y &lt;- father.son$sheight</div><div class="line">n &lt;- length(y)</div></pre></td></tr></table></figure>
<p>现在我们使用Monte Carlo模拟来生成一个含有50个数据的样本，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">N &lt;- <span class="number">50</span></div><div class="line">B &lt;-<span class="number">1000</span></div><div class="line">betahat &lt;- replicate(B,&#123;</div><div class="line">index &lt;- sample(n,N)</div><div class="line">sampledat &lt;- father.son[index,]</div><div class="line">x &lt;- sampledat$fheight</div><div class="line">y &lt;- sampledat$sheight</div><div class="line">lm(y~x)$coef</div><div class="line">&#125;)</div><div class="line">betahat &lt;- t(betahat) <span class="comment">#have estimates in two columns</span></div></pre></td></tr></table></figure>
<p>现在绘制一个QQ图，我们看到，我们的估计值大致是服从标准正态分布的，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">mypar(<span class="number">1</span>,<span class="number">2</span>)</div><div class="line">qqnorm(betahat[,<span class="number">1</span>])</div><div class="line">qqline(betahat[,<span class="number">1</span>])</div><div class="line">qqnorm(betahat[,<span class="number">2</span>])</div><div class="line">qqline(betahat[,<span class="number">2</span>])</div></pre></td></tr></table></figure>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190817130758.jpeg">

</div>
<p>现在看一下估计值之间的相关性，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; cor(betahat[,<span class="number">1</span>],betahat[,<span class="number">2</span>])</div><div class="line">[<span class="number">1</span>] -<span class="number">0.9992293</span></div></pre></td></tr></table></figure>
<p>当我们计算我们估计值的线性组合时，我们需要知道这个信息能够正确地计算出这些线性组合的标准误差。在接下来的部分中，我们会提到方差-协方差(variance-covariance)矩阵。两个随机变量的协方差定义如下：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mean( (betahat[,<span class="number">1</span>]-mean(betahat[,<span class="number">1</span>] ))* (betahat[,<span class="number">2</span>]-mean(betahat[,<span class="number">2</span>])))</div></pre></td></tr></table></figure>
<p>结果为：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; mean( (betahat[,<span class="number">1</span>]-mean(betahat[,<span class="number">1</span>] ))* (betahat[,<span class="number">2</span>]-mean(betahat[,<span class="number">2</span>])))</div><div class="line">[<span class="number">1</span>] -<span class="number">1.035291</span></div></pre></td></tr></table></figure>
<p>协方差是相关系数乘以每个随机变量的标准差，如下所示：</p>
<p><span class="math display">\[
\mbox{Corr}(X,Y) = \frac{\mbox{Cov}(X,Y)}{\sigma_X \sigma_Y}
\]</span></p>
<p>除此之外，这个量在实际分析中没有一个现实意义上解释。但是，它对于数学推导的过程来说，有着重要意义。在接下来的部分中，我们会描述用于计算线性模型估计的标准差的矩阵代数计算方法。</p>
<h2 id="方差-协方差矩阵">方差-协方差矩阵</h2>
<p>我们先来定义一什么是方差-协方差矩阵(variance-covariance matrix)<span class="math inline">\(\Sigma\)</span>。地于一个元素是随机变量的向量<span class="math inline">\(\mathbf{Y}\)</span>来说，我们定义<span class="math inline">\(\Sigma\)</span>是含有<span class="math inline">\(i,j\)</span>维的矩阵，如下所示： <span class="math display">\[
\Sigma_{i,j} \equiv \mbox{Cov}(Y_i, Y_j)
\]</span></p>
<p>如果<span class="math inline">\(i=j\)</span>，那么协方差就等于方差，如果变量都是独立的，则协方差都为0。在我们现在所学到的各种向量里，<span class="math inline">\(\mathbf{Y}\)</span>向量的每个观测值<span class="math inline">\(Y_{i}\)</span>是从总体中抽样得到的，我们可以假设它的每个元素都是独立的，并且<span class="math inline">\(Y_{i}\)</span>有着相同的方差<span class="math inline">\(\sigma^2\)</span>，因此方差-协方差矩阵只有两类元素，如下所示： <span class="math display">\[
\mbox{Cov}(Y_i, Y_i) = \mbox{var}(Y_i) = \sigma^2
\]</span> <span class="math display">\[
\mbox{Cov}(Y_i, Y_j) = 0, \mbox{ for } i \neq j
\]</span></p>
<p>这就是暗示了<span class="math inline">\(\boldsymbol{\Sigma} = \sigma^2 \mathbf{I}\)</span> ，其中<span class="math inline">\(\mathbf{I}\)</span>是单位矩阵(Identity matrix)。</p>
<h2 id="线性组合的方差">线性组合的方差</h2>
<p>线性代数提供的一个有用结果就是<span class="math inline">\(\mathbf{Y}\)</span>的<span class="math inline">\(\mathbf{AY}\)</span>线性结合的方差-协方差矩阵，它的计算如下所示： <span class="math display">\[
\mbox{var}(\mathbf{AY}) = \mathbf{A}\mbox{var}(\mathbf{Y}) \mathbf{A}^\top
\]</span> 例如，如果<span class="math inline">\(Y_{1}\)</span>和<span class="math inline">\(Y_{2}\)</span>是独立的，并且其方差为<span class="math inline">\(\sigma^2\)</span>，那么：</p>
<p><span class="math display">\[
\mbox{var}\{Y_1+Y_2\} = 
\mbox{var}\left\{ \begin{pmatrix}1&amp;1\end{pmatrix}\begin{pmatrix} Y_1\\Y_2\\ \end{pmatrix}\right\}=\begin{pmatrix}1&amp;1\end{pmatrix} \sigma^2 \mathbf{I}\begin{pmatrix} 1\\1\\ \end{pmatrix}=2\sigma^2
\]</span></p>
<p>我们会使用上述的结果来获取LSE的标准误。</p>
<h2 id="les标准误">LES标准误</h2>
<p><span class="math inline">\(\hat{\beta}\)</span>是一个线性组合，即 <span class="math inline">\(\mathbf{Y}\)</span>: <span class="math inline">\(\mathbf{AY}\)</span> with <span class="math inline">\(\mathbf{A}=\mathbf{(X^\top X)^{-1}X}^\top\)</span>的线性组合，因此我们可以使用上面的公式来计算一个我们估计值的方差：</p>
<p>$$ () = (  ) =</p>
<p>\ (Y) ()^= \</p>
<p> ^2  ()^= \</p>
<p>^2   = \ ^2 $$</p>
<p>其中，这个矩阵的平方根的对角线含有我们估计值的标准误。</p>
<h2 id="估计sigma2">估计<span class="math inline">\(\sigma^2\)</span></h2>
<p>为了从上述公式中获得一个精确的估计值，我们需要估计<span class="math inline">\(\sigma^2\)</span>。在前面我们通过抽样估计了标准误。但是<span class="math inline">\(Y\)</span>的抽样标准误不是<span class="math inline">\(\sigma\)</span>，因为<span class="math inline">\(Y\)</span>还包含了变异，这些变量是由模型<span class="math inline">\(\mathbf{X\beta}\)</span>的确定部分引入的。此时我们采用的方法是利用残差。</p>
<p>我们可以按下面的公式构建残差： <span class="math display">\[
\mathbf{r}\equiv\boldsymbol{\hat{\varepsilon}} = \mathbf{Y}-\mathbf{X}\boldsymbol{\hat{\beta}}
\]</span> 其中，<span class="math inline">\(r\)</span>和<span class="math inline">\(\hat{\epsilon}\)</span>都可以用来表示残差(residuals)。然后我们使用上述的公式来估计残差，这种方式与单变量情况下类似： <span class="math display">\[
s^2 \equiv \hat{\sigma}^2 = \frac{1}{N-p}\mathbf{r}^\top\mathbf{r} = \frac{1}{N-p}\sum_{i=1}^N r_i^2
\]</span></p>
<p>其中，<span class="math inline">\(N\)</span>是样本数目，<span class="math inline">\(p\)</span>是<span class="math inline">\(\mathbf{X}\)</span>的列数，或者是参数的数目（包括截矩<span class="math inline">\(\beta_{0}\)</span>）。公式中还要除以<span class="math inline">\(N-p\)</span>，这是因为根据数学理论（不用深究，这个跟自由度能关），除以<span class="math inline">\(N-p\)</span>，表示无偏估计。下面在R中计算一下，观察一下我们是否能够获得与Monte Carlo模拟一样的数值：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">n &lt;- nrow(father.son)</div><div class="line">N &lt;- <span class="number">50</span></div><div class="line">index &lt;- sample(n,N)</div><div class="line">sampledat &lt;- father.son[index,]</div><div class="line">x &lt;- sampledat$fheight</div><div class="line">y &lt;- sampledat$sheight</div><div class="line">X &lt;- model.matrix(~x)</div><div class="line">N &lt;- nrow(X)</div><div class="line">p &lt;- ncol(X)</div><div class="line">XtXinv &lt;- solve(crossprod(X))</div><div class="line">resid &lt;- y - X %*% XtXinv %*% crossprod(X,y)</div><div class="line">s &lt;- sqrt( sum(resid^<span class="number">2</span>)/(N-p))</div><div class="line">ses &lt;- sqrt(diag(XtXinv))*s</div><div class="line">summary(lm(y~x))$coef[,<span class="number">2</span>]</div><div class="line">ses</div><div class="line">apply(betahat,<span class="number">2</span>,sd)</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">&gt; summary(lm(y~x))$coef[,<span class="number">2</span>]</div><div class="line">(Intercept)           x </div><div class="line">  <span class="number">8.3899781</span>   <span class="number">0.1240767</span> </div><div class="line">&gt; ses</div><div class="line">(Intercept)           x </div><div class="line">  <span class="number">8.3899781</span>   <span class="number">0.1240767</span> </div><div class="line">&gt; apply(betahat,<span class="number">2</span>,sd)</div><div class="line">(Intercept)           x </div><div class="line">  <span class="number">8.3817556</span>   <span class="number">0.1237362</span></div></pre></td></tr></table></figure>
<p>从上面我们可以看出来，我们的计算结果与Monte Carlo模拟的结果几乎一样。</p>
<h2 id="估计值的线性组合">估计值的线性组合</h2>
<p>多数情况下，我们会计算估计值的一个线性组合，例如<span class="math inline">\(\hat{\beta_{2}}-\hat{\beta_{1}}\)</span>。这就是<span class="math inline">\(\hat{\beta}\)</span>的一个线性组合，如下所示： <span class="math display">\[
\hat{\beta}_2 - \hat{\beta}_1 = 
\begin{pmatrix}0&amp;-1&amp;1&amp;0&amp;\dots&amp;0\end{pmatrix} \begin{pmatrix}
\hat{\beta}_0\\
\hat{\beta}_1 \\ 
\hat{\beta}_2 \\ 
\vdots\\
\hat{\beta}_p
\end{pmatrix}
\]</span> 通过上述的公式，我们就知道中如何计算<span class="math inline">\(\hat{\beta}\)</span>的方差-协方差矩阵。</p>
<h2 id="clt与t分布">CLT与t分布</h2>
<p>我们已经了解了如何过计算估计值的标准误。但是，我们在第1章中了解到，在计算置信区间时，我们需要知道随机变量的分布。我们努力计算标准误的原因是因为，CLT适用于线性模型。如果<span class="math inline">\(N\)</span>足够大，那么LSE就会服从正态分布，其中这个正态分布的均值为<span class="math inline">\(\beta\)</span>，标准误就是前面计算的标准误。对于小样本来说，如果<span class="math inline">\(\varepsilon\)</span>服从正态分布，那么<span class="math inline">\(\hat{\beta}-\hat{\beta}\)</span>服从t分布。在这里，我们不需要知道空上计算过程，但是这个结果很有，因为这是我们在线性模型中计算p值，置信区间的基础。</p>
<h2 id="代码与数学">代码与数学</h2>
<p>构建线性模型的标准做法要么是假设<span class="math inline">\(\mathbf{X}\)</span>是固定的，要么我们给它们设置条件。因此<span class="math inline">\(\mathbf{X\beta}\)</span>没有像<span class="math inline">\(\mathbf{X}\)</span>那样固定的方差。这就浊为什么我们要写 <span class="math inline">\(\mbox{var}(Y_i) = \mbox{var}(\varepsilon_i)=\sigma^2\)</span>。在实际计算中，这有可能造成误解，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">x = father.son$fheight</div><div class="line">beta = c(<span class="number">34</span>,<span class="number">0.5</span>)</div><div class="line">var(beta[<span class="number">1</span>]+beta[<span class="number">2</span>]*x)</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; var(beta[<span class="number">1</span>]+beta[<span class="number">2</span>]*x)</div><div class="line">[<span class="number">1</span>] <span class="number">1.883576</span></div></pre></td></tr></table></figure>
<p>这个值并不等于0，也不接近于0。这就是为什么我们要谨慎区分代码与数学的一个案例。<code>var()</code>函数仅仅是用于计算我们输入数值的方差，而数学对方差的定义则是要考虑到这些数字是否是随机变量。在上述的R代码中，<code>x</code>并没有固定：我们只是让它发生变化，但是，当我们写下<span class="math inline">\(\mbox{var}(Y_i) = \sigma^2\)</span>时，我们是把数学上的<code>x</code>强制固定下来。同样，如果我们使用R来计算自由落体运行案例中<span class="math inline">\(Y\)</span>的方差，我们也会获得一个与<span class="math inline">\(\sigma^2=1\)</span>（已知方差）明显不同的数值，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">n &lt;- length(tt)</div><div class="line">y &lt;- h0 + v0*tt - <span class="number">0.5</span>*g*tt^<span class="number">2</span> + rnorm(n,sd=<span class="number">1</span>)</div><div class="line">var(y)</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&gt; n &lt;- length(tt)</div><div class="line">&gt; y &lt;- h0 + v0*tt - <span class="number">0.5</span>*g*tt^<span class="number">2</span> + rnorm(n,sd=<span class="number">1</span>)</div><div class="line">&gt; var(y)</div><div class="line">[<span class="number">1</span>] <span class="number">329.5136</span></div></pre></td></tr></table></figure>
<h2 id="练习-1">练习</h2>
<p>P199</p>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/线性代数/" <i class="fa fa-tag"></i> 线性代数</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2019/08/11/DAL/DALS011_Linear_Models01MatrixDescription/" rel="next" title="DALS011-Linear Models线性模型01MatrixDescription">
                <i class="fa fa-chevron-left"></i> DALS011-Linear Models线性模型01MatrixDescription
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2019/08/13/DAL/DALS013_Linear_Models03ContrastInteraction/" rel="prev" title="DALS013-Linear Models线性模型03比较(contrast)与交互项">
                DALS013-Linear Models线性模型03比较(contrast)与交互项 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  
    <div class="comments" id="comments">
      <div id="vcomments"></div>
    </div>
  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">RVDSD</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">228</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">13</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">112</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          <div class="links-of-author motion-element">
            
          </div>

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#前言"><span class="nav-number">1.</span> <span class="nav-text">前言</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#小鼠饲料案例"><span class="nav-number">2.</span> <span class="nav-text">小鼠饲料案例</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#lm函数背后的数学原理"><span class="nav-number">3.</span> <span class="nav-text">lm()函数背后的数学原理</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#线性回归系数"><span class="nav-number">4.</span> <span class="nav-text">线性回归系数</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#练习"><span class="nav-number">5.</span> <span class="nav-text">练习</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#标准误"><span class="nav-number">6.</span> <span class="nav-text">标准误</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#自由落体"><span class="nav-number">7.</span> <span class="nav-text">自由落体</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#父子身高"><span class="nav-number">8.</span> <span class="nav-text">父子身高</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#方差-协方差矩阵"><span class="nav-number">9.</span> <span class="nav-text">方差-协方差矩阵</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#线性组合的方差"><span class="nav-number">10.</span> <span class="nav-text">线性组合的方差</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#les标准误"><span class="nav-number">11.</span> <span class="nav-text">LES标准误</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#估计sigma2"><span class="nav-number">12.</span> <span class="nav-text">估计\(\sigma^2\)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#估计值的线性组合"><span class="nav-number">13.</span> <span class="nav-text">估计值的线性组合</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#clt与t分布"><span class="nav-number">14.</span> <span class="nav-text">CLT与t分布</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#代码与数学"><span class="nav-number">15.</span> <span class="nav-text">代码与数学</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#练习-1"><span class="nav-number">16.</span> <span class="nav-text">练习</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

<div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">RVDSD</span>

  
</div>



<div class="powered-by">
<i class="fa fa-user-md"></i><span id="busuanzi_container_site_pv">
  本站访客数:<span id="busuanzi_value_site_uv"></span>
</span>
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>


<div class="BbeiAn-info">
	<a target="_blank" href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=41018102000118" style="color:#909090;text-decoration:none;padding-left:0px;no-repeat left center" rel="nofollow">豫公网安备 41018102000118</a>	  <!--这里将图标作为了背景，以使得能和后面的文字在同一行-->
</div>

  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.3</div>




<div class="theme-info">
  <div class="powered-by"></div>
  <span class="post-count">博客全站共917.9k字</span>
</div>

        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.3"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.3"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.3"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.3"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.3"></script>



  


  




	





  





  












  





  

  

  
  

  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config("");
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="custom_mathjax_source">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->
  


  

  

</body>
</html>
