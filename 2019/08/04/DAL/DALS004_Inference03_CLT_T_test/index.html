<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.3" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.3">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.3" color="#222">





  <meta name="keywords" content="统计推断," />










<meta name="description" content="前言 这篇笔记是《Data Analysis for the Life Sciences》的第2章统计推断(Inference)的第3部分。这一部分的主要内容涉及中心极限理论，t检验和功效计算。 中心极限定理(Central Limit Theorem)与t分布 中心极限定理(CLT) 当样本的数目非常大时，一个随机样本的均值 \(\bar{Y}\) 就会服从正态分布，这个正态分布的均值是">
<meta name="keywords" content="统计推断">
<meta property="og:type" content="article">
<meta property="og:title" content="DALS004-统计推断(Inference)02-CLT与T-test">
<meta property="og:url" content="http://rvdsd.top/2019/08/04/DAL/DALS004_Inference03_CLT_T_test/index.html">
<meta property="og:site_name" content="RVDSD的个人笔记本">
<meta property="og:description" content="前言 这篇笔记是《Data Analysis for the Life Sciences》的第2章统计推断(Inference)的第3部分。这一部分的主要内容涉及中心极限理论，t检验和功效计算。 中心极限定理(Central Limit Theorem)与t分布 中心极限定理(CLT) 当样本的数目非常大时，一个随机样本的均值 \(\bar{Y}\) 就会服从正态分布，这个正态分布的均值是">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190721200113.png">
<meta property="og:image" content="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190721200657.png">
<meta property="og:image" content="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190721204249.png">
<meta property="og:image" content="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190721205303.png">
<meta property="og:image" content="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190727104205.png">
<meta property="og:image" content="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190727142655.png">
<meta property="og:image" content="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190728085017.png">
<meta property="og:image" content="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190728122626.jpeg">
<meta property="og:image" content="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190728123209.jpeg">
<meta property="og:image" content="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190728125345.jpeg">
<meta property="og:updated_time" content="2019-09-18T05:21:07.476Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="DALS004-统计推断(Inference)02-CLT与T-test">
<meta name="twitter:description" content="前言 这篇笔记是《Data Analysis for the Life Sciences》的第2章统计推断(Inference)的第3部分。这一部分的主要内容涉及中心极限理论，t检验和功效计算。 中心极限定理(Central Limit Theorem)与t分布 中心极限定理(CLT) 当样本的数目非常大时，一个随机样本的均值 \(\bar{Y}\) 就会服从正态分布，这个正态分布的均值是">
<meta name="twitter:image" content="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190721200113.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.3',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://rvdsd.top/2019/08/04/DAL/DALS004_Inference03_CLT_T_test/"/>





  <title>DALS004-统计推断(Inference)02-CLT与T-test | RVDSD的个人笔记本</title><!-- hexo-inject:begin --><!-- hexo-inject:end -->
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">RVDSD的个人笔记本</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2019/08/04/DAL/DALS004_Inference03_CLT_T_test/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">DALS004-统计推断(Inference)02-CLT与T-test</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-08-04T12:00:00+08:00">
                2019-08-04
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Data-Analysis-for-the-life-sciences/" itemprop="url" rel="index">
                    <span itemprop="name">Data Analysis for the life sciences</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  10,047
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  40
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h2 id="前言">前言</h2>
<p>这篇笔记是《Data Analysis for the Life Sciences》的第2章统计推断(Inference)的第3部分。这一部分的主要内容涉及中心极限理论，t检验和功效计算。</p>
<h2 id="中心极限定理central-limit-theorem与t分布">中心极限定理(Central Limit Theorem)与t分布</h2>
<h3 id="中心极限定理clt">中心极限定理(CLT)</h3>
<p>当样本的数目非常大时，一个随机样本的均值 <span class="math inline">\(\bar{Y}\)</span> 就会服从正态分布，这个正态分布的均值是总体均值( <span class="math inline">\(\mu_{Y}\)</span> )，标准差是总体的标准差 <span class="math inline">\(\sigma_{Y}\)</span> 除以样本的数目 <span class="math inline">\(N\)</span> 的平方根。</p>
<p>如果我们将一个随机变量减去一个常数，那么这个新生成的随机变量就由该常数转换而来的（原文是：Please note that if we subtract a constant from a random variable, the mean of the new random variable shifts by that constant。我个人的理解就是，这个新的变量就是与原来的变量相差这个常数），从数学角度来说，如果<span class="math inline">\(X\)</span>是一个服从均值为 <span class="math inline">\(\mu\)</span> 的分布，<span class="math inline">\(a\)</span>是一个常数，那么 <span class="math inline">\(X-a\)</span> 的均值的分布的均值就是<span class="math inline">\(\mu-a\)</span>。这个也适应用乘法与标准差(SD)。</p>
<p>如果 <span class="math inline">\(X\)</span> 是一个随机变量，它总体分布的均值为 <span class="math inline">\(\mu\)</span> 和标准差(SD)为 <span class="math inline">\(\sigma\)</span> ，而<span class="math inline">\(a\)</span>是一个常数，那么 <span class="math inline">\(aX\)</span> 这个新的随机变量分布的均值是<span class="math inline">\(a\mu\)</span>，标准差为<span class="math inline">\(|a|\sigma\)</span>。为了说明这一点，我们就假设，每只小鼠的体重都减去10，那么平均体重也应该会减去10，类似的，如果我们将小鼠的体重单位由克(g, gram)换成毫克(mg, milligram)，也就相当于把原来的数字都乘以了1000，那么数字的扩散程度（这个扩散程度就是方差或标准差）也会变大。</p>
<p>这就说明了，如果我们获得了 <span class="math inline">\(N\)</span> 个样本，那么这个公式 <span class="math inline">\(\frac{\overline{Y}-\mu}{\sigma_{Y} / \sqrt{N}}\)</span> 就接近于均值为0，标准差为1的正态分布。</p>
<p>现在我们感兴趣的是两个样本的均值的差值。这个数学公式就比较有用了。</p>
<p>如果我们有两个随机变量，即 <span class="math inline">\(X\)</span> 和 <span class="math inline">\(Y\)</span> ，它们的总体均值与总体均值差为<span class="math inline">\(\mu_{X}\)</span>和<span class="math inline">\(\mu_{Y}\)</span>，<span class="math inline">\(\sigma_{X}\)</span>和<span class="math inline">\(\sigma_{Y}\)</span>，然后我们就会得到这些结果：</p>
<p><span class="math inline">\(X+Y\)</span>的均值：<span class="math inline">\(\mu_{X}+\mu_{Y}\)</span>。</p>
<p>也会得到<span class="math inline">\(Y-X\)</span>的均值，其实这也相当于<span class="math inline">\(Y-X=Y+aX\)</span>，其中<span class="math inline">\(a=-1\)</span>，这其实也就是说<span class="math inline">\(Y-X\)</span>的均值为<span class="math inline">\(\mu_{Y}-\mu_{X}\)</span>。</p>
<p>如果说<span class="math inline">\(X\)</span>和<span class="math inline">\(Y\)</span>是相互独立的样本，那么<span class="math inline">\(Y+X\)</span>的方差，就是<span class="math inline">\(\sigma_{Y}^2+\sigma_{X}^2\)</span>，从这里我们可以推到，<span class="math inline">\(Y-X\)</span>，也即<span class="math inline">\(Y+aX\)</span>（其中a为-1）的方差是<span class="math inline">\(\sigma_{Y}^2+a^2\sigma_{X}^2=\sigma_{Y}^2+\sigma_{X}^2\)</span>。因此说，<span class="math inline">\(Y-X\)</span>这个差值的方差也是两个样本的方差和，这有点反直觉，我们需要知道的就是，X与Y这两个样本是相互独立的，它们确实不相互影响。</p>
<p>从数学角度来理解上面的内容对我们的研究目（两个样本的均值，以及均值的差值）。因此这两个样本都服从正态分布，它们的差值也服从正态分布，方差是两个样本总体的方差之和。在零假设（也就是说这两个样本所代表的两个总体的均值没有差异）成立的前提下，样本均值<span class="math inline">\(\bar{Y}-\bar{X}\)</span>的差值的分布接近于均值为0（也就是说没有差异），标准差为<span class="math inline">\(\sqrt{\sigma_{X}^{2}+\sigma_{Y}^{2}} / \sqrt{N}\)</span>的正态分布，也就是说下面的这个公式： <span class="math display">\[
\frac{\overline{Y}-\overline{X}}{\sqrt{\frac{\sigma_{X}^{2}}{M}+\frac{\sigma_{Y}^{2}}{N}}}
\]</span> 的值的分布接近于标准正态分布（均值为0，标准差为1）。</p>
<p>通过这种近似计算，我们就能够将计算p值的过程简单化，因为我们已经知道了标准正态分布下任意值范围的比例。例如，这些值中只有5%的比例会大于2（绝对值），计算过程如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pnorm(-<span class="number">2</span>) + (<span class="number">1</span> - pnorm(<span class="number">2</span>))</div></pre></td></tr></table></figure>
<p>计算结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; pnorm(-<span class="number">2</span>) + (<span class="number">1</span> - pnorm(<span class="number">2</span>))</div><div class="line">[<span class="number">1</span>] <span class="number">0.04550026</span></div></pre></td></tr></table></figure>
<p>从上面结果我们就可以知道，只有5%的可能性会大于2，我们前面计算的obstdiff的值是3.020833，因此12只小鼠足够了，不需要买更多的小鼠。</p>
<p>但是，这还没完。因为我们并不知道总体的标准差，也就是不知道<span class="math inline">\(\sigma_{X}\)</span>与<span class="math inline">\(\sigma_{Y}\)</span>。它们是未知的总体参数，但是，我们可以通过样本的标准差对它们进行估算，估算的总体标准差我们不能希腊字母<span class="math inline">\(\mu\)</span>来表示，只能用<span class="math inline">\(s\)</span>来表示，那么它们的估计值如下所示： <span class="math display">\[
s_{X}^{2}=\frac{1}{M-1} \sum_{i=1}^{M}\left(X_{i}-\overline{X}\right)^{2} \text { and } s_{Y}^{2}=\frac{1}{N-1} \sum_{i=1}^{N}\left(Y_{i}-\overline{Y}\right)^{2}
\]</span> 我们需要注意的是，上面的公式里面除以的是<span class="math inline">\(M-1\)</span>与<span class="math inline">\(N-1\)</span>，而不是前面的<span class="math inline">\(M\)</span>与<span class="math inline">\(N\)</span>，这有数学方面计算的原因，这里不表，记住就行。但是，为了更加直观地说明一些东西，我们还是要涉及一点。试想，如果你有2个数，把它们画在数轴上，它们之间的距离如果是L，那么中间的那一点就是它们的平均值，这个平均值离它们的距离分别都是0.5L。因此，从这个角度来说，你从这2个数中的一个就能够获取这个信息（这涉及自由度的问题），而不需要2个数，这点不怎么重要，重要的一点是，我们是用了<span class="math inline">\(s_{X}\)</span>和<span class="math inline">\(s_{Y}\)</span>来估计总体的均值，即<span class="math inline">\(\sigma_{X}\)</span>和<span class="math inline">\(\sigma_{Y}\)</span>，因为总体均值未知，只能靠样本均值来估计。</p>
<p>因此我们就把前面的那个公式： <span class="math display">\[
\frac{\overline{Y}-\overline{X}}{\sqrt{\frac{\sigma_{X}^{2}}{M}+\frac{\sigma_{Y}^{2}}{N}}}
\]</span> 定义为下面的这个样子： <span class="math display">\[
\frac{\overline{Y}-\overline{X}}{\sqrt{\frac{s_{X}^{2}}{M}+\frac{s_{Y}^{2}}{N}}}
\]</span> 如果<span class="math inline">\(M=N\)</span>，那么公式就可以化简为如下所示： <span class="math display">\[
\sqrt{N} \frac{\overline{Y}-\overline{X}}{\sqrt{s_{X}^{2}+s_{Y}^{2}}}
\]</span> CLT告诉我们，当M与N足够大的时候，上面的这个随机变量就会服从均值为0，标准差为1的正态分布。</p>
<h3 id="t分布">t分布</h3>
<p>CLT的计算依赖于大量的样本，也就是我们指的渐进性结果。当CLT不适用时，还需要另外一种不依赖于渐进性结果的选择。当原始总体来源于一个变量，也就是<span class="math inline">\(Y\)</span>时，如果这个<span class="math inline">\(Y\)</span>是服从均值为0的标准正态分布，那么我们就可以计算下面这个变量的分布： <span class="math display">\[
\sqrt{N} \frac{\overline{Y}}{s_{Y}}
\]</span> 这是两个随机变量的比值，因此这个比值不一定服从正态分布。事实上，这个公式的分母会偶然变小，因此就相应地会增加观察到更大值的概率。Gosset最初发现的这种分布，由于他开始在论文中以Student的名义投的稿，因此就称这种分布为Student‘s t-distribution，也就是t分布。</p>
<p>现在我们以小鼠的表型数据为例说明一下，我们创建2向量，一个当作对照总体，一个当作高脂总体，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">url &lt;- <span class="string">"https://raw.githubusercontent.com/genomicsclass/dagdata/master/inst/extd\</span></div><div class="line"><span class="string">ata/mice_pheno.csv"</span></div><div class="line">filename &lt;- <span class="string">"mice_pheno.csv"</span></div><div class="line">download(url,destfile=filename)</div><div class="line">dat &lt;- read.csv(filename)</div><div class="line">head(dat)</div><div class="line"></div><div class="line"><span class="keyword">library</span>(dplyr)</div><div class="line">controlPopulation &lt;- filter(dat, Sex == <span class="string">"F"</span> &amp; Diet == <span class="string">"chow"</span>) %&gt;% select(Bodyweight) %&gt;% unlist</div><div class="line">hfPopulation &lt;- filter(dat, Sex == <span class="string">"F"</span> &amp; Diet == <span class="string">"hf"</span>) %&gt;% select(Bodyweight) %&gt;% unlist</div></pre></td></tr></table></figure>
<p>这里需要注意提，我们假设的是的<span class="math inline">\(y_{1},y_{2},\dots,y_{n}\)</span>的分布，而不是随机变量<span class="math inline">\(\bar{Y}\)</span>的分布。现在我们来看一下这两个总体的分布：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">library</span>(rafalib)</div><div class="line">mypar(<span class="number">1</span>,<span class="number">2</span>)</div><div class="line">hist(hfPopulation)</div><div class="line">hist(controlPopulation)</div></pre></td></tr></table></figure>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190721200113.png">

</div>
<p>我们可以使用qq图来确认一下上面的分布是比较接近正态分布的，这里我们只作初步了解，更详细的了解在后面。如果在qq图上，点大致都藻在一条直线附近，它们就属于正态分布，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">mypar(<span class="number">1</span>,<span class="number">2</span>)</div><div class="line">qqnorm(hfPopulation)</div><div class="line">qqline(hfPopulation)</div><div class="line">qqnorm(controlPopulation)</div><div class="line">qqline(controlPopulation)</div></pre></td></tr></table></figure>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190721200657.png">

</div>
<h2 id="练习">练习</h2>
<p>P47</p>
<h2 id="中心极限定理的实际运用">中心极限定理的实际运用</h2>
<p>现在我们使用上面的数据来看一下，中心极限定理是如何逼近样本的均值的：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">url &lt;- <span class="string">"https://raw.githubusercontent.com/genomicsclass/dagdata/master/inst/extd\</span></div><div class="line"><span class="string">ata/mice_pheno.csv"</span></div><div class="line">filename &lt;- <span class="string">"mice_pheno.csv"</span></div><div class="line">download(url,destfile=filename)</div><div class="line">dat &lt;- read.csv(filename)</div><div class="line">head(dat)</div><div class="line"></div><div class="line"><span class="keyword">library</span>(dplyr)</div><div class="line">controlPopulation &lt;- filter(dat, Sex == <span class="string">"F"</span> &amp; Diet == <span class="string">"chow"</span>) %&gt;% select(Bodyweight) %&gt;% unlist</div><div class="line">hfPopulation &lt;- filter(dat, Sex == <span class="string">"F"</span> &amp; Diet == <span class="string">"hf"</span>) %&gt;% select(Bodyweight) %&gt;% unlist</div><div class="line">mu_hf &lt;- mean(hfPopulation)</div><div class="line">mu_control &lt;- mean(controlPopulation)</div><div class="line">mu_hf - mu_control</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">&gt; head(dat)</div><div class="line">  Sex Diet Bodyweight</div><div class="line"><span class="number">1</span>   <span class="literal">F</span>   hf      <span class="number">31.94</span></div><div class="line"><span class="number">2</span>   <span class="literal">F</span>   hf      <span class="number">32.48</span></div><div class="line"><span class="number">3</span>   <span class="literal">F</span>   hf      <span class="number">22.82</span></div><div class="line"><span class="number">4</span>   <span class="literal">F</span>   hf      <span class="number">19.92</span></div><div class="line"><span class="number">5</span>   <span class="literal">F</span>   hf      <span class="number">32.22</span></div><div class="line"><span class="number">6</span>   <span class="literal">F</span>   hf      <span class="number">27.50</span></div><div class="line">&gt; </div><div class="line">&gt; <span class="keyword">library</span>(dplyr)</div><div class="line">&gt; controlPopulation &lt;- filter(dat, Sex == <span class="string">"F"</span> &amp; Diet == <span class="string">"chow"</span>) %&gt;% select(Bodyweight) %&gt;% unlist</div><div class="line">&gt; hfPopulation &lt;- filter(dat, Sex == <span class="string">"F"</span> &amp; Diet == <span class="string">"hf"</span>) %&gt;% select(Bodyweight) %&gt;% unlist</div><div class="line">&gt; mu_hf &lt;- mean(hfPopulation)</div><div class="line">&gt; mu_control &lt;- mean(controlPopulation)</div><div class="line">&gt; mu_hf - mu_control</div><div class="line">[<span class="number">1</span>] <span class="number">2.375517</span></div></pre></td></tr></table></figure>
<p>现在计算一下总体的标准差，这里不要使用R的<code>sd()</code>函数，因此这个函数是计算样本的标准差的，它会除以<code>(n-1)</code>，当我们想要对总体进行估计时，按以下代码计算：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">x &lt;- controlPopulation</div><div class="line">N &lt;- length(x)</div><div class="line">populationvar &lt;- mean((x-mean(x))^<span class="number">2</span>)</div><div class="line">populationvar</div><div class="line">var(x)</div><div class="line">var(x)*(N-<span class="number">1</span>)/N</div><div class="line">identical(var(x)*(N-<span class="number">1</span>)/N,populationvar)</div><div class="line">identical(var(x), populationvar)</div></pre></td></tr></table></figure>
<p>计算结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">&gt; populationvar</div><div class="line">[<span class="number">1</span>] <span class="number">11.67205</span></div><div class="line">&gt; var(x)</div><div class="line">[<span class="number">1</span>] <span class="number">11.72416</span></div><div class="line">&gt; var(x)*(N-<span class="number">1</span>)/N</div><div class="line">[<span class="number">1</span>] <span class="number">11.67205</span></div><div class="line">&gt; identical(var(x)*(N-<span class="number">1</span>)/N,populationvar)</div><div class="line">[<span class="number">1</span>] <span class="literal">TRUE</span></div><div class="line">&gt; identical(var(x), populationvar)</div><div class="line">[<span class="number">1</span>] <span class="literal">FALSE</span></div></pre></td></tr></table></figure>
<p>因此，为了在数学计算上是准确的，我们不使用<code>sd()</code>或<code>var()</code>函数，我们可以使用<code>rafalib</code>包中的<code>popvar()</code>与<code>popsd()</code>函数，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">library</span>(rafalib)</div><div class="line">sd_hf &lt;- popsd(hfPopulation)</div><div class="line">sd_control &lt;- popsd(controlPopulation)</div></pre></td></tr></table></figure>
<p>这里需要注意，在实际统计中，我们并不会计算总体参数，我们通常是由样本来估计总体参数，现在我们从总体中抽样，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">N &lt;- <span class="number">12</span></div><div class="line">hf &lt;- sample(hfPopulation, N)</div><div class="line">control &lt;- sample(controlPopulation,N)</div></pre></td></tr></table></figure>
<p>CLT告诉我们，对于更大的N来说，这些样本都近拉于正态分布。作为一种经验，这个N通常是大于30，这仅是一个经验法则，具体来说，它还需要取决于总体的分布。这里我们实际上可以查看一下近似值，并对各种N值进行计算，代码如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Ns &lt;- c(<span class="number">3</span>, <span class="number">12</span>, <span class="number">25</span>, <span class="number">50</span>)</div><div class="line">B &lt;- <span class="number">10000</span></div><div class="line">res &lt;- sapply(Ns, <span class="keyword">function</span>(n)&#123;</div><div class="line">  replicate(B, mean(sample(hfPopulation, n)) - mean(sample(controlPopulation, n)))</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<p>现在使用qq图看一下CLT理论对这些数据的近似值的适应情况。如果这些数据非常接近正态分布，那么这些数据点就会落在一个直线上（这个直接是正态分布的分位数(quantiles))。越偏离，说明数据越不符合正态分布，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">mypar(<span class="number">2</span>,<span class="number">2</span>)</div><div class="line"><span class="keyword">for</span> (i <span class="keyword">in</span> seq(along=Ns))&#123;</div><div class="line">  titleavg &lt;- signif(mean(res[,i]),<span class="number">3</span>)</div><div class="line">  titlesd &lt;- signif(popsd(res[,i]),<span class="number">3</span>)</div><div class="line">  title &lt;- paste0(<span class="string">"N="</span>, Ns[i], <span class="string">"Avg="</span>, titleavg, <span class="string">" SD="</span>, titlesd)</div><div class="line">  qqnorm(res[,i], main = title)</div><div class="line">  qqline(res[,i], col=<span class="number">2</span>)</div><div class="line">  </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190721204249.png">

</div>
<p>从上面结果可以看出来，第3组数据的拟合结果最合适，这是因为它的总体相对最接近正态分布，平均值也最接近于正态分布。在实际中，我们可以计算这样一个比值：除以估计的标准误差来判断，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">Ns &lt;- c(<span class="number">3</span>, <span class="number">12</span>, <span class="number">25</span>, <span class="number">50</span>)</div><div class="line">B &lt;- <span class="number">10000</span></div><div class="line">computetstat &lt;- <span class="keyword">function</span>(n)&#123;</div><div class="line">  y &lt;- sample(hfPopulation, n)</div><div class="line">  x &lt;- sample(controlPopulation, n)</div><div class="line">  (mean(y)- mean(x))/sqrt(var(y)/n+var(x)/n)</div><div class="line">&#125;</div><div class="line">res &lt;- sapply(Ns, <span class="keyword">function</span>(n)&#123;</div><div class="line">  replicate(B, computetstat(n))</div><div class="line">&#125;)</div><div class="line"></div><div class="line">mypar(<span class="number">2</span>,<span class="number">2</span>)</div><div class="line"><span class="keyword">for</span> (i <span class="keyword">in</span> seq(along=Ns))&#123;</div><div class="line">  qqnorm(res[,i], main = Ns[i])</div><div class="line">  qqline(res[,i], col=<span class="number">2</span>)</div><div class="line">  </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190721205303.png">

</div>
<p>从上面可以看出来，当<span class="math inline">\(N=3\)</span>时，CLT并不会提供一个有用的估计，当<span class="math inline">\(N=12\)</span>时，在较大值的点方面，稍微有点偏离。当<span class="math inline">\(N=25\)</span>或<span class="math inline">\(N=50\)</span>时，所有的点基本上都在直线上。</p>
<p>也就是说，在这个案例中，只要<span class="math inline">\(N=12\)</span>就能证明CLT，就像前言提到的那样，在多数情况下，这种模拟并不会很好。我们在这里只是通过这种模拟手段来说明CLT背后的思想与局限。</p>
<h2 id="练习-1">练习</h2>
<p>P52</p>
<h2 id="t检验的实际计算">t检验的实际计算</h2>
<p>现在我们来看一下如何通过计算得到p值，先来导入数据，在这一步中，我们要确定哪些是treatment组，哪些是control组，并且计算出它们的均值差异，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">library</span>(dplyr)</div><div class="line">dir &lt;- system.file(package = <span class="string">"dagdata"</span>)</div><div class="line">filename &lt;- file.path(dir,<span class="string">"extdata/femaleMiceWeights.csv"</span>)</div><div class="line">dat &lt;- read.csv(filename)</div><div class="line">control &lt;- filter(dat,Diet==<span class="string">"chow"</span>) %&gt;% select(Bodyweight) %&gt;% unlist</div><div class="line">treatment &lt;- filter(dat,Diet==<span class="string">"hf"</span>) %&gt;% select(Bodyweight) %&gt;% unlist</div><div class="line">diff &lt;- mean(treatment) - mean(control)</div><div class="line">print(diff)</div></pre></td></tr></table></figure>
<p>计算结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; print(diff)</div><div class="line">[<span class="number">1</span>] <span class="number">3.020833</span></div></pre></td></tr></table></figure>
<p>现在我们开始计算p值，上面的代码中有一个<code>diff</code>变量，可以称为<code>observed effect size</code>，这是一个随机变量，我们还知道，在零假设的前提下，<code>diff</code>均值的分布是0，而这个随机变量分布的标准误则是总体的标准差(population standard deviation)除了样本数目的平方根，如下所示： <span class="math display">\[
S E(\overline{X})=\sigma / \sqrt{N}
\]</span> 我们使用样本样本标准差(sample standard deviation)来对总体的标准差(population standard deviation)进行估计，在R中，也可以使用的<code>sd()</code>函数来计算标准误(SE)，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sd(control)/sqrt(length(control))</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; sd(control)/sqrt(length(control))</div><div class="line">[<span class="number">1</span>] <span class="number">0.8725323</span></div></pre></td></tr></table></figure>
<p>这个值就是样本均值(sample average)的SE，不过实际上，我们相想要的是<code>diff</code>的SE。我们前面已经知道了，统计学理论告诉我们，两个随机变量差的方差是原两个随机变量方差的和，因此我们计算一下方差以及平方根：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">se &lt;- sqrt(</div><div class="line">var(treatment)/length(treatment) +</div><div class="line">var(control)/length(control)</div><div class="line">)</div><div class="line">se</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; se</div><div class="line">[<span class="number">1</span>] <span class="number">1.469867</span></div></pre></td></tr></table></figure>
<p>统计学理论还告诉我们，如果我们将一个随机变量除以其SE，我们就会得到一个SE为1的新的随机变量，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">tstat &lt;- diff/se</div><div class="line">tstat</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&gt; tstat &lt;- diff/se</div><div class="line">&gt; tstat</div><div class="line">[<span class="number">1</span>] <span class="number">2.055174</span></div></pre></td></tr></table></figure>
<p>上面计算出来的<code>tstat</code>就是我们称的t统计量(t-statistic)。这是两个随机变量的比值，因此它也是一个随机变量。一旦我们知道了这个随机的分布，我们就很容易计算出其p值。</p>
<p>前面我们提到，CLT可以告诉我们，如果有大样本(large sample size)，那么样本的均值<code>mean(treatment)</code>和<code>mean(control)</code>都服从正态分布。统计学理论告诉我们，两个正态分布的随机变量的差值还服从正态分布，因此CLT也告诉我们，<code>tstat</code>接近于均值为0(零假设)，SD为1（我们除以它的SE）的正态分布。</p>
<p>现在我们要计算一下p值，此时我们需要问的一个问题就是：一个服从正态分布的随机变量有多大的概率会大于<code>diff</code>？R语言中的有一个<code>pnorm()</code>函数有解决这个问题。<code>pnorm(a)</code>会以返回一个值，这个值就是概率，它表示在一个标准正态分布中，一个随机变量低于<code>a</code> 的概率，具体这个函数的原理与用法，可以参考这篇笔记《R语言中dnorm, pnorm, qnorm与rnorm以及随机数》。</p>
<p>如果要计算大于<code>a</code>的概率，那么可以使用<code>1-pnorm(a)</code>，如果我们想知道看到一些像diff这种极端事件的概率：例如要么小于（更多的时候指的是负值）<code>-abs(diff)</code>，要么是大于<code>abs(diff)</code>，那么我们也可以过计算这两个尾部区域的概率：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">righttail &lt;- <span class="number">1</span>-pnorm(abs(tstat))</div><div class="line">lefttail &lt;- pnorm(-abs(tstat))</div><div class="line">pval &lt;- lefttail + righttail</div><div class="line">print(pval)</div></pre></td></tr></table></figure>
<p>计算结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; print(pval)</div><div class="line">[<span class="number">1</span>] <span class="number">0.0398622</span></div></pre></td></tr></table></figure>
<p>在这个案例中，p值小于0.05，根据传统的p值阈值0.05，我们就可以下给结论，这种差值有统计学意义。</p>
<p>现在我们就面临一个问题，CLT只有在大样本的前提下才有效，12个样本这个数目够么？根据经验法则，通常大于30个样本（这仅仅是经验法则），就能满足CLT。我们计算的这个p值，只有在假设成立的前提下才是有效的近似值，而实际情况并非如此，还好，除了CLT之外，我们还有另外一种选择。</p>
<h2 id="t分布的实际计算">t分布的实际计算</h2>
<p>如果一个总体的分布是正态分布，那么我们在不需要CLT思想的前提下，就可以计算出t-statistic的精确分布。但是，如果我们只有小样本，我们就很难知道总体是否是正态的。但是，对于一些常见的统计量，例如体重，我们就可以猜测它的总体分布非常接近于正态分布，因此我们可以使用这种近似。此外，我们可以使用对样本画qq图，它会显示出样本的分布，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">library</span>(rafalib)</div><div class="line">mypar(<span class="number">1</span>,<span class="number">2</span>)</div><div class="line">qqnorm(treatment)</div><div class="line">qqline(treatment,col=<span class="number">2</span>)</div><div class="line">qqnorm(control)</div><div class="line">qqline(control,col=<span class="number">2</span>)</div></pre></td></tr></table></figure>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190727104205.png">

</div>
<p>如果我们使用这种近似计算，那么从统计学理论角度来讲我们随机变量<code>tstat</code>的分布就服从一个t分布(<code>-t-distribution</code>)，这种分布比正态分布更复杂。t分布没有像正态分布那样的位置参数( location parameter )，正态分布的参数是自由度(<code>degrees of freedom</code>)，R中的<code>t.test()</code>函数可以用于计算相应的p值，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">t.test(treatment, control)</div></pre></td></tr></table></figure>
<p>计算结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">&gt; t.test(treatment, control)</div><div class="line"></div><div class="line">	Welch Two Sample t-test</div><div class="line"></div><div class="line">data:  treatment and control</div><div class="line">t = <span class="number">2.0552</span>, df = <span class="number">20.236</span>, p-value = <span class="number">0.053</span></div><div class="line">alternative hypothesis: true difference <span class="keyword">in</span> means is not equal to <span class="number">0</span></div><div class="line"><span class="number">95</span> percent confidence interval:</div><div class="line"> -<span class="number">0.04296563</span>  <span class="number">6.08463229</span></div><div class="line">sample estimates:</div><div class="line">mean of x mean of y </div><div class="line"> <span class="number">26.83417</span>  <span class="number">23.81333</span></div></pre></td></tr></table></figure>
<p>如果只想看p值，那么使用以下代码即可，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">result &lt;- t.test(treatment,control)</div><div class="line">result$p.value</div></pre></td></tr></table></figure>
<p>结果如下：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&gt; result &lt;- t.test(treatment,control)</div><div class="line">&gt; result$p.value</div><div class="line">[<span class="number">1</span>] <span class="number">0.05299888</span></div></pre></td></tr></table></figure>
<p>从计算结果来看，这个p值有点大，这是因为在CLT近似的计算中，<code>tstat</code>的分布实际上是固定的（对于大样本来说，分母实际上就是固定的），而t分布的近似计算则是考虑到了分母（差值的标准误）是一个随机变量，是不固定的，样本数目越小，那分母的变化就越大。</p>
<p>这样来看的，我们使用了两种方法，得到了2个不同的p值，这在数据分析过程中很常见，因为我们是使用了不同的前提，不同的近似，因此会得到不同的结果。在后面讲到的功效计算(power calculation)中，我们会讲到I类错误，II类错误。在这里我们只说一下，使用CLT近似会错误地拒绝( incorrectly reject )零假设(假阳性)，而t分布则会错误地接受(inccorrectly acept)零假设(假阴性)。</p>
<p>在R中计算t检验如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">library</span>(dplyr)</div><div class="line">dir &lt;- system.file(package = <span class="string">"dagdata"</span>)</div><div class="line">filename &lt;- file.path(dir,<span class="string">"extdata/mice_pheno.csv"</span>)</div><div class="line">dat &lt;- read.csv(filename)</div><div class="line">control &lt;- filter(dat,Diet==<span class="string">"chow"</span>) %&gt;% select(Bodyweight)</div><div class="line">treatment &lt;- filter(dat,Diet==<span class="string">"hf"</span>) %&gt;% select(Bodyweight)</div><div class="line">t.test(treatment,control)</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">&gt; t.test(treatment,control)</div><div class="line"></div><div class="line">	Welch Two Sample t-test</div><div class="line"></div><div class="line">data:  treatment and control</div><div class="line">t = <span class="number">7.1932</span>, df = <span class="number">735.02</span>, p-value = <span class="number">1.563e-12</span></div><div class="line">alternative hypothesis: true difference <span class="keyword">in</span> means is not equal to <span class="number">0</span></div><div class="line"><span class="number">95</span> percent confidence interval:</div><div class="line"> <span class="number">2.231533</span> <span class="number">3.906857</span></div><div class="line">sample estimates:</div><div class="line">mean of x mean of y </div><div class="line"> <span class="number">30.48201</span>  <span class="number">27.41281</span></div></pre></td></tr></table></figure>
<h2 id="置信区间confidence-intervals">置信区间(Confidence Intervals)</h2>
<p>在生命科学研究中，仅在研究结论中报道p值是不够的，因为统计学上的显著性无法保证科学研究上的意义。例如在对体重的差异进行统计时，使用大样本的情况下，即使是1毫克的差异，也有可能有统计学意义，不过这种1毫克的差异是一个重要的发现么？我们能否说明，某个因素导致了不到1%的体重变化？仅报道p值是无法提供一些有价值的信息的，也不会提供有关效应量(the effect size)的信息，效应量(effect size)就是我们前面提到的观察到的差异(observed difference)。有的时候，效应量会用除以对照组的均值，因此会表示为百分比。</p>
<p>为了纠正仅报道p值偏差，另外一个统计量就提了出来，即置信区间(confidence intervals)。置信区间包括了估计的效应量(estimated effect size)，以及与这个估计有关的不确定性(uncertainty)，现在我们使用这批小鼠数据来计算一下置信区间。</p>
<h3 id="总体均值的置信区间">总体均值的置信区间</h3>
<p>在我们展示如何过计算两组差值的置信区间之前，我们先来看一下如何计算对照组雌性小鼠的总体均值的置信区间。随后，我们会计算样本的置留区间，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">dir &lt;- system.file(package = <span class="string">"dagdata"</span>)</div><div class="line">filename &lt;- file.path(dir,<span class="string">"extdata/mice_pheno.csv"</span>)</div><div class="line">dat &lt;- read.csv(filename)</div><div class="line">chowPopulation &lt;- dat[dat$Sex==<span class="string">"F"</span> &amp; dat$Diet==<span class="string">"chow"</span>,<span class="number">3</span>]</div><div class="line">mu_chow &lt;- mean(chowPopulation)</div><div class="line">print(mu_chow)</div></pre></td></tr></table></figure>
<p>计算结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; print(mu_chow)</div><div class="line">[<span class="number">1</span>] <span class="number">23.89338</span></div></pre></td></tr></table></figure>
<p>现在计算的结果就是 总体均值<span class="math inline">\(\mu_{X}\)</span>。</p>
<p>现在我们对这个结果进行估计，在实际分析过程中，我们并不会获取所有的总体，因此我们也像前面计算p值那样，我们来演示一下，通过抽样的方法来计算置信区间，现在我们先抽30个样本，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">N &lt;- <span class="number">30</span></div><div class="line">chow &lt;- sample(chowPopulation, N)</div><div class="line">print(mean(chow))</div></pre></td></tr></table></figure>
<p>计算结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; print(mean(chow))</div><div class="line">[<span class="number">1</span>] <span class="number">23.95033</span></div></pre></td></tr></table></figure>
<p>我们知道这个均值是一个随机变量，因此样本均值并不是一个非常好的估计。实际上，我们使用这个案例只是为了计算这个样本的均值，每次计算并非完全一样，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">&gt; N &lt;- <span class="number">30</span></div><div class="line">&gt; chow &lt;- sample(chowPopulation, N)</div><div class="line">&gt; print(mean(chow))</div><div class="line">[<span class="number">1</span>] <span class="number">23.48467</span></div><div class="line">&gt; </div><div class="line">&gt; N &lt;- <span class="number">30</span></div><div class="line">&gt; chow &lt;- sample(chowPopulation, N)</div><div class="line">&gt; print(mean(chow))</div><div class="line">[<span class="number">1</span>] <span class="number">25.22967</span></div><div class="line">&gt; </div><div class="line">&gt; N &lt;- <span class="number">30</span></div><div class="line">&gt; chow &lt;- sample(chowPopulation, N)</div><div class="line">&gt; print(mean(chow))</div><div class="line">[<span class="number">1</span>] <span class="number">23.732</span></div></pre></td></tr></table></figure>
<p>如上所示，每次抽样计算的均值都不一样。现在我们来了解一下置信区间，置信区间一种报道你数据中样本均值的一种统计学表示方法，它能明确地显示出随机变量的变异程度。</p>
<p>现在我们的的样本是30，CLT告诉我们，<span class="math inline">\(\bar{X}\)</span>或chow组的均值(mean)服从一个均值为<span class="math inline">\(\mu_{X}\)</span>（这个是chowPopulaiton这个总体的均值，即<code>mean(chowPopulation)</code>，这个均值服从均值为<span class="math inline">\(\mu_{X}\)</span>，标准误<span class="math inline">\(s_{X} / \sqrt{N}\)</span>的标准分布，计算过程如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">se &lt;- sd(chow)/sqrt(N)</div><div class="line">print(se)</div></pre></td></tr></table></figure>
<p>计算结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&gt; se &lt;- sd(chow)/sqrt(N)</div><div class="line">&gt; print(se)</div><div class="line">[<span class="number">1</span>] <span class="number">0.597656</span></div></pre></td></tr></table></figure>
<h3 id="定义区间">定义区间</h3>
<p>95%置信区间是一个随机区间，这个区间有95%概率落在我们估计值的参数中。这里需要注意的是，说95%的随机区间将会包括真值，并不等于说真值有95%的概率落在我们的区间中。为了构建置信区间，我们需要注意，CLT告诉我们，<span class="math inline">\(\sqrt{N}\left(\overline{X}-\mu_{X}\right) / s_{X}\)</span>服从均值为0，SD为1的正态分布，这个概率也就是以下事件的概率： <span class="math display">\[
-2 \leq \sqrt{N}\left(\overline{X}-\mu_{X}\right) / s_{X} \leq 2
\]</span> 在R中的计算为：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pnorm(<span class="number">2</span>) - pnorm(-<span class="number">2</span>)</div></pre></td></tr></table></figure>
<p>计算结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; pnorm(<span class="number">2</span>) - pnorm(-<span class="number">2</span>)</div><div class="line">[<span class="number">1</span>] <span class="number">0.9544997</span></div></pre></td></tr></table></figure>
<p>这个值与95%很接近，也就是<code>qnorm(1-0.05/2)</code>的这个值，现在我们把上面的公式变换一下，把<span class="math inline">\(\mu_{X}\)</span>放中间，就成了如下的样子： <span class="math display">\[
\overline{X}-2 s_{X} / \sqrt{N} \leq \mu_{X} \leq \overline{X}+2 s_{X} / \sqrt{N}
\]</span></p>
<p>也就是上面这个值的概率是95%。需要注意的是，区间<span class="math inline">\(\overline{X} \pm 2 s_{X} / \sqrt{N}\)</span>是两个边界，它们是随机的。此外，我们需要明确一下，置信区间的定义是，95%的随机区间（random intervals)包含真正的固定值<span class="math inline">\(\mu_{X}\)</span>。对于一个计算结果来说，计算出来的这个特定的区间，它要么包括固定的总体均值<span class="math inline">\(\mu\)</span>，要么不包括。</p>
<p>现在我们来模拟一下其中的思路，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">N &lt;- <span class="number">30</span></div><div class="line">chow &lt;- sample(chowPopulation, N)</div><div class="line">se &lt;- sd(chow)/sqrt(N)</div><div class="line">Q &lt;- qnorm(<span class="number">1</span> - <span class="number">0.05</span>/<span class="number">2</span>)</div><div class="line">interval &lt;- c(mean(chow)-Q*se, mean(chow) + Q*se)</div><div class="line">interval</div><div class="line">interval[<span class="number">1</span>] &lt; mu_chow &amp; interval[<span class="number">2</span>] &gt; mu_chow</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&gt; interval</div><div class="line">[<span class="number">1</span>] <span class="number">22.17089</span> <span class="number">24.58044</span></div><div class="line">&gt; interval[<span class="number">1</span>] &lt; mu_chow &amp; interval[<span class="number">2</span>] &gt; mu_chow</div><div class="line">[<span class="number">1</span>] <span class="literal">TRUE</span></div></pre></td></tr></table></figure>
<p>从上面我们可以看到，这个区间覆盖了总体均值<span class="math inline">\(\mu_{X}\)</span>或<code>mean(chowPopulation)</code>。但是，如果我们再取另外一批样本的话，有可能不会覆盖总体均值<span class="math inline">\(\mu_{X}\)</span>，但是，统计学理论告诉我们，经过均数次抽样后，这个样本覆盖均值的概率是95%。由于我们能够获取总体数据，现在我们来看一些样本：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">library</span>(rafalib)</div><div class="line">B &lt;- <span class="number">250</span></div><div class="line">mypar()</div><div class="line">plot(mean(chowPopulation)+c(-<span class="number">7</span>, <span class="number">7</span>), c(<span class="number">1</span>,<span class="number">1</span>), type=<span class="string">"n"</span>,</div><div class="line">     xlab=<span class="string">"weight"</span>, ylab = <span class="string">"interval"</span>, ylim=c(<span class="number">1</span>,B))</div><div class="line">abline(v=mean(chowPopulation))</div><div class="line"><span class="keyword">for</span> (i <span class="keyword">in</span> <span class="number">1</span>:B)&#123;</div><div class="line">  chow &lt;- sample(chowPopulation, N)</div><div class="line">  sd &lt;- sd(chow)/sqrt(N)</div><div class="line">  interval &lt;- c(mean(chow)-Q*se, mean(chow)+Q*se)</div><div class="line">  covered &lt;- </div><div class="line">    mean(chowPopulation) &lt;= interval[<span class="number">2</span>] &amp; mean(chowPopulation) &gt;= interval[<span class="number">1</span>]</div><div class="line">  color &lt;- ifelse(covered, <span class="number">1</span>,<span class="number">2</span>)</div><div class="line">  lines(interval, c(i, i), col= color)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190727142655.png">

</div>
<p>在这个案例中，我们模拟了250次随机抽样，计算了250次置信区间，其中颜色表示这个区间是否包含总体均值，其中绿色是包括的，棕色是不包括的。</p>
<p>上面这个案例的置信区间比较大（这个案例除以的是是<span class="math inline">\(\sqrt{5}\)</span>，而非<span class="math inline">\(\sqrt{30}\)</span>），我们可以看到很多区间并未覆盖<span class="math inline">\(\mu_{X}\)</span>，这是因为CLT错误地告诉了我们(chow)的均值是近似地接近于正态分布，实际上这个数据是不太符合正态分布的（在接近<span class="math inline">\(\pm \infty\)</span>的地方，它有一个比较扁平的尾巴）。这种错误会影响我们计算<code>Q</code>值，而这个<code>Q</code>值在计算的时，是以正态分布为前提,，使用<code>qnorm()</code>来计算的。在这种情况下，数据会更符合t分布，现在我们使用<code>qt()</code>函数来计算<code>Q</code>值，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">mypar()</div><div class="line">plot(mean(chowPopulation)+ c(-<span class="number">7</span>,<span class="number">7</span>), c(<span class="number">1</span>,<span class="number">1</span>),type=<span class="string">"n"</span>,</div><div class="line">     xlab=<span class="string">"weight"</span>,ylab=<span class="string">"interval"</span>,ylim=c(<span class="number">1</span>,B))</div><div class="line">abline(v=mean(chowPopulation))</div><div class="line">Q &lt;- qt(<span class="number">1</span>-<span class="number">0.05</span>/<span class="number">2</span>, df=<span class="number">4</span>)</div><div class="line">N &lt;- <span class="number">5</span></div><div class="line"><span class="keyword">for</span> (i <span class="keyword">in</span> <span class="number">1</span>:B)&#123;</div><div class="line">  chow &lt;- sample(chowPopulation, N)</div><div class="line">  se &lt;- sd(chow)/sqrt(N)</div><div class="line">  interval &lt;- c(mean(chow)-Q*se, mean(chow)+Q*se)</div><div class="line">  covered &lt;- mean(chowPopulation) &lt;= interval[<span class="number">2</span>] &amp; mean(chowPopulation) &gt;= interval[<span class="number">1</span>]</div><div class="line">  color &lt;- ifelse(covered, <span class="number">1</span>,<span class="number">2</span>)</div><div class="line">  lines(interval, c(i,i), col=color)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190728085017.png">

</div>
<p>上面这个图中，我们使用了小样本来模拟了250次计算，得到了它的95%置信区间，这个置信区间是基于t分布进行计算的。与前面的那个案例相比，这个案例中置信区间更大，这是因为t分布的尾部更为扁平，得到的置信区间就更大，现在我们来计算一下t分布的累积分分布，并拿它与正态分布比较一下，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">qt(<span class="number">1</span>-<span class="number">0.05</span>/<span class="number">2</span>, df=<span class="number">4</span>)</div><div class="line">qnorm(<span class="number">1</span>-<span class="number">0.05</span>/<span class="number">2</span>)</div></pre></td></tr></table></figure>
<p>计算结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&gt; qt(<span class="number">1</span>-<span class="number">0.05</span>/<span class="number">2</span>, df=<span class="number">4</span>)</div><div class="line">[<span class="number">1</span>] <span class="number">2.776445</span></div><div class="line">&gt; qnorm(<span class="number">1</span>-<span class="number">0.05</span>/<span class="number">2</span>)</div><div class="line">[<span class="number">1</span>] <span class="number">1.959964</span></div></pre></td></tr></table></figure>
<p>从上面结果就可以看出来，t分布的置信区间更大，因此它才能以更大的概率(例如95%)来覆盖<span class="math inline">\(\mu_{X}\)</span>。</p>
<h3 id="置信区间与p值的关系">置信区间与p值的关系</h3>
<p>作者推荐报道实验结果时使用置信区间，而非仅用p值，对于某些原因，我们可能只需要提供p值即可，或者是提供0.05或0.01水平上的统计结果，其实置信区间也能提供这些信息。</p>
<p>当我们谈论t检验(t-test)的p值时，我们实际上是在谈论我们观察到的这两个样本的差值(<span class="math inline">\(\overline{Y}-\overline{X}\)</span>)以及更极端情况下差值的概率，就像是谈论两个总体之间的总体均值之差等于0这种极端情况下的概率。因此我们可以构建一个含有这个观察到的差值的置信区间，不过我们不再写为<span class="math inline">\(\overline{Y}-\overline{X}\)</span>这种形成，而是写为一种新的形式，即<span class="math inline">\(d \equiv \overline{Y}-\overline{X}\)</span>。</p>
<p>当我们来写一个差值的95%置信区间时，使用CLT则会写为<span class="math inline">\(d \pm 2 s_{d} / \sqrt{N}\)</span>这种形式，这个结果并不包含0（假阳性）。因为置信区间不含0，这就暗示了，<span class="math inline">\(d-2 s_{d} / \sqrt{N}&gt;0\)</span>或<span class="math inline">\(d+2 s_{d} / \sqrt{N}&lt;0\)</span>，这种表达形式还说明，<span class="math inline">\(\sqrt{N} d / s_{d}&gt;2\)</span>或<span class="math inline">\(\sqrt{N} d / s_{d}&lt;2\)</span>。这说明，t统计量比2更极端，反过来又说明，p值必然小于0.05（为了更加精确地计算，可以使用<code>qnorm(0.05/2)</code>来替换2）。如果使用t分布来取代CLT，则使用使用<code>qt(0.05/2, df=N-2</code>。总之，一个95%或99%置信区间并不包含0，p它们的p值必然小于0.05或小于0.01。</p>
<p>现在我们使用t检验来计算一下<code>d</code>的置信区间，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">t.test(treatment,control,conf.level=<span class="number">0.95</span>)$conf.int</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&gt; t.test(treatment,control,conf.level=<span class="number">0.95</span>)$conf.int</div><div class="line">[<span class="number">1</span>] <span class="number">2.231533</span> <span class="number">3.906857</span></div><div class="line">attr(,<span class="string">"conf.level"</span>)</div><div class="line">[<span class="number">1</span>] <span class="number">0.95</span></div></pre></td></tr></table></figure>
<p>如果我们把置信水平改为0.9，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&gt; t.test(treatment,control,conf.level=<span class="number">0.90</span>)$conf.int</div><div class="line">[<span class="number">1</span>] <span class="number">2.366479</span> <span class="number">3.771911</span></div><div class="line">attr(,<span class="string">"conf.level"</span>)</div><div class="line">[<span class="number">1</span>] <span class="number">0.9</span></div></pre></td></tr></table></figure>
<p>可以发现，置信区间变小了。</p>
<h2 id="功效计算">功效计算</h2>
<p>在前面的案例中，我们研究了不同包含对小鼠体重的影响，由于我们在使用这个案例的时候，我们研究的是总体，发现了这两种包含对小鼠的体重有着明显的影响，计算结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">library</span>(dplyr)</div><div class="line">dir &lt;- system.file(package = <span class="string">"dagdata"</span>)</div><div class="line">filename &lt;- file.path(dir,<span class="string">"extdata/mice_pheno.csv"</span>)</div><div class="line">dat &lt;- read.csv(filename)</div><div class="line">controlPopulation &lt;- filter(dat, Sex == <span class="string">"F"</span> &amp; Diet == <span class="string">"chow"</span>) %&gt;% dplyr::select(Bodyweight) %&gt;% unlist</div><div class="line">hfPopulation &lt;- filter(dat, Sex == <span class="string">"F"</span> &amp; Diet == <span class="string">"hf"</span>) %&gt;% dplyr::select(Bodyweight) %&gt;% unlist</div><div class="line"></div><div class="line">mu_hf &lt;- mean(hfPopulation)</div><div class="line">mu_control &lt;- mean(controlPopulation)</div><div class="line">print(mu_hf - mu_control)</div><div class="line">print((mu_hf - mu_control)/mu_control*<span class="number">100</span>)</div></pre></td></tr></table></figure>
<p>计算结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&gt; print(mu_hf - mu_control)</div><div class="line">[<span class="number">1</span>] <span class="number">2.375517</span></div><div class="line">&gt; print((mu_hf - mu_control)/mu_control*<span class="number">100</span>)</div><div class="line">[<span class="number">1</span>] <span class="number">9.942157</span></div></pre></td></tr></table></figure>
<p>某些情况下，我们会采用抽样的形式，抽取一定数目的小鼠体重作为样本，此时就不能使用总体的计算方法，而是采用t检验，此时计算得到的p值不一定小于0.05，例如，我们随机抽取5只小鼠来计算一下，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">set.seed(<span class="number">1</span>)</div><div class="line">N &lt;- <span class="number">5</span></div><div class="line">hf &lt;- sample(hfPopulation, N)</div><div class="line">control &lt;- sample(controlPopulation, N)</div><div class="line">t.test(hf,control)$p.value</div></pre></td></tr></table></figure>
<p>计算结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; t.test(hf,control)$p.value</div><div class="line">[<span class="number">1</span>] <span class="number">0.1410204</span></div></pre></td></tr></table></figure>
<p>前后两种的计算方法出现了差异，第一次计算（使用小鼠的总体来进行计算）与第二次计算（随机抽两组的5只小鼠来计算）的p值不一样，是否出现了错误？</p>
<p>在第二次计算中，p值大于0.05，因此我们不拒绝零假设，从而说饮食对小鼠的体重没有影响么？</p>
<p>能否这么讲？答案不是能。</p>
<p>我们只能说，无法拒绝零假设（注意，没有后面那半句：包含对小鼠的体重没有影响）。我们无法拒绝零假设，并不意味着零假设一定为真。在这个特殊的案例中，这里我们面临的一个问题就是，我们没有足够的功效(power)。如果你从事科学研究，很有可能在某些时候不得不做一个功效计算。在很多情况下，这是一种首选义务，因此它可以帮助你在人的研究中，避免使用过多的小鼠，或者是避免使用过多的受试患者。现在我们就来解释一下统计功效(statistical power)的含义。</p>
<h3 id="错误类型">错误类型</h3>
<p>我们要有这么一个思路，一旦我们做统计，就有可能出现计算错误，这也就是为什么p值不等于0。在进行统计时，当p值很小时，这说明我们可以拒绝零假设，但是这种拒绝也有可能犯错误（虽然犯错误的概率很低），例如零假设确实是真时。例如当p值等于0.05时，那么我们重复20实验，就有可能1次会发生零假设成功的事件，统计学家把这种错误称为I类错误(<code>type I error</code>)。</p>
<p>I类错误的定义就是，零假设成立时，我们拒绝了（其实不应该拒绝的），也就是所谓假阳性。这里为什么使用0.05，而不使用0.00001呢？这是因为如果阈值设得过低，成本会非常高。此时我们还要引入II类错误(<code>type I error</code>)，II类错误是指，零假设不成立，但是我们接受了零假设，也就是所谓的假阴性。前面我们抽样了5只小鼠，计算得到的值大于0.05，因此我们无法拒绝零假设（在0.05这个水平上），此时所犯的错误就是II类错误，也就是假阴性（从总体上看，实际上是有差异的，但是我们没有发现）。如果我们把阈值提高到0.25，我们就不会犯这个错误了（计算出的p值为0.1410204），不过通常情况下，不会这么干。</p>
<h3 id="与0.01阈值cut-off">0.05与0.01阈值(cut-off)</h3>
<p>多数的期刊或监管机构都坚持0.01或0.05的显著性水平，当然这么做无可厚非。我们本书的目标就之一就是让读者对p值以及置信区间有一个更深入的理解，以便读者能够在一些情况下做出合理的选择。不幸的是，这些阈值在某些程度上已经滥用，不过这是又是一个容易引起争论的话量，此处不表。</p>
<h3 id="功效计算-1">功效计算</h3>
<p>功效(power)是指：当零假设为假时，拒绝它的概率，原书的描述如下所示：</p>
<blockquote>
<p>Power is the probability of rejecting the null when the null is false.</p>
</blockquote>
<p>不过“零假设为假”这种情况比较复杂，因为在许多情况下，零假设都有可能为假。<span class="math inline">\(\Delta \equiv \overline{Y}-\overline{X}\)</span>可以是任意的，功效实际上要依赖于这个参数，功效同时还依赖于你估计值的标准误，反过来，标准误又依赖于样本数目，以及总体标准差。实际情况中，我们并不知道一些<span class="math inline">\(\Delta\)</span>，<span class="math inline">\(\sigma_{X}\)</span>，<span class="math inline">\(\sigma_{Y}\)</span>值以及样本数目这些值。但是通过统计学理论，我们可以计算功效，R中的<code>pwr</code>包可以进行这样的计算，现在我们来模拟一下这个过程：</p>
<p>第一步：确定样本数目，我们确定为12，即<code>N &lt;- 12</code>；</p>
<p>第二步：设定拒绝零假设的阈值，这里为0.05，也就是常见的p值水平，即<code>alpha &lt;- 0.05</code>；</p>
<p>第三步：设计重复抽样次数，我们会重复地进行抽样，来计算一下拒绝零假设的比例，这里设为2000，即<code>B &lt;- 2000</code>；</p>
<p>这个模拟过程就是：我们会从对照组和处理组中抽取<code>N</code>个样本，使用t检验来计算p值，观察p值是否小于0.05，现在我们把这个过程写为一个函数，代码如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">N &lt;- <span class="number">12</span></div><div class="line">alpha &lt;- <span class="number">0.05</span></div><div class="line">B &lt;- <span class="number">2000</span></div><div class="line"></div><div class="line">reject &lt;- <span class="keyword">function</span>(N, alpha=<span class="number">0.05</span>)&#123;</div><div class="line">  hf &lt;- sample(hfPopulation, N)</div><div class="line">  control &lt;- sample(controlPopulation, N)</div><div class="line">  pval &lt;- t.test(hf, control)$p.value</div><div class="line">  pval &lt; alpha</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>如果样本数目为12，那么我们是否能拒绝零假设呢，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; reject(<span class="number">12</span>)</div><div class="line">[<span class="number">1</span>] <span class="literal">FALSE</span></div></pre></td></tr></table></figure>
<p>答案是不能。现在我们使用<code>replicate()</code>函数来重复2000次，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">N &lt;- <span class="number">12</span></div><div class="line">rejections &lt;- replicate(B, reject(N))</div><div class="line">mean(rejections)</div></pre></td></tr></table></figure>
<p>计算结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; mean(rejections)</div><div class="line">[<span class="number">1</span>] <span class="number">0.218</span></div></pre></td></tr></table></figure>
<p>其中<code>rejecctions</code>的结果是一个逻辑值，即里面只有<code>TRUE</code>或<code>FALSE</code>，其中<code>TRUE</code>为1，<code>FALSE</code>是0，那么我们计算的均值，即<code>mean(rejections)</code>就是<code>TRUE</code>所占的比例，因此我们计算出来的功效为0.218。这就是为什么，当我们知道零假设为假时，t检验也无法拒绝的原因。当样本数目为12时，功效是21.8%，对为能够在0.05水平上降低假阳性，那么我们可以设置更高的阈值，但这会导致II类错误的增多。</p>
<p>现在我们来看一下，功效是如何随着N的变化而变化的，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">Ns &lt;- seq(<span class="number">5</span>,<span class="number">50</span>, <span class="number">5</span>)</div><div class="line">power &lt;- sapply(Ns, <span class="keyword">function</span>(N)&#123;</div><div class="line">  rejections &lt;- replicate(B, reject(N))</div><div class="line">  mean(rejections)</div><div class="line">&#125;)</div><div class="line">power</div></pre></td></tr></table></figure>
<p>计算结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; power</div><div class="line"> [<span class="number">1</span>] <span class="number">0.0960</span> <span class="number">0.1640</span> <span class="number">0.2775</span> <span class="number">0.3775</span> <span class="number">0.4795</span> <span class="number">0.5540</span> <span class="number">0.6415</span> <span class="number">0.7075</span> <span class="number">0.7725</span> <span class="number">0.8160</span></div></pre></td></tr></table></figure>
<p>从上面的结果我们可以发现，随着N的增加，功效也在增加，曲线如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">plot(Ns, power, type = <span class="string">"b"</span>)</div></pre></td></tr></table></figure>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190728122626.jpeg">

</div>
<p>再来看一个案例。我们把<code>alpha</code>这个拒绝阈值改变一下，再来看一下功效的变化。如果想要降低I类错误，那么功效就会越小，也就说，我们需要在两类错误之间进行权衡，现在我们看下面的代码，在保证N值相同的前提下，改变<code>alpha</code>后功效的大小：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">N &lt;- <span class="number">30</span></div><div class="line">alphas &lt;- c(<span class="number">0.1</span>, <span class="number">0.05</span>, <span class="number">0.01</span>, <span class="number">0.001</span>, <span class="number">0.001</span>)</div><div class="line">power &lt;- sapply(alphas, <span class="keyword">function</span>(alpha)&#123;</div><div class="line">  rejections &lt;- replicate(B, reject(N, alpha=alpha))</div><div class="line">  mean(rejections)</div><div class="line">&#125;)</div><div class="line">plot(alphas, power, xlab=<span class="string">"alpha"</span>, type=<span class="string">"b"</span>, log=<span class="string">"x"</span>)</div></pre></td></tr></table></figure>
<p>变化曲线如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190728123209.jpeg">

</div>
<p>在实际统计中，没有绝对的功效，也没有绝对的alpha值，但是我们要理解这背后的统计学硬。</p>
<h3 id="替代假设下的p值">替代假设下的p值</h3>
<p>当零假设为假，替代假设为真时，那么p值有的时候就比较任意了。当替代假设为真时，我们通过增加样本数目，可以得到一个尽可能小的p值，通过从总体中不断抽取更大的样本数，我们就会知道p值的这种特性，现在看一下这个过程。</p>
<p>第一步：构建一个函数，这个函数能够返回一个样本数目为N时的p值，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">calculatePvalue &lt;- <span class="keyword">function</span>(N)&#123;</div><div class="line">  hf &lt;- sample(hfPopulation,N)</div><div class="line">  control &lt;- sample(controlPopulation, N)</div><div class="line">  t.test(hf, control)$p.value</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>第二步：设定样本数目，对于每个样本数目的计算，我们会得到一系列p值，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Ns &lt;- seq(<span class="number">10</span>, <span class="number">200</span>, by=<span class="number">10</span>)</div><div class="line">Ns_rep &lt;- rep(Ns, each=<span class="number">10</span>)</div></pre></td></tr></table></figure>
<p>第三步：计算p值，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pvalues &lt;- sapply(Ns_rep, calculatePvalue)</div></pre></td></tr></table></figure>
<p>第四步：绘制样本数目与其对应的p值，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">plot(Ns_rep, pvalues, log=<span class="string">"y"</span>, xlab=<span class="string">"Sample size"</span>,</div><div class="line">     ylab=<span class="string">"p-value"</span>)</div><div class="line">abline(h=c(<span class="number">0.01</span>, <span class="number">0.05</span>), col=<span class="string">"red"</span>, lwd=<span class="number">2</span>)</div></pre></td></tr></table></figure>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190728125345.jpeg">

</div>
<p>上图是随着样本数目的变化，p值的变化。从上面结果可以看出，当替代假设成立时，随着样本数目的增多，p值会越来越小，从上面的两条红线分别是0.01与0.05的区间。</p>
<p>一旦我们在某个阈值上拒绝了零假设，我们如果想要获得一个更小的p值，那么就需要更多的样本，例如实验小鼠。样本增大会增加我们对差值<span class="math inline">\(\Delta\)</span>估计的精确性，但是，这个p值的降低仅仅是数学计算的自然结果。因为在计算p值时，它公式中的分母是样本数目的平方根，即<span class="math inline">\(\sqrt{N}\)</span>，即如果<span class="math inline">\(\Delta\)</span>不等于0，随着N的增加，p值必然降低。</p>
<p>因此，一个好的统计学结果需要列出效应量(effect size)与置信区间。效应量的计算是：将差值(difference)和置信区间(confidence interval)除以对照总体的均值，获得一个百分数，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">N &lt;- <span class="number">12</span></div><div class="line">hf &lt;- sample(hfPopulation, N)</div><div class="line">control &lt;- sample(controlPopulation, N)</div><div class="line">diff &lt;- mean(hf) - mean(control)</div><div class="line">diff/mean(control)*<span class="number">100</span></div><div class="line">t.test(hf, control)$conf.int / mean(control) * <span class="number">100</span></div></pre></td></tr></table></figure>
<p>计算结果为：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&gt; diff/mean(control)*<span class="number">100</span></div><div class="line">[<span class="number">1</span>] <span class="number">5.783149</span></div><div class="line">&gt; t.test(hf, control)$conf.int / mean(control) * <span class="number">100</span></div><div class="line">[<span class="number">1</span>] -<span class="number">8.169363</span> <span class="number">19.735661</span></div><div class="line">attr(,<span class="string">"conf.level"</span>)</div><div class="line">[<span class="number">1</span>] <span class="number">0.95</span></div></pre></td></tr></table></figure>
<p>此外，我们还可以写出一个名为<code>Cohen's d</code>的统计量，它是两组之间的差值除以这两组总和的标准差，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">sd_pool &lt;- sqrt(((N-<span class="number">1</span>)*var(hf) + (N-<span class="number">1</span>)*var(control))/(<span class="number">2</span>*N - <span class="number">2</span>))</div><div class="line">diff / sd_pool</div></pre></td></tr></table></figure>
<p>计算结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&gt; sd_pool &lt;- sqrt(((N-<span class="number">1</span>)*var(hf) + (N-<span class="number">1</span>)*var(control))/(<span class="number">2</span>*N - <span class="number">2</span>))</div><div class="line">&gt; diff / sd_pool</div><div class="line">[<span class="number">1</span>] <span class="number">0.3510624</span></div></pre></td></tr></table></figure>
<p>这个结果告诉我们，hf组的小鼠体重的均值与对照组(control)小鼠体重平均值偏离多少个标准差。在替代假设下，t统计量会随着样本数目的增加而增加，但是效应量(effect size)与<code>Cohen's d</code>却会变得更加精确。</p>
<h3 id="练习-2">练习</h3>
<p>P76</p>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/统计推断/" <i class="fa fa-tag"></i> 统计推断</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2019/08/03/DAL/DALS003_Inference02_Population_Estimates/" rel="next" title="DALS003-统计推断(Inference)02-总体与样本估计">
                <i class="fa fa-chevron-left"></i> DALS003-统计推断(Inference)02-总体与样本估计
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2019/08/05/DAL/DALS005_Inference04_MonteCarlo/" rel="prev" title="DALS005-统计推断(Inference)04-Monte Carlo">
                DALS005-统计推断(Inference)04-Monte Carlo <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  
    <div class="comments" id="comments">
      <div id="vcomments"></div>
    </div>
  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">RVDSD</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">226</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">13</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">112</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          <div class="links-of-author motion-element">
            
          </div>

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#前言"><span class="nav-number">1.</span> <span class="nav-text">前言</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#中心极限定理central-limit-theorem与t分布"><span class="nav-number">2.</span> <span class="nav-text">中心极限定理(Central Limit Theorem)与t分布</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#中心极限定理clt"><span class="nav-number">2.1.</span> <span class="nav-text">中心极限定理(CLT)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#t分布"><span class="nav-number">2.2.</span> <span class="nav-text">t分布</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#练习"><span class="nav-number">3.</span> <span class="nav-text">练习</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#中心极限定理的实际运用"><span class="nav-number">4.</span> <span class="nav-text">中心极限定理的实际运用</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#练习-1"><span class="nav-number">5.</span> <span class="nav-text">练习</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#t检验的实际计算"><span class="nav-number">6.</span> <span class="nav-text">t检验的实际计算</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#t分布的实际计算"><span class="nav-number">7.</span> <span class="nav-text">t分布的实际计算</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#置信区间confidence-intervals"><span class="nav-number">8.</span> <span class="nav-text">置信区间(Confidence Intervals)</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#总体均值的置信区间"><span class="nav-number">8.1.</span> <span class="nav-text">总体均值的置信区间</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#定义区间"><span class="nav-number">8.2.</span> <span class="nav-text">定义区间</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#置信区间与p值的关系"><span class="nav-number">8.3.</span> <span class="nav-text">置信区间与p值的关系</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#功效计算"><span class="nav-number">9.</span> <span class="nav-text">功效计算</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#错误类型"><span class="nav-number">9.1.</span> <span class="nav-text">错误类型</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#与0.01阈值cut-off"><span class="nav-number">9.2.</span> <span class="nav-text">0.05与0.01阈值(cut-off)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#功效计算-1"><span class="nav-number">9.3.</span> <span class="nav-text">功效计算</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#替代假设下的p值"><span class="nav-number">9.4.</span> <span class="nav-text">替代假设下的p值</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#练习-2"><span class="nav-number">9.5.</span> <span class="nav-text">练习</span></a></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

<div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">RVDSD</span>

  
</div>



<div class="powered-by">
<i class="fa fa-user-md"></i><span id="busuanzi_container_site_pv">
  本站访客数:<span id="busuanzi_value_site_uv"></span>
</span>
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>


<div class="BbeiAn-info">
	<a target="_blank" href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=41018102000118" style="color:#909090;text-decoration:none;padding-left:0px;no-repeat left center" rel="nofollow">豫公网安备 41018102000118</a>	  <!--这里将图标作为了背景，以使得能和后面的文字在同一行-->
</div>

  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.3</div>




<div class="theme-info">
  <div class="powered-by"></div>
  <span class="post-count">博客全站共915.6k字</span>
</div>

        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.3"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.3"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.3"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.3"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.3"></script>



  


  




	





  





  












  





  

  

  
  

  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config("");
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="custom_mathjax_source">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->
  


  

  

</body>
</html>
