<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.3" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.3">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.3" color="#222">





  <meta name="keywords" content="统计学,均一化," />










<meta name="description" content="前言 NormqPcR这个包用于对qPCR数据进行均一化(normalization，这里需要注意的是，这里的normalization只是使用内参来校正目标基因的表达的意思，与统计学中的归一化(Normalization)，中心化(center)，标准化(scales)之类的术语没有关系)。这篇笔记主要是翻译了这个包的英文文档，本文档以一个小型案例(vignette)来演示了这个包的主要功能，">
<meta name="keywords" content="统计学,均一化">
<meta property="og:type" content="article">
<meta property="og:title" content="NormqPCR包笔记">
<meta property="og:url" content="http://rvdsd.top/2019/09/30/BioTools/NormqPCR包学习笔记/index.html">
<meta property="og:site_name" content="RVDSD的个人笔记本">
<meta property="og:description" content="前言 NormqPcR这个包用于对qPCR数据进行均一化(normalization，这里需要注意的是，这里的normalization只是使用内参来校正目标基因的表达的意思，与统计学中的归一化(Normalization)，中心化(center)，标准化(scales)之类的术语没有关系)。这篇笔记主要是翻译了这个包的英文文档，本文档以一个小型案例(vignette)来演示了这个包的主要功能，">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190925163029.png">
<meta property="og:image" content="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190925163314.png">
<meta property="og:image" content="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190925181159.jpeg">
<meta property="og:image" content="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190925163523.png">
<meta property="og:image" content="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190925181222.jpeg">
<meta property="og:image" content="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190925181651.png">
<meta property="og:image" content="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190925182918.png">
<meta property="og:updated_time" content="2019-10-10T02:32:26.934Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="NormqPCR包笔记">
<meta name="twitter:description" content="前言 NormqPcR这个包用于对qPCR数据进行均一化(normalization，这里需要注意的是，这里的normalization只是使用内参来校正目标基因的表达的意思，与统计学中的归一化(Normalization)，中心化(center)，标准化(scales)之类的术语没有关系)。这篇笔记主要是翻译了这个包的英文文档，本文档以一个小型案例(vignette)来演示了这个包的主要功能，">
<meta name="twitter:image" content="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190925163029.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.3',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://rvdsd.top/2019/09/30/BioTools/NormqPCR包学习笔记/"/>





  <title>NormqPCR包笔记 | RVDSD的个人笔记本</title><!-- hexo-inject:begin --><!-- hexo-inject:end -->
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">RVDSD的个人笔记本</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2019/09/30/BioTools/NormqPCR包学习笔记/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">NormqPCR包笔记</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-09-30T12:00:00+08:00">
                2019-09-30
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/生信工具/" itemprop="url" rel="index">
                    <span itemprop="name">生信工具</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  8,176
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  43
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h2 id="前言">前言</h2>
<p><code>NormqPcR</code>这个包用于对qPCR数据进行均一化(normalization，这里需要注意的是，这里的normalization只是使用内参来校正目标基因的表达的意思，与统计学中的归一化(Normalization)，中心化(center)，标准化(scales)之类的术语没有关系)。这篇笔记主要是翻译了这个包的英文文档，本文档以一个小型案例(vignette)来演示了这个包的主要功能，笔记主要内容如下所示：</p>
<ul>
<li>合并技术重复(technical replicates)（了解即可）；</li>
<li>处理低Cq值(undetermined values)（了解即可）；</li>
<li>计算用于均一化的最佳管家基因(housekeeping genes)（这个最重要，其余的很多函数其实了解即可，这一部分要了解geNorm和NormFinder的算法原理）；</li>
<li>使用管家基因来对数据进行均一化(normalization)（了解）。</li>
</ul>
<p>注：在这篇笔记中，管家基因(housekeeping genes)与内参(reference)指的是同一个意思。</p>
<h2 id="合并技术重复">合并技术重复</h2>
<p>我们先使用<code>ReadqPCR</code>包来导入原始数据，这个原始数据中含有技术重复，其后缀都是<code>_TechRep.n</code>，其中n表示总的重复数。读取数据过程如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># BiocManager::install("ReadqPCR")</span></div><div class="line"><span class="comment"># BiocManager::install("NormqPCR")</span></div><div class="line"><span class="comment"># input raw data for qPCR</span></div><div class="line"><span class="keyword">library</span>(NormqPCR)</div><div class="line"><span class="keyword">library</span>(ReadqPCR)</div><div class="line">path &lt;- system.file(<span class="string">"exData"</span>, package = <span class="string">"ReadqPCR"</span>)</div><div class="line">qPCR.example.techReps &lt;- file.path(path, <span class="string">"qPCR.techReps.txt"</span>)</div><div class="line">qPCRBatch.qPCR.techReps &lt;- read.qPCR(qPCR.example.techReps)</div><div class="line">rownames(exprs(qPCRBatch.qPCR.techReps))[<span class="number">1</span>:<span class="number">8</span>]</div></pre></td></tr></table></figure>
<p>计算结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&gt; rownames(exprs(qPCRBatch.qPCR.techReps))[<span class="number">1</span>:<span class="number">8</span>]</div><div class="line">[<span class="number">1</span>] <span class="string">"gene_aj_TechReps.1"</span> <span class="string">"gene_aj_TechReps.2"</span> <span class="string">"gene_al_TechReps.1"</span></div><div class="line">[<span class="number">4</span>] <span class="string">"gene_al_TechReps.2"</span> <span class="string">"gene_ax_TechReps.1"</span> <span class="string">"gene_ax_TechReps.2"</span></div><div class="line">[<span class="number">7</span>] <span class="string">"gene_bo_TechReps.1"</span> <span class="string">"gene_bo_TechReps.2"</span></div></pre></td></tr></table></figure>
<p>上面是读取数据的一些信息，从中我们可以发现，里面有技术重复，例如<code>gene_aj_TechReps.1</code>与<code>gene_aj_TechReps.2</code>就是做了2个技术重复。</p>
<p>在我们计算之前，我们还要计算技术重复Cq的算术平均值(arithmetic mean)，这一步我们使用<code>combineTechReps()</code>函数来计算一下，这个函数会生成一个qPCRBatch对象，这样就计算出了技术重复的算术平均值，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># Cal arithmetic mean of the raw qPCR Cq value</span></div><div class="line"><span class="comment"># combineTechReps function will return a new qPCRBatch object</span></div><div class="line">combinedTechReps &lt;- combineTechReps(qPCRBatch.qPCR.techReps)</div><div class="line">combinedTechReps</div><div class="line">exprs(qPCRBatch.qPCR.techReps)</div><div class="line">exprs(combinedTechReps)</div><div class="line">apply(exprs(qPCRBatch.qPCR.techReps)[<span class="number">1</span>:<span class="number">2</span>,],<span class="number">2</span>,mean)</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div></pre></td><td class="code"><pre><div class="line">&gt; combinedTechReps &lt;- combineTechReps(qPCRBatch.qPCR.techReps)</div><div class="line">&gt; combinedTechReps</div><div class="line">qPCRBatch (storageMode: lockedEnvironment)</div><div class="line">assayData: <span class="number">8</span> features, <span class="number">4</span> samples </div><div class="line">  element names: exprs </div><div class="line">protocolData: none</div><div class="line">phenoData</div><div class="line">  sampleNames: four one three two</div><div class="line">  varLabels: sample</div><div class="line">  varMetadata: labelDescription</div><div class="line">featureData: none</div><div class="line">experimentData: use <span class="string">'experimentData(object)'</span></div><div class="line">Annotation:  </div><div class="line">&gt; exprs(qPCRBatch.qPCR.techReps)</div><div class="line">                       four      one    three      two</div><div class="line">gene_aj_TechReps.1 <span class="number">18.02512</span> <span class="number">20.72960</span> <span class="number">21.87109</span> <span class="number">17.51878</span></div><div class="line">gene_aj_TechReps.2 <span class="number">17.59243</span> <span class="number">19.58196</span> <span class="number">21.71061</span> <span class="number">18.40029</span></div><div class="line">gene_al_TechReps.1 <span class="number">20.30233</span> <span class="number">22.23137</span> <span class="number">19.30596</span> <span class="number">21.32223</span></div><div class="line">gene_al_TechReps.2 <span class="number">20.56011</span> <span class="number">21.66608</span> <span class="number">20.07169</span> <span class="number">19.53765</span></div><div class="line">gene_ax_TechReps.1 <span class="number">20.67044</span> <span class="number">19.09129</span> <span class="number">21.90034</span> <span class="number">21.15897</span></div><div class="line">gene_ax_TechReps.2 <span class="number">20.44186</span> <span class="number">18.22294</span> <span class="number">21.28660</span> <span class="number">21.31048</span></div><div class="line">gene_bo_TechReps.1 <span class="number">20.62939</span> <span class="number">18.77342</span> <span class="number">19.70848</span> <span class="number">21.08782</span></div><div class="line">gene_bo_TechReps.2 <span class="number">20.70826</span> <span class="number">17.95030</span> <span class="number">19.53260</span> <span class="number">21.53267</span></div><div class="line">gene_cp_TechReps.1 <span class="number">23.50768</span> <span class="number">20.39530</span> <span class="number">22.06632</span> <span class="number">22.99578</span></div><div class="line">gene_cp_TechReps.2 <span class="number">22.73511</span> <span class="number">19.64446</span> <span class="number">20.74793</span> <span class="number">22.34119</span></div><div class="line">gene_dx_TechReps.1 <span class="number">21.16744</span> <span class="number">19.57131</span> <span class="number">21.62546</span> <span class="number">21.65467</span></div><div class="line">gene_dx_TechReps.2 <span class="number">21.36217</span> <span class="number">20.21180</span> <span class="number">21.41619</span> <span class="number">20.73930</span></div><div class="line">gene_ei_TechReps.1 <span class="number">19.90058</span> <span class="number">19.78343</span> <span class="number">20.26527</span> <span class="number">19.83862</span></div><div class="line">gene_ei_TechReps.2 <span class="number">19.67431</span> <span class="number">20.97861</span> <span class="number">19.82184</span> <span class="number">19.16033</span></div><div class="line">gene_jy_TechReps.1 <span class="number">21.60261</span> <span class="number">19.23546</span> <span class="number">18.22053</span> <span class="number">22.21470</span></div><div class="line">gene_jy_TechReps.2 <span class="number">21.04445</span> <span class="number">18.75998</span> <span class="number">19.31650</span> <span class="number">20.94050</span></div><div class="line">&gt; exprs(combinedTechReps)</div><div class="line">            four      one    three      two</div><div class="line">gene_aj <span class="number">17.80877</span> <span class="number">20.15578</span> <span class="number">21.79085</span> <span class="number">17.95954</span></div><div class="line">gene_al <span class="number">20.43122</span> <span class="number">21.94873</span> <span class="number">19.68883</span> <span class="number">20.42994</span></div><div class="line">gene_ax <span class="number">20.55615</span> <span class="number">18.65711</span> <span class="number">21.59347</span> <span class="number">21.23473</span></div><div class="line">gene_bo <span class="number">20.66882</span> <span class="number">18.36186</span> <span class="number">19.62054</span> <span class="number">21.31024</span></div><div class="line">gene_cp <span class="number">23.12139</span> <span class="number">20.01988</span> <span class="number">21.40713</span> <span class="number">22.66848</span></div><div class="line">gene_dx <span class="number">21.26481</span> <span class="number">19.89156</span> <span class="number">21.52082</span> <span class="number">21.19699</span></div><div class="line">gene_ei <span class="number">19.78745</span> <span class="number">20.38102</span> <span class="number">20.04355</span> <span class="number">19.49948</span></div><div class="line">gene_jy <span class="number">21.32353</span> <span class="number">18.99772</span> <span class="number">18.76851</span> <span class="number">21.57760</span></div><div class="line">&gt; apply(exprs(qPCRBatch.qPCR.techReps)[<span class="number">1</span>:<span class="number">2</span>,],<span class="number">2</span>,mean)</div><div class="line">    four      one    three      two </div><div class="line"><span class="number">17.80877</span> <span class="number">20.15578</span> <span class="number">21.79085</span> <span class="number">17.95954</span></div></pre></td></tr></table></figure>
<p>从上面我们可以看到：</p>
<ol style="list-style-type: decimal">
<li>做了2个技术重复；</li>
<li>使用<code>combineTechReps()</code>函数计算了技术重复的算术平均值；</li>
<li>又用<code>apply()</code>函数核对了一下，没问题。</li>
</ol>
<h2 id="处理未检测值">处理未检测值</h2>
<p>在qPCR实验中，当Cq值超过一定阈值后，qPCR仪有可能会将这个读数标记为Undetermined，也就是数值太小（Cq值越大，表示信号越弱），在<code>qPCRBatch</code>对象中，这个值就会被标记为<code>NA</code>。不同的人有不同的处理策略，常见的处理策略有两种。</p>
<p>第一种就是将那些大于38的Cq值认为是无法检测值，并将其标记为40，这是Taqman软件中的常见做法。而在我们的这个案例中，我们不会将其替换为40，而是替换为NA值，现在我们读入一个Taqman的qPCR数据，这批数据是用96孔板测的，其中，实验组(mia)4个重复，对照组(no-mia)4个重复，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">path &lt;- system.file(<span class="string">"exData"</span>, package = <span class="string">"NormqPCR"</span>)</div><div class="line">taqman.example &lt;- file.path(path, <span class="string">"/example.txt"</span>)</div><div class="line">qPCRBatch.taqman &lt;- read.taqman(taqman.example)</div></pre></td></tr></table></figure>
<p>现在我们只看某个样本的检测值，即<code>Ccl20.Rn00570287_m1</code>这个数据，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">exprs(qPCRBatch.taqman)[<span class="string">"Ccl20.Rn00570287_m1"</span>,]</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&gt; exprs(qPCRBatch.taqman)[<span class="string">"Ccl20.Rn00570287_m1"</span>,]</div><div class="line">    fp1.day3.v     fp2.day3.v   fp5.day3.mia   fp6.day3.mia   fp.3.day.3.v </div><div class="line">            <span class="literal">NA</span>             <span class="literal">NA</span>       <span class="number">35.74190</span>       <span class="number">34.05922</span>       <span class="number">35.02052</span> </div><div class="line">  fp.4.day.3.v fp.7.day.3.mia fp.8.day.3.mia </div><div class="line">            <span class="literal">NA</span>       <span class="number">35.93689</span>       <span class="number">36.57921</span></div></pre></td></tr></table></figure>
<p>现在我们使用<code>replaceAboveCutOff()</code>函数将大于35的数值替换为<code>NA</code>，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># Use replaceAboveCutOff method in order to replace anything above 35 with NA</span></div><div class="line">qPCRBatch.taqman.replaced &lt;- replaceAboveCutOff(qPCRBatch.taqman,newVal = <span class="literal">NA</span>, cutOff = <span class="number">35</span>)</div><div class="line">exprs(qPCRBatch.taqman.replaced)[<span class="string">"Ccl20.Rn00570287_m1"</span>,]</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&gt; exprs(qPCRBatch.taqman.replaced)[<span class="string">"Ccl20.Rn00570287_m1"</span>,]</div><div class="line">    fp1.day3.v     fp2.day3.v   fp5.day3.mia   fp6.day3.mia   fp.3.day.3.v </div><div class="line">            <span class="literal">NA</span>             <span class="literal">NA</span>             <span class="literal">NA</span>       <span class="number">34.05922</span>             <span class="literal">NA</span> </div><div class="line">  fp.4.day.3.v fp.7.day.3.mia fp.8.day.3.mia </div><div class="line">            <span class="literal">NA</span>             <span class="literal">NA</span>             <span class="literal">NA</span></div></pre></td></tr></table></figure>
<p>但是对于有些同学来说，我不想把大于35的数值替换为NA，而是想把所有的NA都替换为40，那么可以使用<code>replaceNAs()</code>函数，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># Use replaesNAs methods to replace all NAs with 40</span></div><div class="line">qPCRBatch.taqman.replaced &lt;- replaceNAs(qPCRBatch.taqman, newNA = <span class="number">40</span>)</div><div class="line">exprs(qPCRBatch.taqman.replaced)[<span class="string">"Ccl20.Rn00570287_m1"</span>,]</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&gt; exprs(qPCRBatch.taqman.replaced)[<span class="string">"Ccl20.Rn00570287_m1"</span>,]</div><div class="line">    fp1.day3.v     fp2.day3.v   fp5.day3.mia   fp6.day3.mia   fp.3.day.3.v </div><div class="line">      <span class="number">40.00000</span>       <span class="number">40.00000</span>       <span class="number">35.74190</span>       <span class="number">34.05922</span>       <span class="number">35.02052</span> </div><div class="line">  fp.4.day.3.v fp.7.day.3.mia fp.8.day.3.mia </div><div class="line">      <span class="number">40.00000</span>       <span class="number">35.93689</span>       <span class="number">36.57921</span></div></pre></td></tr></table></figure>
<p>有的时候我们会遇到这样的一样种情况，在一次实验中，例如我们做了96孔板的qPCR实验（做了好几块96孔板），某个孔的检测器中检测的数值大于设定的阈值，而有的孔的检测器检测到的数值则没有大于设定的阈值。有的同学可能就会认为，即然一些孔的检测器检测到的值设为NAs，那么这个孔的检测器在读取其它数值时，也应该设为NAs。因为否则一个检测器的计数出现了异学，那么会导致某个基因表达水平的计算出现错误估计（这一段不太理解，原话如下）：</p>
<blockquote>
<p>In addition, the situation sometimes arises where some readings for a given detector are above a given cycle threshold, but some others are not. The user may decide for example that if a given number of readings are NAs, then all of the readings for this detector should be NAs. This is important because otherwise an unusual reading for one detector might lead to an inaccurate estimate for the expression of a given gene.</p>
</blockquote>
<p>对于不同的样本类型这个过程应该分开处理，因为你也许想比较不同样本之间的某个特定的基因。因此有必要使用比较矩阵来指定每个样本类型的重复数。因此，在上面的案例中，我们一共有两个类型，分别是实验组与对照组，每组4个重复，我们可以使用<code>contrastMatrix()</code>函数和<code>sampleMaxMatrix()</code>函数来创建比较矩阵，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># Use contrastMatrix() and sampleMaxMatrix() to generate contrast matrix</span></div><div class="line">sampleNames(qPCRBatch.taqman) <span class="comment"># Check group information</span></div><div class="line">a &lt;- c(<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>) <span class="comment"># one for each sample type, with 1 representing</span></div><div class="line">b &lt;- c(<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>) <span class="comment"># position of sample type in samplenames vector</span></div><div class="line">contM &lt;- cbind(a,b)</div><div class="line">colnames(contM) &lt;- c(<span class="string">"case"</span>,<span class="string">"control"</span>) <span class="comment"># set the names of each sample type</span></div><div class="line">rownames(contM) &lt;- sampleNames(qPCRBatch.taqman) <span class="comment"># set row names</span></div><div class="line">contM</div><div class="line">sMaxM &lt;- t(as.matrix(c(<span class="number">3</span>,<span class="number">3</span>))) <span class="comment"># now make the contrast matrix</span></div><div class="line">colnames(sMaxM) &lt;- c(<span class="string">"case"</span>,<span class="string">"control"</span>) <span class="comment"># make sure these line up with samples</span></div><div class="line">sMaxM</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line">&gt; <span class="comment"># Use contrastMatrix() and sampleMaxMatrix() to generate contrast matrix</span></div><div class="line">&gt; sampleNames(qPCRBatch.taqman) <span class="comment"># Check group information</span></div><div class="line">[<span class="number">1</span>] <span class="string">"fp1.day3.v"</span>     <span class="string">"fp2.day3.v"</span>     <span class="string">"fp5.day3.mia"</span>   <span class="string">"fp6.day3.mia"</span>  </div><div class="line">[<span class="number">5</span>] <span class="string">"fp.3.day.3.v"</span>   <span class="string">"fp.4.day.3.v"</span>   <span class="string">"fp.7.day.3.mia"</span> <span class="string">"fp.8.day.3.mia"</span></div><div class="line">&gt; a &lt;- c(<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>) <span class="comment"># one for each sample type, with 1 representing</span></div><div class="line">&gt; b &lt;- c(<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>) <span class="comment"># position of sample type in samplenames vector</span></div><div class="line">&gt; contM &lt;- cbind(a,b)</div><div class="line">&gt; colnames(contM) &lt;- c(<span class="string">"case"</span>,<span class="string">"control"</span>) <span class="comment"># set the names of each sample type</span></div><div class="line">&gt; rownames(contM) &lt;- sampleNames(qPCRBatch.taqman) <span class="comment"># set row names</span></div><div class="line">&gt; contM</div><div class="line">               case control</div><div class="line">fp1.day3.v        <span class="number">0</span>       <span class="number">1</span></div><div class="line">fp2.day3.v        <span class="number">0</span>       <span class="number">1</span></div><div class="line">fp5.day3.mia      <span class="number">1</span>       <span class="number">0</span></div><div class="line">fp6.day3.mia      <span class="number">1</span>       <span class="number">0</span></div><div class="line">fp.3.day.3.v      <span class="number">0</span>       <span class="number">1</span></div><div class="line">fp.4.day.3.v      <span class="number">0</span>       <span class="number">1</span></div><div class="line">fp.7.day.3.mia    <span class="number">1</span>       <span class="number">0</span></div><div class="line">fp.8.day.3.mia    <span class="number">1</span>       <span class="number">0</span></div><div class="line">&gt; sMaxM &lt;- t(as.matrix(c(<span class="number">3</span>,<span class="number">3</span>))) <span class="comment"># now make the contrast matrix</span></div><div class="line">&gt; colnames(sMaxM) &lt;- c(<span class="string">"case"</span>,<span class="string">"control"</span>) <span class="comment"># make sure these line up with samples</span></div><div class="line">&gt; sMaxM</div><div class="line">     case control</div><div class="line">[<span class="number">1</span>,]    <span class="number">3</span>       <span class="number">3</span></div></pre></td></tr></table></figure>
<p>有关更多的算法细节可以参考<code>limmma</code>包中的内容，那个包中创建差异基因比较的矩阵也是类似方法。</p>
<p>例如，如果用户决定将那些4个重复中，有3个是NA的值都设为NA的话，可以使用<code>makeAllNewVal()</code>函数，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">qPCRBatch.taqman.replaced &lt;- makeAllNewVal(qPCRBatch.taqman, contM,sMaxM, newVal=<span class="literal">NA</span>)</div></pre></td></tr></table></figure>
<p>现在我们来看一下<code>Ccl20.Rn00570287 m1</code>这个样本的检测值，对照组的值都为NA，因为原始的4个技术重复中，有3个是NA，有一个是35，因此全设为NA。不过实验组的数据全部进行了保留，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">exprs(qPCRBatch.taqman)[<span class="string">"Ccl20.Rn00570287_m1"</span>,]</div><div class="line">exprs(qPCRBatch.taqman.replaced)[<span class="string">"Ccl20.Rn00570287_m1"</span>,]</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">&gt; exprs(qPCRBatch.taqman)[<span class="string">"Ccl20.Rn00570287_m1"</span>,]</div><div class="line">    fp1.day3.v     fp2.day3.v   fp5.day3.mia   fp6.day3.mia   fp.3.day.3.v </div><div class="line">            <span class="literal">NA</span>             <span class="literal">NA</span>       <span class="number">35.74190</span>       <span class="number">34.05922</span>       <span class="number">35.02052</span> </div><div class="line">  fp.4.day.3.v fp.7.day.3.mia fp.8.day.3.mia </div><div class="line">            <span class="literal">NA</span>       <span class="number">35.93689</span>       <span class="number">36.57921</span> </div><div class="line">&gt; exprs(qPCRBatch.taqman.replaced)[<span class="string">"Ccl20.Rn00570287_m1"</span>,]</div><div class="line">    fp1.day3.v     fp2.day3.v   fp5.day3.mia   fp6.day3.mia   fp.3.day.3.v </div><div class="line">            <span class="literal">NA</span>             <span class="literal">NA</span>       <span class="number">35.74190</span>       <span class="number">34.05922</span>             <span class="literal">NA</span> </div><div class="line">  fp.4.day.3.v fp.7.day.3.mia fp.8.day.3.mia </div><div class="line">            <span class="literal">NA</span>       <span class="number">35.93689</span>       <span class="number">36.57921</span></div></pre></td></tr></table></figure>
<p>前面这两部分内容（合并技术重复与处理未检测值）了解一下就行，平时也用不到，最重要的是下面的内容。</p>
<h2 id="选择最稳定内参基因">选择最稳定内参基因</h2>
<p>这一部分涉及选择最稳定的内参基因，其中用的是geNorm算法，这个算法的相关文献信息如下所示：</p>
<blockquote>
<p>Jo Vandesompele, Katleen De Preter, Filip Pattyn et al. (2002). Accurate normalization of real-time quantitative RT-PCR data by geometric averaging of multiple internal control genes. Genome Biology 2002. 3(7):research0034.1-0034.11. http://genomebiology.com/2002/3/7/research/0034/</p>
</blockquote>
<h3 id="genorm">geNorm</h3>
<p>先加载数据，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">options(width = <span class="number">68</span>)</div><div class="line">data(geNorm)</div><div class="line">str(exprs(geNorm.qPCRBatch))</div></pre></td></tr></table></figure>
<p>数据结构如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&gt; str(exprs(geNorm.qPCRBatch))</div><div class="line"> num [<span class="number">1</span>:<span class="number">10</span>, <span class="number">1</span>:<span class="number">85</span>] <span class="number">0.0425</span> <span class="number">0.0576</span> <span class="number">0.1547</span> <span class="number">0.1096</span> <span class="number">0.118</span> <span class="keyword">...</span></div><div class="line"> - attr(*, <span class="string">"dimnames"</span>)=List of <span class="number">2</span></div><div class="line">  ..$ : chr [<span class="number">1</span>:<span class="number">10</span>] <span class="string">"ACTB"</span> <span class="string">"B2M"</span> <span class="string">"GAPD"</span> <span class="string">"HMBS"</span> <span class="keyword">...</span></div><div class="line">  ..$ : chr [<span class="number">1</span>:<span class="number">85</span>] <span class="string">"BM1"</span> <span class="string">"BM2"</span> <span class="string">"BM3"</span> <span class="string">"BM4"</span> <span class="keyword">...</span></div></pre></td></tr></table></figure>
<p>现在我们对选择的内参基因进行排序。我们在这里使用<code>selectHKs()</code>函数来实现geNorm算法中的逐步处理过程，这里的数据都是文献中材料与方法中提到的数据。</p>
<p>第一步，我们计算所有内参基因稳定检测值M后，排除那些M值最高的内参基因；</p>
<p>第二步，再次计算M值，再排除掉最高M值的内参基因，直到剩下两个内参基因（也就是参数<code>minNrHK=2</code>，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">tissue &lt;- as.factor(c(rep(<span class="string">"BM"</span>, <span class="number">9</span>), rep(<span class="string">"FIB"</span>, <span class="number">20</span>), rep(<span class="string">"LEU"</span>, <span class="number">13</span>),rep(<span class="string">"NB"</span>, <span class="number">34</span>), rep(<span class="string">"POOL"</span>, <span class="number">9</span>)))</div><div class="line">res.BM &lt;- selectHKs(geNorm.qPCRBatch[,tissue == <span class="string">"BM"</span>], method = <span class="string">"geNorm"</span>,Symbols = featureNames(geNorm.qPCRBatch),minNrHK = <span class="number">2</span>, log = <span class="literal">FALSE</span>)</div></pre></td></tr></table></figure>
<p>计算过程中，这个函数会给出不断计算的M值，结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div></pre></td><td class="code"><pre><div class="line">res.BM &lt;- selectHKs(geNorm.qPCRBatch[,tissue == <span class="string">"BM"</span>], method = <span class="string">"geNorm"</span>,Symbols = featureNames(geNorm.qPCRBatch),minNrHK = <span class="number">2</span>, log = <span class="literal">FALSE</span>)</div><div class="line"><span class="comment">###############################################################</span></div><div class="line"></div><div class="line">Step <span class="number">1</span>:</div><div class="line"></div><div class="line">stability values M:</div><div class="line"></div><div class="line">    HPRT1     YWHAZ    RPL13A       UBC      GAPD      SDHA       TBP </div><div class="line"><span class="number">0.5160313</span> <span class="number">0.5314564</span> <span class="number">0.5335963</span> <span class="number">0.5700961</span> <span class="number">0.6064919</span> <span class="number">0.6201470</span> <span class="number">0.6397969</span> </div><div class="line">     HMBS       B2M      ACTB </div><div class="line"><span class="number">0.7206013</span> <span class="number">0.7747634</span> <span class="number">0.8498739</span> </div><div class="line">average stability M:	<span class="number">0.63628545246682</span></div><div class="line"></div><div class="line">variable with lowest stability (largest M value):	ACTB</div><div class="line"></div><div class="line">Pairwise variation, (<span class="number">9</span>/<span class="number">10</span>):	<span class="number">0.0764690052563778</span></div><div class="line"></div><div class="line"><span class="comment">###############################################################</span></div><div class="line"></div><div class="line">Step <span class="number">2</span>:</div><div class="line"></div><div class="line">stability values M:</div><div class="line"></div><div class="line">    HPRT1    RPL13A     YWHAZ       UBC      GAPD      SDHA       TBP </div><div class="line"><span class="number">0.4705664</span> <span class="number">0.5141375</span> <span class="number">0.5271169</span> <span class="number">0.5554718</span> <span class="number">0.5575295</span> <span class="number">0.5738460</span> <span class="number">0.6042110</span> </div><div class="line">     HMBS       B2M </div><div class="line"><span class="number">0.6759176</span> <span class="number">0.7671985</span> </div><div class="line">average stability M:	<span class="number">0.582888329316757</span></div><div class="line"></div><div class="line">variable with lowest stability (largest M value):	B2M</div><div class="line"></div><div class="line">Pairwise variation, (<span class="number">8</span>/<span class="number">9</span>):	<span class="number">0.0776534266912183</span></div><div class="line"></div><div class="line"><span class="comment">###############################################################</span></div><div class="line"></div><div class="line">Step <span class="number">3</span>:</div><div class="line"></div><div class="line">stability values M:</div><div class="line"></div><div class="line">    HPRT1    RPL13A      SDHA     YWHAZ       UBC      GAPD       TBP </div><div class="line"><span class="number">0.4391222</span> <span class="number">0.4733732</span> <span class="number">0.5243665</span> <span class="number">0.5253471</span> <span class="number">0.5403137</span> <span class="number">0.5560120</span> <span class="number">0.5622094</span> </div><div class="line">     HMBS </div><div class="line"><span class="number">0.6210820</span> </div><div class="line">average stability M:	<span class="number">0.530228279613623</span></div><div class="line"></div><div class="line">variable with lowest stability (largest M value):	HMBS</div><div class="line"></div><div class="line">Pairwise variation, (<span class="number">7</span>/<span class="number">8</span>):	<span class="number">0.0671119963410967</span></div><div class="line"></div><div class="line"><span class="comment">###############################################################</span></div><div class="line"></div><div class="line">Step <span class="number">4</span>:</div><div class="line"></div><div class="line">stability values M:</div><div class="line"></div><div class="line">    HPRT1    RPL13A     YWHAZ       UBC      SDHA      GAPD       TBP </div><div class="line"><span class="number">0.4389069</span> <span class="number">0.4696398</span> <span class="number">0.4879728</span> <span class="number">0.5043292</span> <span class="number">0.5178634</span> <span class="number">0.5245346</span> <span class="number">0.5563591</span> </div><div class="line">average stability M:	<span class="number">0.499943693933222</span></div><div class="line"></div><div class="line">variable with lowest stability (largest M value):	TBP</div><div class="line"></div><div class="line">Pairwise variation, (<span class="number">6</span>/<span class="number">7</span>):	<span class="number">0.0681320232188603</span></div><div class="line"></div><div class="line"><span class="comment">###############################################################</span></div><div class="line"></div><div class="line">Step <span class="number">5</span>:</div><div class="line"></div><div class="line">stability values M:</div><div class="line"></div><div class="line">    HPRT1    RPL13A       UBC     YWHAZ      GAPD      SDHA </div><div class="line"><span class="number">0.4292808</span> <span class="number">0.4447874</span> <span class="number">0.4594181</span> <span class="number">0.4728920</span> <span class="number">0.5012107</span> <span class="number">0.5566762</span> </div><div class="line">average stability M:	<span class="number">0.477377523800525</span></div><div class="line"></div><div class="line">variable with lowest stability (largest M value):	SDHA</div><div class="line"></div><div class="line">Pairwise variation, (<span class="number">5</span>/<span class="number">6</span>):	<span class="number">0.0806194432580746</span></div><div class="line"></div><div class="line"><span class="comment">###############################################################</span></div><div class="line"></div><div class="line">Step <span class="number">6</span>:</div><div class="line"></div><div class="line">stability values M:</div><div class="line"></div><div class="line">      UBC    RPL13A     HPRT1     YWHAZ      GAPD </div><div class="line"><span class="number">0.4195958</span> <span class="number">0.4204997</span> <span class="number">0.4219179</span> <span class="number">0.4424631</span> <span class="number">0.4841646</span> </div><div class="line">average stability M:	<span class="number">0.437728198765878</span></div><div class="line"></div><div class="line">variable with lowest stability (largest M value):	GAPD</div><div class="line"></div><div class="line">Pairwise variation, (<span class="number">4</span>/<span class="number">5</span>):	<span class="number">0.0841653121631615</span></div><div class="line"></div><div class="line"><span class="comment">###############################################################</span></div><div class="line"></div><div class="line">Step <span class="number">7</span>:</div><div class="line"></div><div class="line">stability values M:</div><div class="line"></div><div class="line">   RPL13A       UBC     YWHAZ     HPRT1 </div><div class="line"><span class="number">0.3699163</span> <span class="number">0.3978736</span> <span class="number">0.4173706</span> <span class="number">0.4419220</span> </div><div class="line">average stability M:	<span class="number">0.406770625156432</span></div><div class="line"></div><div class="line">variable with lowest stability (largest M value):	HPRT1</div><div class="line"></div><div class="line">Pairwise variation, (<span class="number">3</span>/<span class="number">4</span>):	<span class="number">0.097678269387021</span></div><div class="line"></div><div class="line"><span class="comment">###############################################################</span></div><div class="line"></div><div class="line">Step <span class="number">8</span>:</div><div class="line"></div><div class="line">stability values M:</div><div class="line"></div><div class="line">      UBC    RPL13A     YWHAZ </div><div class="line"><span class="number">0.3559286</span> <span class="number">0.3761358</span> <span class="number">0.3827933</span> </div><div class="line">average stability M:	<span class="number">0.371619241507029</span></div><div class="line"></div><div class="line">variable with lowest stability (largest M value):	YWHAZ</div><div class="line"></div><div class="line">Pairwise variation, (<span class="number">2</span>/<span class="number">3</span>):	<span class="number">0.113745049966055</span></div><div class="line"></div><div class="line"><span class="comment">###############################################################</span></div><div class="line"></div><div class="line">Step <span class="number">9</span>:</div><div class="line"></div><div class="line">stability values M:</div><div class="line"></div><div class="line">   RPL13A       UBC </div><div class="line"><span class="number">0.3492712</span> <span class="number">0.3492712</span> </div><div class="line">average stability M:	<span class="number">0.349271187472188</span></div><div class="line"></div><div class="line">&gt; res.BM</div><div class="line">$ranking</div><div class="line">       <span class="number">1</span>        <span class="number">1</span>        <span class="number">3</span>        <span class="number">4</span>        <span class="number">5</span>        <span class="number">6</span>        <span class="number">7</span> </div><div class="line"><span class="string">"RPL13A"</span>    <span class="string">"UBC"</span>  <span class="string">"YWHAZ"</span>  <span class="string">"HPRT1"</span>   <span class="string">"GAPD"</span>   <span class="string">"SDHA"</span>    <span class="string">"TBP"</span> </div><div class="line">       <span class="number">8</span>        <span class="number">9</span>       <span class="number">10</span> </div><div class="line">  <span class="string">"HMBS"</span>    <span class="string">"B2M"</span>   <span class="string">"ACTB"</span> </div><div class="line"></div><div class="line">$variation</div><div class="line">      <span class="number">9</span>/<span class="number">10</span>        <span class="number">8</span>/<span class="number">9</span>        <span class="number">7</span>/<span class="number">8</span>        <span class="number">6</span>/<span class="number">7</span>        <span class="number">5</span>/<span class="number">6</span>        <span class="number">4</span>/<span class="number">5</span> </div><div class="line"><span class="number">0.07646901</span> <span class="number">0.07765343</span> <span class="number">0.06711200</span> <span class="number">0.06813202</span> <span class="number">0.08061944</span> <span class="number">0.08416531</span> </div><div class="line">       <span class="number">3</span>/<span class="number">4</span>        <span class="number">2</span>/<span class="number">3</span> </div><div class="line"><span class="number">0.09767827</span> <span class="number">0.11374505</span> </div><div class="line"></div><div class="line">$meanM</div><div class="line">       <span class="number">10</span>         <span class="number">9</span>         <span class="number">8</span>         <span class="number">7</span>         <span class="number">6</span>         <span class="number">5</span> </div><div class="line"><span class="number">0.6362855</span> <span class="number">0.5828883</span> <span class="number">0.5302283</span> <span class="number">0.4999437</span> <span class="number">0.4773775</span> <span class="number">0.4377282</span> </div><div class="line">        <span class="number">4</span>         <span class="number">3</span>         <span class="number">2</span> </div><div class="line"><span class="number">0.4067706</span> <span class="number">0.3716192</span> <span class="number">0.3492712</span></div></pre></td></tr></table></figure>
<p>以上只是BM这类组织的计算结果。现在我们把其它的组织都计算出来，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">res.POOL &lt;- selectHKs(geNorm.qPCRBatch[,tissue == <span class="string">"POOL"</span>],</div><div class="line">	method = <span class="string">"geNorm"</span>,</div><div class="line">	Symbols = featureNames(geNorm.qPCRBatch),</div><div class="line">	minNrHK = <span class="number">2</span>, trace = <span class="literal">FALSE</span>, log = <span class="literal">FALSE</span>)</div><div class="line">res.FIB &lt;- selectHKs(geNorm.qPCRBatch[,tissue == <span class="string">"FIB"</span>],</div><div class="line">	method = <span class="string">"geNorm"</span>,</div><div class="line">	Symbols = featureNames(geNorm.qPCRBatch),</div><div class="line">	minNrHK = <span class="number">2</span>, trace = <span class="literal">FALSE</span>, log = <span class="literal">FALSE</span>)</div><div class="line">res.LEU &lt;- selectHKs(geNorm.qPCRBatch[,tissue == <span class="string">"LEU"</span>],</div><div class="line">	method = <span class="string">"geNorm"</span>,</div><div class="line">	Symbols = featureNames(geNorm.qPCRBatch),</div><div class="line">	minNrHK = <span class="number">2</span>, trace = <span class="literal">FALSE</span>, log = <span class="literal">FALSE</span>)</div><div class="line">res.NB &lt;- selectHKs(geNorm.qPCRBatch[,tissue == <span class="string">"NB"</span>],</div><div class="line">	method = <span class="string">"geNorm"</span>,</div><div class="line">	Symbols = featureNames(geNorm.qPCRBatch),</div><div class="line">	minNrHK = <span class="number">2</span>, trace = <span class="literal">FALSE</span>, log = <span class="literal">FALSE</span>)</div></pre></td></tr></table></figure>
<p>我们就获得了基因的下面排序信息，这个就是文献中的Table 3，文献中的信息如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190925163029.png">

</div>
<p>我们自己的计算结果：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">ranks &lt;- data.frame(c(<span class="number">1</span>, <span class="number">1</span>:<span class="number">9</span>),</div><div class="line">	res.BM$ranking, res.POOL$ranking,</div><div class="line">	res.FIB$ranking, res.LEU$ranking,</div><div class="line">	res.NB$ranking)</div><div class="line">names(ranks) &lt;- c(<span class="string">"rank"</span>, <span class="string">"BM"</span>, <span class="string">"POOL"</span>, <span class="string">"FIB"</span>, <span class="string">"LEU"</span>, <span class="string">"NB"</span>)</div><div class="line">ranks</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">ranks</div><div class="line">   rank     BM   POOL    FIB    LEU     NB</div><div class="line"><span class="number">1</span>     <span class="number">1</span> RPL13A   GAPD   GAPD    UBC   GAPD</div><div class="line"><span class="number">2</span>     <span class="number">1</span>    UBC   SDHA  HPRT1  YWHAZ  HPRT1</div><div class="line"><span class="number">3</span>     <span class="number">2</span>  YWHAZ   HMBS  YWHAZ    B2M   SDHA</div><div class="line"><span class="number">4</span>     <span class="number">3</span>  HPRT1  HPRT1    UBC   GAPD    UBC</div><div class="line"><span class="number">5</span>     <span class="number">4</span>   GAPD    TBP   ACTB RPL13A   HMBS</div><div class="line"><span class="number">6</span>     <span class="number">5</span>   SDHA    UBC    TBP    TBP  YWHAZ</div><div class="line"><span class="number">7</span>     <span class="number">6</span>    TBP RPL13A   SDHA   SDHA    TBP</div><div class="line"><span class="number">8</span>     <span class="number">7</span>   HMBS  YWHAZ RPL13A  HPRT1   ACTB</div><div class="line"><span class="number">9</span>     <span class="number">8</span>    B2M   ACTB    B2M   HMBS RPL13A</div><div class="line"><span class="number">10</span>    <span class="number">9</span>   ACTB    B2M   HMBS   ACTB    B2M</div></pre></td></tr></table></figure>
<p>现在绘制出每个细胞类型的平均基因表达稳定值M的折线图，这个对应于文献中的Figure 2，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190925163314.png">

</div>
<p>代码如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">library</span>(RColorBrewer)</div><div class="line">mypalette &lt;- brewer.pal(<span class="number">5</span>, <span class="string">"Set1"</span>)</div><div class="line">matplot(cbind(res.BM$meanM, res.POOL$meanM, res.FIB$meanM,</div><div class="line">res.LEU$meanM, res.NB$meanM), type = <span class="string">"b"</span>,</div><div class="line">ylab = <span class="string">"Average expression stability M"</span>,</div><div class="line">xlab = <span class="string">"Number of remaining control genes"</span>,</div><div class="line">axes = <span class="literal">FALSE</span>, pch = <span class="number">19</span>, col = mypalette,</div><div class="line">ylim = c(<span class="number">0.2</span>, <span class="number">1.22</span>), lty = <span class="number">1</span>, lwd = <span class="number">2</span>,</div><div class="line">main = <span class="string">"Figure 2 in Vandesompele et al. (2002)"</span>)</div><div class="line">axis(<span class="number">1</span>, at = <span class="number">1</span>:<span class="number">9</span>, labels = as.character(<span class="number">10</span>:<span class="number">2</span>))</div><div class="line">axis(<span class="number">2</span>, at = seq(<span class="number">0.2</span>, <span class="number">1.2</span>, by = <span class="number">0.2</span>), labels = seq(<span class="number">0.2</span>, <span class="number">1.2</span>, by = <span class="number">0.2</span>))</div><div class="line">box()</div><div class="line">abline(h = seq(<span class="number">0.2</span>, <span class="number">1.2</span>, by = <span class="number">0.2</span>), lty = <span class="number">2</span>, lwd = <span class="number">1</span>, col = <span class="string">"grey"</span>)</div><div class="line">legend(<span class="string">"topright"</span>, legend = c(<span class="string">"BM"</span>, <span class="string">"POOL"</span>, <span class="string">"FIB"</span>, <span class="string">"LEU"</span>, <span class="string">"NB"</span>),</div><div class="line">fill = mypalette)</div></pre></td></tr></table></figure>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190925181159.jpeg">

</div>
<p>绘制每个细胞类型的成对方差(pairwise variation)图，这个对应文献中的Figure 3，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190925163523.png">

</div>
<p>代码如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">mypalette &lt;- brewer.pal(<span class="number">8</span>, <span class="string">"YlGnBu"</span>)</div><div class="line">barplot(cbind(res.POOL$variation, res.LEU$variation, res.NB$variation,</div><div class="line">res.FIB$variation, res.BM$variation), beside = <span class="literal">TRUE</span>,</div><div class="line">col = mypalette, space = c(<span class="number">0</span>, <span class="number">2</span>),</div><div class="line">names.arg = c(<span class="string">"POOL"</span>, <span class="string">"LEU"</span>, <span class="string">"NB"</span>, <span class="string">"FIB"</span>, <span class="string">"BM"</span>),</div><div class="line">ylab = <span class="string">"Pairwise variation V"</span>,</div><div class="line">main = <span class="string">"Figure 3(a) in Vandesompele et al. (2002)"</span>)</div><div class="line">legend(<span class="string">"topright"</span>, legend = c(<span class="string">"V9/10"</span>, <span class="string">"V8/9"</span>, <span class="string">"V7/8"</span>, <span class="string">"V6/7"</span>,</div><div class="line"><span class="string">"V5/6"</span>, <span class="string">"V4/5"</span>, <span class="string">"V3/4"</span>, <span class="string">"V2/3"</span>),</div><div class="line">fill = mypalette, ncol = <span class="number">2</span>)</div><div class="line">abline(h = seq(<span class="number">0.05</span>, <span class="number">0.25</span>, by = <span class="number">0.05</span>), lty = <span class="number">2</span>, col = <span class="string">"grey"</span>)</div><div class="line">abline(h = <span class="number">0.15</span>, lty = <span class="number">1</span>, col = <span class="string">"black"</span>)</div></pre></td></tr></table></figure>
<p>注：文献中推荐的成对方差值的截止值为0.15，因此低于此值后，就不需要使用其它的内参基因了。</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190925181222.jpeg">

</div>
<h3 id="normfinder">NormFinder</h3>
<p>第二种选择内参的基因的方法是<code>NormFinder</code>，这种方法来源于以下文献：</p>
<blockquote>
<p>Andersen, C. L., et al. (2004). “Normalization of real-time quantitative reverse transcription-PCR data: a model-based variance estimation approach to identify genes suited for normalization, applied to bladder and colon cancer data sets.” Cancer Res 64(15): 5245-5250.</p>
</blockquote>
<p>现在我们计算Table 3，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190925181651.png">

</div>
<p>第一步，导入数据：：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="comment">## NormFinder</span></div><div class="line">data(Colon)</div><div class="line">Colon</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">&gt; data(Colon)</div><div class="line">&gt; Colon</div><div class="line">qPCRBatch (storageMode: lockedEnvironment)</div><div class="line">assayData: <span class="number">13</span> features, <span class="number">40</span> samples </div><div class="line">  element names: exprs </div><div class="line">protocolData: none</div><div class="line">phenoData</div><div class="line">  sampleNames: I459N <span class="number">90</span> <span class="keyword">...</span> I-C1056T (<span class="number">40</span> total)</div><div class="line">  varLabels: Sample.no. Classification</div><div class="line">  varMetadata: labelDescription</div><div class="line">featureData</div><div class="line">  featureNames: UBC UBB <span class="keyword">...</span> TUBA6 (<span class="number">13</span> total)</div><div class="line">  fvarLabels: Symbol Gene.name</div><div class="line">  fvarMetadata: labelDescription</div><div class="line">experimentData: use <span class="string">'experimentData(object)'</span></div><div class="line">Annotation: Table <span class="number">1</span> <span class="keyword">in</span> Andersen et al. (<span class="number">2004</span>)</div></pre></td></tr></table></figure>
<p>继续计算，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">Class &lt;- pData(Colon)[,<span class="string">"Classification"</span>]</div><div class="line">res.Colon &lt;- stabMeasureRho(Colon, group = Class, log = <span class="literal">FALSE</span>)</div><div class="line">sort(res.Colon) <span class="comment"># see Table 3 in Andersen et al (2004)</span></div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&gt; sort(res.Colon) <span class="comment"># see Table 3 in Andersen et al (2004)</span></div><div class="line">      UBC      GAPD      TPT1       UBB     TUBA6     RPS13      NACA </div><div class="line"><span class="number">0.1821707</span> <span class="number">0.2146061</span> <span class="number">0.2202956</span> <span class="number">0.2471573</span> <span class="number">0.2700641</span> <span class="number">0.2813039</span> <span class="number">0.2862397</span> </div><div class="line">     CFL1      SUI1      ACTB      CLTC     RPS23  FLJ20030 </div><div class="line"><span class="number">0.2870467</span> <span class="number">0.3139404</span> <span class="number">0.3235918</span> <span class="number">0.3692880</span> <span class="number">0.3784909</span> <span class="number">0.3935173</span></div></pre></td></tr></table></figure>
<p>再看另外的一个数据集<code>Bladder</code>，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">data(Bladder)</div><div class="line">Bladder</div><div class="line">grade &lt;- pData(Bladder)[,<span class="string">"Grade"</span>]</div><div class="line">res.Bladder &lt;- stabMeasureRho(Bladder,</div><div class="line">                              group = grade,</div><div class="line">                              log = <span class="literal">FALSE</span>)</div><div class="line">sort(res.Bladder)</div></pre></td></tr></table></figure>
<p>计算结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line">&gt; data(Bladder)</div><div class="line">&gt; Bladder</div><div class="line">qPCRBatch (storageMode: lockedEnvironment)</div><div class="line">assayData: <span class="number">14</span> features, <span class="number">28</span> samples </div><div class="line">  element names: exprs </div><div class="line">protocolData: none</div><div class="line">phenoData</div><div class="line">  sampleNames: <span class="number">335</span>-<span class="number">6</span> <span class="number">1131</span>-<span class="number">1</span> <span class="keyword">...</span> <span class="number">1356</span>-<span class="number">1</span> (<span class="number">28</span> total)</div><div class="line">  varLabels: Sample.no. Grade</div><div class="line">  varMetadata: labelDescription</div><div class="line">featureData</div><div class="line">  featureNames: ATP5B HSPCB <span class="keyword">...</span> FLJ20030 (<span class="number">14</span> total)</div><div class="line">  fvarLabels: Symbol Gene.name</div><div class="line">  fvarMetadata: labelDescription</div><div class="line">experimentData: use <span class="string">'experimentData(object)'</span></div><div class="line">Annotation: Table <span class="number">1</span> <span class="keyword">in</span> Andersen et al. (<span class="number">2004</span>) </div><div class="line">&gt; grade &lt;- pData(Bladder)[,<span class="string">"Grade"</span>]</div><div class="line">&gt; res.Bladder &lt;- stabMeasureRho(Bladder,</div><div class="line">+                               group = grade,</div><div class="line">+                               log = <span class="literal">FALSE</span>)</div><div class="line">Warning message:</div><div class="line">In .local(x, <span class="keyword">...</span>) : Argument <span class="string">'group'</span> is transformed to a factor vector.</div><div class="line">&gt; sort(res.Bladder)</div><div class="line">    HSPCB      TEGT     ATP5B       UBC     RPS23     RPS13      CFL1 </div><div class="line"><span class="number">0.1539598</span> <span class="number">0.1966556</span> <span class="number">0.1987227</span> <span class="number">0.2033477</span> <span class="number">0.2139626</span> <span class="number">0.2147852</span> <span class="number">0.2666129</span> </div><div class="line"> FLJ20030      TPT1       UBB     FLOT2      GAPD    S100A6      ACTB </div><div class="line"><span class="number">0.2672918</span> <span class="number">0.2691553</span> <span class="number">0.2826051</span> <span class="number">0.2960429</span> <span class="number">0.3408742</span> <span class="number">0.3453435</span> <span class="number">0.3497295</span></div></pre></td></tr></table></figure>
<p>我们也可以使用geNorm算法来计算，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">selectHKs(Colon, </div><div class="line">          log = <span class="literal">FALSE</span>, </div><div class="line">          trace = <span class="literal">FALSE</span>,</div><div class="line">          Symbols = featureNames(Colon))$ranking</div></pre></td></tr></table></figure>
<p>计算结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">&gt; selectHKs(Colon, </div><div class="line">+           log = <span class="literal">FALSE</span>, </div><div class="line">+           trace = <span class="literal">FALSE</span>,</div><div class="line">+           Symbols = featureNames(Colon))$ranking</div><div class="line">         <span class="number">1</span>          <span class="number">1</span>          <span class="number">3</span>          <span class="number">4</span>          <span class="number">5</span>          <span class="number">6</span>          <span class="number">7</span> </div><div class="line">   <span class="string">"RPS23"</span>     <span class="string">"TPT1"</span>    <span class="string">"RPS13"</span>     <span class="string">"SUI1"</span>      <span class="string">"UBC"</span>     <span class="string">"GAPD"</span>    <span class="string">"TUBA6"</span> </div><div class="line">         <span class="number">8</span>          <span class="number">9</span>         <span class="number">10</span>         <span class="number">11</span>         <span class="number">12</span>         <span class="number">13</span> </div><div class="line">     <span class="string">"UBB"</span>     <span class="string">"NACA"</span>     <span class="string">"CFL1"</span>     <span class="string">"CLTC"</span>     <span class="string">"ACTB"</span> <span class="string">"FLJ20030"</span></div></pre></td></tr></table></figure>
<p>再来看Baldder的数据，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">selectHKs(Bladder,</div><div class="line">	log = <span class="literal">FALSE</span>,</div><div class="line">	trace = <span class="literal">FALSE</span>,</div><div class="line">	Symbols = featureNames(Bladder))$ranking</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">&gt; selectHKs(Bladder,</div><div class="line">+           log = <span class="literal">FALSE</span>,</div><div class="line">+           trace = <span class="literal">FALSE</span>,</div><div class="line">+           Symbols = featureNames(Bladder))$ranking</div><div class="line">         <span class="number">1</span>          <span class="number">1</span>          <span class="number">3</span>          <span class="number">4</span>          <span class="number">5</span>          <span class="number">6</span>          <span class="number">7</span> </div><div class="line">    <span class="string">"CFL1"</span>      <span class="string">"UBC"</span>    <span class="string">"ATP5B"</span>    <span class="string">"HSPCB"</span>     <span class="string">"GAPD"</span>     <span class="string">"TEGT"</span>    <span class="string">"RPS23"</span> </div><div class="line">         <span class="number">8</span>          <span class="number">9</span>         <span class="number">10</span>         <span class="number">11</span>         <span class="number">12</span>         <span class="number">13</span>         <span class="number">14</span> </div><div class="line">   <span class="string">"RPS13"</span>     <span class="string">"TPT1"</span> <span class="string">"FLJ20030"</span>    <span class="string">"FLOT2"</span>      <span class="string">"UBB"</span>     <span class="string">"ACTB"</span>   <span class="string">"S100A6"</span></div></pre></td></tr></table></figure>
<p>我们也可以使用NormFinder算法的分步计算方式工来看多个内参基因的情况，也就是文献中附录中的<code>Average control gene</code>部分，<code>selectHKs</code>函数中含有这种算法的参数，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">Class &lt;- pData(Colon)[,<span class="string">"Classification"</span>]</div><div class="line">selectHKs(Colon, </div><div class="line">	group = Class, </div><div class="line">	log = <span class="literal">FALSE</span>, </div><div class="line">	trace = <span class="literal">TRUE</span>,</div><div class="line">	Symbols = featureNames(Colon), </div><div class="line">	minNrHKs = <span class="number">12</span>,</div><div class="line">	method = <span class="string">"NormFinder"</span>)$ranking</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div></pre></td><td class="code"><pre><div class="line">&gt; Class &lt;- pData(Colon)[,<span class="string">"Classification"</span>]</div><div class="line">&gt; selectHKs(Colon, </div><div class="line">+           group = Class, </div><div class="line">+           log = <span class="literal">FALSE</span>, </div><div class="line">+           trace = <span class="literal">TRUE</span>,</div><div class="line">+           Symbols = featureNames(Colon), </div><div class="line">+           minNrHKs = <span class="number">12</span>,</div><div class="line">+           method = <span class="string">"NormFinder"</span>)$ranking</div><div class="line"><span class="comment">###############################################################</span></div><div class="line"></div><div class="line">Step <span class="number">1</span>:</div><div class="line"></div><div class="line">stability values rho:</div><div class="line"></div><div class="line">      UBC      GAPD      TPT1       UBB     TUBA6     RPS13      NACA </div><div class="line"><span class="number">0.1821707</span> <span class="number">0.2146061</span> <span class="number">0.2202956</span> <span class="number">0.2471573</span> <span class="number">0.2700641</span> <span class="number">0.2813039</span> <span class="number">0.2862397</span> </div><div class="line">     CFL1      SUI1      ACTB      CLTC     RPS23  FLJ20030 </div><div class="line"><span class="number">0.2870467</span> <span class="number">0.3139404</span> <span class="number">0.3235918</span> <span class="number">0.3692880</span> <span class="number">0.3784909</span> <span class="number">0.3935173</span> </div><div class="line">variable with highest stability (smallest rho value):	UBC</div><div class="line"></div><div class="line"><span class="comment">###############################################################</span></div><div class="line"></div><div class="line">Step <span class="number">2</span>:</div><div class="line"></div><div class="line">stability values rho:</div><div class="line"></div><div class="line">     GAPD      TPT1       UBB      NACA      CFL1     RPS13     TUBA6 </div><div class="line"><span class="number">0.1375298</span> <span class="number">0.1424519</span> <span class="number">0.1578360</span> <span class="number">0.1657364</span> <span class="number">0.1729069</span> <span class="number">0.1837057</span> <span class="number">0.1849021</span> </div><div class="line">     SUI1      ACTB     RPS23  FLJ20030      CLTC </div><div class="line"><span class="number">0.2065531</span> <span class="number">0.2131651</span> <span class="number">0.2188277</span> <span class="number">0.2359623</span> <span class="number">0.2447588</span> </div><div class="line">variable with highest stability (smallest rho value):	GAPD</div><div class="line"></div><div class="line"><span class="comment">###############################################################</span></div><div class="line"></div><div class="line">Step <span class="number">3</span>:</div><div class="line"></div><div class="line">stability values rho:</div><div class="line"></div><div class="line">     TPT1      NACA       UBB     RPS13      CFL1     TUBA6  FLJ20030 </div><div class="line"><span class="number">0.1108474</span> <span class="number">0.1299802</span> <span class="number">0.1356690</span> <span class="number">0.1411173</span> <span class="number">0.1474242</span> <span class="number">0.1532953</span> <span class="number">0.1583031</span> </div><div class="line">     SUI1      ACTB     RPS23      CLTC </div><div class="line"><span class="number">0.1586250</span> <span class="number">0.1682972</span> <span class="number">0.1686139</span> <span class="number">0.1926907</span> </div><div class="line">variable with highest stability (smallest rho value):	TPT1</div><div class="line"></div><div class="line"><span class="comment">###############################################################</span></div><div class="line"></div><div class="line">Step <span class="number">4</span>:</div><div class="line"></div><div class="line">stability values rho:</div><div class="line"></div><div class="line">       UBB      TUBA6       ACTB       CFL1      RPS13       SUI1       CLTC </div><div class="line"><span class="number">0.09656546</span> <span class="number">0.09674897</span> <span class="number">0.10753445</span> <span class="number">0.10830099</span> <span class="number">0.11801680</span> <span class="number">0.12612399</span> <span class="number">0.12773131</span> </div><div class="line">      NACA   FLJ20030      RPS23 </div><div class="line"><span class="number">0.13422958</span> <span class="number">0.14609897</span> <span class="number">0.16530522</span> </div><div class="line">variable with highest stability (smallest rho value):	UBB</div><div class="line"></div><div class="line"><span class="comment">###############################################################</span></div><div class="line"></div><div class="line">Step <span class="number">5</span>:</div><div class="line"></div><div class="line">stability values rho:</div><div class="line"></div><div class="line">     RPS13       SUI1      TUBA6       NACA   FLJ20030       CFL1       ACTB </div><div class="line"><span class="number">0.09085973</span> <span class="number">0.09647829</span> <span class="number">0.09943424</span> <span class="number">0.10288912</span> <span class="number">0.11097074</span> <span class="number">0.11428399</span> <span class="number">0.11495336</span> </div><div class="line">     RPS23       CLTC </div><div class="line"><span class="number">0.12635109</span> <span class="number">0.13286210</span> </div><div class="line">variable with highest stability (smallest rho value):	RPS13</div><div class="line"></div><div class="line"><span class="comment">###############################################################</span></div><div class="line"></div><div class="line">Step <span class="number">6</span>:</div><div class="line"></div><div class="line">stability values rho:</div><div class="line"></div><div class="line">      ACTB      TUBA6       CFL1   FLJ20030       NACA       CLTC       SUI1 </div><div class="line"><span class="number">0.09215478</span> <span class="number">0.09499893</span> <span class="number">0.09674032</span> <span class="number">0.10528784</span> <span class="number">0.10718604</span> <span class="number">0.10879846</span> <span class="number">0.11368091</span> </div><div class="line">     RPS23 </div><div class="line"><span class="number">0.13134766</span> </div><div class="line">variable with highest stability (smallest rho value):	ACTB</div><div class="line"></div><div class="line"><span class="comment">###############################################################</span></div><div class="line"></div><div class="line">Step <span class="number">7</span>:</div><div class="line"></div><div class="line">stability values rho:</div><div class="line"></div><div class="line">      SUI1       NACA   FLJ20030      RPS23      TUBA6       CFL1       CLTC </div><div class="line"><span class="number">0.08281504</span> <span class="number">0.08444905</span> <span class="number">0.08922236</span> <span class="number">0.09072667</span> <span class="number">0.10559279</span> <span class="number">0.10993755</span> <span class="number">0.13142181</span> </div><div class="line">variable with highest stability (smallest rho value):	SUI1</div><div class="line"></div><div class="line"><span class="comment">###############################################################</span></div><div class="line"></div><div class="line">Step <span class="number">8</span>:</div><div class="line"></div><div class="line">stability values rho:</div><div class="line"></div><div class="line">      NACA       CFL1      TUBA6   FLJ20030       CLTC      RPS23 </div><div class="line"><span class="number">0.08336046</span> <span class="number">0.08410148</span> <span class="number">0.09315528</span> <span class="number">0.09775742</span> <span class="number">0.10499056</span> <span class="number">0.10554332</span> </div><div class="line">variable with highest stability (smallest rho value):	NACA</div><div class="line"></div><div class="line"><span class="comment">###############################################################</span></div><div class="line"></div><div class="line">Step <span class="number">9</span>:</div><div class="line"></div><div class="line">stability values rho:</div><div class="line"></div><div class="line">      CFL1      TUBA6       CLTC   FLJ20030      RPS23 </div><div class="line"><span class="number">0.07222968</span> <span class="number">0.07722737</span> <span class="number">0.08440691</span> <span class="number">0.09831958</span> <span class="number">0.12735605</span> </div><div class="line">variable with highest stability (smallest rho value):	CFL1</div><div class="line"></div><div class="line"><span class="comment">###############################################################</span></div><div class="line"></div><div class="line">Step <span class="number">10</span>:</div><div class="line"></div><div class="line">stability values rho:</div><div class="line"></div><div class="line">  FLJ20030      TUBA6       CLTC      RPS23 </div><div class="line"><span class="number">0.08162006</span> <span class="number">0.08189011</span> <span class="number">0.10705192</span> <span class="number">0.11430674</span> </div><div class="line">variable with highest stability (smallest rho value):	FLJ20030</div><div class="line"></div><div class="line"><span class="comment">###############################################################</span></div><div class="line"></div><div class="line">Step <span class="number">11</span>:</div><div class="line"></div><div class="line">stability values rho:</div><div class="line"></div><div class="line">     TUBA6       CLTC      RPS23 </div><div class="line"><span class="number">0.06978897</span> <span class="number">0.08069582</span> <span class="number">0.13702726</span> </div><div class="line">variable with highest stability (smallest rho value):	TUBA6</div><div class="line"></div><div class="line"><span class="comment">###############################################################</span></div><div class="line"></div><div class="line">Step <span class="number">12</span>:</div><div class="line"></div><div class="line">stability values rho:</div><div class="line"></div><div class="line">     CLTC     RPS23 </div><div class="line"><span class="number">0.1199009</span> <span class="number">0.1245241</span> </div><div class="line">variable with highest stability (smallest rho value):	CLTC</div><div class="line"></div><div class="line">         <span class="number">1</span>          <span class="number">2</span>          <span class="number">3</span>          <span class="number">4</span>          <span class="number">5</span>          <span class="number">6</span>          <span class="number">7</span> </div><div class="line">     <span class="string">"UBC"</span>     <span class="string">"GAPD"</span>     <span class="string">"TPT1"</span>      <span class="string">"UBB"</span>    <span class="string">"RPS13"</span>     <span class="string">"ACTB"</span>     <span class="string">"SUI1"</span> </div><div class="line">         <span class="number">8</span>          <span class="number">9</span>         <span class="number">10</span>         <span class="number">11</span>         <span class="number">12</span> </div><div class="line">    <span class="string">"NACA"</span>     <span class="string">"CFL1"</span> <span class="string">"FLJ20030"</span>    <span class="string">"TUBA6"</span>     <span class="string">"CLTC"</span> </div><div class="line">Warning message:</div><div class="line">In .local(x, <span class="keyword">...</span>) : Argument <span class="string">'group'</span> is transformed to a factor vector.</div></pre></td></tr></table></figure>
<p>在Bladder数据集中，我们发现，排列前面的2个内参基因是HSPCB与RPS13，也就是Figure 1中的内容，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190925182918.png">

</div>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">grade &lt;- pData(Bladder)[,<span class="string">"Grade"</span>]</div><div class="line">selectHKs(Bladder, </div><div class="line">	group = grade, </div><div class="line">	log = <span class="literal">FALSE</span>, </div><div class="line">	trace = <span class="literal">FALSE</span>,</div><div class="line">	Symbols = featureNames(Bladder), </div><div class="line">	minNrHKs = <span class="number">13</span>,</div><div class="line">	method = <span class="string">"NormFinder"</span>)$ranking</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">&gt; grade &lt;- pData(Bladder)[,<span class="string">"Grade"</span>]</div><div class="line">&gt; selectHKs(Bladder, </div><div class="line">+           group = grade, </div><div class="line">+           log = <span class="literal">FALSE</span>, </div><div class="line">+           trace = <span class="literal">FALSE</span>,</div><div class="line">+           Symbols = featureNames(Bladder), </div><div class="line">+           minNrHKs = <span class="number">13</span>,</div><div class="line">+           method = <span class="string">"NormFinder"</span>)$ranking</div><div class="line">         <span class="number">1</span>          <span class="number">2</span>          <span class="number">3</span>          <span class="number">4</span>          <span class="number">5</span>          <span class="number">6</span>          <span class="number">7</span> </div><div class="line">   <span class="string">"HSPCB"</span>    <span class="string">"RPS13"</span>      <span class="string">"UBC"</span>    <span class="string">"RPS23"</span>    <span class="string">"ATP5B"</span>     <span class="string">"TEGT"</span>      <span class="string">"UBB"</span> </div><div class="line">         <span class="number">8</span>          <span class="number">9</span>         <span class="number">10</span>         <span class="number">11</span>         <span class="number">12</span>         <span class="number">13</span> </div><div class="line"><span class="string">"FLJ20030"</span>     <span class="string">"CFL1"</span>   <span class="string">"S100A6"</span>    <span class="string">"FLOT2"</span>     <span class="string">"ACTB"</span>     <span class="string">"TPT1"</span></div></pre></td></tr></table></figure>
<h2 id="使用多内参进行均一化">使用多内参进行均一化</h2>
<h3 id="单内参的δcq方法">单内参的ΔCq方法</h3>
<p>单内参均一化的方法就是，使用某个基因的Cq值减去内参的Cq值。<code>NormqPCR</code>中就有相关的计算函数，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">path &lt;- system.file(<span class="string">"exData"</span>, package = <span class="string">"NormqPCR"</span>)</div><div class="line">taqman.example &lt;- file.path(path, <span class="string">"example.txt"</span>)</div><div class="line">qPCR.example &lt;- file.path(path, <span class="string">"qPCR.example.txt"</span>)</div><div class="line">qPCRBatch.taqman &lt;- read.taqman(taqman.example)</div><div class="line">hkgs&lt;-<span class="string">"Actb-Rn00667869_m1"</span></div><div class="line">qPCRBatch.norm &lt;- deltaCq(qPCRBatch = qPCRBatch.taqman, hkgs = hkgs, calc=<span class="string">"arith"</span>)</div><div class="line">head(exprs(qPCRBatch.taqman)) <span class="comment"># raw data</span></div><div class="line">head(exprs(qPCRBatch.norm)) <span class="comment"># Normlazation data</span></div></pre></td></tr></table></figure>
<p>这里我们使用了Actb作为内参，计算结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line">&gt; head(exprs(qPCRBatch.taqman)) <span class="comment"># raw data</span></div><div class="line">                     fp1.day3.v fp2.day3.v fp5.day3.mia fp6.day3.mia</div><div class="line">Actb.Rn00667869_m1     <span class="number">20.92301</span>   <span class="number">21.00262</span>     <span class="number">20.88438</span>     <span class="number">20.38190</span></div><div class="line">Adipoq.Rn00595250_m1   <span class="number">20.93906</span>   <span class="number">20.88610</span>     <span class="number">23.81790</span>     <span class="number">22.92289</span></div><div class="line">Adrbk1.Rn00562822_m1         <span class="literal">NA</span>         <span class="literal">NA</span>     <span class="number">27.45101</span>     <span class="number">27.02446</span></div><div class="line">Agtrl1.Rn00580252_s1   <span class="number">25.82239</span>   <span class="number">26.03846</span>     <span class="number">27.28175</span>     <span class="number">26.06274</span></div><div class="line">Alpl.Rn00564931_m1     <span class="number">33.45495</span>   <span class="number">32.81128</span>     <span class="number">33.91955</span>     <span class="number">32.62145</span></div><div class="line">B2m.Rn00560865_m1      <span class="number">21.66457</span>   <span class="number">21.89334</span>     <span class="number">22.92485</span>     <span class="number">22.61651</span></div><div class="line">                     fp.3.day.3.v fp.4.day.3.v fp.7.day.3.mia fp.8.day.3.mia</div><div class="line">Actb.Rn00667869_m1       <span class="number">20.94854</span>     <span class="number">21.48838</span>       <span class="number">20.97863</span>       <span class="number">21.10281</span></div><div class="line">Adipoq.Rn00595250_m1     <span class="number">20.76957</span>     <span class="number">20.92512</span>       <span class="number">23.43714</span>       <span class="number">23.83928</span></div><div class="line">Adrbk1.Rn00562822_m1           <span class="literal">NA</span>           <span class="literal">NA</span>       <span class="number">24.71573</span>       <span class="number">27.97638</span></div><div class="line">Agtrl1.Rn00580252_s1     <span class="number">26.16934</span>     <span class="number">25.91374</span>       <span class="number">25.77341</span>       <span class="number">26.44801</span></div><div class="line">Alpl.Rn00564931_m1       <span class="number">33.34335</span>     <span class="number">33.26128</span>       <span class="number">33.08863</span>       <span class="number">33.35799</span></div><div class="line">B2m.Rn00560865_m1        <span class="number">21.45406</span>     <span class="number">22.36598</span>       <span class="number">22.90620</span>       <span class="number">23.00608</span></div><div class="line">&gt; head(exprs(qPCRBatch.norm)) <span class="comment"># Normlazation data</span></div><div class="line">                     fp1.day3.v fp2.day3.v fp5.day3.mia fp6.day3.mia</div><div class="line">Actb.Rn00667869_m1     <span class="number">0.000000</span>   <span class="number">0.000000</span>     <span class="number">0.000000</span>     <span class="number">0.000000</span></div><div class="line">Adipoq.Rn00595250_m1   <span class="number">0.016052</span>  -<span class="number">0.116520</span>     <span class="number">2.933523</span>     <span class="number">2.540987</span></div><div class="line">Adrbk1.Rn00562822_m1         <span class="literal">NA</span>         <span class="literal">NA</span>     <span class="number">6.566628</span>     <span class="number">6.642561</span></div><div class="line">Agtrl1.Rn00580252_s1   <span class="number">4.899380</span>   <span class="number">5.035841</span>     <span class="number">6.397364</span>     <span class="number">5.680837</span></div><div class="line">Alpl.Rn00564931_m1    <span class="number">12.531942</span>  <span class="number">11.808657</span>    <span class="number">13.035166</span>    <span class="number">12.239549</span></div><div class="line">B2m.Rn00560865_m1      <span class="number">0.741558</span>   <span class="number">0.890717</span>     <span class="number">2.040470</span>     <span class="number">2.234605</span></div><div class="line">                     fp.3.day.3.v fp.4.day.3.v fp.7.day.3.mia fp.8.day.3.mia</div><div class="line">Actb.Rn00667869_m1       <span class="number">0.000000</span>     <span class="number">0.000000</span>       <span class="number">0.000000</span>       <span class="number">0.000000</span></div><div class="line">Adipoq.Rn00595250_m1    -<span class="number">0.178971</span>    -<span class="number">0.563263</span>       <span class="number">2.458509</span>       <span class="number">2.736475</span></div><div class="line">Adrbk1.Rn00562822_m1           <span class="literal">NA</span>           <span class="literal">NA</span>       <span class="number">3.737100</span>       <span class="number">6.873568</span></div><div class="line">Agtrl1.Rn00580252_s1     <span class="number">5.220796</span>     <span class="number">4.425364</span>       <span class="number">4.794776</span>       <span class="number">5.345202</span></div><div class="line">Alpl.Rn00564931_m1      <span class="number">12.394802</span>    <span class="number">11.772896</span>      <span class="number">12.110000</span>      <span class="number">12.255186</span></div><div class="line">B2m.Rn00560865_m1        <span class="number">0.505516</span>     <span class="number">0.877598</span>       <span class="number">1.927563</span>       <span class="number">1.903269</span></div></pre></td></tr></table></figure>
<p>生成的结果是一个qPCRBatch对象，很多R包例如heatmap就兼容这类对象。</p>
<h3 id="多内参的δcq方法">多内参的ΔCq方法</h3>
<p>如果使用前面提到的geNorm或NormFinder算法找到了多个内参，此时想要用这多个内参进行均一化，那么就需要计算这几个内参的均值，构成一个“伪内参“(pseudo-housekeeper)进行均一化。现在我们使用三个内参，分别为GAPDH，beta-2-microglobulin和Beta-actin来进行均一化，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">hkgs&lt;-c(<span class="string">"Actb-Rn00667869_m1"</span>, <span class="string">"B2m-Rn00560865_m1"</span>, <span class="string">"Gapdh-Rn99999916_s1"</span>)</div><div class="line">qPCRBatch.norm &lt;- deltaCq(qPCRBatch = qPCRBatch.taqman, hkgs = hkgs, calc=<span class="string">"arith"</span>)</div><div class="line">head(exprs(qPCRBatch.norm))</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">&gt; head(exprs(qPCRBatch.norm))</div><div class="line">                     fp1.day3.v fp2.day3.v fp5.day3.mia fp6.day3.mia</div><div class="line">Actb.Rn00667869_m1   -<span class="number">1.2998917</span> -<span class="number">1.2816963</span>    -<span class="number">1.380296</span>   -<span class="number">1.5106197</span></div><div class="line">Adipoq.Rn00595250_m1 -<span class="number">1.2838397</span> -<span class="number">1.3982163</span>     <span class="number">1.553227</span>    <span class="number">1.0303673</span></div><div class="line">Adrbk1.Rn00562822_m1         <span class="literal">NA</span>         <span class="literal">NA</span>     <span class="number">5.186332</span>    <span class="number">5.1319413</span></div><div class="line">Agtrl1.Rn00580252_s1  <span class="number">3.5994883</span>  <span class="number">3.7541447</span>     <span class="number">5.017068</span>    <span class="number">4.1702173</span></div><div class="line">Alpl.Rn00564931_m1   <span class="number">11.2320503</span> <span class="number">10.5269607</span>    <span class="number">11.654870</span>   <span class="number">10.7289293</span></div><div class="line">B2m.Rn00560865_m1    -<span class="number">0.5583337</span> -<span class="number">0.3909793</span>     <span class="number">0.660174</span>    <span class="number">0.7239853</span></div><div class="line">                     fp.3.day.3.v fp.4.day.3.v fp.7.day.3.mia fp.8.day.3.mia</div><div class="line">Actb.Rn00667869_m1     -<span class="number">1.1644617</span>   -<span class="number">1.1714227</span>      -<span class="number">1.323712</span>      -<span class="number">1.286277</span></div><div class="line">Adipoq.Rn00595250_m1   -<span class="number">1.3434327</span>   -<span class="number">1.7346857</span>       <span class="number">1.134797</span>       <span class="number">1.450198</span></div><div class="line">Adrbk1.Rn00562822_m1           <span class="literal">NA</span>           <span class="literal">NA</span>       <span class="number">2.413388</span>       <span class="number">5.587291</span></div><div class="line">Agtrl1.Rn00580252_s1    <span class="number">4.0563343</span>    <span class="number">3.2539413</span>       <span class="number">3.471064</span>       <span class="number">4.058925</span></div><div class="line">Alpl.Rn00564931_m1     <span class="number">11.2303403</span>   <span class="number">10.6014733</span>      <span class="number">10.786288</span>      <span class="number">10.968909</span></div><div class="line">B2m.Rn00560865_m1      -<span class="number">0.6589457</span>   -<span class="number">0.2938247</span>       <span class="number">0.603851</span>       <span class="number">0.616992</span></div></pre></td></tr></table></figure>
<h3 id="单内参2-δδcq方法">单内参2^-ΔΔCq方法</h3>
<p>使用2^-ΔΔCq方法哦可以计算两个样本类型之间的相对表达值。默认情况下，同一个样本的目标基因与其内参基因配对进行计算，此时的标准差就体现在不同基因与不同内参上。但是，如果参数中设定了<code>paired=FALSE</code>，那么标准差的计算公式就是<code>s=sqrt(s1^2+s2^2)</code>，这里的s1是目标基因的标准差，s2是内参基因的标准差，但是，如果当你要比较的基因与内参基因是来源于同一个样本时，不推荐这种方法，例如使用Taqman板的情况就是如此，但是，如果要考虑到完整性(completeness)以及要使用不同的生物学重复中获得的内参基因时，可以考虑使用这种计算方法，例如我们最初设计的内参数据并不好时，当采用事后检验(post hoc)时，就采用这种方法，或者是当NormqPCR用于处理那些单独板孔中的扩增数据时，也是采用这种方法。</p>
<p>现在我们读取原始数据，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">path &lt;- system.file(<span class="string">"exData"</span>, package = <span class="string">"NormqPCR"</span>)</div><div class="line">taqman.example &lt;- file.path(path, <span class="string">"example.txt"</span>)</div><div class="line">qPCR.example &lt;- file.path(path, <span class="string">"qPCR.example.txt"</span>)</div><div class="line">qPCRBatch.taqman &lt;- read.taqman(taqman.example)</div></pre></td></tr></table></figure>
<p><code>deltaDeltaCq()</code>函数在进行计算时需要一个比较矩阵。在这个矩阵中，列是样本名（例如case或control），这与<code>limma</code>包中的数据类似。这个比较矩阵的列中只包括1或0这两个数据，用于指定分类变量，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">contM &lt;- cbind(c(<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>),c(<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>))</div><div class="line">colnames(contM) &lt;- c(<span class="string">"interestingPhenotype"</span>,<span class="string">"wildTypePhenotype"</span>)</div><div class="line">rownames(contM) &lt;- sampleNames(qPCRBatch.taqman)</div><div class="line">contM</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">&gt; contM</div><div class="line">               interestingPhenotype wildTypePhenotype</div><div class="line">fp1.day3.v                        <span class="number">0</span>                 <span class="number">1</span></div><div class="line">fp2.day3.v                        <span class="number">0</span>                 <span class="number">1</span></div><div class="line">fp5.day3.mia                      <span class="number">1</span>                 <span class="number">0</span></div><div class="line">fp6.day3.mia                      <span class="number">1</span>                 <span class="number">0</span></div><div class="line">fp.3.day.3.v                      <span class="number">0</span>                 <span class="number">1</span></div><div class="line">fp.4.day.3.v                      <span class="number">0</span>                 <span class="number">1</span></div><div class="line">fp.7.day.3.mia                    <span class="number">1</span>                 <span class="number">0</span></div><div class="line">fp.8.day.3.mia                    <span class="number">1</span>                 <span class="number">0</span></div></pre></td></tr></table></figure>
<p>此时，我们可以指定一个内参基因来进行均一化，然后再看一个某个基因在实验组(case)和对照组(control)的比值，计算结果包括以下信息（按列显示）：</p>
<ol style="list-style-type: decimal">
<li>每个基因的表达值；</li>
<li>实验组的ΔCq值：</li>
<li>Cq值的sd；</li>
<li>对照组的ΔCq值；</li>
<li>对照组的ΔCq值的sd；</li>
<li>2^-ΔΔCq值，这是对照组与实验组的差异；</li>
<li>和8. 分别是1和0时的sd值，如下所示：</li>
</ol>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">hkg &lt;- <span class="string">"Actb-Rn00667869_m1"</span></div><div class="line">ddCq.taqman &lt;- deltaDeltaCq(qPCRBatch = qPCRBatch.taqman, </div><div class="line">                            maxNACase=<span class="number">1</span>, maxNAControl=<span class="number">1</span>,</div><div class="line">                            hkg=hkg, </div><div class="line">                            contrastM=contM, </div><div class="line">                            case=<span class="string">"interestingPhenotype"</span>,</div><div class="line">                            control=<span class="string">"wildTypePhenotype"</span>, </div><div class="line">                            statCalc=<span class="string">"geom"</span>,</div><div class="line">                            hkgCalc=<span class="string">"arith"</span>)</div><div class="line">head(ddCq.taqman)</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">&gt; head(ddCq.taqman)</div><div class="line">                    ID <span class="number">2</span>^-dCt.interestingPhenotype interestingPhenotype.sd</div><div class="line"><span class="number">1</span>   Actb.Rn00667869_m1                   <span class="number">1.000e+00</span>               <span class="number">0.000e+00</span></div><div class="line"><span class="number">2</span> Adipoq.Rn00595250_m1                   <span class="number">1.587e-01</span>               <span class="number">2.280e-02</span></div><div class="line"><span class="number">3</span> Adrbk1.Rn00562822_m1                   <span class="number">2.602e-02</span>               <span class="number">3.266e-02</span></div><div class="line"><span class="number">4</span> Agtrl1.Rn00580252_s1                   <span class="number">2.300e-02</span>               <span class="number">1.014e-02</span></div><div class="line"><span class="number">5</span>   Alpl.Rn00564931_m1                   <span class="number">1.892e-04</span>               <span class="number">4.770e-05</span></div><div class="line"><span class="number">6</span>    B2m.Rn00560865_m1                   <span class="number">2.464e-01</span>               <span class="number">2.498e-02</span></div><div class="line">  <span class="number">2</span>^-dCt.wildTypePhenotype wildTypePhenotype.sd              <span class="number">2</span>^-ddCt <span class="number">2</span>^-ddCt.min</div><div class="line"><span class="number">1</span>                <span class="number">1.000e+00</span>            <span class="number">0.000e+00</span> <span class="number">1</span>                             <span class="literal">NA</span></div><div class="line"><span class="number">2</span>                <span class="number">1.171e+00</span>            <span class="number">2.131e-01</span> <span class="number">0.135541545192243</span>             <span class="literal">NA</span></div><div class="line"><span class="number">3</span>                       <span class="literal">NA</span>                   <span class="literal">NA</span> +                             <span class="literal">NA</span></div><div class="line"><span class="number">4</span>                <span class="number">3.434e-02</span>            <span class="number">8.584e-03</span> <span class="number">0.669721905042939</span>             <span class="literal">NA</span></div><div class="line"><span class="number">5</span>                <span class="number">2.298e-04</span>            <span class="number">6.107e-05</span> <span class="number">0.823327272466571</span>             <span class="literal">NA</span></div><div class="line"><span class="number">6</span>                <span class="number">5.965e-01</span>            <span class="number">7.668e-02</span> <span class="number">0.413128242070071</span>             <span class="literal">NA</span></div><div class="line">  <span class="number">2</span>^-ddCt.max</div><div class="line"><span class="number">1</span>          <span class="literal">NA</span></div><div class="line"><span class="number">2</span>          <span class="literal">NA</span></div><div class="line"><span class="number">3</span>          <span class="literal">NA</span></div><div class="line"><span class="number">4</span>          <span class="literal">NA</span></div><div class="line"><span class="number">5</span>          <span class="literal">NA</span></div><div class="line"><span class="number">6</span>          <span class="literal">NA</span></div></pre></td></tr></table></figure>
<p>也可以使用每个单独的样本/孔(samples/wells)方法来计算平均值。这里我们单独计算sd，然后将它们汇总起来。因此，同一个样本的内参与检测值的本领信息氷是人干活的，这同时会增加变异，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">hkg &lt;- <span class="string">"Actb-Rn00667869_m1"</span></div><div class="line">ddCqAvg.taqman &lt;- deltaDeltaCq(qPCRBatch = qPCRBatch.taqman, </div><div class="line">                               maxNACase=<span class="number">1</span>, </div><div class="line">                               maxNAControl=<span class="number">1</span>,</div><div class="line">                               hkg=hkg, </div><div class="line">                               contrastM=contM, </div><div class="line">                               case=<span class="string">"interestingPhenotype"</span>,</div><div class="line">                               control=<span class="string">"wildTypePhenotype"</span>, </div><div class="line">                               paired=<span class="literal">FALSE</span>, statCalc=<span class="string">"geom"</span>,</div><div class="line">                               hkgCalc=<span class="string">"arith"</span>)</div><div class="line"></div><div class="line">head(ddCqAvg.taqman)</div></pre></td></tr></table></figure>
<p>运行结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line">&gt; hkg &lt;- <span class="string">"Actb-Rn00667869_m1"</span></div><div class="line">&gt; ddCqAvg.taqman &lt;- deltaDeltaCq(qPCRBatch = qPCRBatch.taqman, </div><div class="line">+                                maxNACase=<span class="number">1</span>, </div><div class="line">+                                maxNAControl=<span class="number">1</span>,</div><div class="line">+                                hkg=hkg, </div><div class="line">+                                contrastM=contM, </div><div class="line">+                                case=<span class="string">"interestingPhenotype"</span>,</div><div class="line">+                                control=<span class="string">"wildTypePhenotype"</span>, </div><div class="line">+                                paired=<span class="literal">FALSE</span>, statCalc=<span class="string">"geom"</span>,</div><div class="line">+                                hkgCalc=<span class="string">"arith"</span>)</div><div class="line">There were <span class="number">12</span> warnings (use warnings() to see them)</div><div class="line">&gt; </div><div class="line">&gt; head(ddCqAvg.taqman)</div><div class="line">                    ID <span class="number">2</span>^-dCt.interestingPhenotype interestingPhenotype.sd</div><div class="line"><span class="number">1</span>   Actb.Rn00667869_m1                   <span class="number">1.000e+00</span>               <span class="number">0.000e+00</span></div><div class="line"><span class="number">2</span> Adipoq.Rn00595250_m1                   <span class="number">1.587e-01</span>               <span class="number">2.280e-02</span></div><div class="line"><span class="number">3</span> Adrbk1.Rn00562822_m1                   <span class="number">2.602e-02</span>               <span class="number">3.266e-02</span></div><div class="line"><span class="number">4</span> Agtrl1.Rn00580252_s1                   <span class="number">2.300e-02</span>               <span class="number">1.014e-02</span></div><div class="line"><span class="number">5</span>   Alpl.Rn00564931_m1                   <span class="number">1.892e-04</span>               <span class="number">4.770e-05</span></div><div class="line"><span class="number">6</span>    B2m.Rn00560865_m1                   <span class="number">2.464e-01</span>               <span class="number">2.498e-02</span></div><div class="line">  <span class="number">2</span>^-dCt.wildTypePhenotype wildTypePhenotype.sd              <span class="number">2</span>^-ddCt <span class="number">2</span>^-ddCt.min</div><div class="line"><span class="number">1</span>                <span class="number">1.000e+00</span>            <span class="number">0.000e+00</span> <span class="number">1</span>                             <span class="literal">NA</span></div><div class="line"><span class="number">2</span>                <span class="number">1.171e+00</span>            <span class="number">2.131e-01</span> <span class="number">0.135541545192243</span>             <span class="literal">NA</span></div><div class="line"><span class="number">3</span>                       <span class="literal">NA</span>                   <span class="literal">NA</span> +                             <span class="literal">NA</span></div><div class="line"><span class="number">4</span>                <span class="number">3.434e-02</span>            <span class="number">8.584e-03</span> <span class="number">0.669721905042939</span>             <span class="literal">NA</span></div><div class="line"><span class="number">5</span>                <span class="number">2.298e-04</span>            <span class="number">6.107e-05</span> <span class="number">0.823327272466571</span>             <span class="literal">NA</span></div><div class="line"><span class="number">6</span>                <span class="number">5.965e-01</span>            <span class="number">7.668e-02</span> <span class="number">0.413128242070071</span>             <span class="literal">NA</span></div><div class="line">  <span class="number">2</span>^-ddCt.max</div><div class="line"><span class="number">1</span>          <span class="literal">NA</span></div><div class="line"><span class="number">2</span>          <span class="literal">NA</span></div><div class="line"><span class="number">3</span>          <span class="literal">NA</span></div><div class="line"><span class="number">4</span>          <span class="literal">NA</span></div><div class="line"><span class="number">5</span>          <span class="literal">NA</span></div><div class="line"><span class="number">6</span>          <span class="literal">NA</span></div></pre></td></tr></table></figure>
<h3 id="多内参2-δδcq方法">多内参2^-ΔΔCq方法</h3>
<p>如果想使用大于1个内参进行均一化，例如，我们想使用NormFinder/geNorm算法来进行均一化。我们就可以使用几何平均数(geometric mean)来构建一个<code>伪内参(pseudo-housekeeper)</code>来实现这一目的。现在我们使用GAPDH，beta-2-microglobulin和Beta-actin这三个内参来进行均一化，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">qPCRBatch.taqman &lt;- read.taqman(taqman.example)</div><div class="line">contM &lt;- cbind(c(<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>),c(<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>))</div><div class="line">colnames(contM) &lt;- c(<span class="string">"interestingPhenotype"</span>,<span class="string">"wildTypePhenotype"</span>)</div><div class="line">rownames(contM) &lt;- sampleNames(qPCRBatch.taqman)</div><div class="line">hkgs&lt;-c(<span class="string">"Actb-Rn00667869_m1"</span>, <span class="string">"B2m-Rn00560865_m1"</span>, <span class="string">"Gapdh-Rn99999916_s1"</span>)</div><div class="line">ddCq.gM.taqman &lt;- deltaDeltaCq(qPCRBatch = qPCRBatch.taqman,</div><div class="line">                               maxNACase=<span class="number">1</span>,</div><div class="line">                               maxNAControl=<span class="number">1</span>,</div><div class="line">                               hkgs=hkgs, </div><div class="line">                               contrastM=contM,</div><div class="line">                               case=<span class="string">"interestingPhenotype"</span>,</div><div class="line">                               control=<span class="string">"wildTypePhenotype"</span>, </div><div class="line">                               statCalc=<span class="string">"arith"</span>,</div><div class="line">                               hkgCalc=<span class="string">"arith"</span>)</div><div class="line">head(ddCq.gM.taqman)</div></pre></td></tr></table></figure>
<p>计算结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div></pre></td><td class="code"><pre><div class="line">&gt; qPCRBatch.taqman &lt;- read.taqman(taqman.example)</div><div class="line">Warning message:</div><div class="line">In read.taqman(taqman.example) :</div><div class="line">  Incompatible phenoData object. Created a new one using sample name data derived from raw data.</div><div class="line"></div><div class="line">&gt; contM &lt;- cbind(c(<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>),c(<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>))</div><div class="line">&gt; colnames(contM) &lt;- c(<span class="string">"interestingPhenotype"</span>,<span class="string">"wildTypePhenotype"</span>)</div><div class="line">&gt; rownames(contM) &lt;- sampleNames(qPCRBatch.taqman)</div><div class="line">&gt; hkgs&lt;-c(<span class="string">"Actb-Rn00667869_m1"</span>, <span class="string">"B2m-Rn00560865_m1"</span>, <span class="string">"Gapdh-Rn99999916_s1"</span>)</div><div class="line">&gt; ddCq.gM.taqman &lt;- deltaDeltaCq(qPCRBatch = qPCRBatch.taqman,</div><div class="line">+                                maxNACase=<span class="number">1</span>,</div><div class="line">+                                maxNAControl=<span class="number">1</span>,</div><div class="line">+                                hkgs=hkgs, </div><div class="line">+                                contrastM=contM,</div><div class="line">+                                case=<span class="string">"interestingPhenotype"</span>,</div><div class="line">+                                control=<span class="string">"wildTypePhenotype"</span>, </div><div class="line">+                                statCalc=<span class="string">"arith"</span>,</div><div class="line">+                                hkgCalc=<span class="string">"arith"</span>)</div><div class="line">There were <span class="number">12</span> warnings (use warnings() to see them)</div><div class="line">&gt; head(ddCq.gM.taqman)</div><div class="line">                    ID <span class="number">2</span>^-dCt.interestingPhenotype interestingPhenotype.sd</div><div class="line"><span class="number">1</span>   Actb.Rn00667869_m1                   <span class="number">2.594e+00</span>                 <span class="number">0.09819</span></div><div class="line"><span class="number">2</span> Adipoq.Rn00595250_m1                   <span class="number">4.083e-01</span>                 <span class="number">0.24929</span></div><div class="line"><span class="number">3</span> Adrbk1.Rn00562822_m1                   <span class="number">4.182e-02</span>                 <span class="number">1.45844</span></div><div class="line"><span class="number">4</span> Agtrl1.Rn00580252_s1                   <span class="number">5.520e-02</span>                 <span class="number">0.63719</span></div><div class="line"><span class="number">5</span>   Alpl.Rn00564931_m1                   <span class="number">4.767e-04</span>                 <span class="number">0.42589</span></div><div class="line"><span class="number">6</span>    B2m.Rn00560865_m1                   <span class="number">6.367e-01</span>                 <span class="number">0.05413</span></div><div class="line">  <span class="number">2</span>^-dCt.wildTypePhenotype wildTypePhenotype.sd              <span class="number">2</span>^-ddCt <span class="number">2</span>^-ddCt.min</div><div class="line"><span class="number">1</span>                <span class="number">2.345e+00</span>             <span class="number">0.071373</span> <span class="number">1.10638851325547</span>       <span class="number">1.034e+00</span></div><div class="line"><span class="number">2</span>                <span class="number">2.713e+00</span>             <span class="number">0.201905</span> <span class="number">0.150497255530234</span>      <span class="number">1.266e-01</span></div><div class="line"><span class="number">3</span>                       <span class="literal">NA</span>                   <span class="literal">NA</span> +                             <span class="literal">NA</span></div><div class="line"><span class="number">4</span>                <span class="number">7.878e-02</span>             <span class="number">0.333840</span> <span class="number">0.700597907024805</span>      <span class="number">4.505e-01</span></div><div class="line"><span class="number">5</span>                <span class="number">5.242e-04</span>             <span class="number">0.386280</span> <span class="number">0.909381199520663</span>      <span class="number">6.769e-01</span></div><div class="line"><span class="number">6</span>                <span class="number">1.390e+00</span>             <span class="number">0.163975</span> <span class="number">0.457939394245865</span>      <span class="number">4.411e-01</span></div><div class="line">  <span class="number">2</span>^-ddCt.max</div><div class="line"><span class="number">1</span>    <span class="number">1.184310</span></div><div class="line"><span class="number">2</span>    <span class="number">0.178884</span></div><div class="line"><span class="number">3</span>          <span class="literal">NA</span></div><div class="line"><span class="number">4</span>    <span class="number">1.089636</span></div><div class="line"><span class="number">5</span>    <span class="number">1.221662</span></div><div class="line"><span class="number">6</span>    <span class="number">0.475448</span></div></pre></td></tr></table></figure>
<p>我们也可以使用那些在样本间方差相同的内参来进行均一化，这个类似于前面提到的第二个<code>deltaDeltaCq</code>方法，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">qPCRBatch.taqman &lt;- read.taqman(taqman.example)</div><div class="line">contM &lt;- cbind(c(<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>),c(<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>))</div><div class="line">colnames(contM) &lt;- c(<span class="string">"interestingPhenotype"</span>,<span class="string">"wildTypePhenotype"</span>)</div><div class="line">rownames(contM) &lt;- sampleNames(qPCRBatch.taqman)</div><div class="line">hkgs&lt;-c(<span class="string">"Actb-Rn00667869_m1"</span>, <span class="string">"B2m-Rn00560865_m1"</span>, <span class="string">"Gapdh-Rn99999916_s1"</span>)</div><div class="line">ddAvgCq.gM.taqman &lt;-deltaDeltaCq(qPCRBatch = qPCRBatch.taqman, </div><div class="line">                                 maxNACase=<span class="number">1</span>, maxNAControl=<span class="number">1</span>,</div><div class="line">                                 hkgs=hkgs, </div><div class="line">                                 contrastM=contM, </div><div class="line">                                 case=<span class="string">"interestingPhenotype"</span>,</div><div class="line">                                 control=<span class="string">"wildTypePhenotype"</span>,</div><div class="line">                                 paired=<span class="literal">FALSE</span>, </div><div class="line">                                 statCalc=<span class="string">"arith"</span>,</div><div class="line">                                 hkgCalc=<span class="string">"arith"</span>)</div><div class="line">head(ddAvgCq.gM.taqman)</div></pre></td></tr></table></figure>
<p>计算结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div></pre></td><td class="code"><pre><div class="line">&gt; qPCRBatch.taqman &lt;- read.taqman(taqman.example)</div><div class="line">Warning message:</div><div class="line">In read.taqman(taqman.example) :</div><div class="line">  Incompatible phenoData object. Created a new one using sample name data derived from raw data.</div><div class="line"></div><div class="line">&gt; contM &lt;- cbind(c(<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>),c(<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>))</div><div class="line">&gt; colnames(contM) &lt;- c(<span class="string">"interestingPhenotype"</span>,<span class="string">"wildTypePhenotype"</span>)</div><div class="line">&gt; rownames(contM) &lt;- sampleNames(qPCRBatch.taqman)</div><div class="line">&gt; hkgs&lt;-c(<span class="string">"Actb-Rn00667869_m1"</span>, <span class="string">"B2m-Rn00560865_m1"</span>, <span class="string">"Gapdh-Rn99999916_s1"</span>)</div><div class="line">&gt; ddAvgCq.gM.taqman &lt;-deltaDeltaCq(qPCRBatch = qPCRBatch.taqman, </div><div class="line">+                                  maxNACase=<span class="number">1</span>, maxNAControl=<span class="number">1</span>,</div><div class="line">+                                  hkgs=hkgs, </div><div class="line">+                                  contrastM=contM, </div><div class="line">+                                  case=<span class="string">"interestingPhenotype"</span>,</div><div class="line">+                                  control=<span class="string">"wildTypePhenotype"</span>,</div><div class="line">+                                  paired=<span class="literal">FALSE</span>, </div><div class="line">+                                  statCalc=<span class="string">"arith"</span>,</div><div class="line">+                                  hkgCalc=<span class="string">"arith"</span>)</div><div class="line">There were <span class="number">12</span> warnings (use warnings() to see them)</div><div class="line">&gt; head(ddAvgCq.gM.taqman)</div><div class="line">                    ID <span class="number">2</span>^-dCt.interestingPhenotype interestingPhenotype.sd</div><div class="line"><span class="number">1</span>   Actb.Rn00667869_m1                   <span class="number">2.594e+00</span>                  <span class="number">0.3849</span></div><div class="line"><span class="number">2</span> Adipoq.Rn00595250_m1                   <span class="number">4.083e-01</span>                  <span class="number">0.4822</span></div><div class="line"><span class="number">3</span> Adrbk1.Rn00562822_m1                   <span class="number">4.182e-02</span>                  <span class="number">1.4545</span></div><div class="line"><span class="number">4</span> Agtrl1.Rn00580252_s1                   <span class="number">5.520e-02</span>                  <span class="number">0.6905</span></div><div class="line"><span class="number">5</span>   Alpl.Rn00564931_m1                   <span class="number">4.767e-04</span>                  <span class="number">0.5846</span></div><div class="line"><span class="number">6</span>    B2m.Rn00560865_m1                   <span class="number">6.367e-01</span>                  <span class="number">0.2777</span></div><div class="line">  <span class="number">2</span>^-dCt.wildTypePhenotype wildTypePhenotype.sd              <span class="number">2</span>^-ddCt <span class="number">2</span>^-ddCt.min</div><div class="line"><span class="number">1</span>                <span class="number">2.345e+00</span>               <span class="number">0.3574</span> <span class="number">1.10638851325547</span>       <span class="number">8.473e-01</span></div><div class="line"><span class="number">2</span>                <span class="number">2.713e+00</span>               <span class="number">0.2495</span> <span class="number">0.150497255530234</span>      <span class="number">1.077e-01</span></div><div class="line"><span class="number">3</span>                       <span class="literal">NA</span>                   <span class="literal">NA</span> +                             <span class="literal">NA</span></div><div class="line"><span class="number">4</span>                <span class="number">7.878e-02</span>               <span class="number">0.2813</span> <span class="number">0.700597907024805</span>      <span class="number">4.341e-01</span></div><div class="line"><span class="number">5</span>                <span class="number">5.242e-04</span>               <span class="number">0.3689</span> <span class="number">0.909381199520663</span>      <span class="number">6.064e-01</span></div><div class="line"><span class="number">6</span>                <span class="number">1.390e+00</span>               <span class="number">0.4576</span> <span class="number">0.457939394245865</span>      <span class="number">3.778e-01</span></div><div class="line">  <span class="number">2</span>^-ddCt.max</div><div class="line"><span class="number">1</span>    <span class="number">1.444684</span></div><div class="line"><span class="number">2</span>    <span class="number">0.210221</span></div><div class="line"><span class="number">3</span>          <span class="literal">NA</span></div><div class="line"><span class="number">4</span>    <span class="number">1.130625</span></div><div class="line"><span class="number">5</span>    <span class="number">1.363762</span></div><div class="line"><span class="number">6</span>    <span class="number">0.555126</span></div></pre></td></tr></table></figure>
<h3 id="nrq值计算">NRQ值计算</h3>
<p>导入数据，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">path &lt;- system.file(<span class="string">"exData"</span>, package = <span class="string">"ReadqPCR"</span>)</div><div class="line">qPCR.example &lt;- file.path(path, <span class="string">"qPCR.example.txt"</span>)</div><div class="line">Cq.data &lt;- read.qPCR(qPCR.example)</div></pre></td></tr></table></figure>
<p>合并技术重复，并计算SD，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Cq.data1 &lt;- combineTechRepsWithSD(Cq.data)</div></pre></td></tr></table></figure>
<p>加载数据集的效应(efficiencies)，并将它们添加到数据集中，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Effs &lt;- file.path(path, <span class="string">"Efficiencies.txt"</span>)</div><div class="line">Cq.effs &lt;- read.table(file = Effs, row.names = <span class="number">1</span>, header = <span class="literal">TRUE</span>)</div><div class="line">rownames(Cq.effs) &lt;- featureNames(Cq.data1)</div><div class="line">effs(Cq.data1) &lt;- as.matrix(Cq.effs[,<span class="string">"efficiency"</span>,drop = <span class="literal">FALSE</span>])</div><div class="line">se.effs(Cq.data1) &lt;- as.matrix(Cq.effs[,<span class="string">"SD.efficiency"</span>,drop = <span class="literal">FALSE</span>])</div></pre></td></tr></table></figure>
<p>计算数据集的NRQ(normalized relative quantities)，我们只考虑两个特征值作为内参基因，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">res &lt;- ComputeNRQs(Cq.data1, hkgs = c(<span class="string">"gene_az"</span>, <span class="string">"gene_gx"</span>))</div><div class="line"><span class="comment">## NRQs</span></div><div class="line">exprs(res)</div><div class="line"></div><div class="line"><span class="comment">## SD of NRQs</span></div><div class="line">se.exprs(res)</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div></pre></td><td class="code"><pre><div class="line">&gt; res &lt;- ComputeNRQs(Cq.data1, hkgs = c(<span class="string">"gene_az"</span>, <span class="string">"gene_gx"</span>))</div><div class="line">Warning message:</div><div class="line">In .local(qPCRBatch, <span class="keyword">...</span>) : This <span class="keyword">function</span> is still experimental!</div><div class="line">&gt; <span class="comment">## NRQs</span></div><div class="line">&gt; exprs(res)</div><div class="line">            caseA     caseB  controlA  controlB</div><div class="line">gene_ai <span class="number">1.9253072</span> <span class="number">1.3586729</span> <span class="number">0.6479659</span> <span class="number">0.8749479</span></div><div class="line">gene_az <span class="number">1.0567118</span> <span class="number">1.1438982</span> <span class="number">1.0331980</span> <span class="number">0.9134997</span></div><div class="line">gene_bc <span class="number">1.1024935</span> <span class="number">0.7193500</span> <span class="number">0.7030487</span> <span class="number">1.2140836</span></div><div class="line">gene_by <span class="number">1.5102316</span> <span class="number">0.9573047</span> <span class="number">0.7527082</span> <span class="number">1.6008850</span></div><div class="line">gene_dh <span class="number">1.2982037</span> <span class="number">1.0722522</span> <span class="number">0.9623335</span> <span class="number">0.9392871</span></div><div class="line">gene_dm <span class="number">0.6590246</span> <span class="number">1.1690720</span> <span class="number">1.2475372</span> <span class="number">0.9366210</span></div><div class="line">gene_dq <span class="number">0.7541955</span> <span class="number">0.7036408</span> <span class="number">0.8327917</span> <span class="number">1.6165326</span></div><div class="line">gene_dr <span class="number">2.2192305</span> <span class="number">1.0581211</span> <span class="number">0.7026411</span> <span class="number">0.6900584</span></div><div class="line">gene_eg <span class="number">0.9366671</span> <span class="number">0.5800339</span> <span class="number">0.8313720</span> <span class="number">1.1848856</span></div><div class="line">gene_er <span class="number">0.5269062</span> <span class="number">0.9375427</span> <span class="number">0.6953326</span> <span class="number">2.3195978</span></div><div class="line">gene_ev <span class="number">1.4622280</span> <span class="number">2.3457021</span> <span class="number">0.9038912</span> <span class="number">1.1454535</span></div><div class="line">gene_fr <span class="number">1.4954763</span> <span class="number">1.6200792</span> <span class="number">0.9641192</span> <span class="number">0.7295680</span></div><div class="line">gene_fw <span class="number">0.6944248</span> <span class="number">0.8051075</span> <span class="number">1.5698382</span> <span class="number">0.7978611</span></div><div class="line">gene_gx <span class="number">0.9463318</span> <span class="number">0.8742037</span> <span class="number">0.9678687</span> <span class="number">1.0946911</span></div><div class="line">gene_hl <span class="number">1.0009372</span> <span class="number">1.4015267</span> <span class="number">0.7683665</span> <span class="number">0.7713712</span></div><div class="line">gene_il <span class="number">1.4632019</span> <span class="number">1.2595559</span> <span class="number">0.7216891</span> <span class="number">0.9318860</span></div><div class="line">gene_iv <span class="number">1.7263335</span> <span class="number">1.2275001</span> <span class="number">1.5464212</span> <span class="number">0.8881605</span></div><div class="line">gene_jr <span class="number">0.8984351</span> <span class="number">0.9834026</span> <span class="number">0.8754813</span> <span class="number">0.6637941</span></div><div class="line">gene_jw <span class="number">1.4655948</span> <span class="number">0.9340184</span> <span class="number">1.0505200</span> <span class="number">1.5504136</span></div><div class="line">gene_qs <span class="number">0.6730225</span> <span class="number">0.7610418</span> <span class="number">1.0665938</span> <span class="number">3.5329891</span></div><div class="line">gene_qy <span class="number">0.5287127</span> <span class="number">1.5722670</span> <span class="number">1.0615326</span> <span class="number">3.3252907</span></div><div class="line">gene_rz <span class="number">0.8690600</span> <span class="number">1.5588299</span> <span class="number">0.7287288</span> <span class="number">1.4812753</span></div><div class="line">gene_sw <span class="number">0.5975288</span> <span class="number">1.2406438</span> <span class="number">0.6982954</span> <span class="number">1.6007333</span></div><div class="line">gene_vx <span class="number">0.6942254</span> <span class="number">0.7168408</span> <span class="number">2.0253177</span> <span class="number">1.3190943</span></div><div class="line">gene_xz <span class="number">0.7668030</span> <span class="number">1.0218209</span> <span class="number">0.6136038</span> <span class="number">1.6729352</span></div><div class="line"></div><div class="line">&gt; <span class="comment">## SD of NRQs</span></div><div class="line">&gt; se.exprs(res)</div><div class="line">            caseA     caseB  controlA  controlB</div><div class="line">gene_ai <span class="number">1.3996554</span> <span class="number">0.8787290</span> <span class="number">0.4855882</span> <span class="number">1.0034912</span></div><div class="line">gene_az <span class="number">0.6832730</span> <span class="number">0.7601966</span> <span class="number">0.8971054</span> <span class="number">0.6031927</span></div><div class="line">gene_bc <span class="number">0.7225348</span> <span class="number">0.4746146</span> <span class="number">0.9626570</span> <span class="number">1.0478385</span></div><div class="line">gene_by <span class="number">1.1522746</span> <span class="number">0.6116269</span> <span class="number">0.6088836</span> <span class="number">2.0409211</span></div><div class="line">gene_dh <span class="number">1.2483072</span> <span class="number">0.7889984</span> <span class="number">0.6165041</span> <span class="number">0.9767947</span></div><div class="line">gene_dm <span class="number">0.4711409</span> <span class="number">0.7780238</span> <span class="number">0.8476053</span> <span class="number">0.7294405</span></div><div class="line">gene_dq <span class="number">0.7023561</span> <span class="number">0.4849899</span> <span class="number">0.5813310</span> <span class="number">1.4067670</span></div><div class="line">gene_dr <span class="number">1.4407662</span> <span class="number">1.0804211</span> <span class="number">0.4543153</span> <span class="number">0.5149367</span></div><div class="line">gene_eg <span class="number">0.7355269</span> <span class="number">0.5497433</span> <span class="number">0.5588801</span> <span class="number">1.0938601</span></div><div class="line">gene_er <span class="number">0.4301195</span> <span class="number">0.6119514</span> <span class="number">0.4471454</span> <span class="number">1.5115897</span></div><div class="line">gene_ev <span class="number">1.0094209</span> <span class="number">2.4267114</span> <span class="number">0.6337126</span> <span class="number">0.7782519</span></div><div class="line">gene_fr <span class="number">1.6760391</span> <span class="number">1.1119157</span> <span class="number">0.6226081</span> <span class="number">0.5040967</span></div><div class="line">gene_fw <span class="number">0.5041070</span> <span class="number">0.9131565</span> <span class="number">1.1153268</span> <span class="number">0.7234551</span></div><div class="line">gene_gx <span class="number">0.6046042</span> <span class="number">0.9027816</span> <span class="number">0.6713914</span> <span class="number">1.7394961</span></div><div class="line">gene_hl <span class="number">0.7633174</span> <span class="number">0.9123997</span> <span class="number">1.0000329</span> <span class="number">0.5005813</span></div><div class="line">gene_il <span class="number">1.4621406</span> <span class="number">0.9540445</span> <span class="number">0.5678634</span> <span class="number">0.6067147</span></div><div class="line">gene_iv <span class="number">1.2668346</span> <span class="number">0.8039841</span> <span class="number">0.9995225</span> <span class="number">0.8171996</span></div><div class="line">gene_jr <span class="number">0.5749672</span> <span class="number">0.6786989</span> <span class="number">0.5595295</span> <span class="number">0.4405919</span></div><div class="line">gene_jw <span class="number">0.9626606</span> <span class="number">0.7890401</span> <span class="number">0.7194378</span> <span class="number">1.1512512</span></div><div class="line">gene_qs <span class="number">0.5830335</span> <span class="number">0.5309990</span> <span class="number">0.6828952</span> <span class="number">2.8253799</span></div><div class="line">gene_qy <span class="number">0.5947918</span> <span class="number">1.1294199</span> <span class="number">0.6794829</span> <span class="number">2.1713340</span></div><div class="line">gene_rz <span class="number">0.5846751</span> <span class="number">1.7926435</span> <span class="number">0.4911506</span> <span class="number">2.1424580</span></div><div class="line">gene_sw <span class="number">0.6284440</span> <span class="number">0.8062083</span> <span class="number">0.9638307</span> <span class="number">1.8398593</span></div><div class="line">gene_vx <span class="number">0.5285361</span> <span class="number">1.0126959</span> <span class="number">1.3861226</span> <span class="number">0.8683886</span></div><div class="line">gene_xz <span class="number">0.5231477</span> <span class="number">0.9270275</span> <span class="number">0.3972901</span> <span class="number">1.3643840</span></div></pre></td></tr></table></figure>
<h2 id="参考资料">参考资料</h2>
<ol style="list-style-type: decimal">
<li>NormqPCR: Functions for normalisation of RT-qPCR data</li>
<li></li>
</ol>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/统计学/" <i class="fa fa-tag"></i> 统计学</a>
          
            <a href="/tags/均一化/" <i class="fa fa-tag"></i> 均一化</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2019/09/28/Experiment/WB实验笔记/" rel="next" title="Western Blot笔记">
                <i class="fa fa-chevron-left"></i> Western Blot笔记
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2019/10/01/BioTools/NormqPCR笔记对应文献之一/" rel="prev" title="NormqPCR笔记对应文献之一">
                NormqPCR笔记对应文献之一 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  
    <div class="comments" id="comments">
      <div id="vcomments"></div>
    </div>
  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">RVDSD</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">228</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">13</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">112</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          <div class="links-of-author motion-element">
            
          </div>

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#前言"><span class="nav-number">1.</span> <span class="nav-text">前言</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#合并技术重复"><span class="nav-number">2.</span> <span class="nav-text">合并技术重复</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#处理未检测值"><span class="nav-number">3.</span> <span class="nav-text">处理未检测值</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#选择最稳定内参基因"><span class="nav-number">4.</span> <span class="nav-text">选择最稳定内参基因</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#genorm"><span class="nav-number">4.1.</span> <span class="nav-text">geNorm</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#normfinder"><span class="nav-number">4.2.</span> <span class="nav-text">NormFinder</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#使用多内参进行均一化"><span class="nav-number">5.</span> <span class="nav-text">使用多内参进行均一化</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#单内参的δcq方法"><span class="nav-number">5.1.</span> <span class="nav-text">单内参的ΔCq方法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#多内参的δcq方法"><span class="nav-number">5.2.</span> <span class="nav-text">多内参的ΔCq方法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#单内参2-δδcq方法"><span class="nav-number">5.3.</span> <span class="nav-text">单内参2^-ΔΔCq方法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#多内参2-δδcq方法"><span class="nav-number">5.4.</span> <span class="nav-text">多内参2^-ΔΔCq方法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#nrq值计算"><span class="nav-number">5.5.</span> <span class="nav-text">NRQ值计算</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#参考资料"><span class="nav-number">6.</span> <span class="nav-text">参考资料</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

<div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">RVDSD</span>

  
</div>



<div class="powered-by">
<i class="fa fa-user-md"></i><span id="busuanzi_container_site_pv">
  本站访客数:<span id="busuanzi_value_site_uv"></span>
</span>
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>


<div class="BbeiAn-info">
	<a target="_blank" href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=41018102000118" style="color:#909090;text-decoration:none;padding-left:0px;no-repeat left center" rel="nofollow">豫公网安备 41018102000118</a>	  <!--这里将图标作为了背景，以使得能和后面的文字在同一行-->
</div>

  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.3</div>




<div class="theme-info">
  <div class="powered-by"></div>
  <span class="post-count">博客全站共917.9k字</span>
</div>

        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.3"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.3"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.3"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.3"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.3"></script>



  


  




	





  





  












  





  

  

  
  

  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config("");
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="custom_mathjax_source">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->
  


  

  

</body>
</html>
