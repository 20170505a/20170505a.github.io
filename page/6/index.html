<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.3" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.3">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.3" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta property="og:type" content="website">
<meta property="og:title" content="RVDSD的个人笔记本">
<meta property="og:url" content="http://rvdsd.top/page/6/index.html">
<meta property="og:site_name" content="RVDSD的个人笔记本">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="RVDSD的个人笔记本">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.3',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://rvdsd.top/page/6/"/>





  <title>RVDSD的个人笔记本</title><!-- hexo-inject:begin --><!-- hexo-inject:end -->
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">RVDSD的个人笔记本</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">学习过程中的输出</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2018/05/02/Linux/Linux-shell04-处理用户输入/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/05/02/Linux/Linux-shell04-处理用户输入/" itemprop="url">Shell学习笔记（4）——处理用户输入</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-05-02T12:12:54+08:00">
                2018-05-02
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Linux/" itemprop="url" rel="index">
                    <span itemprop="name">Linux</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  7,003
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  30
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="命令行参数"><a href="#命令行参数" class="headerlink" title="命令行参数"></a>命令行参数</h2><p>脚本还可以接受一些参数。向shell脚本传递数据的最基本方法是使用命令行参数，命令行参数就像是一些常规的Linux命令一样，例如<code>head -20 file001.sh</code>，在一条命令上，head命令就能接收一个<code>-20</code>的参数，用户自己定义的脚本，也可以接收一定的参数。</p>
<h3 id="读取参数"><a href="#读取参数" class="headerlink" title="读取参数"></a>读取参数</h3><h4 id="第1个案例：读取1个参数"><a href="#第1个案例：读取1个参数" class="headerlink" title="第1个案例：读取1个参数"></a>第1个案例：读取1个参数</h4><p>bash shell会将一些称为位置参数（positional parameter）的特殊变量分配给输入到命令行中的所有参数，这也包括shell所执行的脚本名称，位于参数变量是标准的数据，其中，<code>$0</code>是程序名，<code>$1</code>是第1个参数，<code>$2</code>是第2个参数，直到第9个参数，即<code>$9</code>。下面的案例是shell脚本中使用单个命令行参数的例子。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span>!/bin/bash</div><div class="line"><span class="meta">#</span> using one command line parameter</div><div class="line"><span class="meta">#</span> </div><div class="line"></div><div class="line">factorial=1</div><div class="line"></div><div class="line">for (( number=1; number &lt;= $1;number++ )) </div><div class="line"><span class="meta">#</span> 这里的$1指的是脚本运行过程中输入的参数，在后面的运行过程中，输入5</div><div class="line"> do</div><div class="line">    factorial=$[ $factorial*$number ]</div><div class="line"> done</div><div class="line"> echo The factorial of $1 is $factorial</div></pre></td></tr></table></figure>
<p>运行结果如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~/userdata$ bash test1.sh 5</div><div class="line">The factorial of 5 is 120</div></pre></td></tr></table></figure>
<p>运行过程：第1次：factorial=1，number=1；第2次：n=2，f=2；第3次：n=3，f=6；第4次：n=4,f=24；第5次：n=5；f=120。</p>
<h4 id="第2个案例：读取2个及以上参数"><a href="#第2个案例：读取2个及以上参数" class="headerlink" title="第2个案例：读取2个及以上参数"></a>第2个案例：读取2个及以上参数</h4><p>如果要读取更多的参数，需要将每个参数用空格分开，如下所示：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span>!/bin/bash</div><div class="line"><span class="meta">#</span> testing two command line parameters</div><div class="line"><span class="meta">#</span></div><div class="line">total=$[ $1*$2 ]</div><div class="line">echo The first parameter is $1.</div><div class="line">echo The second parameter is $2.</div><div class="line">echo The total value is $total.</div></pre></td></tr></table></figure>
<p>运行结果如下所示：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">The first parameter is 2.</div><div class="line">The second parameter is 5.</div><div class="line">The total value is 10.</div></pre></td></tr></table></figure></p>
<h4 id="第3个案例，使用字符串作为变量"><a href="#第3个案例，使用字符串作为变量" class="headerlink" title="第3个案例，使用字符串作为变量"></a>第3个案例，使用字符串作为变量</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span>!bin/bash</div><div class="line"><span class="meta">#</span> testing string parameters</div><div class="line"><span class="meta">#</span></div><div class="line">echo Hello $1, glad to meet you.</div></pre></td></tr></table></figure>
<p>运行结果如下所示：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~/userdata$ bash test3.sh Zhang</div><div class="line">Hello Zhang, glad to meet you.</div></pre></td></tr></table></figure></p>
<p>在这个案例中，使用了字符串作为脚本的参数，但是，如果参数中含有空格，则会出现问题，如下所示：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~/userdata$ bash test3.sh Zhang San</div><div class="line">Hello Zhang, glad to meet you.</div></pre></td></tr></table></figure></p>
<p>脚本只识别了Zhang，没有识别出完整的Zhang San，因为shell脚本会把空格分隔开的字符串当成两个参数，如果要使含有空格的字符串当成一个，需要添加引号，如下所示；</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~/userdata$ bash test3.sh &apos;Zhang San&apos;</div><div class="line">Hello Zhang San, glad to meet you.</div></pre></td></tr></table></figure>
<h4 id="第4个案例：参数大于9个"><a href="#第4个案例：参数大于9个" class="headerlink" title="第4个案例：参数大于9个"></a>第4个案例：参数大于9个</h4><p>如果脚本需要的命令行参数大于9个，此时需要在变量数字周围加上花括号，例如<code>${``10``}</code>，如下所示：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span>!/bin/bash</div><div class="line"><span class="meta">#</span> handling lots of paramerters</div><div class="line"><span class="meta">#</span></div><div class="line">total=$[ $&#123;10&#125;*$&#123;11&#125; ]</div><div class="line">echo The tenth parameter is $&#123;10&#125;</div><div class="line">echo The eleventh parameter is $&#123;11&#125;</div><div class="line">echo The total is $total</div></pre></td></tr></table></figure>
<p>结果如下所示：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~/userdata$ bash test4.sh 1 2 3 4 5 6 7 8 9 10 11 12</div><div class="line">The tenth parameter is 10</div><div class="line">The eleventh parameter is 11</div><div class="line">The total is 110</div></pre></td></tr></table></figure></p>
<h4 id="第5个案例：读取脚本名"><a href="#第5个案例：读取脚本名" class="headerlink" title="第5个案例：读取脚本名"></a>第5个案例：读取脚本名</h4><h5 id="0参数的意义。"><a href="#0参数的意义。" class="headerlink" title="$0参数的意义。"></a><code>$0</code>参数的意义。</h5><p><code>$0</code>参数用于获取shell在命令行启动的脚本，如下所示：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span>!/bin/bash</div><div class="line"><span class="meta">#</span> Testing the $0 parameter</div><div class="line"><span class="meta">#</span></div><div class="line">echo The zero parameter is set to:$0</div></pre></td></tr></table></figure>
<p>需要注意的是，如果使用完整路径运行脚本，则<code>$0</code>就是完整脚本，如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~/userdata$ bash /home/biotest/userdata/test5.sh</div><div class="line">The zero parameter is set to:/home/biotest/userdata/test5.sh</div></pre></td></tr></table></figure>
<h5 id="basename命令可以补充-0参数的局限"><a href="#basename命令可以补充-0参数的局限" class="headerlink" title="basename命令可以补充$0参数的局限"></a><code>basename</code>命令可以补充<code>$0</code>参数的局限</h5><p>如果要写一个根据脚本名来执行不同功能的脚本，则就需要注意把脚本的运行路径给剥离掉，shell中有一个命令可以考虑，即<code>basename</code>命令，如下所示：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span>!/bin/bash</div><div class="line"><span class="meta">#</span> Using basename with the $0 parameter</div><div class="line"><span class="meta">#</span></div><div class="line">name=$(basename $0)</div><div class="line">echo</div><div class="line">echo The script name is: $name</div></pre></td></tr></table></figure>
<p>运行结果如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~/userdata$ bash test5b.sh</div><div class="line">The script name is: test5b.sh</div><div class="line">biotest@ubuntu:~/userdata$ bash /home/biotest/userdata/test5b.sh</div><div class="line">The script name is: test5b.sh</div></pre></td></tr></table></figure>
<p>从结果可以看出来，使用了<code>basename</code>命令后，即使运行脚本时输入全路径，<code>$0</code>也只是脚本的名称。</p>
<h5 id="相对路径与绝对路径的案例"><a href="#相对路径与绝对路径的案例" class="headerlink" title="相对路径与绝对路径的案例"></a>相对路径与绝对路径的案例</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span>!/bin/bash</div><div class="line"><span class="meta">#</span> Testing a Multi-function script</div><div class="line"><span class="meta">#</span></div><div class="line">name=$(basename $0)</div><div class="line"><span class="meta">#</span></div><div class="line">if [ $name = "addem" ]</div><div class="line">then</div><div class="line">    total=$[ $1 + $2 ]</div><div class="line"><span class="meta">#</span></div><div class="line">elif [ $name = "multem" ]</div><div class="line">then</div><div class="line">    total=$[ $1*$2 ]</div><div class="line">fi</div><div class="line"><span class="meta">#</span></div><div class="line">echo</div><div class="line">echo The calculated value is $total</div><div class="line"><span class="meta">#</span></div></pre></td></tr></table></figure>
<p>运行结果如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~/userdata$ cp test6.sh addem</div><div class="line">biotest@ubuntu:~/userdata$ chmod u+x addem</div><div class="line">biotest@ubuntu:~/userdata$ ln -s test6.sh multem</div><div class="line">biotest@ubuntu:~/userdata$ ls -l *em</div><div class="line">-rwxrw-r-- 1 biotest biotest 224 May  1 10:48 addem</div><div class="line">lrwxrwxrwx 1 biotest biotest   8 May  1 10:48 multem -&gt; test6.sh</div><div class="line">biotest@ubuntu:~/userdata$ bash addem 2 5</div><div class="line">The calculated value is 7</div><div class="line">biotest@ubuntu:~/userdata$ sudo bash ./multem 2 5</div><div class="line">The calculated value is 10</div></pre></td></tr></table></figure>
<p>结果解释：第一，<code>cp test6.sh addem</code>复制<code>test6.sh</code>脚本，新生成的文件命令为<code>addem</code>；第二，<code>chmod u+x addem</code>，将<code>addem</code>文件权限更改为可执行；第三，<code>ln -s test6.sh multem</code>，其中<code>ln</code>是为文件创建链接，<code>-s</code>表示软连接，可以理解为Linux的快捷方式；第四，当执行<code>addem 2 5</code>时，执行<code>total=$[ $1 + $2 ]</code>语句，如果是<code>bash ./multem 2 5</code>，则执行<code>total=$[ 41*$2 ]</code>语句。</p>
<h4 id="测试参数"><a href="#测试参数" class="headerlink" title="测试参数"></a>测试参数</h4><p>当脚本认为参数变量中会有数据，而实际上没有时，脚本就有可能会产生错误消息。通常要避免这种脚本的写法，在使用参数前一定要检查其中是否存在为数据，如下所示：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~/userdata$ cat test7.sh</div><div class="line"><span class="meta">#</span>!/bin/bash</div><div class="line"><span class="meta">#</span> testing parameters befoire user</div><div class="line"><span class="meta">#</span></div><div class="line"> if [ -n "$1" ]</div><div class="line">then</div><div class="line">    echo Hello $1, gload to meet you.</div><div class="line">else</div><div class="line">    echo "Sorry you did not identify yourself."</div><div class="line">fi</div></pre></td></tr></table></figure>
<p>运行结果如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~/userdata$ bash test7.sh Zhang</div><div class="line">Hello Zhang, gload to meet you.</div><div class="line">biotest@ubuntu:~/userdata$ bash test7.sh</div><div class="line">Sorry you did not identify yourself.</div></pre></td></tr></table></figure>
<p>代码解释：在<code>if</code>语句中使用了<code>if [ -n &quot;$1&quot; ]</code>语句，这里的<code>-n</code>是用于判断<code>$1</code>中是否有数据。</p>
<h2 id="特殊参数变量"><a href="#特殊参数变量" class="headerlink" title="特殊参数变量"></a>特殊参数变量</h2><p>在bash shell中有一些变量，它们会记录命令行参数。</p>
<h3 id="参数统计基本用法"><a href="#参数统计基本用法" class="headerlink" title="参数统计基本用法"></a>参数统计基本用法</h3><p>bash shell有一个特殊的变量，可以记录命令行中输入了多少个参数，其中这个特殊变量就是<code>$#</code>，哦可以肝脚本中任何地方使用这个特殊的变量，如下所示：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span>!/bin/bash</div><div class="line"><span class="meta">#</span> getting the number of parameters</div><div class="line"><span class="meta">#</span></div><div class="line">echo There were $# parameters supplied.</div></pre></td></tr></table></figure>
<p>运行结果如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~/userdata$ bash test8.sh</div><div class="line">There were 0 parameters supplied.</div><div class="line">biotest@ubuntu:~/userdata$ bash test8.sh 1 2 3 4 5 6 7</div><div class="line">There were 7 parameters supplied.</div><div class="line">biotest@ubuntu:~/userdata$ bash test8.sh &quot;Zhang San&quot;</div><div class="line">There were 1 parameters supplied.</div></pre></td></tr></table></figure>
<h3 id="参数统计案例"><a href="#参数统计案例" class="headerlink" title="参数统计案例"></a>参数统计案例</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span>/bin/bash</div><div class="line"><span class="meta">#</span> Testing parameters</div><div class="line"><span class="meta">#</span></div><div class="line">if [ $# -ne 2 ] # -ne测试命令行参数的数量，-ne是检查$#是否不等于2，ne相当于non-equal</div><div class="line">then</div><div class="line">    echo</div><div class="line">    echo Usage: test9..sh a b</div><div class="line">    echo</div><div class="line">else</div><div class="line">    total=$[ $1 + $2 ]</div><div class="line">    echo</div><div class="line">    echo The total is $total</div><div class="line">    echo</div></pre></td></tr></table></figure>
<p>结果运行如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~/userdata$ bash test9.sh </div><div class="line">Usage: test9..sh a b</div><div class="line">biotest@ubuntu:~/userdata$ bash test9.sh 10</div><div class="line">Usage: test9..sh a b</div><div class="line">biotest@ubuntu:~/userdata$ bash test9.sh 10 10 15</div><div class="line">Usage: test9..sh a b</div></pre></td></tr></table></figure>
<p>需要注意的是，如果认为<code>$#</code>变量含有参数的总数，而变量<code>$\{$#\}</code>代表了最后一个命令行参数变量，那就会出错，如下所示：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span>!/bin/bash</div><div class="line"><span class="meta">#</span> testing grabbing last parameter</div><div class="line"><span class="meta">#</span></div><div class="line">echo The last parameter was $&#123;$#&#125;</div></pre></td></tr></table></figure>
<p>运行结果如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~/userdata$ bash badtest1.sh 10</div><div class="line">The last parameter was 19343</div></pre></td></tr></table></figure>
<p>结果是19343，这说明，在花括号内不能使用美元符号，除非按照下面的方式进行修改，如下所示：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span>!/bin/bash</div><div class="line"><span class="meta">#</span> Grabbing the last parameter</div><div class="line"><span class="meta">#</span></div><div class="line">params=$#</div><div class="line">echo</div><div class="line">echo The last parameter is $params</div><div class="line">echo The last parameter is $&#123;!#&#125;</div><div class="line">echo</div></pre></td></tr></table></figure>
<p>运行结果如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~/userdata$ bash test10.sh 1 2 3 4 5 6</div><div class="line">The last parameter is 6</div><div class="line">The last parameter is 6</div><div class="line"></div><div class="line">biotest@ubuntu:~/userdata$ bash test10.sh</div><div class="line">The last parameter is 0</div><div class="line">The last parameter is test10.sh</div></pre></td></tr></table></figure>
<p>从结果来看，如果将<code>$#</code>变量的值赋给了变量<code>params</code>，然后也按特殊命令行参数变量的格式（即使用<code>$/{!#/}</code>）使用了该变量，结果就能正常显示。但是，当脚本没有参数时，<code>$#</code>的值为0，params变量的值也一样，但<code>$\{!#\}</code>变量的返回值则是脚本名本身。</p>
<h3 id="抓取所有的数据"><a href="#抓取所有的数据" class="headerlink" title="抓取所有的数据"></a>抓取所有的数据</h3><p>有时候需要抓取命令行上提供的所有参数，这时候不需要先用<code>$#</code>变量来判断命令行上有多少参数，然后再进行遍历，可以使用其他的特殊变量来解决这个问题，其中<code>$*</code>和<code>$@</code>变量可以访问所有的参数，这两个变量都能够在单个变量中存储所有的命令行参数。</p>
<p><code>$*</code>变量会将命令行上提供的所有参数当作一个单词保存，这个单词包含了命令行中出现的每一个参数，基本上<code>$*</code>变量会将这些参数视为一个整体，而不是单独的个体。而<code>$@</code>变量会将命令行上提供的所有参数当作同一字符串中多个独立的单词，这样可以遍历所有的参数值，得到每个参数，这通常使用for命令完成。如下所示：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span>!/bin/bash</div><div class="line"><span class="meta">#</span> testing $* and $@</div><div class="line"><span class="meta">#</span></div><div class="line">echo</div><div class="line">echo "Using the \$* method: $*"</div><div class="line">echo</div><div class="line">echo "Using the \$@ mehtods: $@"</div></pre></td></tr></table></figure>
<p>运行结果如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">biostudy@ubuntu18:~/script$ bash test11.sh Zhang Li Wang</div><div class="line">Using the $* method: Zhang Li Wang</div><div class="line">Using the $@ mehtods: Zhang Li Wang</div></pre></td></tr></table></figure>
<p>从结果来看，<code>$*</code>和<code>$@</code>在形式上并没有区别。但是下面的例子则能看出区别：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span>!/bin/bash</div><div class="line"><span class="meta">#</span> testing $* and $@</div><div class="line"><span class="meta">#</span></div><div class="line">echo</div><div class="line">count=1</div><div class="line"></div><div class="line">for param in "$*"</div><div class="line">do</div><div class="line">    echo "\$ Parameter # $count=$param"</div><div class="line">    count=$[ $count+1 ]</div><div class="line">done</div><div class="line"></div><div class="line">count=1</div><div class="line"></div><div class="line">for param in "$@"</div><div class="line">do</div><div class="line">    echo "\$@ Parameter # $count=$param"</div><div class="line">    ecount=$[ $count+1 ]</div><div class="line">done</div></pre></td></tr></table></figure>
<p>运行结果如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~/userdata$ bash test12.sh Zhang Li Wang</div><div class="line"></div><div class="line">$ Parameter # 1=Zhang Li Wang</div><div class="line">$@ Parameter # 1=Zhang</div><div class="line">$@ Parameter # 1=Li</div><div class="line">$@ Parameter # 1=Wang</div></pre></td></tr></table></figure>
<p>从结果可以看出来，使用for遍历这两个特殊的变量时，<code>$*</code>会将所有参数当成单个参数，而<code>$@</code>变量会单独处理所有的参数。</p>
<h2 id="移动变量"><a href="#移动变量" class="headerlink" title="移动变量"></a>移动变量</h2><p>bash shell中的<code>shift</code>命令可以操作命令行参数，<code>shift</code>可以根据它们的相对位置来移动命令行参数。当使用该命令时，它会将每个参数变量向左移动一个位置。因此，变量<code>$3</code>的值会移到<code>$2</code>，变量<code>$2</code>的值会移到<code>$1</code>，而变量<code>$1</code>的值则会被删除（因为<code>$0</code>的值是程序名，不会改变）。这是遍历命令行参数的一个方法，当用户不矢科有多少个参数时，可以只操作第1个参数，移动参数，然后继续操作下一个参数。看一个案例：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span>!/bin/bash</div><div class="line"><span class="meta">#</span> demonstrating the shift command</div><div class="line"></div><div class="line">echo</div><div class="line">count=1</div><div class="line">while [ -n "$1" ]</div><div class="line">do</div><div class="line">    echo "Parameter #$count=$1"</div><div class="line">    count=$[ $count+1 ]</div><div class="line">    shift</div><div class="line">done</div></pre></td></tr></table></figure>
<p>运行结果如所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">[000.DESKTOP-FS88S5S] &gt; bash test13.sh Zhang Li Wang Tian</div><div class="line"></div><div class="line">Parameter #1=Zhang</div><div class="line">Parameter #2=Li</div><div class="line">Parameter #3=Wang</div><div class="line">Parameter #4=Tian</div></pre></td></tr></table></figure>
<p>代码及结果解释： -n 测试来检查命令行参数<code>$1</code>中是否有数据。如果不是0，就执行，一直执行到<code>$1</code>参数为0为止。也可以为shift提供一个参数，指明要移动的位置数即可，如下所示：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span>!/bin/bash</div><div class="line"><span class="meta">#</span> demonstrating a multi-positon shift</div><div class="line"><span class="meta">#</span></div><div class="line">echo "The original parameters: $*"</div><div class="line">shift 2</div><div class="line">echo "Here's the new first parameter: $1"</div></pre></td></tr></table></figure>
<p>运行结果如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">[000.DESKTOP-FS88S5S] &gt; bash test14.sh 1 2 3 4 5</div><div class="line">The original parameters: 1 2 3 4 5</div><div class="line">Here&apos;s the new first parameter: 3</div></pre></td></tr></table></figure>
<p>从上述案例可知，通过使用shfit的参数可以跳过不想要的参数。</p>
<h2 id="处理选项"><a href="#处理选项" class="headerlink" title="处理选项"></a>处理选项</h2><p>选项指的是这样的一种情况，在命令后面的短横线的单个字母 ，例如 <code>ls -a</code>，其中<code>-a</code>就是选项。</p>
<h3 id="查找选项"><a href="#查找选项" class="headerlink" title="查找选项"></a>查找选项</h3><p>在提取每个单独参数时用<code>case</code>语句来判断某个参数是否为选项。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span>!/bin/bash</div><div class="line"><span class="meta">#</span> extracting command line options as parameters</div><div class="line"><span class="meta">#</span></div><div class="line">echo</div><div class="line">while [ -n "$1" ]</div><div class="line">do</div><div class="line">    case "$1" in </div><div class="line">        -a) echo "Found the -a option";;</div><div class="line">        -b) echo "Found the -b option";;</div><div class="line">        -c) echo "Found the -c option";;</div><div class="line">         *) echo "$1 is not an option";;</div><div class="line">    esac</div><div class="line">    shift</div><div class="line">done</div></pre></td></tr></table></figure>
<p>运行结果如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~/userdata$ bash test15.sh -a -b -c -d</div><div class="line">Found the -a option</div><div class="line">Found the -b option</div><div class="line">Found the -c option</div><div class="line">-d is not an option</div></pre></td></tr></table></figure>
<p>case语句会检查每个参数是不是有效选项。如果是的话，就运行对应case语句中的命令，无论选项按什么顺序出现在命令行上，这种方法都适用，如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~/userdata$ bash test15.sh -d -c -a</div><div class="line">-d is not an option</div><div class="line">Found the -c option</div><div class="line">Found the -a option</div></pre></td></tr></table></figure>
<p>case语句在命令行参数中找到一个选项，就处理一个选项，如果命令行上的还提供了其他参数，就可以在case语句的通用情况处理部分中处理。</p>
<h3 id="分离参数和选项"><a href="#分离参数和选项" class="headerlink" title="分离参数和选项"></a>分离参数和选项</h3><p>在shell脚本中同时使用选项有参数时，Linux处理这种问题的标准方式是用特殊字符，也就是双破折号（<code>--</code>）将二者分开，该字符会告诉脚本何时选项结束以及普通参数何时开始。在双破折线之后，脚本可以将剩下的命令行参数当作参数，而不是选项，如下所示：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span>!/bin/bash</div><div class="line"><span class="meta">#</span> extracting options and parameters</div><div class="line">echo</div><div class="line">while [ -n "$1" ]</div><div class="line">do</div><div class="line">    case "$1" in</div><div class="line">        -a) echo "Found the -a option";;</div><div class="line">        -b) echo "Found the -b option";;</div><div class="line">        -c) echo "Found the -c option";;</div><div class="line">        --) shift</div><div class="line">            break;;</div><div class="line">         *) echo "$1 is not an option";;</div><div class="line">    esac</div><div class="line">    shift</div><div class="line">done</div><div class="line"></div><div class="line">count=1</div><div class="line">for param in $@</div><div class="line">do</div><div class="line">   echo "Parameter #$count: $param"</div><div class="line">   count=$[ $count+1 ]</div><div class="line">done</div></pre></td></tr></table></figure>
<p>运行结果如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~/userdata$ bash test16.sh -c -a -b test1 test2 test3</div><div class="line">Found the -c option</div><div class="line">Found the -a option</div><div class="line">Found the -b option</div><div class="line">test1 is not an option</div><div class="line">test2 is not an option</div><div class="line">test3 is not an option</div></pre></td></tr></table></figure>
<p>当脚本遇到双破折号时，它会停止处理选项，并将剩下的参数都当作命令行参数。</p>
<h3 id="处理带值的选项"><a href="#处理带值的选项" class="headerlink" title="处理带值的选项"></a>处理带值的选项</h3><p>有些选项会带上额外的参数值，例如像这样的<code>bash testing.sh -a test1 -b -c -d test2</code>，如果例行选项中带有额外的参数，脚本必须要能检测到，并且进行处理，如下所示：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span>!/bin/bash</div><div class="line"><span class="meta">#</span> extracting command line options and values</div><div class="line">echo</div><div class="line">while [ -n "$1" ]</div><div class="line">do</div><div class="line">    case "$1" in </div><div class="line">        -a) echo "Found the -a option";;</div><div class="line">        -b) param="$2"</div><div class="line">            echo "Found the -b option, with parameter value $param"</div><div class="line">           shift;;</div><div class="line">        -c) echo "Found the -c option";;</div><div class="line">        --) shift</div><div class="line">            break;;</div><div class="line">         *) echo "$1 is not an option";;</div><div class="line">     esac</div><div class="line">     shift</div><div class="line">done</div></pre></td></tr></table></figure>
<p>运行结果如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~/userdata$ bash test17.sh -a -b test1 -d</div><div class="line"></div><div class="line">Found the -a option</div><div class="line">Found the -b option, with parameter value test1</div><div class="line">-d is not an option</div></pre></td></tr></table></figure>
<p>代码及结果解释：在这案例中，<code>case</code>语句定义了3个安要处理的选项，其中<code>-b</code>选项还需要一个额外的参数值，由于要处理的参数是<code>$1</code>，额外的参数值就应该位于<code>$2</code>位置上（因为所有的参数在处理完后就会被移出），只要将参数值从<code>$2</code>变量中提取出来就行，因为这个选项占了2个参数位，因此还需要<code>shift</code>命令多移动一个位置。只用这些基本的特性，整个过程就能正常工作，不管按什么顺序放置选项（但要记住包含每个选项相应的选项参数）。如下所示：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~/userdata$ bash test17.sh -b test1 -a -d</div><div class="line">Found the -b option, with parameter value test1</div><div class="line">Found the -a option</div><div class="line">-d is not an option</div></pre></td></tr></table></figure>
<p>此时，shell脚本就有了处理例行选项的基本能力，但还一些限制，例如，想要多个选项放一个参数时，就像<code>ls -lh</code>这个命令这样，脚本就无法正常工作，如下所示：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~/userdata$ bash test17.sh -ac</div><div class="line">-ac is not an option</div></pre></td></tr></table></figure>
<p>此时需要<code>getopt</code>命令。</p>
<h3 id="使用getopt命令"><a href="#使用getopt命令" class="headerlink" title="使用getopt命令"></a>使用getopt命令</h3><h4 id="getopt命令基本用法"><a href="#getopt命令基本用法" class="headerlink" title="getopt命令基本用法"></a>getopt命令基本用法</h4><p><code>getopt</code>命令是一个在处理命令行选项和参数时非常方便的工具，它能够识别命令行参数，从而在脚本中解析它们时更方便。<code>getopt</code>命令可以接受一系列任意形式的命令行选项和参数，并自动将它们转换为适当的格式，它的使用方法为<code>getopt optstring parameters</code>，其中，<code>optstring</code>定义了命令行有效的选项字符，不这它义了哪些选项字母需要参数值。首先在<code>optstring</code>中列出要在脚本中用到的每个命令行选项字母，然后在每个需要参数值的选项字母后面加一个冒号，<code>getopt</code>命令会基于定义的<code>optstring</code>解析提供的参数。如下所示：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~/userdata$ getopt ab:cd -a -b test1 -cd test2 test3</div><div class="line"> -a -b test1 -c -d -- test2 test3</div></pre></td></tr></table></figure>
<p>optstring定义了4个有效选项字母，a、b、c和d。冒号（<code>：</code>）被放到了字母b的后面，因为b选项需要一个参数值，当<code>getopt</code>命令运行时，它会检查提供的参数列表（-a -b test1 -cd test2 test3），并基于提供的<code>optstring</code>进行解析。此时，它会自动将<code>-cd</code>选项分成两个单独的选项，并插入双破折线来分隔行中的额外参数，如果指定了一个不在<code>optstring</code>中的选项，默认情况下，<code>getopt</code>会产生一条错误消息，如下所示：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~/userdata$ getopt ab:cd -a -b test1 -cde test2 test3</div><div class="line">getopt: invalid option -- 'e'</div><div class="line"> -a -b test1 -c -d -- test2 test3</div></pre></td></tr></table></figure>
<p>如果需要忽略这条错误消息，可以在命令后加<code>-q</code>选项，如下所示：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~/userdata$ getopt -q ab:cd -a -b test1 -cde test2 test3</div><div class="line"> -a -b 'test1' -c -d -- 'test2' 'test3'</div></pre></td></tr></table></figure>
<p>注意：getopt命令选项必须出现在optstring之间。</p>
<h4 id="在脚本中使用getopt"><a href="#在脚本中使用getopt" class="headerlink" title="在脚本中使用getopt"></a>在脚本中使用getopt</h4><p>在脚本中使用<code>getopt</code>来格式化脚本所携带的任何选项或参数时，方法就是使用<code>getopt</code>命令生成的格式化后的版本替换已有的命令行选项的参数。这其中要用到<code>set</code>命令。<code>set</code>命令的选项之一就是双破折线（<code>--</code>），它会将命令行参数值的成set命令的命令行值。该方法会将原始脚本的命令行参数传给<code>getopt</code>命令，之后再将<code>getopt</code>命令的输出传给<code>set</code>命令，用<code>getopt</code>格式化后的命令行参数来替换原始的命令行参数，看起来就像这样的<code>set --$(getopt -q ab:cd &quot;$@&quot;)</code>,此时，原始命令行参数变量的值会被<code>getopt</code>命令的输出替换，而<code>getopt</code>已经格式化好了命令行参数。看一个案例：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span>!/bin/bash</div><div class="line"><span class="meta">#</span> Extract command line options and values with getop</div><div class="line"><span class="meta">#</span> </div><div class="line">set --$(getopt -q ab:cd "$@")</div><div class="line"><span class="meta">#</span></div><div class="line">echo </div><div class="line">while [ -n "$1" ]</div><div class="line">do</div><div class="line">    case "$1" in</div><div class="line">    -a) echo "Found the -a option";;</div><div class="line">    -b) param="$2"</div><div class="line">        echo "Found the -b option, with paraeter value $param"</div><div class="line">        shift;;</div><div class="line">    -c) echo "Found the -c option";;</div><div class="line">    --) shift</div><div class="line">        break;;</div><div class="line">     *) echo "$1 is not an option";;</div><div class="line">     esac</div><div class="line">  shift</div><div class="line">done</div><div class="line"></div><div class="line">count=1</div><div class="line">for param in "$@"</div><div class="line">do</div><div class="line">    echo "Parameter $count: $param"</div><div class="line">    count=$[ $count+1 ]</div><div class="line">done</div></pre></td></tr></table></figure>
<p>运行结果如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~/userdata$ bash test18.sh -ac</div><div class="line">Found the -a option</div><div class="line">Found the -c option</div><div class="line">biotest@ubuntu:~/userdata$ bash test18.sh -a -b test1 -cd test2 test3 test4</div><div class="line"></div><div class="line">Found the -a option</div><div class="line">Found the -b option, with paraeter value &apos;test1&apos;</div><div class="line">Found the -c option</div><div class="line">-d is not an option</div><div class="line">Parameter 1: &apos;test2&apos;</div><div class="line">Parameter 2: &apos;test3&apos;</div><div class="line">Parameter 3: &apos;test4&apos;</div><div class="line"></div><div class="line">biotest@ubuntu:~/userdata$ bash test18.sh -a -b test1 -cd &quot;test2 test3&quot; test4</div><div class="line">Found the -a option</div><div class="line">Found the -b option, with paraeter value &apos;test1&apos;</div><div class="line">Found the -c option</div><div class="line">-d is not an option</div><div class="line">Parameter 1: &apos;test2</div><div class="line">Parameter 2: test3&apos;</div><div class="line">Parameter 3: &apos;test4</div></pre></td></tr></table></figure>
<p>从运行结果来看，第一个与第二个没有问题，第三个出现了问题，在第三个运行过程中，参数选项其中人有<code>&quot;test2 test3&quot;</code>，用了双引号，由于<code>getopt</code>命令不擅长处理带空格和引号的参数值，它会将空格当作参数分隔符，而不是根据双引号将二者当作一个参数。此时就需要另外一个命令，即<code>getopts</code>，这个命令是在<code>getopt</code>后面加了一个<code>s</code>。</p>
<h3 id="使用getopts命令（注意后面加了s）"><a href="#使用getopts命令（注意后面加了s）" class="headerlink" title="使用getopts命令（注意后面加了s）"></a>使用getopts命令（注意后面加了s）</h3><p><code>getopts</code>命令能够与已有的shell参数变量进行配合。每调用它时，它一次只处理命令行上检测到的一个参数，处理完所有的参数后，它会退回一个大于0的退出状态码，因此这个命令很适合解析命令行所有参数的循环。它的用法为<code>getopts optstring variable</code>。<code>optstring</code>中储存的是有效的选项字母，如果选项字母要求有个参数值，就要加一个冒号，要去年错误消息的话，可以在<code>optstring</code>之前加一个冒号，<code>getopts</code>命令将当前参数保存在命令行中定义的<code>variable</code>中。<code>getopts</code>命令会用到两个环境变量，如果选项需要跟一个参数值，<code>OPTARG</code>环境变量会保存这个值，<code>OPTIND</code>环境变量保存了参数列表中<code>getopts</code>正在处理的参数位置。这样能够在处理完选项之后继续处理其他命令行参数。看一个案例：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span>!/bin/bash</div><div class="line"><span class="meta">#</span> simple demonstration of the getopts command</div><div class="line"><span class="meta">#</span></div><div class="line">echo</div><div class="line">while getopts :ab:c opt</div><div class="line">do</div><div class="line">    case "$opt" in </div><div class="line">        a) echo "Found the -a option";;</div><div class="line">        b) echo "Found the -b option, with value $OPTARG";;</div><div class="line">        c) echo "Found the -c option";;</div><div class="line">        *) echoi "Unknown options:$opt";;</div><div class="line">    esac</div><div class="line">done</div></pre></td></tr></table></figure>
<p>运行结果如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~/userdata$ bash test19.sh -ab test1 -c</div><div class="line">Found the -a option</div><div class="line">Found the -b option, with value test1</div><div class="line">Found the -c option</div></pre></td></tr></table></figure>
<p>while语句定义了<code>getopts</code>命令，指明了要查找哪些命令选项，以及每次迭代中储存它们的变量名（<code>opt</code>）。此时<code>case</code>语句的用法有些不同，getopts命令解析命令行选项时会移除开头的单破拆线，所以在case定义中不用单破折线。getopts命令的参数值中可以包含空格，如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Found the -b option, with value test1 test2</div><div class="line">Found the -a option</div></pre></td></tr></table></figure>
<p>还可以将选项字母和参数值放在一起使用，而不用加空格，如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~/userdata$ bash test19.sh -abtest1</div><div class="line"></div><div class="line">Found the -a option</div><div class="line">Found the -b option, with value test1</div></pre></td></tr></table></figure>
<p><code>getopts</code>命令能够从<code>-b</code>选项中正确解析出<code>test1</code>值。除此之外，<code>getopts</code>还能够将命令行上找到的所有未定义的选项统一输出成问号，如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~/userdata$ bash test19.sh -d</div><div class="line"></div><div class="line">Unknown options:?</div><div class="line">biotest@ubuntu:~/userdata$ bash test19.sh -acde</div><div class="line"></div><div class="line">Found the -a option</div><div class="line">Found the -c option</div><div class="line">Unknown options:?</div><div class="line">Unknown options:?</div></pre></td></tr></table></figure>
<p><code>optstring</code>中未定义的选项字母会以问号形式发给代码。<code>getopts</code>命令知道何时停止处理选项，并将参数留给用户处理，在使用<code>getopts</code>处理每个选项时，它会将<code>OPTIND</code>环境变量值增一。在<code>getopts</code>完成处理时，用户可以使用<code>shift</code>命令和<code>OPTIND</code>值来移动参数，如下所示：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span>!/bin/bash</div><div class="line"><span class="meta">#</span> Processing options and parameters with getopts</div><div class="line"></div><div class="line">echo </div><div class="line">while getopts :ab:cd opt</div><div class="line">do</div><div class="line">    case "$opt" in </div><div class="line">    a) echo "Found the -a option";;</div><div class="line">    b) echo "Found the -b option, with value $OPTARG";;</div><div class="line">    c) echo "Found the -c option";;</div><div class="line">    c) echo "Found the 0d option";;</div><div class="line">    *) echo "Unknown option: $opt";;</div><div class="line">    esac</div><div class="line">done</div><div class="line"></div><div class="line">shift $[ $OPTIND - 1 ]</div><div class="line"></div><div class="line">echo</div><div class="line">count=1</div><div class="line">for param in "$@"</div><div class="line">do</div><div class="line">   echo "Parameter $count: $param"</div><div class="line">   coiunt=$[ $count+1 ]</div><div class="line">done</div></pre></td></tr></table></figure>
<p>运行结果如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~/userdata$ bash test20.sh -a -b test1 -d test2 test3 test4</div><div class="line"></div><div class="line">Found the -a option</div><div class="line">Found the -b option, with value test1</div><div class="line">Unknown option: d</div><div class="line"></div><div class="line">Parameter 1: test2</div><div class="line">Parameter 1: test3</div><div class="line">Parameter 1: test4</div></pre></td></tr></table></figure>
<h2 id="选项标准化"><a href="#选项标准化" class="headerlink" title="选项标准化"></a>选项标准化</h2><p>在Linux系统中，一些字母选项已经拥有了某种程度的标准含义，因此在写bash shell脚本时，用户自己脚本中如果要使用一些选项参数的话，最好与Linux系统中的保持一致，一些常用的linux命令选项如下所示：</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>选项</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>-a</td>
<td>显示所有对象</td>
</tr>
<tr>
<td>-c</td>
<td>生成一个计数</td>
</tr>
<tr>
<td>-d</td>
<td>指定一个目录</td>
</tr>
<tr>
<td>-e</td>
<td>扩展一个对象</td>
</tr>
<tr>
<td>-f</td>
<td>指定读入数据的文件</td>
</tr>
<tr>
<td>-h</td>
<td>显示命令的帮助信息</td>
</tr>
<tr>
<td>-i</td>
<td>忽略文本大小写</td>
</tr>
<tr>
<td>-l</td>
<td>产生输出的长格式版本</td>
</tr>
<tr>
<td>-n</td>
<td>使用非交互模式（批处理）</td>
</tr>
<tr>
<td>-o</td>
<td>将所有输出重定向到的</td>
</tr>
<tr>
<td>-q</td>
<td>以安静模式运行</td>
</tr>
<tr>
<td>-r</td>
<td>递归地处理目录和文件</td>
</tr>
<tr>
<td>-s</td>
<td>以安静模式运行</td>
</tr>
<tr>
<td>-v</td>
<td>生成详细输出</td>
</tr>
<tr>
<td>-x</td>
<td>排除某个对象</td>
</tr>
<tr>
<td>-y</td>
<td>对所有问题回答yes</td>
</tr>
</tbody>
</table>
</div>
<h3 id="获得用户输入"><a href="#获得用户输入" class="headerlink" title="获得用户输入"></a>获得用户输入</h3><p>虽然命令行选项和参数可以从脚本用户处获得输入，但还有一种情况下，需要读取用户的一些信息，例如在运行某个脚本时，需要用户输入自己的用户名。bash shell为此提供了<code>read</code>命令。</p>
<h3 id="read的基本用法"><a href="#read的基本用法" class="headerlink" title="read的基本用法"></a><code>read</code>的基本用法</h3><p><code>read</code>命令从标准输入（键盘）或另一个文件描述符中接受输入，在收入输入后，<code>read</code>命令会将数据放进一个变量，下面是<code>read</code>命令的一个案例。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span>!/bin/bash</div><div class="line"><span class="meta">#</span> testing the read command</div><div class="line"><span class="meta">#</span></div><div class="line">echo -n "Enter your name: "</div><div class="line">read name</div><div class="line">echo "Hello, $name, welcome to my program."</div><div class="line"><span class="meta">#</span></div></pre></td></tr></table></figure>
<p>运行后结果如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~/userdata$ bash test21.sh</div><div class="line">Enter your name: Zhang San</div><div class="line">Hello, Zhang San, welcome to my program.</div></pre></td></tr></table></figure>
<p>代码及结果解释：生成提示的echo使用了<code>-n</code>选项，该选项不会在字符串末尾输出换行符，允许脚本用户紧跟其后输入数据，而不是下一行。<code>read</code>命令还包含了<code>-p</code>选项，可以直接在<code>read</code>命令行指定指示符，如下所示：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span>!/bin/bash</div><div class="line"><span class="meta">#</span> testing the read -p option</div><div class="line"><span class="meta">#</span></div><div class="line">read -p "Please enter your age: " age</div><div class="line">days=$[ $age*365 ]</div><div class="line">echo "That makes your over $days days old!"</div><div class="line"><span class="meta">#</span></div></pre></td></tr></table></figure>
<p>运行结果如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~/userdata$ bash test22.sh</div><div class="line">Please enter your age: 20</div><div class="line">That makes your over 7300 days old!</div></pre></td></tr></table></figure>
<p>代码及结果解释，在第一个例子中当有名字输入时，<code>read</code>命令会将姓和名保存在同一个变量中，<code>read</code>命令会将提示符后输入的所有数据分配给单个变量，要么用户指定多个变量。输入的每个数据值都会分配给变量列表中的下一个变量，如果变量数量不够，剩下的数据就全部分配给最后一个变量，如下所示：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span>!/bin/bash</div><div class="line"></div><div class="line"><span class="meta">#</span> entering multiple varibales</div><div class="line">read -p "Enter your name:    " first last</div><div class="line">echo "Checking data for $last, $first..."</div></pre></td></tr></table></figure>
<p>结果运行如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~/userdata$ bash test23.sh</div><div class="line">Enter your name:    Zhang San</div><div class="line">Checking data for San, Zhang...</div></pre></td></tr></table></figure>
<p>如果<code>read</code>命令行中不指定变量，<code>read</code>命令会将它收到的任何数据都放到特殊环境变量<code>REPLY</code>中。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span>!/bin/bash</div><div class="line"><span class="meta">#</span> Testing the REPLY Environemnt variable</div><div class="line"><span class="meta">#</span></div><div class="line">read -p "Enter uyuour name: "</div><div class="line">echo</div><div class="line">echo Hello $REPLY, welcome to my program.</div><div class="line"><span class="meta">#</span></div></pre></td></tr></table></figure>
<p>运行结果如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~/userdata$ bash test24.sh</div><div class="line">Enter uyuour name: Zhang</div><div class="line"></div><div class="line">Hello Zhang, welcome to my program.</div></pre></td></tr></table></figure>
<p><code>REPLY</code>环境变量会保存输入的所有数据，可以在shell脚本中像其他变量一样使用。</p>
<h3 id="超时"><a href="#超时" class="headerlink" title="超时"></a>超时</h3><p>在使用<code>read</code>命令时需要注意，脚本很有可能会一直等着用户的输入，如果不管是否有数据输入，脚本都必须继续执行，可以使用<code>-t</code>选项来指定个计时器，<code>-t</code>选项指定了<code>read</code>命令等待输入的秒数，当计时器过期后，<code>read</code>命令会返回一个非零退出状态码。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span>!/bin/bash</div><div class="line"><span class="meta">#</span> timing the data entry</div><div class="line"><span class="meta">#</span> </div><div class="line">if read -t 5 -p "Please enter your name:  " name</div><div class="line">then</div><div class="line">    echo "Hello $name, welcome to my script"</div><div class="line">else</div><div class="line">    echo</div><div class="line">    echo "Sorry, too slow!"</div><div class="line">fi</div></pre></td></tr></table></figure>
<p>运行结果如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~/userdata$ bash test25.sh</div><div class="line">Please enter your name:  Zhang</div><div class="line">Hello Zhang, welcome to my script</div><div class="line">biotest@ubuntu:~/userdata$ bash test25.sh</div><div class="line">Please enter your name:  </div><div class="line">Sorry, too slow!</div></pre></td></tr></table></figure>
<p>代码及结果解释：如果计时器过期，<code>read</code>命令会以非零退出状态码退出，可以使用如<code>if-then</code>语句或<code>while</code>循环这种标准的结构化语句所发生的具体情况，在这个例子中，<code>if</code>语句不成立，shell会执行else部分的命令。也可以不进行诸，让<code>read</code>命令来统计输入的字符数，当输入的字符数达到预设的字符数时，就自动退出，将输入的数据赋给变量，如下所示：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span>!/bin/bash</div><div class="line"><span class="meta">#</span> getting just one character of input</div><div class="line"><span class="meta">#</span></div><div class="line">read -n1 -p "Do you want to continue [Y/N]? " answer</div><div class="line">case $answer in </div><div class="line">Y|y) echo</div><div class="line">     echo "fine, continue on...";;</div><div class="line">N|n) echo</div><div class="line">     echo OK, goodbye</div><div class="line">     exit;;</div><div class="line">esac</div><div class="line">echo "This is the end of the script"</div></pre></td></tr></table></figure>
<p>运行结果如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~/userdata$ bash test26.sh</div><div class="line">Do you want to continue [Y/N]? Y</div><div class="line">fine, continue on...</div><div class="line">This is the end of the script</div><div class="line">biotest@ubuntu:~/userdata$ bash test26.sh</div><div class="line">Do you want to continue [Y/N]? n</div><div class="line">OK, goodbye</div></pre></td></tr></table></figure>
<p>在这个案例中，将<code>-n选项</code>和值<code>1</code>一起使用，告诉<code>read</code>命令在接受单个字符后退出，只要按下单个字符回答后，<code>read</code>命令就会接受输入并将它传给变量，无需按回车键。</p>
<h3 id="隐藏方式读取"><a href="#隐藏方式读取" class="headerlink" title="隐藏方式读取"></a>隐藏方式读取</h3><p>有时候需要从脚本用户处得到输入，在屏幕上显示输入信息。但有种例外，就是输入密码，需要隐藏输入的信息。在<code>read</code>命令使用时，使用<code>-s</code>选项可以避免在<code>read</code>命令中输入的数据出现在显示器上（其实数据是会显示的，只是<code>read</code>命令将文本的颜色设成了跟背景色一样），下面是一个案例。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span>!/bin/bash</div><div class="line"><span class="meta">#</span> hiding input data from the monitor</div><div class="line"><span class="meta">#</span></div><div class="line">read -s -p "Enter your passwd:  " pass</div><div class="line">echo</div><div class="line">echo "Is your password really $pass?"</div></pre></td></tr></table></figure>
<p>运行结果如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~/userdata$ bash test27.sh</div><div class="line">Enter your passwd:  </div><div class="line">Is your password really dsfdf?</div></pre></td></tr></table></figure>
<p>输入提示符输入的数据不会出现在屏幕上，但会赋值给变量，以便在脚本中使用。</p>
<h3 id="从文件中读取数据"><a href="#从文件中读取数据" class="headerlink" title="从文件中读取数据"></a>从文件中读取数据</h3><p><code>read</code>可以用于读取文件中的数据，每次调用<code>read</code>命令时，它就会从文件中读取一行文本。当文件中再没有内容时，<code>read</code>命令就会退出，并返回非零退出状态码。通常使用<code>cat</code>命令将数据中的文件传给含有<code>read</code>命令的<code>while</code>命令，看一个案例。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span>!/bin/bash</div><div class="line"><span class="meta">#</span> reading data from a file</div><div class="line"></div><div class="line">count=1</div><div class="line">cat test|while read line</div><div class="line">do</div><div class="line">    echo "Line $count: $line"</div><div class="line">    count=$[ $count+1 ]</div><div class="line">done</div><div class="line">echo "Finished processing the file"</div></pre></td></tr></table></figure>
<p>运行结果如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~/userdata$ cat test</div><div class="line">The quick brown dog jumps over the lazy fox.</div><div class="line">This is a test, this is only a test.</div><div class="line">O Romeo, Romeo! Wherefore art thou Romeo?</div></pre></td></tr></table></figure>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2018/05/01/Linux/Linux-shell03-for、while和until语句/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/05/01/Linux/Linux-shell03-for、while和until语句/" itemprop="url">Shell学习笔记（3）——for、while和until语句</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-05-01T12:10:54+08:00">
                2018-05-01
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Linux/" itemprop="url" rel="index">
                    <span itemprop="name">Linux</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  7,875
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  34
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>本篇笔记的参考资料是（<a href="https://item.jd.com/12010266.html" target="_blank" rel="external">《Linux命令行与shell脚本编程大全》</a>（第3版），外加百度辅助，本篇笔记的主要内容是循环语句，即for、while和until语句。</p>
<h2 id="for命令"><a href="#for命令" class="headerlink" title="for命令"></a>for命令</h2><p>如果遇到这样的场景：重复一组命令直到某个特定条件，例如处理某个目录下的所有文件、系统上所有用户或是某个文本文件中的所有行。此时就会用到<code>for</code>命令，for命令可以创建一个遍历一系列值的的循环，每次迭代就会使用其中一个值来执行已定义好的一组命令，for命令的格式如下所示：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">for var in list</div><div class="line">do </div><div class="line">    commands</div><div class="line">done</div></pre></td></tr></table></figure>
<p>格式解释：</p>
<p>第一，在list参数中，用户需要提供推荐中要用到的一系列值；</p>
<p>第二，在每次迭代时，变量var会包含列表中的当前值，第一次迭代使用列表中的第1个值，第2次使用第2个值，以此类推；</p>
<p>第三，在<code>do</code>和<code>done</code>语句之间输入的命令可以是一条或多条标准的bash sehll命令，在这些命令中，<code>$var</code>变量包含着这次迭代对应的当前列表项的中值。</p>
<h3 id="第1案例：读取列表中的值"><a href="#第1案例：读取列表中的值" class="headerlink" title="第1案例：读取列表中的值"></a>第1案例：读取列表中的值</h3><p>for命令最基本的用法就是遍历for命令自身所定义的一系列值，如下所示：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span>!/bin/bash</div><div class="line"><span class="meta">#</span> basic for command</div><div class="line">for test in Apple Pear Banana Orange Onion</div><div class="line">do</div><div class="line">    echo The next fruit is $test</div><div class="line">done</div></pre></td></tr></table></figure>
<p>运行结果如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">The next fruit is Apple</div><div class="line">The next fruit is Pear</div><div class="line">The next fruit is Banana</div><div class="line">The next fruit is Orange</div><div class="line">The next fruit is Onion</div></pre></td></tr></table></figure>
<p>每次for命令遍历值列表，它都会将列表中的下个值赋给<code>$test</code>变量，<code>$test</code>变量可以像for命令语句中的其他脚本变量一样使用，在最后一次迭代后，<code>$test</code>变量的值会在shell脚本的剩余部分一直保持有效，它会一直保持最后一次迭代的值，除非再次为变量赋值，看下面的案例：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span>!/bin/bash</div><div class="line"><span class="meta">#</span> testing the for variable after the looping</div><div class="line"></div><div class="line">for test in Apple Pear Banana Orange Onion</div><div class="line">do</div><div class="line">    echo The next fruit is $test</div><div class="line">done</div><div class="line"></div><div class="line">echo "The last fruit we visited was $test"</div><div class="line">test=Watermelon</div><div class="line">echo "Wait, now we're visiting $test"</div></pre></td></tr></table></figure>
<p>运行结果如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~/loop$ bash test1b.sh</div><div class="line">The next fruit is Apple</div><div class="line">The next fruit is Pear</div><div class="line">The next fruit is Banana</div><div class="line">The next fruit is Orange</div><div class="line">The next fruit is Onion</div><div class="line">The last fruit we visited was Onion</div><div class="line">Wait, now we&apos;re visiting Watermelon</div></pre></td></tr></table></figure>
<h3 id="转义字符的使用"><a href="#转义字符的使用" class="headerlink" title="转义字符的使用"></a>转义字符的使用</h3><p>for中有可能会遇到比较复杂的值，如下所示：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span>!/bin/bash</div><div class="line"><span class="meta">#</span> another example of how not to use the for command</div><div class="line"></div><div class="line">for test in I don't know if this'll work</div><div class="line">do</div><div class="line">    echo "word:$test"</div><div class="line">done</div></pre></td></tr></table></figure>
<p>结果运行如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~/loop$ bash test1c.sh</div><div class="line">word:I</div><div class="line">word:dont know if thisll</div><div class="line">word:work</div></pre></td></tr></table></figure>
<p>从结果中可以看出，如果for的列表中存在单引号，则在迭代中会出错误，它会把单引号去掉，并把单引号中间的字符串当作是一个值，如果要解决这个问题，可以使用两种方法：第一，使用转义字符来将单引号转义；第二，使用双引号来定义用到的单引号的值。</p>
<p>现在用这两种方法来解决这个问题，第一个引用用第一种方法，第二个引号用第二种方法，如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">#!/bin/bash</div><div class="line"># another example of how not to use the for command</div><div class="line"></div><div class="line">for test in I don\&apos;t know if this\&apos;ll work</div><div class="line">do</div><div class="line">    echo &quot;word:$test&quot;</div><div class="line">done</div></pre></td></tr></table></figure>
<p>运行结果如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~/loop$ bash test1c1.sh</div><div class="line">word:I</div><div class="line">word:don&apos;t</div><div class="line">word:know</div><div class="line">word:if</div><div class="line">word:this&apos;ll</div><div class="line">word:work</div></pre></td></tr></table></figure>
<p>从结果可以看出两个单引号都能正常工作了。</p>
<h3 id="多个词的分割"><a href="#多个词的分割" class="headerlink" title="多个词的分割"></a>多个词的分割</h3><p>在for循环中，每个值都是用空格进行分割的，如果某个值包含空格，就会比较麻烦，如下面的案例所示：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span>!/bin/bash</div><div class="line"><span class="meta">#</span> another example of how not to user the for command</div><div class="line">for test in Nevada New Hampshire New Mexico New York North Carolina</div><div class="line">do</div><div class="line">    echo "Now going to $test"</div><div class="line">done</div></pre></td></tr></table></figure>
<p>运行结果如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~/loop$ bash bedtest2 </div><div class="line">Now going to Nevada</div><div class="line">Now going to New</div><div class="line">Now going to Hampshire</div><div class="line">Now going to New</div><div class="line">Now going to Mexico</div><div class="line">Now going to New</div><div class="line">Now going to York</div><div class="line">Now going to North</div><div class="line">Now going to Carolina</div></pre></td></tr></table></figure>
<p>从结果来看有问题，如果想要把含有空格的数值正确地迭代出来，必须使用双引号将这些值给圈起来，如下所示：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span>!/bin/bash</div><div class="line"><span class="meta">#</span> another example of how not to user the for command</div><div class="line">for test in Nevada "New Hampshire" " New Mexico" "New York" "North Carolina"</div><div class="line">do</div><div class="line">    echo "Now going to $test"</div><div class="line">done</div></pre></td></tr></table></figure>
<p>运行结果如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~/loop$ bash bedtest2 </div><div class="line">Now going to Nevada</div><div class="line">Now going to New Hampshire</div><div class="line">Now going to  New Mexico</div><div class="line">Now going to New York</div><div class="line">Now going to North Carolina</div></pre></td></tr></table></figure>
<h3 id="从变量读取列表"><a href="#从变量读取列表" class="headerlink" title="从变量读取列表"></a>从变量读取列表</h3><p>在shell脚本中会遇到这样的情况：将一系列的值都储存在了一个变量中，然后需要遍历变量中的整个列表。这种情况下，可以使用for命令，如下所示：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span>!/bin/bash</div><div class="line"><span class="meta">#</span> using a variable to hold the list</div><div class="line"><span class="meta">#</span></div><div class="line">list="Henan Chongqing Hebei Jiangsu"</div><div class="line">list=$list" Heilongjiang"</div><div class="line">for province in $list</div><div class="line">do</div><div class="line">    echo "Have you ever visited $province?"</div><div class="line">done</div></pre></td></tr></table></figure>
<p>运行结果如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~/loop$ bash test4.sh</div><div class="line">Have you ever visited Henan?</div><div class="line">Have you ever visited Chongqing?</div><div class="line">Have you ever visited Hebei?</div><div class="line">Have you ever visited Jiangsu?</div><div class="line">Have you ever visited Heilongjiang?</div></pre></td></tr></table></figure>
<p>代码解释，在代码中有一行这样的代码，即<code>list=$list&quot; Heilongjiang&quot;</code>，它表示在原来的列表中添加一个元素。</p>
<h3 id="从命令读取值"><a href="#从命令读取值" class="headerlink" title="从命令读取值"></a>从命令读取值</h3><p>生成列表中所需要值的另外一个途径就是使用命令的输出，可以用命令替换来执行任何能产生输出的 命令，然后在for命令中使用该命令的输出，如下所示：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span>!/bin/bash</div><div class="line"><span class="meta">#</span> reading values from a file</div><div class="line"></div><div class="line">file="province"</div><div class="line"></div><div class="line">for province in $(cat $file)</div><div class="line">do</div><div class="line">    echo "Visit beautifull $province"</div><div class="line">done</div></pre></td></tr></table></figure>
<p>运行结果如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~/loop$ cat province</div><div class="line">Henan</div><div class="line">Chongqing</div><div class="line">Hubei</div><div class="line">Jiansu</div><div class="line">Guangdong</div><div class="line">Guangxi</div><div class="line">biotest@ubuntu:~/loop$ bash test5.sh</div><div class="line">Visit beautifull Henan</div><div class="line">Visit beautifull Chongqing</div><div class="line">Visit beautifull Hubei</div><div class="line">Visit beautifull Jiansu</div><div class="line">Visit beautifull Guangdong</div><div class="line">Visit beautifull Guangxi</div></pre></td></tr></table></figure>
<p>在这个案例中，使用了cat命令来输出文件province的内容，在province文件中，每一行有一个省，其中最后一行是China HongKong，中间有一个空格。然后在输出时，for命令把China HongKong分开了。这是因为，在bash shell中，空格，换行符，制表符都是分割符，因此会被分开。</p>
<h3 id="更改字段分割符"><a href="#更改字段分割符" class="headerlink" title="更改字段分割符"></a>更改字段分割符</h3><p>for在迭代变量时，使用空格作为分割符，这是因为存在一个特殊的环境就是IFS，它的全称是internal field separator，中文名是内部字段分割符。IFS环境变量定义了bash shell用作字段分割符的一系列字符。默认情况下，bash shell会将以下字符当作是字段分割符，其中包括①空格；②制表符；③换行符。bash shell会将数据中的这些字符都当成分割符，因此在处理含有空格的数据（例如某些文件名）时非常麻烦。如果要解决这个问题，需要修改IFS的值，例如，想让bash shell只识别换行符，就当IFS更改为<code>IFS=$&#39;/n&#39;</code>。将这个语句加入到脚本中，就会告诉bash shell在数据中忽略空格和制表符，还以上面的案例为基础，看一下这段代码。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span>!/bin/bash</div><div class="line"><span class="meta">#</span> reading values from a file</div><div class="line"></div><div class="line">file="province"</div><div class="line"></div><div class="line">IFS=$'\n'</div><div class="line">for province in $(cat $file)</div><div class="line">do</div><div class="line">    echo "Visit beautifull $province"</div><div class="line">done</div></pre></td></tr></table></figure>
<p>运行后，结果如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~/loop$ bash test5a.sh </div><div class="line">Visit beautifull Henan</div><div class="line">Visit beautifull Chongqing</div><div class="line">Visit beautifull Hubei</div><div class="line">Visit beautifull Jiansu</div><div class="line">Visit beautifull Guangdong</div><div class="line">Visit beautifull Guangxi</div><div class="line">Visit beautifull China HongKong</div></pre></td></tr></table></figure>
<p>现在结果一切正常。如果处理的代码量比较大时，可能在一个地方需要修改IFS的值，然后忽略这次悠，在脚本的其他地方继续没用IFS的默认值，这个时候需要在改变IFS之前保存原来的IFS值，之后再恢复它，这种做法习惯是这样的：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">IFS.OLD=$IFS</div><div class="line">IFS=$'\n'</div><div class="line">&lt;在代码中使用新的IFS值&gt;</div><div class="line">IFS=$IFS.OLD</div></pre></td></tr></table></figure>
<p>此外，还有一种情况，如果某个文件中的分割隔都是冒号（:），例如<code>etc/passwd</code>文件中就是这样，此时也可以将IFS的值更改炒冒号，就像这样<code>IFS=:</code>，如果需要指定多个IFS字符，只要将它们在赋值行中一并输入就行，例如<code>IFS=$&#39;\n&#39;:;&quot;</code>，这个赋值就是将换行符、冒号、分号和双引号作为字段分隔符。</p>
<h3 id="使用通配符读取目录"><a href="#使用通配符读取目录" class="headerlink" title="使用通配符读取目录"></a>使用通配符读取目录</h3><p>使用for命令可以自动遍历目录中的文件，进行操作时，必须要在文件名或路径名中使用通配符，它会强制shell使用文件扩展匹配，文件扩展匹配是生成匹配指定通配符的文件名或路径名的过程，如果不清楚所有的文件名，这个特性在处理上当中的文件时很好用，如下所示。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span> iterate throught all the files in a directory</div><div class="line"></div><div class="line">for file in /home/biotest/test/*</div><div class="line">do</div><div class="line"></div><div class="line">    if [ -d "$file" ]</div><div class="line">    then</div><div class="line">        echo "$file is a directory"</div><div class="line">    elif [ -f "$file" ]</div><div class="line">    then</div><div class="line">        echo "$file is a file"</div><div class="line">    fi</div><div class="line">done</div></pre></td></tr></table></figure>
<p>运行后结果如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~/loop$ bash test6.sh|head</div><div class="line">/home/biotest/test/badtest2.sh is a file</div><div class="line">/home/biotest/test/badtest.sh is a file</div><div class="line">/home/biotest/test/cheat is a directory</div><div class="line">/home/biotest/test/contrast_file.sh is a file</div><div class="line">/home/biotest/test/directest.sh is a file</div><div class="line">/home/biotest/test/group.sh is a file</div><div class="line">/home/biotest/test/hockey is a file</div><div class="line">/home/biotest/test/object_exist.sh is a file</div><div class="line">/home/biotest/test/owner.sh is a file</div><div class="line">/home/biotest/test/sentinel is a file</div></pre></td></tr></table></figure>
<p>代码及结果解释：for命令遍历<code>/home/biotest/test/*</code>输出的结果，此代码使用了test命令测试了每个目录，以查看它是目录（-d参数）还是文件（-f参数）。在上面的代码中，<code>if [ -d &quot;$file&quot; ]</code>这里比较特殊，因此它加了引号，因为目录名和文件中包含空格非常常见，因此为了适应这种情况，需要将<code>$file</code>变量用双引号圈起来，如果不圈起来，就会输出错误，如下所示：</p>
<p>现在在<code>/home/biotest/test</code>目录中添加一个目录，命令为<code>a b</code>（中间有空格），再把上面的代码中的<code>if [ -d &quot;$file&quot; ]</code>的引号去掉，运行，如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~/loop$ bash test6a.sh</div><div class="line">test6a.sh: line 7: [: /home/biotest/test/a: binary operator expected</div></pre></td></tr></table></figure>
<p>这里就显示出错。因为在test命令方面，bash shell会将额外的单词当作参数，从而造成错误。</p>
<p>在for命令中可以列出多个目录通配符，将目录查找和列表合并到同一个for语句中，看下面的案例：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span>!/bin/bash</div><div class="line"><span class="meta">#</span> iterating through multiple directories</div><div class="line"></div><div class="line">for file in /home/biotest/.b*  /home/biotest/testing</div><div class="line">do</div><div class="line">    if [ -d "$file" ]</div><div class="line">    then</div><div class="line">        echo "$file is a directory"</div><div class="line">    elif [ -f "$file" ]</div><div class="line">    then</div><div class="line">        echo "$file is a file"</div><div class="line">    else</div><div class="line">        echo "$file doesn't exist"</div><div class="line">    fi</div><div class="line">done</div></pre></td></tr></table></figure>
<p>运行结果如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~/loop$ bash test7.sh</div><div class="line">/home/biotest/.bash_history is a file</div><div class="line">/home/biotest/.bash_logout is a file</div><div class="line">/home/biotest/.bashrc is a file</div><div class="line">/home/biotest/testing is a directory</div></pre></td></tr></table></figure>
<p>for语句使用了文件扩展匹配来遍历通配符生成的文件列表，然后它会遍历列表中的下一个文件。</p>
<h2 id="C语言风格的for命令"><a href="#C语言风格的for命令" class="headerlink" title="C语言风格的for命令"></a>C语言风格的for命令</h2><h3 id="简单的C风格for命令"><a href="#简单的C风格for命令" class="headerlink" title="简单的C风格for命令"></a>简单的C风格for命令</h3><p>在C语言中，它的for命令有一个用来指明变量的特定方法，一个必须保持成立才能继续迭代的条件。以及另一个在每个迭代中改变变量的方法，当指定的条件不成立时，for循环就会停止，条件等式通过标准的数学符号定义，例如下面的C语言代码：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++)</div><div class="line">&#123;</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"The next number is %d\n"</span>,i);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>这段代码会产生一个简单的迭代循环，其中变量<code>i</code>作为计数器，第一部分将一个默认值赋给该变量，中间的部分定义了循环重复的条件。当定义的条件不成立时，for循环就停止迭代。最后一部分定义了迭代的过程，在每次迭代之后，最后一部分占定义的表达式会被执行，在此案例中，每迭代一次，<code>i</code>变量就会增加1。</p>
<p>bash shell也支持一种for循环，与C语言的for循环类似，它的格式如下所示：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">for (( variable assignment ; condition ; iteration process ))</div></pre></td></tr></table></figure>
<p>在bash shell的C语言风格的for命令中，它有一些特殊的地方：第一，变量赋值可以有空格；第二，条件中的变量不以美元符号开头；第三，迭代过程中的算式并使用expr命令格式。看下面的案例：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span>!/bin/bash</div><div class="line"><span class="meta">#</span> testing the C-sytle for loop</div><div class="line"></div><div class="line">for (( i=1; i&lt;=10;i++))</div><div class="line">do</div><div class="line">    echo "The next number is $i"</div><div class="line">done</div></pre></td></tr></table></figure>
<p>运行结果如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~/loop$ bash test8.sh</div><div class="line">The next number is 1</div><div class="line">The next number is 2</div><div class="line">The next number is 3</div><div class="line">The next number is 4</div><div class="line">The next number is 5</div><div class="line">The next number is 6</div><div class="line">The next number is 7</div><div class="line">The next number is 8</div><div class="line">The next number is 9</div><div class="line">The next number is 10</div></pre></td></tr></table></figure>
<h3 id="使用多个变量"><a href="#使用多个变量" class="headerlink" title="　使用多个变量"></a>　使用多个变量</h3><p>C风格的for命令也可以迭代多个变量，循环会单独处理每个变量，用户可以为每个变量定义不同的迭代过程，虽然可以使用多个变量，但在for循环中只能定义一种条件，如下所示：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"></div></pre></td></tr></table></figure>
<p>运行结果如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~/loop$ bash test9.sh</div><div class="line">1-10</div><div class="line">2-9</div><div class="line">3-8</div><div class="line">4-7</div><div class="line">5-6</div><div class="line">6-5</div><div class="line">7-4</div><div class="line">8-3</div><div class="line">9-2</div><div class="line">10-1</div></pre></td></tr></table></figure>
<p>代码及结果解释：变量a和b分别用不同的值来初始化并定义了不同的迭代过程，循环的每次迭代在增加变量a的同时，减小了变量b。</p>
<h2 id="while命令"><a href="#while命令" class="headerlink" title="while命令"></a>while命令</h2><p>while命令在某种程度上是<code>if-then</code>和<code>for</code>循环的混合体。while命令允许定义一个要测试的命令，然后循环执行一组命令，只要定义的测试命令返回的是退出状态码0。它会在每次迭代的一开始测试test命令。在test命令返回非零退出状态码时，while命令会停止执行那组命令。</p>
<h3 id="while命令的基本使用"><a href="#while命令的基本使用" class="headerlink" title="while命令的基本使用"></a>while命令的基本使用</h3><p>while命令的基本格式如下所示：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">while test command</div><div class="line">do</div><div class="line">    other commands</div><div class="line">done</div></pre></td></tr></table></figure>
<p>while命令中定义的test command和if-then语句中的格式一样。可以使用任何普通bash shell命令，或者用test命令进行条件测试，比如测试变量值。while命令的关键在于所指定的test command的退出状态码必须随着循环中运行的命令而改变，如果退出状态码不发生变化，while循环就将一直不停地进行下去。常用的test command的用法是用方括号来检查循环命令中用到的shell变量的值，如下所示：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span>!/bin/bash</div><div class="line"><span class="meta">#</span> while command test</div><div class="line"></div><div class="line">var1=10</div><div class="line">while [ $var1 -gt 0 ]</div><div class="line">do</div><div class="line">    echo $var1</div><div class="line">    var1=$[ $var1 -1 ]</div><div class="line">done</div></pre></td></tr></table></figure>
<p>运行结果如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~/loop$ bash test10.sh</div><div class="line">10</div><div class="line">9</div><div class="line">8</div><div class="line">7</div><div class="line">6</div><div class="line">5</div><div class="line">4</div><div class="line">3</div><div class="line">2</div><div class="line">1</div></pre></td></tr></table></figure>
<p>在这个例子中，while命令定义了每次迭代时检查的测试条件，即<code>whle [ $var1 -gt 0 ]</code>，只要测试条件成立，<code>while</code>命令就会不停地循环执行定义好的命令，在这些命令中，测试条件中用到的变量必须修改，否则就会降入无限循环，在这个案例中，每次循环，变量值就会减一，即<code>var1=[ $var1 -1 ]</code>。while循环会在测试条件不再成立时停止。</p>
<h3 id="使用多个测试命令"><a href="#使用多个测试命令" class="headerlink" title="使用多个测试命令"></a>使用多个测试命令</h3><p>while命令允许用户在while语句行定义多个测试命令。只有最后一个测试命令的退出状态码会被用来决定什么时候结束循环。如果在输入命令时不小心，会导致一些意外，如下面的案例所示：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span>!/bin/bash</div><div class="line"><span class="meta">#</span> testing a multicommand while loop</div><div class="line"></div><div class="line">var1=10</div><div class="line"></div><div class="line">while echo $var1</div><div class="line">    [ $var1 -ge 0 ]</div><div class="line">do</div><div class="line">    echo "This is inside the loop"</div><div class="line">    var1=$[ $var1 - 1 ]</div><div class="line">done</div></pre></td></tr></table></figure>
<p>运行结果如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~/loop$ bash test11.sh</div><div class="line">10</div><div class="line">This is inside the loop</div><div class="line">9</div><div class="line">This is inside the loop</div><div class="line">8</div><div class="line">This is inside the loop</div><div class="line">7</div><div class="line">This is inside the loop</div><div class="line">6</div><div class="line">This is inside the loop</div><div class="line">5</div><div class="line">This is inside the loop</div><div class="line">4</div><div class="line">This is inside the loop</div><div class="line">3</div><div class="line">This is inside the loop</div><div class="line">2</div><div class="line">This is inside the loop</div><div class="line">1</div><div class="line">This is inside the loop</div><div class="line">0</div><div class="line">This is inside the loop</div><div class="line">-1</div></pre></td></tr></table></figure>
<p>代码及结果解释：第一个测试显示了var1变量的当前值，即<code>while echo $var1</code>，第二个测试用方括号来判断var1变量的值，即<code>[ $var1 -ge 0 ]</code>，在循环内部，echo语句会显示一条信息，说明循环被执行了，在最后，变量成为-1，这是因为while循环会在var1变量等于0时执行echo语句，然后将var1送去1，接下来再执行测试命令，用于下一次迭代，echo不测试命令被执行并显示了var变量的值，直到shell执行test测试命令，while循环才停止。这就说明在含有多个命令的while语句中，在每次迭代中所有的测试命令都会被执行，包括测试命令失败的最后一交迭代，需要注意这种用法。</p>
<h2 id="until命令"><a href="#until命令" class="headerlink" title="until命令"></a>until命令</h2><p>until命令和while命令的工作方式完全相反，until命令要求你指定一个通常返回非零退出状态码的测试命令。只有油门工命令的退出状态码不为0，bash shell才会执行循环中列出的命令。一旦测试命令返回了退出状态码0，循环就结果了，until命令的基本格式如下所示：</p>
<h3 id="until命令的基本格式"><a href="#until命令的基本格式" class="headerlink" title="until命令的基本格式"></a>until命令的基本格式</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">until test commands</div><div class="line">do</div><div class="line">    other commands</div><div class="line">done</div></pre></td></tr></table></figure>
<p>与while命令类似，在until命令中也可以放入多个测试命令，只有最后个命令的退出状态码决定了bash shell是否执行已经定义的other commands，如下所示：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span>!/bin/bash</div><div class="line"><span class="meta">#</span> using the until command</div><div class="line"></div><div class="line">var1=100</div><div class="line"></div><div class="line">until [ $var1 -eq 0 ]</div><div class="line">do</div><div class="line">    echo $var1</div><div class="line">    var1=$[ $var1 - 25 ]</div><div class="line">done</div></pre></td></tr></table></figure>
<p>运行结果如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~/loop$ bash test12.sh</div><div class="line">100</div><div class="line">75</div><div class="line">50</div><div class="line">25</div></pre></td></tr></table></figure>
<p>代码及结果解释：由于变量var1来决定until循环什么时候停止，只要该变量的的值等于0，until命令就会停止循环。until与while类似，在使用多个测试命令时要注意，如下所示：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span>!/bin/bash</div><div class="line"><span class="meta">#</span> using the until command</div><div class="line"></div><div class="line">var1=100</div><div class="line"></div><div class="line">until echo $var1</div><div class="line">    [ $var1 -eq 0 ]</div><div class="line">do</div><div class="line">    echo Inside the loop: $var1</div><div class="line">    var1=$[ var1 - 25 ]</div><div class="line">done</div></pre></td></tr></table></figure>
<p>运行结果如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~/loop$ bash test13.sh</div><div class="line">100</div><div class="line">Inside the loop: 100</div><div class="line">75</div><div class="line">Inside the loop: 75</div><div class="line">50</div><div class="line">Inside the loop: 50</div><div class="line">25</div><div class="line">Inside the loop: 25</div><div class="line">0</div></pre></td></tr></table></figure>
<p>直到var1=0，程序运行结束。</p>
<h2 id="嵌套循环"><a href="#嵌套循环" class="headerlink" title="嵌套循环"></a>嵌套循环</h2><p>循环语句可以在循环内使用任意类型的命令，包括其他循环命令。这种循环叫嵌套循环（nested loop）。需要注意的是，在使用嵌套循环时，是在迭代中使用迭代，与命令运行次数的关系是乘积的关系，在写代码时尤其要注意这一点，看下面的一个案例。</p>
<h3 id="for循环与for循环的嵌套"><a href="#for循环与for循环的嵌套" class="headerlink" title="for循环与for循环的嵌套"></a>for循环与for循环的嵌套</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span>!/bin/bash</div><div class="line"><span class="meta">#</span> nesting for loops</div><div class="line"></div><div class="line">for (( a=1;a&lt;=3;a++))</div><div class="line">do</div><div class="line">    echo "Starting loop $a: "</div><div class="line">    for ((b=1;b&lt;=3;b++))</div><div class="line">    do</div><div class="line">        echo "   Inside loop: $b"</div><div class="line">    done</div><div class="line">done</div></pre></td></tr></table></figure>
<p>运行结果如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~/loop$ bash test14.sh</div><div class="line">Starting loop 1: </div><div class="line">   Inside loop: 1</div><div class="line">   Inside loop: 2</div><div class="line">   Inside loop: 3</div><div class="line">Starting loop 2: </div><div class="line">   Inside loop: 1</div><div class="line">   Inside loop: 2</div><div class="line">   Inside loop: 3</div><div class="line">Starting loop 3: </div><div class="line">   Inside loop: 1</div><div class="line">   Inside loop: 2</div><div class="line">   Inside loop: 3</div></pre></td></tr></table></figure>
<p>代码及结果解释：在嵌套循环中，在外部循环的每次迭代中遍历一次它所有的值，两个循环的do和done命令没有任何差别，bash shell知道当第一个node命令执行的是内部循环，而非外部循环。</p>
<h3 id="while循环与for循环的嵌套"><a href="#while循环与for循环的嵌套" class="headerlink" title="while循环与for循环的嵌套"></a>while循环与for循环的嵌套</h3><p>在while循环内也可以放置一个for循环，如下所示：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span>!/bin/bash</div><div class="line"><span class="meta">#</span> palcing a for loop inside a while loop</div><div class="line"></div><div class="line">var1=5</div><div class="line"></div><div class="line">while [ $var1 -ge 0 ]</div><div class="line">do</div><div class="line">    echo "Outer loop: $var1"</div><div class="line">    for ((var2=1;$var2&lt;3;var2++))</div><div class="line">    do</div><div class="line">        var3=$[ $var1*$var2 ]</div><div class="line">        echo " Inner loop: $var1*$var2=$var3"</div><div class="line">    done</div><div class="line">    var1=$[ $var1 - 1 ]</div><div class="line">done</div></pre></td></tr></table></figure>
<p>运行结果如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">Outer loop: 5</div><div class="line"> Inner loop: 5*1=5</div><div class="line"> Inner loop: 5*2=10</div><div class="line">Outer loop: 4</div><div class="line"> Inner loop: 4*1=4</div><div class="line"> Inner loop: 4*2=8</div><div class="line">Outer loop: 3</div><div class="line"> Inner loop: 3*1=3</div><div class="line"> Inner loop: 3*2=6</div><div class="line">Outer loop: 2</div><div class="line"> Inner loop: 2*1=2</div><div class="line"> Inner loop: 2*2=4</div><div class="line">Outer loop: 1</div><div class="line"> Inner loop: 1*1=1</div><div class="line"> Inner loop: 1*2=2</div><div class="line">Outer loop: 0</div><div class="line"> Inner loop: 0*1=0</div><div class="line"> Inner loop: 0*2=0</div></pre></td></tr></table></figure>
<h3 id="until循环与for循环的嵌套"><a href="#until循环与for循环的嵌套" class="headerlink" title="until循环与for循环的嵌套"></a>until循环与for循环的嵌套</h3><p>案例如下所示：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span>!/bin/bash</div><div class="line"><span class="meta">#</span> using until and while loops</div><div class="line"></div><div class="line">var1=3</div><div class="line"><span class="meta">#</span> 变量以3开始</div><div class="line">until [ $var1 -eq 0 ] # 除非var1等于0，否则继续运行do...done之间的语句</div><div class="line">do</div><div class="line">    echo "Outer loop: $vaar1"</div><div class="line">    var2=1</div><div class="line">    while [ $var2 -lt 5 ] # 当var2小于5时，一直运行</div><div class="line">    do</div><div class="line">        var3=$(echo "scale=4;$var1/$var2" |bc)</div><div class="line">        echo "   Inner loop: $var1/$var2=$var3"</div><div class="line">        var2=$[ $var2+1 ]</div><div class="line">    done</div><div class="line">    var1=$[ $var1-1 ]</div><div class="line">done</div></pre></td></tr></table></figure>
<p>运行结果如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~/loop$ bash test16.sh</div><div class="line">Outer loop: </div><div class="line">   Inner loop: 3/1=3.0000</div><div class="line">   Inner loop: 3/2=1.5000</div><div class="line">   Inner loop: 3/3=1.0000</div><div class="line">   Inner loop: 3/4=.7500</div><div class="line">Outer loop: </div><div class="line">   Inner loop: 2/1=2.0000</div><div class="line">   Inner loop: 2/2=1.0000</div><div class="line">   Inner loop: 2/3=.6666</div><div class="line">   Inner loop: 2/4=.5000</div><div class="line">Outer loop: </div><div class="line">   Inner loop: 1/1=1.0000</div><div class="line">   Inner loop: 1/2=.5000</div><div class="line">   Inner loop: 1/3=.3333</div><div class="line">   Inner loop: 1/4=.2500</div></pre></td></tr></table></figure>
<h2 id="循环处理文件数据"><a href="#循环处理文件数据" class="headerlink" title="循环处理文件数据"></a>循环处理文件数据</h2><p>当我们遇到一种情况，即必须要遍历储存在文件中的数据时，需要两种技术。第一，使用嵌套循环；第二，修改IFS环境变量。通过修改IFS环境变量，就能强制for命令将文件中的每行都当成单独的一个条目来处理，即使数据中有空格也是如此，一旦从文件中提取出了单独的行，可能需要再次利用循环来提取行中的数据，典型的案例就是处理<code>/etc/passwd</code>文件中的数据，这要求你逐行遍历<code>/etc/passwd</code>文件，并将IFS变量的值改为冒号，这样就能分隔开每行中的各个数据段了，如下所示：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span>!/bin/bash</div><div class="line"><span class="meta">#</span> changing the IFS value</div><div class="line"></div><div class="line">IFS=$'\n'</div><div class="line">for entry in $(cat /etc/passwd)</div><div class="line">do</div><div class="line">    echo "Values in $entry -"</div><div class="line">    IFS=:</div><div class="line">    for value in $entry</div><div class="line">    do</div><div class="line">        echo "    $value"</div><div class="line">    done</div><div class="line">done</div></pre></td></tr></table></figure>
<p>运行结果如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~/loop$ bash test17.sh|head</div><div class="line">Values in root:x:0:0:root:/root:/bin/bash -</div><div class="line">    root</div><div class="line">    x</div><div class="line">    0</div><div class="line">    0</div><div class="line">    root</div><div class="line">    /root</div><div class="line">    /bin/bash</div><div class="line">Values in daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin -</div><div class="line">    daemon</div></pre></td></tr></table></figure>
<p>这个脚本使用了两个不同的FIS值来解析数据，第一个IFS值解析出<code>/etc/passwd</code>文件中的单独的行，内部for循环接着将FIS的值修改为冒号，然后从单独的行中解析出单独的值，因此在第一次运行时，会提取出一行数据，例如<code>root​:x:​0:0:root:/root:/bin/bash</code> ，接头使用for循环，提取出这一行中以冒号为分割符的元素，即<code>root x  0 0 root /root /bin/bash</code>信息。</p>
<h2 id="控制循环"><a href="#控制循环" class="headerlink" title="控制循环"></a>控制循环</h2><p>如果遇到这样的情况：一旦开启了循环，必须要等到所有的循环完成迭代时才结束，如果我想提前想结束循环的话，此时就要用到<code>break</code>命令和<code>continue</code>命令。</p>
<h3 id="break命令"><a href="#break命令" class="headerlink" title="break命令"></a>break命令</h3><p><code>break</code>命令可以退出任意类型的循环，包括<code>until</code>和<code>while</code>循环。</p>
<h4 id="break跳出单个循环"><a href="#break跳出单个循环" class="headerlink" title="break跳出单个循环"></a>break跳出单个循环</h4><p>在shell中执行break命令，它会深度跳出当前正在执行的循环，如下所示：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span>!/bin/bash</div><div class="line"><span class="meta">#</span> breaking out of a for loop</div><div class="line"></div><div class="line">for var1 in 1 2 3 4 5 6 7 8 9 10</div><div class="line">do</div><div class="line">    if [ $var1 -eq 5 ]</div><div class="line">    then</div><div class="line">       break</div><div class="line">    fi</div><div class="line">    echo "Iteration number: $var1"</div><div class="line">done</div><div class="line">echo "The for loop is completed"</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~/loop$ bash test18.sh</div><div class="line">Iteration number: 1</div><div class="line">Iteration number: 2</div><div class="line">Iteration number: 3</div><div class="line">Iteration number: 4</div><div class="line">The for loop is completed</div></pre></td></tr></table></figure>
<p>for循环通常都会遍历列表中指定的所有值。但当满足if-then的条件时，shell会执行break命令，停止for循环。同样的方法也适用于while和until循环，如下所示：：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span>!/bin/bash</div><div class="line"><span class="meta">#</span> breaking oiut of a while loop</div><div class="line"></div><div class="line">var1=1</div><div class="line"></div><div class="line">while [ $var1 -lt 10 ]</div><div class="line">do</div><div class="line">    if [ $var1 -eq 5 ]</div><div class="line">    then</div><div class="line">        break</div><div class="line">    fi</div><div class="line">    echo "Iteration: $var1"</div><div class="line">    var1=$[ $var1+1 ]</div><div class="line">done</div><div class="line">echo "The while is loop is completed"</div></pre></td></tr></table></figure>
<p>运行结果如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~/loop$ bash test19.sh</div><div class="line">Iteration: 1</div><div class="line">Iteration: 2</div><div class="line">Iteration: 3</div><div class="line">Iteration: 4</div><div class="line">The while is loop is completed</div></pre></td></tr></table></figure>
<h3 id=""><a href="#" class="headerlink" title=" "></a> </h3><h4 id="跳出内部循环"><a href="#跳出内部循环" class="headerlink" title="跳出内部循环"></a>跳出内部循环</h4><p>在处理多个循环时，break命令会自动终止你所在的最内层的循环。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span>!/bin/bash</div><div class="line"><span class="meta">#</span> breaking out of an inner loop</div><div class="line"></div><div class="line">for ((a=1;a&lt;4;a++))</div><div class="line">do</div><div class="line">    echo "Outer loop: $a"</div><div class="line">    for ((b=1;b&lt;100;b++)) # 内部循环指定当变量b等于100时停止迭代；</div><div class="line">    do</div><div class="line">        if [ $b -eq 5 ] # 但是当内部循环的if-then语句指明当变量b的值等于5时就执行break命令，跳出循环</div><div class="line">        then</div><div class="line">            break</div><div class="line">        fi</div><div class="line">        echo "   Inner loop:  $b" # 但是外部的循环仍然继续执行</div><div class="line">    done</div><div class="line">done</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~/loop$ bash test20.sh</div><div class="line">Outer loop: 1</div><div class="line">   Inner loop:  1</div><div class="line">   Inner loop:  2</div><div class="line">   Inner loop:  3</div><div class="line">   Inner loop:  4</div><div class="line">Outer loop: 2</div><div class="line">   Inner loop:  1</div><div class="line">   Inner loop:  2</div><div class="line">   Inner loop:  3</div><div class="line">   Inner loop:  4</div><div class="line">Outer loop: 3</div><div class="line">   Inner loop:  1</div><div class="line">   Inner loop:  2</div><div class="line">   Inner loop:  3</div><div class="line">   Inner loop:  4</div></pre></td></tr></table></figure>
<h4 id="跳出外部循环"><a href="#跳出外部循环" class="headerlink" title="跳出外部循环"></a>跳出外部循环</h4><p>有时候需要在内部循环，但外部循环停止，break命令可以接受单个命令行参数值，<code>break -n</code>，其中n指定了要跳出的循环层级，默认情况下，n为1，表明跳出的是当前的循环，即最内层的是第1层循环，如果设为2，break命令就会停止下一级的外部循环，如下所示：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span>!/bin/bash</div><div class="line"><span class="meta">#</span> breaking out of an outer loop</div><div class="line"></div><div class="line">for ((a=1;a&lt;4;a++))</div><div class="line">do</div><div class="line">    echo "Outer loop: $a"</div><div class="line">    for ((b=1;b&lt;100;b++))</div><div class="line">    do</div><div class="line">        if [ $b -gt 4 ]</div><div class="line">        then</div><div class="line">            break 2</div><div class="line">        fi</div><div class="line">        echo "   Inner loop: $b"</div><div class="line">    done</div><div class="line">done</div></pre></td></tr></table></figure>
<p>运行结果如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~/loop$ bash test21.sh</div><div class="line">Outer loop: 1</div><div class="line">   Inner loop: 1</div><div class="line">   Inner loop: 2</div><div class="line">   Inner loop: 3</div><div class="line">   Inner loop: 4</div></pre></td></tr></table></figure>
<p>当shell执行了break命令后，外部循环就停止了。</p>
<h3 id="continue命令"><a href="#continue命令" class="headerlink" title="continue命令"></a>continue命令</h3><p>continue命令可以提前中止某次循环中的命令，但并不会完全终止整个循环，可以在循环内部设置shell不执行命令的条件，这里有个for循环中使用continue命令的简单例子，如下所示：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span>!/bin/bash</div><div class="line"><span class="meta">#</span> testing continue command</div><div class="line"></div><div class="line">for ((var1=1;var1&lt;15;var1++))</div><div class="line">do</div><div class="line">    if [ $var1 -gt 5 ] &amp;&amp; [ $var1 -lt 10 ] </div><div class="line">    then</div><div class="line">         continue</div><div class="line">    fi</div><div class="line">    echo "Iteration number: $var1"</div><div class="line">done</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~/loop$ vim continue_test.sh</div><div class="line">biotest@ubuntu:~/loop$ bash continue_test.sh </div><div class="line">Iteration number: 1</div><div class="line">Iteration number: 2</div><div class="line">Iteration number: 3</div><div class="line">Iteration number: 4</div><div class="line">Iteration number: 5</div><div class="line">Iteration number: 10</div><div class="line">Iteration number: 11</div><div class="line">Iteration number: 12</div><div class="line">Iteration number: 13</div><div class="line">Iteration number: 14</div></pre></td></tr></table></figure>
<p>代码解释:当if-then语句的条件满足时，即值大于5小于10，shell会 执行continue命令，跳过此次循环中的剩余命令，但整个循环还会继续，当if-then的条件不再满足后，又继续循环。在while和until循环中也可以使用continue命令，但要谨慎，因为当shell执行continue命令时，它会跳过剩余的部分，如果在其中的条件具条件里对测试条件变量进行增值，问题就会出现，如下所示：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span>!/bin/bash</div><div class="line"><span class="meta">#</span> improperly using the continue command in a while loop</div><div class="line"></div><div class="line">var1=0</div><div class="line"></div><div class="line">while echo "while iteration; $var1"</div><div class="line">    [ $var1 -lt 15 ]</div><div class="line">do</div><div class="line">    if [ $var1 -gt 5 ] &amp;&amp; [ $var1 -lt 10 ]</div><div class="line">    then</div><div class="line">        continue</div><div class="line">    fi</div><div class="line">    echo "   Inside iteration number: $var1"</div><div class="line">    var1=$[ $var1+1 ]</div><div class="line">done</div></pre></td></tr></table></figure>
<p>运行结果如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~/loop$ bash badtest3.sh|head -20</div><div class="line">while iteration; 0</div><div class="line">   Inside iteration number: 0</div><div class="line">while iteration; 1</div><div class="line">   Inside iteration number: 1</div><div class="line">while iteration; 2</div><div class="line">   Inside iteration number: 2</div><div class="line">while iteration; 3</div><div class="line">   Inside iteration number: 3</div><div class="line">while iteration; 4</div><div class="line">   Inside iteration number: 4</div><div class="line">while iteration; 5</div><div class="line">   Inside iteration number: 5</div><div class="line">while iteration; 6</div><div class="line">while iteration; 6</div><div class="line">while iteration; 6</div><div class="line">while iteration; 6</div><div class="line">while iteration; 6</div><div class="line">while iteration; 6</div><div class="line">while iteration; 6</div><div class="line">while iteration; 6</div></pre></td></tr></table></figure>
<p>从结果可以看了同，在if-then的条件成立之后，一切都正常，但是当执行了continue命令后，它就跳过了while循环中的剩余部分，则跳过的部分正好是$var1计数变量增值的部分，而这个变量又被用于个渭测试命令中，因此这个值就不再变化，从而连续输出。</p>
<p>continue也可以与break一样，使用n来指定要继续执行哪一级循环，格式为<code>continue n</code>，如下所示：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span>!/bin/bash</div><div class="line"><span class="meta">#</span> continuing an outer loop</div><div class="line"></div><div class="line">for ((a=1;a&lt;=5;a++))</div><div class="line">do</div><div class="line">    echo "Iteration $a: "</div><div class="line">    for((b=1;b&lt;3;b++))</div><div class="line">    do</div><div class="line">        if [ $a -gt 2 ] &amp;&amp; [ $a -lt 4 ]</div><div class="line">        then</div><div class="line">            continue 2</div><div class="line">        fi</div><div class="line">        var3=$[ $a*$b ]</div><div class="line">        echo "   The result of $a*$b is $var3"</div><div class="line">    done</div><div class="line">done</div></pre></td></tr></table></figure>
<p>结果如下所示：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~/loop$ bash test22.sh</div><div class="line">Iteration 1: </div><div class="line">   The result of 1*1 is 1</div><div class="line">   The result of 1*2 is 2</div><div class="line">Iteration 2: </div><div class="line">   The result of 2*1 is 2</div><div class="line">   The result of 2*2 is 4</div><div class="line">Iteration 3: </div><div class="line">Iteration 4: </div><div class="line">   The result of 4*1 is 4</div><div class="line">   The result of 4*2 is 8</div><div class="line">Iteration 5: </div><div class="line">   The result of 5*1 is 5</div><div class="line">   The result of 5*2 is 10</div></pre></td></tr></table></figure></p>
<p>代码解释，其中的if-then部分为：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">if [ $a -gt 2 ] &amp;&amp; [ $a -lt 4 ]</div><div class="line">        then</div><div class="line">            continue 2</div><div class="line">        fi</div></pre></td></tr></table></figure>
<p>在此处用continue命令来停止处理循环内的命令，但会继续处理外部循环，值为3的那次迭代并没有处理任何内部循环语句，因为尽管continue命令命令会停止了处理过程，但外部循环会继续。（有关<code>break n</code>与<code>continue n</code>的这个原理，再写一篇笔记，我是没弄清楚原理）。</p>
<h2 id="处理循环输出"><a href="#处理循环输出" class="headerlink" title="处理循环输出"></a>处理循环输出</h2><p>在shell脚本中，可以对循环的输出使用管道或重定向，这可以通过在done命令之后添加一个处理命令来实现。如下所示：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span>!/bin/bash</div><div class="line">for file in /home/biotest/*</div><div class="line"></div><div class="line">do   </div><div class="line">   if [ -d "$file" ]</div><div class="line">   then</div><div class="line">       echo "$file is a directory"</div><div class="line">   elif [ -f "$file" ]</div><div class="line">   then</div><div class="line">       echo "$file is a file"</div><div class="line">   fi</div><div class="line">done &gt; output.tx</div></pre></td></tr></table></figure>
<p>运行结果如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~/loop$ cat output.txt|head</div><div class="line">/home/biotest/Desktop is a directory</div><div class="line">/home/biotest/Documents is a directory</div><div class="line">/home/biotest/Downloads is a directory</div><div class="line">/home/biotest/examples.desktop is a file</div><div class="line">/home/biotest/filename is a file</div><div class="line">/home/biotest/log. is a file</div><div class="line">/home/biotest/log.180427 is a file</div><div class="line">/home/biotest/loop is a directory</div><div class="line">/home/biotest/miniconda2 is a directory</div><div class="line">/home/biotest/Miniconda2-latest-Linux-x86_64.sh is a file</div></pre></td></tr></table></figure>
<p>第2个案例，如下所示：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span>!/bin/bash</div><div class="line"><span class="meta">#</span> redirecting the for output to a file</div><div class="line"></div><div class="line">for ((a=1;a&lt;10;a++))</div><div class="line">do</div><div class="line">    echo "The number is $a"</div><div class="line">done &gt; test23.txt</div><div class="line">echo "The commmand is finished."</div></pre></td></tr></table></figure>
<p>运行结果如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~/loop$ cat test23.txt</div><div class="line">The number is 1</div><div class="line">The number is 2</div><div class="line">The number is 3</div><div class="line">The number is 4</div><div class="line">The number is 5</div><div class="line">The number is 6</div><div class="line">The number is 7</div><div class="line">The number is 8</div><div class="line">The number is 9</div></pre></td></tr></table></figure>
<p>代码及结果解释：shell创建了文件test23.txt并将for命令的输出重定向到这个文件，shell在for命令之后正常显示了echo语句。这种方法也同样适用于将循环的结果用通道导入另一个命令。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span>!/bin/bash</div><div class="line"><span class="meta">#</span> piping a loop to another command</div><div class="line"></div><div class="line">for province in "Chine HK" Henan Guangdong </div><div class="line">do</div><div class="line">    echo "$province is the next place to go"</div><div class="line">done | sort</div><div class="line">echo "This completes out travels"</div></pre></td></tr></table></figure>
<p>运行结果如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~/loop$ bash test24.sh</div><div class="line">Chine HK is the next place to go</div><div class="line">Guangdong is the next place to go</div><div class="line">Henan is the next place to go</div><div class="line">This completes out travels</div></pre></td></tr></table></figure>
<p>代码及结果解释：province的值并没有在for命令列表中以特定次序列出，for命令的输出结果导入到了sort命令中，该命令会改变for命令输出结果的顺序。运行这个脚本实际上说明了结果已经在脚本内部排好序了。</p>
<h2 id="最终案例"><a href="#最终案例" class="headerlink" title="最终案例"></a>最终案例</h2><h3 id="第1案例：查找可执行文件"><a href="#第1案例：查找可执行文件" class="headerlink" title="第1案例：查找可执行文件"></a>第1案例：查找可执行文件</h3><p>如果要找出系统中有哪些可执行文件，只需要扫描PATH环境变量中的所有目录即可，下面是这样的一个脚本，如下所示</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span>!/bin/bash</div><div class="line"><span class="meta">#</span> finding files in the PATH</div><div class="line"></div><div class="line">IFS=:</div><div class="line">for folder in $PATH</div><div class="line">do </div><div class="line">    echo "$folder:"</div><div class="line">    for file in $folder/*</div><div class="line">    do</div><div class="line">        if [ -x $file ]</div><div class="line">        then</div><div class="line">            echo "   $file"</div><div class="line">        fi</div><div class="line">    done</div><div class="line">done</div></pre></td></tr></table></figure>
<p>运行，结果如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~/loop$ bash test25.sh|head -5</div><div class="line">/home/biotest/miniconda2/bin:</div><div class="line">   /home/biotest/miniconda2/bin/2to3</div><div class="line">   /home/biotest/miniconda2/bin/activate</div><div class="line">   /home/biotest/miniconda2/bin/appletviewer</div><div class="line">   /home/biotest/miniconda2/bin/c2ph</div><div class="line">biotest@ubuntu:~/loop$ cat test25.sh</div></pre></td></tr></table></figure>
<h3 id="第2案例：创建多个用户账户"><a href="#第2案例：创建多个用户账户" class="headerlink" title="第2案例：创建多个用户账户"></a>第2案例：创建多个用户账户</h3><p>如果要创建大量的用户，可以使用while循环来实现，将需要添加的新用户账户放在一个文本文件中，然后创建一个简单的脚本处理，文件文件的格式是这样的<code>userid, user name</code>，第一个条目是新用户的ID，第二个条目是用户的全名。两个值之间使用逗号分隔，这样就形成卫 种名为逗号分隔值的文本文件（或是csv格式文件）。如果要读取这里面的数据，需要将<code>IFS</code>分隔符设置为逗号，并将其放入while语句的条件测试部分。然后使用read命令读取文件中的各行，这一部分 的代码就是<code>while IFS=&#39;,&#39;,read -r userid name</code>，read命令会自动读取<code>.csv</code>文件的下一行内容，因此不需要创建一个循环，当read命令返回FALSE时（也就是读取完整个文件时），while命令就会退出，完整的脚本如下所示：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span>!/bin/bash</div><div class="line"><span class="meta">#</span> process new user accounts</div><div class="line"></div><div class="line">input="user.csv"</div><div class="line">while IFS=',' read -r userid name # -r这个参数表示允许输入的值中包含反斜杠“\”,反斜杠也作为值输出</div><div class="line">do</div><div class="line">    echo "adding $userid"</div><div class="line">    useradd -c "$name" -m $userid #-c表示：加上备注文字。备注文字会保存在passwd的备注栏位中；</div><div class="line">                                  # -m表示自动建立用户的登入目录</div><div class="line">done &lt; "$input" #将input变量中的csv文件输导入到while循环中</div></pre></td></tr></table></figure>
<p>运行结果如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~/loop$ cat user.csv </div><div class="line">userid,user name</div><div class="line">501,test01</div><div class="line">502,test02</div><div class="line">503,test03</div><div class="line"></div><div class="line">biotest@ubuntu:~/loop$ sudo bash test26.sh</div><div class="line">[sudo] password for biotest: </div><div class="line">adding userid</div><div class="line">adding 501</div><div class="line">adding 502</div><div class="line">adding 503</div><div class="line"></div><div class="line">biotest@ubuntu:~/loop$ tail /etc/passwd</div><div class="line">kernoops:x:116:65534:Kernel Oops Tracking Daemon,,,:/:/bin/false</div><div class="line">pulse:x:117:124:PulseAudio daemon,,,:/var/run/pulse:/bin/false</div><div class="line">rtkit:x:118:126:RealtimeKit,,,:/proc:/bin/false</div><div class="line">saned:x:119:127::/var/lib/saned:/bin/false</div><div class="line">usbmux:x:120:46:usbmux daemon,,,:/var/lib/usbmux:/bin/false</div><div class="line">biotest:x:1000:1000:UBUNTU,,,:/home/biotest:/bin/bash</div><div class="line">:/home/userid:1002:user name</div><div class="line">:/home/501:1003:test01</div><div class="line">:/home/502:1004:test02</div><div class="line">:/home/503:1005:test03</div></pre></td></tr></table></figure>
<p>从结果可以看出，这3个账户已经生成。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2018/04/30/Linux/Linux-shell02-if-then和case语句/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/04/30/Linux/Linux-shell02-if-then和case语句/" itemprop="url">Shell学习笔记（2）——if-then和case语句</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-04-30T12:10:54+08:00">
                2018-04-30
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Linux/" itemprop="url" rel="index">
                    <span itemprop="name">Linux</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  7,786
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  35
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>本篇笔记的参考资料是（<a href="https://item.jd.com/12010266.html" target="_blank" rel="external">《Linux命令行与shell脚本编程大全》</a>（第3版），外加百度辅助，本篇笔记的主要内容是if-then和case语句。</p>
<p>许多程序要求对shell脚本中的命令添加一些逻辑流控制。有一类命令会根据条件使脚本跳过某些命令，这样的命令叫做结构化命令（structured command）。</p>
<h2 id="if-then语句"><a href="#if-then语句" class="headerlink" title="if-then语句"></a>if-then语句</h2><p>if-then语句是最基本的结构化命令，if-then的结构如下所示：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">if commandA</div><div class="line">then commandB</div><div class="line">fi</div></pre></td></tr></table></figure>
<p>解释：if后面跟一个shell命令commandA，如果commandA命令的退出状态码是0（表示此命令成功运行），位于then后面的commandB命令就会被执行，如果commandA命令的退出状态码是其他值，then后面的commandB就不会被执行，而是继续执行脚本中的下一具命令，fi语句用来表示if-theny语句到此结构。</p>
<h3 id="第1案例：简单的if-then"><a href="#第1案例：简单的if-then" class="headerlink" title="第1案例：简单的if-then"></a>第1案例：简单的if-then</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span>!/bin/bash</div><div class="line"><span class="meta">#</span> testing the if statement</div><div class="line">if pwd</div><div class="line">then</div><div class="line">  echo "It worked"</div><div class="line">fi</div></pre></td></tr></table></figure>
<p>运行结果如下所示：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">[20161111.DESKTOP-IVG4HR1] ➤ bash test1.sh</div><div class="line">/home/mobaxterm</div><div class="line">It worked</div></pre></td></tr></table></figure>
<p>代码解释：if部分用了pwd命令，这个命令运行成功后，echo就会显示后面的字符串。</p>
<h3 id="第2案例：出错的if-then"><a href="#第2案例：出错的if-then" class="headerlink" title="第2案例：出错的if-then"></a>第2案例：出错的if-then</h3><p>看一段代码，如下所示：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span>!/bin/bash</div><div class="line"><span class="meta">#</span> testing a bad command</div><div class="line">if IamNotaCommand;then</div><div class="line">  echo "It worked"</div><div class="line">fi</div></pre></td></tr></table></figure>
<p>运行后，结果如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">[2018-04-28 10:41.15]  ~</div><div class="line">[20161111.DESKTOP-IVG4HR1] ➤ bash test2.sh</div><div class="line">test2.sh: line 3: IamNotaCommand: command not found</div></pre></td></tr></table></figure>
<p>代码解释：if后面跟的是一个无法工作的命令，它会产生一个非零的退出状态码，bash shell会跳过then部分。</p>
<h3 id="第3案例：then部分的多条命令"><a href="#第3案例：then部分的多条命令" class="headerlink" title="第3案例：then部分的多条命令"></a>第3案例：then部分的多条命令</h3><p>在if-then语句中，then部分可以输入多条命令，如下所示：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span>!/bin/bash</div><div class="line"><span class="meta">#</span> testing multiple commands in the then seciton</div><div class="line"><span class="meta">#</span></div><div class="line">testuser=biotest</div><div class="line"><span class="meta">#</span></div><div class="line">if grep $testuser /etc/passwd</div><div class="line">then </div><div class="line">  echo "This is my first command"</div><div class="line">  echo "This is my second command"</div><div class="line">  echo "I can even put in other commands besides echo: "</div><div class="line">  ls -a /home/$testuser/.b*</div><div class="line">fi</div></pre></td></tr></table></figure>
<p>运行后，结果如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~/test$ bash test3.sh</div><div class="line">biotest:x:1000:1000:UBUNTU,,,:/home/biotest:/bin/bash</div><div class="line">This is my first command</div><div class="line">This is my second command</div><div class="line">I can even put in other commands besides echo: </div><div class="line">/home/biotest/.bash_history  /home/biotest/.bash_logout  /home/biotest/.bashrc</div></pre></td></tr></table></figure>
<p>代码解释：<code>if grep $testuser /etc/passwd</code>这条代码用于查找某个用户名当前是否在系统上使用，如果有用户使用了这个登录名，脚本会显示出一些文本信息，并列出该用户HOME目录中的bash文件。如果没有这个用户，就什么都不显示，现在将<code>testuser=biotest</code>改为<code>testuser=biotest0</code>，运行，如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~/test$ bash test3.sh</div><div class="line">biotest@ubuntu:~/test$</div></pre></td></tr></table></figure>
<h2 id="if-then-else语句"><a href="#if-then-else语句" class="headerlink" title="if-then-else语句"></a>if-then-else语句</h2><p>if-then使用的场景是：如果if后面的命令成功执行，就输出then后面的内容，如果无法成功执行，什么都不输出。只有一这一种情况。而if-then-else语句则是能够执行其他的命令，它的格式如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">if commandA</div><div class="line">then </div><div class="line">  commandB</div><div class="line">else </div><div class="line">  commandC</div><div class="line">fi</div></pre></td></tr></table></figure>
<p>命令解释：当if语句中的commandA命令返回退出状态状码0时，then部分中的命令commandB会执行，到此if-then-else语句与if-then语句是相同的。如果if语句中的commandA命令返回非零状态码时，bash shell会执行else部分中的命令。看一个案例。</p>
<h3 id="第1案例：常规if-then-else语句"><a href="#第1案例：常规if-then-else语句" class="headerlink" title="第1案例：常规if-then-else语句"></a>第1案例：常规if-then-else语句</h3><p>看下面的代码:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span>!/bin/bash</div><div class="line"><span class="meta">#</span> testing  the else section</div><div class="line"><span class="meta">#</span></div><div class="line">testuser=biotest0</div><div class="line"><span class="meta">#</span></div><div class="line">if grep $testuser /etc/passwd</div><div class="line">then </div><div class="line">  echo "The bash files for user $testuser are:   "</div><div class="line">  ls -a /home/$testuser/.b*</div><div class="line">  echo</div><div class="line">else</div><div class="line">  echo "The user $testuser does not exist on this system."</div><div class="line">  echo</div><div class="line">fi</div></pre></td></tr></table></figure>
<p>运行结果如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~/test$ bash test4.sh</div><div class="line">The user biotest0 does not exist on this system.</div></pre></td></tr></table></figure>
<p>从代码与结果可以看出，<code>if grep $testuser /etc/passwd</code>命令出错，返回状态码是非0，<code>then</code>后面的命令不会执行，路过，执行<code>else</code>后面的命令。</p>
<h2 id="嵌套if"><a href="#嵌套if" class="headerlink" title="嵌套if"></a>嵌套if</h2><h3 id="第1个案例：常规if-then-else语句"><a href="#第1个案例：常规if-then-else语句" class="headerlink" title="第1个案例：常规if-then-else语句"></a>第1个案例：常规if-then-else语句</h3><p>案例：要检验<code>/etc/passwd</code>文件中是否存在某个用户名以及该用户的目录是否存在，可以使用嵌套的<code>if-then</code>语法，嵌套的<code>if-then</code>语句位于主<code>if-then-else</code>语句的<code>else</code>代码块中，如下所示：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span>!/bin/bash</div><div class="line"><span class="meta">#</span> testing nested ifs</div><div class="line"><span class="meta">#</span></div><div class="line">testuser=NoSuchUser</div><div class="line"><span class="meta">#</span></div><div class="line">if grep $testuser /etc/passwd</div><div class="line">then</div><div class="line">  echo "The user $testuser exists on this system."</div><div class="line">else</div><div class="line">  echo "The user $testuser does not exist on this system."</div><div class="line">  if ls -d /home/$testuser/</div><div class="line">  then </div><div class="line">    echo "However, $testuser has a directory."</div><div class="line">    fi</div><div class="line">fi</div></pre></td></tr></table></figure>
<p>运行结果，如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">The user NoSuchUser does not exist on this system.</div><div class="line">ls: cannot access &apos;/home/NoSuchUser/&apos;: No such file or directory</div></pre></td></tr></table></figure>
<p>程序解释：<code>if grep $testuser /etc/passwd</code>这个命令无法运行，状态返回码是非0，跳过了<code>echo &quot;The user $testuser exists on this system.&quot;</code>这个语句，执行后面的语句，即<code>&quot;The user $testuser does not exist on this system.&quot;</code>，接头是个嵌套语句，其中<code>ls -d /home/$testuser/</code>无法执行（因为不存在这个目录），then后面的<code> </code>也无法执行。</p>
<p>从结果可以看出，NoSuchUser这个账户不存在，他的目录也不存在。<code>if-then-else</code>还有一个延伸，即<code>elif</code>，它的格式如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">if commandA</div><div class="line">then </div><div class="line">  commandB</div><div class="line">elif commandC</div><div class="line">then</div><div class="line">  more commands</div><div class="line">fi</div></pre></td></tr></table></figure>
<p><code>elif</code>语句提供了一个要测序的命令，这类似于原始的if语句，如果elif后命令的退出状态码是0，bash就执行第二个<code>then</code>语句部分的命令，即more commands这一部分，看一个案例（提前在<code>/home/</code>目录下建立一个<code>NoSuchUser</code>目录）：</p>
<h3 id="第2个案例：elif语句"><a href="#第2个案例：elif语句" class="headerlink" title="第2个案例：elif语句"></a>第2个案例：elif语句</h3><p>这是对第1个案例的修改，所实现的目的是一样的，只是这里用到了elif语句，这种语句在逻辑上更加清晰。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span>!/bin/bash</div><div class="line"><span class="meta">#</span> Testing nested ifs=user elif</div><div class="line"><span class="meta">#</span></div><div class="line">testuser=NoSuchUser</div><div class="line"><span class="meta">#</span></div><div class="line">if grep $testuser /etc/passwd</div><div class="line">then</div><div class="line">  echo "The user $testuser exists on this system."</div><div class="line"><span class="meta">#</span></div><div class="line">elif ls -d /home/$testuser</div><div class="line">then</div><div class="line">  echo "The user $testuser does not exist on this system."</div><div class="line">  echo "Howerve, $testuser has a directory."</div><div class="line"><span class="meta">#</span></div><div class="line">fi</div></pre></td></tr></table></figure>
<p>运行后，结果如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~/test$ bash test6.sh</div><div class="line">/home/NoSuchUser</div><div class="line">The user NoSuchUser does not exist on this system.</div><div class="line">Howerve, NoSuchUser has a directory.</div></pre></td></tr></table></figure>
<p>程序解释：<code>if grep $testuser /etc/passwd</code>这条语句无法执行，执行<code>elif</code>后面的语句，即<code>ls -d /home/$testuser</code>,这条语句可以执行（因为我们提前建立了/home/NoSuchUser这个目录），随后执行then后面的语句。</p>
<h3 id="第3个案例：elif扩展"><a href="#第3个案例：elif扩展" class="headerlink" title="第3个案例：elif扩展"></a>第3个案例：elif扩展</h3><p>针对上面的案例，对脚本进行更改，让这个脚本的功能变成：一、检查拥有目录的不存在用户；二、检验没有目录的不存在用户，这是通过在嵌套elif中添加了一个else语句来实现的，如下所示：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span>!/bin/bash</div><div class="line"><span class="meta">#</span> Testing nested ifs - user elif &amp; else</div><div class="line"><span class="meta">#</span></div><div class="line">testuser=NoSuchUser</div><div class="line"><span class="meta">#</span></div><div class="line">if grep $testuser /etc/passwd</div><div class="line">then</div><div class="line">  echo "The user $testuser exists on this system."</div><div class="line"><span class="meta">#</span></div><div class="line">elif ls -d /home/$testuser</div><div class="line">then</div><div class="line">  echo "The user $testuser does not exist on this system."</div><div class="line">  echo "Howerve, $testuser has a directory."</div><div class="line"><span class="meta">#</span></div><div class="line">else</div><div class="line">  echo "The user $testuser does not exist on this system."</div><div class="line">  echo "And,$testuser does not have a directory."</div><div class="line">fi</div></pre></td></tr></table></figure>
<p>第1次运行结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~/test$ bash test7.sh</div><div class="line">/home/NoSuchUser</div><div class="line">The user NoSuchUser does not exist on this system.</div><div class="line">Howerve, NoSuchUser has a directory.</div></pre></td></tr></table></figure>
<p>第2次运行结果，现在删除掉<code>/home/NoSuchUser</code>目录，运行结果如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~/test$ sudo rm -rf /home/NoSuchUser</div><div class="line">biotest@ubuntu:~/test$ bash test7.sh </div><div class="line">ls: cannot access &apos;/home/NoSuchUser&apos;: No such file or directory</div><div class="line">The user NoSuchUser does not exist on this system.</div><div class="line">And,NoSuchUser does not have a directory.</div></pre></td></tr></table></figure>
<p>从两次的运行结果可以看出，在删除/home/NoSuchUser目录之前，即第1次运行，脚本执行的是<code>elif</code>后面的语句，返回状态码是0，删除了目录之后，elif语句返回的是非零状态码，elif块中的else就开始执行。需要注意的是，在elif语句中，紧跟其后的else语句属于elif代码块，它们并不属于if-then代码块。</p>
<h2 id="Test命令"><a href="#Test命令" class="headerlink" title="Test命令"></a>Test命令</h2><p>test命令是shell环境中测试条件表达式的工具。在前面的案例中，if后面的语句都是普通的shell语句，无法测序命令退出状态码之外的条件。在test命令中，如果test后面列出的条件成立，test命令就会退出并返回退出状态码0，如果条件不成立，test命令就会退出并返回非零的退出状态码，这就会使if-then语句不会被再执行，test的语句格式如下所示：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">test condition</div></pre></td></tr></table></figure>
<p>其中，condition是test命令要测试的一系列参数和值，如果test与if-then配合使用的话，格式如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">if test condition</div><div class="line">then</div><div class="line">  commands</div><div class="line">  if</div></pre></td></tr></table></figure>
<p>如果不写test命令的condition部分，它会以非零状态码退出，并执行else语句块，看一个案例。</p>
<h3 id="第1案例：常规test：test不添加condition"><a href="#第1案例：常规test：test不添加condition" class="headerlink" title="第1案例：常规test：test不添加condition"></a>第1案例：常规test：test不添加condition</h3><p>测试一下常规的test功能，如下所示：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span>!/bin/bash</div><div class="line"><span class="meta">#</span> Testing the test command</div><div class="line"><span class="meta">#</span></div><div class="line">if test</div><div class="line">then</div><div class="line">  echo "No expression returns a True"</div><div class="line">else</div><div class="line">  echo "No expression returns a False"</div><div class="line">fi</div></pre></td></tr></table></figure>
<p>结果如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~/test$ bash test8.sh</div><div class="line">No expression returns a False</div></pre></td></tr></table></figure>
<p>程序解释：test后面没有condition，因此它以非零状态码退出，执行else后面的语句，即<code>echo &quot;No expression returns a False&quot;</code>，如果添加上condition，则是下面的案例：</p>
<h3 id="第2案例：常规test：test添加condition"><a href="#第2案例：常规test：test添加condition" class="headerlink" title="第2案例：常规test：test添加condition"></a>第2案例：常规test：test添加condition</h3><p>代码如下：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span>!/bin/bash</div><div class="line"><span class="meta">#</span> testing the test command</div><div class="line"><span class="meta">#</span></div><div class="line">my_variable="Full"</div><div class="line"><span class="meta">#</span></div><div class="line">if test $my_variable</div><div class="line">then </div><div class="line">  echo "The $my_variable expression returns a True"</div><div class="line">else</div><div class="line">  echo "The $my_variable expressoion returns a False"</div><div class="line">fi</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~/test$ bash test9.sh</div><div class="line">The Full expression returns a True</div></pre></td></tr></table></figure>
<p>代码解释：test后面有内容（Full），因此当test命令测试条件时，返回的状态为0，执行then后面的语句。如果<code>$my_variable=&quot;&quot;</code>时，没有内容，就会执行else后面的语句，就跟第1个案例一样了。</p>
<h2 id="shell另外一种条件测试方法"><a href="#shell另外一种条件测试方法" class="headerlink" title="shell另外一种条件测试方法"></a>shell另外一种条件测试方法</h2><p>shell还有另外一种条件测序方法，无需要在if-then语句中使用test命令，其格式如下所示：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">if [ condition ]</div><div class="line">then </div><div class="line">  commands</div><div class="line">fi</div></pre></td></tr></table></figure>
<p><code>[ condition ]</code>中定义了测试条件，需要注意提方括号中，condition前后要加上空格，否则就会报错，test命令可以判断三类条件，分别为①数值比较；②字符串比较；③文件比较。</p>
<h3 id="数值比较"><a href="#数值比较" class="headerlink" title="数值比较"></a>数值比较</h3><p>test命令常见的情形是对两个数值进行比较，下表就列出了测试两个值可用的条件参数：</p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">比较</th>
<th style="text-align:center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">n1 -eq n2</td>
<td style="text-align:center">检查n1是否与n2相等</td>
</tr>
<tr>
<td style="text-align:center">n1 -ge n2</td>
<td style="text-align:center">检查n1是否大于或等于n2</td>
</tr>
<tr>
<td style="text-align:center">n1 -gt n2</td>
<td style="text-align:center">检查n1是否大于n2</td>
</tr>
<tr>
<td style="text-align:center">n1 -le n2</td>
<td style="text-align:center">检查n1是否小于或等于n2</td>
</tr>
<tr>
<td style="text-align:center">n1 -lt n2</td>
<td style="text-align:center">检查n1是否小于n2</td>
</tr>
<tr>
<td style="text-align:center">n1 -ne n2</td>
<td style="text-align:center">检查n1是否不等于n2</td>
</tr>
</tbody>
</table>
</div>
<h4 id="第1案例：数值比较"><a href="#第1案例：数值比较" class="headerlink" title="第1案例：数值比较"></a>第1案例：数值比较</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span>!bin/bash</div><div class="line"><span class="meta">#</span> Using numeric test evaluations</div><div class="line"><span class="meta">#</span></div><div class="line">value1=10</div><div class="line">value2=11</div><div class="line"><span class="meta">#</span></div><div class="line">if [ $value1 -gt 5 ] # test value1 is great 5 or not</div><div class="line">then </div><div class="line">  echo "The test value $value1 is greater than 5"</div><div class="line">fi</div><div class="line"><span class="meta">#</span></div><div class="line">if [ $value1 -eq $value2 ] # test value1 and value2 is equal or not</div><div class="line">then </div><div class="line">  echo "The values are equal"</div><div class="line">else</div><div class="line">  echo "The values are different"</div><div class="line">fi</div><div class="line"><span class="meta">#</span></div></pre></td></tr></table></figure>
<p>结果如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~/test$ bash test10.sh</div><div class="line">The test value 10 is greater than 5</div><div class="line">The values are different</div></pre></td></tr></table></figure>
<h4 id="第2案例：浮点数的比较"><a href="#第2案例：浮点数的比较" class="headerlink" title="第2案例：浮点数的比较"></a>第2案例：浮点数的比较</h4><p>如果涉及浮点比较时，数值条件测试会有一个限制，如下所示：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span>!bin/bash</div><div class="line"><span class="meta">#</span> Using floating point numbers in test evaluations</div><div class="line"><span class="meta">#</span></div><div class="line">value1=5.555</div><div class="line"><span class="meta">#</span></div><div class="line">echo "The test value is $value1"</div><div class="line"><span class="meta">#</span></div><div class="line">if [ $value1 -gt 5 ]</div><div class="line">then </div><div class="line">  echo "The test value $value1 is greater than 5"</div><div class="line">fi</div></pre></td></tr></table></figure>
<p>结果如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~/test$ bash test11.sh</div><div class="line">The test value is 5.555</div><div class="line">test11.sh: line 8: [: 5.555: integer expression expected</div></pre></td></tr></table></figure>
<p>结果中提示有问题，因为变量value1中储存提浮点值，脚本对这个值进行了测试，因为bash shell只能处理整数，如果只是要通过echo语句来显示这个结果，没问题，但是如果是基于数字的函数，就会出现了问题，因此需要注意。</p>
<h3 id="字符串比较"><a href="#字符串比较" class="headerlink" title="字符串比较"></a>字符串比较</h3><p>字符串的比较方法如下所示：</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>比较</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>str1 = str2</td>
<td>检查str1是否和str2相同</td>
</tr>
<tr>
<td>str1 != str2</td>
<td>检查str1是否和str3不相同</td>
</tr>
<tr>
<td>str1 &lt; str2</td>
<td>检查str1是否比str2小</td>
</tr>
<tr>
<td>str1 &gt; str2</td>
<td>检查str1是否比str2大</td>
</tr>
<tr>
<td>-n str1</td>
<td>检查str1的长度是否非0</td>
</tr>
<tr>
<td>-z str1</td>
<td>检查str1的长度是否为0</td>
</tr>
</tbody>
</table>
</div>
<h4 id="字符串比较第1案例"><a href="#字符串比较第1案例" class="headerlink" title="字符串比较第1案例"></a>字符串比较第1案例</h4><p>代码如下；</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span>!bin/bash</div><div class="line"><span class="meta">#</span> testing string equality</div><div class="line">testuser=biotest</div><div class="line"><span class="meta">#</span></div><div class="line">if [ $USER = $testuser ]</div><div class="line">then</div><div class="line">  echo "Welcom $testuser"</div><div class="line">fi</div></pre></td></tr></table></figure>
<p>运行结果如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~/test$ bash test12.sh</div><div class="line">Welcom biotest</div></pre></td></tr></table></figure>
<h4 id="字符串比较第2案例：判断字符串不等的条件"><a href="#字符串比较第2案例：判断字符串不等的条件" class="headerlink" title="字符串比较第2案例：判断字符串不等的条件"></a>字符串比较第2案例：判断字符串不等的条件</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span>!/bin/bash</div><div class="line"><span class="meta">#</span> testing string equality</div><div class="line">testuser=baduser</div><div class="line"><span class="meta">#</span></div><div class="line">if [ $USER != $testuser ]</div><div class="line">then </div><div class="line">  echo "This is not $testuser"</div><div class="line">else</div><div class="line">  echo "Welcome $testuser"</div><div class="line">fi</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~/test$ bash test13.sh</div><div class="line">This is not baduser</div></pre></td></tr></table></figure>
<h3 id="字符串的大小"><a href="#字符串的大小" class="headerlink" title="字符串的大小"></a>字符串的大小</h3><p>在比较字符串方面，有一些事情比较麻烦，主要有两个方面，①大于号和小于号必须要转义，否则shell会将它们当成重定向符号，把字符串值当作文件名；②大于和小于顺序和sort命令所采用的不同，看一个案例。</p>
<h4 id="第1案例：大于或小于号的重定向问题"><a href="#第1案例：大于或小于号的重定向问题" class="headerlink" title="第1案例：大于或小于号的重定向问题"></a>第1案例：大于或小于号的重定向问题</h4><p>看下面的案例，注意大于号。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span>!/bin/bash</div><div class="line"><span class="meta">#</span> mis-using string comparisons</div><div class="line"><span class="meta">#</span></div><div class="line">val1=baseball</div><div class="line">val2=hockey</div><div class="line"><span class="meta">#</span></div><div class="line">if [ $val1 &gt; $val2 ]</div><div class="line">then</div><div class="line">  echo "$val1 is greater than $val2"</div><div class="line">else</div><div class="line">  echo "$val1 is less than $val2"</div><div class="line">fi</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~/test$ bash badtest.sh </div><div class="line">val1 is less than val2</div><div class="line">biotest@ubuntu:~/test$ ll</div><div class="line">total 72</div><div class="line">-rw-rw-r--  1 biotest biotest     0 Apr 27 23:21 hockey</div></pre></td></tr></table></figure>
<p>运行结果时，shell没有报错，但是给出的结果却是错的，因为脚本把大于事情解释成了输出重定向，它在当前目录下创建了一个名为hockey的文件，由于重定向的完成，test命令（就是if语句）返回了退出状态码0。</p>
<h4 id="第2案例：解决字符串比较时，大于号的问题"><a href="#第2案例：解决字符串比较时，大于号的问题" class="headerlink" title="第2案例：解决字符串比较时，大于号的问题"></a>第2案例：解决字符串比较时，大于号的问题</h4><p>如果要解决上述问题，需要对大于号进行转义，前面加上<code>\</code>符号即可，如下所示：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span>!/bin/bash</div><div class="line"><span class="meta">#</span> mis-using string comparisons</div><div class="line"><span class="meta">#</span></div><div class="line">val1=baseball</div><div class="line">val2=hockey</div><div class="line"><span class="meta">#</span></div><div class="line">if [ $val1 \&gt; $val2 ]</div><div class="line">then</div><div class="line">  echo "$val1 is greater than $val2"</div><div class="line">else</div><div class="line">  echo "$val1 is less than $val2"</div><div class="line">fi</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~/test$ bash badtest2.sh </div><div class="line">baseball is less than hockey</div></pre></td></tr></table></figure>
<h4 id="sort命令对字符串的排序问题"><a href="#sort命令对字符串的排序问题" class="headerlink" title="sort命令对字符串的排序问题"></a>sort命令对字符串的排序问题</h4><p>在处理字符串方面，sort和test的方法正好相反， 看一个案例。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span>!/bin/bash</div><div class="line"><span class="meta">#</span> testing astring osrt order</div><div class="line">val1=Testing</div><div class="line">val2=testing</div><div class="line"><span class="meta">#</span></div><div class="line">if [ $val1 \&gt; $val2 ]</div><div class="line">then</div><div class="line">  echo "$val1 is greater than $val2"</div><div class="line">else</div><div class="line">  echo "$val1 is less than $val2"</div><div class="line">fi</div></pre></td></tr></table></figure>
<p>运行结果如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~/test$ bash test14.sh</div><div class="line">Testing is less than testing</div></pre></td></tr></table></figure>
<p>结查要显示，Testing比testing小，如果是sort，则是下面的结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~/test$ cat testfile </div><div class="line">Testing</div><div class="line">testing</div><div class="line">biotest@ubuntu:~/test$ sort testfile </div><div class="line">testing</div><div class="line">Testing</div></pre></td></tr></table></figure>
<p>testing要比Testing大。</p>
<p>在比较测试上，大写字符被认为是小于小写字母的，但是在sort命令中，小写字母会先出现。这是因为比较测试中使用的是标准的ASCII顺序，根据每个字符的ASCII为当会来决定排序结果，而sort命令使用的也是ASCII顺序排序，只是默认情况下，sort会按照ASCII从小到大进行排序，如果加上了-r参数，则是按照默认排序的相反顺序进行排序，如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~/test$ sort -r testfile </div><div class="line">Testing</div><div class="line">testing</div></pre></td></tr></table></figure>
<h4 id="判断字符串是否为0"><a href="#判断字符串是否为0" class="headerlink" title="判断字符串是否为0"></a>判断字符串是否为0</h4><p><code>-n</code>和<code>-z</code>可以检查一个变量是否含有数据，如下所示：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span>!/bin/bash</div><div class="line"><span class="meta">#</span> testing string length</div><div class="line">val1=testing  </div><div class="line">val2='' </div><div class="line"><span class="meta">#</span></div><div class="line">if [ -n $val1 ]</div><div class="line">then</div><div class="line">  echo "The string '$val1' is not empty"</div><div class="line">else</div><div class="line">  echo "The string '$val1' is empty"</div><div class="line">fi</div><div class="line"><span class="meta">#</span></div><div class="line"></div><div class="line">if [ -z $val2 ]</div><div class="line">then</div><div class="line">  echo "The string '$val2' is empty"</div><div class="line">else</div><div class="line">  echo "The string '$val2' is not empty"</div><div class="line">fi</div><div class="line"><span class="meta">#</span></div><div class="line"></div><div class="line">if [ -z $val3 ]</div><div class="line">then</div><div class="line">  echo "The string '$val3' is empty"</div><div class="line">else</div><div class="line">  echo "The string '$val3' is not empty"</div><div class="line">fi</div></pre></td></tr></table></figure>
<p>运行结果如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~/test$ bash test15.sh</div><div class="line">The string &apos;testing&apos; is not empty</div><div class="line">The string &apos;&apos; is empty</div><div class="line">The string &apos;&apos; is empty</div></pre></td></tr></table></figure>
<p>程序解释：①先创建了2个字符串变量，val1包含一个字符串，val2包含的是一个空字符串；②<code>if [ -n $val1 ]</code>表示：判断val1的变量是否长度非0，因为val1并不是一个空字符串，它不是0，因此执行后面的then部分；③<code>if [ -z $val2 ]</code>：判断val2的变量是否长度为0，而val2是一个空字符串，它的长度为0，因此执行then部分；④<code>if [ -z $val3 ]</code>：判断val3的变量是否长度为0，由于这个变量并未在shell脚本中定义过，所以它的字符串长度仍然为0。</p>
<h3 id="文件比较"><a href="#文件比较" class="headerlink" title="文件比较"></a>文件比较</h3><p>文件比较是shell编程中使用比较多的形式，它允许用户测试Linux文件系统上的文件和目录的状态，下表列出了这些比较方式，如下所示：</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>比较</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>-d file</td>
<td>检查file是否存在并是一个目录</td>
</tr>
<tr>
<td>-e file</td>
<td>检查file是否存在</td>
</tr>
<tr>
<td>-f file</td>
<td>检查file是否存在并 一个文件</td>
</tr>
<tr>
<td>-r file</td>
<td>检查file是否存在并可读</td>
</tr>
<tr>
<td>-s file</td>
<td>检查file是否存在并非空</td>
</tr>
<tr>
<td>-w file</td>
<td>检查file是否存在并可写</td>
</tr>
<tr>
<td>-x file</td>
<td>检查file是否存在并可执行</td>
</tr>
<tr>
<td>-O file</td>
<td>检查file是否存在并属当前用户所有</td>
</tr>
<tr>
<td>-G file</td>
<td>检查file是否存在并默认组与当前用户相同</td>
</tr>
<tr>
<td>file1 -nt file2</td>
<td>检查file是否比file2新</td>
</tr>
<tr>
<td>file1 -ot file2</td>
<td>检查file是否比file2旧</td>
</tr>
</tbody>
</table>
</div>
<h4 id="检查目录"><a href="#检查目录" class="headerlink" title="检查目录"></a>检查目录</h4><p><code>-d</code>测试会检查指定的目录是否存在于系统中如果打算将文件写入目录或是准备切换到某个目录，先进行测试是一种好习惯，如下所示：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span>!/bin/bash</div><div class="line"><span class="meta">#</span> Look before you leap</div><div class="line"><span class="meta">#</span></div><div class="line">jump_directory=/home/arthur</div><div class="line"><span class="meta">#</span></div><div class="line">if [ -d $jump_directory ]</div><div class="line">then</div><div class="line">  echo "The $jump_directory directory exists"</div><div class="line">  cd $jump_directory</div><div class="line">  ls</div><div class="line">else</div><div class="line">  echo "The $jump_directory directory does not exist"</div><div class="line">fi</div><div class="line"><span class="meta">#</span></div></pre></td></tr></table></figure>
<p>结果运行如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~/test$ bash directest.sh </div><div class="line">The /home/arthur directory does not exist</div></pre></td></tr></table></figure>
<p>代码解释：<code>-d</code>测试用于检测jump_directory变量是中目录是否存在，如果存在就使用cd命令进入该目录，如果不存在脚本就输出一条信息，然后退出。</p>
<h4 id="检查对象是否存在"><a href="#检查对象是否存在" class="headerlink" title="检查对象是否存在"></a>检查对象是否存在</h4><p><code>-e</code>参数可以使脚本代码在使用文件或上当前检查它们是否存在，如下所示：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span>!/bin/bash</div><div class="line"><span class="meta">#</span> check if either a directory or file exists</div><div class="line"><span class="meta">#</span></div><div class="line">location=$HOME</div><div class="line">file_name="sentinel"</div><div class="line"><span class="meta">#</span></div><div class="line">if [ -e $location ]</div><div class="line">then # Directory does exist</div><div class="line">  echo "OK on the $location directory."</div><div class="line">  echo "Now checking on the file, $file_name."</div><div class="line"><span class="meta">#</span></div><div class="line">  if [ -e $location/$file_name ]</div><div class="line">  then # file does exist</div><div class="line">    echo "OK on the filename"</div><div class="line">    echo "Updating Current Date..."</div><div class="line">    date &gt;&gt; $location/$file_name</div><div class="line"><span class="meta">#</span></div><div class="line">  else # file does no exist</div><div class="line">    echo "File does not exist"</div><div class="line">    echo "Nothing to update"</div><div class="line">  fi</div><div class="line"><span class="meta">#</span></div><div class="line">else #Directory does exist</div><div class="line">  echo "The $location directory does not exist."</div><div class="line">  echo "Nothing to update"</div><div class="line">fi</div></pre></td></tr></table></figure>
<p>第一次运行，结果如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~/test$ bash object_exist.sh </div><div class="line">OK on the /home/biotest directory.</div><div class="line">Now checking on the file, sentinel.</div><div class="line">File does not exist</div><div class="line">Nothing to update</div></pre></td></tr></table></figure>
<p>第二次运行，如果创建了<code>sentinel</code>文件，则如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~/test$ bash object_exist.sh </div><div class="line">OK on the /home/biotest directory.</div><div class="line">Now checking on the file, sentinel.</div><div class="line">OK on the filename</div><div class="line">Updating Current Date...</div><div class="line">biotest@ubuntu:~/test$ cat ~/sentinel </div><div class="line">Sat Apr 28 00:37:31 PDT 2018</div></pre></td></tr></table></figure>
<p>代码解释：第一次检查用了<code>-e</code>比较来判断用户是否有<code>$HOME</code>目录，如果有接下来的<code>-e</code>会检测sentinel文件是否存在于<code>$HOME</code>目录中，如果不存在，shell脚本就会提示该文件不存在，不需要更新。第二次运行时，在<code>$HOME</code>目录下创建了一个<code>sentinel</code>文件，然后重新运行脚本，由于<code>$HOME</code>和<code>sentinel</code>文件都存在，当前的上期和时间就都追加到了这个文本中。</p>
<h4 id="检查文件"><a href="#检查文件" class="headerlink" title="检查文件"></a>检查文件</h4><p>如果检查的对象是文件，需要用<code>-f</code>参数，如下所示：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span>!/bin/bash</div><div class="line"><span class="meta">#</span> Check if either a directory or file exists.</div><div class="line"><span class="meta">#</span></div><div class="line">item_name=$HOME</div><div class="line">echo</div><div class="line">echo "The item being checked: $item_name"</div><div class="line">echo</div><div class="line"><span class="meta">#</span></div><div class="line">if [ -e $item_name ]</div><div class="line">then # Item does exist</div><div class="line">  echo "The item, $item_name, does exist."</div><div class="line">  echo "But is it a file?"</div><div class="line">  echo</div><div class="line"><span class="meta">  #</span></div><div class="line">  if [ -f $item_name ]</div><div class="line">  then # Item is a file</div><div class="line">     echo "Yes, $item_name is a file."</div><div class="line"><span class="meta">  #</span></div><div class="line">  else # Item does not exist</div><div class="line">    echo "No, $item_name is not a file"</div><div class="line">  fi</div><div class="line"></div><div class="line">else #Item doese not exist</div><div class="line">    echo "The item , $item_name, does not exist."</div><div class="line">    echo "Nothing to update"</div><div class="line">fi</div></pre></td></tr></table></figure>
<p>运行结果如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~/test$ bash test_file.sh </div><div class="line"></div><div class="line">The item being checked: /home/biotest</div><div class="line"></div><div class="line">The item, /home/biotest, does exist.</div><div class="line">But is it a file?</div><div class="line"></div><div class="line">No, /home/biotest is not a file</div></pre></td></tr></table></figure>
<p>代码解释：首先使用了<code>-e</code>比较测序<code>$HOME</code>是否存在，如果存在，继续使用<code>-f</code>来测试它是不是一个文件，如果它不是文件（肯定不是文件），就会显示一条消息，它不是一个文件，如果更改一下代码，把<code>item_name</code>设置为<code>$HOME/sentinel</code>，即如下所示：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span>!/bin/bash</div><div class="line"><span class="meta">#</span> Check if either a directory or file exists.</div><div class="line"><span class="meta">#</span></div><div class="line">item_name=$HOME/sentinel</div><div class="line">echo</div><div class="line">echo "The item being checked: $item_name"</div><div class="line">echo</div><div class="line"><span class="meta">#</span></div><div class="line">if [ -e $item_name ]</div><div class="line">then # Item does exist</div><div class="line">  echo "The item, $item_name, does exist."</div><div class="line">  echo "But is it a file?"</div><div class="line">  echo</div><div class="line"><span class="meta">  #</span></div><div class="line">  if [ -f $item_name ]</div><div class="line">  then # Item is a file</div><div class="line">     echo "Yes, $item_name is a file."</div><div class="line"><span class="meta">  #</span></div><div class="line">  else # Item does not exist</div><div class="line">    echo "No, $item_name is not a file"</div><div class="line">  fi</div><div class="line"></div><div class="line">else #Item doese not exist</div><div class="line">    echo "The item , $item_name, does not exist."</div><div class="line">    echo "Nothing to update"</div><div class="line">fi</div></pre></td></tr></table></figure>
<p>运行结果如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~/test$ bash test_file2.sh </div><div class="line"></div><div class="line">The item being checked: /home/biotest/sentinel</div><div class="line"></div><div class="line">The item, /home/biotest/sentinel, does exist.</div><div class="line">But is it a file?</div><div class="line"></div><div class="line">Yes, /home/biotest/sentinel is a file.</div></pre></td></tr></table></figure>
<h4 id="检查文件是否可读"><a href="#检查文件是否可读" class="headerlink" title="检查文件是否可读"></a>检查文件是否可读</h4><p>在试图从某个文件中读取数据之前，可以测试一下文件是否可读，参数是<code>-r</code>，如下所示：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span>!/bin/bash</div><div class="line"><span class="meta">#</span> testing a file is readable or not</div><div class="line">pwfile=/etc/shadow</div><div class="line"><span class="meta">#</span></div><div class="line"><span class="meta">#</span> first, test if the file exists, and is a file</div><div class="line">if [ -f $pwfile ]</div><div class="line">then </div><div class="line">    # Now test if you can read it</div><div class="line">    if [ -r $pwfile ]</div><div class="line">    then </div><div class="line">        tail $pwfile</div><div class="line">    else</div><div class="line">        echo "Sorry, I am unable to read the $pwfile file"</div><div class="line">    fi</div><div class="line">else</div><div class="line">    echo "Sorry, the file $pwfile does not exist"</div><div class="line">fi</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~/test$ bash test_read.sh </div><div class="line">Sorry, I am unable to read the /etc/shadow file</div></pre></td></tr></table></figure>
<h4 id="检查空文档"><a href="#检查空文档" class="headerlink" title="检查空文档"></a>检查空文档</h4><p>检查空文档的参数是<code>-s</code>，如果<code>-s</code>比较正确，说明文件中有数据，如下所示：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span>!/bin/bash</div><div class="line"><span class="meta">#</span> Testing if a file is empty</div><div class="line"><span class="meta">#</span></div><div class="line">file_name=$HOME/sentinel</div><div class="line"><span class="meta">#</span></div><div class="line">if [ -f $file_name ]</div><div class="line">then</div><div class="line">    if [ -s $file_name ]</div><div class="line">    then</div><div class="line">        echo "The $file_name file exists and has data in it."</div><div class="line">        echo "Will not remove this file."</div><div class="line"><span class="meta">#</span></div><div class="line">    else</div><div class="line">        echo "The $file_name file exists, but is empty."</div><div class="line">        echo "Deleting empty file..."</div><div class="line">        rm $file_name</div><div class="line">    fi</div><div class="line">else</div><div class="line">    echo "File, $file_name, does not exist."</div><div class="line">fi</div><div class="line"><span class="meta">#</span></div></pre></td></tr></table></figure>
<p>运行结果如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~/test$ ls -l $HOME/sentinel</div><div class="line">-rw-rw-r-- 1 biotest biotest 29 Apr 28 00:37 /home/biotest/sentinel</div><div class="line">biotest@ubuntu:~/test$ bash test_empty.sh </div><div class="line">The /home/biotest/sentinel file exists and has data in it.</div><div class="line">Will not remove this file.</div></pre></td></tr></table></figure>
<p>代码解释：首先使用<code>-f</code>测试文件是否存在，如果存在，用<code>-s</code>比较来判断该文件是否为空，空文件会被删除，在运行脚本前，使用<code>ls -l</code>命令检查了<code>$HOME/ssentinel</code>文件，发现不是空的，因此脚本并不会删除它。</p>
<h4 id="检查是否可写"><a href="#检查是否可写" class="headerlink" title="检查是否可写"></a>检查是否可写</h4><p><code>-w</code>比较会判断当前用户对文件是否有可写权限，下面的一段代码应时检测item_name是否存在、是否为文件，是否可写，如下所示：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span>!/bin/bash</div><div class="line"><span class="meta">#</span> Testing if a file is writable</div><div class="line"><span class="meta">#</span></div><div class="line">file_name=$HOME/sentinel</div><div class="line">echo</div><div class="line">echo "The item being checked: $file_name"</div><div class="line">echo</div><div class="line"><span class="meta">#</span></div><div class="line">if [ -e $file_name ]</div><div class="line">then </div><div class="line">    echo "The item, $file_name, does exist."</div><div class="line">    echo "But is it a file?"</div><div class="line">    echo</div><div class="line">    #</div><div class="line">    if [ -f $file_name ]</div><div class="line">    then</div><div class="line">        echo "Yes, $file_name is a file."</div><div class="line">        echo "But is it writable ?"</div><div class="line">        echo</div><div class="line"></div><div class="line">    #</div><div class="line">        if [ -w $file_name ]</div><div class="line">        then</div><div class="line">            echo "Yes, it is writable."</div><div class="line">            echo "Writing current time to $file_name"</div><div class="line">            date +%H%M &gt;&gt; $file_name</div><div class="line">            echo</div><div class="line">        #</div><div class="line">        else</div><div class="line">            echo "The item, $file_name,is not a writable file"</div><div class="line">            echo "Unable to write to $file_name"</div><div class="line">        fi</div><div class="line"></div><div class="line">    else</div><div class="line">        echo "No, $file_name is not a file."</div><div class="line">    fi</div><div class="line">else</div><div class="line">    echo "The item  $file_name does not exist"</div><div class="line">fi</div></pre></td></tr></table></figure>
<p>运行结果如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~/test$ bash test_write.sh </div><div class="line"></div><div class="line">The item being checked: /home/biotest/sentinel</div><div class="line"></div><div class="line">The item, /home/biotest/sentinel, does exit.</div><div class="line">But is it a file?</div><div class="line"></div><div class="line">Yes, /home/biotest/sentinel is a file.</div><div class="line">But is it writable ?</div><div class="line"></div><div class="line">Yes, it is writable.</div><div class="line">Writing current time to /home/biotest/sentinel</div><div class="line">biotest@ubuntu:~/test$ cat /home/biotest/sentinel </div><div class="line">Sat Apr 28 00:37:31 PDT 2018</div><div class="line">0137</div><div class="line">0138</div><div class="line">0141</div></pre></td></tr></table></figure>
<p>现在使用<code>chmod</code>命令关闭文件sentinel的用户写入权限，再测试一下这个脚本。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">chmod u-w $HOME/sentinel</div><div class="line">biotest@ubuntu:~/test$ bash test_write.sh </div><div class="line"></div><div class="line">The item being checked: /home/biotest/sentinel</div><div class="line"></div><div class="line">The item, /home/biotest/sentinel, does exist.</div><div class="line">But is it a file?</div><div class="line"></div><div class="line">Yes, /home/biotest/sentinel is a file.</div><div class="line">But is it writable ?</div><div class="line"></div><div class="line">The item, /home/biotest/sentinel,is not a writable file</div><div class="line">Unable to write to /home/biotest/sentinel</div></pre></td></tr></table></figure>
<h4 id="检查文件是否可以执行"><a href="#检查文件是否可以执行" class="headerlink" title="检查文件是否可以执行"></a>检查文件是否可以执行</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span>!/bin/bash</div><div class="line"><span class="meta">#</span> testing file execution</div><div class="line"><span class="meta">#</span></div><div class="line">if [ -x test11.sh ]</div><div class="line">then </div><div class="line">    echo "You can run the script: "</div><div class="line">    ./test11.sh</div><div class="line">else</div><div class="line">    echo "Sorry, you are unable to execute the script"</div><div class="line">fi</div></pre></td></tr></table></figure>
<p>运行结果如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~/test$ bash test_ex.sh</div><div class="line">Sorry, you are unable to execute the script</div><div class="line"></div><div class="line">biotest@ubuntu:~/test$ ll test11.sh</div><div class="line">-rw-rw-r-- 1 biotest biotest 195 Apr 27 23:06 test11.sh</div><div class="line">biotest@ubuntu:~/test$ chmod u+x test11.sh</div><div class="line">biotest@ubuntu:~/test$ ll test11.sh</div><div class="line">-rwxrw-r-- 1 biotest biotest 195 Apr 27 23:06 test11.sh*</div><div class="line">biotest@ubuntu:~/test$ bash test_ex.sh </div><div class="line">You can run the script: </div><div class="line">The test value is 5.555</div><div class="line">./test11.sh: line 8: [: 5.555: integer expression expected</div></pre></td></tr></table></figure>
<p>代码及结果解释：代码开头使用了-x参数来判断是滞有权限执行test11.sh脚本，如果有权限就运行这个脚本。在首次运行时，没有权限，随后使用<code>chmod u+x test11.sh</code>命令赋予权限，再次执行，结果显示有权限运行test11.sh这个脚本。</p>
<h4 id="检查所属关系"><a href="#检查所属关系" class="headerlink" title="检查所属关系"></a>检查所属关系</h4><p><code>-O</code>（大写），测试出某个文件的属主，如下所示：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span>!/bin/bash</div><div class="line"><span class="meta">#</span> check file ownership</div><div class="line"><span class="meta">#</span></div><div class="line">if [ -O /etc/passwd ]</div><div class="line">then</div><div class="line">    echo "You are the owner of the /etc/passwd file"</div><div class="line">else</div><div class="line">    echo "Sorry, you are not the owner of the /etc/passwd file"</div><div class="line">fi</div></pre></td></tr></table></figure>
<p>运行结果如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~/test$ bash owner.sh </div><div class="line">Sorry, you are not the owner of the /etc/passwd file</div></pre></td></tr></table></figure>
<p>代码解释：<code>-O</code>田头来测试运行该脚本的用户是否是<code>/etc/passwd</code>文件的属主，这个脚本是运行在普通有入眠账户下的，所以测试失败。</p>
<h4 id="检查默认属组关系"><a href="#检查默认属组关系" class="headerlink" title="检查默认属组关系"></a>检查默认属组关系</h4><p><code>-G</code>比较会检查文件的默认组，如果它匹配了用户的默认组，则测试成功。由于-G比较只会检查默认组而非用户所属的所有组，因此会有一定的局限性，如下所示；</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span>!/bin/bash</div><div class="line"><span class="meta">#</span> check file group test</div><div class="line"><span class="meta">#</span></div><div class="line">if [ -G $HOME/testing ]</div><div class="line">then </div><div class="line">    echo "Your are in the same group as the file"</div><div class="line">else</div><div class="line">    echo "The file is not owned by your gruop"</div><div class="line">fi</div></pre></td></tr></table></figure>
<p>运行脚本，如下所示：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~$ ll testing/  #查看HOME目录下的testing目录详细信息</div><div class="line">drwxr-xr-x 24 biotest biotest 4096 Apr 29 02:55 ../ # testing属于biotest组</div><div class="line">biotest@ubuntu:~$ cd test</div><div class="line">biotest@ubuntu:~/test$ bash group.sh # 运行脚本</div><div class="line">You are in the same group as the file  # testing属于当前biotest组</div><div class="line">biotest@ubuntu:~$ cd</div><div class="line">biotest@ubuntu:~$ sudo chgrp sharing $HOME/testing # 将testing所属的biotest组更改为sharing组</div><div class="line">[sudo] password for biotest: </div><div class="line">biotest@ubuntu:~$ ll testing/</div><div class="line">drwxrwxr-x  2 biotest sharing 4096 Apr 29 00:03 ./</div><div class="line">biotest@ubuntu:~$ cd test</div><div class="line">biotest@ubuntu:~/test$ bash group.sh </div><div class="line">The file is not owned by your gruop # testing就不属于了biotest组</div><div class="line">biotest@ubuntu:~/test$ cd ..</div></pre></td></tr></table></figure>
<h4 id="检查文件日期"><a href="#检查文件日期" class="headerlink" title="检查文件日期"></a>检查文件日期</h4><p>有时候需要比较两个文件的创建日期，<code>-nt</code>比较会判断文件A是否比另外一个文件B新，如果文件A较新，那意味着它的文件创建日期更近。<code>-ot</code>比较会判断一个文件A是否比另外一个文件B旧，如果文件A较旧，则是意味着它的创建日期更早。</p>
<p>先来查看地一下test12.sh文件与test13.sh文件，以及test11.sh和test12.sh文件，如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~/test$ ll test11.sh test12.sh test13.sh</div><div class="line">-rwxrw-r-- 1 biotest biotest 196 Apr 28 20:42 test11.sh*</div><div class="line">-rw-rw-r-- 1 biotest biotest 116 Apr 27 23:14 test12.sh</div><div class="line">-rw-rw-r-- 1 biotest biotest 156 Apr 27 23:17 test13.sh</div></pre></td></tr></table></figure>
<p>由上述结果可以发现，test11.sh文件创建于4.28，20:42；test12.sh文件创建于4.27，23:14，test13.sh文件创建于4.27 ，23:17，现在运行下面的脚本：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span>!/bin/bash</div><div class="line"><span class="meta">#</span> testing file dates</div><div class="line"><span class="meta">#</span></div><div class="line">if [ test12.sh -nt test13.sh ]</div><div class="line">then</div><div class="line">    echo "The test12 file is newer than test13"</div><div class="line">else</div><div class="line">    echo "The test13 file is newer than test12"</div><div class="line">fi</div><div class="line"></div><div class="line">if [ test11.sh -ot test12.sh ]</div><div class="line">then </div><div class="line">    echo "The test11 file is older than the test12 file"</div><div class="line">fi</div></pre></td></tr></table></figure>
<p>运行结果如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~/test$ bash contrast_file.sh </div><div class="line">The test13 file is newer than test12</div></pre></td></tr></table></figure>
<p>代码及结果解释：<code>test12.sh -nt test13.sh</code>这一句用于判断test12是否比test13更新，结果是否，执行<code>then</code>后面的语句，即<code>echo &quot;The test13 file is newer than test12&quot;。</code>结果也显示，test13文件比test12文件更新，因为test13.sh文件创建的时间（2018-4-27-23:17)比test12.sh文件（2018-4-27-23:14)要晚。在第二个<code>if-then</code>语句中，<code>test11.sh -ot test12.sh</code>语句用于判断，test11文件是否比test12文件更老，由于test11.sh文件创建于2018-4-28-20:42；而test12.sh文件创建于2018-4-27-23:14，test11文件比test12文件创建的时候更晚，因此<code>test11.sh -ot test12.sh</code>这个语句不执行。</p>
<p>再补充一个案例，如果要比较的两个文件不存在，如果仅用<code>-nt</code>来判断，那么还会返回结果，如下所示：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span>!/bin/bash</div><div class="line"><span class="meta">#</span> testing file dates</div><div class="line"><span class="meta">#</span></div><div class="line">if [ badfile1 -nt badfile2 ]</div><div class="line">then</div><div class="line">    echo "The badfile1 file is newer than badfile2"</div><div class="line">else</div><div class="line">    echo "The badfile2 file is newer than badfile1"</div><div class="line">fi</div></pre></td></tr></table></figure>
<p>运行后，结果如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~/test$ bash test21.sh</div><div class="line">The badfile2 file is newer than badfile1</div></pre></td></tr></table></figure>
<p>代码运行后，仍然有结果，这就是有问题了，因此在使用<code>-nt</code>时，首先需要判断文件是否存在。</p>
<h2 id="复合条件测试"><a href="#复合条件测试" class="headerlink" title="复合条件测试"></a>复合条件测试</h2><p>在<code>if-then</code>语句中，还可以使用布尔逻辑来组合测试，有两种布尔运算符可以使用，如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">[ condition1 ] &amp;&amp; [ condition2 ] </div><div class="line"># 使用的是AND布尔运行算来组合两个条件，若要执行then后面的语句，两个条件必须都满足</div><div class="line"></div><div class="line">[ condition1 ] || [ condition2 ]</div><div class="line"># 使用OR布尔运算符来组合两个条件，如果任意条件为TRUE，then后面的语句执行</div></pre></td></tr></table></figure>
<h3 id="AND运算符"><a href="#AND运算符" class="headerlink" title="AND运算符"></a>AND运算符</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span>!/bin/bash</div><div class="line"><span class="meta">#</span> testing compound comparisons</div><div class="line"><span class="meta">#</span></div><div class="line">if [ -d $HOME ] &amp;&amp; [ -w $HOME/testing ]</div><div class="line">then</div><div class="line">    echo "The file exists and you can write to it"</div><div class="line">else</div><div class="line">    echo "I cannot write to the file"</div><div class="line">fi</div></pre></td></tr></table></figure>
<p>运行结果如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~/test$ bash test22.sh</div><div class="line">The file exists and you can write to it</div></pre></td></tr></table></figure>
<h2 id="if-then的高级特性"><a href="#if-then的高级特性" class="headerlink" title="if-then的高级特性"></a>if-then的高级特性</h2><p>bash sehll提供了2项可在if-then语句中使用的高级特性，第一：用于数学表达式的双括号；第二：用于高级字符串处理的双方括号。</p>
<h3 id="使用双括号"><a href="#使用双括号" class="headerlink" title="使用双括号"></a>使用双括号</h3><p>双括号命令可以使用户在比较过程中使用高级数学表达式。test命令只能在比较中使用简单的自述操作，而双括号命令提供了更多的数学符号，双括号的命令格式为<code>(( expressiton ))</code>。其中<code>expresstion</code>可以是任意的数学赋值或比较表达式，除了test命令使用的标准数学运算答外，下表列出了双括号命令中会用到的其他运算符，如下所示：</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>符号</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>val++</td>
<td>后增</td>
</tr>
<tr>
<td>val—</td>
<td>后减</td>
</tr>
<tr>
<td>++val</td>
<td>先增</td>
</tr>
<tr>
<td>—val</td>
<td>先减</td>
</tr>
<tr>
<td>!</td>
<td>逻辑求反</td>
</tr>
<tr>
<td>~</td>
<td>位求反</td>
</tr>
<tr>
<td>**</td>
<td>幂运算</td>
</tr>
<tr>
<td>&lt;&lt;</td>
<td>左位移</td>
</tr>
<tr>
<td>&gt;&gt;</td>
<td>右位移</td>
</tr>
<tr>
<td>&amp;</td>
<td>位布尔和</td>
</tr>
<tr>
<td>\</td>
<td></td>
<td>位布尔或</td>
</tr>
<tr>
<td>&amp;&amp;</td>
<td>逻辑和</td>
</tr>
<tr>
<td>\</td>
<td>\</td>
<td></td>
<td>逻辑或</td>
</tr>
</tbody>
</table>
</div>
<h4 id="案例：在if语句中使用双括号"><a href="#案例：在if语句中使用双括号" class="headerlink" title="案例：在if语句中使用双括号"></a>案例：在if语句中使用双括号</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span>!/bin/bash</div><div class="line"><span class="meta">#</span> using double parenthesis</div><div class="line"><span class="meta">#</span></div><div class="line">val1=10</div><div class="line"><span class="meta">#</span></div><div class="line">if (( $val1 **2 &gt; 90))</div><div class="line">then</div><div class="line">    (( val2=$val1**2 ))</div><div class="line">    echo "The square of $val1 is $val2"</div><div class="line">fi</div></pre></td></tr></table></figure>
<p>运行结果如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~/test$ bash test23.sh</div><div class="line">The square of 10 is 100</div></pre></td></tr></table></figure>
<h3 id="使用双方括号"><a href="#使用双方括号" class="headerlink" title="使用双方括号"></a>使用双方括号</h3><p>双方括号命令提供了针对字符串比较的高级特性，双方括号命令的格式为<code>[[ expression ]]</code>，双方括号里的<code>expression</code>使用了test命令中采用的标准字符串比较，但它还有另外的一个特性，即模式匹配（pattern matching）。（注：bash shel对中双方括号的支持很好，但其他的shell未必如此）。</p>
<p>在模式匹配中，用户可以定义一个正则表达式来匹配字符串，如下所示：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span>!/bin/bash</div><div class="line"><span class="meta">#</span> using pattern matching</div><div class="line"><span class="meta">#</span></div><div class="line">if [[ $USER == r* ]]</div><div class="line">then</div><div class="line">    echo "Hello $USER"</div><div class="line">else</div><div class="line">    echo "Sorry, I do not know you"</div><div class="line">fi</div></pre></td></tr></table></figure>
<p>运行结果为：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~/test$ bash test24.sh</div><div class="line">Sorry, I do not know you</div></pre></td></tr></table></figure></p>
<p>如果将其中<code>$USER == r*</code>改为<code>$USER == b*</code>（当前Linux系统中biotest用户，<code>b*</code>这种格式可以查换所有以b开头的用户，运行结果如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~/test$ bash test24.sh</div><div class="line">Hello biotest</div></pre></td></tr></table></figure>
<h2 id="case命令"><a href="#case命令" class="headerlink" title="case命令"></a>case命令</h2><p>如果有一种情况：用户在尝试计算一个变量的值，可以在一组可能的值中寻找特定值。在这种情况下，可以写一段长的<code>if-then-else</code>代码，如下所示：</p>
<h3 id="常规if-then-else代码"><a href="#常规if-then-else代码" class="headerlink" title="常规if-then-else代码"></a>常规<code>if-then-else</code>代码</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span>!/bin/bash</div><div class="line"><span class="meta">#</span> Looking for a possible value</div><div class="line"><span class="meta">#</span></div><div class="line">if [ $USER = "rich" ]</div><div class="line">then</div><div class="line">    echo "Welcome $USER"</div><div class="line">    echo "Please enjoy your visit"</div><div class="line">elif [ $USER = "barbara" ]</div><div class="line">then</div><div class="line">    echo "Welcome $USER"</div><div class="line">    echo "Please enjoy your visit"</div><div class="line">elif [ $USER = "testing" ]</div><div class="line">then</div><div class="line">    echo "Special testing account"</div><div class="line">elif [ $USER = "jessica" ]</div><div class="line">then</div><div class="line">    echo "Do not forget to logout when you're done"</div><div class="line">elif [ $USER = "biotest" ]</div><div class="line">then</div><div class="line">    echo "You are currnet user"</div><div class="line">else</div><div class="line">    echo "Sorry, your are not allowed here"</div><div class="line">fi</div></pre></td></tr></table></figure>
<p>运行结果如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~/test$ bash test25.sh</div><div class="line">You are currnet user</div></pre></td></tr></table></figure>
<p>如果有了<code>case</code>命令，则不需要写出所有的<code>elif</code>语句来不停地检查同一个变量的值，<code>case</code>命令会采用列表格式来检查单个变量的多个值。</p>
<h3 id="case语句"><a href="#case语句" class="headerlink" title="case语句"></a><code>case</code>语句</h3><p><code>case</code>语句的格式如下所示：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">case variable in </div><div class="line">pattern1 | pattern2)  command1;;</div><div class="line">pattern3) commands2;;</div><div class="line">*) default commands;;</div><div class="line">esac</div></pre></td></tr></table></figure>
<p>case命令会将指定的变量与不同械进行比较。如果变量和模式是匹配的，那么shell会执行为该模式指定的命令，可以通过竖线操作符在一行中分隔出多个模式。星号会捕获所有与已知模式不匹配的值，现在将前面的<code>if-then-else</code>代码转换为<code>case</code>形式，如下所示：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span>!/bin/bash</div><div class="line"><span class="meta">#</span> using the case command</div><div class="line"><span class="meta">#</span></div><div class="line">case $USER in </div><div class="line">rich | barbara)</div><div class="line">    echo "Welcome, $USER"</div><div class="line">    echo "Please enjoy your visit";;</div><div class="line">testing)</div><div class="line">    echo "Special testing account";;</div><div class="line">jessica)</div><div class="line">    echo "Do not forget to log off when you're done";;</div><div class="line">biotest)</div><div class="line">    echo "You are current user";;</div><div class="line">*)</div><div class="line">    echo "Sorry, you are not allowed here";;</div><div class="line">esac</div></pre></td></tr></table></figure>
<p>运行结果如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~/test$ bash test26.sh</div><div class="line">You are current user</div></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2018/04/29/Linux/Linux-shell01-基础笔记/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/04/29/Linux/Linux-shell01-基础笔记/" itemprop="url">Shell学习笔记（1）——shell脚本基础笔记</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-04-29T12:10:54+08:00">
                2018-04-29
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Linux/" itemprop="url" rel="index">
                    <span itemprop="name">Linux</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  3,088
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  13
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>本篇笔记的参考资料是（<a href="https://item.jd.com/12010266.html" target="_blank" rel="external">《Linux命令行与shell脚本编程大全》</a>（第3版），外加百度辅助，本篇笔记主要内容是Shell脚本的一些基本知识。</p>
<p>使用命令行的一大特点就是能够写脚本，可以将一些命令写到一个脚本中，自动运行。而在Linux的命令行中，一次基本上只能运行一个或几个命令，就像下面的这样，它可以运行两个命令，只是要用分号隔开。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~/test/testfile$ date;who</div><div class="line">Fri Apr 27 15:56:32 CST 2018</div><div class="line">biotest  tty7         2018-04-27 11:24 (:0)</div></pre></td></tr></table></figure>
<p>这两个命令其实也可以视为一个非常简单的脚本，虽然它只有两个命令，作用就是显示今天的日期以及当前登录到系统中的用户。</p>
<h2 id="创建shell脚本文件"><a href="#创建shell脚本文件" class="headerlink" title="创建shell脚本文件"></a>创建shell脚本文件</h2><p>如果要将shell命令放到文本文件中，就需要一个文本编辑器，Linux中常用的是vim，写好的脚本文件如下所示：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span>!/bin/bash</div><div class="line">date;who</div><div class="line"><span class="meta">#</span> this is comments</div></pre></td></tr></table></figure>
<p>将脚本文件保存，命令为test.sh。</p>
<p>现在解释一下这个脚本：</p>
<p>第1行：写入的是<code>#!/bin/bash</code>，#号是用于注释的，shell并不会处理注释，注释只是起到说明的作用，但第1行是个例外，#!的意思是要告诉shell要到哪个shell来运行，这里指定的是bash。</p>
<p>第2行：在第1行中指定了运行脚本的shell后，就可以输入命令了，输入一个命令后，回车，再输入另外一个命令，或者是用分号隔开两个命令。</p>
<p>命令结束后，输入脚本，如下所示：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~/test/testfile$ test.sh</div><div class="line">test.sh: command not found</div></pre></td></tr></table></figure>
<p>这是因为，shell是通过PATH环境变量来查找命令的，现在test.sh这个脚本文件并不在环境变量PATH中，因此如果要运行这个脚本，只有2种方法：</p>
<p>第一，将shell脚本文件所在的目录添加到PATH环境中；</p>
<p>第二，使用绝对或相对路径引用shell脚本文件。</p>
<p>现在使用第二种方法，如下所示：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~$ test</div><div class="line">biotest@ubuntu:~$</div></pre></td></tr></table></figure>
<p>发现没有反应，此时输入<code>bash test</code>，如下所示：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~/test/testfile$ bash test</div><div class="line">Fri Apr 27 16:19:14 CST 2018</div><div class="line">biotest  tty7         2018-04-27 11:24 (:0)</div></pre></td></tr></table></figure>
<p>test是一个脚本文件，通过<code>ls -lF</code>命令查看发现，test不是一个可执行程序，因此运行这个脚本，需要使用bash test，如果要将它设为可执行文件，则如下操作：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~$ ls -lF test</div><div class="line">-rw-rw-r-- 1 biotest biotest 42 Apr 27 01:28 test</div><div class="line">biotest@ubuntu:~$ chmod u+x test</div><div class="line">biotest@ubuntu:~$ test</div><div class="line">biotest@ubuntu:~$ ./test</div><div class="line">Fri Apr 27 01:29:38 PDT 2018</div><div class="line">biotest  tty7         2018-03-24 03:28 (:0)</div></pre></td></tr></table></figure>
<p>此时输入的是相对路径<code>./test</code>，如果要直接运行，则需要将test添加到环境变量中去，如下操作：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~$ ./test</div><div class="line">Fri Apr 27 01:36:50 PDT 2018</div><div class="line">biotest  tty7         2018-03-24 03:28 (:0)</div><div class="line">biotest@ubuntu:~$ pwd</div><div class="line">/home/biotest</div><div class="line">biotest@ubuntu:~$ echo 'export PATH=$PATH:/home/biotest/'&gt;&gt;~/.bashrc</div><div class="line">biotest@ubuntu:~$ source ~/.bashrc</div><div class="line">biotest@ubuntu:~$ test</div><div class="line">biotest@ubuntu:~$ mv test test.sh</div><div class="line">biotest@ubuntu:~$ test.sh</div><div class="line">Fri Apr 27 01:37:57 PDT 2018</div><div class="line">biotest  tty7         2018-03-24 03:28 (:0)</div></pre></td></tr></table></figure>
<p>添加到环境变量用到了<code>echo &#39;export PATH=$PATH:/home/biotest/&#39;&gt;&gt;~/.bashrc</code>命令，此外，还有一点，test是用shell写的，原来没有后缀名，输入后无法运行，当添加上上了<code>.sh</code>后，可以正常运行，原理现在还不清楚，懂了再写。</p>
<h2 id="显示消息"><a href="#显示消息" class="headerlink" title="显示消息"></a>显示消息</h2><p>多数shell都会产生自己的输出，这些输出会显示脚本所运行的控制台显示器上。很多时候，在自己写脚本时，要添加自己的文本消息来告诉脚本用户正在做什么，需要echo命令，如果在echo命令后面加上一个字符串，就会显示出这个文本字符串，如下所示：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~$ echo This is a test</div><div class="line">This is a test</div><div class="line">biotest@ubuntu:~$ echo "This is a test to see if you're paying attention"</div><div class="line">This is a test to see if you're paying attention</div><div class="line">biotest@ubuntu:~$ ^C</div><div class="line">biotest@ubuntu:~$ echo 'Rich says "scripting is easy".'</div><div class="line">Rich says "scripting is easy".</div></pre></td></tr></table></figure>
<p>从中可以发现：第一，常规情况下字符串并不需要使用引号；第二，如果要使用引号，字符串中间的引号不能与字符串两端的引号重复（即字符串中使用单引号，整个字符串就使用双引号，反之亦然）。</p>
<p>再看一案例，新建一个文件，命名为test1，输入以下代码：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span>!/bin/bash</div><div class="line"><span class="meta">#</span> This script displays the date and who's logged on </div><div class="line">echo The time and date are:</div><div class="line">date</div><div class="line">echo "Let's see who's logged into the system:"</div><div class="line">who</div></pre></td></tr></table></figure>
<p>结果如下所示：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~$ bash test1</div><div class="line">The time and date are:</div><div class="line">Fri Apr 27 03:01:29 PDT 2018</div><div class="line">Let&apos;s see who&apos;s logged into the system:</div><div class="line">biotest  tty7         2018-03-24 03:28 (:0)</div></pre></td></tr></table></figure></p>
<h2 id="使用变量"><a href="#使用变量" class="headerlink" title="使用变量"></a>使用变量</h2><p>环境变量是常见的变量之一，在shell脚本中，也能使用环境变量，只需要在环境㸄前加上美元符号（$）即可，下面的脚本中就使用了一些环境变量，如下所示：<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span>!/bin/bash</div><div class="line"><span class="meta">#</span> display user information from the system.</div><div class="line">echo "User info for userid: $USER"</div><div class="line">echo UID:$UID</div><div class="line">echo HOME: $HOME</div></pre></td></tr></table></figure></p>
<p>运行后结果如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~$ bash test2</div><div class="line">User info for userid: biotest</div><div class="line">UID:1000</div><div class="line">HOME: /home/biotest</div></pre></td></tr></table></figure>
<p>如果在字符串中使用美元符号，如下所示：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~$ echo "The cost of the item is $15"</div><div class="line">The cost of the item is 5</div></pre></td></tr></table></figure>
<p>这里面的美元符号就不会显示，如果要显示的话，需要添加转义字符，如下所示：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~$ echo "The cost of the item is \$15"</div><div class="line">The cost of the item is $15</div></pre></td></tr></table></figure>
<h2 id="用户变量"><a href="#用户变量" class="headerlink" title="用户变量"></a>用户变量</h2><p>用户变量是用户自己定义的一些变量，这些常见的编程语言中的变量大同小异，看下面的案例：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span>!/bin/bash</div><div class="line"><span class="meta">#</span> testing vairbales</div><div class="line">days=10</div><div class="line">guest="Test"</div><div class="line">echo "$guest checked in $days days ago"</div><div class="line">days=5</div><div class="line">guest="Test01"</div><div class="line">echo "$guest checked in $days days ago"</div></pre></td></tr></table></figure>
<p>运行后结果如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~$ bash test3</div><div class="line">Test checked in 10 days ago</div><div class="line">Test01 checked in 5 days ago</div></pre></td></tr></table></figure>
<h3 id="有关美元符号与赋值的另一案例"><a href="#有关美元符号与赋值的另一案例" class="headerlink" title="有关美元符号与赋值的另一案例"></a>有关美元符号与赋值的另一案例</h3><p>如果引用变量不使用美元符号，会将引用的某个变量名称识别为字符串，看下面的案例：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span>!/bin/bash</div><div class="line"><span class="meta">#</span> assigning a variable value to another variable</div><div class="line"></div><div class="line">value1=10</div><div class="line">value2=$value1</div><div class="line">echo The resulting value is $value2</div><div class="line">value3=value1</div><div class="line">echo The resulting value is $value3</div></pre></td></tr></table></figure>
<p>结果如下所示：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~$ bash test4</div><div class="line">The resulting value is 10</div><div class="line">The resulting value is value1</div></pre></td></tr></table></figure></p>
<p>从结果可以看出来，当value2=$value1时，就把变量value1的值10赋值给了value2，当使用value3=value1时，由于没加美元符号，就把value1这个字符串赋值给了value3。</p>
<h2 id="命令替换"><a href="#命令替换" class="headerlink" title="命令替换"></a>命令替换</h2><p>shell脚本有一个重要的功能就是从命令输出中提取信息，并将值赋给某个变量。有2种方法可以将命令输出赋值给某个变量：</p>
<p>第一：使用反引号（`）；<br>第二：使用<code>$()</code>格式。<br>使用这两种方法可以使shell命令的输出赋值给变量，具体用法如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">testing=`date`</div><div class="line"># 或者是</div><div class="line">testing=$(date)</div></pre></td></tr></table></figure>
<p>具体的案例如下所示：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">#!/bin/bash</div><div class="line">testing=$(date)</div><div class="line">echo &quot;The date and time are: &quot; $testing</div></pre></td></tr></table></figure></p>
<p>运行结果如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~$ bash test5</div><div class="line">The date and time are:  Fri Apr 27 07:10:16 PDT 2018</div></pre></td></tr></table></figure>
<p>第二案例：<br>以下的案例就是就是通过命令替换获得当前日期，并用它来生成唯一文件名。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">#!/bin/bash</div><div class="line"># copy the /usr/bin directory listing to a log file</div><div class="line">today=$(date +%y%m%d) </div><div class="line"># there is a blank between +%y%m%d</div><div class="line">ls /usr/bin -al &gt; log.$today</div></pre></td></tr></table></figure>
<p>运行后没有输出信息，但是它会在当前目录下生成一个log文件，名称就是log加上今天的日期（今天是2018年4月27日），则这个文件名称就是log.180427。代码的运行原理是，date命令得到当前日期，经格式化后，赋值给today。关于日期的格式化，可以看下面的案例：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~$ date</div><div class="line">Fri Apr 27 07:21:17 PDT 2018</div><div class="line">biotest@ubuntu:~$ date +%y%m%d</div><div class="line">180427</div></pre></td></tr></table></figure>
<h2 id="重定向输入和输出"><a href="#重定向输入和输出" class="headerlink" title="重定向输入和输出"></a>重定向输入和输出</h2><p>有时候我们会遇到这样的场景，我想把某个命令的输出结果保存到某个文件中，这个文件我可以用于查看，或者是经后来的命令处理。这就用到了重定向，重定向可以用于输入，也可以用于输出。</p>
<h3 id="输出重定向"><a href="#输出重定向" class="headerlink" title="输出重定向"></a>输出重定向</h3><p>最基本的重定向就是将命令的输出发送到一个文件中，bash shell中使用大于号（&gt;）来完成，格式为<code>command &gt; outputfile</code>，如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~$ date &gt; test7</div><div class="line">biotest@ubuntu:~$ ls -l test7</div><div class="line">-rw-rw-r-- 1 biotest biotest 29 Apr 27 07:25 test7</div><div class="line">biotest@ubuntu:~$ less test7</div><div class="line">biotest@ubuntu:~$ cat test7</div><div class="line">Fri Apr 27 07:25:44 PDT 2018</div><div class="line">biotest@ubuntu:~$ who &gt; test7</div><div class="line">biotest@ubuntu:~$ cat test7</div><div class="line">biotest  tty7         2018-03-24 03:28 (:0)</div><div class="line">biotest@ubuntu:~$ date &gt;&gt; test7</div><div class="line">biotest@ubuntu:~$ cat test7</div><div class="line">biotest  tty7         2018-03-24 03:28 (:0)</div><div class="line">Fri Apr 27 07:28:58 PDT 2018</div></pre></td></tr></table></figure>
<p>使用重定向文件创建了一个文件test7，将date命令的输出结果重定向了到了test7中，如果这个文件存在，则重定向的数据会覆盖原来的数据，如果不想覆盖，只是追加，可以使用双大于号。</p>
<h3 id="输入重定向"><a href="#输入重定向" class="headerlink" title="输入重定向"></a>输入重定向</h3><h4 id="常规的输入重定向"><a href="#常规的输入重定向" class="headerlink" title="常规的输入重定向"></a>常规的输入重定向</h4><p>输入重定向和输出重定向正好相反。输入重定向将文件的内容重定向到命令。 输入重定向符号是小于号（&lt;），格式为<code>command &lt; inputfile</code>。<br>如下所示：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~$ cat test7</div><div class="line">biotest  tty7         2018-03-24 03:28 (:0)</div><div class="line">Fri Apr 27 07:28:58 PDT 2018</div><div class="line">biotest@ubuntu:~$ wc &lt; test7</div><div class="line"> 2 11 73</div></pre></td></tr></table></figure></p>
<p>在这个案例中，将test7的内容输入到wc命令中，wc命令可以对数据中的文本进行计数（wc的全称为words count），wc的默认输出有3个值，从左到右分别为：<br>①文本的行数；②文本的词数；③文本的字节数，在前面的案例中，结果就是2行，11个单词，73个字节。</p>
<h4 id="内联输入重定向"><a href="#内联输入重定向" class="headerlink" title="内联输入重定向"></a>内联输入重定向</h4><p>内联输入重定向的英文是inline input redirection，这种方法无需使用文件进行重定向，只需要在命令行中指定用于输入重定向的数据就可以了。内联输入重定向符号是远小于号（&lt;&lt;）。除了这个符号，必须指定一个文本标记来划分输入数据的开始和结尾。任何字符串都可作为文本标记，但在数据的开始和结尾文本标记必须一致，格式为：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">command &lt;&lt; marker </div><div class="line">data </div><div class="line">marker</div></pre></td></tr></table></figure></p>
<p>maker是数据的开始，也是结果，data是位于maker之间的文本文件，看一个案例：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~$ wc &lt;&lt; EOF</div><div class="line">&gt; test string 1</div><div class="line">&gt; test string 2</div><div class="line">&gt; test string 3</div><div class="line">&gt; EOF</div><div class="line"> 3  9 42</div></pre></td></tr></table></figure></p>
<p>当输入wc &lt;&lt; EOF时，命令行会自动变成大于号，接着输入内容，输入完毕后，再输入EOF表示结束，此时命令开始运行，结果为3，9， 42.</p>
<h2 id="管道"><a href="#管道" class="headerlink" title="管道"></a>管道</h2><p>管道的使用场景为，将命令A的输出结果导入到命令B，使A的结果成为B的输入。其实这样可以通过重定向实现，但是太麻烦，管道就是出于此目的而设计的。</p>
<p>举个例子：统计当前的文件数有多少个。</p>
<p>先看一下重定向是如何实现的：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~$ ls &gt; filename</div><div class="line">biotest@ubuntu:~$ cat filename</div><div class="line">Desktop</div><div class="line">Documents</div><div class="line">Downloads</div><div class="line">examples.desktop</div><div class="line">filename</div><div class="line">log.</div><div class="line">log.180427</div><div class="line">miniconda2</div><div class="line">Miniconda2-latest-Linux-x86_64.sh</div><div class="line">Music</div><div class="line">Pictures</div><div class="line">Public</div><div class="line">Templates</div><div class="line">test1</div><div class="line">test2</div><div class="line">test3</div><div class="line">test4</div><div class="line">test5</div><div class="line">test6</div><div class="line">test7</div><div class="line">test8</div><div class="line">test.sh</div><div class="line">Videos</div><div class="line">biotest@ubuntu:~$ wc filename</div><div class="line"> 23  23 210 filename</div></pre></td></tr></table></figure></p>
<p>使用重定向就是，先用ls列出当前的文件名，重定向到filename文件，然后使用wc命令来统计。</p>
<p>再看一下管道命令：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~$ ls|wc</div><div class="line">     23      23     210</div><div class="line">biotest@ubuntu:~$</div></pre></td></tr></table></figure></p>
<p>管道命令通过一条竖线，将ls的结果导入到wc中。</p>
<h2 id="退出脚本"><a href="#退出脚本" class="headerlink" title="退出脚本"></a>退出脚本</h2><p>shell中运行的每个命令都是使用退出状态码（exit status）告诉shell它已经运行完毕，退出状态码是一个0~255的号数值，在命令结束运行时，由命令传给shell。</p>
<h3 id="查看退出状态码"><a href="#查看退出状态码" class="headerlink" title="查看退出状态码"></a>查看退出状态码</h3><p>Linux提供了一个专门的变量<code>$?</code> 来保存上个已执行命令的退出状态码。对于需要进行检查的 命令，必须在其运行完毕后立刻查看或使用 $? 变量。它的值会变成由shell所执行的最后一条命令的退出状态码。 </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~$ date</div><div class="line">Fri Apr 27 07:52:45 PDT 2018</div><div class="line">biotest@ubuntu:~$ echo $?</div><div class="line">0</div></pre></td></tr></table></figure>
<p>通常一个成功结束的命令的退出状态码是0，如果命令结束时有错误，这个代码就是一个正整数，如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~$ asd</div><div class="line">No command &apos;asd&apos; found, but there are 22 similar ones</div><div class="line">asd: command not found</div><div class="line">biotest@ubuntu:~$ echo $?</div><div class="line">127</div></pre></td></tr></table></figure>
<h3 id="exit命令"><a href="#exit命令" class="headerlink" title="exit命令"></a>exit命令</h3><p>exit 命令允许你在脚本结束时指定一个退出状态码，如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">#!/bin/bash</div><div class="line"># testing the exit status</div><div class="line">var1=10</div><div class="line">var2=30</div><div class="line">var3=$[$var1 + $var2]</div><div class="line">echo The answer is $var3</div><div class="line">exit 5</div></pre></td></tr></table></figure>
<p>运行后，结果如下所示：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~$ bash test9</div><div class="line">The answer is 40</div><div class="line">biotest@ubuntu:~$ echo $?</div><div class="line">5</div></pre></td></tr></table></figure></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2018/04/28/Linux/Linux环境变量/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/04/28/Linux/Linux环境变量/" itemprop="url">Linux环境变量</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-04-28T12:10:54+08:00">
                2018-04-28
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Linux/" itemprop="url" rel="index">
                    <span itemprop="name">Linux</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  5,555
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  21
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="1-什么是shell？"><a href="#1-什么是shell？" class="headerlink" title="1. 什么是shell？"></a>1. 什么是shell？</h3><p>答：在计算机科学中，Shell俗称壳（用来区别于核，核是指“内核”），Shell是指“提供使用者使用界面”的软件（命令解析器）。它类似于DOS下的command.com和后来的cmd.exe。它接收用户命令，然后调用相应的应用程序。</p>
<p>在很多并不正式的场合，这两个名词表达的意思相同，即命令解释器。但从严格的意义上讲，命令行是指供用户输入命令的界面，其本身只是接受输入，然后把命令传递给命令解释器，后者就是Shell，从本质上讲，Shell是一个程序，它在用户和操作系统之间提供了一个面向行的可交互接口，用户在命令行中输入命令，运行在后台的Shell把命令转换成指令代码发送给操作系统。Shell并非只有命令行这一种形式，例如GNOME、KDE等图形界面也是Shell，不过它们是GUI Shell，都是为了解决人机交互的问题。</p>
<p>目前在Linux环境下有几种不同类型的Shell，常用的有Bourne Again Shell（BASH）、TCSH Shell、Z-Shell。不同的Shell提供不同的语法和特性。</p>
<p>例如在Ubuntu中，可以在<code>etc/passwd</code>文件中查看到自己的默认shell程序，如下所示：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~$ cat /etc/passwd |grep biotest</div><div class="line">biotest:x:1000:1000:UBUNTU,,,:/home/biotest:/bin/bash</div></pre></td></tr></table></figure>
<p>由上述结果可知，biotest用户所用到shell是bash。bash shell程序位于/bin目录内，从长列表中可以看出<code>/bin/bash</code>是一个可执行程序：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~$ ls -lF /bin/bash</div><div class="line">-rwxr-xr-x 1 root root 1037528 May 16  2017 /bin/bash*</div></pre></td></tr></table></figure>
<p>注：在Linux系统中，当使用ls，添加了-F参数时，会在每个输出项后追加文件的类型标识符，具体含义为：“*”表示具有可执行权限的普通文件，“/”表示目录，“@”表示符号链接，“|”表示命令管道FIFO，“=”表示sockets套接字。当文件为普通文件时，不输出任何标识符；</p>
<h3 id="2-什么是bash？"><a href="#2-什么是bash？" class="headerlink" title="2. 什么是bash？"></a>2. 什么是bash？</h3><p>答：bash相当于shell中的某个，shell的范围更广。bash的全称是Bourne again / born again。</p>
<h3 id="3-什么是环境变量？"><a href="#3-什么是环境变量？" class="headerlink" title="3. 什么是环境变量？"></a>3. 什么是环境变量？</h3><p>答：shell 在 shell 会话中保存着大量信息。这些信息被称为 (shell 的) 环境。 程序获取环境中的数据（即环境变量）来了解本机的配置。虽然大多数程序用配置文件来存储程序设置， 一些程序会根据环境变量来调整他们的行为。Linux是一个多用户的操作系统。每个用户登录系统后，都会有一个专用的运行环境。 通常每个用户默认的环境都是相同的，这个默认环境实际上就是一组环境变量的定义。 环境变量是全局的，设置好的环境变量可以被所有当前用户所运行的程序所使用。 用户可以对自己的运行环境进行定制，其方法就是修改相应的系统环境变量。在bash shell中，环境变量分为两类，分别为全局变量，局部变量。</p>
<p>shell 在环境中存储了两种基本类型的数据，虽然 bash 几乎无法分辨这些数据的类型。 它们是环境变量和 shell 变量。Shell 变量是 bash 存放的少量数据。剩下的都是 环境变量。除了变量，shell 也存储了一些可编程的数据，即别名和 shell 函数。</p>
<h3 id="4-如何查看环境变量？"><a href="#4-如何查看环境变量？" class="headerlink" title="4. 如何查看环境变量？"></a>4. 如何查看环境变量？</h3><p>答：<code>printenv</code>可以显示全局变量，如下所示：</p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/professional/180421/f429H66haH.png?imageslim" alt="mark"><br>上述的内容是环境变量及其数值列表，环境变量通常是大写字母，这主要是为了与用户的变量进行区分，例如我们可以看到USER=biotest这行代码，就表示当前的用户是biotest，用<code>printenv</code>命令也可以查看当前用户，如下所示：</p>
<blockquote>
<p>biotest@ubuntu:~$ printenv USER<br>biotest</p>
</blockquote>
<h4 id="通过echo来查看变量的值，如下所示："><a href="#通过echo来查看变量的值，如下所示：" class="headerlink" title="通过echo来查看变量的值，如下所示："></a>通过echo来查看变量的值，如下所示：</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~$ echo $HOME</div><div class="line">/home/biotest</div><div class="line">biotest@ubuntu:~/miniconda2/opt$ echo $PWD # PWD是显示当前目录</div><div class="line">/home/biotest/miniconda2/opt</div></pre></td></tr></table></figure>
<h4 id="的作用"><a href="#的作用" class="headerlink" title="$的作用"></a>$的作用</h4><p>在echo命令中，在变量名前加上<code>$</code>就能显示当前变量的值，它也能让变量作为命令行参数，如下所示：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~/miniconda2/opt$ ls $HOME</div><div class="line">biosoft    Downloads         Miniconda2-latest-Linux-x86_64.sh  Public     Videos</div><div class="line">Desktop    examples.desktop  Music                              Templates</div><div class="line">Documents  miniconda2        Pictures                           test</div></pre></td></tr></table></figure>
<h4 id="设置局部用户定义变量"><a href="#设置局部用户定义变量" class="headerlink" title="设置局部用户定义变量"></a>设置局部用户定义变量</h4><p>一旦启动了bash  shell（或者执行一个shell脚本），就能创建在这个shell进程内可见的局部变量了。可以通过等号给环境变量赋值，值可以是数值或字符串，需要注意的是，在shell中，变量名，等号和值之间没有空格，否则会出错，如下所示：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~/miniconda2/opt$ echo $mywords</div><div class="line"></div><div class="line">biotest@ubuntu:~/miniconda2/opt$ mywords=hello</div><div class="line">biotest@ubuntu:~/miniconda2/opt$ echo $mywords</div><div class="line">hello</div></pre></td></tr></table></figure>
<p>如果要给变量赋值一个含有空格的字符串，必须要加上单绰号来界定字符串的首和尾，如下所示：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~/miniconda2/opt$ mywords=Hello linux</div><div class="line">linux: command not found</div><div class="line">biotest@ubuntu:~/miniconda2/opt$ mywords="Hello linux"</div><div class="line">biotest@ubuntu:~/miniconda2/opt$ echo $mywords</div><div class="line">Hello linux</div></pre></td></tr></table></figure>
<p>设置了局部变量后，就能在shell进程的任何地方使用它了，但是，如果生成了另外一个shell，在它的子shell中就无法使用。类似地，如果在子进程中设置了一个局部变量，一旦退出了子进程，那个局部环境变量就无法使用。</p>
<h4 id="设置全局环境变量"><a href="#设置全局环境变量" class="headerlink" title="设置全局环境变量"></a>设置全局环境变量</h4><p>在设定全局环境变量的进程所创建的子进程中，该变量都是可见的。创建全局环境变量的方法是先创建一个局部环境变量，然后再把它导出到全局环境中。，这个过程是通过<code>export</code>命令实现的，变量名前面不加<code>$</code>，如下所示：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~$ my_words="I love Linux"</div><div class="line">biotest@ubuntu:~$ export my_words</div><div class="line">biotest@ubuntu:~$ echo $mywords</div><div class="line">Hello linux</div><div class="line">biotest@ubuntu:~$ bash</div><div class="line">bbiotest@ubuntu:~$ echo $my_words</div><div class="line">I love Linux</div></pre></td></tr></table></figure>
<p>在定义了my_words变量后，用bash命令启动了一个子shell，在空上子shell中能够显示变量my_words的值，这是因为export命令将其设为了全局变量。</p>
<p>修改子shell中全局环境变量的值并不会影响你shell中该变量的值，如下所示：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~$ echo $my_words</div><div class="line">I love Linux</div><div class="line">biotest@ubuntu:~$ bash</div><div class="line">biotest@ubuntu:~$ echo $my_words</div><div class="line">I love Linux</div><div class="line">biotest@ubuntu:~$ my_words="I love Ubuntu"</div><div class="line">biotest@ubuntu:~$ echo $my_words</div><div class="line">I love Ubuntu</div><div class="line">biotest@ubuntu:~$ exit</div><div class="line">exit</div><div class="line">biotest@ubuntu:~$ exit</div><div class="line">exit</div><div class="line">biotest@ubuntu:~$ ps</div><div class="line">   PID TTY          TIME CMD</div><div class="line"> 20142 pts/4    00:00:00 bash</div><div class="line"> 20318 pts/4    00:00:00 ps</div><div class="line">biotest@ubuntu:~$ echo $my_words</div><div class="line">I love Linux</div></pre></td></tr></table></figure>
<p>子shell也无法通export命令改变父shell中全局变量的值。</p>
<h4 id="删除环境变量"><a href="#删除环境变量" class="headerlink" title="删除环境变量"></a>删除环境变量</h4><p>删除环境变量使用<code>unset</code>命令，前面不加<code>$</code>符号，如下所示：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~$ echo $my_words</div><div class="line">I love Linux</div><div class="line">biotest@ubuntu:~$ unset my_words</div><div class="line">biotest@ubuntu:~$ echo $my_words</div><div class="line"></div><div class="line">biotest@ubuntu:~$</div></pre></td></tr></table></figure>
<p>在涉及变量名时，什么时候使用<script type="math/tex">`，什么时候不使用`</script>，只需要这样记忆：要具体地查看变量的值时，就需要<script type="math/tex">`符号，如果不需要查看变量的值，只针对变量本身操作，就不使用`</script>符号。</p>
<h3 id="5-setprintenv都可以查看系统变量，它们有什么区别？"><a href="#5-setprintenv都可以查看系统变量，它们有什么区别？" class="headerlink" title="5. setprintenv都可以查看系统变量，它们有什么区别？"></a>5. setprintenv都可以查看系统变量，它们有什么区别？</h3><p>答：（1）通过<code>set</code>可以设置shell选项，如果只输入set而不加任何参数，它就会显示shell 变量，环境变量，和定义的 shell 函数，此时与printenv命令类似，与 printenv 命令不同的是，set 命令的输出很友好地按照首字母顺序排列，如下所示：</p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/professional/180421/Hc4BKfI9eL.png?imageslim" alt="mark"><br>如上图所示，当使用没有带选项和参数的 set 命令时，shell 变量，环境变量，和定义的 shell 函数都会被显示。不同于 printenv 命令，set 命令的输出很友好地按照首字母顺序排列。<br>（2）set命令显示当前shell的变量，包括当前用户的变量；printenv（输入env也可以）命令只显示当前用户的变量。每个shell有自己特有的变量（set）显示的变量，这个和用户变量是不同的，当前用户变量和你用什么shell无关，不管你用什么shell都在，比如HOME,SHELL等这些变量，但shell自己的变量不同shell是不同的，比如BASH_ARGC， BASH等，这些变量只有set才会显示，是bash特有的。</p>
<h3 id="6-环境变量存放在哪个地方？"><a href="#6-环境变量存放在哪个地方？" class="headerlink" title="6. 环境变量存放在哪个地方？"></a>6. 环境变量存放在哪个地方？</h3><p>答：当你进入系统的时候，linux 就会为你读入系统的环境变量，这些环境变量存放在什么地方，那就是环境变量的文件中。Linux 中有很多记载环境变量的文件，它们被系统读入是按照一定的顺序的，这些文件包括以下部分：</p>
<h4 id="6-1-etc-profile："><a href="#6-1-etc-profile：" class="headerlink" title="6.1 /etc/profile："></a>6.1 <code>/etc/profile</code>：</h4><p>此文件是bash shell默认的主启动文件，只要登录了Linux，bash就会执行/etc/profile启动文件中的命令，该文件存储的是整个系统的环境变量，它为每个用户设置环境信息，这个文件只有root才能修改。当用户第一次登录时，该文件被执行。并从/etc/profile.d目录的配置文件中搜集shell 的设置。这个文件，是任何用户登陆操作系统以后都会读取的文件（如果用户的shell 是csh 、tcsh 、zsh ，则不会读取此文件），用于获取系统的环境变量，只在登陆的时候读取一次。</p>
<h4 id="6-2-etc-bashrc："><a href="#6-2-etc-bashrc：" class="headerlink" title="6.2/etc/bashrc："></a>6.2<code>/etc/bashrc</code>：</h4><p>在执行完/etc/profile 内容之后，如果用户的Shell运行的是bash ，那么接着就会执行此文件。另外，当每次一个新的bash shell 被打开时, 该文件被读取。每个使用bash的用户在登陆以后执行完/etc/profile 中内容以后都会执行此文件，在新开一个bash 的时候也会执行此文件。因此，如果你想让每个使用bash 的用户每新开一个bash 和每次登陆都执行某些操作，或者给他们定义一些新的环境变量，就可以在这个里面设置。<br>注：<code>/etc/profile</code>，<code>/etc/bashrc</code> 是系统全局环境变量设定</p>
<h4 id="6-3-HOME-bashrc："><a href="#6-3-HOME-bashrc：" class="headerlink" title="6.3$HOME/.bashrc："></a>6.3<code>$HOME/.bashrc</code>：</h4><p>该文件包含专用于单个人的bash shell 的bash 信息，当登录时以及每次打开一个新的shell 时, 该该文件被读取。 单个用户此文件的修改会影响到他以后的每一次登陆系统和每一次新开一个bash 。因此，可以在这里设置单个用户的特殊的环境变量或者特殊的操作，那么每次它新登陆系统或者新开一个bash ，都会去获取相应的特殊的环境变量和特殊操作。</p>
<h4 id="6-4-HOME-bash-profile："><a href="#6-4-HOME-bash-profile：" class="headerlink" title="6.4$HOME/.bash_profile："></a>6.4<code>$HOME/.bash_profile</code>：</h4><p>每个用户都可使用该文件输入专用于自己使用的shell 信息。当用户登录时，该文件仅仅执行一次，默认情况下，它设置一些环境变量，执行用户的.bashrc 文件。单个用户此文件的修改只会影响到他以后的每一次登陆系统。因此，可以在这里设置单个用户的特殊的环境变量或者特殊的操作，那么它在每次登陆的时候都会去获取这些新的环境变量或者做某些特殊的操作，但是仅仅在登陆时。<br><code>~/.bashrc</code>和<code>~/.bash_profile</code>都只对当前的用户永久生效，也就是说假如用户A设置了些类环境变量，这个环境变量只有A才能使用，而对于其他的B，C，D等用户来说，这个变量是不存在的。在根目录下，通过<code>ls -a</code>可以查看这两个文件，正常情况下，这两个文件是隐藏的。</p>
<h4 id="6-5-HOME-bash-logout："><a href="#6-5-HOME-bash-logout：" class="headerlink" title="6.5$HOME/.bash_logout："></a>6.5<code>$HOME/.bash_logout</code>：</h4><p>当每次退出系统( 退出bash shell) 时, 执行该文件。</p>
<h3 id="7-bashrc和-bash-profile的区别是什么？"><a href="#7-bashrc和-bash-profile的区别是什么？" class="headerlink" title="7. ~/.bashrc和~/.bash_profile的区别是什么？"></a>7. <code>~/.bashrc</code>和<code>~/.bash_profile</code>的区别是什么？</h3><p>答：原则上来说，设置自己的环境变量时，在这两个文件中任意选一个即可，它们的区别在于：<code>~/.bash_profile</code>是交互式login方式进入bash shell运行而<code>~/ .bashrc</code>是交互式non-login方式进入bash shell运行。二者设置大致相同。通俗点说，就是<code>.bash_profile</code>文件只会在用户登录的时候读取一次，而<code>.bashrc</code>在每次打开终端进行一次新的会话时都会读取。</p>
<h4 id="登录-shell-会读取一个或多个启动文件的总结"><a href="#登录-shell-会读取一个或多个启动文件的总结" class="headerlink" title="登录 shell 会读取一个或多个启动文件的总结:"></a>登录 shell 会读取一个或多个启动文件的总结:</h4><div class="table-container">
<table>
<thead>
<tr>
<th>文件</th>
<th>内容</th>
</tr>
</thead>
<tbody>
<tr>
<td>/etc/profile</td>
<td>应用于所有用户的全局配置脚本。</td>
</tr>
<tr>
<td>$HOME/.bash_profile</td>
<td>用户个人的启动文件。可以用来扩展或重写全局配置脚本中的设置。</td>
</tr>
<tr>
<td>$HOME/.bash_login</td>
<td>如果文件 ~/.bash_profile 没有找到，bash 会尝试读取这个脚本。</td>
</tr>
<tr>
<td>$HOME/.profile</td>
<td>如果文件 ~/.bash_profile 或文件 ~/.bash_login 都没有找到，bash 会试图读取这个文件。 这是基于 Debian  发行版的默认设置，比方说 Ubuntu。</td>
</tr>
</tbody>
</table>
</div>
<p>非登录 shell 会话会读取以下启动文件：</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>文件</th>
<th>内容</th>
</tr>
</thead>
<tbody>
<tr>
<td>/etc/bash.bashrc</td>
<td>应用于所有用户的全局配置文件。</td>
</tr>
<tr>
<td>~/.bashrc</td>
<td>用户个人的启动文件。可以用来扩展或重写全局配置脚本中的设置。</td>
</tr>
</tbody>
</table>
</div>
<p>在普通用户看来，文件 ~/.bashrc 可能是最重要的启动文件，因为它几乎总是被读取。非登录 shell 默认 会读取它，并且大多数登录 shell 的启动文件会以能读取 ~/.bashrc 文件的方式来书写。</p>
<h3 id="8-如何查看某个变量的内容？"><a href="#8-如何查看某个变量的内容？" class="headerlink" title="8. 如何查看某个变量的内容？"></a>8. 如何查看某个变量的内容？</h3><p>答：如果只查看某个变量的内容，用echo，如下所示：<br><img src="http://ortxpw68f.bkt.clouddn.com/professional/180421/EEDi017BBh.png?imageslim" alt="mark"></p>
<h3 id="9-什么是临时有效的环境变量？"><a href="#9-什么是临时有效的环境变量？" class="headerlink" title="9. 什么是临时有效的环境变量？"></a>9. 什么是临时有效的环境变量？</h3><p>答：临时有效的环境变量就是只对当前的shell有效，当我们退出登录或者关闭终端再打开时，这个环境变量就会消失，它是临时的，设置方法是直接使用<code>export</code>命令来添加，如下所示：</p>
<blockquote>
<p>biotest@ubuntu:~$ export Words=”Hello, world!”<br>biotest@ubuntu:~$ echo $Words<br>Hello, world!<br>biotest@ubuntu:~</p>
</blockquote>
<h3 id="10-如何查看地自定义的别名？"><a href="#10-如何查看地自定义的别名？" class="headerlink" title="10. 如何查看地自定义的别名？"></a>10. 如何查看地自定义的别名？</h3><p>答：通过set或printenv无法查看通过alias命名的别名，此时需要通过alias来查看，如下所示：</p>
<blockquote>
<p>alias egrep=’egrep —color=auto’<br>alias fgrep=’fgrep —color=auto’<br>alias grep=’grep —color=auto’<br>alias l=’ls -CF’<br>alias la=’ls -A’<br>alias ll=’ls -alF’<br>alias ls=’ls —color=auto’</p>
</blockquote>
<h3 id="11-Shell中的一些大写字母是什么意思？"><a href="#11-Shell中的一些大写字母是什么意思？" class="headerlink" title="11. Shell中的一些大写字母是什么意思？"></a>11. Shell中的一些大写字母是什么意思？</h3><p>答：这些大写字母表示一些特殊的环境变量，如下所示：</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>变量</th>
<th>内容</th>
</tr>
</thead>
<tbody>
<tr>
<td>DISPLAY</td>
<td>如果你正在运行图形界面环境，那么这个变量就是你显示器的名字。通常，它是  “:0”， 意思是由 X 产生的第一个显示器。</td>
</tr>
<tr>
<td>EDITOR</td>
<td>文本编辑器的名字。</td>
</tr>
<tr>
<td>SHELL</td>
<td>shell  程序的名字。</td>
</tr>
<tr>
<td>HOME</td>
<td>用户家目录。</td>
</tr>
<tr>
<td>LANG</td>
<td>定义了字符集以及语言编码方式。</td>
</tr>
<tr>
<td>OLD_PWD</td>
<td>先前的工作目录。</td>
</tr>
<tr>
<td>PAGER</td>
<td>页输出程序的名字。这经常设置为/usr/bin/less。</td>
</tr>
<tr>
<td>PATH</td>
<td>由冒号分开的目录列表，当你输入可执行程序名后，会搜索这个目录列表。</td>
</tr>
<tr>
<td>PS1</td>
<td>Prompt  String 1. 这个定义了你的 shell 提示符的内容。随后我们可以看到，这个变量 内容可以全面地定制。</td>
</tr>
<tr>
<td>PWD</td>
<td>当前工作目录。</td>
</tr>
<tr>
<td>TERM</td>
<td>终端类型名。类  Unix 的系统支持许多终端协议；这个变量设置你的终端仿真器所用的协议。</td>
</tr>
<tr>
<td>TZ</td>
<td>指定你所在的时区。大多数类  Unix 的系统按照协调时间时 (UTC) 来维护计算机内部的时钟 ，然后应用一个由这个变量指定的偏差来显示本地时间。</td>
</tr>
<tr>
<td>USER</td>
<td>你的用户名</td>
</tr>
</tbody>
</table>
</div>
<h3 id="12-设置环境变量常用的指令有哪些"><a href="#12-设置环境变量常用的指令有哪些" class="headerlink" title="12. 设置环境变量常用的指令有哪些?"></a>12. 设置环境变量常用的指令有哪些?</h3><p>答:常用的命令有<code>echo</code>,<code>export</code>,<code>env</code>,<code>set</code>,<code>unset</code>，<code>readonly</code>等，如下所示：</p>
<h4 id="1-echo"><a href="#1-echo" class="headerlink" title="(1)echo"></a>(1)<code>echo</code></h4><p>查看某个环境变量．</p>
<h4 id="２-env"><a href="#２-env" class="headerlink" title="(２)env"></a>(２)<code>env</code></h4><p>查看所有环境变量</p>
<h4 id="３-set"><a href="#３-set" class="headerlink" title="(３)set"></a>(３)<code>set</code></h4><p>查看本地定义的所有shell变量．</p>
<h4 id="４-unset"><a href="#４-unset" class="headerlink" title="(４)unset"></a>(４)<code>unset</code></h4><p>删除一个环境变量，例如：</p>
<blockquote>
<p>biotest@ubuntu:~$ export Words=”Hello, world!”<br>biotest@ubuntu:~$ echo $Words<br>Hello, world!<br>biotest@ubuntu:~$ unset Words<br>biotest@ubuntu:~$ echo $Words<br>biotest@ubuntu:~$ </p>
</blockquote>
<h4 id="5-readonly"><a href="#5-readonly" class="headerlink" title="(5)readonly"></a>(5)<code>readonly</code></h4><p>设置只读环境变量．</p>
<h3 id="13-如何将某程序的目录添加到环境变量？"><a href="#13-如何将某程序的目录添加到环境变量？" class="headerlink" title="13. 如何将某程序的目录添加到环境变量？"></a>13. 如何将某程序的目录添加到环境变量？</h3><p>答：当在shell中输入一个外部命令时,shell就会搜索系统来找到相应的程序,<code>PATH</code>这个环境变量就是定义用于命令和程序查找的目录,通过<code>echo $PATH</code>可以查看环境变量，如下所示：<br><img src="http://ortxpw68f.bkt.clouddn.com/professional/180421/H7kICbk6jf.png?imageslim" alt="mark"></p>
<p>在<code>PATH</code>变量中，可以看到许多由冒号（黄色方框标出的部分）分开的路径。每个冒号就是一个路径，这些搜索路径都是一些可以找到可执行程序的目录列表。当我们输入一个指令时，shell会先检查命令是否是内部命令，不是的话会再检查这个命令是否是一个应用程序。然后shell会试着从这些搜索路径，即PATH（上图中路径）中寻找这些应用程序。如果shell在这些路径目录里没有找到可执行文件。则会报错。若找到，shell内部命令或应用程序将被分解为系统调用并传给Linux内核。在某些时候,我们在Linux中安装了软件,如果没有把软件的可执行文件路径添加到PATH中去的话，要执行某个程序，就需要输入全路径，非常不方便，因此我们需要把软件的安装目录添加到PATH变量中。</p>
<h4 id="PATH环境变量的一个案例"><a href="#PATH环境变量的一个案例" class="headerlink" title="PATH环境变量的一个案例"></a><code>PATH</code>环境变量的一个案例</h4><ol>
<li>创建一个可执行文件<br>在<code>/mnt/hgfs/biotest</code>这个目录下建立一个<code>test.py</code>文件，输入以下内容：</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env python3</span></div><div class="line"></div><div class="line">print(<span class="string">"hello, world"</span>)</div></pre></td></tr></table></figure>
<p>保存，退出。<br>然后将这个文件权限修改为可执行，如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">chmod +x test.py</div></pre></td></tr></table></figure>
<ol>
<li><p>测试相对路径与绝对路径调用<br>在当前目录下打开客户端，如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&gt;biotest@ubuntu:/mnt/hgfs/biotest$ ./test.py # 相对路径调用</div><div class="line">&gt;hello, world</div><div class="line">&gt;biotest@ubuntu:/mnt/hgfs/biotest$ </div><div class="line">&gt;biotest@ubuntu:/mnt/hgfs/biotest$ cd</div><div class="line">&gt;biotest@ubuntu:/mnt/hgfs/biotest/test.py # 绝对路径调用</div><div class="line">&gt;hello, world</div></pre></td></tr></table></figure>
</li>
<li><p>未添加到环境变量PATH时的情况<br>此时，<code>test.py</code>文件并没添加到<code>PATH</code>的环境变量中，因此直接输入<code>test.py</code>会出错，如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt;biotest@ubuntu:$ test.py</div><div class="line">&gt;test.py: command not found</div></pre></td></tr></table></figure>
</li>
<li><p>将文件的路径添加到环境变量PATH<br>通过设置PATH环境变量，直接用文件名调用： </p>
</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&gt;biotest@ubuntu:$export PATH=$PATH:/mnt/hgfs/biotest</div><div class="line">&gt;biotest@ubuntu:$ test.py</div><div class="line">&gt;hello, world</div><div class="line">&gt;biotest@ubuntu:$</div></pre></td></tr></table></figure>
<p>注：在添加路径到环境变量时，用到了<code>export</code>，它的用法是<code>export PATH=$PATH:路径</code>，或<code>export $PATH=&quot;路径”</code></p>
<ol>
<li>永久将文件路径添加到环境变量<br>此时，将这个客户端关闭，再打开，试着输入<code>test.py</code>，发现出错了，如下所示：<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt;biotest@ubuntu:$ test.py</div><div class="line">&gt;test.py: command not found</div></pre></td></tr></table></figure>
</li>
</ol>
<p>因为在第4步中，<code>export PATH=$PATH:/mnt/hgfs/biotest</code>只是一种临时添加到环境变量的方法，如果要每次打开客户端时，都能直接执行<code>test.py</code>，则需要将目录添加到.bashrc文件中，步骤如下：<br>第一，输入<code>biotest@ubuntu:/$ vi ~/.bashrc</code>打开bashrc文件；<br>第二，移到bashrc文件的最末端，按<code>I</code>，切换到编辑模式，输入<code>export PATH=/mnt/hgfs/biotest:$PATH</code>，再按<code>Esc</code>键，输入<code>wq</code>，回车，退出；<br>第三，输入<code>source ~/.bashrc</code>，刷新文件，此时，再输入<code>test.py</code>，如下所示：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt;biotest@ubuntu:$ test.py</div><div class="line">&gt;hello, world</div></pre></td></tr></table></figure></p>
<p>把客户端关闭或者是重启电脑，再次输入<code>test.py</code>也能够执行，用<code>export</code>查看一下环境变量，如下所示：<br><img src="http://ortxpw68f.bkt.clouddn.com/professional/180421/lfJc52FL4H.png?imageslim" alt="mark"><br>可以发现，test.py所在的目录在环境变量中。</p>
<p>如果觉得打开<code>~/.bashrc</code>文件，添加环境变量太麻烦了，可以直接在命令行模式下面进行添加，现在将原来的那个test.py文件拷到另外一个目录（<code>~/Downloads</code>）下面，并把文件名字进行修改，改为<code>test2.py</code>，此时输入以下命令即可：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">echo &apos;export PATH=$PATH:~/Downloads&apos;&gt;&gt;~/.bashrc &amp;&amp; source ~/.bashrc</div></pre></td></tr></table></figure></p>
<p>运行过程如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~/Downloads$ ./test2.py #相对路径运行</div><div class="line">hello, world</div><div class="line">biotest@ubuntu:~/Downloads$ echo &apos;export PATH=$PATH:~/Downloads&apos;&gt;&gt;~/.bashrc &amp;&amp; source ~/.bashrc #将路径添加到环境变量，直接运行；；</div><div class="line">biotest@ubuntu:~/Downloads$ test2.py</div><div class="line">hello, world</div></pre></td></tr></table></figure>
<p>通过echo还可以添加alias，如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">echo &quot;alias lh=&apos;ls -lh&apos;&quot; &gt;&gt; ~/.bashrc &amp;&amp; source ~/.bashrc</div></pre></td></tr></table></figure>
<p>运行过程如下所示：<br><img src="http://ortxpw68f.bkt.clouddn.com/professional/180421/0fJGD9KkA1.png?imageslim" alt="mark"></p>
<h3 id="什么是非交互式shell？"><a href="#什么是非交互式shell？" class="headerlink" title="什么是非交互式shell？"></a>什么是非交互式shell？</h3><p>答：在命令行中输入bash命令，这就是交互式shell，系统执行shell脚本时则是非交互式shell，不同的地方就在于非交互式shell没有命令行提示答。bash shell有一个环境变量即，<code>BASH_ENV</code>环境变量，当shell启动一个非交互式shell进程时，它会检查这个环境变量来查提要执行的启动文件，如果有指定的文件，shell会执行该文件里的命令，这通常包括shell脚本变量设置。这个环境㸄在默认情况下并没有设置，输入<code>printenv BASH_ENV</code>不会返回任何信息。如果BASH_ENV没有设置，shell脚本获取环境变量的过程是这样的：shell脚本是通过启动一个子shell来执行的，子shell可以继承父shell导出过的变量，举例来说，如果父shell是登录shell，在<code>etc/profile</code>、<code>/etc/profile.d/*.sh</code>和<code>$HOME/.bashrc</code>文件中设置并导出了变量，用于执行脚本的子shell就能够继池在这些变量。需要注意的是，父shell设置但并未导出的变量都是局部变量，子shell无法继承局部变量。</p>
<h3 id="什么是数组变量？"><a href="#什么是数组变量？" class="headerlink" title="什么是数组变量？"></a>什么是数组变量？</h3><p>答：环境变量有一个很有用的特性就是它们可以作为数组使用，数组是能够储存多个值的变量，这些值可以单独引用，也可以作为整个数组来引物，要给某个环境变量设置多个值，可以把值放在括号里，值与值之间用空格分隔，如下所示：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~$ mytest=(one two three four five)</div><div class="line">biotest@ubuntu:~$ echo $mytest</div><div class="line">one</div><div class="line">biotest@ubuntu:~$ echo $&#123;mytest[2]&#125;</div><div class="line">three</div><div class="line">biotest@ubuntu:~$ echo $&#123;mytest[0]&#125;</div><div class="line">one</div><div class="line">biotest@ubuntu:~$ echo $&#123;mytest[*]&#125;</div><div class="line">one two three four five</div><div class="line">biotest@ubuntu:~$ unset mytest[2]</div><div class="line">biotest@ubuntu:~$ echo $&#123;mytest[*]&#125;</div><div class="line">one two four five</div><div class="line">biotest@ubuntu:~$ echo $&#123;mytest[3]&#125;</div><div class="line">four</div><div class="line">biotest@ubuntu:~$ echo $&#123;mytest[*]&#125;</div><div class="line">one two four five</div><div class="line">biotest@ubuntu:~$ unset mytest</div><div class="line">biotest@ubuntu:~$ echo $&#123;mytest[*]&#125;</div></pre></td></tr></table></figure>
<p>从上面结果可以知道，数组变量有这样的特点：①如果只输入变量的名称，只返回第1个元素的值；②如果要显其余的变量的值，格式为<code>echo ${mytest[n]}</code>，其中n是元素的索引，它是从0开始的，如果要显示全部的内容，需要输入星号（*）；③如果要删除数组变量中间的某个元素，删除后，原变量的索引不变；④</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2018/04/12/Python/Python学习笔记（10）-输入输入与文件及目录操作/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/04/12/Python/Python学习笔记（10）-输入输入与文件及目录操作/" itemprop="url">Python学习笔记（10）-文件、目录和输入输出操作</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-04-12T12:00:00+08:00">
                2018-04-12
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Python/" itemprop="url" rel="index">
                    <span itemprop="name">Python</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  4,774
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  20
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="读取键盘的输入"><a href="#读取键盘的输入" class="headerlink" title="读取键盘的输入"></a>读取键盘的输入</h2><p>Python提供了<code>input()</code>内置函数从标准输入读入一行文本，默认的标准输入是键盘。<code>input</code>可以接收一个Python表达式作为输入，并将运算结果返回，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">biotest@biotest-VirtualBox:~/python3/<span class="number">03</span>file$ cat input.py </div><div class="line"><span class="comment">#!/usr/bin/python3</span></div><div class="line"></div><div class="line">str=input(<span class="string">"Please input:  "</span>)</div><div class="line">print(<span class="string">"What you input is: "</span>,str)</div><div class="line">biotest@biotest-VirtualBox:~/python3/<span class="number">03</span>file$ python3 input.py </div><div class="line">Please input:  Hello</div><div class="line">What you input <span class="keyword">is</span>:  Hello</div></pre></td></tr></table></figure>
<h2 id="文件的读取"><a href="#文件的读取" class="headerlink" title="文件的读取"></a>文件的读取</h2><p><code>open()</code>将会返回一个file对象，基本语法格式为<code>open(filename,mode)</code>，其中<code>filename</code>：包含了你要访问的文件名称的字符串值。<code>mode</code>决定了打开文件的模式，打开文件的模式有：①只读；②写入；③追加。这个参数是非强制的，默认文件访问模式为只读<code>(r)</code>。不同模式打开文件的完全列表：</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>模式</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>r</td>
<td>以只读方式打开文件。文件的指针将会放在文件的开头。这是默认模式。</td>
</tr>
<tr>
<td>rb</td>
<td>以二进制格式打开一个文件用于只读。文件指针将会放在文件的开头。</td>
</tr>
<tr>
<td>r+</td>
<td>打开一个文件用于读写。文件指针将会放在文件的开头。</td>
</tr>
<tr>
<td>rb+</td>
<td>以二进制格式打开一个文件用于读写。文件指针将会放在文件的开头。</td>
</tr>
<tr>
<td>w</td>
<td>打开一个文件只用于写入。如果该文件已存在则将其覆盖。如果该文件不存在，创建新文件。</td>
</tr>
<tr>
<td>wb</td>
<td>以二进制格式打开一个文件只用于写入。如果该文件已存在则将其覆盖。如果该文件不存在，创建新文件。</td>
</tr>
<tr>
<td>w+</td>
<td>打开一个文件用于读写。如果该文件已存在则将其覆盖。如果该文件不存在，创建新文件。</td>
</tr>
<tr>
<td>wb+</td>
<td>以二进制格式打开一个文件用于读写。如果该文件已存在则将其覆盖。如果该文件不存在，创建新文件。</td>
</tr>
<tr>
<td>a</td>
<td>打开一个文件用于追加。如果该文件已存在，文件指针将会放在文件的结尾。也就是说，新的内容将会被写入到已有内容之后。如果该文件不存在，创建新文件进行写入。</td>
</tr>
<tr>
<td>ab</td>
<td>以二进制格式打开一个文件用于追加。如果该文件已存在，文件指针将会放在文件的结尾。也就是说，新的内容将会被写入到已有内容之后。如果该文件不存在，创建新文件进行写入。</td>
</tr>
<tr>
<td>a+</td>
<td>打开一个文件用于读写。如果该文件已存在，文件指针将会放在文件的结尾。文件打开时会是追加模式。如果该文件不存在，创建新文件用于读写。</td>
</tr>
<tr>
<td>ab+</td>
<td>以二进制格式打开一个文件用于追加。如果该文件已存在，文件指针将会放在文件的结尾。如果该文件不存在，创建新文件用于读写。</td>
</tr>
</tbody>
</table>
</div>
<p>下图总结了这几种模式（出处：<a href="http://www.runoob.com/python3/python3-inputoutput.html" target="_blank" rel="external">菜鸟教程</a>）：</p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/professional/180523/ilf5lkh0lA.png?imageslim" alt="mark"></p>
<div class="table-container">
<table>
<thead>
<tr>
<th>模式</th>
<th>r</th>
<th>r+</th>
<th>w</th>
<th>w+</th>
<th>a</th>
<th>a+</th>
</tr>
</thead>
<tbody>
<tr>
<td>读</td>
<td>+</td>
<td>+</td>
<td></td>
<td>+</td>
<td></td>
<td>+</td>
</tr>
<tr>
<td>写</td>
<td></td>
<td>+</td>
<td>+</td>
<td>+</td>
<td>+</td>
<td>+</td>
</tr>
<tr>
<td>创建</td>
<td></td>
<td></td>
<td>+</td>
<td>+</td>
<td>+</td>
<td>+</td>
</tr>
<tr>
<td>覆盖</td>
<td></td>
<td></td>
<td>+</td>
<td>+</td>
<td></td>
<td></td>
</tr>
<tr>
<td>指针在开始</td>
<td>+</td>
<td>+</td>
<td>+</td>
<td>+</td>
<td></td>
<td></td>
</tr>
<tr>
<td>指针在结尾</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>+</td>
<td>+</td>
</tr>
</tbody>
</table>
</div>
<h3 id="文件读写案例"><a href="#文件读写案例" class="headerlink" title="文件读写案例"></a>文件读写案例</h3><p>下面的代码会将一些字符串写入到文件<code>foo.txt</code>中，代码如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">biotest@biotest-VirtualBox:~/python3/<span class="number">03</span>file$ cat write.py</div><div class="line"><span class="comment">#!/usr/bin/python3</span></div><div class="line"></div><div class="line"><span class="comment"># open a file</span></div><div class="line"><span class="comment"># If this file does not exist, python will create it</span></div><div class="line"><span class="comment"># You can use absolute path or current path;</span></div><div class="line">f = open(<span class="string">"foo.txt"</span>,<span class="string">"w"</span>)</div><div class="line">f.write(<span class="string">"Python is a good program language.\n Yes, it is very good!\n"</span>)</div><div class="line">f.close()</div><div class="line"></div><div class="line">biotest@biotest-VirtualBox:~/python3/<span class="number">03</span>file$ python3 write.py </div><div class="line">biotest@biotest-VirtualBox:~/python3/<span class="number">03</span>file$ ls</div><div class="line">foo.txt  input.py  write.py</div><div class="line">biotest@biotest-VirtualBox:~/python3/<span class="number">03</span>file$ cat foo.txt </div><div class="line">Python <span class="keyword">is</span> a good program language.</div><div class="line"> Yes, it <span class="keyword">is</span> very good!</div></pre></td></tr></table></figure>
<p>代码解释：<code>open()</code>括号中是文件路径，如果不指明绝对路径，则就会默认为当前目录；如果文件存在，就打开，如果不存在，代码会创建这个文件。</p>
<h2 id="文件对象的方法"><a href="#文件对象的方法" class="headerlink" title="文件对象的方法"></a>文件对象的方法</h2><h3 id="file对象常用函数"><a href="#file对象常用函数" class="headerlink" title="file对象常用函数"></a>file对象常用函数</h3><p>file对象使用open函数来创建，下表列出了file对象常用的函数：</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>序号</th>
<th>方法及描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>file.close()：关闭文件。关闭后文件不能再进行读写操作。</td>
</tr>
<tr>
<td>2</td>
<td>file.flush()：刷新文件内部缓冲，直接把内部缓冲区的数据立刻写入文件,   而不是被动的等待输出缓冲区写入。</td>
</tr>
<tr>
<td>3</td>
<td>file.fileno()：返回一个整型的文件描述符(file   descriptor FD 整型), 可以用在如os模块的read方法等一些底层操作上。</td>
</tr>
<tr>
<td>4</td>
<td>file.isatty()：如果文件连接到一个终端设备返回   True，否则返回 False。</td>
</tr>
<tr>
<td>5</td>
<td>file.next()：返回文件下一行。</td>
</tr>
<tr>
<td>6</td>
<td>file.read([size])：从文件读取指定的字节数，如果未给定或为负则读取所有。</td>
</tr>
<tr>
<td>7</td>
<td>file.readline([size])：读取整行，包括   “\n” 字符。</td>
</tr>
<tr>
<td>8</td>
<td>file.readlines([sizeint])：读取所有行并返回列表，若给定sizeint&gt;0，返回总和大约为sizeint字节的行,   实际读取值可能比 sizeint 较大, 因为需要填充缓冲区。</td>
</tr>
<tr>
<td>9</td>
<td>file.seek(offset[,   whence])：设置文件当前位置</td>
</tr>
<tr>
<td>10</td>
<td>file.tell()：返回文件当前位置。</td>
</tr>
<tr>
<td>11</td>
<td>file.truncate([size])：从文件的首行首字符开始截断，截断文件为   size 个字符，无 size 表示从当前位置截断；截断之后后面的所有字符被删除，其中 Widnows 系统下的换行代表2个字符大小。</td>
</tr>
<tr>
<td>12</td>
<td>file.write(str)：将字符串写入文件，没有返回值。</td>
</tr>
<tr>
<td>13</td>
<td>file.writelines(sequence)：向文件写入一个序列字符串列表，如果需要换行则要自己加入每行的换行符。</td>
</tr>
</tbody>
</table>
</div>
<h3 id="f-read"><a href="#f-read" class="headerlink" title="f.read()"></a>f.read()</h3><p>为了读取一个文件的内容，调用<code>f.read(size)</code>,这将读取一定数目的数据,然后作为字符串或字节对象返回。<code>size</code>是一个可选的数字类型的参数。当<code>size</code>被忽略了或者为负,那么该文件的所有内容都将被读取并且返回，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">biotest@biotest-VirtualBox:~/python3/<span class="number">03</span>file$ cat foo.txt</div><div class="line">Python <span class="keyword">is</span> a good program language.</div><div class="line"> Yes, it <span class="keyword">is</span> very good!</div><div class="line">biotest@biotest-VirtualBox:~/python3/<span class="number">03</span>file$ cat read.py </div><div class="line"><span class="comment">#!/usr/bin/python3</span></div><div class="line"></div><div class="line"><span class="comment"># open a file</span></div><div class="line">f = open(<span class="string">"foo.txt"</span>,<span class="string">"r"</span>)</div><div class="line"></div><div class="line">str=f.read()</div><div class="line">print(str)</div><div class="line">f.close()</div><div class="line">biotest@biotest-VirtualBox:~/python3/<span class="number">03</span>file$ python3 read.py </div><div class="line">Python <span class="keyword">is</span> a good program language.</div><div class="line"> Yes, it <span class="keyword">is</span> very good!</div></pre></td></tr></table></figure>
<h3 id="f-readline"><a href="#f-readline" class="headerlink" title="f.readline()"></a>f.readline()</h3><p><code>f.readline()</code>会从文件中读取单独的一行，换行符为<code>\n</code>，<code>f.readline()</code>如果返回一个空字符串，说明已经读取到了最后一下，看下面的案例：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">biotest@biotest-VirtualBox:~/python3/<span class="number">03</span>file$ cat foo.txt </div><div class="line">Python <span class="keyword">is</span> a good program language.</div><div class="line"> Yes, it <span class="keyword">is</span> very good!</div><div class="line">biotest@biotest-VirtualBox:~/python3/<span class="number">03</span>file$ cat readline.py </div><div class="line"><span class="comment">#!/usr/bin/python3</span></div><div class="line"></div><div class="line">f=open(<span class="string">"foo.txt"</span>,<span class="string">"r"</span>)</div><div class="line"></div><div class="line">str=f.readline()</div><div class="line">print(str)</div><div class="line">f.close()</div><div class="line">biotest@biotest-VirtualBox:~/python3/<span class="number">03</span>file$ python3 readline.py </div><div class="line">Python <span class="keyword">is</span> a good program language.</div></pre></td></tr></table></figure>
<h3 id="f-readlines"><a href="#f-readlines" class="headerlink" title="f.readlines()"></a>f.readlines()</h3><p><code>f.readlines()</code>将返回该文件中包含的所有行。如果设置可选参数<code>sizehint</code>,则读取指定长度的字节,并且将这些字节按行分割，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">biotest@biotest-VirtualBox:~/python3/<span class="number">03</span>file$ cat foo.txt </div><div class="line">Python <span class="keyword">is</span> a good program language.</div><div class="line"> Yes, it <span class="keyword">is</span> very good!</div><div class="line">biotest@biotest-VirtualBox:~/python3/<span class="number">03</span>file$ cat readlines.py </div><div class="line"><span class="comment">#!/usr/bin/python3</span></div><div class="line"></div><div class="line">f = open(<span class="string">"foo.txt"</span>,<span class="string">"r"</span>)</div><div class="line">str=f.readlines()</div><div class="line">print(str)</div><div class="line">f.close()</div><div class="line">biotest@biotest-VirtualBox:~/python3/<span class="number">03</span>file$ python3 readlines.py </div><div class="line">[<span class="string">'Python is a good program language.\n'</span>, <span class="string">' Yes, it is very good!\n'</span>]</div></pre></td></tr></table></figure>
<p>另外一种读取文件内容的方式就是对文件中的行进行迭代，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">biotest@biotest-VirtualBox:~/python3/<span class="number">03</span>file$ cat foo.txt </div><div class="line">Python <span class="keyword">is</span> a good program language.</div><div class="line"> Yes, it <span class="keyword">is</span> very good!</div><div class="line">biotest@biotest-VirtualBox:~/python3/<span class="number">03</span>file$ cat iteration.py </div><div class="line"><span class="comment">#!/usr/bin/python3</span></div><div class="line">f=open(<span class="string">"foo.txt"</span>,<span class="string">"r"</span>)</div><div class="line"></div><div class="line"><span class="keyword">for</span> line <span class="keyword">in</span> f:</div><div class="line">    print(line,end=<span class="string">" "</span>)</div><div class="line"></div><div class="line">f.close()</div><div class="line">biotest@biotest-VirtualBox:~/python3/<span class="number">03</span>file$ python3 iteration.py </div><div class="line">Python <span class="keyword">is</span> a good program language.</div><div class="line">  Yes, it <span class="keyword">is</span> very good!</div></pre></td></tr></table></figure>
<h3 id="f-write"><a href="#f-write" class="headerlink" title="f.write()"></a>f.write()</h3><p>f.write(string)会将string写入到文件中，然后返回写入的字符数，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">biotest@biotest-VirtualBox:~/python3/<span class="number">03</span>file$ cat foo.txt </div><div class="line">Python <span class="keyword">is</span> a good program language.</div><div class="line"> Yes, it <span class="keyword">is</span> very good!</div><div class="line">biotest@biotest-VirtualBox:~/python3/<span class="number">03</span>file$ cat f_write.py </div><div class="line"><span class="comment">#!/usr/bin/python3</span></div><div class="line"></div><div class="line">f = open(<span class="string">"foo.txt"</span>,<span class="string">"w"</span>)</div><div class="line"></div><div class="line">num = f.write(<span class="string">"Python is a good tool.\n Yes, it is good!\n"</span>)</div><div class="line">print(num)</div><div class="line">f.close()</div><div class="line">biotest@biotest-VirtualBox:~/python3/<span class="number">03</span>file$ python3 f_write.py </div><div class="line"><span class="number">41</span></div><div class="line">biotest@biotest-VirtualBox:~/python3/<span class="number">03</span>file$ cat foo.txt </div><div class="line">Python <span class="keyword">is</span> a good tool.</div><div class="line"> Yes, it <span class="keyword">is</span> good!</div></pre></td></tr></table></figure>
<p>如果要写入一些非字符串的东西, 那么将需要先进行转换，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">biotest@biotest-VirtualBox:~/python3/<span class="number">03</span>file$ cat string_trans.py </div><div class="line"><span class="comment">#!/usr/bin/python3</span></div><div class="line"></div><div class="line">f = open(<span class="string">"foo1.txt"</span>,<span class="string">"w"</span>)</div><div class="line">value = (<span class="string">'www.runoob.com'</span>,<span class="number">14</span>)</div><div class="line">s = str(value)+<span class="string">"\n"</span></div><div class="line">f.write(s)</div><div class="line">f.close()</div><div class="line">biotest@biotest-VirtualBox:~/python3/<span class="number">03</span>file$ python3 string_trans.py </div><div class="line">biotest@biotest-VirtualBox:~/python3/<span class="number">03</span>file$ cat foo1.txt </div><div class="line">(<span class="string">'www.runoob.com'</span>, <span class="number">14</span>)</div></pre></td></tr></table></figure>
<h3 id="f-tell"><a href="#f-tell" class="headerlink" title="f.tell()"></a>f.tell()</h3><p><code>f.tell()</code>返回文件对象当前所处的位置,它是从文件开头开始算起的字节数。</p>
<h3 id="f-seek"><a href="#f-seek" class="headerlink" title="f.seek()"></a>f.seek()</h3><p>如果要改变文件当前的位置,可以使用<code>f.seek(offset,from_what)</code>函数。<br><code>from_what</code>的值,如果是0表示开头,如果是1表示当前位置,2表示文件的结尾，例如：</p>
<ol>
<li>seek(x,0)：从起始位置即文件首行首字符开始移动x个字符</li>
<li>seek(x,1)：表示从当前位置往后移动x个字符</li>
<li>seek(-x,2)：表示从文件的结尾往前移动x个字符</li>
<li>from_what值为默认为0，即文件开头。</li>
</ol>
<p>看下面的案例：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>f=open(<span class="string">'foo.txt'</span>,<span class="string">'rb+'</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>f.write(<span class="string">b'0123456789abcdef'</span>)</div><div class="line"><span class="number">16</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>f.seek(<span class="number">5</span>)</div><div class="line"><span class="number">5</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>f.read(<span class="number">1</span>)</div><div class="line"><span class="string">b'5'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>f.seek(<span class="number">-3</span>,<span class="number">2</span>)</div><div class="line"><span class="number">38</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>f.read(<span class="number">1</span>)</div><div class="line"><span class="string">b'd'</span></div></pre></td></tr></table></figure></p>
<h3 id="f-close"><a href="#f-close" class="headerlink" title="f.close()"></a>f.close()</h3><p>在文本文件中(那些打开文件的模式下没有<code>b</code>的)，只会相对于文件起始位置进行定位。当你处理完一个文件后，调用<code>f.close()</code>来关闭文件并释放系统的资源，如果尝试再调用该文件，则会抛出异常，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>f.close()</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>f.read()</div><div class="line">Traceback (most recent call last):</div><div class="line">  File <span class="string">"&lt;stdin&gt;"</span>, line <span class="number">1</span>, <span class="keyword">in</span> &lt;module&gt;</div><div class="line">ValueError: read of closed file</div></pre></td></tr></table></figure>
<p>当处理一个文件对象时,使用<code>with</code>关键字是非常好的方式。在结束后,它会帮你正确的关闭文件，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">with</span> open(<span class="string">'foo.txt'</span>,<span class="string">'r'</span>) <span class="keyword">as</span> f:</div><div class="line"><span class="meta">... </span>    read_data = f.read()</div><div class="line"><span class="meta">... </span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>f.closed</div><div class="line"><span class="keyword">True</span></div></pre></td></tr></table></figure>
<h2 id="pickle模块"><a href="#pickle模块" class="headerlink" title="pickle模块"></a>pickle模块</h2><p>python的pickle模块实现了基本的数据序列和反序列化。通过pickle模块的序列化操作我们能够将程序中运行的对象信息保存到文件中去，永久存储。通过pickle模块的反序列化操作，我们能够从文件中创建上一次程序保存的对象。基本接口如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pickle.dump(obj, file, [,protocol])</div></pre></td></tr></table></figure>
<p>有了 pickle 这个对象, 就能对 file 以读取的形式打开，即<code>x = pickle.load(file0</code>)。file表示类文件对象，它有<code>read()</code>和<code>readline()</code>接口，看下面的案例：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line">biotest@biotest-VirtualBox:~/python3/<span class="number">03</span>file$ cat pickly.py </div><div class="line"><span class="comment">#!/usr/bin/python3</span></div><div class="line"></div><div class="line"><span class="keyword">import</span> pickle</div><div class="line"></div><div class="line"><span class="comment"># using pickle module to save data object to a file</span></div><div class="line">data1 = &#123;<span class="string">'a'</span>:[<span class="number">1</span>,<span class="number">2.0</span>,<span class="number">3</span>,<span class="number">4</span>+<span class="number">6j</span>],</div><div class="line">        <span class="string">'b'</span>:(<span class="string">'string'</span>,<span class="string">u'Unicode string'</span>),</div><div class="line">        <span class="string">'c'</span>:<span class="keyword">None</span>&#125;</div><div class="line"></div><div class="line">selfref_list = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]</div><div class="line">selfref_list.append(selfref_list)</div><div class="line"></div><div class="line">output = open(<span class="string">'data.pkl'</span>,<span class="string">'wb'</span>)</div><div class="line"></div><div class="line"><span class="comment"># Pickle dictionary using protocol 0.</span></div><div class="line">pickle.dump(data1,output)</div><div class="line"></div><div class="line"><span class="comment"># Pickle th elist using the highest protocol available.</span></div><div class="line">pickle.dump(selfref_list,output,<span class="number">-1</span>)</div><div class="line"></div><div class="line">output.close()</div><div class="line">biotest@biotest-VirtualBox:~/python3/<span class="number">03</span>file$ python3 pickly.py </div><div class="line">biotest@biotest-VirtualBox:~/python3/<span class="number">03</span>file$ ls</div><div class="line">data.pkl  foo.txt     input.py      pickly.py    readline.py   read.py  string_trans.py</div><div class="line">foo1.txt  f_write.py  iteration.py  __pycache__  readlines.py  seek.py  write.py</div></pre></td></tr></table></figure>
<p>在当前目录下生成了一个<code>data.pkl</code>文件，打开后是乱码，现在不清楚这个文件什么意思，接着还有一段代码，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">biotest@biotest-VirtualBox:~/python3/<span class="number">03</span>file$ cat pickle2.py </div><div class="line"><span class="comment">#!/usr/bin/python3</span></div><div class="line"><span class="keyword">import</span> pprint, pickle</div><div class="line"></div><div class="line">pkl_file = open(<span class="string">'data.pkl'</span>,<span class="string">'rb'</span>)</div><div class="line"></div><div class="line">data1 = pickle.load(pkl_file)</div><div class="line">pprint.pprint(data1)</div><div class="line"></div><div class="line">data2 = pickle.load(pkl_file)</div><div class="line">pprint.pprint(data2)</div><div class="line"></div><div class="line">pkl_file.close()</div><div class="line"></div><div class="line">biotest@biotest-VirtualBox:~/python3/<span class="number">03</span>file$ python3 pickle2.py</div><div class="line">&#123;<span class="string">'a'</span>: [<span class="number">1</span>, <span class="number">2.0</span>, <span class="number">3</span>, (<span class="number">4</span>+<span class="number">6j</span>)], <span class="string">'b'</span>: (<span class="string">'string'</span>, <span class="string">'Unicode string'</span>), <span class="string">'c'</span>: <span class="keyword">None</span>&#125;</div><div class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, &lt;Recursion on list <span class="keyword">with</span> id=<span class="number">140696236160136</span>&gt;]</div></pre></td></tr></table></figure>
<p> 上述代码解释：</p>
<h2 id="目录操作"><a href="#目录操作" class="headerlink" title="目录操作"></a>目录操作</h2><p>Python中的目录操作有这些：</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>序号</th>
<th>方法及描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>os.access(path, mode)：检验权限模式</td>
</tr>
<tr>
<td>2</td>
<td>os.chdir(path)：改变当前工作目录</td>
</tr>
<tr>
<td>3</td>
<td>os.chflags(path,   flags)：设置路径的标记为数字标记。</td>
</tr>
<tr>
<td>4</td>
<td>os.chmod(path, mode)：更改权限</td>
</tr>
<tr>
<td>5</td>
<td>os.chown(path, uid, gid)：更改文件所有者</td>
</tr>
<tr>
<td>6</td>
<td>os.chroot(path)：改变当前进程的根目录</td>
</tr>
<tr>
<td>7</td>
<td>os.close(fd)：关闭文件描述符 fd</td>
</tr>
<tr>
<td>8</td>
<td>os.closerange(fd_low,   fd_high)：关闭所有文件描述符，从 fd_low (包含) 到 fd_high (不包含), 错误会忽略</td>
</tr>
<tr>
<td>9</td>
<td>os.dup(fd)：复制文件描述符 fd</td>
</tr>
<tr>
<td>10</td>
<td>os.dup2(fd, fd2)：将一个文件描述符 fd   复制到另一个 fd2</td>
</tr>
<tr>
<td>11</td>
<td>os.fchdir(fd)：通过文件描述符改变当前工作目录</td>
</tr>
<tr>
<td>12</td>
<td>os.fchmod(fd,   mode)：改变一个文件的访问权限，该文件由参数fd指定，参数mode是Unix下的文件访问权限。</td>
</tr>
<tr>
<td>13</td>
<td>os.fchown(fd, uid,   gid)：修改一个文件的所有权，这个函数修改一个文件的用户ID和用户组ID，该文件由文件描述符fd指定。</td>
</tr>
<tr>
<td>14</td>
<td>os.fdatasync(fd)：强制将文件写入磁盘，该文件由文件描述符fd指定，但是不强制更新文件的状态信息。</td>
</tr>
<tr>
<td>15</td>
<td>os.fdopen(fd[, mode[,   bufsize]])：通过文件描述符 fd 创建一个文件对象，并返回这个文件对象</td>
</tr>
<tr>
<td>16</td>
<td>os.fpathconf(fd,   name)：返回一个打开的文件的系统配置信息。name为检索的系统配置的值，它也许是一个定义系统值的字符串，这些名字在很多标准中指定（POSIX.1,   Unix 95, Unix 98, 和其它）。</td>
</tr>
<tr>
<td>17</td>
<td>os.fstat(fd)：返回文件描述符fd的状态，像stat()。</td>
</tr>
<tr>
<td>18</td>
<td>os.fstatvfs(fd)：返回包含文件描述符fd的文件的文件系统的信息，像   statvfs()</td>
</tr>
<tr>
<td>19</td>
<td>os.fsync(fd)：强制将文件描述符为fd的文件写入硬盘。</td>
</tr>
<tr>
<td>20</td>
<td>os.ftruncate(fd,   length)：裁剪文件描述符fd对应的文件, 所以它最大不能超过文件大小。</td>
</tr>
<tr>
<td>21</td>
<td>os.getcwd()：返回当前工作目录</td>
</tr>
<tr>
<td>22</td>
<td>os.getcwdu()：返回一个当前工作目录的Unicode对象</td>
</tr>
<tr>
<td>23</td>
<td>os.isatty(fd)：如果文件描述符fd是打开的，同时与tty(-like)设备相连，则返回true,   否则False。</td>
</tr>
<tr>
<td>24</td>
<td>os.lchflags(path,   flags)：设置路径的标记为数字标记，类似 chflags()，但是没有软链接</td>
</tr>
<tr>
<td>25</td>
<td>os.lchmod(path, mode)：修改连接文件权限</td>
</tr>
<tr>
<td>26</td>
<td>os.lchown(path, uid,   gid)：更改文件所有者，类似 chown，但是不追踪链接。</td>
</tr>
<tr>
<td>27</td>
<td>os.link(src, dst)：创建硬链接，名为参数   dst，指向参数 src</td>
</tr>
<tr>
<td>28</td>
<td>os.listdir(path)：返回path指定的文件夹包含的文件或文件夹的名字的列表。</td>
</tr>
<tr>
<td>29</td>
<td>os.lseek(fd, pos, how)：设置文件描述符   fd当前位置为pos, how方式修改: SEEK_SET 或者 0 设置从文件开始的计算的pos; SEEK_CUR或者 1 则从当前位置计算;   os.SEEK_END或者2则从文件尾部开始. 在unix，Windows中有效</td>
</tr>
<tr>
<td>30</td>
<td>os.lstat(path)：像stat(),但是没有软链接</td>
</tr>
<tr>
<td>31</td>
<td>os.major(device)：从原始的设备号中提取设备major号码   (使用stat中的st_dev或者st_rdev field)。</td>
</tr>
<tr>
<td>32</td>
<td>os.makedev(major,   minor)：以major和minor设备号组成一个原始设备号</td>
</tr>
<tr>
<td>33</td>
<td>os.makedirs(path[,   mode])：递归文件夹创建函数。像mkdir(), 但创建的所有intermediate-level文件夹需要包含子文件夹。</td>
</tr>
<tr>
<td>34</td>
<td>os.minor(device)：从原始的设备号中提取设备minor号码   (使用stat中的st_dev或者st_rdev field )。</td>
</tr>
<tr>
<td>35</td>
<td>os.mkdir(path[,   mode])：以数字mode的mode创建一个名为path的文件夹.默认的 mode 是 0777 (八进制)。</td>
</tr>
<tr>
<td>36</td>
<td>os.mkfifo(path[,   mode])：创建命名管道，mode 为数字，默认为 0666 (八进制)</td>
</tr>
<tr>
<td>37</td>
<td>os.mknod(filename[, mode=0600,   device])：创建一个名为filename文件系统节点（文件，设备特别文件或者命名pipe）。</td>
</tr>
<tr>
<td>38</td>
<td>os.open(file, flags[,   mode])：打开一个文件，并且设置需要的打开选项，mode参数是可选的</td>
</tr>
<tr>
<td>39</td>
<td>os.openpty()：打开一个新的伪终端对。返回 pty 和   tty的文件描述符。</td>
</tr>
<tr>
<td>40</td>
<td>os.pathconf(path,   name)：返回相关文件的系统配置信息。</td>
</tr>
<tr>
<td>41</td>
<td>os.pipe()：创建一个管道. 返回一对文件描述符(r, w)   分别为读和写</td>
</tr>
<tr>
<td>42</td>
<td>os.popen(command[, mode[,   bufsize]])：从一个 command 打开一个管道</td>
</tr>
<tr>
<td>43</td>
<td>os.read(fd, n)：从文件描述符 fd 中读取最多 n   个字节，返回包含读取字节的字符串，文件描述符 fd对应文件已达到结尾, 返回一个空字符串。</td>
</tr>
<tr>
<td>44</td>
<td>os.readlink(path)：返回软链接所指向的文件</td>
</tr>
<tr>
<td>45</td>
<td>os.remove(path)：删除路径为path的文件。如果path   是一个文件夹，将抛出OSError; 查看下面的rmdir()删除一个 directory。</td>
</tr>
<tr>
<td>46</td>
<td>os.removedirs(path)：递归删除目录。</td>
</tr>
<tr>
<td>47</td>
<td>os.rename(src, dst)：重命名文件或目录，从 src   到 dst</td>
</tr>
<tr>
<td>48</td>
<td>os.renames(old,   new)：递归地对目录进行更名，也可以对文件进行更名。</td>
</tr>
<tr>
<td>49</td>
<td>os.rmdir(path)：删除path指定的空目录，如果目录非空，则抛出一个OSError异常。</td>
</tr>
<tr>
<td>50</td>
<td>os.stat(path)：获取path指定的路径的信息，功能等同于C   API中的stat()系统调用。</td>
</tr>
<tr>
<td>51</td>
<td>os.stat_float_times([newvalue])：决定stat_result是否以float对象显示时间戳</td>
</tr>
<tr>
<td>52</td>
<td>os.statvfs(path)：获取指定路径的文件系统统计信息</td>
</tr>
<tr>
<td>53</td>
<td>os.symlink(src, dst)：创建一个软链接</td>
</tr>
<tr>
<td>54</td>
<td>os.tcgetpgrp(fd)：返回与终端fd（一个由os.open()返回的打开的文件描述符）关联的进程组</td>
</tr>
<tr>
<td>55</td>
<td>os.tcsetpgrp(fd,   pg)：设置与终端fd（一个由os.open()返回的打开的文件描述符）关联的进程组为pg。</td>
</tr>
<tr>
<td>56</td>
<td>os.tempnam([dir[,   prefix]])：Python3 中已删除。返回唯一的路径名用于创建临时文件。</td>
</tr>
<tr>
<td>57</td>
<td>os.tmpfile()：Python3   中已删除。返回一个打开的模式为(w+b)的文件对象 .这文件对象没有文件夹入口，没有文件描述符，将会自动删除。</td>
</tr>
<tr>
<td>58</td>
<td>os.tmpnam()：Python3   中已删除。为创建一个临时文件返回一个唯一的路径</td>
</tr>
<tr>
<td>59</td>
<td>os.ttyname(fd)：返回一个字符串，它表示与文件描述符fd   关联的终端设备。如果fd 没有与终端设备关联，则引发一个异常。</td>
</tr>
<tr>
<td>60</td>
<td>os.unlink(path)：删除文件路径</td>
</tr>
<tr>
<td>61</td>
<td>os.utime(path,   times)：返回指定的path文件的访问和修改的时间。</td>
</tr>
<tr>
<td>62</td>
<td>os.walk(top[, topdown=True[,   onerror=None[, followlinks=False]]])：输出在文件夹中的文件名通过在树中游走，向上或者向下。</td>
</tr>
<tr>
<td>63</td>
<td>os.write(fd, str)：写入字符串到文件描述符 fd中.   返回实际写入的字符串长度</td>
</tr>
</tbody>
</table>
</div>
<p>目录操作的函数太多，用到的时候再学习，下面只列出几个简单的案例：</p>
<h3 id="显示某文件夹下的所有文件名"><a href="#显示某文件夹下的所有文件名" class="headerlink" title="显示某文件夹下的所有文件名"></a>显示某文件夹下的所有文件名</h3><p>代码如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">C:\Users\<span class="number">20161111</span>&gt;type practice.py</div><div class="line"><span class="keyword">import</span> os</div><div class="line"><span class="keyword">for</span> filename <span class="keyword">in</span> os.listdir(<span class="string">'d:/Software'</span>):</div><div class="line">    print(filename)</div><div class="line">    </div><div class="line">C:\Users\<span class="number">20161111</span>&gt;python practice.py</div><div class="line">office_tools</div><div class="line">Professional_tools</div><div class="line">ProgramTool</div><div class="line">SnapGene <span class="number">3.2</span><span class="number">.1</span> Win</div><div class="line">system_enhance</div><div class="line">windows_iso</div><div class="line">谷歌批量翻译</div></pre></td></tr></table></figure>
<h3 id="创建某个目录"><a href="#创建某个目录" class="headerlink" title="创建某个目录"></a>创建某个目录</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> os</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>os.mkdir(<span class="string">"d:/Software/test"</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>exit()</div><div class="line">C:\Users\<span class="number">20161111</span>&gt;d:</div><div class="line">D:\&gt;cd software</div><div class="line">D:\software&gt;dir</div><div class="line"> Volume <span class="keyword">in</span> drive D <span class="keyword">is</span> 新加卷</div><div class="line"> Volume Serial Number <span class="keyword">is</span> C0C6<span class="number">-2E4</span>F</div><div class="line"></div><div class="line"> Directory of D:\software</div><div class="line"></div><div class="line"><span class="number">2018</span>/<span class="number">05</span>/<span class="number">24</span>  <span class="number">09</span>:<span class="number">33</span>    &lt;DIR&gt;          .</div><div class="line"><span class="number">2018</span>/<span class="number">05</span>/<span class="number">24</span>  <span class="number">09</span>:<span class="number">33</span>    &lt;DIR&gt;          ..</div><div class="line"><span class="number">2018</span>/<span class="number">05</span>/<span class="number">08</span>  <span class="number">13</span>:<span class="number">46</span>    &lt;DIR&gt;          office_tools</div><div class="line"><span class="number">2018</span>/<span class="number">05</span>/<span class="number">21</span>  <span class="number">10</span>:<span class="number">30</span>    &lt;DIR&gt;          Professional_tools</div><div class="line"><span class="number">2018</span>/<span class="number">05</span>/<span class="number">08</span>  <span class="number">13</span>:<span class="number">46</span>    &lt;DIR&gt;          ProgramTool</div><div class="line"><span class="number">2017</span>/<span class="number">11</span>/<span class="number">22</span>  <span class="number">20</span>:<span class="number">21</span>    &lt;DIR&gt;          SnapGene <span class="number">3.2</span><span class="number">.1</span> Win</div><div class="line"><span class="number">2018</span>/<span class="number">05</span>/<span class="number">13</span>  <span class="number">21</span>:<span class="number">38</span>    &lt;DIR&gt;          system_enhance</div><div class="line"><span class="number">2018</span>/<span class="number">05</span>/<span class="number">24</span>  <span class="number">09</span>:<span class="number">33</span>    &lt;DIR&gt;          test <span class="comment"># 刚刚创建的文件夹</span></div><div class="line"><span class="number">2018</span>/<span class="number">05</span>/<span class="number">11</span>  <span class="number">00</span>:<span class="number">48</span>    &lt;DIR&gt;          windows_iso</div><div class="line"><span class="number">2017</span>/<span class="number">11</span>/<span class="number">02</span>  <span class="number">10</span>:<span class="number">52</span>    &lt;DIR&gt;          谷歌批量翻译</div><div class="line">               <span class="number">1</span> File(s)              <span class="number">0</span> bytes</div><div class="line">              <span class="number">10</span> Dir(s)  <span class="number">49</span>,<span class="number">307</span>,<span class="number">074</span>,<span class="number">560</span> bytes free</div></pre></td></tr></table></figure>
<h3 id="删除某个文件夹"><a href="#删除某个文件夹" class="headerlink" title="删除某个文件夹"></a>删除某个文件夹</h3><p>命令<code>rmdir</code>，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> os</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>os.rmdir(<span class="string">'d:/Software/test'</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>exit()</div><div class="line"></div><div class="line">D:\software&gt;dir</div><div class="line"> Volume <span class="keyword">in</span> drive D <span class="keyword">is</span> 新加卷</div><div class="line"> Volume Serial Number <span class="keyword">is</span> C0C6<span class="number">-2E4</span>F</div><div class="line"></div><div class="line"> Directory of D:\software</div><div class="line"></div><div class="line"><span class="number">2018</span>/<span class="number">05</span>/<span class="number">25</span>  <span class="number">12</span>:<span class="number">40</span>    &lt;DIR&gt;          .</div><div class="line"><span class="number">2018</span>/<span class="number">05</span>/<span class="number">25</span>  <span class="number">12</span>:<span class="number">40</span>    &lt;DIR&gt;          ..</div><div class="line"><span class="number">2018</span>/<span class="number">05</span>/<span class="number">08</span>  <span class="number">13</span>:<span class="number">46</span>    &lt;DIR&gt;          office_tools</div><div class="line"><span class="number">2018</span>/<span class="number">05</span>/<span class="number">21</span>  <span class="number">10</span>:<span class="number">30</span>    &lt;DIR&gt;          Professional_tools</div><div class="line"><span class="number">2018</span>/<span class="number">05</span>/<span class="number">08</span>  <span class="number">13</span>:<span class="number">46</span>    &lt;DIR&gt;          ProgramTool</div><div class="line"><span class="number">2017</span>/<span class="number">11</span>/<span class="number">22</span>  <span class="number">20</span>:<span class="number">21</span>    &lt;DIR&gt;          SnapGene <span class="number">3.2</span><span class="number">.1</span> Win</div><div class="line"><span class="number">2018</span>/<span class="number">05</span>/<span class="number">13</span>  <span class="number">21</span>:<span class="number">38</span>    &lt;DIR&gt;          system_enhance</div><div class="line"><span class="number">2018</span>/<span class="number">05</span>/<span class="number">11</span>  <span class="number">00</span>:<span class="number">48</span>    &lt;DIR&gt;          windows_iso</div><div class="line"><span class="number">2017</span>/<span class="number">11</span>/<span class="number">02</span>  <span class="number">10</span>:<span class="number">52</span>    &lt;DIR&gt;          谷歌批量翻译</div><div class="line">               <span class="number">1</span> File(s)              <span class="number">0</span> bytes</div><div class="line">               <span class="number">9</span> Dir(s)  <span class="number">48</span>,<span class="number">131</span>,<span class="number">309</span>,<span class="number">568</span> bytes free</div></pre></td></tr></table></figure>
<p>把<code>D:\Software\test</code>这个文件夹删除了 。</p>
<h3 id="对待定文件的操作"><a href="#对待定文件的操作" class="headerlink" title="对待定文件的操作"></a>对待定文件的操作</h3><p>如果要对特定类型的文件进行操作时，需要用fnmatch模块，这个模块的主要作用是文件名称的匹配，并且匹配的模式使用的unix shell风格。字面意思感觉就是filename match ，以下是显示<code>.txt</code>文件的内容和<code>.exe</code>文件的文件名，其中<code>*</code>表示任意字符，而<code>?</code>只表示一个字符，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"></div></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2018/04/11/Python/Python学习笔记（9）-迭代器与生成器/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/04/11/Python/Python学习笔记（9）-迭代器与生成器/" itemprop="url">Python学习笔记（9）-迭代器与生成器</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-04-11T12:00:00+08:00">
                2018-04-11
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Python/" itemprop="url" rel="index">
                    <span itemprop="name">Python</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  4,409
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  17
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>在学Python时，我对于生成器和迭代器理解得不清楚，检索到了一篇文章，把这两个东西讲得很透，应该是我能找到的最好的理解迭代器与生成器的文章，原文是《<a href="https://foofish.net/iterators-vs-generators.html" target="_blank" rel="external">完全理解Python迭代对象、迭代器、生成器》</a>，原文章作者提到，他是参考了别人的另外一篇文章写的，另外的文章题目是<a href="http://nvie.com/posts/iterators-vs-generators/" target="_blank" rel="external">《Iterables vs. Iterators vs. Generators》</a>。</p>
<h2 id="数据结构背景"><a href="#数据结构背景" class="headerlink" title="数据结构背景"></a>数据结构背景</h2><p>在了解迭代器与生成器之前，需要了解一下Python的一些数据结构方面的知识，下图说明了容器(container)、可迭代对象(iterable)、迭代器(iterator)、生成器(generator)、列表/集合/字典推导式(list,set,dict comprehension)这些概念的关系图：</p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/professional/180522/1DjIAj9aGG.png?imageslim" alt="mark"></p>
<p>为方便理解，简单地译成中文如下：<img src="http://ortxpw68f.bkt.clouddn.com/professional/180522/Cbb7H0Ggf2.png?imageslim" alt="mark"></p>
<h3 id="容器-container"><a href="#容器-container" class="headerlink" title="容器(container)"></a>容器(container)</h3><p>容器是一种把多个元素组织在一起的数据结构，容器中的元素可以逐个地迭代获取，可以用in, not in关键字判断元素是否包含在容器中。通常这类数据结构把所有的元素存储在内存中（也有一些特例，并不是所有的元素都放在内存，比如迭代器和生成器对象）在Python中，常见的容器对象有：</p>
<ol>
<li>list, deque（双端队列）, ….</li>
<li>set, frozensets, ….</li>
<li>dict, defaultdict, OrderedDict, Counter, ….</li>
<li>tuple, namedtuple, …</li>
<li>str</li>
</ol>
<p>容器比较容易理解，因为你就可以把它看作是一个盒子、一栋房子、一个柜子，里面可以塞任何东西。从技术角度来说，当它可以用来询问某个元素是否包含在其中时，那么这个对象就可以认为是一个容器，比如 list，set，tuples都是容器对象，看下面的案例：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"></div></pre></td></tr></table></figure>
<h4 id="assert-函数"><a href="#assert-函数" class="headerlink" title="assert()函数"></a>assert()函数</h4><p>关于<code>assert</code>这个函数，这个函数是Python断言句，它的功能就是判断某个表达式是否为真，运行后，如果什么都不返回，它就是True，如果语句是假，就返回异常，看一个案例，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">assert</span> <span class="number">1</span> <span class="keyword">in</span> [<span class="number">11</span>,<span class="number">22</span>,<span class="number">33</span>] <span class="comment"># 1不在[11,22,33]里面，这个表达式就是False，返回异常</span></div><div class="line">Traceback (most recent call last):</div><div class="line">  File <span class="string">"&lt;stdin&gt;"</span>, line <span class="number">1</span>, <span class="keyword">in</span> &lt;module&gt;</div><div class="line">AssertionError</div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">assert</span> <span class="number">2</span> &lt; <span class="number">1</span> <span class="comment"># 2小于1，是False，返回异常</span></div><div class="line">Traceback (most recent call last):</div><div class="line">  File <span class="string">"&lt;stdin&gt;"</span>, line <span class="number">1</span>, <span class="keyword">in</span> &lt;module&gt;</div><div class="line">AssertionError</div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">assert</span> <span class="number">1</span> <span class="keyword">in</span> [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>] <span class="comment"># 1在[1,2,3]里，是True，不返回任何信息</span></div></pre></td></tr></table></figure>
<p>再继续看容器的相关知识。可以寻问某元素是否在dict中用dict中的key：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>d = &#123;<span class="number">1</span>:<span class="string">'foo'</span>,<span class="number">2</span>:<span class="string">'bar'</span>,<span class="number">3</span>:<span class="string">'qux'</span>&#125; <span class="comment"># dict</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(d)</div><div class="line">&#123;<span class="number">1</span>: <span class="string">'foo'</span>, <span class="number">2</span>: <span class="string">'bar'</span>, <span class="number">3</span>: <span class="string">'qux'</span>&#125;</div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">assert</span> <span class="number">1</span> <span class="keyword">in</span> d</div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="number">1</span> <span class="keyword">in</span> d</div><div class="line"><span class="keyword">True</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">assert</span> <span class="string">'foo'</span> <span class="keyword">not</span> <span class="keyword">in</span> d <span class="comment"># 'foo'不是d的元素，它只是一个值，不是key</span></div><div class="line">&gt;&gt;&gt;</div></pre></td></tr></table></figure>
<p>询问某substring是否在string中： </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>s = <span class="string">'test'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">assert</span> <span class="string">'a'</span> <span class="keyword">in</span> s</div><div class="line">Traceback (most recent call last):</div><div class="line">  File <span class="string">"&lt;stdin&gt;"</span>, line <span class="number">1</span>, <span class="keyword">in</span> &lt;module&gt;</div><div class="line">AssertionError</div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">assert</span> <span class="string">'a'</span> <span class="keyword">not</span> <span class="keyword">in</span> s</div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">assert</span> <span class="string">'te'</span> <span class="keyword">in</span> s</div><div class="line">&gt;&gt;&gt;</div></pre></td></tr></table></figure>
<p>尽管绝大多数容器都提供了某种方式来获取其中的每一个元素，但这并不是容器本身提供的能力，而是<strong>可迭代对象</strong>赋予了容器这种能力，当然并不是所有的容器都是可迭代的，比如：Bloom filter（布隆过滤器），虽然Bloom filter可以用来检测某个元素是否包含在容器中，但是并不能从容器中获取其中的每一个值，因为Bloom filter压根就没把元素存储在容器中，而是通过一个散列函数映射成一个值保存在数组中。</p>
<blockquote>
<p>Bloom Filter是一种空间效率很高的随机数据结构，它利用位数组很简洁地表示一个集合，并能判断一个元素是否属于这个集合。Bloom Filter的这种高效是有一定代价的：在判断一个元素是否属于某个集合时，有可能会把不属于这个集合的元素误认为属于这个集合（false positive）。因此，Bloom Filter不适合那些“零错误”的应用场合。而在能容忍低错误率的应用场合下，Bloom Filter通过极少的错误换取了存储空间的极大节省。 </p>
</blockquote>
<h3 id="可迭代对象（iterable）"><a href="#可迭代对象（iterable）" class="headerlink" title="可迭代对象（iterable）"></a>可迭代对象（iterable）</h3><p>很多容器都是可迭代对象，此外还有更多的对象同样也是可迭代对象，比如处于打开状态的files，sockets等等。但凡是可以返回一个迭代器的对象都可称之为可迭代对象，看下面的例子：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>x = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>y = iter(x) <span class="comment">#创建迭代对象</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(y)</div><div class="line">&lt;list_iterator object at <span class="number">0x000001F8308B7470</span>&gt;</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>z = iter(x)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>next(y)</div><div class="line"><span class="number">1</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>next(y)</div><div class="line"><span class="number">2</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>next(z)</div><div class="line"><span class="number">1</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>type(x)</div><div class="line">&lt;<span class="class"><span class="keyword">class</span> '<span class="title">list</span>'&gt;</span></div><div class="line"><span class="class">&gt;&gt;&gt; <span class="title">type</span><span class="params">(y)</span></span></div><div class="line"><span class="class">&lt;<span class="title">class</span> '<span class="title">list_iterator</span>'&gt;</span></div></pre></td></tr></table></figure>
<p>代码解释：在这段代码中，<code>x</code>是一个可迭代对象，可迭代对象和容器一样是一种总称，范围很大，在Python中，它并不是指某种具体的数据类型，例如list是可迭代对象，dict是可迭代对象，set也是可迭代对象。在这段代码中，<code>y</code>和<code>z</code>是两个独立的迭代器，迭代器内部持有一个状态，该状态用于记录当前迭代所在的位置，以方便下次迭代的时候获取正确的元素。迭代器有一种具体的迭代器类型，比如<code>list_iterator</code>，<code>set_iterator</code>，可迭代对象实现了<code>__iter__</code>方法，这种方法会返回一个迭代对象，现在运行以下代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">x = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</div><div class="line"><span class="keyword">for</span> elem <span class="keyword">in</span> x:</div><div class="line">    ...</div></pre></td></tr></table></figure>
<p>这段代码的执行过程如下所示：</p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/professional/180522/9Fa14chiLj.png?imageslim" alt="mark"></p>
<p>反编译该段代码，你可以看到解释器显示地调用<code>GET_ITER</code>指令，相当于调用<code>iter(x)</code>，<code>FOR_ITER</code>指令就是调用<code>next()</code>方法，不断地获取迭代器中的下一个元素，但是你没法直接从指令中看出来，因为他被解释器优化过了，下面是反编译的过程：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> dis</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>dis.dis(<span class="string">'for _ in x: pass'</span>)</div><div class="line">  <span class="number">1</span>           <span class="number">0</span> SETUP_LOOP              <span class="number">14</span> (to <span class="number">17</span>)</div><div class="line">              <span class="number">3</span> LOAD_NAME                <span class="number">0</span> (x)</div><div class="line">              <span class="number">6</span> GET_ITER</div><div class="line">        &gt;&gt;    <span class="number">7</span> FOR_ITER                 <span class="number">6</span> (to <span class="number">16</span>)</div><div class="line">             <span class="number">10</span> STORE_NAME               <span class="number">1</span> (_)</div><div class="line">             <span class="number">13</span> JUMP_ABSOLUTE            <span class="number">7</span></div><div class="line">        &gt;&gt;   <span class="number">16</span> POP_BLOCK</div><div class="line">        &gt;&gt;   <span class="number">17</span> LOAD_CONST               <span class="number">0</span> (<span class="keyword">None</span>)</div><div class="line">             <span class="number">20</span> RETURN_VALUE</div></pre></td></tr></table></figure>
<p>注：dis模块主要是用来分析字节码的一个内置模块，经常会用到的方法是dis.dis，它支持对Python代码进行反汇编，生成字节码指令。</p>
<h3 id="判断可迭代对象"><a href="#判断可迭代对象" class="headerlink" title="判断可迭代对象"></a>判断可迭代对象</h3><p>判断一个对象是否是迭代器，可以使用<code>isinstance</code>函数来判断，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> collections <span class="keyword">import</span> Iterable</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>a = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">34</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>isinstance(a,Iterable)</div><div class="line"><span class="keyword">True</span></div><div class="line">&gt;&gt;&gt;</div></pre></td></tr></table></figure>
<h2 id="迭代器-iterator"><a href="#迭代器-iterator" class="headerlink" title="迭代器(iterator)"></a>迭代器(iterator)</h2><h3 id="迭代器协议"><a href="#迭代器协议" class="headerlink" title="迭代器协议"></a>迭代器协议</h3><p>迭代器协议是指：对象需要提供<code>next</code>方法，它要么回返迭代中的下一项，要么引起一个StopIteration异常，以终止迭代。协议是一种约定，可迭代对象实现迭代器协议，Python的内置工具，例如for循环，sum，min，max等函数都可以使用迭代器协议访问对象。</p>
<p>在Python中可以使用for循环来遍历数组，PYhton的list底层就是一个数组，因此也可以使用for循环来遍历list，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">for</span> n <span class="keyword">in</span> [<span class="number">3</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">3</span>]:</div><div class="line"><span class="meta">... </span>    print(n)</div><div class="line">...</div><div class="line"><span class="number">3</span></div><div class="line"><span class="number">2</span></div><div class="line"><span class="number">4</span></div><div class="line"><span class="number">3</span></div></pre></td></tr></table></figure>
<p>Python的for循环也可以用于遍历文件（文件位于<code>C:\Users\20161111</code>目录下，内容是1到4这四个数字）如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> os</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>os.getcwd()</div><div class="line"><span class="string">'C:\\Users\\20161111'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">with</span> open(<span class="string">'practice.py'</span>) <span class="keyword">as</span> text:</div><div class="line"><span class="meta">... </span>    <span class="keyword">for</span> line <span class="keyword">in</span> text:</div><div class="line"><span class="meta">... </span>        print(line)</div><div class="line">...</div><div class="line"><span class="number">1</span></div><div class="line"><span class="number">2</span></div><div class="line"><span class="number">3</span></div><div class="line"><span class="number">4</span></div></pre></td></tr></table></figure>
<p>在Python中，文件也能使用for循环，这是因为在Python中，文件对象实现了迭代器协议，for循环使用迭代器协议访问即对象时，并不需要对象是否是一个文件。</p>
<h3 id="迭代器定义"><a href="#迭代器定义" class="headerlink" title="迭代器定义"></a>迭代器定义</h3><p>那么什么迭代器呢？它是一个带状态的对象，他能在你调用next()方法的时候返回容器中的下一个值，任何实现了<code>__iter__</code>和<code>__next__()</code>方法的对象都是迭代器，<code>__iter__</code>返回迭代器自身，<code>__next__</code>返回容器中的下一个值，如果容器中没有更多元素了，则抛出Stop Iteration异常。</p>
<p>所以，迭代器就是实现了工厂模式（什么是工厂模式？有空了补充笔记）的对象，它在你每次你询问要下一个值的时候给你返回。有很多关于迭代器的例子，比如itertools函数返回的都是迭代器对象。</p>
<h3 id="生成无限序列"><a href="#生成无限序列" class="headerlink" title="生成无限序列"></a>生成无限序列</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> itertools <span class="keyword">import</span> count</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>counter = count(start=<span class="number">13</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>next(counter)</div><div class="line"><span class="number">13</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>next(counter)</div><div class="line"><span class="number">14</span></div></pre></td></tr></table></figure>
<p>代码解释：<code>itertools</code>这个模块用于构建迭代器，<code>count</code>这个函数用于生成连续的整数，<code>count(start=13)</code>表示生成从13开始的整数无限序列，即13,14,15….。</p>
<h3 id="从一个有限序列中生成无限序列"><a href="#从一个有限序列中生成无限序列" class="headerlink" title="从一个有限序列中生成无限序列"></a>从一个有限序列中生成无限序列</h3><p>代码如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> itertools <span class="keyword">import</span> cycle</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>colors = cycle([<span class="string">'red'</span>,<span class="string">'white'</span>,<span class="string">'blue'</span>])</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>next(colors)</div><div class="line"><span class="string">'red'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>next(colors)</div><div class="line"><span class="string">'white'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>next(colors)</div><div class="line"><span class="string">'blue'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>next(colors)</div><div class="line"><span class="string">'red'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>next(colors)</div><div class="line"><span class="string">'white'</span></div></pre></td></tr></table></figure>
<p>这段代码使用了<code>cycle</code>函数，它的功能在于生成一个循环的无限序列。</p>
<h3 id="从无限的序列中生成有限序列"><a href="#从无限的序列中生成有限序列" class="headerlink" title="从无限的序列中生成有限序列"></a>从无限的序列中生成有限序列</h3><p>代码如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> itertools <span class="keyword">import</span> islice</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>counter = count(start=<span class="number">13</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>limited = islice(counter,<span class="number">2</span>,<span class="number">5</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">for</span> x <span class="keyword">in</span> limited:</div><div class="line"><span class="meta">... </span>    print(x)</div><div class="line">...</div><div class="line"><span class="number">15</span></div><div class="line"><span class="number">16</span></div><div class="line"><span class="number">17</span></div></pre></td></tr></table></figure>
<p>代码解释，先用<code>count</code>生成了一个无限的整数序列，即13，14，15，16，17，18…..，接着使用<code>islice</code>从这个无限序列中提取第2到第4个元素（第2个元素是15，因为Python计数时，是从0开始的），15,16,17。</p>
<h3 id="自定义迭代器"><a href="#自定义迭代器" class="headerlink" title="自定义迭代器"></a>自定义迭代器</h3><p>为了更直观地感受迭代器内部的执行过程，我们自定义一个迭代器，以斐波那契数列为例： </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> islice</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Fib</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></div><div class="line">        self.prev = <span class="number">0</span></div><div class="line">        self.curr = <span class="number">1</span></div><div class="line"></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__iter__</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="keyword">return</span> self</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__next__</span><span class="params">(self)</span>:</span></div><div class="line">        value = self.curr</div><div class="line">        self.curr += self.prev</div><div class="line">        self.prev = value</div><div class="line">        <span class="keyword">return</span> value</div><div class="line"></div><div class="line">f = Fib()</div><div class="line">print(list(islice(f,<span class="number">0</span>,<span class="number">10</span>)))</div></pre></td></tr></table></figure>
<p>运行结果如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">C:\Users\<span class="number">20161111</span>&gt;python practice.py</div><div class="line">[<span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">8</span>, <span class="number">13</span>, <span class="number">21</span>, <span class="number">34</span>, <span class="number">55</span>]</div></pre></td></tr></table></figure>
<p>Fib是一个可迭代对象，因为它有<code>__iter__</code>方法，又是一个迭代器，因为它实现了<code>__next__</code>方法，实例变量<code>prev</code>和<code>curr</code>用于维持迭代器的内部状态，每次调用<code>next()</code>方法时，做两件事情，第一：为下一次调用<code>next()</code>方法修改状态；第二：为当前这次调用生成返回结果。</p>
<p>迭代器就像一个懒加载的工厂，等到有人需要的时候才给它生成值返回，没调用的时候就处于休眠状态等待下一次调用。</p>
<h3 id="为什么要使用迭代器？"><a href="#为什么要使用迭代器？" class="headerlink" title="为什么要使用迭代器？"></a>为什么要使用迭代器？</h3><p>先看一段代码，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">list = [<span class="number">3</span>,<span class="number">5</span>,<span class="number">1</span>,<span class="number">4</span>,<span class="number">5</span>]</div><div class="line">it = iter(list)</div><div class="line"><span class="keyword">for</span> x <span class="keyword">in</span> it:</div><div class="line">    print(x,end=<span class="string">" "</span>)</div><div class="line"></div><div class="line">print(<span class="string">"\n---------"</span>)</div><div class="line"><span class="keyword">for</span> y <span class="keyword">in</span> list:</div><div class="line">    print(y,end=<span class="string">" "</span>)</div></pre></td></tr></table></figure>
<p>运行结果如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">C:\Users\<span class="number">20161111</span>&gt;python practice.py</div><div class="line"><span class="number">3</span> <span class="number">5</span> <span class="number">1</span> <span class="number">4</span> <span class="number">5</span></div><div class="line">---------</div><div class="line"><span class="number">3</span> <span class="number">5</span> <span class="number">1</span> <span class="number">4</span> <span class="number">5</span></div></pre></td></tr></table></figure>
<p>从运行结果来看，貌似迭代器与普通的for循环没什么区别。但Python中为什么设计出迭代器种对象？下面列出了一些迭代器的使用场景：</p>
<h4 id="场景1：访问集合中的一个元素。"><a href="#场景1：访问集合中的一个元素。" class="headerlink" title="场景1：访问集合中的一个元素。"></a>场景1：访问集合中的一个元素。</h4><p>例如我要访问集合中的一个元素，怎么处理？</p>
<p>思路：集合是没有顺序的，因此也没有索引，要访问元素，有两种方法：第一，将集合转换为列表；第二，使用迭代器，先看第一种方法：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>set1 = &#123;<span class="number">5</span>,<span class="number">3</span>,<span class="number">8</span>,<span class="number">4</span>,<span class="number">11</span>&#125;</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(set1)</div><div class="line">&#123;<span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">8</span>, <span class="number">11</span>&#125;</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>list1 = list(set1)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(list1)</div><div class="line">[<span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">8</span>, <span class="number">11</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>list1[<span class="number">2</span>]</div><div class="line"><span class="number">5</span></div></pre></td></tr></table></figure>
<p>再看第2种方法：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>set1=iter(set1)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>next(set1)</div><div class="line"><span class="number">3</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>next(set1)</div><div class="line"><span class="number">4</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>next(set1)</div><div class="line"><span class="number">5</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>next(set1)</div><div class="line"><span class="number">8</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>next(set1)</div><div class="line"><span class="number">11</span></div></pre></td></tr></table></figure>
<h4 id="场景2"><a href="#场景2" class="headerlink" title="场景2:"></a>场景2:</h4><p>如果我有一个文件，例如6G的测序文件，要遍历里面的所有元素，此时如果使用列表，元组等序列明显不现实。此时就需要使用迭代器子，它的一大优点就是不需要事先准备好整个迭代过程中所有的元素 ，迭代器仅仅在迭代到某个元素时才计算该元素，而在这之前或之后，元素可以不存在或者被销毁。 这个特点使得它特别适合用于遍历一些巨大的或是无限的集合。因此，它的使用过程有点像内存，我们把正在运行的程序放进内存，运行完就退出内存，每次只放正在运行的程序进入，而不是一次把全部内容都扔进去。</p>
<h2 id="生成器（generator）"><a href="#生成器（generator）" class="headerlink" title="生成器（generator）"></a>生成器（generator）</h2><p>在Python中，使用了<code>yield</code>的函数被称为生成器（generator），跟普通函数不同的是，生成器是一个返回迭代器的函数，只能用于迭代操作，更简单点理解生成器就是一个特殊的迭代器，调用一个生成器函数，返回的是一个迭代器对象。它不需要再像上面的类一样写<code>__iter__()</code>和<code>__next__()</code>方法了，只需要一个<code>yiled</code>关键字，每次遇到<code>yield</code>时函数会暂停并保存当前所有的运行信息，返回<code>yield</code>的值,并在下一次执行<code>next()</code>方法时从当前位置继续运行（这也是生成器的主要使用场景）。</p>
<p>从上述描述中可以知道，生成器可以支持延迟操作，延迟操作是指，只在需要的时候产生结果，而不是立即产生结果，这是生成器的主要好处。Python有两种不同的方式提供生成器：第一，生成器函数：常规函数定义，但是，使用yield语句而不是return语句返回结果。yield语句一次返回一个结果，在每个结果中间，挂起函数的状态，以便下次重它离开的地方继续执行。第二，生成器表达式：类似于列表推导，但是，生成器返回按需产生结果的一个对象，而不是一次构建一个结果列表</p>
<p>用生成器来实现斐波那契数列的例子是：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> islice</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">fib</span><span class="params">()</span>:</span></div><div class="line">    prev, curr = <span class="number">0</span>, <span class="number">1</span></div><div class="line">    <span class="keyword">while</span> <span class="keyword">True</span>:</div><div class="line">        <span class="keyword">yield</span> curr</div><div class="line">        prev, curr = curr, curr + prev</div><div class="line"></div><div class="line">f = fib()</div><div class="line">print(list(islice(f, <span class="number">0</span>, <span class="number">10</span>)))</div></pre></td></tr></table></figure>
<p>代码运行如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">C:\Users\<span class="number">20161111</span>&gt;python practice.py</div><div class="line">[<span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">8</span>, <span class="number">13</span>, <span class="number">21</span>, <span class="number">34</span>, <span class="number">55</span>]</div></pre></td></tr></table></figure>
<p>fib就是一个普通的python函数，它特殊的地方在于函数体中没有<code>return</code>关键字，函数的返回值是一个生成器对象。当执行<code>f=fib()</code>返回的是一个生成器对象，此时函数体中的代码并不会执行，只有显示或隐示地调用<code>next</code>的时候才会真正执行里面的代码。</p>
<h3 id="生成器表达式"><a href="#生成器表达式" class="headerlink" title="生成器表达式"></a>生成器表达式</h3><p>生成器表达式是列表推倒式的生成器版本，看起来像列表推导式，但是它返回的是一个生成器对象而不是列表对象。，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">something</span><span class="params">()</span>:</span></div><div class="line">    result = []</div><div class="line">    <span class="keyword">for</span> ... <span class="keyword">in</span> ...:</div><div class="line">        result.append(x)</div><div class="line">    <span class="keyword">return</span> result</div></pre></td></tr></table></figure>
<h3 id="生成器的优点"><a href="#生成器的优点" class="headerlink" title="生成器的优点"></a>生成器的优点</h3><p>第一，代码量更少。</p>
<p>生成器在Python中是一个非常强大的编程结构，可以用更少地中间变量写流式代码，此外，相比其它容器对象它更能节省内存和CPU，当然它可以用更少的代码来实现相似的功能。但凡看到类似以下的代码，就能够用生成器替代：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">something</span><span class="params">()</span>:</span></div><div class="line">    result = []</div><div class="line">    <span class="keyword">for</span> ... <span class="keyword">in</span> ...:</div><div class="line">        result.append(x)</div><div class="line">    <span class="keyword">return</span> result</div></pre></td></tr></table></figure>
<p>将上述代码用生成器函数来替换：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">iter_something</span><span class="params">()</span>:</span></div><div class="line">    <span class="keyword">for</span> ... <span class="keyword">in</span> ...:</div><div class="line">        <span class="keyword">yield</span> x</div></pre></td></tr></table></figure>
<p>再看一个案例：</p>
<p>使用生成器返回自然数的平方</p>
<p>常规写法如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">C:\Users\<span class="number">20161111</span>&gt;type practice.py</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_square</span><span class="params">(n)</span>:</span></div><div class="line">    res = []</div><div class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(n):</div><div class="line">        res.append(i*i)</div><div class="line">    <span class="keyword">return</span> res</div><div class="line"></div><div class="line"><span class="keyword">for</span> item <span class="keyword">in</span> get_square(<span class="number">5</span>):</div><div class="line">    print(item)</div><div class="line">    </div><div class="line">    </div><div class="line">C:\Users\<span class="number">20161111</span>&gt;python practice.py</div><div class="line"><span class="number">0</span></div><div class="line"><span class="number">1</span></div><div class="line"><span class="number">4</span></div><div class="line"><span class="number">9</span></div><div class="line"><span class="number">16</span></div></pre></td></tr></table></figure>
<p>生成器函数写法如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">C:\Users\<span class="number">20161111</span>&gt;type practice.py</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_square</span><span class="params">(n)</span>:</span></div><div class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(n):</div><div class="line">        <span class="keyword">yield</span> i*i</div><div class="line"></div><div class="line"><span class="keyword">for</span> item <span class="keyword">in</span> get_square(<span class="number">5</span>):</div><div class="line">    print(item)</div><div class="line">    </div><div class="line">C:\Users\<span class="number">20161111</span>&gt;python practice.py</div><div class="line"><span class="number">0</span></div><div class="line"><span class="number">1</span></div><div class="line"><span class="number">4</span></div><div class="line"><span class="number">9</span></div><div class="line"><span class="number">16</span></div></pre></td></tr></table></figure>
<p>生成器表达式的写法如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>squares = (x*x <span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">5</span>))</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>squares</div><div class="line">&lt;generator object &lt;genexpr&gt; at <span class="number">0x000001F167983DB0</span>&gt;</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>next(squares)</div><div class="line"><span class="number">0</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>next(squares)</div><div class="line"><span class="number">1</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>next(squares)</div><div class="line"><span class="number">4</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>next(squares)</div><div class="line"><span class="number">9</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>next(squares)</div><div class="line"><span class="number">16</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>next(squares)</div><div class="line">Traceback (most recent call last):</div><div class="line">  File <span class="string">"&lt;stdin&gt;"</span>, line <span class="number">1</span>, <span class="keyword">in</span> &lt;module&gt;</div><div class="line">StopIteration</div></pre></td></tr></table></figure>
<h3 id="生成器总结"><a href="#生成器总结" class="headerlink" title="生成器总结"></a>生成器总结</h3><p>现在总结一下生成器函数的格式，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> 函数名:</span></div><div class="line">    statements</div><div class="line">        <span class="keyword">yield</span></div></pre></td></tr></table></figure>
<ol>
<li>生成器函数和常规函数几乎是一样的。它们都是使用def语句进行定义，差别在于，生成器使用yield语句返回一个值，而常规函数使用return语句返回一个值。</li>
<li>自动实现迭代器协议：对于生成器，Python会自动实现迭代器协议，以便应用到迭代背景中（如for循环，sum函数）。由于生成器自动实现了迭代器协议，所以，我们可以调用它的next方法，并且，在没有值可以返回的时候，生成器自动产生StopIteration异常。</li>
<li>状态挂起：生成器使用yield语句返回一个值。yield语句挂起该生成器函数的状态，保留足够的信息，以便之后从它离开的地方继续执行。</li>
</ol>
<h2 id="结论"><a href="#结论" class="headerlink" title="结论"></a>结论</h2><ol>
<li>容器是一系列元素的集合，str、list、set、dict、file、sockets对象都可以看作是容器，容器都可以被迭代（用在for，while等语句中），因此他们被称为可迭代对象。</li>
<li>可迭代对象实现了<code>__iter__</code>方法，该方法返回一个迭代器对象。</li>
<li>迭代器持有一个内部状态的字段，用于记录下次迭代返回值，它实现了<code>__next__</code>和<code>__iter__</code>方法，迭代器不会一次性把所有元素加载到内存，而是需要的时候才生成返回结果。</li>
<li>生成器是一种特殊的迭代器，它的返回值不是通过return而是用yield。</li>
</ol>
<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><ol>
<li><a href="https://zhuanlan.zhihu.com/p/24499698" target="_blank" rel="external">Python 迭代器和生成器</a></li>
<li><a href="https://mp.weixin.qq.com/s?src=11&amp;timestamp=1526953288&amp;ver=890&amp;signature=o-XNyigidmZsfz1Gnqygf99H1c1gAYf1ZkBTEMtwoNrkkRfLGM4HPAjbxudh2SPkNqwb6GtXTh8QbcZS4x9Uovz8hcAIEng1iFbJfgSllVIm5mMzpuYLgWnGs2Rwquxe&amp;new=1" target="_blank" rel="external">完全理解Python迭代器对象、迭代器、生成器</a></li>
<li><a href="http://nvie.com/posts/iterators-vs-generators/" target="_blank" rel="external">Iterables vs. Iterators vs. Generators</a></li>
<li><a href="https://blog.csdn.net/jiaomeng/article/details/1495500" target="_blank" rel="external">Bloom Filter概念和原理</a></li>
<li><a href="https://zhuanlan.zhihu.com/p/33662628" target="_blank" rel="external">Python进阶系列连载（4）——迭代器</a></li>
<li><a href="https://www.zhihu.com/question/20829330" target="_blank" rel="external">如何更好地理解Python迭代器与生成器.知乎.赖明星的回答</a></li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2018/04/10/Python/Python学习笔记（8）-正则表达式学习笔记/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/04/10/Python/Python学习笔记（8）-正则表达式学习笔记/" itemprop="url">Python学习笔记（8）-正则表达式学习笔记</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-04-10T12:00:00+08:00">
                2018-04-10
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Python/" itemprop="url" rel="index">
                    <span itemprop="name">Python</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  7,077
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  29
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="1-什是正则表达式？"><a href="#1-什是正则表达式？" class="headerlink" title="1. 什是正则表达式？"></a>1. 什是正则表达式？</h2><p>答：正则表达式又称规则表达式，英语是Regular Expression，在代码中常简写为regex、regexp或RE，这计算机科学的一个概念。正则表达式通常被用来检索、替换那些符合某个模式(规则)的文本。 许多程序设计语言都支持利用正则表达式进行字符串操作。正则表达式包括普通字符（例如，a 到 z 之间的字母）和特殊字符（称为”元字符”）。正则表达式使用单个字符串来描述、匹配一系列匹配某个句法规则的字符串。它的使用类似于通配符（wildchars），例如在Linux的命令行中输入<code>ls *.py</code>就会列出所有以”.py”结尾的文件。</p>
<p>有时候我们要处理一些字符串，例如，我要提取一些位于<code>&lt;pre&gt;</code>和<code>&lt;/pre&gt;</code>之间的广西，或者是从一个文件中清除一些非ATCG的字符，都要用到正则表达式。</p>
<h2 id="2-正则表达式在生物学方面有什么用处"><a href="#2-正则表达式在生物学方面有什么用处" class="headerlink" title="2. 正则表达式在生物学方面有什么用处?"></a>2. 正则表达式在生物学方面有什么用处?</h2><p>答:正则表达式的这种特征在生物学方面使用极为,广泛，利用正则表达式，可以很好地定位蛋白质的结构域，DNA的一些序列模式，例如CpG岛，重复序列，限制性内切酶位点，核酸识别位点。</p>
<h2 id="3-不同编程语言之间的正则表达式相同不？"><a href="#3-不同编程语言之间的正则表达式相同不？" class="headerlink" title="3. 不同编程语言之间的正则表达式相同不？"></a>3. 不同编程语言之间的正则表达式相同不？</h2><p>答：许多编程语言都支持正则表达式，每种编程语言都有自己的正则表达式语法，不过大体上是相同的。Python的正则表达式与Perl接近，如果会使用Perl，那么Python的正则表达式学起来也非常容易。</p>
<h2 id="4-正则表达式是按照哪些规则来匹配文本的？"><a href="#4-正则表达式是按照哪些规则来匹配文本的？" class="headerlink" title="4. 正则表达式是按照哪些规则来匹配文本的？"></a>4. 正则表达式是按照哪些规则来匹配文本的？</h2><p>答：在Python中，通常情况下，字母与单词匹配他们本身，例如“Python”就匹配“Python”，而不是”python”，还有一些特殊的字符用于特殊的匹配，以<code>. ^ $ *  + ? { [ ] \ | ( )</code>为例说明一下，如下表所示：</p>
<ol>
<li><p><code>.</code>号：匹配除除换行符 \n 之外的任何字符，例如“ATT.T”会匹配“ATTCT”，”ATTFT”，但不会匹配“ATTTCT”。</p>
</li>
<li><p><code>^</code>（克拉符号）：匹配输入字符串的开始位置，例如“AUG”会匹配“AUGAGC”，但不匹配“AAUGC”。如果是在方括号里使用，例如<sup><a href="#fn_AUG" id="reffn_AUG">AUG</a></sup>表示相反的意思，即不匹配以AUG开头的字符串。</p>
</li>
<li><p><code>$</code>(美元符号)：在一行字符串中，匹配输入字符串的结尾位置，例如“UAA$”匹配“AGCUAA”，但不匹配“ACUAAG”。</p>
</li>
<li><p><code>*</code>（星号）：匹配前面的子表达式零次或多次重复。例如“AT*”会匹配“AAT”，“A”，但不匹配“TT”。</p>
</li>
<li><p><code>+</code>（加号）：匹配前面的子表达式一次或多次重复。“AT+”会匹配“ATT”，但不匹配“A”。</p>
</li>
<li><p><code>?</code>匹配前面的子表达式零次或一次重复，“AT?”会匹配“A”或“AT”。</p>
</li>
<li><p><code>(...)</code>（括号）：匹配圆括号中的表达式，用于表明匹配的开始与结构，如果只匹配括号，例如匹配“（”或“）”时，可以使用(或)，或者是将它们放到中括号里[(][)]。</p>
</li>
<li><p><code>(?:...)</code>：匹配但不捕获该匹配的子表达式。</p>
</li>
<li><p><code>{n}</code>：n是一个非负整数，匹配重复的某字符串的n次。例如，“(ATTG){3}”匹配ATTGATTGATTG，但是不匹配“ATTGATTG”。（第1个是重复了3次，第2个是重复了2次）。</p>
</li>
<li><p><code>{m,n}</code>：m和n均为非负整数，其中m&lt;=n，它表示最少匹配n次且最多匹配m次。例如“(AT){3,5}”会匹配“ATATTATATAT”，但是不匹配“ATATTATAT”，如果不加m，则是从匹配0次的开始，如果没有n，则匹配任意重复的某字符串。</p>
</li>
<li><p><code>[]</code>：表示一组字符串。“[A-Z]”会匹配任何大写的字母，而“[a-z0-9]”则会匹配任何小写的字母以及数字。“[AT<em>]”匹配“A”，“T”，或“</em>（星号）”。在中括号里，<code>^</code>表示相反的含义，例如“<sup><a href="#fn_R" id="reffn_R">R</a></sup>”会匹配任何除了“R”之外的字母。</p>
</li>
<li><p><code>\</code>：将下一个字符标记为或特殊字符、或原义字符、或向后引用、或八进制转义符。例如， ‘n’ 匹配字符 ‘n’。’\n’ 匹配换行符。序列 ‘\\’ 匹配 “\”，而 ‘(‘ 则匹配 “(“。</p>
</li>
<li><p><code>|</code>：表达“或”的意思，指明两项之间的一个选择，例如“A|T”会匹配“A”，“T”或“AT”</p>
<p>。</p>
<p>Python中的一些特殊字符总结如下所示：</p>
<p>| 元字符                           | 功能说明                                     |<br>| ——————————————- | ———————————————————— |<br>| ()                            | 将位于()中的内容作为一个整体来对待                       |<br>| {}                            | 按{}中的次数进行匹配                              |<br>| []                            | 匹配位于[]中的任意一个字符                           |<br>| <sup><a href="#fn_xyz" id="reffn_xyz">xyz</a></sup>                        | ^放在[]内表示反向字符集，匹配除x、y、z之外的任何字符            |<br>| [a-z]                         | 字符范围，匹配指定范围内的任何字符                        |<br>| <sup><a href="#fn_a-z" id="reffn_a-z">a-z</a></sup>                        | 反向范围字符，匹配除小写英文字母之外的任何字符                  |<br>| .                             | 匹配除换行符以外的任意单个字符                          |<br>| <em>                             | 匹配位于“</em>”之前的字符或子模式的0次或多次出现                 |<br>| +                             | 匹配位于“+”之前的字符或子模式的1次或多次出现                 |<br>| -                             | 用在[]之内用来表示范围                             |<br>| |                            | 匹配位于“|”之前或之后的字符                         |<br>| ^                             | 匹配行首，匹配以^后面的字符开头的字符串                     |<br>| $      | 匹配行尾，匹配以$之前的字符结束的字符串 |                                          |<br>| ?                             | 匹配位于“？”之前的0个或1个字符，当此字符紧随任何其他限定符（*，+，?，{n}，{n,}，{n,m}之后时，匹配模式是“非贪心的“。“非贪心的“模式匹配搜索到的、尽可能短的字符串，而默认的”贪心的“模式匹配搜索一的，尽可能长的字符串。例如在字符串“oooo”中，“o+?”只匹配单个o，而“o+”匹配所有o |<br>| \                             | 表示位于\之后的为转义字符                            |<br>| \num                          | 此处的num是一个正整数，例如，“(.)\1”匹配两个连续的相同字符       |<br>| \f                            | 换页符匹配                                    |<br>| \n                            | 换行符匹配                                    |<br>| \r                            | 匹配一个回车符                                  |<br>| \b                            | 匹配单词头或单词尾                                |<br>| \B                            | 与\b含义相反                                  |<br>| \d                            | 匹配任何数字，相当于[0-9]                          |<br>| \D                            | 代表非数字，等效于[^0-9                           |<br>| \s                            | 匹配任何空白字符，包括空格、制表符、换页符，与[\f\n\r\t\v]等效    |<br>| \S                            | 与\s含义相反，代表非空白字符                          |<br>| \w                            | 匹配要任何字母、数字以及下画线，相当于[a-zA-Z0-9]           |<br>| \W                            | 与\w相反，与<code>[^A-Za-z0-9]</code>等效                  |</p>
<p>​</p>
</li>
</ol>
<h2 id="5-Python中有没有正则表达式专门用的模块？"><a href="#5-Python中有没有正则表达式专门用的模块？" class="headerlink" title="5. Python中有没有正则表达式专门用的模块？"></a>5. Python中有没有正则表达式专门用的模块？</h2><p>答：在Python中，它的标准库<code>re</code>提供了正则表达式操作所需要的功能。它的基础用法如下所示，用search来说明一下，re.search()方法的功能：在给定字符串中寻找第一个匹配给定正则表达式的子字符串。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> re <span class="comment"># 导入python的标准re库</span></div><div class="line">mo = re.search(<span class="string">"hello"</span>,<span class="string">"hello world, hello Python!"</span>)</div></pre></td></tr></table></figure>
<p>其中<code>search</code>方法的具体用法：使用公式为<code>re.search(pattern,string,flags=0)</code>，其中flags的值可以是re.I（大写的字母I，不是1），大写表示忽略查找时的大小写，re.L（支持本地字符集的字符），re.M（多行匹配区栖），re.S（使用元字符“.”，匹配单字）。它可以在字符串内查找模式匹配，只要找到第一个匹配，然后就返回一个match object对象，如果字符串没有匹配，就返回None。mathch object对象有以下的方法：</p>
<p>group() 返回被 RE 匹配的字符串</p>
<p>start() 返回匹配开始的位置</p>
<p>end() 返回匹配结束的位置</p>
<p>span() 返回一个元组包含匹配 (开始,结束) 的位置</p>
<p>group() 返回re整体匹配的字符串，可以一次输入多个组号，对应组号匹配的字符串。</p>
<p>上述的代码运行如下所示：</p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/professional/180424/7bFhFjJDfG.png?imageslim" alt="mark"></p>
<p>个结果非常类似于index()方法，如下所示：</p>
<blockquote>
<p>“hello”,”hello world, hello Python!”.index(“hello”)</p>
<p>(‘hello’, 0)</p>
</blockquote>
<p>不过index()与re.search()方法的不同之处在于所选用的是正则表达式，还是普通的字符串，再看一下例子：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> re</div><div class="line">mo = re.search(<span class="string">"[Hh]ello"</span>,<span class="string">"Hello world, hello Python!"</span>)</div><div class="line">mo.group()</div></pre></td></tr></table></figure>
<p>运行结果如下所示：</p>
<blockquote>
<p>mo.group()<br>‘Hello’</p>
</blockquote>
<p>其中以大写H开头的字符串是第一个被匹配的模式，返回。</p>
<h2 id="6-Python中的re库还有哪些常用的方法？"><a href="#6-Python中的re库还有哪些常用的方法？" class="headerlink" title="6. Python中的re库还有哪些常用的方法？"></a>6. Python中的re库还有哪些常用的方法？</h2><p>答：可以查看地一下re库中的方法，用命令``即可，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">impor re <span class="comment"># 导入re标准库</span></div><div class="line">dir(re) <span class="comment"># 查看re库中所有的方法</span></div></pre></td></tr></table></figure>
<p>可以看到有这些方法：</p>
<blockquote>
<p>dir(re)<br>[‘A’, ‘ASCII’, ‘DEBUG’, ‘DOTALL’, ‘I’, ‘IGNORECASE’, ‘L’, ‘LOCALE’, ‘M’, ‘MULTILINE’, ‘RegexFlag’, ‘S’, ‘Scanner’, ‘T’, ‘TEMPLATE’, ‘U’, ‘UNICODE’, ‘VERBOSE’, ‘X’, ‘_MAXCACHE’, ‘<strong>all</strong>‘, ‘<strong>builtins</strong>‘, ‘<strong>cached</strong>‘, ‘<strong>doc</strong>‘, ‘<strong>file</strong>‘, ‘<strong>loader</strong>‘, ‘<strong>name</strong>‘, ‘<strong>package</strong>‘, ‘<strong>spec</strong>‘, ‘<strong>version</strong>‘, ‘_alphanum_bytes’, ‘_alphanum_str’, ‘_cache’, ‘_compile’, ‘_compile_repl’, ‘_expand’, ‘_locale’, ‘_pattern_type’, ‘_pickle’, ‘_subx’, ‘compile’, ‘copyreg’, ‘enum’, ‘error’, ‘escape’, ‘findall’, ‘finditer’, ‘fullmatch’, ‘functools’, ‘match’, ‘purge’, ‘search’, ‘split’, ‘sre_compile’, ‘sre_parse’, ‘sub’, ‘subn’, ‘template’]</p>
</blockquote>
<p>常用的方法还有re.findall()，re.finditer()，re.match()，</p>
<p>re.findall()：列出字符串中模式的所有匹配项，与re.search()不同的是，re.findall()是查找所有的匹配结果，而后者只是找到第1个匹配结果，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>result = re.findall(<span class="string">"[Hh]ello"</span>,<span class="string">"Hello world, hello Python,!"</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(result)</div><div class="line">[<span class="string">'Hello'</span>, <span class="string">'hello'</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(type(result))</div><div class="line">&lt;<span class="class"><span class="keyword">class</span> '<span class="title">list</span>'&gt;</span></div></pre></td></tr></table></figure>
<p>从上述结果可以看出，re.findall()返回的结果是一个list，而不是一个match object。</p>
<p>re.finditer()：列出字符串中模式的所有匹配项，返回一个match object，这是re.finditer()与re.findall()的区别，re.finditer()返回来的是一个迭代器，后者返回来的是一个list，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>result = re.finditer(<span class="string">"[Hh]ello"</span>,<span class="string">"Hello world, hello Python,!"</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(result)</div><div class="line">&lt;callable_iterator object at <span class="number">0x00000276F7ABEC18</span>&gt;</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(type(result))</div><div class="line">&lt;<span class="class"><span class="keyword">class</span> '<span class="title">callable_iterator</span>'&gt;</span></div></pre></td></tr></table></figure>
<p>如果要查看结果，可以按下操作，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>result = re.finditer(<span class="string">"[Hh]ello"</span>,<span class="string">"Hello world, hello Python,!"</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">for</span> x <span class="keyword">in</span> result:</div><div class="line"><span class="meta">... </span>    print(x.group())</div><div class="line"><span class="meta">... </span>    print(x.span())</div><div class="line">...</div><div class="line">Hello</div><div class="line">(<span class="number">0</span>, <span class="number">5</span>)</div><div class="line">hello</div><div class="line">(<span class="number">13</span>, <span class="number">18</span>)</div><div class="line">&gt;&gt;&gt;</div></pre></td></tr></table></figure>
<p>re.match()：从字符串的开始处匹配，返回match对象或None，它与re.search()类似，不同之处在于，re.match()只在字符串的开头进行匹配，而re.search()会在整个字符串中进行匹配，如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&gt;&gt;&gt; result = re.match(&quot;hello&quot;,&quot;Hello world, hello Python,!&quot;)</div><div class="line">&gt;&gt;&gt; print(result)</div><div class="line">None</div></pre></td></tr></table></figure>
<p>如果找到了匹配结果，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>result = re.match(<span class="string">"Hello"</span>,<span class="string">"Hello world, hello Python,!"</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(result)</div><div class="line">&lt;_sre.SRE_Match object; span=(<span class="number">0</span>, <span class="number">5</span>), match=<span class="string">'Hello'</span>&gt;</div></pre></td></tr></table></figure>
<p>可以通过group()和span()来查看匹配的结果：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>result = re.match(<span class="string">"Hello"</span>,<span class="string">"Hello world, hello Python,!"</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(result)</div><div class="line">&lt;_sre.SRE_Match object; span=(<span class="number">0</span>, <span class="number">5</span>), match=<span class="string">'Hello'</span>&gt;</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>result.group()</div><div class="line"><span class="string">'Hello'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>result.span()</div><div class="line">(<span class="number">0</span>, <span class="number">5</span>)</div></pre></td></tr></table></figure>
<h2 id="7-在Python中，如何构建一个模式对象？"><a href="#7-在Python中，如何构建一个模式对象？" class="headerlink" title="7. 在Python中，如何构建一个模式对象？"></a>7. 在Python中，如何构建一个模式对象？</h2><p>答：在Python的re模块中，可以使用compile()方法将正则表达式编译生成正则表达式对象，然后再使用正则表达式对象提供的方法进行字符串处理，使用编译后的正则表达式对象不仅可以提高字符串处理速度，还提供了更加强大的字符串处理功能，尤其是对于大文本文件来说，这一步不是强制的，但推荐这么做。先来看一下findall的匹配，然后再来看一下“创建”的模式匹配。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>re.findall(<span class="string">"[Hh]ello"</span>,<span class="string">"Hello world, hello Python,!"</span>)</div><div class="line">[<span class="string">'Hello'</span>, <span class="string">'hello'</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>reg  = re.compile(<span class="string">"[Hh]ello"</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>reg.findall(<span class="string">"Hello world, hello Python,!"</span>)</div><div class="line">[<span class="string">'Hello'</span>, <span class="string">'hello'</span>]</div><div class="line">&gt;&gt;&gt;</div></pre></td></tr></table></figure>
<p>编译好的模式可以使用re库中所有的方法，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>rgx = re.compile(<span class="string">"[Hh]ello"</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>rgx.search(<span class="string">"Hello world, hello Python,!"</span>)</div><div class="line">&lt;_sre.SRE_Match object; span=(<span class="number">0</span>, <span class="number">5</span>), match=<span class="string">'Hello'</span>&gt;</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>rgx.match(<span class="string">"Hello world, hello Python,!"</span>)</div><div class="line">&lt;_sre.SRE_Match object; span=(<span class="number">0</span>, <span class="number">5</span>), match=<span class="string">'Hello'</span>&gt;</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>rgx.findall(<span class="string">"Hello world, hello Python, !"</span>)</div><div class="line">[<span class="string">'Hello'</span>, <span class="string">'hello'</span>]</div></pre></td></tr></table></figure>
<h2 id="Example1-搜索第一个”TAT“重复序列"><a href="#Example1-搜索第一个”TAT“重复序列" class="headerlink" title="Example1:搜索第一个”TAT“重复序列"></a>Example1:搜索第一个”TAT“重复序列</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> re</div><div class="line">seq = <span class="string">"ATATAAGATGCGCGCGCTTATGCGCGCA"</span></div><div class="line">rgx = re.compile(<span class="string">"TAT"</span>)     <span class="comment"># 编译了模式（TAT），编译好的模式就可以使用re中的方法，例如finditer</span></div><div class="line">i = <span class="number">1</span> </div><div class="line"></div><div class="line"><span class="keyword">for</span> mo <span class="keyword">in</span> rgx.finditer(seq): <span class="comment"># finditer()方法返回了一个“匹配”类型的对象，就是mo</span></div><div class="line">    print(<span class="string">'Ocurrence&#123;&#125;:&#123;&#125;'</span>.format(i, mo.group()))  <span class="comment"># 用group()方法操作了mo对象</span></div><div class="line">    print(<span class="string">'Position: From &#123;&#125; to &#123;&#125;'</span>.format(mo.start(),mo.end())) <span class="comment"># 用span()方法操作了mo对象，</span></div><div class="line">    <span class="comment"># 这里使用的是mo.start()与mo.end()，它们等价于mo.span[0]和mo.span()[1]</span></div><div class="line">    <span class="comment"># 即价于  print('Position: From &#123;&#125; to &#123;&#125;'.format(mo.span()[0],mo.span()[1]))</span></div><div class="line">    i += <span class="number">1</span></div></pre></td></tr></table></figure>
<p>运行后，结果如下所示（具体代码的解释看注释）：</p>
<blockquote>
<p>Ocurrence1:TAT</p>
<p>Position: From 1 to 4</p>
<p>Ocurrence2:TAT</p>
<p>Position: From 18 to 21</p>
</blockquote>
<h2 id="8-如果我要匹配超过一种模式，如何操作？"><a href="#8-如果我要匹配超过一种模式，如何操作？" class="headerlink" title="8. 如果我要匹配超过一种模式，如何操作？"></a>8. 如果我要匹配超过一种模式，如何操作？</h2><p>答：如果要匹配超过一种模式，则需要用到组操作（grouping）。用括号()来将标一个组，。组可以被“捕获（capturing）或非捕获（non-capturing），按照这种分类方法，组合就有捕获组和非捕获组。捕获组就是把正则表达式中子表达式匹配的内容，保存到内存中以数字编号或显式命名的组里，方便检索。<code>groups()</code>方法可以用于捕获组，需要注意的是<code>groups()</code>和<code>group()</code>是两种不同的方法。<code>group()</code>返回匹配的字符串，groups()返回的是元组，它们的用法可以用几个案例来说明，如下所示：</p>
<h2 id="Example2-常规匹配"><a href="#Example2-常规匹配" class="headerlink" title="Example2: 常规匹配"></a>Example2: 常规匹配</h2><p>下面的代码匹配的是“单词，逗号，单词”这个模式，里面有2个括号，group()默认会返回整个匹配结果，它等同于group(0)，而group(1)会返回第1个亚组，group(2)会返回第2个亚组，关于亚组的划分，如下图所示：<br><img src="http://ortxpw68f.bkt.clouddn.com/professional/180424/eF5bmKCjDB.png?imageslim" alt="mark"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> re</div><div class="line">m = re.search(<span class="string">r"(\w+)\,(\w+)"</span>, <span class="string">"Isaac Newton,physicist"</span>)</div><div class="line"><span class="comment"># 匹配一个“单词，逗号，一个单词”</span></div><div class="line">m.group()</div><div class="line">m.group(<span class="number">0</span>)</div><div class="line">print(type(m.group(<span class="number">0</span>)))</div><div class="line"><span class="comment"># m.group(0)和group()都是返回整个匹配结果，就是group(0)的内容</span></div><div class="line"><span class="comment"># m.group(0)的结果是一个字符串</span></div><div class="line">m.group(<span class="number">1</span>)</div><div class="line"><span class="comment"># 返回第1个亚组（就是group(1)的内容</span></div><div class="line">m.group(<span class="number">2</span>)</div><div class="line"><span class="comment"># 返回第2个亚组（就是group(2)的内容</span></div><div class="line">m.group(<span class="number">10</span>) </div><div class="line"><span class="comment"># group一共就0,1,2三个，如果是gruop(10)则会出错</span></div><div class="line">m.group(<span class="number">1</span>,<span class="number">2</span>) </div><div class="line"><span class="comment"># 输出多个匹配结果，m.gorup(1,2)表示输出</span></div><div class="line">m.groups()</div><div class="line"><span class="comment"># 返回一个包含所有亚组字符串的元组，从1 到所含的小组号,具体的案例可以往后看</span></div></pre></td></tr></table></figure>
<p>结果如下所示：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">&gt;&gt;&gt; import re</div><div class="line">&gt;&gt;&gt; m = re.search(r&quot;(\w+)\,(\w+)&quot;, &quot;Isaac Newton,physicist&quot;)</div><div class="line">&gt;&gt;&gt; # 匹配一个&quot;单词，逗号，一个单词&quot;</div><div class="line">... m.group()</div><div class="line">&apos;Newton,physicist&apos;</div><div class="line">&gt;&gt;&gt; m.group(0)</div><div class="line">&apos;Newton,physicist&apos;</div><div class="line">&gt;&gt;&gt; print(type(m.group(0)))</div><div class="line">&lt;class &apos;str&apos;&gt;</div><div class="line">&gt;&gt;&gt; # m.group(0)和group()都是返回整个匹配结果，就是group(0)的内容</div><div class="line">... # m.group(0)的结果是一个字符串</div><div class="line">...</div><div class="line">&gt;&gt;&gt; m.group(1)</div><div class="line">&apos;Newton&apos;</div><div class="line">&gt;&gt;&gt; # 返回第1个亚组（就是group(1)的内容</div><div class="line">...</div><div class="line">&gt;&gt;&gt; m.group(2)</div><div class="line">&apos;physicist&apos;</div><div class="line">&gt;&gt;&gt; # 返回第2个亚组（就是group(2)的内容</div><div class="line">&gt;&gt;&gt; </div><div class="line">&gt;&gt;&gt; m.groups()</div><div class="line">(&apos;Newton&apos;, &apos;physicist&apos;)</div></pre></td></tr></table></figure></p>
<h3 id="Example-3-gruop-1-的返回值"><a href="#Example-3-gruop-1-的返回值" class="headerlink" title="Example 3: gruop(1)的返回值"></a>Example 3: gruop(1)的返回值</h3><p>如果有多个匹配结果,gruop(1)则返回最后1个匹配结果,如下所示:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">m0 = re.match(<span class="string">r"(..)+"</span>, <span class="string">"a1b2c3"</span>)</div><div class="line">m0.group(<span class="number">0</span>) </div><div class="line">m0.group(<span class="number">1</span>)</div></pre></td></tr></table></figure>
<p>结果如下所示:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&gt;&gt;&gt; m0 = re.match(r&quot;(..)+&quot;, &quot;a1b2c3&quot;)</div><div class="line">&gt;&gt;&gt; m0.group(0)</div><div class="line">&apos;a1b2c3&apos;</div><div class="line">&gt;&gt;&gt; m0.group(1)</div><div class="line">&apos;c3&apos;</div></pre></td></tr></table></figure>
<p>需要注意的是,m0.group(0)返回的是整个匹配结果,而group(1)返回的是则是最后1个匹配结果,因为m0 = re.match(r”(..)+”, “a1b2c3”)中只有1个括号,它会逐步地进行匹配,第1次匹配的是a1,第2次匹配的是b2，此时匹配的结果是b2，覆盖掉a1，接着再匹配，是c3，然后c3覆盖b2，这是最后的匹配结果，因此m0.group(1)返回的是就是c3，如果有3个括号，就会连续匹配a1b2c3，有3个亚组，即如下代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">m01 = re.match(<span class="string">r"(..)(..)(..)+"</span>, <span class="string">"a1b2c3"</span>)</div><div class="line">m01.group()</div><div class="line">m01.group(<span class="number">1</span>)</div><div class="line">m01.group(<span class="number">2</span>)</div><div class="line">m01.group(<span class="number">3</span>)</div></pre></td></tr></table></figure>
<p>运行结果如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>m01 = re.match(<span class="string">r"(..)(..)(..)+"</span>, <span class="string">"a1b2c3"</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>m01.group()</div><div class="line"><span class="string">'a1b2c3'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>m01.group(<span class="number">1</span>)</div><div class="line"><span class="string">'a1'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>m01.group(<span class="number">2</span>)</div><div class="line"><span class="string">'b2'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>m01.group(<span class="number">3</span>)</div><div class="line"><span class="string">'c3'</span></div><div class="line">&gt;&gt;&gt;</div></pre></td></tr></table></figure>
<h3 id="Example4-group-与groups-返回的数值类型"><a href="#Example4-group-与groups-返回的数值类型" class="headerlink" title="Example4: group()与groups()返回的数值类型"></a>Example4: group()与groups()返回的数值类型</h3><p>group()返回的结果是一个字符串，groups()返回的结果是一个元组，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> re</div><div class="line">m = re.search(<span class="string">r"(\w+)\,(\w+)"</span>, <span class="string">"Isaac Newton,physicist"</span>)</div><div class="line">print(type(m.group()))</div><div class="line">print(type(m.groups()))</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>m02.group(<span class="number">2</span>)</div><div class="line"><span class="string">'2c'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> re</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>m = re.search(<span class="string">r"(\w+)\,(\w+)"</span>, <span class="string">"Isaac Newton,physicist"</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(type(m.group()))</div><div class="line">&lt;<span class="class"><span class="keyword">class</span> '<span class="title">str</span>'&gt;</span></div><div class="line"><span class="class">&gt;&gt;&gt; <span class="title">print</span><span class="params">(type<span class="params">(m.groups<span class="params">()</span>)</span>)</span></span></div><div class="line"><span class="class">&lt;<span class="title">class</span> '<span class="title">tuple</span>'&gt;</span></div><div class="line"><span class="class">&gt;&gt;&gt;</span></div></pre></td></tr></table></figure>
<h3 id="Example5-group-与groups-的区别"><a href="#Example5-group-与groups-的区别" class="headerlink" title="Example5: group()与groups()的区别"></a>Example5: group()与groups()的区别</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">m2 = re.match(<span class="string">r"(\d)(\d)(\d)(\d)"</span>,<span class="string">"1234"</span>)</div><div class="line">m2.group()</div><div class="line">m2.group(<span class="number">1</span>)</div><div class="line">m2.group(<span class="number">2</span>)</div><div class="line">m2.group(<span class="number">3</span>)</div><div class="line">m2.group(<span class="number">4</span>)</div><div class="line">m2.groups()</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>m2 = re.match(<span class="string">r"(\d)(\d)(\d)(\d)"</span>,<span class="string">"1234"</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>m2.group()</div><div class="line"><span class="string">'1234'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>m2.group(<span class="number">1</span>)</div><div class="line"><span class="string">'1'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>m2.group(<span class="number">2</span>)</div><div class="line"><span class="string">'2'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>m2.group(<span class="number">3</span>)</div><div class="line"><span class="string">'3'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>m2.group(<span class="number">4</span>)</div><div class="line"><span class="string">'4'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>m2.groups()</div><div class="line">(<span class="string">'1'</span>, <span class="string">'2'</span>, <span class="string">'3'</span>, <span class="string">'4'</span>)</div></pre></td></tr></table></figure>
<h2 id="Example6-group-和groups-的应用。"><a href="#Example6-group-和groups-的应用。" class="headerlink" title="Example6: group()和groups()的应用。"></a>Example6: group()和groups()的应用。</h2><p>现在一条碱基，它的序列是ATATAAGATGCGCGCGCTTATGCGCGCA，现在找到它的GC序列，代码如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> re</div><div class="line">seq = <span class="string">"ATATAAGATGCGCGCGCTTATGCGCGCA"</span></div><div class="line">rgx = re.compile(<span class="string">"(GC)&#123;3,&#125;"</span>)   </div><div class="line"><span class="comment"># (GC)&#123;3,&#125;表示至少匹配3次，如果有4个连续的GC也匹配，5个也是如此</span></div><div class="line"></div><div class="line">result = rgx.search(seq)</div><div class="line">result.group()</div><div class="line">result.groups()</div><div class="line">result.group(<span class="number">0</span>)</div><div class="line">result.group(<span class="number">1</span>)</div><div class="line">result.group(<span class="number">0</span>,<span class="number">1</span>)</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> re</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>seq = <span class="string">"ATATAAGATGCGCGCGCTTATGCGCGCA"</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>rgx = re.compile(<span class="string">"(GC)&#123;3,&#125;"</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="comment"># (GC)&#123;3,&#125;表示至少匹配3次，如果有4个连续的GC也匹配，5个也是如此</span></div><div class="line">...</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>result = rgx.search(seq)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>result.group()</div><div class="line"><span class="string">'GCGCGCGC'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>result.groups()</div><div class="line">(<span class="string">'GC'</span>,)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>result.group(<span class="number">0</span>)</div><div class="line"><span class="string">'GCGCGCGC'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>result.group(<span class="number">1</span>)</div><div class="line"><span class="string">'GC'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>result.group(<span class="number">0</span>,<span class="number">1</span>)</div><div class="line">(<span class="string">'GCGCGCGC'</span>, <span class="string">'GC'</span>)</div></pre></td></tr></table></figure>
<p>从结果中可以看出，group()如果不填写参数，或者是填写了参数0，就会返回完全匹配的子字符串，如果写了参数1，会返回第2个匹配结果，如果填写了0,1，则返回所有的匹配结果。它的原理如下所示：</p>
<p><code>(GC){3,}</code>表示表示至少匹配3次，ATATAAGATGCGCGCGCTTATGCGCGCA序列中有GCGCGCGC，就匹配上了,groups()返回的是一个包含唯一或者全部子组的元组。</p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">捕获组</th>
<th style="text-align:center">正则表达式</th>
<th style="text-align:center">结果</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">group(0)</td>
<td style="text-align:center">(GC){3,}</td>
<td style="text-align:center">GCGCGCGC</td>
</tr>
<tr>
<td style="text-align:center">group(1)</td>
<td style="text-align:center">(GC)</td>
<td style="text-align:center">GC</td>
</tr>
</tbody>
</table>
</div>
<p>接着再来看一下groups()的使用方法，groups()方法返回的是匹配的所有亚组的结果，在这种情况下，由于search返回的是一个匹配对象（match object），在模式中有一个组（即GC），返回的匹配结果是一个元组（tuple），如下所示：</p>
<p>这种情况，就是常规的使用方法，跟前面第5个问题中描述的情况一样。如果是<code>groups()</code>方法，它返回的是匹配的所有亚组的结果，在这种情况下，由于search返回的是一个匹配对象（match object），在模式中只有一个组（即GC），返回的匹配结果是一个元组（tuple），即(“GC”,)，如果想让groups返回整个模式，需要在编译模式中添加上括号，像下面这个案例一样操作：如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> re</div><div class="line">seq = <span class="string">"ATATAAGATGCGCGCGCTTATGCGCGCA"</span></div><div class="line">rgx = re.compile(<span class="string">"((GC)&#123;3,&#125;)"</span>)</div><div class="line">result = rgx.search(seq)</div><div class="line">result.groups()</div><div class="line">result.group()</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> re</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>seq = <span class="string">"ATATAAGATGCGCGCGCTTATGCGCGCA"</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>rgx = re.compile(<span class="string">"((GC)&#123;3,&#125;)"</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>result = rgx.search(seq)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>result.groups()</div><div class="line">(<span class="string">'GCGCGCGC'</span>, <span class="string">'GC'</span>)</div></pre></td></tr></table></figure>
<p>在这种模式下，group()与groups()都能被检索（从左向右），因为这两种组都是默认能“捕获”的。如果不需要内部的这个子组（“CG”组），可以将其标为非捕获组（non-capturing），方法就是在组的开始添加上<code>?:</code>，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> re</div><div class="line">seq = <span class="string">"ATATAAGATGCGCGCGCTTATGCGCGCA"</span></div><div class="line">rgx = re.compile(<span class="string">"((?:GC)&#123;3,&#125;)"</span>)</div><div class="line">result = rgx.search(seq)</div><div class="line">result.groups()</div><div class="line">result.group()</div></pre></td></tr></table></figure>
<p>结果如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> re</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>seq = <span class="string">"ATATAAGATGCGCGCGCTTATGCGCGCA"</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>rgx = re.compile(<span class="string">"((?:GC)&#123;3,&#125;)"</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>result = rgx.search(seq)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>result.groups()</div><div class="line">(<span class="string">'GCGCGCGC'</span>,)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>result.group()</div><div class="line"><span class="string">'GCGCGCGC'</span></div></pre></td></tr></table></figure>
<h2 id="9-re-search-方法匹配的是都是第一个结果，如何匹配多个结果？"><a href="#9-re-search-方法匹配的是都是第一个结果，如何匹配多个结果？" class="headerlink" title="9. re.search()方法匹配的是都是第一个结果，如何匹配多个结果？"></a>9. re.search()方法匹配的是都是第一个结果，如何匹配多个结果？</h2><p>答：如果要进行所有的匹配，需要用到re.findall()方法，它的用法如下：</p>
<blockquote>
<p>findall(pattern, string, flags=0)</p>
</blockquote>
<p>re.findall()方法能够以列表的形式返回能匹配的子字符串。如果模式中存在一个组，那么findall也有不同的作用。如果没有组，那么findall返回的是匹配字符串的列表。如果模式中存在组，它会返回含有组的列表，如果有超过1组，返回一个元组列表，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> re</div><div class="line">seq = <span class="string">"ATATAAGATGCGCGCGCTTATGCGCGCA"</span></div><div class="line">rgx = re.compile(<span class="string">"TAT"</span>)</div><div class="line"><span class="comment"># 没有组</span></div><div class="line">rgx.findall(seq)</div><div class="line"><span class="comment"># 返回匹配的字符串的列表</span></div><div class="line">type(rgx.findall(seq))</div><div class="line">rgx = re.compile(<span class="string">"(GC)&#123;3,&#125;"</span>)</div><div class="line"><span class="comment"># 模式中含有1个组，返回1个列表</span></div><div class="line"></div><div class="line">rgx.findall(seq)</div><div class="line"><span class="comment"># 每个匹配对应的组</span></div><div class="line"></div><div class="line">rgx = re.compile(<span class="string">"((GC)&#123;3,&#125;)"</span>)</div><div class="line"><span class="comment"># 含有2个组，为每个匹配返回一个元组，整体就是一个元组列表</span></div><div class="line">rgx.findall(seq)</div><div class="line">rgx = re.compile(<span class="string">"((?:GC)&#123;3,&#125;)"</span>)</div><div class="line"><span class="comment"># 利用非捕获组得到唯一的匹配</span></div><div class="line">rgx.findall(seq)</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> re</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>seq = <span class="string">"ATATAAGATGCGCGCGCTTATGCGCGCA"</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>rgx = re.compile(<span class="string">"TAT"</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="comment"># 没有组，反回字符串列表</span></div><div class="line"><span class="meta">... </span>rgx.findall(seq)</div><div class="line">[<span class="string">'TAT'</span>, <span class="string">'TAT'</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="comment"># 返回匹配的字符串的列表</span></div><div class="line"><span class="meta">... </span>type(rgx.findall(seq))</div><div class="line">&lt;<span class="class"><span class="keyword">class</span> '<span class="title">list</span>'&gt;</span></div><div class="line">&gt;&gt;&gt; rgx = re.compile("(GC)&#123;3,&#125;")</div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="comment"># 模式中含有1个组，返回1个列表</span></div><div class="line">...</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>rgx.findall(seq)</div><div class="line">[<span class="string">'GC'</span>, <span class="string">'GC'</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="comment"># 每个匹配对应的组</span></div><div class="line">...</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>rgx = re.compile(<span class="string">"((GC)&#123;3,&#125;)"</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="comment"># 含有2个组，为每个匹配返回一个元组，整体就是一个元组列表</span></div><div class="line"><span class="meta">... </span>rgx.findall(seq)</div><div class="line">[(<span class="string">'GCGCGCGC'</span>, <span class="string">'GC'</span>), (<span class="string">'GCGCGC'</span>, <span class="string">'GC'</span>)]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>rgx = re.compile(<span class="string">"((?:GC)&#123;3,&#125;)"</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="comment"># 利用非捕获组得到唯一的匹配</span></div><div class="line"><span class="meta">... </span>rgx.findall(seq)</div><div class="line">[<span class="string">'GCGCGCGC'</span>, <span class="string">'GCGCGC'</span>]</div></pre></td></tr></table></figure>
<h2 id="案例第六：寻找多个亚模式（sub-patterns）"><a href="#案例第六：寻找多个亚模式（sub-patterns）" class="headerlink" title="案例第六：寻找多个亚模式（sub-patterns）"></a>案例第六：寻找多个亚模式（sub-patterns）</h2><p>不同的组可以用于标记，其格式为<code>?P&lt;组名字&gt;</code>，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> re</div><div class="line">rgx = re.compile(<span class="string">"(?P&lt;TBX&gt;TATA..).*(?P&lt;CGislands&gt;(?:GC)&#123;3,&#125;)"</span>)</div><div class="line">seq = <span class="string">"ATATAAGATGCGCGCGCTTATGCGCGCA"</span></div><div class="line">result = rgx.search(seq)</div><div class="line">print(result.group(<span class="string">'CGislands'</span>))</div><div class="line">print(result.group(<span class="string">'TBX'</span>))</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">C:\Users\<span class="number">20161111</span>&gt;python t.py</div><div class="line">GCGCGC</div><div class="line">TATAAG</div></pre></td></tr></table></figure>
<h3 id="Example7-用户支持的模式匹配行"><a href="#Example7-用户支持的模式匹配行" class="headerlink" title="Example7:用户支持的模式匹配行"></a>Example7:用户支持的模式匹配行</h3><p>这行代码主要是为了统计某个单词在文本文件中有多少个，代码如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> re, sys</div><div class="line">myregex = re.compile(sys.argv[<span class="number">2</span>])</div><div class="line">counter = <span class="number">0</span></div><div class="line">fh = open(sys.argv[<span class="number">1</span>])</div><div class="line"><span class="keyword">for</span> line <span class="keyword">in</span> fh:</div><div class="line">    <span class="keyword">if</span> myregex.search(line):</div><div class="line">        counter += <span class="number">1</span></div><div class="line">fh.closer()</div><div class="line">print(counter)</div></pre></td></tr></table></figure>
<p>代码解释如下：</p>
<p>第一，第2行代码：关于sys.argv[2]的用法，举1个小例子，在C盘的<code>C:\Users\20161111</code>目录下建立一个<code>.py</code>脚本，命名为<code>test.py</code>，输入下面的代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> sys</div><div class="line">a = sys.argv[<span class="number">0</span>]</div><div class="line">print(a)</div></pre></td></tr></table></figure>
<p>保存，快捷键<code>Win+R</code>，打开cmd，输入<code>python test.py</code>，结果如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">C:\Users\<span class="number">20161111</span>&gt;python test.py</div><div class="line">test.py</div></pre></td></tr></table></figure>
<p>由此可见，sys.argv[0]表示的就是<code>test.py</code>这个文件本身，现在将<code>tetst.py</code>代码中的sys.argv[0]更改为<code>sys.argv[1]</code>,再次运行，输入<code>python test.py what</code>，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">C:\Users\<span class="number">20161111</span>&gt;python test.py what</div><div class="line">what</div></pre></td></tr></table></figure>
<p>运行的结果变成了what，再次修改，将sys.argv[1]改为sys.argv[2:]，运行，输入<code>python test.py test0 what1 how3 apple4</code>，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">C:\Users\<span class="number">20161111</span>&gt;python test.py test0 what1 how3 apple4</div><div class="line">[<span class="string">'what1'</span>, <span class="string">'how3'</span>, <span class="string">'apple4'</span>]</div><div class="line"></div><div class="line">C:\Users\<span class="number">20161111</span>&gt;</div></pre></td></tr></table></figure>
<p>得到的结果是：’what1’, ‘how3’, ‘apple4’。再倒回去想一下，sys.argv[0]表示的是test.py本身，sys.argv[1]表示的是输入的第1个参数，sys.argv[2:]表示的是第2个参数往后，这与切片的表示形式是一样的。</p>
<p>结论就是，sys.argv[ ]其实就是一个列表，里边的项为用户输入的参数，关键就是要明白这参数是从程序外部输入的，而非代码本身的什么地方，要想看到它的效果就应该将程序保存了，从外部来运行程序并给出参数（参考资料：<a href="https://www.cnblogs.com/aland-1415/p/6613449.html" target="_blank" rel="external">Python中 sys.argv[]的用法简明解释</a>）。</p>
<p>第二，第4行代码，fh = open(sys.argv[1])表示的就是打开某个文件。</p>
<p>第三，现在运行一下这个脚本，将脚本保存到C盘的根目录下，命名为<code>count_line.py</code>，同时在同一个目录新建一个文本文件，输入以下文字：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">line1</div><div class="line">line2</div><div class="line">line3</div><div class="line">line4</div></pre></td></tr></table></figure>
<p>将文件命名为<code>line_test.txt</code>，打开cmd，输入命令<code>python count_line.py count_test,line</code>，一共是2个参数（前面的python不算），参数1是脚本名称，即count_line.py，参数2是文本文件，即count_test，参数3是要统计的文字，即line，运行结果如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">C:\Users\20161111&gt;python count_line.py line_test.txt line</div><div class="line">4</div></pre></td></tr></table></figure>
<p>可以发现，这个文本文件中有4个line这个单词。但是这个脚本有个缺陷，就是，如果一行中有两个line这个单词，它还是会统计为1个，如下所示，将文本文件更改为这样的：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">line1</div><div class="line">line2</div><div class="line">line3</div><div class="line">line4 line5</div></pre></td></tr></table></figure>
<p>继续运行上述脚本，结果如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">C:\Users\20161111&gt;python count_line.py line_test.txt line</div><div class="line">4</div></pre></td></tr></table></figure>
<p>因此，需要对脚本进行更改，更改后的版本如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> re, sys</div><div class="line">myregex = re.compile(sys.argv[<span class="number">2</span>])</div><div class="line">counter = <span class="number">0</span></div><div class="line"></div><div class="line">fh = open(sys.argv[<span class="number">1</span>])</div><div class="line"><span class="keyword">for</span> line <span class="keyword">in</span> fh:</div><div class="line">    counter += len(myregex.findall(line))</div><div class="line">fh.close()</div><div class="line"></div><div class="line">print(counter)</div></pre></td></tr></table></figure>
<p>运行结果如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">C:\Users\20161111&gt;python count_line.py line_test.txt line</div><div class="line">5</div></pre></td></tr></table></figure>
<h2 id="10-在Python中，正则表达式的规则非常难记，有没有工具可以用来检测正则表达式的正确与否？"><a href="#10-在Python中，正则表达式的规则非常难记，有没有工具可以用来检测正则表达式的正确与否？" class="headerlink" title="10. 在Python中，正则表达式的规则非常难记，有没有工具可以用来检测正则表达式的正确与否？"></a>10. 在Python中，正则表达式的规则非常难记，有没有工具可以用来检测正则表达式的正确与否？</h2><p>答：有个工具是Kodos，这个工具是用Python写成的，输入正则表达式，它能够在相应的输出框显示出正则表达式的结查，官网是：<a href="http://kodos.sourceforge.net/，软件是在WIndows下运行的，打开后界面如下所示：" target="_blank" rel="external">http://kodos.sourceforge.net/，软件是在WIndows下运行的，打开后界面如下所示：</a></p>
<p><img src="http://kodos.sourceforge.net/images/match.gif" alt="mark"></p>
<h2 id="11-如何通过正则表达式替换一些字符串？"><a href="#11-如何通过正则表达式替换一些字符串？" class="headerlink" title="11. 如何通过正则表达式替换一些字符串？"></a>11. 如何通过正则表达式替换一些字符串？</h2><p>答：如果要实现这个目的，需要用到re.sub()方法，sub就是substitution的简写，它的用法是<code>sub(rpl,str[,count=0])</code></p>
<p>具体参数的含义如下所示：</p>
<ol>
<li>rpl：原始的字符串；</li>
<li>str，需要替换原始字符串的字符串。</li>
<li>[,count=0]，可选参数，表示替换的最大次数，默认是0，表示替换所有匹配。</li>
</ol>
<p>re.sub的使用非常类似于replace方法，参见下面的案例，代码如下所示：</p>
<p>这个案例展示的是：删除GC重复（该行有超过3个GC），代码解释参见注释<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> re</div><div class="line">regex = re.compile(<span class="string">"(?:GC)&#123;3,&#125;"</span>) <span class="comment"># 匹配至少3个GC结边的字符串</span></div><div class="line">seq = <span class="string">"ATGATCGTACTGCGCGCTTCATGTGATGCGCGCGCGCAGACTATAAG"</span></div><div class="line">print(<span class="string">"Before:"</span>, seq)</div><div class="line">print(<span class="string">"After:"</span>, regex.sub(<span class="string">""</span>,seq))</div></pre></td></tr></table></figure></p>
<p>结果如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">C:\Users\<span class="number">20161111</span>&gt;python test.py</div><div class="line">Before: ATGATCGTACTGCGCGCTTCATGTGATGCGCGCGCGCAGACTATAAG</div><div class="line">After: ATGATCGTACTTTCATGTGATAGACTATAAG</div></pre></td></tr></table></figure>
<p>第二个方法：<code>subn(rpl,str[,count=0])</code>也能实现<code>re.sub</code>的功能。</p>
<p>不同之处在于，subn会返回替换后的字符串和替换的次数，将上述代码用subn演示，就如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> re</div><div class="line">regex = re.compile(<span class="string">"(?:GC)&#123;3,&#125;"</span>) <span class="comment"># 匹配至少3个GC结边的字符串</span></div><div class="line">seq = <span class="string">"ATGATCGTACTGCGCGCTTCATGTGATGCGCGCGCGCAGACTATAAG"</span></div><div class="line">print(<span class="string">"Before:"</span>, seq)</div><div class="line">print(<span class="string">"After:"</span>, regex.subn(<span class="string">""</span>,seq))</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">C:\Users\<span class="number">20161111</span>&gt;python test.py</div><div class="line">Before: ATGATCGTACTGCGCGCTTCATGTGATGCGCGCGCGCAGACTATAAG</div><div class="line">After: (<span class="string">'ATGATCGTACTTTCATGTGATAGACTATAAG'</span>, <span class="number">2</span>)</div></pre></td></tr></table></figure>
<h2 id="12-正则表达式在生物信息学方面有什么用处？"><a href="#12-正则表达式在生物信息学方面有什么用处？" class="headerlink" title="12. 正则表达式在生物信息学方面有什么用处？"></a>12. 正则表达式在生物信息学方面有什么用处？</h2><p>答：正则表达式可以用于搜索PROSITE（这是一个蛋白质拉点和序列模式数据库），这个数据库的信息模式就是序列与描述序列的字符串。例如下面的这段字符串：</p>
<p><code>K-[KR]-C-G-H-[LMQR]</code>，这段字符串表示的是异柠檬酸酶的活性位点。具体的每个字母含义如下：</p>
<p>位于第1个位置的是K，位于第2个位置提是K或R，随后是CGH，最后是一段氨基酸序列，即L，M，Q或R。如果要在这个序列中搜索，必须要把PROSITE的格式转化为符合Python正则表达式的表示方式，就像这样<code>K[KR]CGH[LMQR]</code>。</p>
<p>为了将PROSITE转化为REGEX的基本格式，这个过程中包括移除连接符（“-”），将括号之间的数字替换为大括号之间的数字，并将“x”替换为点号，接着看一个腺苷酸环化酶相关蛋白2（ adenylyl cyclase associated protein 2）的例子。</p>
<p>此蛋白在PROSITE中的版本如下：</p>
<p><code>[LIVM](2)-x-R-L-[DE]-x(4)-R-L-E</code>，这种序列是一致性模式（Consensus pattern）。</p>
<p>其中，L是亮氨酸，I是异亮氨酸，V是缬氨酸，M是甲硫氨酸，x代表任意氨基酸，R是精氨酸，D是天冬氨酸，E是谷氨酸。</p>
<p>REGEX（正则表达式）版本如下：</p>
<p><code>[LIVM]{2}.RL[DE].{4}RLE</code></p>
<h3 id="Example8：在FASTA格式中搜索蛋白质的模式"><a href="#Example8：在FASTA格式中搜索蛋白质的模式" class="headerlink" title="Example8：在FASTA格式中搜索蛋白质的模式"></a>Example8：在FASTA格式中搜索蛋白质的模式</h3><p>现在假设我们要在一个FASTA格式的文件中寻找这个模式。除了要找到这个模式外，我们有可能还需要在上下文中检索它的位置，即位于在这个模式之前与之后的10个氨基酸序列（代码中用小写字母表示），下面是一个Fasta格式的文件：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt;Q5R5X8|CAP2_PONPY CAP <span class="number">2</span> - Pongo pygmaeus (Orangutan).</div><div class="line">MANMQGLVERLERAVSRLESLSAESHRPPGNCGEVNGVIGGVAPSVEAFDKLMDSMVAEFLKNSRILAGDVETHAEMVHSAFQAQRAFLLMASQYQQPHENDVAALLKPISEKIQEIQTFRERNRGSNMFNHLSAVSESIPALGWIAVSPKPGPYVKEMNDAATFYTNRVLKDYKHSDLRHVDWVKSYLNIWSELQAYIKEHHTTGLTWSKTGPVASTVSAFSVLSSGPGLPPPPPPPPPPGPPPLLENEGKKEESSPSRSALFAQLNQGEAITKGLRHVTDDQKTYKNPSLRAQGGQTRSPTKSHTPSPTSPKSYPSQKHAPVLELEGKKWRVEYQEDRNDLVISETELKQVAYIFKCEKSTLQIKGKVNSIIIDNCKKLGLVFDNVVGIVEVINSQDIQIQVMGRVPTISINKTEGCHIYLSEDALDCEIVSAKSSEMNILIPQDGDYREFPIPEQFKTAWDGSKLITEPAEIMA</div></pre></td></tr></table></figure>
<p>下面的代码实现的就是这个功能，即在1个FASTA文件中寻找这个模式，代码如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> re</div><div class="line">pattern = <span class="string">"[LIVM]&#123;2&#125;.RL[DE].&#123;4&#125;RLE"</span></div><div class="line">fh = open(<span class="string">'D:/prot.fas'</span>)</div><div class="line">fh.readline()</div><div class="line">seq = <span class="string">""</span></div><div class="line"><span class="keyword">for</span> line <span class="keyword">in</span> fh:</div><div class="line">    seq += line.strip()</div><div class="line">rgx = re.compile(pattern)</div><div class="line">result = rgx.search(seq)</div><div class="line">patternfound = result.group()</div><div class="line">span = result.span()</div><div class="line">leftpos = span[<span class="number">0</span>]<span class="number">-10</span></div><div class="line"><span class="keyword">if</span> leftpos &lt; <span class="number">0</span>:</div><div class="line">    leftpos = <span class="number">0</span></div><div class="line">print(seq[leftpos:span[<span class="number">0</span>]].lower() + patternfound + seq[span[<span class="number">1</span>]:span[<span class="number">1</span>]+<span class="number">10</span>].lower())</div><div class="line">fh.close()</div></pre></td></tr></table></figure>
<p>运行代码如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">C:\Users\<span class="number">20161111</span>&gt;python test.py</div><div class="line">manmqgLVERLERAVSRLEslsaeshrpp</div></pre></td></tr></table></figure>
<h3 id="Example9：-清洗序列"><a href="#Example9：-清洗序列" class="headerlink" title="Example9： 清洗序列"></a>Example9： 清洗序列</h3><p>正则表达式在清除序列方面更加常用，需要清理的序列通常是一些非标准的序列，就像下面的这样：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="number">1</span> ATGACCATGA TTACGCCAAG CTCTAATACG ACTCACTATA GGGAAAGCTT GCATGCCTGC</div><div class="line"><span class="number">61</span> AGGTCGACTC TAGAGGATCT ACTAGTCATA TGGATATCGG ATCCCCGGGT ACCGAGCTCG</div><div class="line"><span class="number">121</span> AATTCACTGG CCGTCGTTTT</div></pre></td></tr></table></figure>
<p>这个序列里面有空格，有数字，这些都不是我们所需要的，需要把它们的清除掉，清除序列的代码如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> re</div><div class="line">regex = re.compile(<span class="string">' |\d|\n|\t'</span>) <span class="comment"># 有一个空格</span></div><div class="line">seq = <span class="string">''</span></div><div class="line"><span class="keyword">for</span> line <span class="keyword">in</span> open(<span class="string">'D:/pMOSBlue.txt'</span>):</div><div class="line">    seq += regex.sub(<span class="string">''</span>,line)</div><div class="line">print(seq)</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">C:\Users\<span class="number">20161111</span>&gt;python test.py</div><div class="line">ATGACCATGATTACGCCAAGCTCTAATACGACTCACTATAGGGAAAGCTTGCATGCCTGCAGGTCGACTCTAGAGGATCTACTAGTCATATGGATATCGGATCCCCGGGTACCGAGCTCGAATTCACTGGCCGTCGTTTT</div></pre></td></tr></table></figure>
<p>代码解释：最重要的就是这个模式：<code>regex = re.compile(&#39; |\d|\n|\t&#39;)</code>，其中’ |\d|\n|\t’表示的是，数字或换行，或空格。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2018/04/07/Python/Python学习笔记（7）-条件与循环语句/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/04/07/Python/Python学习笔记（7）-条件与循环语句/" itemprop="url">Python学习笔记（7）-条件与循环语句</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-04-07T12:00:00+08:00">
                2018-04-07
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Python/" itemprop="url" rel="index">
                    <span itemprop="name">Python</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  4,173
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  19
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="条件与循环语句"><a href="#条件与循环语句" class="headerlink" title="条件与循环语句"></a>条件与循环语句</h2><h3 id="条件与循环语句的表达式"><a href="#条件与循环语句的表达式" class="headerlink" title="条件与循环语句的表达式"></a>条件与循环语句的表达式</h3><p>在选择结构和循环结构中，都要根据条件表达式的值来确定下一步的执行流程，条件表达式的值只要不是False、0、0.0、0j、None、空列表、空元组、空集合、空字典、空字符串、空range对象或其他空迭代对象，Python解释器都认为其与True等价，从这个意义上来讲，所有Python合法表达式都可以作为条件表达式，包括含有函数调用的表达式。</p>
<h2 id="if语句"><a href="#if语句" class="headerlink" title="if语句"></a>if语句</h2><h3 id="if条件语句的格式"><a href="#if条件语句的格式" class="headerlink" title="if条件语句的格式"></a>if条件语句的格式</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> condition_1:</div><div class="line">    statement_block_1</div><div class="line"><span class="keyword">elif</span> condition_2:</div><div class="line">    statement_block_2</div><div class="line"><span class="keyword">else</span>:</div><div class="line">    statement_block_3</div></pre></td></tr></table></figure>
<p>参数解释：</p>
<ol>
<li>如果 “condition_1” 为 True 将执行 “statement_block_1” 块语句</li>
<li>如果 “condition_1” 为False，将判断 “condition_2”</li>
<li>如果”condition_2” 为 True 将执行 “statement_block_2” 块语句</li>
<li>如果 “condition_2” 为False，将执行”statement_block_3”块语句</li>
<li>每个条件后面要使用冒号 :，表示接下来是满足条件后要执行的语句块。</li>
<li>使用缩进来划分语句块，相同缩进数的语句在一起组成一个语句块。</li>
</ol>
<h3 id="if案例"><a href="#if案例" class="headerlink" title="if案例"></a>if案例</h3><h4 id="简单的if语句案例："><a href="#简单的if语句案例：" class="headerlink" title="简单的if语句案例："></a>简单的if语句案例：</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">biotest@biotest-VirtualBox:~/python3/<span class="number">02</span>condition$ cat <span class="keyword">if</span>.py </div><div class="line"><span class="comment">#!/usr/bin/python3</span></div><div class="line"></div><div class="line">var1 =<span class="number">100</span></div><div class="line"><span class="keyword">if</span> var1:</div><div class="line">    print(<span class="string">"1 - if expression condition is true"</span>)</div><div class="line">    print(var1)</div><div class="line"></div><div class="line">var2 = <span class="number">0</span></div><div class="line"><span class="keyword">if</span> var2:</div><div class="line">    print(<span class="string">"2 - if expression condition is true"</span>)</div><div class="line">    print(var2)</div><div class="line">print(<span class="string">"Good bye"</span>)</div><div class="line"></div><div class="line">biotest@biotest-VirtualBox:~/python3/<span class="number">02</span>condition$ python3 <span class="keyword">if</span>.py </div><div class="line"><span class="number">1</span> - <span class="keyword">if</span> expression condition <span class="keyword">is</span> true</div><div class="line"><span class="number">100</span></div><div class="line">Good bye</div></pre></td></tr></table></figure>
<h4 id="使用整数作为if条件表达式"><a href="#使用整数作为if条件表达式" class="headerlink" title="使用整数作为if条件表达式"></a>使用整数作为if条件表达式</h4><p>如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">if</span> <span class="number">3</span>:</div><div class="line"><span class="meta">... </span>print(<span class="number">4</span>)</div><div class="line">...</div><div class="line"><span class="number">4</span></div></pre></td></tr></table></figure>
<h4 id="if语句中判断相等是用“-”"><a href="#if语句中判断相等是用“-”" class="headerlink" title="if语句中判断相等是用“==”"></a>if语句中判断相等是用“==”</h4><p>如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>a = <span class="number">8</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">if</span> a == <span class="number">8</span>:</div><div class="line"><span class="meta">... </span>print(a)</div><div class="line">...</div><div class="line"><span class="number">8</span></div></pre></td></tr></table></figure>
<p>代码解释：if a == 8表示：如果条件a==8返回的值是True，就执行下面的语句，此语句后面的冒号是必需的，下面一行语句print(a)前面要有4个空格的缩进。 如果if后面不放语句时，比如空出来用于后续补充，可以用pass语句，就是什么也不做，如下所示：</p>
<h4 id="pass语句"><a href="#pass语句" class="headerlink" title="pass语句"></a>pass语句</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> X &lt; <span class="number">0</span>:</div><div class="line">    <span class="keyword">pass</span></div></pre></td></tr></table></figure>
<p>如果误用了等号作为判断条件，那么就会出错，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">if</span> (a = <span class="number">3</span>) <span class="keyword">and</span> (b = <span class="number">4</span>)</div><div class="line">  File <span class="string">"&lt;stdin&gt;"</span>, line <span class="number">1</span></div><div class="line">    <span class="keyword">if</span> (a = <span class="number">3</span>) <span class="keyword">and</span> (b = <span class="number">4</span>)</div><div class="line">          ^</div><div class="line">SyntaxError: invalid syntax</div></pre></td></tr></table></figure>
<h4 id="列表作为if条件表达式："><a href="#列表作为if条件表达式：" class="headerlink" title="列表作为if条件表达式："></a>列表作为if条件表达式：</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 案例1，非空的列表</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>a = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">if</span> a:</div><div class="line"><span class="meta">... </span>print(a)</div><div class="line">...</div><div class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</div><div class="line"></div><div class="line"><span class="comment"># 案例2，空列表</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>a = []</div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">if</span> a:</div><div class="line"><span class="meta">... </span>    print(a)</div><div class="line"><span class="meta">... </span><span class="keyword">else</span>:</div><div class="line"><span class="meta">... </span>    print(<span class="string">'Empty'</span>)</div><div class="line">...</div><div class="line">Empty</div><div class="line">&gt;&gt;&gt;</div></pre></td></tr></table></figure>
<h4 id="三元运算符"><a href="#三元运算符" class="headerlink" title="三元运算符"></a>三元运算符</h4><p>语法为<code>value1 if condition else value2</code>，当条件表达式condition的值与True等价时，表达式的值为value1，否则表达式的值为value2。value1和value2本身可以是复杂的表达式，也可以包括函数调用，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>a = <span class="number">5</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(<span class="number">6</span>) <span class="keyword">if</span> a &gt; <span class="number">3</span> <span class="keyword">else</span> print(<span class="number">5</span>)</div><div class="line"><span class="number">6</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(<span class="number">6</span> <span class="keyword">if</span> a &gt; <span class="number">3</span> <span class="keyword">else</span> <span class="number">5</span>)</div><div class="line"><span class="number">6</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>b = <span class="number">6</span> <span class="keyword">if</span> a &gt; <span class="number">13</span> <span class="keyword">else</span> <span class="number">9</span> <span class="comment"># 赋值运算符优先级低</span></div><div class="line"></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>b</div><div class="line"><span class="number">9</span></div></pre></td></tr></table></figure>
<p>三元运算符案例第二：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">name = <span class="string">"qiwsir"</span> <span class="keyword">if</span> <span class="string">"laoqi"</span> <span class="keyword">else</span> <span class="string">"github"</span></div><div class="line">print(name)</div><div class="line"> </div><div class="line">name = <span class="string">"qiwsir"</span> <span class="keyword">if</span> <span class="string">""</span> <span class="keyword">else</span> <span class="string">"github"</span></div><div class="line">print(name)</div><div class="line"> </div><div class="line">name = <span class="string">"qiwsir"</span> <span class="keyword">if</span> <span class="string">"github"</span> <span class="keyword">else</span> <span class="string">""</span></div><div class="line">print(name)</div></pre></td></tr></table></figure>
<p>这种操作的公式为： A = Y if X else Z 这表示为： 如果X为真，那么就执行Y。 如果X为假，那么就执行Z。 如下面的案例： </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>x = <span class="number">2</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>y = <span class="number">8</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>a = <span class="string">"python"</span> <span class="keyword">if</span> x &gt; y <span class="keyword">else</span> <span class="string">"qiwsir"</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(a)</div><div class="line">qiwsir</div><div class="line">&gt;&gt;&gt;</div><div class="line"><span class="meta">... </span>x = <span class="number">2</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>y = <span class="number">8</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>a = <span class="string">"python"</span> <span class="keyword">if</span> x &lt; y <span class="keyword">else</span> <span class="string">"qiwsir"</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(a)</div><div class="line">python</div></pre></td></tr></table></figure>
<p>代码解释：在第一步中，因为x&gt;y是假，因此执行Z，即qiwsir，在第二步中，因为x &lt;y 是真，执行Y，即python。其实可以这么理解，这一段代码是从左向右执行的，如果中间的判别式是对的，则就此执行结束，如果中间的判别式是错的，继续向右执行。</p>
<h4 id="多分枝条件语句"><a href="#多分枝条件语句" class="headerlink" title="多分枝条件语句"></a>多分枝条件语句</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">print(<span class="string">"请输入任意一个数字： "</span>)</div><div class="line">number = int(input())</div><div class="line"> </div><div class="line"><span class="keyword">if</span> number == <span class="number">10</span>:</div><div class="line">    print(<span class="string">"您输入的数字是: %d"</span> % number)</div><div class="line">    print(<span class="string">"Youare smart!"</span>)</div><div class="line"><span class="keyword">elif</span> number &gt; <span class="number">10</span>:</div><div class="line">    print(<span class="string">"您输入的数字是&#123;&#125;"</span>.format(number))</div><div class="line">    print(<span class="string">"This number is more than 10"</span>)</div><div class="line"><span class="keyword">elif</span> number &lt; <span class="number">10</span>:</div><div class="line">    print(<span class="string">"您输入的数字是： %d"</span> % number)</div><div class="line">    print(<span class="string">"This number is less than 10"</span>)</div><div class="line"><span class="keyword">else</span>:</div><div class="line">    print(<span class="string">"Are your a human"</span>)</div></pre></td></tr></table></figure>
<p>运行结果如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">请输入任意一个数字：</div><div class="line"><span class="number">23</span></div><div class="line">您输入的数字是<span class="number">23</span></div><div class="line">This number <span class="keyword">is</span> more than <span class="number">10</span></div></pre></td></tr></table></figure>
<p>代码解释：如果输入的是10，则输出You are smart，如果大于10，则执行下一条语句，如果小于10，执行第三条语句，这第一条到第三条一共有3种选择，称为分支。其中elif是else if的缩写。</p>
<h4 id="if语句的嵌套"><a href="#if语句的嵌套" class="headerlink" title="if语句的嵌套"></a>if语句的嵌套</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> x &lt; y:</div><div class="line">    print(<span class="string">"x is less than y"</span>)</div><div class="line"><span class="keyword">elif</span> x &gt; y:</div><div class="line">    print(<span class="string">"x is greater than y"</span>)</div><div class="line"><span class="keyword">else</span>:</div><div class="line">    print(<span class="string">"x and y are equal"</span>)</div></pre></td></tr></table></figure>
<p>上述语句可以改写为嵌套语句，如下所示：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> x == y:</div><div class="line">    print(<span class="string">"x and y are equal"</span>)</div><div class="line"><span class="keyword">else</span>:</div><div class="line">    <span class="keyword">if</span> x &lt; y:</div><div class="line">         print(<span class="string">"x is less than y"</span>)</div><div class="line">    <span class="keyword">else</span>:</div><div class="line">        print(<span class="string">"x is greater than y"</span>)</div></pre></td></tr></table></figure></p>
<p>外部的条件判断包含两个分支。第一个分支只有一个简单的语句。第二个分支包含了另外一重条件判断，这个内部条件判断有两个分支。这两个分支都是简单的语句，他们的位置也可以继续放条件判断语句的。 逻辑运算符有时候对简化嵌套条件判断很有用。比如下面这个代码就能改写成更简单的版本: </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> <span class="number">0</span> &lt; x:</div><div class="line">    <span class="keyword">if</span> x &lt; <span class="number">10</span>:</div><div class="line">        print(<span class="string">"x is a positive single-digit number."</span>)</div></pre></td></tr></table></figure>
<p>上面的例子中，只有两个条件都满足了才会运行print语句，所以就用逻辑运算符来实现同样的效果即可：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> <span class="number">0</span> &lt; x <span class="keyword">and</span> x &lt;<span class="number">10</span>:</div><div class="line">    print(<span class="string">"x is a positive single-digit number."</span>)</div></pre></td></tr></table></figure>
<p>还可以更加简单：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> <span class="number">0</span> &lt; x &lt; <span class="number">10</span>:</div><div class="line">    print(<span class="string">"x is a positive single-digit number."</span>)</div></pre></td></tr></table></figure></p>
<h4 id="案例：if…else-面试资格确认"><a href="#案例：if…else-面试资格确认" class="headerlink" title="案例：if…else:面试资格确认"></a>案例：if…else:面试资格确认</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">age = <span class="number">24</span></div><div class="line">subject = <span class="string">"计算机 "</span></div><div class="line">college = <span class="string">"非重点"</span></div><div class="line"><span class="keyword">if</span> (age &gt; <span class="number">25</span> <span class="keyword">and</span> subject ==<span class="string">"电子信息工程 "</span>) <span class="keyword">or</span> (college ==<span class="string">"重点"</span> <span class="keyword">and</span> subject ==<span class="string">"电子信息工程"</span>) <span class="keyword">or</span> (age&lt;=<span class="number">28</span> <span class="keyword">and</span> subject==<span class="string">"计算机"</span>):</div><div class="line">    print(<span class="string">"恭喜，您已经获得我公司的面试机会！"</span>)</div><div class="line"><span class="keyword">else</span>:</div><div class="line">    print(<span class="string">"抱歉，您未达到面试要求"</span>)</div></pre></td></tr></table></figure>
<h4 id="案例if：判断今天是今年的第几天。"><a href="#案例if：判断今天是今年的第几天。" class="headerlink" title="案例if：判断今天是今年的第几天。"></a>案例if：判断今天是今年的第几天。</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> time</div><div class="line">date = time.localtime()</div><div class="line"><span class="comment"># 获取当前日期时间</span></div><div class="line"></div><div class="line">year,month,day=date[:<span class="number">3</span>]</div><div class="line">day_month=[<span class="number">31</span>,<span class="number">28</span>,<span class="number">31</span>,<span class="number">30</span>,<span class="number">31</span>,<span class="number">30</span>,<span class="number">31</span>,<span class="number">31</span>,<span class="number">30</span>,<span class="number">31</span>,<span class="number">30</span>,<span class="number">31</span>]</div><div class="line"></div><div class="line"><span class="keyword">if</span> year%<span class="number">400</span> == <span class="number">0</span> <span class="keyword">or</span> (year%<span class="number">4</span>==<span class="number">0</span> <span class="keyword">and</span> year%<span class="number">100</span>!=<span class="number">0</span>):</div><div class="line"><span class="comment"># 判断是否为闰年</span></div><div class="line">    day_month[<span class="number">1</span>] = <span class="number">29</span></div><div class="line">    </div><div class="line"><span class="keyword">if</span> month ==<span class="number">1</span>:</div><div class="line">    print(day)</div><div class="line"><span class="keyword">else</span>:</div><div class="line">    print(sum(day_month[:month<span class="number">-1</span>])+day)</div></pre></td></tr></table></figure>
<h2 id="while语句"><a href="#while语句" class="headerlink" title="while语句"></a>while语句</h2><p>while语句的格式如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">while</span> 判断条件：</div><div class="line">    语句</div></pre></td></tr></table></figure>
<h3 id="while语句案例"><a href="#while语句案例" class="headerlink" title="while语句案例"></a>while语句案例</h3><h4 id="简单案例"><a href="#简单案例" class="headerlink" title="简单案例"></a>简单案例</h4><p>以下实例使用了 while 来计算 1 到 100 的总和： </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">biotest@biotest-VirtualBox:~/python3/<span class="number">02</span>condition$ cat <span class="keyword">while</span>.py </div><div class="line"><span class="comment">#!/usr/bin/python3</span></div><div class="line"></div><div class="line">n = <span class="number">100</span></div><div class="line"></div><div class="line">sum = <span class="number">0</span></div><div class="line">counter = <span class="number">1</span></div><div class="line"><span class="keyword">while</span> counter &lt;= n:</div><div class="line">    sum = sum + counter</div><div class="line">    counter +=<span class="number">1</span></div><div class="line"></div><div class="line">print(<span class="string">"1 to %d sum up is: %d"</span>%(n, sum))</div><div class="line">biotest@biotest-VirtualBox:~/python3/<span class="number">02</span>condition$ python3 <span class="keyword">while</span>.py </div><div class="line"><span class="number">1</span> to <span class="number">100</span> sum up <span class="keyword">is</span>: <span class="number">5050</span></div></pre></td></tr></table></figure>
<h4 id="常量作为while的条件表达式"><a href="#常量作为while的条件表达式" class="headerlink" title="常量作为while的条件表达式"></a>常量作为while的条件表达式</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">i = s = <span class="number">0</span></div><div class="line"><span class="keyword">while</span> i &lt;= <span class="number">10</span>:</div><div class="line"><span class="meta">... </span>s+=i</div><div class="line"><span class="meta">... </span>i+=<span class="number">1</span></div><div class="line">...</div><div class="line">print(s)</div><div class="line"><span class="number">55</span></div></pre></td></tr></table></figure>
<h4 id="break语句"><a href="#break语句" class="headerlink" title="break语句"></a>break语句</h4><p>在while循环语句，满足一定条件时，用break跳出循环：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>i =s=<span class="number">0</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">while</span> <span class="keyword">True</span>:</div><div class="line"><span class="meta">... </span>    s+=i</div><div class="line"><span class="meta">... </span>    i+=<span class="number">1</span></div><div class="line"><span class="meta">... </span>    <span class="keyword">if</span> i &gt; <span class="number">10</span>:</div><div class="line"><span class="meta">... </span>        <span class="keyword">break</span></div><div class="line">...</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(s)</div><div class="line"><span class="number">55</span></div></pre></td></tr></table></figure>
<h4 id="while案例"><a href="#while案例" class="headerlink" title="while案例"></a>while案例</h4><p>用户输入若干个成绩，求所有成绩的平均分。每输入一个成绩后询问是否继续输入下一个成绩，回答yes就继续输入下一个成绩，回答no就停止输入成绩。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">numbers = []</div><div class="line"><span class="keyword">while</span> <span class="keyword">True</span>:</div><div class="line">    x = input(<span class="string">'请输入一个整数:'</span>)</div><div class="line">    <span class="keyword">try</span>:</div><div class="line">        numbers.append(int(x))</div><div class="line">    <span class="keyword">except</span>:</div><div class="line">        print(<span class="string">'不是整数'</span>)</div><div class="line">    <span class="keyword">while</span> <span class="keyword">True</span>:</div><div class="line">        flag = input(<span class="string">'继续输入吗？（yes/no）'</span>)</div><div class="line">        <span class="keyword">if</span> flag.lower() <span class="keyword">not</span> <span class="keyword">in</span> (<span class="string">'yes'</span>,<span class="string">'no'</span>):</div><div class="line">            print(<span class="string">"只能输入yes或no"</span>)</div><div class="line">        <span class="keyword">else</span>:</div><div class="line">            <span class="keyword">break</span></div><div class="line">    <span class="keyword">if</span> flag.lower()==<span class="string">'no'</span>:</div><div class="line">        <span class="keyword">break</span></div><div class="line"></div><div class="line">print(sum(numbers)/len(numbers))</div></pre></td></tr></table></figure></p>
<h2 id="for语句"><a href="#for语句" class="headerlink" title="for语句"></a>for语句</h2><p>Python中主要有两种形式的循环结构，for循环和while循环。while循环一般用于循环次数难以提前确定的情况；而for循环一般用于循环次数可以提前确定的情况，尤其适用于枚举或遍历序列或迭代对象中元素的场合。当循环带有else子句时，如果循环因子条件因为条件青工达不成立或序列遍历结束而自然结束时则执行else结构中的语句，如果循环是因为执行了break语句而导致循环提前结束则不执行else中的语句，其完整语法形式为： </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">while</span> 条件表达式：</div><div class="line">       循环体</div><div class="line"><span class="keyword">else</span>：</div><div class="line">    <span class="keyword">else</span> 子句代码块</div></pre></td></tr></table></figure>
<p>或者是：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">for</span> 取值 <span class="keyword">in</span> 序列或迭代对象：</div><div class="line">    循环语句</div><div class="line"><span class="keyword">else</span>:</div><div class="line">    <span class="keyword">else</span>子句代码块</div></pre></td></tr></table></figure>
<h3 id="for循环中常用的操作符"><a href="#for循环中常用的操作符" class="headerlink" title="for循环中常用的操作符"></a>for循环中常用的操作符</h3><div class="table-container">
<table>
<thead>
<tr>
<th>操作符</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>&lt;</td>
<td>小于</td>
</tr>
<tr>
<td>&lt;=</td>
<td>小于或等于</td>
</tr>
<tr>
<td>&gt;</td>
<td>大于</td>
</tr>
<tr>
<td>&gt;=</td>
<td>大于或等于</td>
</tr>
<tr>
<td>==</td>
<td>等于，比较对象是否相等</td>
</tr>
<tr>
<td>!=</td>
<td>不等于</td>
</tr>
</tbody>
</table>
</div>
<h3 id="for循环案例"><a href="#for循环案例" class="headerlink" title="for循环案例"></a>for循环案例</h3><h4 id="简单案例-1"><a href="#简单案例-1" class="headerlink" title="简单案例"></a>简单案例</h4><p>使用for循环遍历：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, <span class="number">11</span>,<span class="number">1</span>):</div><div class="line"><span class="meta">... </span>s +=i</div><div class="line">...</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(s)</div><div class="line"><span class="number">110</span></div></pre></td></tr></table></figure>
<h4 id="带有else子句的循环结构"><a href="#带有else子句的循环结构" class="headerlink" title="带有else子句的循环结构"></a>带有else子句的循环结构</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>s = <span class="number">0</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, <span class="number">101</span>):</div><div class="line"><span class="meta">... </span>s +=i</div><div class="line"><span class="meta">... </span><span class="keyword">else</span>:</div><div class="line"><span class="meta">... </span>print(s)</div><div class="line">...</div><div class="line"><span class="number">5050</span></div></pre></td></tr></table></figure>
<h4 id="带有while的循环结构"><a href="#带有while的循环结构" class="headerlink" title="带有while的循环结构"></a>带有while的循环结构</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">while</span> i &lt;= <span class="number">100</span>:</div><div class="line"><span class="meta">... </span>s += i</div><div class="line"><span class="meta">... </span>i += i</div><div class="line"><span class="meta">... </span><span class="keyword">else</span>:</div><div class="line"><span class="meta">... </span>print(s)</div><div class="line">...</div><div class="line"><span class="number">5150</span></div><div class="line">&gt;&gt;&gt;</div></pre></td></tr></table></figure>
<h4 id="显示元组中的每个元素"><a href="#显示元组中的每个元素" class="headerlink" title="显示元组中的每个元素"></a>显示元组中的每个元素</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, <span class="number">5</span>):</div><div class="line"><span class="meta">... </span>print(i)</div><div class="line"><span class="meta">... </span><span class="keyword">else</span>:</div><div class="line"><span class="meta">... </span>print(<span class="string">'The for loop is over'</span>)</div><div class="line">...</div><div class="line"><span class="number">1</span></div><div class="line"><span class="number">2</span></div><div class="line"><span class="number">3</span></div><div class="line"><span class="number">4</span></div><div class="line">The <span class="keyword">for</span> loop <span class="keyword">is</span> over</div></pre></td></tr></table></figure>
<h4 id="打印字符串中的每个元素"><a href="#打印字符串中的每个元素" class="headerlink" title="打印字符串中的每个元素"></a>打印字符串中的每个元素</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>hello = <span class="string">"world"</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">for</span> i <span class="keyword">in</span> hello:</div><div class="line"><span class="meta">... </span>print(i)</div><div class="line">...</div><div class="line">w</div><div class="line">o</div><div class="line">r</div><div class="line">l</div><div class="line">d</div></pre></td></tr></table></figure>
<h4 id="根据索引显示每个字符"><a href="#根据索引显示每个字符" class="headerlink" title="根据索引显示每个字符"></a>根据索引显示每个字符</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">for</span> i <span class="keyword">in</span> range(len(hello)):</div><div class="line"><span class="meta">... </span>print(i)</div><div class="line">...</div><div class="line"><span class="number">0</span></div><div class="line"><span class="number">1</span></div><div class="line"><span class="number">2</span></div><div class="line"><span class="number">3</span></div><div class="line"><span class="number">4</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(<span class="string">"根据每个字符的索引显示每个字符"</span>)</div><div class="line">根据每个字符的索引显示每个字符</div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">for</span> i <span class="keyword">in</span> range(len(hello)):</div><div class="line"><span class="meta">... </span>print(hello[i])</div><div class="line">...</div><div class="line">w</div><div class="line">o</div><div class="line">r</div><div class="line">l</div><div class="line">d</div><div class="line">&gt;&gt;&gt;</div></pre></td></tr></table></figure>
<h3 id="range-函数的用法"><a href="#range-函数的用法" class="headerlink" title="range()函数的用法"></a>range()函数的用法</h3><p>range()函数经常与for循环配合使用，它的用法是<code>range(a,b,c)</code>，其中c为步长，a与b是范围，先看一个简单的案例：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(list(range(<span class="number">0</span>,<span class="number">9</span>,<span class="number">1</span>)))</div><div class="line">[<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(list(range(<span class="number">0</span>,<span class="number">9</span>,<span class="number">2</span>)))</div><div class="line">[<span class="number">0</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">8</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(list(range(<span class="number">0</span>,<span class="number">9</span>,<span class="number">3</span>)))</div><div class="line">[<span class="number">0</span>, <span class="number">3</span>, <span class="number">6</span>]</div></pre></td></tr></table></figure>
<p>如果你需要遍历数字序列，可以使用内置range()函数。它会生成数列，例如: </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">&gt;&gt;&gt;<span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">5</span>):</div><div class="line"><span class="meta">... </span>    print(i)</div><div class="line">...</div><div class="line"><span class="number">0</span></div><div class="line"><span class="number">1</span></div><div class="line"><span class="number">2</span></div><div class="line"><span class="number">3</span></div><div class="line"><span class="number">4</span></div></pre></td></tr></table></figure>
<p>或者指定区间，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">&gt;&gt;&gt;<span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">5</span>,<span class="number">9</span>) :</div><div class="line">    print(i)</div><div class="line"> </div><div class="line">    </div><div class="line"><span class="number">5</span></div><div class="line"><span class="number">6</span></div><div class="line"><span class="number">7</span></div><div class="line"><span class="number">8</span></div><div class="line">&gt;&gt;&gt;</div></pre></td></tr></table></figure>
<h4 id="range-函数控制循环次数。"><a href="#range-函数控制循环次数。" class="headerlink" title="range()函数控制循环次数。"></a>range()函数控制循环次数。</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">(n)</span>:</span></div><div class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(n):</div><div class="line">        print((<span class="string">' * '</span>*i).center(n*<span class="number">3</span>))</div><div class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(n, <span class="number">0</span>, <span class="number">-1</span>):</div><div class="line">        print((<span class="string">' * '</span>*i).center(n*<span class="number">3</span>))</div><div class="line">main(<span class="number">6</span>)</div></pre></td></tr></table></figure>
<h4 id="案例：找出100以内能被3整除的正整数"><a href="#案例：找出100以内能被3整除的正整数" class="headerlink" title="案例：找出100以内能被3整除的正整数"></a>案例：找出100以内能被3整除的正整数</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>aliquot = []</div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">for</span> n <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">100</span>):</div><div class="line"><span class="meta">... </span><span class="keyword">if</span> n % <span class="number">3</span> == <span class="number">0</span>:</div><div class="line"><span class="meta">... </span>aliquot.append(n)</div><div class="line">...</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(aliquot)</div><div class="line">[<span class="number">3</span>, <span class="number">6</span>, <span class="number">9</span>, <span class="number">12</span>, <span class="number">15</span>, <span class="number">18</span>, <span class="number">21</span>, <span class="number">24</span>, <span class="number">27</span>, <span class="number">30</span>, <span class="number">33</span>, <span class="number">36</span>, <span class="number">39</span>, <span class="number">42</span>, <span class="number">45</span>, <span class="number">48</span>, <span class="number">51</span>, <span class="number">54</span>, <span class="number">57</span>, <span class="number">60</span>, <span class="number">63</span>, <span class="number">66</span>, <span class="number">69</span>, <span class="number">72</span>, <span class="number">75</span>, <span class="number">78</span>, <span class="number">81</span>, <span class="number">84</span>, <span class="number">87</span>, <span class="number">90</span>, <span class="number">93</span>, <span class="number">96</span>, <span class="number">99</span>]</div><div class="line">&gt;&gt;&gt;</div></pre></td></tr></table></figure>
<h4 id="for循环遍历序列类型对象"><a href="#for循环遍历序列类型对象" class="headerlink" title="for循环遍历序列类型对象"></a>for循环遍历序列类型对象</h4><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>name_str = <span class="string">"test"</span> <span class="comment"># 字符串</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(type(name_str))</div><div class="line">&lt;<span class="class"><span class="keyword">class</span> '<span class="title">str</span>'&gt;</span></div><div class="line"><span class="class">&gt;&gt;&gt; <span class="title">for</span> <span class="title">i</span> <span class="title">in</span> <span class="title">name_str</span>:</span></div><div class="line"><span class="meta">... </span>print(i)</div><div class="line"><span class="meta">... </span><span class="comment">##-----------##</span></div><div class="line">...</div><div class="line">t</div><div class="line">e</div><div class="line">s</div><div class="line">t</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>name_list = list(name_str) <span class="comment"># 列表</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(name_str)</div><div class="line">test</div><div class="line">&gt;&gt;&gt;</div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">for</span> i <span class="keyword">in</span> name_list: <span class="comment"># 列表的循环</span></div><div class="line"><span class="meta">... </span>print(i)</div><div class="line"><span class="meta">... </span><span class="comment">##-----------##</span></div><div class="line">...</div><div class="line">t</div><div class="line">e</div><div class="line">s</div><div class="line">t</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>name_set = set(name_str) <span class="comment"># 集合</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(name_set)</div><div class="line">&#123;<span class="string">'e'</span>, <span class="string">'s'</span>, <span class="string">'t'</span>&#125;</div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="comment">##-----------##</span></div><div class="line">...</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>name_tuple = tuple(name_str) <span class="comment"># 元组</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">for</span> i <span class="keyword">in</span> name_tuple:</div><div class="line"><span class="meta">... </span>print(i)</div><div class="line"><span class="meta">... </span><span class="comment">##-----------##</span></div><div class="line">...</div><div class="line">t</div><div class="line">e</div><div class="line">s</div><div class="line">t</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>name_dict = &#123;<span class="string">"name"</span>: <span class="string">"qiwsir"</span>, <span class="string">"lang"</span>: <span class="string">"python"</span>, <span class="string">"website"</span>: <span class="string">"qiwsir.github.io"</span>&#125; <span class="comment"># 字典</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">for</span> i <span class="keyword">in</span> name_dict:</div><div class="line"><span class="meta">... </span>print(i, <span class="string">"--&gt;"</span>, name_dict[i])</div><div class="line">...</div><div class="line">name --&gt; qiwsir</div><div class="line">lang --&gt; python</div><div class="line">website --&gt; qiwsir.github.io</div></pre></td></tr></table></figure>
<h4 id="遍历字典元素"><a href="#遍历字典元素" class="headerlink" title="遍历字典元素"></a>遍历字典元素</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>a_dict = &#123;<span class="string">"name"</span>:<span class="string">"qiwsir"</span>,<span class="string">"lang"</span>:<span class="string">"python"</span>,<span class="string">"email"</span>:<span class="string">"qiwsir@gmail.com"</span>,<span class="string">"website"</span>:<span class="string">"www.itdiffer.com"</span>&#125;</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(a_dict)</div><div class="line">&#123;<span class="string">'name'</span>: <span class="string">'qiwsir'</span>, <span class="string">'lang'</span>: <span class="string">'python'</span>, <span class="string">'email'</span>: <span class="string">'qiwsir@gmail.com'</span>, <span class="string">'website'</span>: <span class="string">'www.itdiffer.com'</span>&#125;</div><div class="line">&gt;&gt;&gt;</div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">for</span> k,v <span class="keyword">in</span> a_dict.items():</div><div class="line"><span class="meta">... </span>print(k,v)</div><div class="line">...</div><div class="line">name qiwsir</div><div class="line">lang python</div><div class="line">email qiwsir@gmail.com</div><div class="line">website www.itdiffer.com</div></pre></td></tr></table></figure>
<h4 id="案例：计算两个列表中对应元素的和"><a href="#案例：计算两个列表中对应元素的和" class="headerlink" title="案例：计算两个列表中对应元素的和"></a>案例：计算两个列表中对应元素的和</h4><p>两个列表分别为：a = [1,2,3,4,5]和b = [9,8,7,6,5]，如下所示：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>a = [<span class="number">71</span>,<span class="number">22</span>,<span class="number">663</span>,<span class="number">64</span>,<span class="number">15</span>] </div><div class="line"><span class="meta">&gt;&gt;&gt; </span>b = [<span class="number">19</span>,<span class="number">48</span>,<span class="number">74</span>,<span class="number">46</span>,<span class="number">54</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>c = []</div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">for</span> i <span class="keyword">in</span> range(len(a)):</div><div class="line"><span class="meta">... </span>c.append(a[i] + b[i])</div><div class="line">...</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(c)</div><div class="line">[<span class="number">90</span>, <span class="number">70</span>, <span class="number">737</span>, <span class="number">110</span>, <span class="number">69</span>]</div></pre></td></tr></table></figure></p>
<h4 id="案例：将值与键进行转换"><a href="#案例：将值与键进行转换" class="headerlink" title="案例：将值与键进行转换"></a>案例：将值与键进行转换</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>yinfor = &#123;<span class="string">"name"</span>:<span class="string">"qiwsir"</span>,<span class="string">"sit"</span>:<span class="string">"qiwsir.github.io"</span>,<span class="string">"lang"</span>:<span class="string">"python"</span>&#125;</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(yinfor)</div><div class="line">&#123;<span class="string">'name'</span>: <span class="string">'qiwsir'</span>, <span class="string">'sit'</span>: <span class="string">'qiwsir.github.io'</span>, <span class="string">'lang'</span>: <span class="string">'python'</span>&#125;</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>infor = &#123;&#125;</div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">for</span> k,v <span class="keyword">in</span> yinfor.items():</div><div class="line"><span class="meta">... </span>infor[v] = k</div><div class="line">...</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(infor)</div><div class="line">&#123;<span class="string">'qiwsir'</span>: <span class="string">'name'</span>, <span class="string">'qiwsir.github.io'</span>: <span class="string">'sit'</span>, <span class="string">'python'</span>: <span class="string">'lang'</span>&#125;</div></pre></td></tr></table></figure>
<h4 id="案例-字符的切片及循环"><a href="#案例-字符的切片及循环" class="headerlink" title="案例:字符的切片及循环"></a>案例:字符的切片及循环</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>raw = <span class="string">"Do you love Python? Python is a good script"</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>raw_list = raw.split(<span class="string">" "</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(raw_list)</div><div class="line">[<span class="string">'Do'</span>, <span class="string">'you'</span>, <span class="string">'love'</span>, <span class="string">'Python?'</span>, <span class="string">'Python'</span>, <span class="string">'is'</span>, <span class="string">'a'</span>, <span class="string">'good'</span>, <span class="string">'script'</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">for</span> i, string <span class="keyword">in</span> enumerate(raw_list):</div><div class="line"><span class="meta">... </span><span class="keyword">if</span> string == <span class="string">"Python"</span>:</div><div class="line"><span class="meta">... </span>raw_list[i] = <span class="string">"Ruby"</span></div><div class="line">...</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(raw_list)</div><div class="line">[<span class="string">'Do'</span>, <span class="string">'you'</span>, <span class="string">'love'</span>, <span class="string">'Python?'</span>, <span class="string">'Ruby'</span>, <span class="string">'is'</span>, <span class="string">'a'</span>, <span class="string">'good'</span>, <span class="string">'script'</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="comment"># 发现有问题，继续修改：</span></div><div class="line">...</div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">for</span> i, string <span class="keyword">in</span> enumerate(raw_list):</div><div class="line"><span class="meta">... </span><span class="keyword">if</span> <span class="string">"Python"</span> <span class="keyword">in</span> string:</div><div class="line"><span class="meta">... </span>raw_list[i] = <span class="string">"Ruby"</span></div><div class="line">...</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(raw_list)</div><div class="line">[<span class="string">'Do'</span>, <span class="string">'you'</span>, <span class="string">'love'</span>, <span class="string">'Ruby'</span>, <span class="string">'Ruby'</span>, <span class="string">'is'</span>, <span class="string">'a'</span>, <span class="string">'good'</span>, <span class="string">'script'</span>]</div><div class="line">&gt;&gt;&gt;</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(<span class="string">" "</span>.join(raw_list))</div><div class="line">Do you love Ruby Ruby <span class="keyword">is</span> a good script</div></pre></td></tr></table></figure>
<h4 id="for…else：求1到99中的整数根"><a href="#for…else：求1到99中的整数根" class="headerlink" title="for…else：求1到99中的整数根"></a>for…else：求1到99中的整数根</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> math <span class="keyword">import</span> sqrt</div><div class="line">&gt;&gt;&gt;</div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">for</span> n <span class="keyword">in</span> range(<span class="number">99</span>,<span class="number">1</span>,<span class="number">-1</span>): <span class="comment"># n是从99到1的整数</span></div><div class="line"><span class="meta">... </span>root = sqrt(n) <span class="comment"># root是对n开根号</span></div><div class="line"><span class="meta">... </span><span class="keyword">if</span> root == int(root): <span class="comment"># 如果root是整数，就打印n，并中断</span></div><div class="line"><span class="meta">... </span>print(n)</div><div class="line"><span class="meta">... </span><span class="keyword">break</span></div><div class="line"><span class="meta">... </span><span class="keyword">else</span>:</div><div class="line"><span class="meta">... </span>print(<span class="string">"Nothing"</span>)</div><div class="line">...</div><div class="line"><span class="number">81</span></div></pre></td></tr></table></figure>
<h4 id="案例-for…break-：求200以内能被17整除的最大正整数"><a href="#案例-for…break-：求200以内能被17整除的最大正整数" class="headerlink" title="案例(for…break)：求200以内能被17整除的最大正整数"></a>案例(for…break)：求200以内能被17整除的最大正整数</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">200</span>,<span class="number">0</span>,<span class="number">-2</span>):</div><div class="line"><span class="meta">... </span><span class="keyword">if</span> i%<span class="number">17</span> ==<span class="number">0</span>:</div><div class="line"><span class="meta">... </span>print(i)</div><div class="line"><span class="meta">... </span><span class="keyword">break</span></div><div class="line">...</div><div class="line"><span class="number">170</span></div></pre></td></tr></table></figure>
<h4 id="案例：鸡兔同笼的问题"><a href="#案例：鸡兔同笼的问题" class="headerlink" title="案例：鸡兔同笼的问题"></a>案例：鸡兔同笼的问题</h4><p>假设共有鸡、兔30只，脚90只，求鸡、兔各有多少只？</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">for</span> cock <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">30</span>):</div><div class="line"><span class="meta">... </span>rabbit = <span class="number">30</span>-cock</div><div class="line"><span class="meta">... </span><span class="keyword">if</span> rabbit*<span class="number">4</span> + cock*<span class="number">2</span>== <span class="number">90</span>:</div><div class="line"><span class="meta">... </span>print(<span class="string">'鸡的数量为'</span>,cock,<span class="string">'只'</span>)</div><div class="line"><span class="meta">... </span>print(<span class="string">'兔的数量为'</span>,rabbit,<span class="string">'只'</span>)</div><div class="line">...</div><div class="line">鸡的数量为 <span class="number">15</span> 只</div><div class="line">兔的数量为 <span class="number">15</span> 只</div></pre></td></tr></table></figure>
<h4 id="案例4：求1-100之间能被7整除，但不能同时被5整除的所有整数。"><a href="#案例4：求1-100之间能被7整除，但不能同时被5整除的所有整数。" class="headerlink" title="案例4：求1~100之间能被7整除，但不能同时被5整除的所有整数。"></a>案例4：求1~100之间能被7整除，但不能同时被5整除的所有整数。</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">for</span> n <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">101</span>):</div><div class="line"><span class="meta">... </span><span class="keyword">if</span> (n%<span class="number">7</span> ==<span class="number">0</span>) <span class="keyword">and</span> n%<span class="number">5</span>!=<span class="number">0</span>:</div><div class="line"><span class="meta">... </span>print(n)</div><div class="line">...</div><div class="line"><span class="number">7</span></div><div class="line"><span class="number">14</span></div><div class="line"><span class="number">21</span></div><div class="line"><span class="number">28</span></div><div class="line"><span class="number">42</span></div><div class="line"><span class="number">49</span></div><div class="line"><span class="number">56</span></div><div class="line"><span class="number">63</span></div><div class="line"><span class="number">77</span></div><div class="line"><span class="number">84</span></div><div class="line"><span class="number">91</span></div><div class="line"><span class="number">98</span></div></pre></td></tr></table></figure>
<h4 id="案例：输出水仙花数"><a href="#案例：输出水仙花数" class="headerlink" title="案例：输出水仙花数"></a>案例：输出水仙花数</h4><p>所谓水仙花数，是指一个3位的十进制数，其余各位数字的立方和恰好等于该数本身。例如，153是水仙花数，因为<code>153=1^3+5^3+3^3</code>。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">100</span>,<span class="number">1000</span>):</div><div class="line"><span class="meta">... </span>ge = i%<span class="number">10</span></div><div class="line"><span class="meta">... </span>shi = i//<span class="number">10</span>%<span class="number">10</span></div><div class="line"><span class="meta">... </span>bai = i//<span class="number">100</span></div><div class="line"><span class="meta">... </span><span class="keyword">if</span> ge**<span class="number">3</span> + shi**<span class="number">3</span> + bai**<span class="number">3</span> ==i:</div><div class="line"><span class="meta">... </span>print(i)</div><div class="line">...</div><div class="line"><span class="number">153</span></div><div class="line"><span class="number">370</span></div><div class="line"><span class="number">371</span></div><div class="line"><span class="number">407</span></div></pre></td></tr></table></figure>
<h4 id="案例：求200以内能被17整除的最大正整数。"><a href="#案例：求200以内能被17整除的最大正整数。" class="headerlink" title="案例：求200以内能被17整除的最大正整数。"></a>案例：求200以内能被17整除的最大正整数。</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">200</span>,<span class="number">0</span>,<span class="number">-2</span>):</div><div class="line"><span class="meta">... </span><span class="keyword">if</span> i%<span class="number">17</span> ==<span class="number">0</span>:</div><div class="line"><span class="meta">... </span>print(i)</div><div class="line"><span class="meta">... </span><span class="keyword">break</span></div><div class="line">...</div><div class="line"><span class="number">170</span></div></pre></td></tr></table></figure>
<h4 id="案例9：while…break判断一个数字的奇偶数"><a href="#案例9：while…break判断一个数字的奇偶数" class="headerlink" title="案例9：while…break判断一个数字的奇偶数"></a>案例9：while…break判断一个数字的奇偶数</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>a = <span class="number">8</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">while</span> a:</div><div class="line"><span class="meta">... </span><span class="keyword">if</span> a % <span class="number">2</span> == <span class="number">0</span>:</div><div class="line"><span class="meta">... </span><span class="keyword">break</span></div><div class="line"><span class="meta">... </span><span class="keyword">else</span>:</div><div class="line"><span class="meta">... </span>print(<span class="string">"%d is olld number"</span>%a)</div><div class="line"><span class="meta">... </span>a = <span class="number">0</span></div><div class="line">...</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(<span class="string">"%d is even number"</span>%a)</div><div class="line"><span class="number">8</span> <span class="keyword">is</span> even number</div></pre></td></tr></table></figure>
<p>当a=8的时候，执行循环体中的break跳出循环，执行最后的打印语句，得到结果8 is even number，如果a=9，如下所示： </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>a = <span class="number">9</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">while</span> a:</div><div class="line"><span class="meta">... </span><span class="keyword">if</span> a % <span class="number">2</span> == <span class="number">0</span>:</div><div class="line"><span class="meta">... </span><span class="keyword">break</span></div><div class="line"><span class="meta">... </span><span class="keyword">else</span>:</div><div class="line"><span class="meta">... </span>print(<span class="string">"%d is odd number"</span>%a)</div><div class="line"><span class="meta">... </span>a = <span class="number">0</span></div><div class="line">...</div><div class="line"><span class="number">9</span> <span class="keyword">is</span> odd number</div></pre></td></tr></table></figure>
<p>此时会跳过break，进入else下面的语句。 </p>
<h2 id="enumerate函数"><a href="#enumerate函数" class="headerlink" title="enumerate函数"></a>enumerate函数</h2><p>enumerate()是python的内置函数。</p>
<p>enumerate在字典上是枚举、列举的意思，对于一个可迭代的（iterable）/可遍历的对象（如列表、字符串），enumerate将其组成一个索引序列，利用它可以同时获得索引和值。enumerate多用于在for循环中得到计数。</p>
<h3 id="同时得到一个元素的索引和内容"><a href="#同时得到一个元素的索引和内容" class="headerlink" title="同时得到一个元素的索引和内容"></a>同时得到一个元素的索引和内容</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>seasons = [<span class="string">'Spring'</span>,<span class="string">'Summer'</span>,<span class="string">'Fall'</span>,<span class="string">'Winter'</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(seasons)</div><div class="line">[<span class="string">'Spring'</span>, <span class="string">'Summer'</span>, <span class="string">'Fall'</span>, <span class="string">'Winter'</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(list(enumerate(seasons)))</div><div class="line">[(<span class="number">0</span>, <span class="string">'Spring'</span>), (<span class="number">1</span>, <span class="string">'Summer'</span>), (<span class="number">2</span>, <span class="string">'Fall'</span>), (<span class="number">3</span>, <span class="string">'Winter'</span>)]</div></pre></td></tr></table></figure>
<h3 id="使用案例"><a href="#使用案例" class="headerlink" title="使用案例"></a>使用案例</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>seasons = [<span class="string">'Spring'</span>,<span class="string">'Summer'</span>,<span class="string">'Fall'</span>,<span class="string">'Winter'</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(seasons)</div><div class="line">[<span class="string">'Spring'</span>, <span class="string">'Summer'</span>, <span class="string">'Fall'</span>, <span class="string">'Winter'</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(list(enumerate(seasons,start=<span class="number">3</span>)))</div><div class="line">[(<span class="number">3</span>, <span class="string">'Spring'</span>), (<span class="number">4</span>, <span class="string">'Summer'</span>), (<span class="number">5</span>, <span class="string">'Fall'</span>), (<span class="number">6</span>, <span class="string">'Winter'</span>)]</div></pre></td></tr></table></figure>
<h3 id="列表元素的提取"><a href="#列表元素的提取" class="headerlink" title="列表元素的提取"></a>列表元素的提取</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>mylist = [<span class="string">"qiwsir"</span>,<span class="number">703</span>,<span class="string">'python'</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(mylist)</div><div class="line">[<span class="string">'qiwsir'</span>, <span class="number">703</span>, <span class="string">'python'</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(list(enumerate(mylist)))</div><div class="line">[(<span class="number">0</span>, <span class="string">'qiwsir'</span>), (<span class="number">1</span>, <span class="number">703</span>), (<span class="number">2</span>, <span class="string">'python'</span>)]</div></pre></td></tr></table></figure>
<h2 id="break语句-1"><a href="#break语句-1" class="headerlink" title="break语句"></a>break语句</h2><p>break语句和continue语句在while循环及for循环中都可以使用，并且一般常与选择结构结合使用。break 语句可以跳出 for 和 while 的循环体。如果你从 for 或 while 循环中终止，任何对应的循环 else 块将不执行，如下所示：</p>
<h3 id="简单break案例"><a href="#简单break案例" class="headerlink" title="简单break案例"></a>简单break案例</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">如果你需要遍历数字序列，可以使用内置range()函数。它会生成数列，例如: </div><div class="line"></div><div class="line">​```python</div><div class="line">&gt;&gt;&gt;<span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">5</span>):</div><div class="line"><span class="meta">... </span>    print(i)</div><div class="line">...</div><div class="line"><span class="number">0</span></div><div class="line"><span class="number">1</span></div><div class="line"><span class="number">2</span></div><div class="line"><span class="number">3</span></div><div class="line"><span class="number">4</span></div><div class="line">​</div></pre></td></tr></table></figure>
<p>或者指定区间，如下所示：</p>
<p>​<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">&gt;&gt;&gt;<span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">5</span>,<span class="number">9</span>) :</div><div class="line">    print(i)</div><div class="line"> </div><div class="line">    </div><div class="line"><span class="number">5</span></div><div class="line"><span class="number">6</span></div><div class="line"><span class="number">7</span></div><div class="line"><span class="number">8</span></div><div class="line">&gt;&gt;&gt;</div><div class="line">​</div></pre></td></tr></table></figure></p>
<h4 id="range-函数控制循环次数。-1"><a href="#range-函数控制循环次数。-1" class="headerlink" title="range()函数控制循环次数。"></a>range()函数控制循环次数。</h4><p>​<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">(n)</span>:</span></div><div class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(n):</div><div class="line">        print((<span class="string">' * '</span>*i).center(n*<span class="number">3</span>))</div><div class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(n, <span class="number">0</span>, <span class="number">-1</span>):</div><div class="line">        print((<span class="string">' * '</span>*i).center(n*<span class="number">3</span>))</div><div class="line">main(<span class="number">6</span>)</div><div class="line">​</div></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">### break案例2：计算小于100的最大素数</div><div class="line">从下面的这个案例中就可以看出break语句在循环中的作用 。注：素质又叫质数，质数定义为在大于1的自然数中，除了1和它本身以外不再有其他因数。</div><div class="line"></div><div class="line">```python</div><div class="line">&gt;&gt;&gt; for n in range(100,1,-1):</div><div class="line">... for i in range(2,n):</div><div class="line">... if n%i == 0:</div><div class="line">... break</div><div class="line">... else:</div><div class="line">... print(n)</div><div class="line">... break</div><div class="line">...</div><div class="line">97</div></pre></td></tr></table></figure>
<h2 id="continue语句"><a href="#continue语句" class="headerlink" title="continue语句"></a>continue语句</h2><p>continue语句被用来告诉Python跳过当前循环块中的剩余语句，然后继续进行下一轮循环，如下所示：</p>
<h3 id="continue案例1"><a href="#continue案例1" class="headerlink" title="continue案例1:"></a>continue案例1:</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line">biotest@biotest-VirtualBox:~/python3/<span class="number">02</span>condition$ cat continue2.py </div><div class="line"><span class="comment">#!/usr/bin/python3</span></div><div class="line"></div><div class="line"><span class="keyword">for</span> letter <span class="keyword">in</span> <span class="string">'Runoob'</span>:</div><div class="line">    <span class="keyword">if</span> letter == <span class="string">'o'</span>:</div><div class="line">        <span class="keyword">continue</span></div><div class="line">    print(<span class="string">'Currnet letter is: '</span>,letter)</div><div class="line"></div><div class="line">var = <span class="number">10</span></div><div class="line"><span class="keyword">while</span> var &gt; <span class="number">0</span>:</div><div class="line">    var = var <span class="number">-1</span></div><div class="line">    <span class="keyword">if</span> var == <span class="number">5</span>:  <span class="comment"># script will jump loop when var=5</span></div><div class="line">        <span class="keyword">continue</span></div><div class="line">    print(<span class="string">'Currnet variable is: '</span>,var)</div><div class="line">print(<span class="string">"Good bye!"</span>)</div><div class="line">biotest@biotest-VirtualBox:~/python3/<span class="number">02</span>condition$ python3 continue2.py </div><div class="line">Currnet letter <span class="keyword">is</span>:  R</div><div class="line">Currnet letter <span class="keyword">is</span>:  u</div><div class="line">Currnet letter <span class="keyword">is</span>:  n</div><div class="line">Currnet letter <span class="keyword">is</span>:  b</div><div class="line">Currnet variable <span class="keyword">is</span>:  <span class="number">9</span></div><div class="line">Currnet variable <span class="keyword">is</span>:  <span class="number">8</span></div><div class="line">Currnet variable <span class="keyword">is</span>:  <span class="number">7</span></div><div class="line">Currnet variable <span class="keyword">is</span>:  <span class="number">6</span></div><div class="line">Currnet variable <span class="keyword">is</span>:  <span class="number">4</span></div><div class="line">Currnet variable <span class="keyword">is</span>:  <span class="number">3</span></div><div class="line">Currnet variable <span class="keyword">is</span>:  <span class="number">2</span></div><div class="line">Currnet variable <span class="keyword">is</span>:  <span class="number">1</span></div><div class="line">Currnet variable <span class="keyword">is</span>:  <span class="number">0</span></div><div class="line">Good bye!</div></pre></td></tr></table></figure>
<h3 id="continue案例2"><a href="#continue案例2" class="headerlink" title="continue案例2:"></a>continue案例2:</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>a = <span class="number">9</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">while</span> a:</div><div class="line"><span class="meta">... </span><span class="keyword">if</span> a % <span class="number">2</span> == <span class="number">0</span>:</div><div class="line"><span class="meta">... </span>a = a<span class="number">-1</span></div><div class="line"><span class="meta">... </span><span class="keyword">continue</span> <span class="comment">#如果是偶数，就返回循环的开始</span></div><div class="line"><span class="meta">... </span><span class="keyword">else</span>:</div><div class="line"><span class="meta">... </span>print(<span class="string">"%d is olld number"</span>%a) <span class="comment">#如果是奇数，就打印出来</span></div><div class="line"><span class="meta">... </span>a = a<span class="number">-1</span></div><div class="line">...</div><div class="line"><span class="number">9</span> <span class="keyword">is</span> olld number</div><div class="line"><span class="number">7</span> <span class="keyword">is</span> olld number</div><div class="line"><span class="number">5</span> <span class="keyword">is</span> olld number</div><div class="line"><span class="number">3</span> <span class="keyword">is</span> olld number</div><div class="line"><span class="number">1</span> <span class="keyword">is</span> olld number</div></pre></td></tr></table></figure>
<h2 id="pass语句-1"><a href="#pass语句-1" class="headerlink" title="pass语句"></a>pass语句</h2><p>Python pass是空语句，是为了保持程序结构的完整性。pass不做任何事情，一般用做占位语句，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt;&gt;&gt;<span class="keyword">while</span> <span class="keyword">True</span>:</div><div class="line"><span class="meta">... </span>    <span class="keyword">pass</span>  <span class="comment"># 等待键盘中断 (Ctrl+C)</span></div></pre></td></tr></table></figure>
<h3 id="pass语句案例1"><a href="#pass语句案例1" class="headerlink" title="pass语句案例1"></a>pass语句案例1</h3><p>在面向对象的程序设计中，pass语句经常这么使用，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyEmptyClass</span>:</span></div><div class="line">    <span class="keyword">pass</span></div></pre></td></tr></table></figure>
<p>此时定义了一个类，只是现在没有具体想好怎么写它，先占一个空位。</p>
<h3 id="pass语句案例2"><a href="#pass语句案例2" class="headerlink" title="pass语句案例2"></a>pass语句案例2</h3><p>以下代码在字母为<code>o</code>时执行pass语句：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">biotest@biotest-VirtualBox:~/python3/<span class="number">02</span>condition$ cat <span class="keyword">pass</span>.py </div><div class="line"><span class="comment">#!/usr/bin/python3</span></div><div class="line"></div><div class="line"><span class="keyword">for</span> letter <span class="keyword">in</span> <span class="string">'Runoob'</span>:</div><div class="line">    <span class="keyword">if</span> letter == <span class="string">'o'</span>:</div><div class="line">        <span class="keyword">pass</span></div><div class="line">        print(<span class="string">"Execute pass block"</span>)</div><div class="line">    print(<span class="string">'Current letter is :'</span>,letter)</div><div class="line"></div><div class="line">print(<span class="string">"Good, bye"</span>)</div><div class="line">biotest@biotest-VirtualBox:~/python3/<span class="number">02</span>condition$ python3 <span class="keyword">pass</span>.py </div><div class="line">Current letter <span class="keyword">is</span> : R</div><div class="line">Current letter <span class="keyword">is</span> : u</div><div class="line">Current letter <span class="keyword">is</span> : n</div><div class="line">Execute <span class="keyword">pass</span> block</div><div class="line">Current letter <span class="keyword">is</span> : o</div><div class="line">Execute <span class="keyword">pass</span> block</div><div class="line">Current letter <span class="keyword">is</span> : o</div><div class="line">Current letter <span class="keyword">is</span> : b</div><div class="line">Good, bye</div></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2018/04/06/Python/Python学习笔记（6）-函数构建/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/04/06/Python/Python学习笔记（6）-函数构建/" itemprop="url">Python学习笔记（6）-函数构建</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-04-06T12:00:00+08:00">
                2018-04-06
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Python/" itemprop="url" rel="index">
                    <span itemprop="name">Python</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  4,147
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  18
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="函数的构建格式"><a href="#函数的构建格式" class="headerlink" title="函数的构建格式"></a>函数的构建格式</h2><p>在Python中，函数的构建要遵循一定的格式，如下所示：</p>
<ol>
<li>函数代码块以 def 关键词开头，后接函数标识符名称和圆括号 ()。</li>
<li>任何传入参数和自变量必须放在圆括号中间，圆括号之间可以用于定义参数。</li>
<li>函数的第一行语句可以选择性地使用文档字符串—用于存放函数说明。</li>
<li>函数内容以冒号起始，并且缩进。</li>
<li><code>return [表达式]</code>结束函数，选择性地返回一个值给调用方。不带表达式的return相当于返回 None。</li>
</ol>
<p>Python函数的构建方法示意图如下所示： </p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/professional/180519/mJ5cgIJekH.png?imageslim" alt="mark"></p>
<h2 id="一个简单的函数构建"><a href="#一个简单的函数构建" class="headerlink" title="一个简单的函数构建"></a>一个简单的函数构建</h2><p>在下面的例子中，构建了一个将华氏度转换为摄氏度的函数，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">fahrenheit_coverter</span><span class="params">(C)</span>:</span></div><div class="line">    fahrenheit = C*<span class="number">9</span>/<span class="number">5</span> +<span class="number">32</span></div><div class="line">    <span class="keyword">return</span> str(fahrenheit) +<span class="string">' F'</span></div><div class="line">C2F = fahrenheit_coverter(<span class="number">35</span>)</div><div class="line">print(C2F)</div></pre></td></tr></table></figure>
<p>将上述文件保存在C盘，命名为test.py，运行结果如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">C:\Users\<span class="number">20161111</span>&gt;python t.py</div><div class="line"><span class="number">95.0</span> F</div></pre></td></tr></table></figure>
<h2 id="在交互模式下定义函数"><a href="#在交互模式下定义函数" class="headerlink" title="在交互模式下定义函数"></a>在交互模式下定义函数</h2><p> 如果在交互模式下面定义函数，解释器会显示三个小点来提醒你定义还没有完成，如下所示： </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="function"><span class="keyword">def</span> <span class="title">test_python</span><span class="params">()</span>:</span></div><div class="line">...</div></pre></td></tr></table></figure>
<p>在函数定义完毕的结尾，必须输入一行空白行。定义函数会创建一个函数类的对象，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="function"><span class="keyword">def</span> <span class="title">test_python</span><span class="params">()</span>:</span></div><div class="line"><span class="meta">... </span>    print(<span class="string">"I test def function"</span>)</div><div class="line">...</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>test_python()</div><div class="line">I test <span class="function"><span class="keyword">def</span> <span class="title">function</span></span></div><div class="line"><span class="function">&gt;&gt;&gt;</span></div></pre></td></tr></table></figure>
<p>第一行：def test_python():  定义函数</p>
<p>第二行：print(“I test def function”) 输入函数的内容，前面要空四格</p>
<p>第三行：是一空行，输入几个空格，直接回车就行；</p>
<p>第四行：继续回车，函数创建完毕，输入test_python()，显示结果。</p>
<h2 id="函数的嵌套"><a href="#函数的嵌套" class="headerlink" title="函数的嵌套"></a>函数的嵌套</h2><p>在函数中也能创建函数，如下面的案例：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">print_lyrics</span><span class="params">()</span>:</span></div><div class="line">    print(<span class="string">"I'm a lumberjack, and I'm okay."</span>)</div><div class="line">    print(<span class="string">"I sleep all night and I work all day."</span>)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">repeat_lyrics</span><span class="params">()</span>:</span></div><div class="line">    print_lyrics()</div><div class="line">repeat_lyrics()</div></pre></td></tr></table></figure>
<p>运行后如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">C:\Users\<span class="number">20161111</span>&gt;python test.py</div><div class="line">I<span class="string">'m a lumberjack, and I'</span>m okay.</div><div class="line">I sleep all night <span class="keyword">and</span> I work all day.</div></pre></td></tr></table></figure>
<h2 id="函数的参数传递"><a href="#函数的参数传递" class="headerlink" title="函数的参数传递"></a>函数的参数传递</h2><p>在Python中，类型属于对象，变量是没有类型的，先看下面的代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">a = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</div><div class="line">a = <span class="string">"Runoob"</span></div></pre></td></tr></table></figure>
<p>在上述代码中，<code>[1, 2, 3]</code>是List类型，<code>&quot;Runoob&quot;</code>是String类型，而变量a是没有类型的，它仅仅是一个对象的引用（一个指针），它可以指向List类型的对象，也哦可以是指向String类型对象。</p>
<h2 id="可更改-mutable-与不可更改-immutable-对象"><a href="#可更改-mutable-与不可更改-immutable-对象" class="headerlink" title="可更改(mutable)与不可更改(immutable)对象"></a>可更改(mutable)与不可更改(immutable)对象</h2><p>在python中，strings,tuples,和numbers是不可更改的对象，而list,dict等则是可以修改的对象。</p>
<ol>
<li>不可变类型：变量赋值a=5后再赋值a=10，这里实际是新生成一个int值对象10，再让a指向它，而5被丢弃，不是改变a的值，相当于新生成了a。</li>
<li>可变类型：变量赋值la=[1,2,3,4]后再赋值la[2]=5则是将listla的第三个元素值更改，本身la没有动，只是其内部的一部分值被修改了。</li>
</ol>
<h2 id="python函数的参数传递："><a href="#python函数的参数传递：" class="headerlink" title="python函数的参数传递："></a>python函数的参数传递：</h2><ol>
<li>不可变类型：如整数、字符串、元组。如fun（a），传递的只是a的值，没有影响a对象本身。比如在fun（a）内部修改a的值，只是修改另一个复制的对象，不会影响a本身。</li>
<li>可变类型：如列表，字典。如fun（la），则是将la真正的传过去，修改后fun外部的la也会受影响</li>
</ol>
<p>在python中，一切皆对象，严格意义上来讲，我们不能说值传递还是引用传递，我们应该说传不可变对象和传可变对象。</p>
<h2 id="python传不可变对象实例"><a href="#python传不可变对象实例" class="headerlink" title="python传不可变对象实例"></a>python传不可变对象实例</h2><p>看这个案例：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">biotest@biotest-VirtualBox:~/python3/<span class="number">01</span>basic$ cat para.py </div><div class="line"><span class="comment">#!/usr/bin/python3</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">ChangeInt</span><span class="params">(a)</span>:</span></div><div class="line">    a = <span class="number">10</span></div><div class="line"></div><div class="line">b = <span class="number">2</span></div><div class="line">ChangeInt(b)</div><div class="line">print(b)</div><div class="line"><span class="comment"># The result is 2</span></div><div class="line"></div><div class="line">biotest@biotest-VirtualBox:~/python3/<span class="number">01</span>basic$ python3 para.py </div><div class="line"><span class="number">2</span></div></pre></td></tr></table></figure>
<p>在这个案例中，有int对象2，指向它的变量是b，在传递给ChangeInt函数时，按传值的方式复制了变量b，a和b都指向了同一个Int对象，在a=10时，则新生成一个int值对象10，并让a指向它。</p>
<h2 id="python传可变对象实例"><a href="#python传可变对象实例" class="headerlink" title="python传可变对象实例"></a>python传可变对象实例</h2><p>可变对象在函数里修改了参数，那么在调用这个函数的函数里，原始的参数也被改变了，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">biotest@biotest-VirtualBox:~/python3/<span class="number">01</span>basic$ cat para2.py</div><div class="line"><span class="comment">#!/usr/bin/python3</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">changeme</span><span class="params">(mylist)</span>:</span></div><div class="line">    mylist.append([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>])</div><div class="line">    print(<span class="string">"The value inside function is: "</span>,mylist)</div><div class="line">    <span class="keyword">return</span></div><div class="line"></div><div class="line">mylist=[<span class="number">10</span>,<span class="number">20</span>,<span class="number">30</span>]</div><div class="line">changeme(mylist)</div><div class="line">print(<span class="string">"The value outside function is: "</span>,mylist)</div><div class="line">biotest@biotest-VirtualBox:~/python3/<span class="number">01</span>basic$ python3 para2.py</div><div class="line">The value inside function <span class="keyword">is</span>:  [<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>, [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>]]</div><div class="line">The value outside function <span class="keyword">is</span>:  [<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>, [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>]]</div></pre></td></tr></table></figure>
<p>传入函数的和在末尾添加新内容的对象用的是同一个引用，因此输出了相同的结果。</p>
<h2 id="函数的参数"><a href="#函数的参数" class="headerlink" title="函数的参数"></a>函数的参数</h2><p>以下是调用函数时可使用的正式参数类型：</p>
<ol>
<li>必需参数</li>
<li>关键字参数</li>
<li>默认参数</li>
<li>不定长参数</li>
</ol>
<h3 id="必需参数"><a href="#必需参数" class="headerlink" title="必需参数"></a>必需参数</h3><p>必需参数须以正确的顺序传入函数。调用时的数量必须和声明时的一样。调用printme()函数，你必须传入一个参数，不然会出现语法错误，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">biotest@biotest-VirtualBox:~/python3/<span class="number">01</span>basic$ cat function1.py </div><div class="line"><span class="comment">#!/usr/bin/python3</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">printme</span><span class="params">(str)</span>:</span></div><div class="line">    print(str)</div><div class="line">    <span class="keyword">return</span></div><div class="line"></div><div class="line">printme()</div><div class="line">biotest@biotest-VirtualBox:~/python3/<span class="number">01</span>basic$ python3 function1.py </div><div class="line">Traceback (most recent call last):</div><div class="line">  File <span class="string">"function1.py"</span>, line <span class="number">7</span>, <span class="keyword">in</span> &lt;module&gt;</div><div class="line">    printme()</div><div class="line">TypeError: printme() missing <span class="number">1</span> required positional argument: <span class="string">'str'</span></div></pre></td></tr></table></figure>
<h3 id="关键字参数"><a href="#关键字参数" class="headerlink" title="关键字参数"></a>关键字参数</h3><p>关键字参数和函数调用关系紧密，函数调用使用关键字参数来确定传入的参数值。使用关键字参数允许函数调用时参数的顺序与声明时不一致，因为 Python 解释器能够用参数名匹配参数值。以下实例在函数 printme() 调用时使用参数名：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">biotest@biotest-VirtualBox:~/python3/<span class="number">01</span>basic$ cat function2.py </div><div class="line"><span class="comment">#!/usr/bin/python3</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">printme</span><span class="params">(str)</span>:</span></div><div class="line">    print(str)</div><div class="line">    <span class="keyword">return</span></div><div class="line"></div><div class="line">printme(str=<span class="string">"Runoob tutorial"</span>)</div><div class="line">biotest@biotest-VirtualBox:~/python3/<span class="number">01</span>basic$ python3 function2.py </div><div class="line">Runoob tutorial</div></pre></td></tr></table></figure>
<p>以下实例中演示了函数参数的使用不需要使用指定顺序： </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">biotest@biotest-VirtualBox:~/python3/<span class="number">01</span>basic$ cat function3.py </div><div class="line"><span class="comment">#!/usr/bin/python3</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">printinfo</span><span class="params">(name, age)</span>:</span></div><div class="line">    print(<span class="string">"Name: "</span>,name)</div><div class="line">    print(<span class="string">"Age: "</span>,age)</div><div class="line">    <span class="keyword">return</span></div><div class="line"></div><div class="line">printinfo(age=<span class="number">50</span>,name=<span class="string">"runoob"</span>)</div><div class="line">printinfo(<span class="string">"Zhang"</span>,<span class="number">20</span>)</div><div class="line">printinfo(<span class="number">20</span>,<span class="string">"Zhang"</span>)</div><div class="line">biotest@biotest-VirtualBox:~/python3/<span class="number">01</span>basic$ python3 function3.py </div><div class="line">Name:  runoob</div><div class="line">Age:  <span class="number">50</span></div><div class="line">Name:  Zhang</div><div class="line">Age:  <span class="number">20</span></div><div class="line">Name:  <span class="number">20</span></div><div class="line">Age:  Zhang</div></pre></td></tr></table></figure>
<p>从结果来看，如果不按顺序输入参数，那么可以使用赋值语句将实参直接赋值给相应的形参。</p>
<h3 id="默认参数"><a href="#默认参数" class="headerlink" title="默认参数"></a>默认参数</h3><p>调用函数时，如果没有传递参数，则会使用默认参数。以下实例中如果没有传入age参数，则使用默认值：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">biotest@biotest-VirtualBox:~/python3/<span class="number">01</span>basic$ cat function4.py </div><div class="line"><span class="comment">#!/usr/bin/python3</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">printinfo</span><span class="params">(name,age=<span class="number">35</span>)</span>:</span></div><div class="line">    print(<span class="string">"Name: "</span>,name)</div><div class="line">    print(<span class="string">"Age: "</span>,age)</div><div class="line">    <span class="keyword">return</span></div><div class="line"></div><div class="line">printinfo(age=<span class="number">50</span>, name=<span class="string">"runoob"</span>)</div><div class="line">print(<span class="string">"------------------------"</span>)</div><div class="line">printinfo(name=<span class="string">"runoob"</span>)</div><div class="line">printinfo(<span class="number">20</span>,<span class="string">"runoob"</span>)</div><div class="line">printinfo(<span class="string">"runoob"</span>,<span class="number">20</span>)</div><div class="line">biotest@biotest-VirtualBox:~/python3/<span class="number">01</span>basic$ python3 function4.py </div><div class="line">Name:  runoob</div><div class="line">Age:  <span class="number">50</span></div><div class="line">------------------------</div><div class="line">Name:  runoob</div><div class="line">Age:  <span class="number">35</span></div><div class="line">Name:  <span class="number">20</span></div><div class="line">Age:  runoob</div><div class="line">Name:  runoob</div><div class="line">Age:  <span class="number">20</span></div></pre></td></tr></table></figure>
<h3 id="不定长参数"><a href="#不定长参数" class="headerlink" title="不定长参数"></a>不定长参数</h3><p>你可能需要一个函数能处理比当初声明时更多的参数。这些参数叫做不定长参数，和上述2种参数不同，声明时不会命名。基本语法如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">functionname</span><span class="params">([formal_args,] *var_args_tuple )</span>:</span></div><div class="line">   <span class="string">"函数_文档字符串"</span></div><div class="line">   function_suite</div><div class="line">   <span class="keyword">return</span> [expression]</div></pre></td></tr></table></figure>
<p>加了星号（<code>*</code>）的变量名会存放所有未命名的变量参数。如果在函数调用时没有指定参数，它就是一个空元组。我们也可以不向函数传递未命名的变量。如下实例：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">biotest@biotest-VirtualBox:~/python3/<span class="number">01</span>basic$ cat function5.py </div><div class="line"><span class="comment">#!/usr/bin/python3</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">printinfo</span><span class="params">(arg1, *vartuple)</span>:</span></div><div class="line">    print(<span class="string">"Output: "</span>)</div><div class="line">    print(arg1)</div><div class="line">    <span class="keyword">for</span> var <span class="keyword">in</span> vartuple:</div><div class="line">        print(var)</div><div class="line">    <span class="keyword">return</span></div><div class="line"></div><div class="line">printinfo(<span class="number">10</span>)</div><div class="line">printinfo(<span class="number">11</span>,<span class="number">12</span>,<span class="number">13</span>)</div><div class="line">biotest@biotest-VirtualBox:~/python3/<span class="number">01</span>basic$ python3 function5.py </div><div class="line">Output: </div><div class="line"><span class="number">10</span></div><div class="line">Output: </div><div class="line"><span class="number">11</span></div><div class="line"><span class="number">12</span></div><div class="line"><span class="number">13</span></div></pre></td></tr></table></figure>
<h2 id="匿名函数lambda"><a href="#匿名函数lambda" class="headerlink" title="匿名函数lambda"></a>匿名函数lambda</h2><p>python使用lambda来创建匿名函数。所谓匿名，意即不再使用def语句这样标准的形式定义一个函数，它的特点如下：</p>
<ol>
<li>lambda只是一个表达式，函数体比def简单很多。</li>
<li>lambda的主体是一个表达式，而不是一个代码块。仅仅能在lambda表达式中封装有限的逻辑进去。</li>
<li>lambda函数拥有自己的命名空间，且不能访问自己参数列表之外或全局命名空间里的参数。</li>
<li>虽然lambda函数看起来只能写一行，却不等同于C或C++的内联函数，后者的目的是调用小函数时不占用栈内存从而增加运行效率。</li>
</ol>
<p>语法格式如下所示：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">lambda</span> [arg1 [,arg2,.....argn]]:expression</div></pre></td></tr></table></figure></p>
<p>看一个简单的例子：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">biotest@biotest-VirtualBox:~/python3/<span class="number">01</span>basic$ cat <span class="keyword">lambda</span>.py </div><div class="line"><span class="comment">#!/usr/bin/python3</span></div><div class="line"></div><div class="line">sum = <span class="keyword">lambda</span> arg1, arg2: arg1 + arg2</div><div class="line"><span class="comment"># 这里就是定义了一个函数，这个函数实现的功能就是两个数字相加</span></div><div class="line"></div><div class="line">print(<span class="string">"The value summed is :  "</span>,sum(<span class="number">10</span>, <span class="number">20</span>))</div><div class="line">print(<span class="string">"The value summed is :  "</span>,sum(<span class="number">20</span>,<span class="number">20</span>))</div><div class="line">biotest@biotest-VirtualBox:~/python3/<span class="number">01</span>basic$ python3 <span class="keyword">lambda</span>.py </div><div class="line">The value summed <span class="keyword">is</span> :   <span class="number">30</span></div><div class="line">The value summed <span class="keyword">is</span> :   <span class="number">40</span></div></pre></td></tr></table></figure>
<p>上面的这个案例如果改成常规的函数写法，则是如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">biotest@biotest-VirtualBox:~/python3/<span class="number">01</span>basic$ cat <span class="keyword">lambda</span>.py </div><div class="line"><span class="comment">#!/usr/bin/python3</span></div><div class="line"></div><div class="line">sum = <span class="keyword">lambda</span> arg1, arg2: arg1 + arg2</div><div class="line"></div><div class="line">print(<span class="string">"The value summed is :  "</span>,sum(<span class="number">10</span>, <span class="number">20</span>))</div><div class="line">print(<span class="string">"The value summed is :  "</span>,sum(<span class="number">20</span>,<span class="number">20</span>))</div><div class="line">biotest@biotest-VirtualBox:~/python3/<span class="number">01</span>basic$ python3 <span class="keyword">lambda</span>.py </div><div class="line">The value summed <span class="keyword">is</span> :   <span class="number">30</span></div><div class="line">The value summed <span class="keyword">is</span> :   <span class="number">40</span></div></pre></td></tr></table></figure>
<h3 id="匿名函数与普通函数的区别"><a href="#匿名函数与普通函数的区别" class="headerlink" title="匿名函数与普通函数的区别"></a>匿名函数与普通函数的区别</h3><p>看下面的一段代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">biotest@biotest-VirtualBox:~/python3/<span class="number">03</span>file$ cat <span class="keyword">lambda</span>.py </div><div class="line"><span class="comment">#!/usr/bin/python3</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span><span class="params">(a,b)</span>:</span></div><div class="line">    <span class="keyword">return</span> a+b</div><div class="line">a=<span class="number">2</span></div><div class="line">b=<span class="number">3</span></div><div class="line">print(<span class="string">'a+b='</span>, add(a,b))</div><div class="line"></div><div class="line">a=<span class="number">2</span></div><div class="line">b=<span class="number">3</span></div><div class="line">addl = <span class="keyword">lambda</span> a,b:a+b</div><div class="line">print(<span class="string">'a+b='</span>,addl(a,b))</div><div class="line"></div><div class="line">print(<span class="string">'type(add(a,b)):'</span>,type(add(a,b)))</div><div class="line">print(<span class="string">'type(addl):'</span>,type(addl))</div><div class="line"></div><div class="line">biotest@biotest-VirtualBox:~/python3/<span class="number">03</span>file$ python3 <span class="keyword">lambda</span>.py </div><div class="line">a+b= <span class="number">5</span></div><div class="line">a+b= <span class="number">5</span></div><div class="line">type(add(a,b)): &lt;<span class="class"><span class="keyword">class</span> '<span class="title">int</span>'&gt;</span></div><div class="line"><span class="class"><span class="title">type</span><span class="params">(addl)</span>:</span> &lt;<span class="class"><span class="keyword">class</span> '<span class="title">function</span>'&gt;</span></div></pre></td></tr></table></figure>
<p>从上面我们可以看见add(a,b)的类型是int，而addl(a,b)的类型则是函数。从这里也能看出Lambda表达式确实是一种函数的表示方式。lambda的一般形式是关键字lambda后面跟一个或多个参数，紧跟一个冒号，以后是一个表达式。lambda是一个表达式而不是一个语句。它能够出现在python语法不允许def出现的地方。 </p>
<h3 id="lambda案例第1-快速组建列表"><a href="#lambda案例第1-快速组建列表" class="headerlink" title="lambda案例第1:快速组建列表"></a>lambda案例第1:快速组建列表</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>list1 = <span class="keyword">lambda</span> x:x**<span class="number">2</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>l = [list1(i) <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">10</span>)]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(l)</div><div class="line">[<span class="number">0</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">9</span>, <span class="number">16</span>, <span class="number">25</span>, <span class="number">36</span>, <span class="number">49</span>, <span class="number">64</span>, <span class="number">81</span>]</div></pre></td></tr></table></figure>
<h3 id="lambda函数：减少函数命名"><a href="#lambda函数：减少函数命名" class="headerlink" title="lambda函数：减少函数命名"></a>lambda函数：减少函数命名</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">biotest@biotest-VirtualBox:~/python3/<span class="number">03</span>file$ cat lambda1.py </div><div class="line"><span class="comment">#!/usr/bin/python3</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">eat</span><span class="params">(f)</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">many</span><span class="params">(n)</span>:</span></div><div class="line">        <span class="keyword">return</span> n*f</div><div class="line">    <span class="keyword">return</span> many</div><div class="line">food = input(<span class="string">'What kind of fruti do you like?'</span>)</div><div class="line">f = eat(food)</div><div class="line">print(f(<span class="number">5</span>))</div><div class="line">biotest@biotest-VirtualBox:~/python3/<span class="number">03</span>file$ python3 lambda1.py </div><div class="line">What kind of fruti do you like? Yes</div><div class="line"> Yes Yes Yes Yes Yes</div></pre></td></tr></table></figure>
<p>上述代码改写为lambda则是如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">eat</span><span class="params">(f)</span>:</span></div><div class="line">    <span class="keyword">return</span> <span class="keyword">lambda</span> n:f*n</div><div class="line">    </div><div class="line">food = input(<span class="string">'What kind of fruit do you like?'</span>)</div><div class="line">f = eat(food)</div><div class="line">print(f(<span class="number">5</span>))</div></pre></td></tr></table></figure>
<p>再看一个案例：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">biotest@biotest-VirtualBox:~/python3/<span class="number">03</span>file$ cat original.py <span class="comment"># 这是原代码</span></div><div class="line"><span class="comment">#!/usr/bin/python3</span></div><div class="line">freshfruit = [<span class="string">' banana'</span>,<span class="string">' loganberry '</span>,<span class="string">'passion fruit'</span>] <span class="comment"># 建立一个列表</span></div><div class="line">print(freshfruit) <span class="comment">#显示列表，发现前2个元素有空格</span></div><div class="line">list3 =[w.strip() <span class="keyword">for</span> w <span class="keyword">in</span> freshfruit] <span class="comment"># 去除空格</span></div><div class="line">print(list3) <span class="comment">#空格去掉后的效果</span></div><div class="line"></div><div class="line">biotest@biotest-VirtualBox:~/python3/<span class="number">03</span>file$ python3 original.py </div><div class="line">[<span class="string">' banana'</span>, <span class="string">' loganberry '</span>, <span class="string">'passion fruit'</span>]</div><div class="line">[<span class="string">'banana'</span>, <span class="string">'loganberry'</span>, <span class="string">'passion fruit'</span>]</div><div class="line"></div><div class="line">biotest@biotest-VirtualBox:~/python3/<span class="number">03</span>file$ cat original_trans.py <span class="comment"># 改写为lambda形式</span></div><div class="line"><span class="comment">#!/usr/bin/python3</span></div><div class="line"></div><div class="line">freshfruit = [<span class="string">' banana'</span>,<span class="string">' loganberry '</span>,<span class="string">'passion fruit'</span>]</div><div class="line">list3 = list(map(<span class="keyword">lambda</span> x:x.strip(),freshfruit))</div><div class="line"><span class="comment"># lambda x:x.strip()这里就相当于一个函数，map则是将这个函数映射到freshfruit的每个元素上</span></div><div class="line">print(list3)</div><div class="line">biotest@biotest-VirtualBox:~/python3/<span class="number">03</span>file$ python3 original_trans.py </div><div class="line">[<span class="string">'banana'</span>, <span class="string">'loganberry'</span>, <span class="string">'passion fruit'</span>]</div></pre></td></tr></table></figure>
<h3 id="案例：使用列表推导式实现嵌套列表的平铺，如下所示："><a href="#案例：使用列表推导式实现嵌套列表的平铺，如下所示：" class="headerlink" title="案例：使用列表推导式实现嵌套列表的平铺，如下所示："></a>案例：使用列表推导式实现嵌套列表的平铺，如下所示：</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>vec = [[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>],[<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>],[<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">10</span>]]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print([num <span class="keyword">for</span> elem <span class="keyword">in</span> vec <span class="keyword">for</span> num <span class="keyword">in</span> elem])</div><div class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>]</div></pre></td></tr></table></figure>
<p>这个列表推导式中有2个循环，第1个循环可以看作是外循环，执行得慢，第2个循环是内循环，执行得快，上面代码等价于下面的： </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">biotest@biotest-VirtualBox:~/python3/<span class="number">03</span>file$ cat test1.py </div><div class="line"><span class="comment">#!/usr/bin/python3</span></div><div class="line"></div><div class="line">vec = [[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>],[<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>],[<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">10</span>]]</div><div class="line">result = []</div><div class="line"><span class="keyword">for</span> elem <span class="keyword">in</span> vec:</div><div class="line">    <span class="keyword">for</span> num <span class="keyword">in</span> elem:</div><div class="line">        result.append(num)</div><div class="line">print(result)</div><div class="line">biotest@biotest-VirtualBox:~/python3/<span class="number">03</span>file$ python3 test1.py </div><div class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>]</div></pre></td></tr></table></figure>
<h3 id="案例：过滤掉不合条件的元素"><a href="#案例：过滤掉不合条件的元素" class="headerlink" title="案例：过滤掉不合条件的元素"></a>案例：过滤掉不合条件的元素</h3><p>列表推导式中可以使用if语句来进行筛选，只在结果列表中保留符合条件的元素，下面的代码是过滤当前目录下的所有文件，只保留以<code>.py</code>结尾的文件，如下所示：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> os</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print([filename <span class="keyword">for</span> filename <span class="keyword">in</span> os.listdir(<span class="string">'.'</span>) <span class="keyword">if</span> filename.endswith(<span class="string">'.py'</span>)])</div><div class="line">[<span class="string">'a.py'</span>, <span class="string">'count_line.py'</span>, <span class="string">'practice.py'</span>, <span class="string">'python.py'</span>, <span class="string">'t.py'</span>]</div></pre></td></tr></table></figure></p>
<p>代码解释：</p>
<ol>
<li><code>os.listdir()</code>方法用于返回指定的文件夹包含的文件或文件夹的名字的列表。这个列表以字母顺序，括号中的参数可以是路径，例如c:\downloads，也可以不加，用’.’来表示。</li>
<li><code>endswith()</code>方法用于判断字符串是否以指定后缀结尾，如果以指定后缀结尾返回True，否则返回False。可选参数”start”与”end”为检索字符串的开始与结束位置。</li>
</ol>
<h3 id="案例：过滤满足一定条件的元素"><a href="#案例：过滤满足一定条件的元素" class="headerlink" title="案例：过滤满足一定条件的元素"></a>案例：过滤满足一定条件的元素</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>list4= [<span class="number">-1</span>, <span class="number">-4</span>, <span class="number">6</span>, <span class="number">7.5</span> ,<span class="number">-2.3</span>, <span class="number">9</span>, <span class="number">-11</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(list4)</div><div class="line">[<span class="number">-1</span>, <span class="number">-4</span>, <span class="number">6</span>, <span class="number">7.5</span>, <span class="number">-2.3</span>, <span class="number">9</span>, <span class="number">-11</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>result = [i <span class="keyword">for</span> i <span class="keyword">in</span> list4 <span class="keyword">if</span> i &lt; <span class="number">0</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(result)</div><div class="line">[<span class="number">-1</span>, <span class="number">-4</span>, <span class="number">-2.3</span>, <span class="number">-11</span>]</div></pre></td></tr></table></figure>
<h2 id="带有返回值的函数"><a href="#带有返回值的函数" class="headerlink" title="带有返回值的函数"></a>带有返回值的函数</h2><p><code>return[表达式]</code>语句用于退出函数，选择性地向调用方返回一个表达式。不带参数值的<code>return</code>语句返回<code>None</code>，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">biotest@biotest-VirtualBox:~/python3/<span class="number">01</span>basic$ cat <span class="keyword">return</span>.py </div><div class="line"><span class="comment">#!/usr/bin/python3</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sum</span><span class="params">(arg1, arg2)</span>:</span></div><div class="line">    total = arg1 + arg2</div><div class="line">    print(<span class="string">"Inside function is :  "</span>,total)</div><div class="line">    <span class="keyword">return</span> total</div><div class="line"></div><div class="line">total = sum(<span class="number">10</span>, <span class="number">20</span>)</div><div class="line">print(<span class="string">"Outside function is : "</span>,total)</div><div class="line"></div><div class="line">biotest@biotest-VirtualBox:~/python3/<span class="number">01</span>basic$ python3 <span class="keyword">return</span>.py </div><div class="line">Inside function <span class="keyword">is</span> :   <span class="number">30</span></div><div class="line">Outside function <span class="keyword">is</span> :  <span class="number">30</span></div></pre></td></tr></table></figure>
<h2 id="变量作用域"><a href="#变量作用域" class="headerlink" title="变量作用域"></a>变量作用域</h2><p>Python中，程序的变量并不是在哪个位置都可以访问的，访问权限决定于这个变量是在哪里赋值的。变量的作用域决定了在哪一部分程序可以访问哪个特定的变量名称。Python的作用域一共有4种，分别是：</p>
<ol>
<li><p>L（Local）局部作用域</p>
</li>
<li><p>E（Enclosing）闭包函数外的函数中</p>
</li>
<li><p>G（Global）全局作用域</p>
</li>
<li><p>B（Built-in）内建作用域</p>
</li>
</ol>
<p>Pyhton以<code>L–&gt;E–&gt;G–&gt;B</code>的规则查找，即：在局部找不到，便会去局部外的局部找（例如闭包），再找不到就会去全局找，再者去内建中找，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">x = int(<span class="number">2.9</span>)  <span class="comment"># 内建作用域</span></div><div class="line"> </div><div class="line">g_count = <span class="number">0</span>  <span class="comment"># 全局作用域</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">outer</span><span class="params">()</span>:</span></div><div class="line">    o_count = <span class="number">1</span>  <span class="comment"># 闭包函数外的函数中</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">inner</span><span class="params">()</span>:</span></div><div class="line">        i_count = <span class="number">2</span>  <span class="comment"># 局部作用域</span></div></pre></td></tr></table></figure>
<p>Python中只有<code>模块（module）</code>，<code>类（class）</code>以及函数<code>（def、lambda）</code>才会引入新的作用域，其它的代码块（如<code>if/elif/else/</code>、<code>try/except</code>、<code>for/while</code>等）是不会引入新的作用域的，也就是说这些语句内定义的变量，外部也可以访问，如下代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">if</span> <span class="keyword">True</span>:</div><div class="line"><span class="meta">... </span>    msg = <span class="string">"I am a learner"</span></div><div class="line">...</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>msg</div><div class="line"><span class="string">'I am a learner'</span></div></pre></td></tr></table></figure>
<p>在这个案例中，msg变量定义在if语句块中，但外部还是可以访问的。如果将msg定义在函数中，则它就是局部变量，外部不能访问，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">biotest@biotest-VirtualBox:~/python3/<span class="number">01</span>basic$ cat local_variable.py </div><div class="line"><span class="comment">#!/usr/bin/python3</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">test</span><span class="params">()</span>:</span></div><div class="line">    msg_inner = <span class="string">"I am a learner"</span></div><div class="line"></div><div class="line">print(msg_inner)</div><div class="line"></div><div class="line">biotest@biotest-VirtualBox:~/python3/<span class="number">01</span>basic$ python3 local_variable.py </div><div class="line">Traceback (most recent call last):</div><div class="line">  File <span class="string">"local_variable.py"</span>, line <span class="number">6</span>, <span class="keyword">in</span> &lt;module&gt;</div><div class="line">    print(msg_inner)</div><div class="line">NameError: name <span class="string">'msg_inner'</span> <span class="keyword">is</span> <span class="keyword">not</span> defined</div></pre></td></tr></table></figure>
<p>从错误提示就能看出，msg_inner并示未定义，因为它是局部变量，只能在函数内部使用。</p>
<h2 id="全局变量和局部变量"><a href="#全局变量和局部变量" class="headerlink" title="全局变量和局部变量"></a>全局变量和局部变量</h2><p>定义在函数内部的变量拥有一个局部作用域，定义在函数外的拥有全局作用域。局部变量只能在其被声明的函数内部访问，而全局变量可以在整个程序范围内访问。调用函数时，所有在函数内声明的变量名称都将被加入到作用域中，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">biotest@biotest-VirtualBox:~/python3/<span class="number">01</span>basic$ cat global_local_variable.py </div><div class="line"><span class="comment">#!/usr/bin/python3</span></div><div class="line"></div><div class="line">total = <span class="number">0</span> </div><div class="line"><span class="comment"># this is a global variable</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sum</span><span class="params">(arg1, arg2)</span>:</span></div><div class="line">    total = arg1 + arg2</div><div class="line">    <span class="comment"># Here, total is a local variable</span></div><div class="line">    print(<span class="string">"Variable inside function is local variable: "</span>,total)</div><div class="line">    <span class="keyword">return</span> total</div><div class="line"></div><div class="line">sum(<span class="number">10</span>, <span class="number">20</span>)</div><div class="line">print(<span class="string">"Variable outside function is global variable: "</span>,total)</div><div class="line">biotest@biotest-VirtualBox:~/python3/<span class="number">01</span>basic$ python3 global_local_variable.py </div><div class="line">Variable inside function <span class="keyword">is</span> local variable:  <span class="number">30</span></div><div class="line">Variable outside function <span class="keyword">is</span> <span class="keyword">global</span> variable:  <span class="number">0</span></div></pre></td></tr></table></figure>
<h2 id="global和nonlocal关键字"><a href="#global和nonlocal关键字" class="headerlink" title="global和nonlocal关键字"></a>global和nonlocal关键字</h2><p>当内部作用域想修改外部作用域的变量时，就要用到global和nonlocal关键字，在下面的案例中，修改了全局变量num：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">biotest@biotest-VirtualBox:~/python3/<span class="number">01</span>basic$ cat <span class="keyword">nonlocal</span>.py </div><div class="line"><span class="comment">#!/usr/bin/python3</span></div><div class="line"></div><div class="line">num = <span class="number">1</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">fun1</span><span class="params">()</span>:</span></div><div class="line">    <span class="keyword">global</span> num <span class="comment"># need to keyword "global" for statement</span></div><div class="line">    print(num)</div><div class="line">    num = <span class="number">123</span></div><div class="line">    print(num)</div><div class="line"></div><div class="line">fun1()</div><div class="line"></div><div class="line">biotest@biotest-VirtualBox:~/python3/<span class="number">01</span>basic$ python3 <span class="keyword">nonlocal</span>.py </div><div class="line"><span class="number">1</span></div><div class="line"><span class="number">123</span></div></pre></td></tr></table></figure>
<p>如果要修改嵌套作用域（enclosing作用域，外层非全局作用域）中的变量则需要nonlocal关键字了，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">biotest@biotest-VirtualBox:~/python3/<span class="number">01</span>basic$ cat nonlocal2.py </div><div class="line"><span class="comment">#!/usr/bin/python3</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">outer</span><span class="params">()</span>:</span></div><div class="line">    num = <span class="number">10</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">inner</span><span class="params">()</span>:</span></div><div class="line">        <span class="keyword">nonlocal</span> num </div><div class="line">        num = <span class="number">100</span></div><div class="line">        print(num)</div><div class="line">    inner()</div><div class="line">    print(num)</div><div class="line">outer()</div><div class="line">biotest@biotest-VirtualBox:~/python3/<span class="number">01</span>basic$ python3 nonlocal2.py </div><div class="line"><span class="number">100</span></div><div class="line"><span class="number">100</span></div></pre></td></tr></table></figure>
<p>再看一个案例：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">biotest@biotest-VirtualBox:~/python3/<span class="number">01</span>basic$ cat action_scope_error.py </div><div class="line"><span class="comment">#!/usr/bin/python3</span></div><div class="line"></div><div class="line">a = <span class="number">10</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">test</span><span class="params">()</span>:</span></div><div class="line">    a = a + <span class="number">1</span></div><div class="line">    print(a)</div><div class="line">test()</div><div class="line">biotest@biotest-VirtualBox:~/python3/<span class="number">01</span>basic$ python3 action_scope_error.py </div><div class="line">Traceback (most recent call last):</div><div class="line">  File <span class="string">"action_scope_error.py"</span>, line <span class="number">7</span>, <span class="keyword">in</span> &lt;module&gt;</div><div class="line">    test()</div><div class="line">  File <span class="string">"action_scope_error.py"</span>, line <span class="number">5</span>, <span class="keyword">in</span> test</div><div class="line">    a = a + <span class="number">1</span></div><div class="line">UnboundLocalError: local variable <span class="string">'a'</span> referenced before assignment</div></pre></td></tr></table></figure>
<p>错误信息为局部作用域引用错误，因为test函数中的a使用的是局部变量，未定义，无法修改。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/5/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/5/">5</a><span class="page-number current">6</span><a class="page-number" href="/page/7/">7</a><span class="space">&hellip;</span><a class="page-number" href="/page/12/">12</a><a class="extend next" rel="next" href="/page/7/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">RVDSD</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">111</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">10</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">103</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          <div class="links-of-author motion-element">
            
          </div>

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

<div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">RVDSD</span>

  
</div>



<div class="powered-by">
<i class="fa fa-user-md"></i><span id="busuanzi_container_site_uv">
  本站访客数:<span id="busuanzi_value_site_uv"></span>
</span>
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.3</div>




<div class="theme-info">
  <div class="powered-by"></div>
  <span class="post-count">博客全站共409.4k字</span>
</div>

        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.3"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.3"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.3"></script>



  


  




	





  





  










  
  <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/valine@1.1.4/dist/Valine.min.js"></script>
  <script type="text/javascript">
    new Valine({
        av: AV,
        el: '#vcomments' ,
        verify: true,
        notify: true,
        app_id: '4ORLDMxXCFDLSHPJ4wSSDkkw-gzGzoHsz',
        app_key: 'HSWpCY7XlN0pGV5DCrKoC0ic',
        placeholder: 'Comment input placeholder'
    });
  </script>



  





  

  

  
  

  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config("");
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="custom_mathjax_source">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->
  


  

  

</body>
</html>
