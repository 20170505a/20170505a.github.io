<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.3" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.3">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.3" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta property="og:type" content="website">
<meta property="og:title" content="RVDSD的个人笔记本">
<meta property="og:url" content="http://rvdsd.top/page/9/index.html">
<meta property="og:site_name" content="RVDSD的个人笔记本">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="RVDSD的个人笔记本">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.3',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://rvdsd.top/page/9/"/>





  <title>RVDSD的个人笔记本</title><!-- hexo-inject:begin --><!-- hexo-inject:end -->
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">RVDSD的个人笔记本</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">学习过程中的输出</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2017/10/01/BioItem/生信-转录组学习笔记01-计算机及软件安装/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/10/01/BioItem/生信-转录组学习笔记01-计算机及软件安装/" itemprop="url">转录组学习笔记01-计算机及软件安装</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-10-01T12:00:00+08:00">
                2017-10-01
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/生信实战项目/" itemprop="url" rel="index">
                    <span itemprop="name">生信实战项目</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  1,978
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  9
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="前言">前言</h2>
<p>转录组的这几篇入门笔记主要是参照了生信技能树论坛，公众号，生信媛公众号，徐更洲的博客，沈梦圆的博客及公众号，Jimmy等人的博客完成的。</p>
<h2 id="软件安装一miniconda">软件安装（一）——miniconda</h2>
<h3 id="首先要安装miniconda">首先要安装：Miniconda</h3>
<p>先了解一下conda，Anaconda,Miniconda。 <strong>conda</strong>是一个工具，也是一个可执行命令，其核心功能是包管理与环境管理。包管理与pip的使用类似，环境管理则允许用户方便地安装不同版本的python并可以快速切换。 <strong><a href="https://www.anaconda.com/download/#download" target="_blank" rel="external">Anaconda</a></strong>是一个用于科学计算的Python发行版，支持 Linux, Mac, Windows系统，提供了包管理与环境管理的功能，可以很方便地解决多版本python并存、切换以及各种第三方包安装问题。Anaconda则是一个打包的集合，里面预装好了conda、某个版本的python、众多packages、科学计算工具等等，所以也称为Python的一种发行版。 <strong><a href="https://conda.io/miniconda.html" target="_blank" rel="external">Miniconda</a></strong>则是Anaconda的微缩版，它只包含最基本的内容，即python与conda，以及相关的必须依赖项，对于空间要求严格的用户，Miniconda是一种选择。 <strong><a href="https://bioconda.github.io/index.html" target="_blank" rel="external">bioconda</a></strong>是conda上一个分发生物信息软件的频道。多数软件都可以通过conda来安装，可查看<a href="https://bioconda.github.io/recipes.html#recipes" target="_blank" rel="external">可用软件列表</a>。</p>
<h4 id="第一步下载miniconda2">第一步：下载miniconda2</h4>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">wget https://repo.continuum.io/miniconda/Miniconda2-latest-Linux-x86_64.sh</div></pre></td></tr></table></figure>
<h4 id="第二步安装miniconda2">第二步：安装miniconda2</h4>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">bash Miniconda2-latest-Linux-x86_64.sh</div></pre></td></tr></table></figure>
<p>安装过程基本上就是按Enter或输入yes，仔细看说明就行。</p>
<h4 id="第三步将miniconda2保存到环境变量">第三步：将miniconda2保存到环境变量</h4>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">echo &quot;export PATH=/home/bio/miniconda2/bin:&quot;&apos;$PATH&apos; &gt;&gt; ~/.bashrc</div><div class="line">source ~/.bashrc</div></pre></td></tr></table></figure>
<h4 id="第四步添加通道">第四步：添加通道</h4>
<p>Conda默认的源访问速度有些慢，可以增加国内的源（国内的源是清华源，其中参考文献中给出的；另外还可以增加几个源，以便于安装更多的软件，尤其是bioconda安装生信类工具。conda-forge通道是Conda社区维护的包含很多不在默认通道里面的通用型软件。r通道是向后兼容性通道，尤其是使用R3.3.1版本时会用到。后添加的通道优先级更高，因此一般用下面列出的顺序添加。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">conda config --set show_channel_urls yes</div><div class="line">conda config --add channels r # Optional, lowest priority</div><div class="line">conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/free</div><div class="line">conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/conda-forge</div><div class="line">conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/bioconda</div></pre></td></tr></table></figure>
<p>如果命令行添加不了，可以用<code>vim ~/.condarc</code>来进行安装，如果安装错误了，可以删除.condarc文件，然后再用命令行来安装。用<code>conda config --get channels</code>可以查看已经添加的频道，而用<code>conda config --show</code>可查看已有的配置。如下所示： <img src="http://ortxpw68f.bkt.clouddn.com/conda002a.png"></p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/conda001a.png">

</div>
<h3 id="conda基本使用">Conda基本使用</h3>
<h4 id="列出安装的软件包">列出安装的软件包</h4>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">conda list</div></pre></td></tr></table></figure>
<p>如下所示： <img src="http://ortxpw68f.bkt.clouddn.com/conda003a.png"></p>
<h4 id="搜索需要安装的软件包获取其完成名字">搜索需要安装的软件包，获取其完成名字</h4>
<p>命令是<code>conda search &lt;package ambigious name&gt;</code> ，以搜索fastqc为例： <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">conda search fastqc  # * 表示对于版本的包已安装</div></pre></td></tr></table></figure></p>
<p>如下所示： <img src="http://ortxpw68f.bkt.clouddn.com/conda004a.png"></p>
<h4 id="安装包">安装包</h4>
<p>命令为<code>conda install &lt;package name&gt;</code> 以安装 numpy=1.7.2为例说明</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">conda install numpy=1.7.2 </div><div class="line"># 安装特定版本的软件包</div><div class="line"># 也可以不加</div></pre></td></tr></table></figure>
<h4 id="更新软件包">更新软件包</h4>
<p><code>conda update &lt;package name&gt;</code></p>
<h4 id="移除软件包">移除软件包</h4>
<p><code>conda remove &lt;package name&gt;</code></p>
<h4 id="获取帮助信息">获取帮助信息</h4>
<p><code>conda -h # 查看conda可用的命令</code> <code>conda install -h #查看install子命令的帮助</code></p>
<h3 id="关于环境">关于环境</h3>
<p>condas可以创建多个分析环境，这是它的优势之一，不过目前用不到，以后用到了再学。</p>
<h4 id="查看已有环境">查看已有环境</h4>
<p>虚拟<strong>环境管理</strong>：conda比较好用的就是它能够建立多个互不干扰的分析环境。通过<code>conda info --envs</code>可以查看环境，如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">conda info --envs</div><div class="line"># 或 conda info -e</div></pre></td></tr></table></figure>
<p>目前就只有一个默认环境，也就是root： <img src="http://ortxpw68f.bkt.clouddn.com/minicoda2.png"></p>
<h3 id="卸载miniconda">卸载miniconda</h3>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">rm -rf ~/miniconda2</div></pre></td></tr></table></figure>
<p>从环境变量中去掉miniconda：打开~/.bash_profile文件，删掉其中miniconda的路径，关闭并保存 删除隐藏的.condarc 、.conda以及.continuum文件</p>
<h2 id="软件安装二其它生信工具">软件安装（二）——其它生信工具</h2>
<p>目前所用的生信工具如下所示：</p>
<h3 id="sratoolkit">(1)sratoolkit</h3>
<p><a href="https://trace.ncbi.nlm.nih.gov/Traces/sra/sra.cgi?view=software" title="sratoolkit" target="_blank" rel="external">sratoolkit</a>：把NCBI SRA（Sequence Read Archive）数据库中的NGS序列数据从 sra 格式转换到 fastq 格式。</p>
<p>conda安装：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">conda install -c jfear sratoolkit=2.8.1</div></pre></td></tr></table></figure>
<p>如果安装不成功，可采用下列安装方式（<strong>我的笔记本上上基本上都是conda安装，对于下面的安装方式并没有试过</strong>）：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">cd mynotes</div><div class="line">cd src</div><div class="line">wget https://ftp-trace.ncbi.nlm.nih.gov/sra/sdk/2.8.2-1/sratoolkit.2.8.2-1-ubuntu64.tar.gz</div><div class="line">tar -zxvf sratoolkit.2.8.2-1-ubuntu64.tar.gz</div><div class="line">mv sratoolkit.2.8.2-1-ubuntu64 ~/biosoft</div><div class="line"></div><div class="line"># 加入环境变量</div><div class="line">echo &apos;PATH=$PATH:~/biosoft/sratoolkit.2.8.2-1-ubuntu64/bin&apos; &gt;&gt; ~/.bashrc</div><div class="line"></div><div class="line"># 测试</div><div class="line">prefetch -v</div><div class="line"># 尝试下载，默认存放在家目录下的ncbi文件夹中</div><div class="line">prefetch -c SRR390728</div></pre></td></tr></table></figure>
<h3 id="fastqc">fastqc</h3>
<p><a href="http://www.bioinformatics.babraham.ac.uk/projects/fastqc/" title="fastqc" target="_blank" rel="external">fastqc</a>:二代测序数据质量分析软件。</p>
<p>安装如下： <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">conda install fastqc</div></pre></td></tr></table></figure></p>
<p>或者是采用常规的安装方式： <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"># 判断系统是否安装java</div><div class="line">java -version</div><div class="line"># 安装java， 请改成openjdk-9-jdk，下面的是错误演示</div><div class="line">sudo apt install  openjdk-9-jre-headless</div><div class="line"># 验证</div><div class="line">java -version</div><div class="line"># openjdk version &quot;9-internal&quot;</div><div class="line"># OpenJDK Runtime Environment (build 9-internal+0-2016-04-14-195246.buildd.src)</div><div class="line"># OpenJDK 64-Bit Server VM (build 9-internal+0-2016-04-14-195246.buildd.src, mixed mode)</div><div class="line"># 安装fastqc</div><div class="line">cd src</div><div class="line">wget http://www.bioinformatics.babraham.ac.uk/projects/fastqc/fastqc_v0.11.5.zip</div><div class="line">unzip fastqc_v0.11.5.zip</div><div class="line">mv FastQC/ ~/biosoft/</div><div class="line">cd ~/biosoft/FastQC/</div><div class="line">chmod 770 fastqc</div><div class="line"># 添加环境变量， 我用sed修改</div><div class="line">sed -i &apos;/^PATH/s/\(.*\)/\1:~\/biosoft\/FastQC\//&apos; ~/.bashrc</div><div class="line">source ~/.bashrc</div><div class="line">fastqc -v</div><div class="line"># FastQC v0.11.5</div></pre></td></tr></table></figure></p>
<h3 id="hisats">hisats</h3>
<p><a href="http://ccb.jhu.edu/software/hisat2/index.shtml" title="hisats" target="_blank" rel="external">hisats</a>：将测序结果比对到人类参考基因组上。HISAT2是TopHat2/Bowti2的继任者，使用改进的BWT算法，实现了更快的速度和更少的资源占用。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">conda install -c bioconda hisat2</div></pre></td></tr></table></figure>
<h3 id="samtools">samtools</h3>
<p><a href="http://www.htslib.org/" title="samtools" target="_blank" rel="external">samtools</a>:处理SAM、BAM文件的工具软件。BAM格式文件是存放高通量测序中比对结果的标准格式文件。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">conda install -c bioiconda samtools</div></pre></td></tr></table></figure>
<p>或者如下安装： <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line">cd src</div><div class="line">#  prerequsite</div><div class="line">## system requirement</div><div class="line">sudo apt install autoconf libz-dev libbz2-dev liblzma-dev libssl-dev</div><div class="line"></div><div class="line">### zlib2</div><div class="line">wget http://zlib.net/zlib-1.2.11.tar.gz</div><div class="line">tar -zxvf zlib-1.2.11.tar.gz &amp;&amp; cd zlib-1.2.11 &amp;&amp; make &amp;&amp; sudo make install &amp;&amp; cd .. &amp;&amp; rm -rf zlib-1.2.11</div><div class="line"></div><div class="line">### bzip2</div><div class="line">wget http://bzip.org/1.0.6/bzip2-1.0.6.tar.gz</div><div class="line">tar -zxvf bzip2-1.0.6.tar.gz &amp;&amp; cd bzip2-1.0.6 &amp;&amp; make &amp;&amp; sudo make install &amp;&amp; cd .. &amp;&amp; rm -rf  bzip2-1.0.6</div><div class="line"></div><div class="line">### curses</div><div class="line">sudo apt-get install libncurses5-dev </div><div class="line"></div><div class="line">### htslib</div><div class="line">git clone https://github.com/samtools/htslib.git</div><div class="line">cd htslib</div><div class="line">autoreconf</div><div class="line"></div><div class="line"># building samtools</div><div class="line">git clone https://github.com/samtools/samtools.git</div><div class="line">cd samtools</div><div class="line">autoconf -Wno-syntax</div><div class="line">./configure </div><div class="line">make &amp;&amp; make install prefix=$HOME/biosoft/samtools</div><div class="line"></div><div class="line">## add PATH</div><div class="line">sed  &apos;/^PATH/s/\(.*\)/\1:~\/biosoft\/samtools\/bin/&apos; .bashrc -i</div><div class="line">source ~/.bashrc</div><div class="line">samtools --help</div></pre></td></tr></table></figure></p>
<h3 id="htseq-count">htseq-count</h3>
<p><a href="http://htseq.readthedocs.io/en/release_0.9.1/" title="htseq-count" target="_blank" rel="external">htseq-count</a>：用于reads计数的软件，他能对位于基因组上的一些单位的reads数进行统计，这里所说的单位主要是指染色体上的一组位置区间（我们常见的就是gene exon）</p>
<p>优先conda安装</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">conda install -c bioconda htseq=0.7.2</div></pre></td></tr></table></figure>
<p>如果conda无法安装，采用下列安装方式：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">## Download and install HISAT </div><div class="line"># https://ccb.jhu.edu/software/hisat2/index.shtml</div><div class="line">cd ~/biosoft</div><div class="line">mkdir HISAT  &amp;&amp;  cd HISAT </div><div class="line">#### readme: https://ccb.jhu.edu/software/hisat2/manual.shtml</div><div class="line">wget ftp://ftp.ccb.jhu.edu/pub/infphilo/hisat2/downloads/hisat2-2.0.4-Linux_x86_64.zip</div><div class="line">unzip hisat2-2.0.4-Linux_x86_64.zip</div><div class="line">ln -s hisat2-2.0.4  current </div><div class="line">## ~/biosoft/HISAT/current/hisat2-build</div><div class="line">## ~/biosoft/HISAT/current/hisat2</div></pre></td></tr></table></figure>
<p>或者如下： <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"># prerequsites</div><div class="line">sudo apt-get install python-pip</div><div class="line">pip install --upgrade pip</div><div class="line">sudo apt-get install build-essential python2.7-dev python-numpy python-matplotlib</div><div class="line">## 验证， 保证无报错</div><div class="line">python -V</div><div class="line">## python</div><div class="line">python</div><div class="line">&gt;&gt;&gt; import numpy </div><div class="line">&gt;&gt;&gt; import matplotlib </div><div class="line"></div><div class="line">## install HTSeq</div><div class="line">pip install htseq</div><div class="line"></div><div class="line">## 验证</div><div class="line">python</div><div class="line">&gt;&gt;&gt; import HTSeq</div></pre></td></tr></table></figure></p>
<h3 id="r">R</h3>
<p><a href="https://www.r-project.org/" title="R" target="_blank" rel="external">R</a>：统计与数据可视化工具。 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">conda install -c r r-base</div><div class="line">R #运行的时候要大写</div><div class="line"></div><div class="line">## conda install -c r r-essentials </div><div class="line">## -essentials表示安装R,及80多个常用的数据分析包, 包括idplyr, shiny, ggplot2, tidyr, caret 和 nnet</div></pre></td></tr></table></figure></p>
<h4 id="rstudio的安装">Rstudio的安装</h4>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">conda install rstudio</div><div class="line">rstudio</div></pre></td></tr></table></figure>
<p>后面涉及有关R的分析是在Sindows平台下完成的，并没有用到Linux下的R工具。</p>
<h4 id="fastx-toolkit安装">fastx-toolkit安装</h4>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">conda install -c biobuilds fastx-toolkit</div></pre></td></tr></table></figure>
<h2 id="参考资料">参考资料：</h2>
<ol start="2" style="list-style-type: decimal">
<li><a href="https://zhuanlan.zhihu.com/p/25085567" target="_blank" rel="external">使用Bioconda管理Linux系统中的生物信息软件</a></li>
<li><a href="http://www.jianshu.com/p/2f3be7781451" target="_blank" rel="external">PeterYuan，Anaconda使用总结</a></li>
<li><a href="http://www.jianshu.com/p/b16ae34f9012" target="_blank" rel="external">hoptop.转录组入门（1）：软件准备</a></li>
<li><a href="https://mp.weixin.qq.com/s?src=3&amp;timestamp=1507534977&amp;ver=1&amp;signature=uauB8*AHbC91QJFzs7AVO9vdeU92DPB9L4J5qT67AiaQtvdg0nvRCGJo1yaciFx3pF3slW4Zh0w8GUAecvQJmBKc2I0xX2q7IBvD2ha0T-uFJ1xlINQNb-VM40mZZOkP3rVn78KVvAFtVqYCxeSdjGBoYw23piWH50rts95D6iU=" target="_blank" rel="external">生信软件的好帮手-bioconda</a></li>
<li><a href="http://www.dxy.cn/bbs/topic/37352184" target="_blank" rel="external">中国科大开源镜像站的bioconda新镜像申请</a></li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2017/09/23/BioStatistics/生物统计-14因子分析/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/09/23/BioStatistics/生物统计-14因子分析/" itemprop="url">因子分析笔记</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-09-23T12:02:00+08:00">
                2017-09-23
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/生物统计/" itemprop="url" rel="index">
                    <span itemprop="name">生物统计</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  599
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  2
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="因子分析思想">因子分析思想</h2>
<p>在医学研究中有一些现象是难以直接观测的，通常称为不可测现象，它们只能通过其他多个可观测的指标来间接地反映。例如，脑部疾病患者的意识清醒状态是一个不可测现象，但可以通过患者的语言能力、辨识能力、记忆能力、理解能力、思维的逻辑能力等一系列可观测的指标来反映。这里，由于各个可观测指标都不同程度地反映了意识清醒状态这一不可测现象，因此这些可观测指标之间呈现出一定的相关性。很自然地，人们可能认为这些可观测指标之间的相关性主要是由它们反共同反映的不可测现象支配的。 一般地，对于多指标数据中呈现出来的相关性，是否存在对这种相关性起支配作用的潜在因素？如果存在，如何找出这些潜在因素？这些潜在因素是怎样对原始指标起支配作用的？这些问题，都可以通过因子分析来解决。事实上，因子分析是一种从分析多个原始指标的相关关系入手，找到支配这种相关关系的有限个不可观测的潜在变量，并用这些潜在变量来解释原始指标之间的相关性或协方差关系的多元统计分析方法。</p>
<h2 id="因子分析的数学模型">因子分析的数学模型</h2>
<h2 id="因子模型的性质">因子模型的性质</h2>
<h3 id="公共度">公共度</h3>
<h3 id="因子贡献及因子贡献率">因子贡献及因子贡献率</h3>
<h3 id="因子载荷及因子载荷阵">因子载荷及因子载荷阵</h3>
<h2 id="因子载荷阵的求解及计算步骤">因子载荷阵的求解及计算步骤</h2>
<p>案例如下： 例22-2 某医院为了合理地评价该院各月的医疗工作质量，搜集了三年有关门诊人次、出院人数、病床利用率、病床周转次数、平均住院天数、治愈好转率、病死率、诊断符合率、抢救成功率等9个指标数据，如表22-8。现采用因子分析方法，探讨其综合评价指标体系。<img src="http://ortxpw68f.bkt.clouddn.com/efa001.png"></p>
<h2 id="参考资料">参考资料</h2>
<ol style="list-style-type: decimal">
<li><a href="https://zhuanlan.zhihu.com/p/26305845" target="_blank" rel="external">《R语言实战》第四部分第十四章-主成分分析和因子分析学习笔记</a></li>
<li><a href="https://zhuanlan.zhihu.com/p/23981354" target="_blank" rel="external">Learn R | 数据降维之因子分析（上）</a></li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2017/09/22/BioStatistics/生物统计-13主成分分析/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/09/22/BioStatistics/生物统计-13主成分分析/" itemprop="url">主成分分析笔记</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-09-22T12:02:00+08:00">
                2017-09-22
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/生物统计/" itemprop="url" rel="index">
                    <span itemprop="name">生物统计</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  4,837
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  19
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="主成分分析简介及主要思想">主成分分析简介及主要思想</h2>
<p>主成分分析（principal components analysis，PCA），是由1901年被Pearson首先引入的，1933年由Hotelling作了进一步的发展，主成分分析是从多个数值变量（指标）之间的相互关系入手，利用降维的思想，将多个变量（指标）化为少数几个互不相关的综合变量（指标）的统计方法。</p>
<p>在医学研究中，为了客观、全面地分析问题，常要记录多个观察指标并考虑众多的影响因素，这样的数据虽然可以提供丰富的信息，但同时也使用数据的分析工作更趋复杂化。例如在儿童生长发育的评价中，收集到的数据包括每一个儿童的身高、体重、胸围、坐高、肺活量等十多个指标。怎样利用这类多指标的数据对每一个儿童的生长发育水平作出正常的评价？如果仅用其中任一指标来作评价，其结论显然是片面的，而且不能充分利用已有的数据信息。如果分别利用每一指标进行评价，然后再综合各指标评价的结论，这样做一是可能会出现各指标评价的结论不一致，甚至相互冲突，从而给最后的综合评价带来困难；二是工作量明显增大，不利于进一步的统计分析。事实上，在实际工作中，所涉及的众多指标之间经常是有相互联系和影响的，从这一点出发，希望通过对原始相互关系的研究，找出少数几个综合指标，这些综合指标是原始指标的纯属绵且，它既保留了原始指标的主要信息，且又互不相关。这样一种从众多原始指标之间相互关系入手，寻找少数综合指标以根据原始指标信息的多元统计方法称为主成分分析。</p>
<h2 id="主成分分析的数学模型及几何意义">主成分分析的数学模型及几何意义</h2>
<h3 id="一主成分分析的数学模型">（一）主成分分析的数学模型</h3>
<p>设有m个指标，即<span class="math inline">\(X_{1},X_{2},\dots,X_{m}\)</span>,欲寻找可以概括这m个指标主要信息的综合指标<span class="math inline">\(Z_{1},Z+{2},\dots,Z_{m}\)</span>，从数学上讲，就是寻找一组常数，即<span class="math inline">\(a_{i1},a_{i2},\dots,a_{im}(i=1,2,\dots,m）\)</span>，使这m个指标的线性组合为： <img src="http://ortxpw68f.bkt.clouddn.com/pca_f001.png"> 能够根据m个原始指标<span class="math inline">\(X_{1},X_{2},\dots,X_{m}\)</span>的主要信息，且各<span class="math inline">\(Z_{i}(i=1,2,\dots,m)\)</span>互不相关，为叙述方案，可以引入以下的矩阵形式，令</p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/pca_f002.png"> 则公式1-1可以表示为： <span class="math display">\[
\bf {Z=AX} (1-2)
\]</span> 或者是</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/pca_f003.png">

</div>
<p>如果<span class="math inline">\(Z_{1}=\bf a&#39;_{1}X\)</span>满足<span class="math inline">\(\bf a&#39;_{1}a_{1}=1\)</span>，且 <span class="math inline">\(Var(Z_{1})=\mathop{Max}\limits_{\bf a&#39;a=1}^{}{Var(\bf a&#39;X)}\)</span>，刚称<span class="math inline">\(Z_{1}\)</span>是原始指标<span class="math inline">\(X_{1},X_{2},\dots,X_{m}\)</span>的第一主成分。</p>
<p>通常情况下，如果<span class="math inline">\(Z_{i}=\bf a&#39;X\)</span>满足： (1)<span class="math inline">\(\bf a&#39;_{i}a_{i}=1\)</span>，当i&gt;1时，<span class="math inline">\(\bf a&#39;_{i}a_{j}=0(i=1,2,\dots,i-1)\)</span> (2)<span class="math inline">\(Var(Z_{i})=\mathop{Max{Var(a&#39;\bf X)}}\limits_{\bf a&#39;a=1,\bf a&#39;a_{j}=0(j=1,2,\dots,i-1)}^{}\)</span> 刚称<span class="math inline">\(Z_{i}\)</span>是原始指标的第<span class="math inline">\(i\)</span>主成分（<span class="math inline">\(i=2,\dots,m\)</span>）。</p>
<p>由上述定义可知，当<span class="math inline">\(i\neq j\)</span>时，主成分<span class="math inline">\(Z_{i}\)</span>与<span class="math inline">\(Z_{j}\)</span>是互不相关的，并且<span class="math inline">\(Z_{1}\)</span>是原始指标<span class="math inline">\(X_{1},X_{2},\dots,X_{m}\)</span>的一切线性组合中方差最大者，<span class="math inline">\(Z_{2}\)</span>是与<span class="math inline">\(Z_{1}\)</span>不相关的、除<span class="math inline">\(Z_{1}\)</span>以外的<span class="math inline">\(X_{1},X_{2},\dots,X_{m}\)</span>一切线性组合中方差最大者，<span class="math inline">\(Z_{m}\)</span>是与<span class="math inline">\(Z_{1},Z_{2},\dots,Z_{m}-1\)</span>都不相关的，除<span class="math inline">\(Z_{1},Z_{2},\dots,Z_{m}-1\)</span>以外的<span class="math inline">\(X_{1},X_{2},\dots,X_{m}\)</span>一切线性组合中方差最大者。从理论上讲，求得的主成分个数最多可能有m个，这时，m个主成分就反映了全部原始指标所提供的信息，鉴于主成分分析的目的主要是用较少的综合指标来反映全部原始指标中的主要信息，因此在实际工作中，所确定的主成分个数总是小于原始指标的个数。</p>
<h3 id="二主成分的几何意义">（二）主成分的几何意义</h3>
<p>为方便讨论，以m=2为例说明主成分分析的几何意义，设个体具有两个观测指标X1和X2，它们之间具有较强的相关性，测量n例这样的个体的值，将所得的n对数据在以X1为横轴，X2为纵轴的二维坐标平面中的苫，得到如下的散点图： <img src="http://ortxpw68f.bkt.clouddn.com/pca.png"></p>
<p>由上图可以看出，由于<span class="math inline">\(X_{1}\)</span>和<span class="math inline">\(X_{2}\)</span>具有较强的相关性，这n个点的分页呈现出直接化的趋势；同时它们沿<span class="math inline">\(X_{1}\)</span>轴方向和<span class="math inline">\(X_{2}\)</span>轴方向都具有较大的变异变。个体在某个方向上的变异度可以用该方向上相应观测变量的方差来定量地表示。显然，如果只考虑<span class="math inline">\(X_{1}\)</span>和<span class="math inline">\(X_{2}\)</span>中任何一个方向上的方差，就将损失原始观测数据中很大一部分信息。如果我们将坐标轴<span class="math inline">\(X_{1}\)</span>和<span class="math inline">\(X_{2}\)</span>同时按逆时针方向作一个放置，得到新的坐标轴<span class="math inline">\(Z_{1}\)</span>和<span class="math inline">\(Z_{2}\)</span>，使得在亲折坐标平面上，这n个点的分布基本上不再具有有相关性，且它们的变异主要集中在Z1方向上，而在Z2方向上的变异较小，此时若取<span class="math inline">\(Z_{1}\)</span>作为第一主成分，则<span class="math inline">\(Z_{1}\)</span>就反应了原始指标<span class="math inline">\(X_{1}\)</span>和<span class="math inline">\(X_{2}\)</span>所包含的主要信息。</p>
<h2 id="主成分的求法及性质">主成分的求法及性质</h2>
<h3 id="一主成分的求法">（一）主成分的求法</h3>
<p>由主成分的定义可知，各主成分互不相关，即任意两个主成分<span class="math inline">\(Z_{i},Z_{j}\)</span>的协方差为0，即 <span class="math display">\[
Cov(Z_{i},Z_{j})=0,i\neq j
\]</span></p>
<p>且各主成分的方差满足： <span class="math display">\[
Var(Z_{1}) \geq Var(Z_{2}) \dots Var(Z_{m})  
\]</span></p>
<p>于是由公式(1-2)定义的随机向量<span class="math inline">\(Z\)</span>的协方差矩阵为： <img src="http://ortxpw68f.bkt.clouddn.com/pca_f004.png"></p>
<p>由主成分定义中的条件（1）可知，这里的方阵<span class="math inline">\(A\)</span>是正交阵，即<span class="math inline">\(A&#39;A=I\)</span>（I为单位矩阵），由此可得：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/pca_f005.png">

</div>
<p>由上述公式可知，求原始指标<span class="math inline">\(X_{1},X_{2},\dots,X_{m}\)</span>的主成分问题，实际上就是要求满足上述条件的正交阵<span class="math inline">\(A\)</span>，即随机微量<span class="math inline">\(X=(X_{1},X_{2},\dots,X_{m}\)</span>的协方差矩阵<span class="math inline">\(Cov(X)\)</span>的特征值（eigenvalue）与特征向量(eigenvector)。</p>
<h3 id="主成分的计算过程">主成分的计算过程</h3>
<p>下面讨论怎么由一组<span class="math inline">\(X_{1},X_{2},\dots,X_{m}\)</span>的样本观测值求出主成分，假设收集到的原始数据共有n例，每例测得m个指标的数值，记录如下所示： <img src="http://ortxpw68f.bkt.clouddn.com/pca003.png"></p>
<h4 id="对各原始指标数据进行标准化先按下式进行">1. 对各原始指标数据进行标准化，先按下式进行：</h4>
<p><span class="math display">\[
X&#39;_{ij}=\frac{X_{ij}-\bar{X_{j}}}{S_{J}}(j=1,2,3,\dots,m)
\]</span></p>
<p>将原始指标标准化（标准化通俗讲就是每一列的每个数字每去这一列的均值，然后除以标准差），然后用标准化的数据<span class="math inline">\(X&#39;_{ij}\)</span>来计算主成分，为了方便计算，下面的公式中仍用<span class="math inline">\(X_{ij}\)</span>表示标准化后的指标数据，<span class="math inline">\(\bf X\)</span>为标准化后的数据矩阵，则： <img src="http://ortxpw68f.bkt.clouddn.com/pca_f006.png"></p>
<h4 id="求出x的协方差矩阵r">2. 求出<span class="math inline">\(X\)</span>的协方差矩阵<span class="math inline">\(R\)</span></h4>
<p>标准化后，<span class="math inline">\(X\)</span>的相关矩阵即为协方差矩阵<span class="math inline">\(Cov({\bf X})\)</span> <img src="http://ortxpw68f.bkt.clouddn.com/pca_f007.png"> 对角线上分别是<span class="math inline">\(r_{11}\)</span>，<span class="math inline">\(r_{22}\)</span>和<span class="math inline">\(r_{mm}\)</span>的方差，非对角线上是协方差。协方差是衡量两个变量同时变化的变化程度。以两个变量x、y来举例，例如协方差大于0，表示x和y若一个增，另一个也增；小于0表示一个增，一个减。如果ｘ和ｙ是统计独立的，那么二者之间的协方差就是０；但是协方差是０，并不能说明ｘ和ｙ是独立的。协方差绝对值越大，两者对彼此的影响越大，反之越小。协方差是没有单位的量，因此，如果同样的两个变量所采用的量纲发生变化，它们的协方差也会产生数字上的变化。</p>
<h4 id="求出相关矩阵的特征值和特征值对应的特征向量">3. 求出相关矩阵的特征值和特征值对应的特征向量</h4>
<p>由公式1-3得知，求主成分的问题，实际上是求出<span class="math inline">\(X\)</span>的协方差矩阵<span class="math inline">\(Cov(X)\)</span>（这里即为<span class="math inline">\(X\)</span>的相关矩阵<span class="math inline">\(R\)</span>）的特征值和特征向量，由于<span class="math inline">\(R\)</span>为半正定矩阵，故可由R的特征方程 <span class="math display">\[
|{\bf R} -\lambda{\bf I|} 
= 0
\]</span></p>
<p>解得每一特征值<span class="math inline">\(\lambda_{i}\)</span>对应的单位特征向量<span class="math inline">\(a_{i}=(a_{i1} a_{i2} \dots a_{im}&#39;\)</span>，从而求得各主成分，即 <span class="math display">\[
Z_{i}={\bf a&#39;_{i}X}={a_{i1}X_{1}+a_{i2}X_{2}+ \dots +a_{im}X_{m}} i=1,2,\dots,m
\]</span></p>
<blockquote>
<p>有关特征值和特征向量的理解可以参考后文引用的文章。这里简单提一下，如果把矩阵看作是运动，对于运动而言，最重要的就是运动的速度和方向，那么特征值就是运动的速度，特征向量就是运动的方向。</p>
</blockquote>
<h3 id="二主成分的性质">（二）主成分的性质</h3>
<h4 id="各主成分互不相关">1. 各主成分互不相关</h4>
<p>即<span class="math inline">\(Z_{i}\)</span>与<span class="math inline">\(Z_{j}\)</span>的相关系数为0，即： <span class="math display">\[
r_{z_{i},z_{j}}=\frac{Cov(Z_{i},Z_{j})}{\sqrt{Cov(Z_{i},Z_{j})Cov(Z_{j},Z{j})}}=0(i \neq j)
\]</span> 因此各主成分间的相关系统矩阵为单位矩阵。</p>
<h4 id="主成分的贡献率和累积贡献率">2. 主成分的贡献率和累积贡献率</h4>
<p>可以证明，各原始指标<span class="math inline">\(X_{1},X_{2},\dots,X_{m}\)</span>的方差和与各主成分<span class="math inline">\(Z_{1},Z_{2},\dots,Z_{m}\)</span>的方差和相等，将数据标准化后，原始指标的方差和为<span class="math inline">\(\sum\limits_{i=1}^m \lambda_{i}\)</span>，即有<span class="math inline">\(m=\sum\limits_{i=1}^m \lambda_{i}\)</span></p>
<p>各指标所提供的信息量是用其方差来衡量的。由此可知，主成分分析是把m个原始指标<span class="math inline">\(X_{1},X_{2},\dots,X_{m}\)</span>的总方差分解为m个互不相关的综合指标<span class="math inline">\(Z_{1},Z_{2},\dots,Z_{m}\)</span>的方差之和，使第一主成分的方差达到最大，即变化最大的方向微量所相应的线性函数，最大方差为<span class="math inline">\(\lambda\)</span>。其中<span class="math inline">\({\lambda}/{\sum\limits_{i=1}^m \lambda_{i}}\)</span>表明了第一主成分<span class="math inline">\(Z_{1}\)</span>的方差在全部方差中所占的比值，称为第一主成分的贡献率，这个值越大，表明<span class="math inline">\(Z_{1}\)</span>这个指标综合原指标<span class="math inline">\(X_{1},X_{2},\dots,X_{m}\)</span>的能力越强，也可以说，由<span class="math inline">\(Z_{1}\)</span>的差异来解释<span class="math inline">\(X_{1},X_{2},\dots,X_{m}\)</span>的差异的能力越强，正是因为这一点，才把<span class="math inline">\(Z_{1}\)</span>称为<span class="math inline">\(X_{1},X_{2},\dots,X_{m}\)</span>的第一主成分，也就是<span class="math inline">\(X_{1},X_{2},\dots,X_{m}\)</span>的主要部分，了解到这一点，就可以知道为什么主成分是按特征值<span class="math inline">\(\lambda_{1},\lambda_{2},\dots,\lambda_{m}\)</span>进行排序的。</p>
<p>通常情况下 <span class="math display">\[
\frac{\lambda_{i}}{\sum\limits_{i=1}^m}=\frac{\lambda_{i}}{m}(k=1,2,\dots,m)
\]</span> 为第i主成分的贡献率；而称 <span class="math display">\[
\sum\limits_{i=1}^k \frac{\lambda_{i}}{m}(k \leq m)
\]</span> 为前k个主成分的累积贡献率。</p>
<h4 id="主成分个数的选取">3. 主成分个数的选取</h4>
<p>通常并不需要全部的主成分，只用其中的前几个，一般来说，主成分的保留个数按以下的原则来进行：</p>
<h5 id="以累积贡献率来确定">(1)以累积贡献率来确定：</h5>
<p>当前k个主成分的累积贡献率达到某一特定值时（一般以大于70%为宜，有的时候会要求大于80%），则保留前k个主成分。</p>
<h5 id="以特征值的大小来确定">(2)以特征值的大小来确定：</h5>
<p>即若主成分<span class="math inline">\(Z_{i}\)</span>的特征值<span class="math inline">\(\lambda_{i} \geq 1\)</span>，则保留<span class="math inline">\(Z_{i}\)</span>，否则就去掉该主成分。这个与碎石图类似。</p>
<h4 id="因子载荷">4. 因子载荷</h4>
<p>为了了解各主成分与各原始指标之间的关系，在主成的表达式中，第<span class="math inline">\(i\)</span>主成分<span class="math inline">\(Z_{i}\)</span>的特征值的平方根<span class="math inline">\(\sqrt{\lambda_{i}}\)</span>与第<span class="math inline">\(j\)</span>原始指标<span class="math inline">\(X_{j}\)</span>的系数<span class="math inline">\(a_{ij}\)</span>的乘积，即 <span class="math display">\[
q_{ij}=\sqrt{\lambda_{i}a_{ij}}
\]</span> 为因子载荷（factor loading），由因子载荷构成的矩阵称为因子载荷阵，事实上因子载荷<span class="math inline">\(q_{ij}\)</span>就是第<span class="math inline">\(i\)</span>主成分<span class="math inline">\(Z_{i}\)</span>与第<span class="math inline">\(j\)</span>原始指标<span class="math inline">\(X_{j}\)</span>之间的相关系数，它反映了主成分<span class="math inline">\(Z_{i}\)</span>与原始指标X_{i}$之间联系的密切程度与作用的方向。</p>
<h4 id="样品的主成得分">5. 样品的主成得分</h4>
<p>对于具有原始指标测定值<span class="math inline">\((X_{i1},X_{i2},\dots,X_{im})\)</span>的任一样品，可先用标准化变换式将原始数据标化，即：</p>
<p><span class="math display">\[
X&#39;_{ij}=\frac{X_{ij}-\bar{X_{j}}}{S_{J}}(j=1,2,3,\dots,m)
\]</span></p>
<p>然后代入各主成分的表达式，即 <span class="math display">\[
Z_{i}={\bf a&#39;_{i}X}={a_{i1}X_{1}+a_{i2}X_{2}+ \dots +a_{im}X_{m}} i=1,2,\dots,m
\]</span> 求出该样本各主成分值，这样求得的主成分值称为该样本的主成分得分，利用样品的主成分得分，可以对样品的特征进行推断和评价。</p>
<h2 id="案例分析">案例分析</h2>
<h3 id="案例一">案例一</h3>
<p>例22-1 某研究者测得84名10岁男孩的身高、坐高、体重、胸围、肩宽、肺活量等6项生长发育指标，数据见表22-2。试作主成分分析。 <img src="http://ortxpw68f.bkt.clouddn.com/pca001.png"></p>
<h4 id="第1步导入数据">第1步：导入数据</h4>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">raw_pca &lt;- read.csv(&quot;https://raw.githubusercontent.com/20170505a/raw_data/master/data_szq_2201.csv&quot;)</div><div class="line"># 这是原始数据，放在了github上</div><div class="line">head(raw_pca)</div><div class="line">str(raw_pca)</div><div class="line">raw_pca &lt;- raw_pca[-1]</div><div class="line">#第1列是序号，没用，剔除掉</div></pre></td></tr></table></figure>
<p><img src="http://ortxpw68f.bkt.clouddn.com/pca001a.png"> 剔除掉第1列后的数据： <img src="http://ortxpw68f.bkt.clouddn.com/pca002a.png"></p>
<h4 id="第2步-数据的简单统计量">第2步： 数据的简单统计量</h4>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">apply(raw_pca,2,sd) # 求各列的标准差</div><div class="line">apply(raw_pca,2,mean) # 求各列的均数</div></pre></td></tr></table></figure>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/pca003a.png">

</div>
<h4 id="第3步相关矩阵的特征值">第3步：相关矩阵的特征值</h4>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">raw.pr&lt;- prcomp(raw_pca, scale = TRUE) # 标准误、方差贡献率和累积贡献率</div><div class="line">summary(raw.pr,loadings=TRUE) # 标准误、方差贡献率和累积贡献率</div></pre></td></tr></table></figure>
<p><img src="http://ortxpw68f.bkt.clouddn.com/pca005a.png"> 在上图中，其中第二行，即Proportion of Variance表示的是贡献率；而第3行，即Cumulative Proportion表示的是累积贡献率；由这个表可以看出，主成分取3个比较合适，此时的累积贡献率为88.92%，接近于90.00%。</p>
<h4 id="第4步相关矩阵的特征向量">第4步：相关矩阵的特征向量</h4>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">prcomp(raw_pca, scale = TRUE)</div></pre></td></tr></table></figure>
<p><img src="http://ortxpw68f.bkt.clouddn.com/pca004a.png"> 这张表的结果可以得出各个主成分的与相应变量的系数，如果取3个主成分，则可以得出前三个主成分为： <img src="http://ortxpw68f.bkt.clouddn.com/pca006a.png"></p>
<h4 id="第5步因子载荷矩阵">第5步：因子载荷矩阵</h4>
<p>前面的第1到第5步用的是R中的base的函数，没有找到计算因载荷的矩阵方法，现在用psych包来进行计算。</p>
<h5 id="碎石图">碎石图</h5>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"># 利用paych包进行分析</div><div class="line">library(psych)</div><div class="line">fa.parallel(raw_pca,fa=&apos;pc&apos;,n.iter=100,show.legend = FALSE,main=&apos;PCA analysis&apos;)</div></pre></td></tr></table></figure>
<p>psych包中的fa.parallel用来提取主成分，绘制的图形如下所示： <img src="http://ortxpw68f.bkt.clouddn.com/pca007a.png"> 这种图叫碎石图，把对应各个主成分的特征值按从大到小的顺序在图上绘出，选取主成分个数至碎石图发生斜率明显变化为止。其中，蓝线是基于观测特征值的碎石检验，根据100个随机数据矩阵推导出来的特征值均值是红线，从图中可以看出：碎石检验图形最大变化处上面只有一个成分；特征值大于随机模拟数据的也只有一个主成分；特征值大于1的也只有一个主成分。所以这一组数据使用一个主成分即可保留数据集的大部分信息（这一点与书上的不符，但主成分的挑选我觉得参入了一定的主观成分在里面，选取几个主成分，要综合几个因素来看，书上选取的是3个主成分，为了保持一致，我们后面的分析也选3个主成分）。</p>
<h5 id="提取主成分">提取主成分</h5>
<p>提取3个主成分，如下所示： <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">raw2.pca &lt;- principal(r = raw_pca, nfactors = 3, rotate = &apos;none&apos;)</div><div class="line"></div><div class="line"># nfactors=3表示，提取3个主成分</div><div class="line"># rotate指定旋转的方法，默认是最大方差旋转；scores设定是否需要计算主成分得分，默认不计算。</div><div class="line">raw2.pca</div></pre></td></tr></table></figure></p>
<p>结果如下所示： <img src="http://ortxpw68f.bkt.clouddn.com/pca008a.png"> 红色框中就是因子载荷矩阵。</p>
<p>由因子载荷矩阵可知，第一主成分<span class="math inline">\(Z_{1}\)</span>在各原始指标上的因子载荷较为均匀，故可认为该主成分反映的是各原始指标的综合信息；第二主成分<span class="math inline">\(Z_{2}\)</span>在<span class="math inline">\(X_{1}\)</span>（身高）、<span class="math inline">\(X_{3}\)</span>（坐高）及<span class="math inline">\(X_{4}\)</span>（胸围）上的因子载荷较大，故可认为该主成分反映的是体型方面的信息；而第三主成分<span class="math inline">\(Z_{3}\)</span>则主要反映了来自原始指标<span class="math inline">\(X_{6}\)</span>（肺活量）的信息。此外，还可知道，第一主成分<span class="math inline">\(Z_{1}\)</span>与各原始变量之间的关系较为密切，第二主成分<span class="math inline">\(Z_{2}\)</span>与原始变量<span class="math inline">\(X_{1}\)</span>、<span class="math inline">\(X_{2}\)</span>及<span class="math inline">\(X_{4}\)</span>之间的关系较为密切，而第三主成分<span class="math inline">\(Z_{3}\)</span>与原始变量<span class="math inline">\(X_{6}\)</span>之间的关系较为密切。</p>
<p>此外，结果中还有h2和u2以及com，它们的解释如下： h2栏指成分公因子方差，主成分对每个变量的方差解释度； u2栏指成分唯一性，就是方差不能被主成分解释的比例。显然u2=1-h2；</p>
<h4 id="主成分旋转">主成分旋转</h4>
<p>当我们提取的主成分不止一个时，使用主成分旋转会使各主成分所代表的实际意义更容易被解释。主要的旋转方法包括以下两种： 1. 正交旋转：选择的成分保持不相关 2. 斜交旋转：选择的成分保持相关 在本案例中，我们选择使用正交旋转中的方差极大旋转，它试图对载荷阵的列进行去噪，使得每个成分只由一组有限的变量来解释（即载荷阵每列只有少数几个很大的载荷，其他都是很小的载荷）。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"># varimax:方差极大旋转</div><div class="line">raw_pca_xz &lt;- principal(raw_pca,nfactors = 3,rotate = &apos;varimax&apos;)</div><div class="line">raw_pca_xz</div></pre></td></tr></table></figure>
<p><img src="http://ortxpw68f.bkt.clouddn.com/pca001c.png"> 经过主成分旋转的三个主成分仍然不相关，对变量的解释性不变，这是因为变量的群组没有发 生变化。另外，三个主成分旋转后的累积方差解释性没有变化（89%），变的只是各个主成分对方差的解释度（第一主成分从71%变为39%，第二主成分从10%变为30%，第三主成分从8%变为20%）。</p>
<p>获取主成分与原始变量的线性关系（保存在模型的weights部分）：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">head(raw_pca_xz$weights)</div></pre></td></tr></table></figure>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/pca002c.png">

</div>
<p>这样，我们就可以得到主成分与原始变量之间的相关关系：</p>
<p>RC1 = -0.18X1 - 0.273X2 + 0.47X3 + … RC2 =0.535X1 + 0859X2 - 0.067X3 + … RC3 = 0.049X1 - 0.267X2 - 0.173X3 + …</p>
<h2 id="参考资料">参考资料</h2>
<ol style="list-style-type: decimal">
<li>医学统计学.孙振球.第4版</li>
<li><a href="https://www.zhihu.com/question/20852004" target="_blank" rel="external">如何通俗易懂地解释「协方差」与「相关系数」的概念？</a></li>
<li><a href="http://pinkyjie.com/2010/08/31/covariance/" target="_blank" rel="external">浅谈协方差矩阵</a></li>
<li><a href="https://mp.weixin.qq.com/s/-FuNX0LiKHNRysSdgenK_g" target="_blank" rel="external">如何理解矩阵特征值和特征向量？</a></li>
<li><a href="https://ask.hellobi.com/blog/dataman/3073" target="_blank" rel="external">数据挖掘系列篇(15):R语言VS主成分分析的案例</a></li>
<li><a href="https://zhuanlan.zhihu.com/p/23795029" target="_blank" rel="external">Learn R | 数据降维之主成分分析（下）</a></li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2017/09/22/Tools/hexo笔记/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/09/22/Tools/hexo笔记/" itemprop="url">hexo公式渲染</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-09-22T12:02:00+08:00">
                2017-09-22
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/工具笔记/" itemprop="url" rel="index">
                    <span itemprop="name">工具笔记</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  56
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  1
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <ol style="list-style-type: decimal">
<li>安装hexo-math</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install hexo-math --save</div></pre></td></tr></table></figure>
<p>2.<code>_config.yml</code>的配置 添加以下信息：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">math:</div><div class="line">  engine: &apos;mathjax&apos; # or &apos;katex&apos;</div><div class="line">  mathjax:</div><div class="line">    src: custom_mathjax_source</div><div class="line">    config:</div><div class="line">      # MathJax config</div><div class="line">  katex:</div><div class="line">    css: custom_css_source</div><div class="line">    js: custom_js_source # not used</div><div class="line">    config:</div><div class="line">      # KaTeX config</div></pre></td></tr></table></figure>
<p>参考资料： 1. https://github.com/hexojs/hexo-math</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2017/09/20/Principle/RNA-seq入门/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/09/20/Principle/RNA-seq入门/" itemprop="url">生信笔记-RNA-Seq分析简介</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-09-20T12:00:00+08:00">
                2017-09-20
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/生物信息学/" itemprop="url" rel="index">
                    <span itemprop="name">生物信息学</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  3,366
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  12
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>这是对<a href="http://mp.weixin.qq.com/s/KQ7wfCTCT1UIEeMfJBC78Q" target="_blank" rel="external">沈梦圆PPT</a>的整理。是一篇非常好的关于RNA-seq数据分析的文章。</p>
<h3 id="rna-seq到底测的是什么">RNA-seq到底测的是什么？</h3>
<p>mRNA在生物个体内RNA的组分中只占很小的一部分，rRNA占绝大多数。一般我们说RNA-seq指的都是mRNA-seq，后面的流程也都是主要针对mRNA-seq数据分析的。在科学家们的努力下，可以把那些非编码RNA提取出来建库，进行测序。 一个成功的RNA-seq研究，起决定性因素的是一个好的实验设计。还依赖于建库的类型、测序深度和设置适于的生物重复。并且尽量减少测序本身以外带来的数据误差。</p>
<h4 id="真核生物与原核生物的mrna结构差异">真核生物与原核生物的mRNA结构差异</h4>
<ol style="list-style-type: decimal">
<li>真核生物mRNA由5’端帽子结构、5’端非翻译区、翻译区、3’端聚腺苷酸尾巴构成。</li>
<li>原核生物mRNA无5’端帽子结构和3’端聚腺苷酸尾巴。 <img src="http://ortxpw68f.bkt.clouddn.com/rnaseq3.png"></li>
</ol>
<h3 id="数据分析前工作">数据分析前工作</h3>
<p>如下所示： <img src="http://ortxpw68f.bkt.clouddn.com/rnaseq4.png"></p>
<h4 id="实验设计">实验设计</h4>
<p>需要注意的问题：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/rnaseq5.png">

</div>
<ol style="list-style-type: decimal">
<li>单端测序还是双端测序？</li>
<li>测序读长是多少？</li>
<li>是否建链特异性文库？</li>
<li>需要多少数据量？（测序深度）</li>
<li>设置多少个生物学重复比较合适？</li>
<li>如果我们做了生物重复还要做技术重复么？</li>
</ol>
<h3 id="文库构建">文库构建</h3>
<p>1.一般生物体中的的RNA中，rRNA占绝大多数，含量超过90%，而mRNA的含量在1-2%左右。对于真核生物，一般使用加poly(A)选择性富集mRNA或者而原核生物则是通过去除rRNA； 2.是否建stand-preserving库； 3.对于Illumina，测序插入片段一般小于500bp。确定合适长度的插入片段是后续测序和分析的关键； 4.单端还是双端测序毫无疑问的是，单端测序更便宜一些，如果你研究的某个物种的基因表达水平，并且它的转录组已经被注释很好了，单端测序产生的数据量一般是足够的了。双端测序呢，它的读长更长，更适合于那些没有被注释的转录组物种的研究，便于其转录本的从头拼接。 <img src="http://ortxpw68f.bkt.clouddn.com/rnaseq6.png"></p>
<h3 id="测序深度和重复数">测序深度和重复数</h3>
<ol style="list-style-type: decimal">
<li>测序深度和数据量不能一味加大。测序深度虽然可以提高基因定量和检测的敏感性（低丰度的基因），但是同时也会增加一些噪音和一些无用的转录本。</li>
<li>重复数，很重要。（举例子：比较两个班的语文成绩，抽取一个人代表一个班来比较，显然是不科学的。）增加重复数可以减少实验误差，对提高结果的可靠性，是非常有意义的。 <img src="http://ortxpw68f.bkt.clouddn.com/rnaseq7.png"></li>
</ol>
<p>误差分为技术误差和生物学差异。技术误差-可以通过选择最优化的实验测序程序；生物误差-三个生物学重复。 然后设定生物学重复对差异基因的检出率（真阳性率，TPR）的提高具有明显效果。上面说增加测序深度可以检测到低丰度基因，但是对任何样品来说的当测序深度增加再增加，它就会到达平台期。由于科研经费有限，无法无限制地增加样本数或数据量。 所以在生物学重复数和单个样本测序量上必须找到平衡点。在总数据量不变的情况下，将总数据量分配到更多的生物学重复样本中，差异分析结果的可靠性在不断提升。对于RNA-seq，生物学重复数的价值要大于单个样本测序量。但增加生物学重复的样本数，意味着要增加建库费用。因此，即使总数据不变，设置过多的生物学重复也是不合理的。 我们最终确定设置多少生物学重复还是需要看样本个体之间的差异大不大，这点我们一般都很清楚，在测序之前，如果你所研究的现象在两个实验样本之间差异很稳定的话，就可以少设置一些重复，差异不稳定的话有时候设置10个/20个都不够。具体问题具体分析.</p>
<p><strong>测序深度（Sequencing depth），也叫乘数</strong>，指每个碱基被测序的平均次数，是用来衡量测序量的首要参数。研究表明，增加测序深度，测序量从1.6M条reads增加到20M条reads,（75bp）但到10M条reads时就已经达到平衡了，80%的基因转录本被检测到。在此基础上增加测序量，它们会比对到已经存在的转录本上。因此即使提高测序深度，低表达水平的基因的检测是比较困难的。并且提高测序深度确实能够增加基因差异表达的敏感度，但是并不能保证检测到的差异具有生物学意义。</p>
<p>直观一些说，如果某个基因在RNA-seq结果显示差异表达，但QPCR结果表明这个基因表达差异不显著，可以认为这个基因RNA-seq结果为假阳性；反之，这个结果就是真阳性。</p>
<p><strong>生物学重复对差异表达分析的影响</strong></p>
<p>在单样本测序量保持不变的情况下，随着生物学重复(n)的提高，差异分析的假阳性率（FP R）基本稳定，但真阳性率（TPR）在不断提高。也就是说提高生物学重复数，实验对差异基因的检测更加敏感，那些差异倍数较小或差异量较低的差异表达基因（此类基因的差异检测难度较大）能够更加容易被检测到。</p>
<p><strong>判定差异分析结果可靠性的指标</strong></p>
<p>假阳性与真阳性 假阳性率（FPR）：真实非差异表达的基因中，被错误判定为差异表达的比例，FPR越低越好。 真阳性率（TRP）：真实差异表达的基因中，能够正确判定为差异表达的比例，TRP越高越好。</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/rnaseq1.png">

</div>
<p>提高生物学重复数，实验对差异基因的检验更加敏感。那些差异倍数较小或差异量较低的差异表达基因（此类基因的差异检测难度较大）能够更加容易被检测到。</p>
<p>在一定的生物学重复数（n）的情况下，随着单样本测序量（Depth）的提高（25% → 100%），真阳性率（TPR）都只有有限的提高（图1）。例如在n=3的情况下，单个样本的测序量从25%提高到100%，TPR仅仅从6.24%提高到8.95%。在表3中，如果Depth等于25%不变，当n从2提高到12，TPR的提高则是非常明显的。因此测序深度对结果改善效果不如增加生物学重复。 <img src="http://ortxpw68f.bkt.clouddn.com/rnaseq8.png"></p>
<p>总数据量不变，生物学重复数与单样品测序量最佳组合 如果保持总测序量不变（即如果生物量重复数为n,则单个样品的测序量降低为1/n,总数据量为n*1/n=1,保持不变）。如图A,灰色实线代表不同的生物学重复数（n）和单样本数据量（1/n）组合的情况下，真阳性率（TPR）的变化。结果表明，随着n的提高，TPR率不断提高。例如n=2,TPR约为3%，如果n=6,TPR则提高到24.3%。 <img src="http://ortxpw68f.bkt.clouddn.com/rnaseq9.png"></p>
<p>同时我们也可以对“单样本测序量对差异表达分析的影响”再进行深入观察。如果n保持不变，但单个样本的数据量不断降低，TPR的降低十分缓慢。例如，n=3,单个样本的数据量从100%降低到15%，TPR的值一直处于平台期，仅仅从9%降低到5%。 但是不同的生物学重复数和单样本测序量的组合，对假阳性率（ FPR）的影响却较小。如图B，灰色实线代表不同生物学重复数（n）和单样本数据量（1/n）组合的情况下，真阳性率（FPR）的变化。虽然 n 从2 变化到 96，FPR 基本没有太大变化。</p>
<p>从图中我们很容易发现，基于负二项分布的差异分析检验（P value），FPR 对生物学重复数和单个样本数据量均不敏感，始终保持低于 0.1%水平。或者说，这个算法对 FPR 的控制还是非常理想的。</p>
<h3 id="讨论">讨论</h3>
<p>随着测序单价的下降，目前市场上 RNA-seq 类项目的单样本测序量正在不断提高。以 2G，PE100 测序的表达谱项目为例，其对应的测序量为 20M 条 reads。如果一条长度为 1kbp 的低表达基因的表达量为 RPKM=0.5，其理论上可以检测到的 reads 数为 20×0.5=10。所以低丰度基因的检测，对 RNA-seq 这个技术来说并非最大问题。</p>
<p>第二个问题“转录本表达量的高低变化”比“转录本的有无”更具有普遍的生物学意义。虽然个别基因的表达量变化程度，可以使用 Qpcr 来验证。但我们往往也使用所有差异基因来统计某些规律。例如使用差异基因的 pathway 富集分析来寻找与性状相关的 pathway。如果在全局水平的差异基因集并不可靠，那么 pathway富集分析得出的结论的可靠性自然也受到影响。而全局水平的差异基因数量巨大，是难以使用 Qpcr 验证的。因此，定量以及差异分析的准确性是在 RNA-seq 中更值得关心的问题。</p>
<h4 id="测序设计">测序设计</h4>
<p>RNA-seq文库的制备和测序过程：RNA碎裂，cDNA合成，接头连接，PCR扩增，加标签（多样品混合测序），上泳池测序; <img src="http://ortxpw68f.bkt.clouddn.com/rnaseq10.png"></p>
<h5 id="如何减少误差">如何减少误差：</h5>
<ol style="list-style-type: decimal">
<li>使用末端带随机核酸的接头或者使用化学碎裂法代替Rnase III碎裂法；</li>
<li>不同批次实验或者不同runs。</li>
</ol>
<ol style="list-style-type: lower-alpha">
<li>如果样品太多在一个批次或者一个run跑不完，为了避免技术误差造成太大的实验误差，要把样品随机分配到每个批次或runs中;(到底怎么设计，我们要讨论一下！！)</li>
<li>如果你的样品是多样品混合测序，每个样品要单独加上标签，每个lanes要保证足够的测序深度，为了保证所有的样品在每个lane中都有。如果送给公司去做的话，我们要选择建库水平好些的，并且要求他们这么去做，应该会更好。</li>
</ol>
<h4 id="质量控制">质量控制</h4>
<h5 id="重复数">重复数：</h5>
<ol style="list-style-type: decimal">
<li>技术重复（spearman秩相关系数R²&gt;0.9）;</li>
<li>生物重复（主成分分析PCA）</li>
</ol>
<h5 id="原始数据的质量控制">原始数据的质量控制：</h5>
<p>原始数据回来后，你做完备份以后，做的第一件事情就是看看数据质量如何，一般来自llumina测序平台用软件FastQC看；其他平台的数据用软件NGSQC。一般会有原始数据的序列质量，GC含量，存在的接头以及K-mers子串图并且重复序列太多的reads。并且reads 3‘末端的质量低于前段，原因是随着测序读长的增加，酶活性下降，荧光强度也在下降，因此测序数据质量逐渐降低乃是自然趋势。常用的数据过滤的软件有FASTX-Toolkit and Trimmomatic，其他还有许多，你也可以自己写代码处理数据。 <img src="http://ortxpw68f.bkt.clouddn.com/rnaseq11.png"></p>
<h5 id="reads比对后的质量控制评估比对质量的指标">Reads比对后的质量控制(评估比对质量的指标)：</h5>
<p>比对上的reads占总reads的百分比； Reads比对到外显子和参考链上的覆盖度是否一致；比对到基因组序列：多重比对reads？比对到转录组序列：来自未被注释的转录本的reads会丢失； 产生更多的多重比对reads; 转录本被定量以后，应该看一下GC含量和基因长度偏差，确定定量的方法是否适用。 <img src="http://ortxpw68f.bkt.clouddn.com/rnaseq12.png"></p>
<h5 id="数据分析">数据分析</h5>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/rnaseq13.png">

</div>
<h5 id="转录本分析">转录本分析</h5>
<p>需要注意的问题： 1. 比对到基因组序列、比对到转录组序列？ 2. 一条reads比对到多个地方？ 3. 用什么来表示表达量的高低？</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/rnaseq14.png">

</div>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/rnaseq15.png">

</div>
<p>把所有样本的reads混合用于转录本的拼接。二代测序的转录组reads用于拼接还是存在一些问题的，最终拼接结果不太理想。一个转录本的拼接结果会是10~100contigs。三代测序的读长直接可以把一个转录本读完了，完全不需要拼接。 <img src="http://ortxpw68f.bkt.clouddn.com/rnaseq16.png"></p>
<h5 id="表达定量">表达定量</h5>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/rnaseq17.png">

</div>
<p>RPKM/FPKM/TPM用来表示RNA-seq基因表达水平的值；对于单端测序RPKM和FPKM值是一样的，FPKM可以转换成TPM。Cufflinks(支持双端测序数据，并且需要GTF格式的注释文件)。</p>
<h5 id="表达差异分析">表达差异分析</h5>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/rnaseq18.png">

</div>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/rnaseq19.png">

</div>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/rnaseq20.png">

</div>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/rnaseq21.png">

</div>
<h4 id="功能分析">功能分析</h4>
<p>功能分析是标准转录组分析流程的最后一步，分析差异表达基因的分子功能和代谢通路。 <img src="http://ortxpw68f.bkt.clouddn.com/rnaseq22.png"></p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/rnaseq23.png">

</div>
<p>参考资料： 1. http://www.biotrainee.com/thread-166-1-1.html</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2017/08/10/Experiment/实验笔记-cas9/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/08/10/Experiment/实验笔记-cas9/" itemprop="url">Crispr/Cas9原理实及实验流程笔记</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-08-10T12:01:00+08:00">
                2017-08-10
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/生物实验笔记/" itemprop="url" rel="index">
                    <span itemprop="name">生物实验笔记</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  3,838
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  14
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="来源">来源</h2>
<p>Crispr/Cas9在微生物中起到的作用就是识别入侵、将病毒的DNA录入自己的基因组，当病毒再次入侵时候，切割病毒DNA、RNA进而消除病毒的感染。CRISPR（Clustered regularly interspaced short palindromic repeats）是生命进化历史上，细菌和病毒进行斗争产生的免疫武器，简单说就是病毒能把自己的基因整合到细菌，利用细菌的细胞工具为自己的基因复制服务，细菌为了将病毒的外来入侵基因清除，进化出CRISPR系统，利用这个细菌免疫系统，细菌地把病毒基因从自己的染色体上切除，这是细菌特有的免疫系统。</p>
<h2 id="原理">原理</h2>
<h3 id="结构">结构</h3>
<p>Crispr技术有两个分子在参与：Cas9核酸酶+sgRNA（自行设计）。其中Cas9核酸酶的基因已经被整合到商业化载体中，只要自行设计sgRNA，然后构建Cas9/sgRNA表达载体，转染细胞，就可以行使基因组的定点基因编辑任务。sgRNA（small-guided RNA）是CRISPR基因敲除敲入系统中重要的组成部分，由两部分组成—tracRNA和crRNA，两部分融合表达后，即sgRNA，与cas9蛋白结合，引导cas9酶靶向基因组DNA进行剪切。示意图如下所示： <img src="http://ortxpw68f.bkt.clouddn.com/cas9%20%281%29.jpg"></p>
<h3 id="各原件作用">各原件作用</h3>
<p>Crispr各原件的组成如下所示： <img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/微信截图_20190129195459.png"> CRISPR簇是一个广泛存在于细菌和古生菌基因组中的特殊DNA重复序列家族，其序列由一个<strong>前导区(Leader)</strong>、多个短而高度保守的<strong>重复序列区(Repeat)</strong>和<strong>多个间隔区(Spacer)</strong>组成。</p>
<p>前导区一般位于CRISPR簇上游，是富含AT长度为300～500bp的区域，被认为可能是CRISPR簇的<strong>启动子序列</strong>。</p>
<p>重复序列区长度为21～48bp，含有回文序列，可形成发卡结构。重复序列之间被长度为26～72bp的<strong>间隔区</strong>隔开。</p>
<p>间隔区域由俘获的外源DNA组成，类似免疫记忆，当含有同样序列的外源DNA入侵时，可被细菌机体识别，并进行剪切使之表达沉默，达到保护自身安全的目的。</p>
<h3 id="如何发挥作用">如何发挥作用</h3>
<p>作用示意图如下所示： <img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/2.png"></p>
<h4 id="阶段-1外源-dna-采集">阶段 1：外源 DNA 采集</h4>
<p>外源核苷酸是通过Cas 蛋白识别，入侵的短片段DNA（30-50个碱基对）被称为protospacers，作为间隔序列插入宿 主CRISPR 位点中，由重复序列隔开。对于I型和II型系统来说，protospacers来自入侵 DNA 中两侧出现2-5 个核酸结构（PAM，protospacer adjacent motif）的区域。一般 protospacers 连接在CRISPR 位点的一端，并且后者通过涉及 Cas1、Cas2 和 游离3’-hydroxyls 等元件的机制，牵引序列。Protospacer 的整合过程中也出现了牵引末端重新序列复制，这可能涉及宿主聚合酶和DNA修复机制。如下所示： <img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/3.png"></p>
<h4 id="阶段-2crrna-合成">阶段 2：crRNA 合成</h4>
<p>CRISPR RNA 在转录之后，生成初级转录产物：pre-crRNA，之后经过加工，又成为一组短小的 CRISPR衍生RNAs（crRNAs），这些crRNAs 每一个都包含有对应于之前遇到的外源DNA的对应序列。 <img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/4.png"></p>
<h4 id="阶段-3靶向干扰">阶段 3：靶向干扰</h4>
<p>在pre-crRNA转录的同时，与其重复序列互补的反式激活tracrRNA(Trans-activating crRNA，tracrRNA)也转录出来，并且激发Cas9和双链RNA特异性RNase III核酸酶对pre-crRNA进行加工。加工成熟后，crRNA、tracrRNA和Cas9组成复合体，识别并结合于crRNA互补的序列，然后解开DNA双链，形成R-loop，使crRNA与互补链杂交，另一条链保持游离的单链状态，然后由Cas9中的HNH活性位点剪切crRNA的互补DNA链，RuvC活性位点剪切非互补链，最终引入DNA双链断裂(DSB)。CRISPR／Cas9的剪切位点位于crRNA互补序列下游邻近的PAM区(Protospacer Adjacent Motif)的5’-GG-N18-NGG-3’特征区域中的NGG位点，而这种特征的序列在每128bp的随机DNA序列中就重复出现一次。 <img src="http://ortxpw68f.bkt.clouddn.com/cas9_3.png"></p>
<h4 id="补充cas9解螺旋的过程">补充：cas9解螺旋的过程</h4>
<p>Cas9可以解开DNA，gRNA和target dsDNA配对是在解旋之后所进行（文献为：Sternberg, S. H., et al. (2014). “DNA interrogation by the CRISPR RNA-guided endonuclease Cas9.” Nature 507(7490): 62-67.）。步骤如下：</p>
<ol style="list-style-type: decimal">
<li>gRNA和Cas9形成Cas9:gRNA complex.</li>
<li>这个complex来寻找双链DNA上的PAM位点。因为crisper/cas9源于细菌的防御机制，为了定点清除进入细胞内的“异己DNA而设计”，PAM就是evolutionary conserved关于“异己DNA”的特异标志，所以Cas9需要识别PAM也就不难解释了。现在分子生物学常用的Cas9源自S. Pyogenes这个细菌种属，这种Cas9的特异PAM是5’ NGG(N可以是任何nucleotide)。在人类基因组上GG占5%（每42bp就有一个），因此人的绝大多数基因都在PAM附近，也就意味着几乎所有人的基因都可以被Cas9识别。</li>
<li>当Cas9:gRNA complex识别到PAM的时候，Cas9就会把下游的双链DNA解旋，然后这个complex来根据gRNA的序列“扫描”解旋的DNA，一旦发现和gRNA序列互补的DNA，Cas9就会把DNA切开，完成操作。</li>
</ol>
<p>下图是Doudna那篇paper的原理解释的figure</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/5.png">

</div>
<h2 id="sgrna的序列特征和设计">SgRNA的序列特征和设计</h2>
<h3 id="sgrna的序列设计原理">SgRNA的序列设计原理</h3>
<p>SgRNA 设计靶序列选择：在NCBI找到该基因CDS区，分析相应的基因组结构，明确CDS的外显子部分。按照基因本身的性质，选择候选的待敲除位点，确定待敲除位点。对于蛋白编码基因，如果该蛋白具重要结构功能域，可考虑将基因敲除位点设计在编码该结构域的外显子。可选择将待敲除位点放在起始密码子ATG后的外显子上。如果被敲除的靶标基因是microRNA或者lncRNA，可以将待敲除位点设计在编码成熟microRNA的外显子或在编码成熟microRNA的外显子的5’和3’侧翼序列。</p>
<p>gRNA设计：通常情况下我们仅需要在你的目的位置附近找到PAM序列：NGG（N代表任意核苷酸），然后找到其紧邻的上游20 nt即可 （如下图所示）。 <img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/6.png"></p>
<p>目的位置的选择：我们绝大部分时候的目的是完全敲除一个基因，其原理是利用移码突变（CRISPR/Cas系统诱导产生indel）。</p>
<blockquote>
<p>注：indel全称为insertion，deletion，即插入，缺失，缩写为indel， 插入如下： 生物原始基因序列：ATCGTCGAATCCGGTTG 发生突变基因序列：ATCGTCGAAatcgTCCGGTTG，其中的小写字母atcg为插入的序列，为插入突变；</p>
<p>缺失： 生物原始基因序列：ATCGTCGAAtccgGTTG 发生突变基因序列：ATCGTCGAAGTTG，其中，原始序列里的小写字母tccg为缺失的序列，为缺失突变； 插入和缺失都相对于原始序列来说：缺失指，在原始序列中的某一段丢失；插入指，相对于原始序列在某个位置多了一段序列，即在这个位置插入了一段序列</p>
</blockquote>
<p>因此我们一般选择距离起始密码子ATG下游200bp范围内的exon区域。另外，通常一个基因往往会转录成2个以上的转录本，所以请选择尽量靠近5’端的公共部分，保证每个转录本都会成功移码突变。</p>
<p>通常情况下，为了便于下游KO mutants的鉴定，我们往往可以作如下设计：即Cas9的切割位点刚好被一个酶切位点跨过，且附近至少100 bp内酶切位点唯一（下游的敲除突变也能通过测序的手段来鉴定）。 <img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/7.png"></p>
<p>上图的酶切示意图就显示了，敲除突变无法被酶切，而野生型的则能够进行酶切。</p>
<h3 id="sgrna的设计流程">sgRNA的设计流程</h3>
<p>在数据中找到自己的目的序列，通过<a href="http://crispr.mit.edu" target="_blank" rel="external">MIT的在线网站设计</a>来设计要敲除的靶序列，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/cas9.1.5.jpg">

</div>
<p>分析中，显示你所键入的基因序列里有22对可选的guide序列，如下所示。 <img src="http://ortxpw68f.bkt.clouddn.com/cas9.1.6.png"></p>
<p>分析结束，点击Download as genbank查看结果，此时也会收到邮件，如下所示。 <img src="http://ortxpw68f.bkt.clouddn.com/cas9.1.7.png"></p>
<p>单击<code>Download as genbank1</code>，能够查看所有guide序列的评分，如下所示： <img src="http://ortxpw68f.bkt.clouddn.com/cas9.1.9.png"></p>
<blockquote>
<h3 id="降低脱靶概率原则如下">降低脱靶概率原则如下：</h3>
<ol style="list-style-type: decimal">
<li>sgRNA的长度一般应为20 nt左右；</li>
<li>对于sgRNA序列的碱基组成，可选3’末端含GG的sgRNA，同时sgRNA种子序列尽量避免以4个以上的T结尾，GC%含量最佳为40%~60%；</li>
<li>sgRNA在设计网站上的评分越高，越容易脱靶；</li>
<li>如需造成基因knockout，需尽量选择包含有ATG的外显子或靠近ATG的外显子；</li>
<li>检查sgRNA靶向结合位点基因组序列是否存在SNPs；</li>
<li>如采用Cas9单切口，设计paired-gRNA需考虑sgRNA之间的间距；</li>
<li>全基因脱靶效应分析，需考虑脱靶位点最大允许几个错配碱基数，建议最少5个碱基。重点考察种子序列和非种子序列碱基错配数。</li>
</ol>
</blockquote>
<p>通常选择分数较高的Guide序列，以Guide#1序列为例，2条单链oligo的序列如下：oligo1：5’-<strong>caccG</strong>CTGTTTGTGCAGGGCTCCGA -3’； oligo2：5’- <strong>aaac</strong>TCGGAGCCCTGCACAAACAG<strong>c</strong>-3’。加粗部分与经BsmBI酶切后的载体互补配对。BsmBI又名BbsI，它的酶切位点如下所示：<img src="https://www.neb.com/~/media/Catalog/All-Products/8FD67221124342CCB2F58C64960B66EC/Cut%20Site%20Image/BsmB-I-cutsite_1.gif"></p>
<p><strong>注：有关与BsmBI酶切的一些信息</strong> 现在使用Cas9技术时，通常使用的是<a href="https://www.addgene.org/52961/" target="_blank" rel="external">lentiCRISPR v2载体</a>，这个载体中插入外源基因的序列如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/cas9.1.10.png">

</div>
<p>当质粒经过BsmBI酶切后，产生的缺口如下所示： <img src="http://ortxpw68f.bkt.clouddn.com/cas9.1.11.png"></p>
<p>因此，在上述的靶序列中，有一条是5’-CTGTTTGTGCAGGGCTCCGA-3’，它要在两边加上caccG，这个cacc与BsmBI酶切后的gtgg配对，加G是因为这个转录起始位点，必须要加上，如果本身第一个是G，则不需要添加，另一条是5’-TCGGAGCCCTGCACAAACAG-3’，它的两端要加上aaac与gttt配对，其模式如下所示：<img src="http://ortxpw68f.bkt.clouddn.com/cas9.1.12.png"></p>
<h2 id="实验流程">实验流程</h2>
<h3 id="载体构建流程">载体构建流程</h3>
<p><strong>1. Oligo退火形成duplex</strong></p>
<table>
<thead>
<tr class="header">
<th>Component</th>
<th align="center">Volume</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>oligo1</td>
<td align="center">1ul(100uM)</td>
</tr>
<tr class="even">
<td>oligo2</td>
<td align="center">1uL(100uM)</td>
</tr>
<tr class="odd">
<td>H2O</td>
<td align="center">8uL</td>
</tr>
<tr class="even">
<td>total</td>
<td align="center">10uL</td>
</tr>
</tbody>
</table>
<p>PCR仪 95℃ 5 min，缓慢降温至室温1h，1：200稀释duplex。</p>
<p><strong>2. 质粒酶切</strong></p>
<table>
<thead>
<tr class="header">
<th>Component</th>
<th align="center">Volume</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>lentiCRISPR plasmid</td>
<td align="center">2ug</td>
</tr>
<tr class="even">
<td>BbsI-HF（不同的质粒有不同的酶切位点）</td>
<td align="center">1uL</td>
</tr>
<tr class="odd">
<td>10X buffer</td>
<td align="center">2uL</td>
</tr>
<tr class="even">
<td>H2O</td>
<td align="center">X uL</td>
</tr>
<tr class="odd">
<td>total</td>
<td align="center">10 uL</td>
</tr>
</tbody>
</table>
<p>加入以上成分，于37摄氏度酶切15分钟（不同的酶有不同的酶切时间，这个要看说明书）。此处使用的Cas9载体的gRNA插入位点如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180627/4b7Fdh4bk3.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p><strong>3. 胶回收</strong> 大片段约11kb 回收，回收后的线性片段要放到负80度冰箱，因为<code>BbsI</code>这个酶消化后的质粒（我自己用的质粒）有一端是<code>AAA</code>，容易降解（如果没有，则放负20度即可）。</p>
<p><strong>4. 连接</strong></p>
<table>
<thead>
<tr class="header">
<th>Component</th>
<th align="center">Volume</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>T4 DNA ligase(TaKaRa,2011A)</td>
<td align="center">1uL</td>
</tr>
<tr class="even">
<td>10 X DNA ligase buffer</td>
<td align="center">1uL</td>
</tr>
<tr class="odd">
<td>digested lentiCRISPR plasmid</td>
<td align="center">2uL</td>
</tr>
<tr class="even">
<td>duplex</td>
<td align="center">6 uL</td>
</tr>
<tr class="odd">
<td>total</td>
<td align="center">10 uL</td>
</tr>
</tbody>
</table>
<p>室温连接4-6h，随后转化，转化时要把所有的连接体系加入到感受态中，因为载体的连接效率不高。</p>
<h3 id="病毒包装体系">病毒包装体系</h3>
<table>
<thead>
<tr class="header">
<th>Component</th>
<th align="center">Volume</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>lentiCRISPR v2-gDNA plasmid</td>
<td align="center">4ug</td>
</tr>
<tr class="even">
<td>psPAX2 packaging plasmid</td>
<td align="center">3ug</td>
</tr>
<tr class="odd">
<td>pMD2.G envelope plasmid</td>
<td align="center">1ug</td>
</tr>
</tbody>
</table>
<p>如果是使用Lipo3000进行病毒包括，则整个包括体系如下所示：</p>
<table>
<thead>
<tr class="header">
<th>溶液1</th>
<th>溶液2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>① OPTI-MEM 121.25μL</td>
<td>① psPAX2(1.5μg= X μL)(X)</td>
</tr>
<tr class="even">
<td>② lipo3000 3.75μL(或7.5，第一次需要摸索条件)</td>
<td>② pMD2G(1μg= YμL)(Y)</td>
</tr>
<tr class="odd">
<td></td>
<td>③ 目的质粒(2.5μg= Z μL)(Z)</td>
</tr>
<tr class="even">
<td></td>
<td>④ OPTI-MEM (125μL-X-Y-Z-10= μL)</td>
</tr>
<tr class="odd">
<td></td>
<td>⑤ P3000TM试剂 10μL(最后加)</td>
</tr>
</tbody>
</table>
<p>注：注：（1）包装质粒PAX2 ：pMDG2：和目的基因质粒=3:2:5，因此前期工作，每种质粒的浓度最好为：[1]psPAX2（500ng/μL）[2]pMD2G（500ng/μL）[3]目的质粒（500ng/μL）<br>
（2）Lip3000（μL）∶DNA（μg）的推荐比例为2.5∶1</p>
<h3 id="转染">转染</h3>
<p>转染条件与常规的病毒转染相同。</p>
<p>转染48h后，加入puromycin来筛选细胞，1mL的培养基，加5μL的嘌呤酶素（1mg/mL），也就是说嘌呤霉素的终浓度是5μg/mL。</p>
<h3 id="测序">测序</h3>
<p>加了嘌呤霉素的培养基要每天更换，每次里面都要含有5μg/mL的嘌呤霉素，这个时间要持续7天。在第7天的时候，取一定数量的细胞，提取DNA，测序，这一步的目的主要在于，确定是否存在有基因敲除的细胞，如果没有，就要重新包病毒进行敲除。</p>
<p>如果存在基因敲除的细胞，那么gRNA切割位点处就会产生套峰，表示有效编辑的效应为50%，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/cas9.1.13.png">

</div>
<h3 id="单克隆的获取">单克隆的获取</h3>
<p>当测序结果出现套峰时，表明这批细胞中存在被敲除的细胞，此时就可以分离单克隆了，分离单克隆主要有下面的几种方法。</p>
<h4 id="有限稀释法">有限稀释法</h4>
<p>有有限稀释法的过程为：收集细胞，计数，将细胞的密度稀释为500个/mL，此时，用20μL移液枪吸取细胞悬液先点几个孔 ,每孔约2μL，然后放在倒置显微镜下观察 ,如每孔 1～2 个细胞，说明细胞浓度合适 ，则可一次点完 96 孔板，每个孔100uL。</p>
<p>这个过程也可以使用流式细胞仪分选，直接分到96孔板中，每孔种1个细胞。</p>
<h4 id="直接挑单克隆">直接挑单克隆</h4>
<ol style="list-style-type: decimal">
<li>将细胞稀释到一定浓度（具体浓度自己摸索），直接种到10cm的培养皿中，这样的目的在于，每个细胞就会均值地铺到培养皿中，最终一个细胞就会长成一团细胞，这一团细胞就是单克隆；</li>
<li>生长一定时间后（例如7天），放到显微镜下观察，细胞数目足够了，用记号笔在培养皿下标记上；</li>
<li>吸掉培养基，用PBS清洗3次，吸取2uL的胰酶，滴到标记处，消化1分钟，然后再加10uL的培养基，此时用枪头把培养基吸走，细胞就进入了枪头，再把培养基打到24孔板中，让其生长。</li>
</ol>
<p><strong>单克隆的鉴定</strong></p>
<p>第一种方法，根据设计，推荐使用酶切鉴定的方法（见设计部分），通量高；</p>
<p>第二种方法，就是提取细胞DNA，跑胶，在gRNA序列的上下游设计一对引物，产物长度约500bp，敲除的细胞的条带会缩减，由于gRNA只有20几个bp，因此普通的琼脂糖凝胶不容易看出差异，此时可以采用SDS凝胶，如果敲除的基因是非编码的序列，那么就采用测序法；</p>
<p>第三种方法，测序，如果不熟悉SDS凝胶，可以采用普通的琼脂糖凝胶，直接切胶，送测序；</p>
<p>第四种方法，如果有抗体，可以使用WB的方法。</p>
<h2 id="其他的cas9网站收集">其他的cas9网站收集</h2>
<p><a href="https://www.atum.bio/products/crispr" target="_blank" rel="external">ATUM公司(https://www.atum.bio/products/crispr)</a></p>
<p><a href="http://tools.flycrispr.molbio.wisc.edu/targetFinder/" target="_blank" rel="external">flyCRISPR</a></p>
<h2 id="参考资料">参考资料</h2>
<ol style="list-style-type: decimal">
<li><a href="https://mp.weixin.qq.com/s?__biz=MzIwMzA1MzU5Mg==&amp;mid=2652130380&amp;idx=1&amp;sn=bef6d7313ccb3f12be7016ff9a9904b2&amp;chksm=8d35a33bba422a2d5b1b8c584c867f6bc6d58171abcc0ebd9396425548de7fafba56dd4525a6&amp;mpshare=1&amp;scene=1&amp;srcid=0601Rzuo25J14J1qV3dGnt2X#rd" target="_blank" rel="external">CRISPR-Cas9全程实操教程：从gRNA设计到挑单克隆全程指导</a></li>
<li><a href="https://mp.weixin.qq.com/s?__biz=MzI1NjM1MTI5Ng==&amp;mid=2247483920&amp;idx=1&amp;sn=e5ca3f72224f6969a47d045dac524a3d&amp;chksm=ea294f3fdd5ec629922c95bccb834a5de614dea239b2ecb8068f481e025ae713e26bd817bde0&amp;mpshare=1&amp;scene=1&amp;srcid=0601BWh4Ddc7rKy2EQdgQ673#rd" target="_blank" rel="external">CRISPR是啥？有啥用呢？</a></li>
<li><a href="https://mp.weixin.qq.com/s?__biz=MzIwMzA1MzU5Mg==&amp;mid=2652129836&amp;idx=1&amp;sn=6de31effa8067e9ad0aa37cb853730bd&amp;chksm=8d35a55bba422c4db5895861874342c941f0d5328a752d403367f1bc25dcc101157ce0f82a8b&amp;mpshare=1&amp;scene=1&amp;srcid=0601o4qI8nI9LrvSy8MQJuI4#rd" target="_blank" rel="external">一文掌握CRISPR/Cas9系统操作方法，超详细protocol来袭！</a></li>
<li><a href="https://mp.weixin.qq.com/s?__biz=MzA3ODU1NjUyNw==&amp;mid=2652327260&amp;idx=1&amp;sn=7911a3fe8b1bb21585dfd7814487fe07&amp;chksm=84a3115cb3d4984a676eef8095378cdef62129e302a7117df0671cedf5b6fb809a7c26469cbb&amp;mpshare=1&amp;scene=1&amp;srcid=0402E74Gygnekd7PjPsxnYTt#rd" target="_blank" rel="external">CRISPR是什么鬼？</a></li>
<li><a href="http://mp.weixin.qq.com/s?__biz=MzA4OTQ1MTQxNg==&amp;mid=2652035754&amp;idx=3&amp;sn=5199f544cb35d48feceb5afe9756a016&amp;chksm=8bfcc45dbc8b4d4bef6b38762c7ef396e5bece9c3bce93c698ef136430c2b924eb9cbba7b1d7&amp;mpshare=1&amp;scene=1&amp;srcid=1118LOtqMnGmnCvH8AyAqX0F#rd" target="_blank" rel="external">手把手教你搞定 CRISPR/Cas9 系统操作</a></li>
<li><a href="http://mp.weixin.qq.com/s?__biz=MzIwMzA1MzU5Mg==&amp;mid=2652130074&amp;idx=1&amp;sn=f968e2adc98c46d1ed8635137080bccd&amp;chksm=8d35a46dba422d7bc7780de61641534d80ad8339341ef2f5f48ae640a811c0e156c054c087ed&amp;mpshare=1&amp;scene=1&amp;srcid=0308HdSWMpPPvWyUxeKS5NgY#rd" target="_blank" rel="external">一文掌握gRNA的设计，常用方法汇总解析</a></li>
<li><a href="http://mp.weixin.qq.com/s?__biz=MzIwMzA1MzU5Mg==&amp;mid=2652130160&amp;idx=1&amp;sn=75d4973ba598a18ec83a7ac16a40aeea&amp;chksm=8d35a407ba422d119dd11efe3e1d8b920a9952953b8d9ec7a3b4bbe4dc4cc714c50247fd2e18&amp;mpshare=1&amp;scene=1&amp;srcid=1215mEkQv3xNCdRr7Nr4btVZ#rd" target="_blank" rel="external">手把手教你利用CRISPR-Cas9系统精准敲除靶标基因</a></li>
<li><a href="https://mp.weixin.qq.com/s?__biz=MzI0NzExMTg0NQ==&amp;mid=2649394829&amp;idx=1&amp;sn=2455a14b541c3c1ee193e933b5a63d36&amp;mpshare=1&amp;scene=1&amp;srcid=0308tQUjqA03Kq46VpXqJuEv#rd" target="_blank" rel="external">白友“冰糖”分享：CRISPR/Cas9系统操作实例</a></li>
<li><a href="https://mp.weixin.qq.com/s?__biz=MzI0NzExMTg0NQ==&amp;mid=2649394843&amp;idx=1&amp;sn=1199decf9215e2e93e471fcf7baec00f&amp;mpshare=1&amp;scene=1&amp;srcid=1012EzBZX1Z6UqfvCCQxH827#rd" target="_blank" rel="external">CRISPR/Cas9系统操作实例分享之二：LentiCRISPR v2</a></li>
<li><a href="https://mp.weixin.qq.com/s?__biz=MzA4OTQ1MTQxNg==&amp;mid=2652034666&amp;idx=1&amp;sn=4915148f19dc76e2f7c9e8aa29a58228&amp;scene=1&amp;srcid=06256AxjFUm6DsklabrlylIN#rd" target="_blank" rel="external">手把手教你搞定 CRISPR/Cas9 系统操作</a></li>
<li><a href="https://international.neb.com/products/r3539-bbsi-hf#Product%20Information" target="_blank" rel="external">NEB BbsI酶</a></li>
<li></li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2017/07/06/Experiment/病毒包装笔记(6)-病毒包装问题收集/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/07/06/Experiment/病毒包装笔记(6)-病毒包装问题收集/" itemprop="url">病毒包装笔记(6)-病毒包装问题收集</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-07-06T12:02:00+08:00">
                2017-07-06
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/生物实验笔记/" itemprop="url" rel="index">
                    <span itemprop="name">生物实验笔记</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  352
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  1
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <ol style="list-style-type: decimal">
<li><p>慢病毒如何保存？ 答 ：慢病毒可在-80°C条件下保存6个月，滴度不会出现明显下降，但如果保存时间超过6<sub>12月，滴度可能降至原来十分一，使用前请重新测病毒滴度。慢病毒应避免反复冻融，冻融一次病毒滴度会下降20</sub>50%以上，甚至更多。建议不要在-20°C下长期保存慢病毒；如果冻融后需于短期内（一周以内）使用，建议置于4°C保存；若在4°C保存超过一周，病毒滴度会下降5倍以上。</p></li>
<li><p>从负80度中取出的病毒如何解冻？ 答 ：冰上溶解-80 °C取出的慢病毒。如需稀释病毒，可加入适当比例的PBS（PH7.4）或培养基（ph7.2），混匀分装后 4 °C保存，并最好当天用完。操作时用枪头吸取慢病毒时，应尽量避免慢病毒暴露于空气中，避免起泡。</p></li>
<li><p>病毒的单位是什么？ 答：病毒的单位是TU/ml，即每毫升中含有具有生物活性的病毒颗粒数。如： 病毒滴度为&gt;1×10e8 TU/ml，即每毫升病毒液中至少含有1×10e8个具有生物活性的慢病毒颗粒。</p></li>
<li><p>慢病毒感染时培养基体积与正常培养体积是多少？ 答：如下所示： <img src="http://ortxpw68f.bkt.clouddn.com/virus%20volume.png"></p></li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2017/07/05/Experiment/病毒包装笔记(5)-293FT的病毒包装/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/07/05/Experiment/病毒包装笔记(5)-293FT的病毒包装/" itemprop="url">病毒包装笔记(5)-293FT的病毒包装</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-07-05T11:00:00+08:00">
                2017-07-05
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/生物实验笔记/" itemprop="url" rel="index">
                    <span itemprop="name">生物实验笔记</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  622
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  2
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="实验原理">实验原理</h2>
<h3 id="细胞简介">293细胞简介</h3>
<p>293FT细胞系非常适应用于慢病毒的生产。该细胞系是由293F细胞系培育而来的，293FT能稳定地表达SV40大T抗原（来源于 pCMVSPORT6TAg.neo plasmid）。此细胞表达SV40大T抗原是由CMV启动子控制。</p>
<h3 id="ft细胞的培养基">293FT细胞的培养基：</h3>
<ol style="list-style-type: decimal">
<li>DMEM（高糖）；</li>
<li>10%FBS（不能热灭活）；</li>
<li>0.1 mM MEM Non-Essential Amino Acids (NEAA)；</li>
<li>6 mM L-glutamine；</li>
<li>1 mM MEM Sodium Pyruvate；</li>
<li>1% Pen-Strep (optional)</li>
</ol>
<h3 id="ft细胞的冻存">293FT细胞的冻存</h3>
<p>90% 完全培养基+10% DMSO（实验室通常是用90%FBS+10% DMSO）</p>
<h2 id="实验材料">实验材料</h2>
<p>293FT细胞，PSPAx2；PMD2G；目的质粒</p>
<h2 id="实验流程">实验流程</h2>
<ol style="list-style-type: decimal">
<li>第1天：用无抗生素DMEM+10% FBS血清铺板293FT细胞（6孔板），细胞接种数量约为5X10e5，确保第2天细胞密度达到80-90%的融合。</li>
<li>第2天：溶液【1】240ul OPTI-MEM+10ul lipofectamine 2000 per well （总体积 250ul）（室温下静置5min）；溶液【2】OPTI-MEM+4ug质粒per well（总体积250ul）；</li>
<li>将溶液【1】加入到溶液【2】（顺序不能加错），轻轻吹吸 3 - 5 次混匀，室温下静置 20 min；</li>
<li>与此同时，将6孔板中的培养基更换为<strong>无抗生素无血清</strong>的培养基，约1mL；</li>
<li>将溶液【1】和溶液【2】的混合液逐滴加入到孔中，轻轻援培养板，混匀，后将细胞放入 37℃，5%的CO2中保温5-6 小时；</li>
<li>6小时后，更换含有血清的全培养基，继续放在 37℃，5％的CO2中培养48~72h；</li>
<li>转染24h后，荧光显微镜下观察，转染效率应达到70%以上；</li>
<li>经过48小时后，收集含病毒的培养液（每个孔里包一种病毒）至1.5mL EP管中，8000rpm室温离心3分钟，然后取上清(1mL)（离心是为了清除293FT细胞，如果不离心，容易在宿主细胞中混入293FT）。</li>
<li>将6孔板中的宿主细胞的培养基吸掉1mL（原来是2mL，除去一半），将含有病毒颗粒的1mL上清加入到宿主细胞中（6孔板，宿主细胞放到6孔板中，每孔5E5细胞，细胞密度不能太高，一般20-30%）中进行感染，并同时加入10uL的polybrene（终浓度为2-5µg/ml polybrene）， 充分摇匀后置于37℃温箱孵育;</li>
<li>如果目的质粒带有抗性如Ppuro，则用含嘌呤霉素抗性的培养基进行筛选，如果目的质粒带有荧光，则用FACS筛选。</li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2017/07/04/Experiment/病毒包装笔记(4)-质粒的提取与测序/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/07/04/Experiment/病毒包装笔记(4)-质粒的提取与测序/" itemprop="url">病毒包装笔记(4)-质粒的提取与测序</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-07-04T12:00:00+08:00">
                2017-07-04
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/生物实验笔记/" itemprop="url" rel="index">
                    <span itemprop="name">生物实验笔记</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  1,724
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  6
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="实验原理">实验原理</h2>
<p>细菌质粒是一类双链、闭环的DNA，大小范围从1kb至200kb以上不等。各种质粒都是存在于细胞质中、独立于细胞染色体之外的自主复制的遗传成份，通常情况下可持续稳定地处于染色体外的游离状态，但在一定条件下也会可逆地整合到寄主染色体上，随着染色体的复制而复制， 并通过细胞分裂传递到后代。质粒已成为目前最常用的基因克隆的载体分子，重要的条件是可获得大量纯化的质粒DNA分子。目前已有许多方法可用于质粒DNA的提取，下面主要介绍碱裂解法提取质粒DNA的方法。</p>
<p>在 pH 12.0～12.6 碱性环境中，细菌的线性大分子量染色体 DNA 变性分开，而共价闭环的质粒 DNA 虽然变性但仍处于拓扑缠绕状态。将 pH 调至中性并有高盐存在及低温的条件下，大部分染色体 DNA 、大分子量的 RNA 和蛋白质在去污剂 SDS 的作用下形成沉淀，而质粒 DNA 仍然为可溶状态。通过离心，可除去大部分细胞碎片、染色体 DNA 、 RNA 及蛋白质，质粒 DNA 尚在上清中，然后用硅酸纤维膜吸附或者酚、氯仿抽提进一步纯化质粒 DNA 。</p>
<h2 id="实验材料">实验材料：</h2>
<p>试剂盒E.Z.N.A.® Plasmid DNA Mini Kit I（OMEGA　Bio-tek） Epoch微孔板分光光度计（BioTek） 1.5mL管 5mL 离心管</p>
<h2 id="实验流程">实验流程：</h2>
<ol style="list-style-type: decimal">
<li>自新鲜划痕选择培养板中分离单菌落，接种含适当选择性抗生素的5ml的LB培养基进行培养。37℃强力摇动（~300rpm）孵育16h。括DH5α。</li>
<li>将5.0ml细菌室温10,000 g离心1min，放到5 mL的EP管中，如果菌液多，则分两次加入。</li>
<li>轻轻倒出或吸走培养基并丢弃。</li>
<li>加入250μL 的溶液I/Rnase A重悬沉淀，涡旋或用移液器反复吹打。充分重悬沉淀对于获得高质量的DNA非常重要。（<strong>注：溶液Ⅰ的成分及作用为：①50mM 葡萄糖—增稠，使悬浮后的大肠杆菌不会快速沉积到管子的底部；②10mM EDTA—抑制DNase的活性。这一步溶液中还可以加入RNase，③25mM Tris-HCl，pH=8.0—提取适当的缓冲液体系和PH；④RNase—除去RNA，此成分不受EDTA影响，并且可以在后续步骤中被除去</strong>）</li>
<li>加入250μL溶液II（在孵箱中预热），倒置、转动试管数次使之轻轻混匀，得到透明的裂解产物。可能需要孵育2min。不要用力混合，以免使染色体DNA断裂，减低质粒的纯度。该步反应不要超过5min。溶液II不用时要拧紧瓶盖，以免试剂被空气中的CO2酸化。（<strong>溶液II的成分及作用为为①0.2M NaOH—裂解细菌，使双层膜变化为micelle微囊；②1%SDS—-结合蛋白质（平均2个氨基酸结合上一个SDS），和钾离子形成十二烷基硫酸钾PDS,进而形成大量的沉淀。</strong>）</li>
<li>加入350μL溶液III，立即倒置试管数次混匀，直至白色絮状沉淀物形成。为避免形成局部沉淀，加入溶液III后应立即、充分混匀溶液。（<strong>溶液III的成分及作用为：①3M醋酸钾—钾离子和SDS形成PDS，大量的沉淀；②2M醋酸—中和NaOH，防止基因组DNA断裂。</strong>）</li>
<li>室温≥13,000g离心10分钟。白色沉淀物形成，立即进行下一步操作。</li>
<li>将HiBindDNAMini Column 加入到2mL的收集管上。</li>
<li>小心翼翼的吸取上清液（注意不要吸到沉淀，如果不放心，可以将上清吸到另一新的EP管，然后再离心一次，吸取上清），加入装配在2ml收集管中的小量纯化柱I中。确保离心沉淀未受扰动，确保没有细胞碎片加入到柱子中。</li>
<li>室温下10,000g离心1分钟，使裂解液完全通过柱子。再将裂解液加回柱子，再离心一次。</li>
<li>丢弃滤过液，重新使用2ml收集管。</li>
<li>加入500μL HBC缓冲液清洗柱子。(** HBC的成分没有查到，但根据相关的信息，HBC的成分应该是酚，氯仿，异戊醇的混合用；它们的作用分为：①酚—使残余的蛋白质变性（远强于氯仿）；②氯仿—和酚混合使用，增加比重。酞与氯仿是非极性分子，水是极性分子，当蛋白水溶液与酚或氯仿混合时，蛋白质分子之间的水分子就被酚或氯仿挤去，使蛋白失去水合状态而变性过离心，变性蛋白质的密度比水的密度为大，因而与水分离，沉淀在水相下面，从而与溶解在水相中的DNA分开；③异戊醇—可以使用酚：氯仿：异戊醇=25:24:1的比例抽提质粒DNA，在抽提DNA时，为了混合均匀，必须剧烈振荡容器数次，这时在混合液内易产生气泡，气泡会阻止相互间的充分作用。加入异戊醇能降低分子表面张力，所以能减少抽提过程中的泡沫产生。**)</li>
<li>室温13,000 g离心1分钟，使溶液完成通过柱子。该步操作需确保残余的蛋白质污染被去除，以保证获得高品质的DNA以适合于下游的应用。</li>
<li>丢弃滤过液，重新使用2ml收集管。</li>
<li>加入700μL DNA Wash Buffer。DNA清洗液的浓缩液使用前必须用无水乙醇稀释（5倍稀释），如果DNA清洗液稀释液经过冷藏，则使用之前必须置于室温。(<strong>wash buffer的作用：加入无水乙醇后,终浓度差不多就是70%的乙醇溶液了,在沉淀的DNA中,由于过多的盐杂质存在,影响DNA的酶切等反应,wash buffer就是洗去这些盐杂质的。</strong>)</li>
<li>室温10,000g离心1分钟。</li>
<li>丢弃滤过液。</li>
<li>将空柱子≥13,000 x g离心2min，使柱子的基质干燥。此步骤为关键操作，不可遗漏。</li>
<li>将柱子放入干净的1.5ml微量离心管中，60℃孵育5min。</li>
<li>将80μL无菌去离子水直接加入柱子基质上。</li>
<li>60℃孵育5min。</li>
<li>≥13,000 x g离心1min洗脱DNA。可以进行二次洗脱，以收集残存的DNA。</li>
<li>检测质粒浓度，A260/A280的比率可以反映核酸的纯度。比值大于1.8表明核算的纯度在90%以上。将质粒稀释到400ng/uL。</li>
</ol>
<h2 id="测序">测序</h2>
<p>取10uL的质粒样品，送到测序公司即可。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2017/07/03/Experiment/病毒包装笔记(3)-转化/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/07/03/Experiment/病毒包装笔记(3)-转化/" itemprop="url">病毒包装笔记(3)-转化</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-07-03T12:00:00+08:00">
                2017-07-03
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/生物实验笔记/" itemprop="url" rel="index">
                    <span itemprop="name">生物实验笔记</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  675
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  3
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="原理">原理</h2>
<p>转化（ transformation ）是指一段同源或异源的 DNA 转入受体细胞并得到表达的水平基因的转移过程，是现代分子生物学研究和基因工程不可缺少的重要技术。</p>
<p>转化过程所用的受体细胞（通常是大肠杆菌），一般是限制修饰系统缺陷的变异株，即不含限制性内切酶和甲基化酶的突变体，它可以容忍外源DNA分子进入体内并稳定地遗传给后代，受体细胞经过一些特殊方法的处理后，细胞膜的通透性发生了暂时性的改变，成为能允许外源DNA分子进入的感受态细胞。进入受体细胞的DNA分子通过复制，表达实现遗传信息的转移，使受体细胞出现新的遗传性状。将经过转化后的细胞在筛选培养基中培养，即可筛选出转化子（即带有异源DNA分子的受体细胞）。</p>
<h2 id="菌株">菌株</h2>
<p>E.coli DH5a 菌株（感受态）</p>
<h2 id="转化">转化</h2>
<ol style="list-style-type: decimal">
<li>质粒1uL加入10ul的感受态细胞中，冰上放置40min。</li>
<li>42℃水浴锅内热激90s（让质粒进入感受态细胞）。</li>
<li>取出，冰上放置5min（让感受态细胞关闭）。</li>
<li>加入200ul LB液体培养基（无抗性AMP），37℃摇床培养1h。</li>
</ol>
<h2 id="涂板">涂板</h2>
<p>将上述培养液20uL涂布在含AMP的LB固体培养基上，过液培养。</p>
<h2 id="挑菌">挑菌</h2>
<p>次日如果发现板子已经长有菌落，则用5uL的枪头挑一个单菌落，打入5mL的LB液体培养基中（ 实验室的氨苄为1000X的，即100mg/mL，因此5mL的液态培养基里加入5uL，即100ug/mL )，放于摇床培养，37℃过夜。（5mL LB培养基+5uL AMP + 用枪头挑菌，枪头可加入培养瓶中）</p>
<p>第二天提取质粒或保藏（保藏菌株放于负80冰箱）。</p>
<h2 id="lb培养基的配制">LB培养基的配制</h2>
<p>下面以100mL（250mL）的LB培养基为例说明 1. 胰蛋白胨(Tryptone)-1g（250mL–2.5g) 2. 酵母提取物（Yeast Extract) 0.5g(250mL–1.25g) 3. NaCl-1g)(250mL–2.5g) 4. 琼脂(Agar) 1.5g(250mL–3.75g) 5. 单蒸水：100mL(250mL–250mL)</p>
<h2 id="抗性lb培养基">抗性LB培养基</h2>
<ol style="list-style-type: decimal">
<li>高压灭菌后，将融化的LB固体培养基置与55℃的水浴中；</li>
<li>待培养基温度降到55℃时(手可触摸)加入抗生素（实验室的氨苄为1000X的，即100mg/mL，因此5mL的液态培养基里加入5uL，即100ug/mL ），以免温度过高导致抗生素失效；</li>
<li>充分摇匀。</li>
<li>如果是固体培养基，则用封口胶封边，并倒置放于4℃保存，一个月内使用。</li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/8/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/8/">8</a><span class="page-number current">9</span><a class="page-number" href="/page/10/">10</a><span class="space">&hellip;</span><a class="page-number" href="/page/13/">13</a><a class="extend next" rel="next" href="/page/10/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">RVDSD</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">126</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">13</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">38</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          <div class="links-of-author motion-element">
            
          </div>

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

<div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">RVDSD</span>

  
</div>



<div class="powered-by">
<i class="fa fa-user-md"></i><span id="busuanzi_container_site_uv">
  本站访客数:<span id="busuanzi_value_site_uv"></span>
</span>
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.3</div>




<div class="theme-info">
  <div class="powered-by"></div>
  <span class="post-count">博客全站共467.1k字</span>
</div>

        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.3"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.3"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.3"></script>



  


  




	





  





  












  





  

  

  
  

  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config("");
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="custom_mathjax_source">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->
  


  

  

</body>
</html>
