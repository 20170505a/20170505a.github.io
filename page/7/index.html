<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.3" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.3">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.3" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta property="og:type" content="website">
<meta property="og:title" content="RVDSD的个人笔记本">
<meta property="og:url" content="http://rvdsd.top/page/7/index.html">
<meta property="og:site_name" content="RVDSD的个人笔记本">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="RVDSD的个人笔记本">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.3',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://rvdsd.top/page/7/"/>





  <title>RVDSD的个人笔记本</title><!-- hexo-inject:begin --><!-- hexo-inject:end -->
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">RVDSD的个人笔记本</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">学习过程中的输出</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2018/03/20/BioInformation/生信-实战-生信技能树转录组数据分析入门实战/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/03/20/BioInformation/生信-实战-生信技能树转录组数据分析入门实战/" itemprop="url">转录组数据分析入门实战</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-03-20T12:00:00+08:00">
                2018-03-20
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/生信实战项目/" itemprop="url" rel="index">
                    <span itemprop="name">生信实战项目</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  5,466
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  21
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>这是根据“思考问题的熊“的课程《生信技能树转录组数据分析入门实战》进行整理的，这是一个标准的转录组分析流程，所用模式生物是拟南芥，整个课程信息如下所示：</p>
<h3 id="课程题目："><a href="#课程题目：" class="headerlink" title="课程题目："></a>课程题目：</h3><p>生信技能树转录组数据分析入门实战</p>
<h3 id="课程内容："><a href="#课程内容：" class="headerlink" title="课程内容："></a>课程内容：</h3><ol>
<li>课程介绍</li>
<li>Linux操作技巧</li>
<li>生物信息软件安装</li>
<li>转录组分析整体思路</li>
<li>转录组数据预处理</li>
<li>转录组数据序列比对</li>
<li>转录组数据表达定量</li>
<li>转录组数据差异分析</li>
</ol>
<h3 id="所用数据，如下所示："><a href="#所用数据，如下所示：" class="headerlink" title="所用数据，如下所示："></a>所用数据，如下所示：</h3><p><img src="http://ortxpw68f.bkt.clouddn.com/professional/180323/aJC86iIddm.png?imageslim" alt="mark"></p>
<h3 id="（二）inux操作技巧"><a href="#（二）inux操作技巧" class="headerlink" title="（二）inux操作技巧"></a>（二）inux操作技巧</h3><h4 id="Linux常用客户端"><a href="#Linux常用客户端" class="headerlink" title="Linux常用客户端"></a>Linux常用客户端</h4><p>Xshell：用于登录远程服务器。<br>Putty：用于登录远程服务器。<br>WInSCP：用于下载服务器文件。</p>
<h4 id="Linux命名"><a href="#Linux命名" class="headerlink" title="Linux命名"></a>Linux命名</h4><p>这个比较基础，略过，只讲一个alias<br>alias用于缩简一些命令，例如这次的练习数据我放在了<code>/mnt/hgfs/biotest/rnaseq/</code>这个目录下，每次都输入都太麻烦了，因此可以使用alias命名进行添加，如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">cd #进行主目录</div><div class="line">vim .bashrc # 进入bashrc文件</div></pre></td></tr></table></figure>
<p>在.bashrc文件中添加如下字段：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">alias wp=&apos;cd /mnt/hgfs/biotest/rnaseq/&apos;</div></pre></td></tr></table></figure>
<p>保存并退出，其中需要注意的是等号两边不要有空格，否则会出错。<br>此时直接输入wp就可以直接进行目录。</p>
<h3 id="（三）生物信息软件安装"><a href="#（三）生物信息软件安装" class="headerlink" title="（三）生物信息软件安装"></a>（三）生物信息软件安装</h3><p>主要是利用conda进行安装，比较简单，详细的教程可以参照<a href="https://zhuanlan.zhihu.com/p/25085567" target="_blank" rel="external">青山屋主的教程</a>，这个是我看到的比较好的教程。</p>
<h3 id="（四）转录组分析整体思路"><a href="#（四）转录组分析整体思路" class="headerlink" title="（四）转录组分析整体思路"></a>（四）转录组分析整体思路</h3><p>作者回顾了一下以前的思路，如下所示：<br><img src="http://ortxpw68f.bkt.clouddn.com/professional/180323/21cLF9i3Jl.png?imageslim" alt="mark"></p>
<p>大图如下所示：<br><img src="http://ortxpw68f.bkt.clouddn.com/professional/180323/hkA5ea79cL.png?imageslim" alt="mark"></p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/professional/180323/01gdAhELCi.png?imageslim" alt="mark"></p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/professional/180323/j2mj3L2d84.png?imageslim" alt="mark"></p>
<h3 id="（五）转录组数据预处理"><a href="#（五）转录组数据预处理" class="headerlink" title="（五）转录组数据预处理"></a>（五）转录组数据预处理</h3><h4 id="数据介绍"><a href="#数据介绍" class="headerlink" title="数据介绍"></a>数据介绍</h4><p>按照作者教程中的文件夹整理了所要分析的数据，如下所示：<br><img src="http://ortxpw68f.bkt.clouddn.com/professional/180323/0jIb80EBL8.png?imageslim" alt="mark"></p>
<p>现在解释一下这几个文件夹，其中：</p>
<ol>
<li><p><code>00ref</code>存放的是参考基因组文件（fasta格式）和注释信息（gtf/gff格式）文件；参考序列以及注释信息的下载地方通有<a href="www.ensembl.org">Ensembl</a>，<a href="https://genome.jgi.doe.gov/portal/" target="_blank" rel="external">JGI</a>，此外，还有一些针对某些模式生物的专门数据库，例如araport是拟南芥的数据库，本文所用的数据就是拟南芥的测序数据（已经下载好，过程略）。</p>
</li>
<li><p><code>01_raw_data</code>中的是原始数据（测序公司给你的数据），其中，sample1_R1.fastq.gz和sample1_R2.fastq.gz表示的是双端测序（PE），一个是左边的数据，一个是右边的数据。</p>
</li>
<li><p><code>02clean_data</code>用于存放清洗了原始数据后的数据；</p>
</li>
<li><p><code>03align_data</code>用于存放比对后的数据（例如BAM或SAM），以及分析的数据；</p>
</li>
<li><p><code>others</code>文件夹中的数据不清楚，这一部分的数据是从教程的主页上下载下来的，估计是分析后的数据，先不管。</p>
</li>
</ol>
<h4 id="解压缩参考序列文件"><a href="#解压缩参考序列文件" class="headerlink" title="解压缩参考序列文件"></a>解压缩参考序列文件</h4><p>刚下载的参考序列文件与注释文件是以gz结尾的压缩文件，因此先进行解压，<code>gunzip *gz</code>的作用就是将压缩文件解压到当前文件夹，如下所示：<br><img src="http://ortxpw68f.bkt.clouddn.com/professional/180323/ILg2fcd82I.png?imageslim" alt="mark"><br>两个文件已经解压好了，一个是gtf文件，一个是fasta文件，可以用<code>head</code>命令查看一下序列：<br><img src="http://ortxpw68f.bkt.clouddn.com/professional/180323/LkJfeJ6C7e.png?imageslim" alt="mark"></p>
<p>此外，还能通过<code>cat，less，more，head，tail</code>这几个命令来查看序列，现在查看一下注释文件：<br><img src="http://ortxpw68f.bkt.clouddn.com/professional/180323/Ke5K118mlE.png?imageslim" alt="mark"></p>
<h5 id="MD5值的计算"><a href="#MD5值的计算" class="headerlink" title="MD5值的计算"></a>MD5值的计算</h5><p>MD5主要用于检验数据传输后，前后两个数据是否完整，简单来说就是，测序文件很大，通过MD5我就能知道上传或下载后的数据跟我原来的数据是不是一样。检测过程如下所示：<br>生成4个原始数据的MD5值：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">cd ../01raw_data </div><div class="line">md5sum *gz &gt; md5.txt</div></pre></td></tr></table></figure></p>
<p>上述两个命令是切换到原始数据的文件夹，通过<code>md5sum</code>命令是生成该文件夹下的所有gz格式文件的MD5值，并将这些MD5值给md5.txt文件，现在查看一下md5.txt文件<code>less md5.txt</code>：<br><img src="http://ortxpw68f.bkt.clouddn.com/professional/180323/1g1mJja9be.png?imageslim" alt="mark"></p>
<h5 id="检验MD5值"><a href="#检验MD5值" class="headerlink" title="检验MD5值"></a>检验MD5值</h5><p>用md5sum命令来检验一下MD5的值：<br><img src="http://ortxpw68f.bkt.clouddn.com/professional/180323/k61halaEID.png?imageslim" alt="mark"><br>如果文件完整，后面会显示OK。</p>
<h4 id="测序文件的质控"><a href="#测序文件的质控" class="headerlink" title="测序文件的质控"></a>测序文件的质控</h4><p>质控软件是<code>fastqc</code>，如果没有安装可以利用ocnda进行安装，<code>conda install fastqc</code>，安装后，查看一下版本<code>fastqc -v</code>，如下所示：<br><img src="http://ortxpw68f.bkt.clouddn.com/professional/180323/K9A04G9a84.png?imageslim" alt="mark"></p>
<h5 id="第一种方法质控：常规方法"><a href="#第一种方法质控：常规方法" class="headerlink" title="第一种方法质控：常规方法"></a>第一种方法质控：常规方法</h5><p>现在用fastqc进行质控，如下所示：<br><code>fastqc sample*gz</code>，<br><img src="http://ortxpw68f.bkt.clouddn.com/professional/180323/be16cK2fHI.png?imageslim" alt="mark"><br>运行过程与测序文件的大小以及计算机的性能有关，我们这个数据量不大，比较快，结束后，用<code>tree</code>来查看一下结果：<br><img src="http://ortxpw68f.bkt.clouddn.com/professional/180323/Ba6aFcGKg4.png?imageslim" alt="mark"><br>其中以html结尾的数据就是测序的结果，关于测序结果的解读，以前参考过<a href="https://zhuanlan.zhihu.com/p/20731723" target="_blank" rel="external">青山屋主的《使用 FastQC 做质控》</a>，可以看一下。</p>
<h5 id="第二种方法质控：用for循环"><a href="#第二种方法质控：用for循环" class="headerlink" title="第二种方法质控：用for循环"></a>第二种方法质控：用for循环</h5><p>此外，还可以用<code>for</code>循环来做，先把原来的zip和html文件删除掉<code>rm -f *zip</code>和<code>rm -f *html</code>，用于<code>for i in</code>ls *gz<code>;do fastqc $i;done</code>来进行循环，同样能达到相同的目的。</p>
<h5 id="第三种方法质控：利用管道命令"><a href="#第三种方法质控：利用管道命令" class="headerlink" title="第三种方法质控：利用管道命令"></a>第三种方法质控：利用管道命令</h5><p> 先把原来的zip和html文件删除掉<code>rm -f *zip</code>和<code>rm -f *html</code>，然后输入命名<code>ls *gz |xargs -I [] echo &#39;nohup fastqc [] &amp;&#39;</code>，这个命名是的运行过程就是列出raw_data文件夹下的所有测序文件（就是4个原始数据文件），然后导入到xargs命名中，利用xargs命令调用nohup命名。关于这个命名的解释：</p>
<ol>
<li><code>ls *gz</code>是列出当前目录下的所有gz文件。</li>
<li><code>|</code>表示将上面列出的文件导入到下一步（xargs命名），这叫管道命令，很形象，就是将上面的结果像管道一下，输入到下一步。</li>
<li>xargs命令是给其他命令传递参数的一个过滤器，也是组合多个命令的一个工具，使用-I指定一个替换字符串[]，这个字符串在xargs扩展时会被替换掉，当-I与xargs结合使用，每一个参数命令都会被执行一次，我们使用上述的这段命名时，它表示，用<code>ls *gz</code>列出的几个文件名字替换掉<code>nuhup fastqc []</code>的中括号。</li>
<li><code>echo</code>用于输出字符串；</li>
<li>nohup是将操作置于后台，它要与<code>&amp;</code>配合使用。</li>
<li>有关管道与<code>xargs</code>的用法，这个<a href="https://www.cnblogs.com/wangqiguo/p/6464234.html" target="_blank" rel="external">文章介绍得不错《xargs命令详解，xargs与管道的区别》</a>。</li>
</ol>
<p>再看一下流程：<br>ls *gz |xargs -I [] echo ‘fastqc []’ 就是将第一个[]里的内容替换掉第二个[]，如下所示：<br><img src="http://ortxpw68f.bkt.clouddn.com/professional/180323/5E68hCkHfl.png?imageslim" alt="mark"></p>
<p>将上述命令保存到<code>fastqc.sh</code>文件中，并运行fastqc.sh文件，如下所示：<br><img src="http://ortxpw68f.bkt.clouddn.com/professional/180323/ijb79De8FI.png?imageslim" alt="mark"></p>
<p>结果如下：<br><img src="http://ortxpw68f.bkt.clouddn.com/professional/180323/JIlKCL0KG7.png?imageslim" alt="mark"></p>
<h5 id="第四种方法质控：multiqc"><a href="#第四种方法质控：multiqc" class="headerlink" title="第四种方法质控：multiqc"></a>第四种方法质控：multiqc</h5><p>这种方法严格来说并不是做质控，而是把fastqc的质控结果给合并起来，直接在fastqc分析后的结果的目录中输入<code>multiqc .</code>就可以，如下所示：<br><img src="http://ortxpw68f.bkt.clouddn.com/professional/180323/D3H3dHGl0j.png?imageslim" alt="mark"><br>打开multiqc_report文件，如下所示：<br><img src="http://ortxpw68f.bkt.clouddn.com/professional/180323/LdFfCdAECc.png?imageslim" alt="mark"></p>
<h4 id="数据的过滤（去接头）"><a href="#数据的过滤（去接头）" class="headerlink" title="数据的过滤（去接头）"></a>数据的过滤（去接头）</h4><p>数据过程主要使用的是Trimmomatic软件，此软件的功能是用于去掉原始数据的接头序列，先看一下测序的质量文件中的Adaptor Concent，如下所示：<br><img src="http://ortxpw68f.bkt.clouddn.com/professional/180323/5jDEd42Kl8.png?imageslim" alt="mark"><br>这张图衡量的是序列中两端adapter的情况，从图中我们可以看出这些测序文件的接头序列并没有去掉，因此我们要去掉这些软件，Trimmomatic就是实现这个功能的，它的一些介绍如下所示：</p>
<p><strong>软件特点：</strong></p>
<ol>
<li>支持多线程，处理数据速度快；</li>
<li>主要用于去除Illumina平台接头；</li>
<li>根据碱基质量对fastq进行筛选；</li>
<li>支持SE和PE测序数据，支持gzip和bzip2压缩文件。</li>
</ol>
<p><strong>质量过滤的依据：</strong></p>
<ol>
<li>ILLUMINACLIP：过滤reads中的Illumina接头；</li>
<li>LEADING：从reads开头切除质量值低于阈值的碱基；</li>
<li>TRAILING：从reads末尾切除质量值低于阈值的碱基；</li>
<li>SLIDINGWINDOW：从reads的5’端开始，进行滑窗过滤，切掉碱基质量平均值低于阈值的滑窗；</li>
<li>MINLEN：丢弃经过剪切后长度低于阈值的这条reads；</li>
<li>TOPHRED33：将reads的碱基质量值体系转换为phred-33（一般都选择phred-33）；</li>
<li>TOPHRED66:将reads的碱基质量值体系转换为phred-64。</li>
</ol>
<p><strong>软件使用</strong><br><strong>1. 接头序列的选择：</strong></p>
<ul>
<li><p>软件默认提供了几个接头文件，在FastQC的结果中会提示是哪种接头，如下所示：<br><img src="http://ortxpw68f.bkt.clouddn.com/professional/180323/5b3K76jg9L.png?imageslim" alt="mark"><br>文件显示的是TruSeq Adapter，因此要选择“TrueSeq3-SE.fa” and “TruSeq3-PE.fa”进行过滤（我们前面知道，本次案例中的是双端测序，因此用到的是TruSeq3-PE.fa）。</p>
<ul>
<li>但是如果显示的是Illumina Single End”/“Illumina Paired End”就要选择“TruSeq2-SE.fa”和“TruSeq2-PE.fa”，</li>
</ul>
</li>
</ul>
<p><strong>2. 去接头参数的选择</strong><br>选择true或false，随后会介绍。</p>
<h5 id="trimmomatic使用案例"><a href="#trimmomatic使用案例" class="headerlink" title="trimmomatic使用案例"></a>trimmomatic使用案例</h5><p>双端测序会输入2个文件，分别是正向测序序列和反向测序序列，过滤完数据后，会输出4个文件，双端测序都保留的是paired，如果其中一端序列过滤后被丢弃了，另一端序列被保留了，则为unpaired。</p>
<p>现在使用trimmomatic去掉adapter，如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">trimmomatic PE -threads 4 \</div><div class="line">sample1_R1.fastq.gz sample1_R2.fastq.gz \</div><div class="line">../02clean_data/sample1_paired_clean_R1.fastq.gz \</div><div class="line">../02clean_data/sample1_unpair_clean_R1.fastq.gz \</div><div class="line">../02clean_data/sample1_paired_clean_R2.fastq.gz \</div><div class="line">../02clean_data/sample1_unpair_clean_R2.fastq.gz \</div><div class="line">ILLUMINACLIP:/home/biotest/ENTER/share/trimmomatic-0.36-5/adapters/TruSeq3-PE-2.fa:2:30:10:1:true \</div><div class="line">LEADING:3 TRAILING:3 \</div><div class="line">SLIDINGWINDOW:4:20 MINLEN:50 TOPHRED33</div></pre></td></tr></table></figure>
<p>代码的解释：</p>
<ol>
<li>-threads:后面的数据表示是线程数，可不设置，程序会自行检测并选择核心数。</li>
<li>ILLUMINACLIP:过滤 reads 中的 Illumina 测序接头和引物序列，并决定是否去除反向互补的 R1/R2 中的 R2。在此命令中输入的是/home/biotest/ENTER/share/trimmomatic-0.36-5/adapters/TruSeq3-PE-2.fa，它是接头序列文件，可以在trimmomatic的安装目录中找到，这一步要使用绝对路径；</li>
<li>LEADING:3 TRAILING:3</li>
<li>SLIDINGWINDOW:从 reads 的 5’ 端开始，进行滑窗质量过滤，切掉碱基质量平均值低于阈值的滑窗。</li>
<li>LEADING: 从 reads 的开头切除质量值低于阈值的碱基。</li>
<li>TRAILING: 从 reads 的末尾开始切除质量值低于阈值的碱基。</li>
<li>MINLEN: 如果经过剪切后 reads 的长度低于阈值则丢弃这条 reads，被丢弃的 reads 数会被统计在 Trimmomatic 日志的 dropped reads 中。</li>
<li>AVGQUAL: 如果 reads 的平均碱基质量值低于阈值则丢弃这条 reads。</li>
<li>TOPHRED33: 将 reads 的碱基质量值体系转为 phred-33。</li>
<li>TOPHRED64: 将 reads 的碱基质量值体系转为 phred-64。<br>运行过程如下所示：<br><img src="http://ortxpw68f.bkt.clouddn.com/professional/180323/ga5L1ijFJh.png?imageslim" alt="mark"><br>这个过程根据序列的长度与计算机的性能有所不同，我在虚拟机中跑了大概5分钟，运行完后，如下所示：<br><img src="http://ortxpw68f.bkt.clouddn.com/professional/180323/bdi1eGGK59.png?imageslim" alt="mark"></li>
</ol>
<p>这个结果显示，输入了250000个序列，其中196007个序列（78.40%）的序列留下，14.26%留在了一端，2.39%留在了另一端，另外，扔掉了4.94%的序列。如果将ILLUMINACLIP:/home/biotest/ENTER/share/trimmomatic-0.36-5/adapters/TruSeq3-PE-2.fa:2:30:10:1:true 中的true改为false，则结果如下所示：<br><img src="http://ortxpw68f.bkt.clouddn.com/professional/180324/kFF2KIFa04.png?imageslim" alt="mark"></p>
<p>这个结果显示，输入了250000个序列，其中90442个序列（36.02%）的序列留下，56.64%留在了一端，1.23%留在了另一端，另外，扔掉了6.11%的序列。<br>另外一个sample2样本也按照同样的操作（选true），去掉接头的所有文件如下所示：<br><img src="http://ortxpw68f.bkt.clouddn.com/professional/180324/cJJl8k258g.png?imageslim" alt="mark"></p>
<h3 id="（六）转录组数据序列比对"><a href="#（六）转录组数据序列比对" class="headerlink" title="（六）转录组数据序列比对"></a>（六）转录组数据序列比对</h3><h4 id="软件介绍"><a href="#软件介绍" class="headerlink" title="软件介绍"></a>软件介绍</h4><p>序列比对分为两种，一种是有参比对，另一种是无参比对。这个过程就是将公司测序得到的reads比对到参考基因组上，如果我们所研究的物种有参考基因组的话，就是将reads直接比对到参考基因组上就行，如果没有参考基因组，则先需要拼接出一个基因组，然后再进行比对。这两种方式的差别如下所示：</p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/professional/180324/AfjfcHCA1J.jpg?imageslim" alt="mark"><br>这张图里面涉及三种比对，分别是基因组，有参转录组，无参转录组，可以参考一下（图片出处：Conesa A, Madrigal P, Tarazona S, et al. A survey of best practices for RNA-seq data analysis. Genome Biology. 2016;17:13. doi:10.1186/s13059-016-0881-8.）</p>
<p>转录组测序的比对通常分为基因组比对和转录组比对两种，顾名思义，基因组比对就是把reads比对到完整的基因组序列上，而转录组比对则是把reads比对到所有已知的转录本序列上。无参转录组所用到的工具是trinity，有参转录本所用到的工具是STAR。</p>
<p>如果是基于基因组比对，所用的工具是STAR和Hisat2。如果是基于转录组进行比对，则可以使用RSEM（可以结合bowtie2和STAR进行比对和定量分析）。关于转录组所使用的一些工具2017年，<a href="https://mp.weixin.qq.com/s?src=11&amp;timestamp=1521872470&amp;ver=773&amp;signature=QyvVfMDkq46O3CxqFprV5ni3hSooBgOg2PVu*rGT4sfNaLH4Z7fsj8DvJepECqczTPF71CfQfTbQXaW7c7rn*ZWcLJqyC4YZzuVKqTDIP1fC9-cs0NuRk94DGQED1HmN&amp;new=1" target="_blank" rel="external">Nature Com去年发一篇文章，讲的39个工具，可以看一下。</a></p>
<p>本案例所用工具是STAR。过程包括①建立索引；②进行比对（分为两种操作，分为简单版与复杂版）；③查看比对文件。 </p>
<h4 id="建立索引"><a href="#建立索引" class="headerlink" title="建立索引"></a>建立索引</h4><p>先建立一个目录，用于存放索引文物，即在<code>rnaseq</code>目录下，输入<code>mkdir arab_STAR_genome</code>，建立一个名叫arab_STAR_genome的目录。接着安装STAR软件，命令为<code>conda install star</code>，记得是小写。</p>
<p>现在切换到biotest/rnaseq目录下（这个目录就是00ref，arab_STAR_genome的上层目录，一定要在这个目录下，否则运行会出错），运行软件，代码如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">STAR --runThreadN 6 --runMode genomeGenerate \ </div><div class="line">--genomeDir arab_STAR_genome \ </div><div class="line">--genomeFastaFiles 00ref/TAIR10_Chr.all.fasta \ --sjdbGTFfile 00ref/Araport11_GFF3_genes_transposons.201606.gtf \ --sjdbOverhang 149</div></pre></td></tr></table></figure>
<p>运行过程中出现了错误，STAR的进程被杀死了，因为我用的是虚拟机，虚拟机的内存是1G，而STAR这个软件很耗内存，因此把虚拟机的内存上调到8G，再次运行，出现finished successfully即表示运行结束，如下所示：<br><img src="http://ortxpw68f.bkt.clouddn.com/professional/180330/ECdg9cIjfg.png?imageslim" alt="mark"></p>
<p>进程还是被杀死，因此最后切换到笔记本的Ubuntu中进去，STAR能顺利运行，运行结束后，如下所示：<br><img src="http://ortxpw68f.bkt.clouddn.com/professional/180330/l3cIFhf85K.png?imageslim" alt="mark"></p>
<p>可以查看一下arab_STAR_genome文件夹，下图就是运算的结果 ：<br><img src="http://ortxpw68f.bkt.clouddn.com/professional/180330/88gJg41d18.png?imageslim" alt="mark"></p>
<p>接着进行第二步，先进行简单版的比对，简单版的比对输入的参数比较少，以比对sample1为例 说明，如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">STAR  --runThreadN 5 --genomeDir arab_STAR_genome \</div><div class="line">--readFilesCommand zcat \</div><div class="line">--readFilesIn 02clean_data/sample1_paired_clean_R1.fastq.gz \</div><div class="line">02clean_data/sample1_paired_clean_R2.fastq.gz \</div><div class="line">--outFileNamePrefix 03align_out/sample1_</div></pre></td></tr></table></figure>
<p>在03align_out文件 中可以看到这些文件 ：</p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/professional/180330/fmaKecG1Fa.png?imageslim" alt="mark"></p>
<p>SJ文件包括了一些可变剪接的信息，还有3个Log文件，它们包括了一些处理过程的信，sample1_Log.final.out含有了一些统计信息，如下所示 ：<br><img src="http://ortxpw68f.bkt.clouddn.com/professional/180330/5m7eJ32f21.png?imageslim" alt="mark"></p>
<p>sample1_align.out.sam文件则是比对的结果，例如是否有错配，哪些reads比对上了。接着用复杂版进行比对 ，<br>这次用sample2进行复杂比对，如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">STAR  --runThreadN 5 --genomeDir arab_STAR_genome \</div><div class="line">--readFilesCommand zcat \</div><div class="line">--readFilesIn 02clean_data/sample2_paired_clean_R1.fastq.gz \</div><div class="line">02clean_data/sample2_paired_clean_R2.fastq.gz \</div><div class="line">--outFileNamePrefix 03align_out/sample2_ \</div><div class="line">--outSAMtype BAM SortedByCoordinate \</div><div class="line">--outBAMsortingThreadN 5 \</div><div class="line">--quantMode TranscriptomeSAM GeneCounts</div></pre></td></tr></table></figure>
<p>出现successfully表示比对结束，如下所示：<br><img src="http://ortxpw68f.bkt.clouddn.com/professional/180330/1dE3E67FGC.png?imageslim" alt="mark"></p>
<p>比对后的结果如下所示：</p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/professional/180330/E4LFmFGj3h.png?imageslim" alt="mark"></p>
<p>与sample1的简单比对相比，sample2的复杂比对结果中，少了一个sam文件，而多了2个bam文件，其中一个是经过坐标转换的，形成的转录本文件（sample2_Aligned.toTranscriptome.out.bam），另外一个是排过序的bam文件（sample2_Aligned.sortedByCoord.out.bam）。此外，还有一个文件，叫sample2_ReadsPerGene.out.tab，这个文件所含的信息是，一个基因上含有多少个reads。可以查看一下这个文件，如下所示：</p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/professional/180330/l4AA7k8k0g.png?imageslim" alt="mark"></p>
<p>第一列是基因名称，后面3列是基因的reads数。</p>
<p>现在查看一下sample2排序后的数据，所用命令为samtools view 文件名，如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">samtools view sample2_Aligned.sortedByCoord.out.bam | head</div></pre></td></tr></table></figure>
<p><img src="http://ortxpw68f.bkt.clouddn.com/professional/180330/j4fLffJ2f1.png?imageslim" alt="mark"></p>
<p>转录组数据表达定量：<br>处理原始比对文件<br>picard/samtools<br>将sam格式转换为bam格式<br>对bam文件进行排序<br>去除比对得分比较低的序列<br>如果需要（当质量不好时）可以去除重复reads</p>
<p>定量表达的流程：<br>STAR+RSEM：输出结果选择转录本定量或者基因定量；定量单位包括feature count,FPKM，TPM；操作相对复杂；先比对再定量</p>
<p>STAR+HTSeq：输出结果为原始read count；结果可用于差异表达分析;操作相对 简单；先比对再定量</p>
<p>Kallisto（free-alignment）：速度快省内存；基于转录本定量；不产生Bam文件，不方便基它后续分析（不进行比对，直接定量）。</p>
<p>新建一个文件夹，arab_RSEM</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">rsem-prepare-reference --gtf 00ref/Araport11_GFF3_genes_transposons.201606.gtf \ 00ref/TAIR10_Chr.all.fasta \ arab_RSEM/arab_rsem</div></pre></td></tr></table></figure>
<p>开始 运行，如下所示：<br><img src="http://ortxpw68f.bkt.clouddn.com/professional/180330/ACjEAGCmlF.png?imageslim" alt="mark"></p>
<p>生成了7个文件，如下所示：</p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/professional/180330/4jlbJjB9EF.png?imageslim" alt="mark"></p>
<p>其中比较重要的是<code>arab_rsem.transcripts.fa</code>，这个文件提供了转录本的信息;接着，再新建一个目录 ，命名为04rsem_out，然后输入以下命令：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">rsem-calculate-expression --paired-end --no-bam-output --alignments -p 5 -q 03align_out/sample2_Aligned.toTranscriptome.out.bam arab_RSEM/arab_rsem 04rsem_out/sample2_rsem</div></pre></td></tr></table></figure>
<p><img src="http://ortxpw68f.bkt.clouddn.com/professional/180330/e3fE7aebbI.png?imageslim" alt="mark"></p>
<p>运行结束，一共生成 了3个文件<br>，如下所示：<br><img src="http://ortxpw68f.bkt.clouddn.com/professional/180330/Aj3adElBd3.png?imageslim" alt="mark"></p>
<p>在这三个文件中，sample2_rsem.stat含有统计信息，这些信息可以用于进一步的分析，例如可视化。而sample2_rsem.genes.results则是基因的结果，可以查看一下，如下所示：</p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/professional/180330/GL2EkgLILb.png?imageslim" alt="mark"><br>其中，第1列是基因id，第2列是一个基因对应的转录本.</p>
<p>接着看一下基于转录本的信息，即文件sample2_rsem.isoforms.results的信息，如下所示：<br><img src="http://ortxpw68f.bkt.clouddn.com/professional/180330/kbGCEf9jk5.png?imageslim" alt="mark"></p>
<p>第1列就变成了转录本的id，第2列就成了基因的id。<br>以上是STAR+RSEM的定量流程。</p>
<p>接着用kallisto进行定量。<br>如果没有安装kallisto，则用conda进行安装，安装后，新建一个目录，arab_kallisto，进入该目录，随后建立 索引 ，如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">mkdir arab_kallisto</div><div class="line">cd arab_kallisto</div><div class="line">kallisto index -i arab_kallisto ../arab_RSEM/arab_rsem.transcripts.fa</div></pre></td></tr></table></figure>
<p>开始运行，运行过程如下所示：<br><img src="http://ortxpw68f.bkt.clouddn.com/professional/180330/896Eea4903.png?imageslim" alt="mark"></p>
<p>整个过程可能需要几分钟，最终会生成一个叫arab_kallisto的文件，这个文件就是后面进行定量的索引文件，如下所示：<br><img src="http://ortxpw68f.bkt.clouddn.com/professional/180330/JdeHk1K93d.png?imageslim" alt="mark"></p>
<p>现在再新建一个目录，用于存放定量的结果，如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">mkdir 05kallisto_out</div><div class="line">kallisto quant -i arab_kallisto/arab_kallisto -o 05kallisto_out/sample2 02clean_data/sample2_paired_clean_R1.fastq.gz 02clean_data/sample2_paired_clean_R2.fastq.gz</div></pre></td></tr></table></figure>
<p>这个过程很快，结果如下所示：<br><img src="http://ortxpw68f.bkt.clouddn.com/professional/180330/Gc0AdjBKhD.png?imageslim" alt="mark"></p>
<p>然后进入05kallisto_out目录，里面还有一个称为sample2的目录，进入，如下所示：<br><img src="http://ortxpw68f.bkt.clouddn.com/professional/180330/72kIIj67A7.png?imageslim" alt="mark"></p>
<p>sample2目录里有3个文件，其中tsv文件是可读的，可以查看一下，如下所示：<br><img src="http://ortxpw68f.bkt.clouddn.com/professional/180330/Hdm8C2lB86.png?imageslim" alt="mark"></p>
<p>数据差异分析：</p>
<p>STAR+featureCounts是STAR+HTSeq的升级版，在这一部分中，利用STAR的结果，通过featureCounts来计算。</p>
<p>表达宣结果转换为表达矩阵。</p>
<p>为了方便进行差异分析，我们需要根据前文提到的内容，用STAR的复杂分析，将所有的样本都转化为相应的BAM格式，原始数据有sample1和sample2，2个样本又有2个生物学重复，因此是4个数据，分别为sample1，sample1_2，sample2和sample2_2，转换后的数据如下所示：</p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/professional/180330/H35403DkI4.png?imageslim" alt="mark"></p>
<p>安装subread工具，<code>conda install subread</code><br>随后进行分析，计算结果非常快，如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">featureCounts -p -a ../00ref/Araport11_GFF3_genes_transposons.201606.gtf -o out_counts.txt -T 6 -t exon -g gene_id sample*Aligned.sortedByCoord.out.bam</div></pre></td></tr></table></figure>
<p><img src="http://ortxpw68f.bkt.clouddn.com/professional/180330/0Ce7ej5EEi.png?imageslim" alt="mark"></p>
<p>03align_out中会出现2个文件，分别为out_count.txt与out_counts.txt.summary。可以查看一下out_counts.txt文件，如下所示：</p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/professional/180330/IB9Fd53mj6.png?imageslim" alt="mark"></p>
<p>这个文件就是定量的结果。</p>
<p>将定量的结果转换为表达矩阵。<br>根据前文的案例，将所有的样本都转化为表达矩阵，如下所示：<br><img src="http://ortxpw68f.bkt.clouddn.com/professional/180330/CfbkHFK2C5.png?imageslim" alt="mark"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">rsem-generate-data-matrix *_rsem.genes.results &gt; output.matrix</div></pre></td></tr></table></figure>
<p>第1列是基因名称，第2到第5列是样本的整合，如下所示：</p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/professional/180330/gA34B244lE.png?imageslim" alt="mark"></p>
<p>有的基因表达量是0,随后可以将基因表达量为0的基因去掉，并且将表头进行更改，</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">awk &apos;BEGIN&#123;print &quot;geneid\ta1\ta2\tb2\tb2\n&quot;&#125;&#123;if($2+$3+$4+$5&gt;0)print $0&#125;&apos; output.matrix &gt; deseq2_input.txt</div></pre></td></tr></table></figure>
<p>运行后，查看一下原来的行数<br>wc -l output.matrix与wc -l deseq2_input.txt，如下所示：</p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/professional/180330/7aAEcgKDja.png?imageslim" alt="mark"></p>
<p>上图中，去掉基因表达量为0的基因前，矩阵是37337行，去掉后为17971行，后续用deseq2_input.txt进行分析 。现在 建立一个06deseq_out的文件夹，进行差异分析，并将deseq2_input.txt复制过去：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">mkdir 06deseq_out</div><div class="line">mv deseq2_input.txt ../06deseq_out/</div></pre></td></tr></table></figure>
<p>接着用R语言进行分析，代码如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div></pre></td><td class="code"><pre><div class="line">getwd()</div><div class="line"># 获取当前目录</div><div class="line"></div><div class="line">setwd(&quot;D:\\netdisk\\biotest\\rnaseq&quot;)</div><div class="line"># 将工作目录定位到测序结果的目录</div><div class="line"></div><div class="line">source(&quot;http://bioconductor.org/biocLite.R&quot;)</div><div class="line"># 调用biocLite</div><div class="line"></div><div class="line">biocLite(&quot;DESeq2&quot;)</div><div class="line">biocLite(&quot;edgeR&quot;)</div><div class="line"># 安装分析数据所用的包</div><div class="line">install.packages(&quot;ggrepel&quot;)</div><div class="line"></div><div class="line">library(DESeq2)</div><div class="line">library(edgeR)</div><div class="line">library(ggrepel)</div><div class="line">library(ggplot2)</div><div class="line"></div><div class="line">input_data &lt;- read.table(</div><div class="line">  &quot;D:\\netdisk\\biotest\\rnaseq\\06deseq_out\\deseq2_input.txt&quot;,</div><div class="line">  header = TRUE, </div><div class="line">  row.names=1)</div><div class="line"># 导入数据，其中添加row.names=1是将第1列设为矩阵的名称</div><div class="line">input_data &lt;- round(input_data,digits = 0)</div><div class="line"># reads数都是整数，因此要保留整数部分，否则后面会出错</div><div class="line"></div><div class="line"></div><div class="line">input_data &lt;- as.matrix(input_data)</div><div class="line">condition &lt;- factor(c(rep(&quot;ctl&quot;,2),rep(&quot;exp&quot;,2)))</div><div class="line">coldata &lt;- data.frame(row.names = colnames(input_data),condition)</div><div class="line">dds &lt;- DESeqDataSetFromMatrix(countData = input_data,            </div><div class="line">                              colData = coldata,</div><div class="line">                              design = ~condition)</div><div class="line"># dds是分析矩阵</div><div class="line"></div><div class="line"></div><div class="line">dds &lt;- DESeq(dds)</div><div class="line">res &lt;- results(dds,alpha = 0.05)</div><div class="line"># 提取分析结果</div><div class="line"></div><div class="line">summary(res)</div><div class="line"># 查看分析结果</div><div class="line"></div><div class="line">names(resdata)[1] &lt;- &quot;Gene&quot;</div><div class="line"></div><div class="line">res &lt;- res[order(res$padj),]</div><div class="line">resdata &lt;- merge(as.data.frame(res),</div><div class="line">                 as.data.frame(counts(dds,normalized = TRUE)),</div><div class="line">                 by = &quot;row.names&quot;,sort = FALSE)</div><div class="line"></div><div class="line">write.table(resdata,file=&quot;diffexpr_results.txt&quot;,</div><div class="line">            sep=&quot;\t&quot;,</div><div class="line">            quote = F,</div><div class="line">            row.names = F)</div><div class="line"></div><div class="line">plotMA(res)</div></pre></td></tr></table></figure>
<p><img src="http://ortxpw68f.bkt.clouddn.com/professional/180330/30ADKLgKb4.png?imageslim" alt="mark"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">maplot &lt;- function(res,thresh = 0.05, labelsig = TRUE, ...)&#123;</div><div class="line">  with(res, plot(baseMean, log2FoldChange, pch=20, cex=.5, log=&quot;x&quot;,...))</div><div class="line">  with(subset(res,padj&lt;thresh),points(baseMean, log2FoldChange, col=&quot;red&quot;,pch=20, cex = 1.5))</div><div class="line">&#125;</div><div class="line"></div><div class="line">maplot(resdata,main=&quot;MA plot&quot;)</div></pre></td></tr></table></figure>
<p>构建的maplot函数的绘图：</p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/professional/180330/eHcm7EhggC.png?imageslim" alt="mark"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">resdata$significant &lt;- as.factor(resdata$padj&lt;0.05 &amp; abs(resdata$log2FoldChange) &gt;1)</div><div class="line"></div><div class="line">ggplot(data=resdata, aes(x=log2FoldChange, y = -log10(padj),color = significant)) +</div><div class="line">  geom_point()+</div><div class="line">  ylim(0, 8)+</div><div class="line">  scale_color_manual(values = c(&quot;black&quot;,&quot;red&quot;))+</div><div class="line">  geom_hline(yintercept = -log10(0.05),lty=4, lwd=0.6,alpha=0.8)+</div><div class="line">  geom_vline(xintercept = c(1,-1),lty=4,lwd=0.6,alpha=0.8)+</div><div class="line">  theme_bw()+</div><div class="line">  theme(panel.border = element_blank(),</div><div class="line">        panel.grid.major = element_blank(),</div><div class="line">        axis.line = element_line(colour = &quot;black&quot;))+</div><div class="line">  labs(title=&quot;Volcanoplot_biotest(by RVDSD)&quot;, x=&quot;log2(fold change)&quot;,</div><div class="line">       y=&quot;-log10(padj&quot;)+</div><div class="line">  theme(plot.title = element_text(hjust = 0.5))+</div><div class="line">  geom_text_repel(data=subset(resdata, -log10(padj) &gt; 6),</div><div class="line">                  aes(label = Gene),col=&quot;black&quot;,</div><div class="line">                  alpha = 0.8)</div></pre></td></tr></table></figure>
<p>ggplot2绘制的火山图：<br><img src="http://ortxpw68f.bkt.clouddn.com/professional/180330/Hc3193k2c9.png?imageslim" alt="mark"></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2018/03/19/Linux/Linux-虚拟机Ubuntu与windows的文件夹共享/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/03/19/Linux/Linux-虚拟机Ubuntu与windows的文件夹共享/" itemprop="url">虚拟机Ubuntu与windows的文件夹共享</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-03-19T12:02:00+08:00">
                2018-03-19
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/生物信息学/" itemprop="url" rel="index">
                    <span itemprop="name">生物信息学</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  190
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  1
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <ol>
<li><p>在虚拟机Vmware的菜单栏上，单击“安装VMware Tools”，随后在虚拟机中出现VMware-tools-distrib的文件，将其解压到Documnts文件夹，如下所示：<br><img src="http://ortxpw68f.bkt.clouddn.com/professional/180324/b3el81mc1k.png?imageslim" alt="mark"></p>
</li>
<li><p>打开解压后的文件夹，文件夹中有这些文件，如下所示：<br><img src="http://ortxpw68f.bkt.clouddn.com/professional/180324/AFjJDIh5bB.png?imageslim" alt="mark"></p>
</li>
</ol>
<p>３. 右键打开Terminal，输入<code>sudo ./vmware-install.pl</code>进行安装，一路回车就行。</p>
<ol>
<li>重启电脑，若不重启电脑，虚拟机的设置选项中的共享文件夹是灰色的，无法进行选择。现在切换到这个选项卡，如下所示：<br><img src="http://ortxpw68f.bkt.clouddn.com/professional/180324/K94gGA2BGB.png?imageslim" alt="mark"></li>
</ol>
<p>选择“总是启用“，并添加相应的文件夹（我的文件夹是bitest），如下所示：<br><img src="http://ortxpw68f.bkt.clouddn.com/professional/180324/hF1Dic9f1I.png?imageslim" alt="mark"></p>
<ol>
<li>打开Ubuntu中的以下目录 <code>/mnt/hgfs</code>就可以看到了共享的文件夹了。<br><img src="http://ortxpw68f.bkt.clouddn.com/professional/180324/JGAeIDCKKB.png?imageslim" alt="mark"></li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2017/10/13/Literature/文献笔记-miRNA/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/10/13/Literature/文献笔记-miRNA/" itemprop="url">microRNA笔记</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-10-13T12:00:00+08:00">
                2017-10-13
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/文献笔记/" itemprop="url" rel="index">
                    <span itemprop="name">文献笔记</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  1,638
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  6
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="背景资料"><a href="#背景资料" class="headerlink" title="背景资料"></a>背景资料</h2><p>MicroRNA (miRNA) 是一类由内源基因编码的长度约为22 nt的非编码单链RNA 分子,它们在动植物中参与转录后基因表达调控。大意就是，Micro RNA就是一条不会翻译蛋白的小的RNA。其单位是22nt，而不是22bp，因为nt是核苷酸，bp是碱基对，Micro RNA是用nt作为单位的，起码说明了Micro RNA是单链的。</p>
<h2 id="命名"><a href="#命名" class="headerlink" title="命名"></a>命名</h2><h3 id="miRNA的转录"><a href="#miRNA的转录" class="headerlink" title="miRNA的转录"></a>miRNA的转录</h3><p>MiRNA首先是由MiRNA的host gene转录获得的，host gene转录，形成了primary microRNA（<strong>pri-MiRNA</strong>），然后通过Drosha–Pasha 复合体，形成了precursor microRNA（也就是<strong>pre-MiRNA</strong>），接着pre-MiRNA被Dicer剪切成双链的RNA，然后双链RNA被AGO1保护起来，其中一条链被降解，另一条链就被保留下来了。<br><img src="http://ortxpw68f.bkt.clouddn.com/rnatrans.png" alt=""><br>被降解的链一般被称之为“Passenger strand（过客链）”，这条链一般不容易被检测到，因为被降解了，这条链也被称之为星号链，一般会表示为“miR-×××*”。另一条链被称之为“Guide strand ”，也就是先导链，这条就是我们通常所说的miRNA。</p>
<p>注：从图上就可以看出，Passenger strand和Guide strand链都是来源于一个基因，但它们两个还能互补。</p>
<h3 id="pri-miRNA"><a href="#pri-miRNA" class="headerlink" title="pri-miRNA"></a>pri-miRNA</h3><p><strong>pri-miRNA：</strong>长度从几百到几千个碱基不等，带有5‘帽子和3’polyA尾巴，以及1到数个发夹径环结构，如下所示<img src="http://ortxpw68f.bkt.clouddn.com/rna2.png" alt="">：</p>
<p>用上述的命名方法的话，比如我们说MiRNA-21和MiRNA-21*，就大概是这样的，如下所示：</p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/m21.png" alt=""></p>
<p>这个图上，我们可以看到MiRNA-21是产生在precursor microRNA的5’臂上的，而MiRNA-21<em>是产生于precursor microRNA的3’臂上的。“</em>”这个标志，主要告诉我们，这条链是“Passenger strand”，也就是miRNA-21产生的一个副产品，表达量超低，所以星号链经常被认为是没有功能的。</p>
<h3 id="miRNA的5p端与3p端"><a href="#miRNA的5p端与3p端" class="headerlink" title="miRNA的5p端与3p端"></a>miRNA的5p端与3p端</h3><p>但是，问题来了，2011年开始，有很多文献，开始表明miRNA星号链是有功能的（Widespread regulatory activity of vertebrate microRNA<em> species.，Yang，2011），星号链的功能，也有可能比先导链更为高级。那这样用“</em>”来标记就有点过时了。于是就产生了这样的命名方法，就是按照microRNA产生于precursor microRNA的5’臂或者是3’臂，来将miRNA表示成“MiR-×××-5p”或者“MiR-×××-3p”，这样的话miR-21，就被命名成为了“miR-21-5p”，它的星号链就被命名成为了“miR-21-3p”。之前还有用“-s”（sence）“-as”（antisence）来对先导链（先导链是-s）和星号链（星号链是-as）来命名，主要是dsRNA形成过程时的正向和反向。但由于很容易搞混，所以已经被取消了。可能看到老一点的文献中会有。</p>
<h3 id="miRNA的编号"><a href="#miRNA的编号" class="headerlink" title="miRNA的编号"></a>miRNA的编号</h3><p>pre-miRNA以“mir”命名，其编号以“MI”编号，如人的miRNA 122的前体ID为hsa-mir-122，Accession为MI0000442；而miRNA的成熟链以“miR”命名，其编号以“MIMAT”编号，如人的miR-122的一个成熟体的ID为hsa-miR-122-5p ，Accession为 MIMAT0000421。</p>
<p>因此，miRNA的命令示意图如下所示：<br><img src="http://ortxpw68f.bkt.clouddn.com/professional/180516/JCHALCKc33.png?imageslim" alt="mark"></p>
<h3 id="miRNA命名方式的汇总"><a href="#miRNA命名方式的汇总" class="headerlink" title="miRNA命名方式的汇总"></a>miRNA命名方式的汇总</h3><ol>
<li>一个系统命名包含三部分内容，即物种，microRNA类别，序号。三者间用短线连接。</li>
<li>物种一般用三个小写字母表示，如hsa,mmu和rno分别代表人，小鼠和大鼠。</li>
<li>MicroRNA类别是指所命名的microRNA是pre-miRNA还是mature miRNA。pre-miRNA用mir表示，mature miRNA用miR表示。</li>
<li>序号为一阿拉伯数字，代表microRNA发现的先后。一般而言，数字越小，发现越早</li>
<li>高度同源的miRNA在No.其后加英文字母(小写,一般从a开始) 如miR-199a 和miR-199b</li>
<li>由不同染色体上的DNA序列转录加工而成的具有相同成熟体序列的miRNA，则在后面加上阿拉伯数字以区分, 如miR-199a-1和miR-199a-2；</li>
<li>如果一个前体的2个臂分别加产生miRNA，则根据克隆实验，在表达水平较低的miRNA 后面加“<em>” ，如miR-199amiR-199a</em>，或进行如下命名，miR-142-5p(也可命名为miR-142-s，表示从5’ 端的臂加工而来)和miR-142-3p(也可命名为miR-142-as，表示从3’端的臂加工而来)；</li>
<li>确定命名规则之前发现的miRNA，如let-7，则保留原来名字。</li>
</ol>
<h2 id="作用机理"><a href="#作用机理" class="headerlink" title="作用机理"></a>作用机理</h2><p>作用机理的图片如下所示：<br><img src="http://ortxpw68f.bkt.clouddn.com/professional/180516/9JIG1HBfcd.png?imageslim" alt="mark"></p>
<blockquote>
<p>要说MiRNA具体是咋起作用的？好吧，给你举个例子，你感受一下。普通的mRNA就好比是一条高速公路，路上会有很多会排出尾气的汽车（核糖体，它们在mRNA上边走边翻译蛋白），一条高速路上会有很多辆车（多聚核糖体Polysome），车越多、开得越快，尾气就越大（蛋白表达量就越高），这个时候，在路快到尽头的地方（mRNA的3’UTR上）就出现了一个交警（MiRNA聚合一些蛋白的RISC，RNA-Induced SilencingComplex，RNA诱导沉默复合体），他稳稳地站在路的最后（通过RISC中的MiRNA与3’UTR互补，结合到mRNA的3’UTR上），整个车队就停下来了，尾气也没了（蛋白表达降低）。好了，现在也明白为啥过表达MiRNA之后下游基因的mRNA变化不大，但蛋白会有变化了吧？因为警察是不会拆路的……</p>
</blockquote>
<p>比较详细的图</p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/rna6.jpg" alt=""></p>
<h3 id="miRNA种子区（“seed”region）"><a href="#miRNA种子区（“seed”region）" class="headerlink" title="miRNA种子区（“seed”region）"></a>miRNA种子区（“seed”region）</h3><p>5’端2-8个碱基被称为种子序列<br><img src="http://ortxpw68f.bkt.clouddn.com/rna3.jpg" alt=""></p>
<h3 id="miRNA与miRNA靶标的结合"><a href="#miRNA与miRNA靶标的结合" class="headerlink" title="miRNA与miRNA靶标的结合"></a>miRNA与miRNA靶标的结合</h3><p>主要有两类：5’-dominant Site和3’-compensatory Site。</p>
<ol>
<li><strong>5‘显性位点：满足经典种子区2-8完全互补结合的方式</strong>。如下所示<img src="http://ortxpw68f.bkt.clouddn.com/rna4.jpg" alt="">：</li>
<li><strong>3’端补偿位点：5‘端并非满足2-8经典完全互补，知识部分互补，这样3‘端补偿位点结合，增强了miRNA与标靶结合稳定性，如下所示：5’-dominant Site和3’-compensatory Site，如下所示</strong><img src="http://ortxpw68f.bkt.clouddn.com/rna5.jpg" alt=""></li>
</ol>
<h2 id="RNA的靶点预测"><a href="#RNA的靶点预测" class="headerlink" title="RNA的靶点预测"></a>RNA的靶点预测</h2><h3 id="工具汇总如下"><a href="#工具汇总如下" class="headerlink" title="工具汇总如下"></a>工具汇总如下</h3><p>miEAA<br>网址：<a href="https://ccb-compute2.cs.uni-saarland.de/mieaa_tool/" target="_blank" rel="external">https://ccb-compute2.cs.uni-saarland.de/mieaa_tool/</a><br>分析microRNA的功能、信号通路、疾病等进行分析</p>
<p>YM500v2：<br><a href="http://ngs.ym.edu.tw/ym500v2/index.php" target="_blank" rel="external">http://ngs.ym.edu.tw/ym500v2/index.php</a></p>
<p>Starbase（<a href="http://starbase.sysu.edu.cn/index.php）" target="_blank" rel="external">http://starbase.sysu.edu.cn/index.php）</a><br>交叉预测网站，既可以通过靶基因预测microRNA也可以通过microRNA预测靶基因。</p>
<p>miRPathDB（<a href="https://mpd.bioinf.uni-sb.de/overview.html）" target="_blank" rel="external">https://mpd.bioinf.uni-sb.de/overview.html）</a><br>查询参与通路内调控的miRNAs，包含了人、鼠两类数据。</p>
<p>mirbase（mirbase：<a href="http://www.mirbase.org/）" target="_blank" rel="external">http://www.mirbase.org/）</a></p>
<h2 id="参考资料："><a href="#参考资料：" class="headerlink" title="参考资料："></a>参考资料：</h2><ol>
<li><a href="https://mp.weixin.qq.com/s?__biz=MzA3ODU1NjUyNw==&amp;mid=404311107&amp;idx=1&amp;sn=85308a8ad9806f65072de4c8ed79f54c&amp;scene=1&amp;srcid=0314tK0Lw7HkKyoJRoAjwPmg#rd" target="_blank" rel="external">miRNA到底是怎么命名的？</a></li>
<li><a href="https://mp.weixin.qq.com/s?__biz=MzA3ODU1NjUyNw==&amp;mid=200526001&amp;idx=1&amp;sn=ae82f47928f8cd4c519c89f69ab8d103&amp;scene=21#wechat_redirect" target="_blank" rel="external">Micro RNA，从一窍不通到略知一二</a></li>
<li><a href="http://mp.weixin.qq.com/s?__biz=MzA5ODQ1NDIyMQ==&amp;mid=2649602388&amp;idx=2&amp;sn=6097b6c76944a795a628bce7fbbac934&amp;chksm=888846f6bfffcfe0a579d0a9bd1dd24083a28937c4057db9e25abd3c006858b8d2675690f5ae&amp;mpshare=1&amp;scene=1&amp;srcid=0901fXzOX8InCPG3nb2oSiDS#rd" target="_blank" rel="external">搞懂RNA命名，miRNA、lncRNA、circRN不再傻傻分不清</a></li>
<li><a href="https://mp.weixin.qq.com/profile?src=3&amp;timestamp=1507870340&amp;ver=1&amp;signature=y-Qin6PEYzPl9NMOQjgJYLIB1ca8JQ1JnnITRYLuVFI*N2jLLUI74CFzvPaSyi-PVLDYcUEOeEIiXXC4QtOf4w==" target="_blank" rel="external">艾博思生物（公众号： ibsbio）</a></li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2017/10/08/BioInformation/生信-转录组学习笔记08差异基因结果注释/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/10/08/BioInformation/生信-转录组学习笔记08差异基因结果注释/" itemprop="url">转录组学习笔记08-差异基因结果注释</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-10-08T12:00:00+08:00">
                2017-10-08
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/生信实战项目/" itemprop="url" rel="index">
                    <span itemprop="name">生信实战项目</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  0
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  1
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2017/10/07/BioInformation/生信-转录组学习笔记07差异基因分析/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/10/07/BioInformation/生信-转录组学习笔记07差异基因分析/" itemprop="url">转录组学习笔记07-差异基因分析</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-10-07T12:00:00+08:00">
                2017-10-07
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/生信实战项目/" itemprop="url" rel="index">
                    <span itemprop="name">生信实战项目</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  2,050
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  9
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>利用DEseq2包进行分析不同组之间的差异。都是参考<a href="http://www.360doc.com/content/17/1023/22/41791033_697550480.shtml" target="_blank" rel="external">徐洲更.(伪)从零开始学转录组(7):差异基因表达分析</a>的。</p>
<p>导入数据，构建 DESeq2 所需的 DESeqDataSet 对象，如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">library(DESeq2)</div><div class="line">countData &lt;- raw_count_filt[,2:5]</div><div class="line">condition &lt;- factor(c(&quot;control&quot;,&quot;KD&quot;,&quot;KD&quot;,&quot;control&quot;))</div><div class="line">dds &lt;- DESeqDataSetFromMatrix(countData, DataFrame(condition), design= ~ condition )</div></pre></td></tr></table></figure>
<h2 id="过滤掉低low-count"><a href="#过滤掉低low-count" class="headerlink" title="过滤掉低low count"></a>过滤掉低low count</h2><p>接着， 过滤掉一些low count数据（通常是count为0的read），节省内存，提高运行速度，如下所示：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">nrow(dds)</div><div class="line">dds &lt;- dds[ rowSums(counts(dds)) &gt; 1, ]</div><div class="line">nrow(dds)</div></pre></td></tr></table></figure></p>
<h2 id="使用DESeq进行差异表达分析："><a href="#使用DESeq进行差异表达分析：" class="headerlink" title="使用DESeq进行差异表达分析："></a>使用DESeq进行差异表达分析：</h2><p>DESeq包含三步，estimation of size factors（estimateSizeFactors)， estimation of dispersion（estimateDispersons)， Negative Binomial GLM fitting and Wald statistics（nbinomWaldTest），可以分布运行，也可用一步到位，最后返回 results可用的DESeqDataSet对象，如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">dds &lt;- DESeq(dds)</div></pre></td></tr></table></figure>
<blockquote>
<p>estimating size factors<br>estimating dispersions<br>gene-wise dispersion estimates<br>mean-dispersion relationship<br>final dispersion estimates<br>fitting model and testing</p>
</blockquote>
<p>出现上述结果表示运行结束，过程大概是十几秒。<br>可以通过<code>result</code>来查看运行的结果，如下所示：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">res &lt;- results(dds)</div></pre></td></tr></table></figure></p>
<p>可用mcols查看每一项结果的具体含义，比如说log2FoldChange 表示倍数变化取log2结果，还能画个火山图。padj 就是用BH对多重试验进行矫正。如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mcols(res, use.names = TRUE)</div></pre></td></tr></table></figure>
<p><img src="http://ortxpw68f.bkt.clouddn.com/rnaseq112.png" alt=""></p>
<p>用summary可以看描述性的结果，如下所示：<br><img src="http://ortxpw68f.bkt.clouddn.com/rnaseq113.png" alt=""></p>
<h3 id="绘制MA图"><a href="#绘制MA图" class="headerlink" title="绘制MA图"></a>绘制MA图</h3><blockquote>
<p>An MA plot is an application of a Bland–Altman plot for visual representation of genomic data. The plot visualises the differences between measurements taken in two samples, by transforming the data onto M (log ratio) and A (mean average) scales, then plotting these values. Though originally applied in the context of two channel DNA microarray gene expression data, MA plots are also used to visualise high-throughput sequencing analysis —From wikipeida</p>
</blockquote>
<p>M表示log fold change，衡量基因表达量变化，上调还是下调。A表示每个基因的count的均值。根据summary可知，low count的比率很高，所以大部分基因表达量不高，也就是集中在0的附近（log2(1)=0，也就是变化1倍）,提供了模型预测系数的分布总览。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">plotMA(res, ylim = c(-5,5))</div><div class="line">topGene &lt;- rownames(res)[which.min(res$padj)]</div><div class="line">with(res[topGene, ], &#123;</div><div class="line">  points(baseMean, log2FoldChange, col=&quot;dodgerblue&quot;, cex=2, lwd=2)</div><div class="line">  text(baseMean, log2FoldChange, topGene, pos=2, col=&quot;dodgerblue&quot;)</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<p>如下所示：<br><img src="http://ortxpw68f.bkt.clouddn.com/rnqseq114.png" alt=""></p>
<p>如果经过lfcShrink 收缩log2 fold change， 结果会好看很多<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">res.shrink &lt;- lfcShrink(dds, contrast = c(&quot;condition&quot;,&quot;KD&quot;,&quot;control&quot;), res=res)</div><div class="line">plotMA(res.shrink, ylim = c(-5,5))</div><div class="line">topGene &lt;- rownames(res)[which.min(res$padj)]</div><div class="line">with(res[topGene, ], &#123;</div><div class="line">  points(baseMean, log2FoldChange, col=&quot;dodgerblue&quot;, cex=2, lwd=2)</div><div class="line">  text(baseMean, log2FoldChange, topGene, pos=2, col=&quot;dodgerblue&quot;)</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<p>如下所示：<br><img src="http://ortxpw68f.bkt.clouddn.com/rnaseq115.png" alt=""></p>
<h3 id="寻找差异基因"><a href="#寻找差异基因" class="headerlink" title="寻找差异基因"></a>寻找差异基因</h3><p>提取差异基因</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">res.deseq2 &lt;- subset(res, padj &lt; 0.05)</div></pre></td></tr></table></figure>
<h3 id="使用edgeR进行差异基因分析"><a href="#使用edgeR进行差异基因分析" class="headerlink" title="使用edgeR进行差异基因分析"></a>使用edgeR进行差异基因分析</h3><p>edgeR使用DGEList函数读取count matrix数据，也就说你需要提供一个现成的matrix数据，而不是指望它能读取单独的文件，然后进行合并，其实可以用 tximport 或 DESeqDataSetFromHTSeq 读取单独的文件，然后传递给DGEList。</p>
<h4 id="第一步：-构建DGEList对象"><a href="#第一步：-构建DGEList对象" class="headerlink" title="第一步： 构建DGEList对象"></a>第一步： 构建DGEList对象</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">library(edgeR)</div><div class="line">group &lt;- factor(c(&quot;control&quot;,&quot;KD&quot;,&quot;KD&quot;,&quot;control&quot;))</div><div class="line">genelist &lt;- DGEList(counts=raw_count_filt[,2:5], group = group)</div></pre></td></tr></table></figure>
<h4 id="第二步：-过滤-low-counts数据。"><a href="#第二步：-过滤-low-counts数据。" class="headerlink" title="第二步： 过滤 low counts数据。"></a>第二步： 过滤 low counts数据。</h4><p>与DESeq2的预过滤不同，DESeq2的预过滤只是为了改善后续运算性能，在运行过程中依旧会自动处理low count数据，edgeR需要在分析前就要排除那些low count数据，而且非常严格。从生物学角度，有生物学意义的基因的表达量必须高于某一个阈值。从统计学角度上， low count的数据不太可能有显著性差异，而且在多重试验矫正阶段还会拖后腿。 综上所诉，放心大胆的过滤吧。</p>
<p>根据经验，基因至少在某一些文库的count超过10 ~ 15 才被认为是表达。这一步全靠尝试， 剔除太多就缓缓，剔除太少就严格点。 我们可以简单的对每个基因的raw count进行比较，但是建议用CPM（count-per-million)标准化 后再比较，避免了文库大小的影响。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"># 简单粗暴的方法</div><div class="line">keep &lt;- rowSums(genelist$count) &gt; 50</div><div class="line"># 利用CPM标准化</div><div class="line">keep &lt;- rowSums(cpm(genelist) &gt; 0.5 ) &gt;=2</div><div class="line">table(keep)</div><div class="line">genelist.filted &lt;- genelist[keep,,keep.lib.sizes=FALSE]</div></pre></td></tr></table></figure>
<p>这里的0.5(即阈值）等于 10/(最小的文库的 read count数 /1000000)，keep.lib.size=FALSE表示重新计算文库大小。</p>
<p>第三步： 根据组成偏好(composition bias)标准化。edgeR的calcNormFactors函数使用TMM算法对DGEList标准化.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">genelist.norm &lt;- calcNormFactors(genelist.filted)</div></pre></td></tr></table></figure>
<p>注 大部分的mRNA-Seq数据分析用TMM标准化就行了，但是也有例外，比如说single-cell RNA-Seq(Lun, Bach, and Marioni 2016), 还有就是global differential expression， 基因组一半以上的基因都是差异表达的，请尽力避免，(D. Wu et al. 2013)， 不然就需要用到内参进行标准化了(Risso et al. 2014).</p>
<p>第四步： 实验设计矩阵(Design matrix)， 类似于DESeq2中的design参数。 edgeR的线性模型和差异表达分析需要定义一个实验设计矩阵。很直白的就能发现是1vs0</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">design &lt;- model.matrix(~0+group)</div><div class="line">colnames(design) &lt;- levels(group)</div></pre></td></tr></table></figure>
<p>第五步： 估计离散值（Dispersion）。前面已经提到负二项分布（negative binomial，NB)需要均值和离散值两个参数。edgeR对每个基因都估测一个经验贝叶斯稳健离散值（mpirical Bayes moderated dispersion），还有一个公共离散值（common dispersion，所有基因的经验贝叶斯稳健离散值的均值）以及一个趋势离散值</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">genelist.Disp &lt;- estimateDisp(genelist.norm, design, robust = TRUE)</div><div class="line">plotBCV(genelist.Disp)</div></pre></td></tr></table></figure>
<p>还可以进一步通过quasi-likelihood (QL)拟合NB模型，用于解释生物学和技术性导致的基因特异性变异 (Lund et al. 2012; Lun, Chen, and Smyth 2016).</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">fit &lt;- glmQLFit(genelist.Disp, design, robust=TRUE)</div><div class="line">head(fit$coefficients)</div></pre></td></tr></table></figure>
<p>第六步: 差异表达检验（1）。这一步主要构建比较矩阵，类似于DESeq2中的results函数的 contrast 参数。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">cntr.vs.KD &lt;- makeContrasts(control-KD, levels=design)</div><div class="line">res &lt;- glmQLFTest(fit, contrast=cntr.vs.KD)</div><div class="line">ig.edger &lt;- res$table[p.adjust(res$table$PValue, method = &quot;BH&quot;) &lt; 0.01, ]</div></pre></td></tr></table></figure>
<p>这里用的是glmQLFTest而不是glmLRT是因为前面用了glmQLTFit进行拟合，所以需要用QL F-test进行检验。如果前面用的是glmFit，那么对应的就是glmLRT. 作者称QL F-test更加严格。多重试验矫正用的也是BH方法。</p>
<p>后续就是提取显著性差异的基因用作下游分析，做一些图看看</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">topTags(res,n=10)</div><div class="line">is.de &lt;- decideTestsDGE(res)</div><div class="line">summary(is.de)</div><div class="line">plotMD(res, status=is.de, values=c(1,-1), col=c(&quot;red&quot;,&quot;blue&quot;),legend=&quot;topright&quot;)</div></pre></td></tr></table></figure>
<p>如下所示：<br><img src="http://ortxpw68f.bkt.clouddn.com/rnaseq116.png" alt=""></p>
<p>第六步：差异表达检验（2）。上面找到的显著性差异的基因，没有考虑效应值，也就是具体变化了多少倍。我们也可用找表达量变化比较大的基因，对应的函数是 glmTreat。</p>
<h3 id="使用limma进行差异分析"><a href="#使用limma进行差异分析" class="headerlink" title="使用limma进行差异分析"></a>使用limma进行差异分析</h3><p>导入read count， 保存为专门的对象用于后续分析<br>原始数据过滤，根据标准化read count 或者 raw count 作为筛选标准<br>raw read count 标准化<br>通过各种算法（如经验贝叶斯，EM）预测dispersion离散值<br>广义线性模型拟合数据<br>差异分析，也就是统计检验部分</p>
<p>Limma原先用于处理基因表达芯片数据。如果你仔细看edgeR导入界面，你就会发现，edgeR有一部分功能依赖于limma包。Limma采用经验贝叶斯模型（ Empirical Bayesian model）让结果更稳健。</p>
<p>在处理RNA-Seq数据时，raw read count先被转成log2-counts-per-million (logCPM)，然后对mean-variance关系建模。建模有两种方法：</p>
<p>精确权重法（precision weights）也就是“voom”<br>经验贝叶斯先验趋势（empirical Bayes prior trend），也就是”limma-trend“</p>
<p>数据预处理： Limma使用edgeR的DGEList对象，并且过滤方法都是一致的，对应edgeR的第一步,第二步， 第三步</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">library(edgeR)library(limma)</div><div class="line">group &lt;- factor(c(&quot;control&quot;,&quot;KD&quot;,&quot;KD&quot;,&quot;control&quot;))</div><div class="line">genelist &lt;- DGEList(counts=raw_count_filt[,2:5], group = group)</div><div class="line">### filter base  use CPM</div><div class="line">keep &lt;- rowSums(cpm(genelist) &gt; 0.5 ) &gt;=2table(keep)</div><div class="line">genelist.filted &lt;- genelist[keep, ,keep.lib.sizes=FALSE]</div><div class="line">### normalizaition</div><div class="line">x &lt;- calcNormFactors(x, method = &quot;TMM&quot;)</div></pre></td></tr></table></figure>
<p>差异表达分析: 使用”limma-trend”</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">design &lt;- model.matrix(~0+group)</div><div class="line">colnames(design) &lt;- levels(group)</div><div class="line">logCPM &lt;- cpm(genelist.norm, log=TRUE, prior.count=3)</div><div class="line">fit &lt;- lmFit(logCPM, design)</div><div class="line">fit &lt;- eBayes(fit, trend=TRUE)</div><div class="line">topTable(fit, coef=ncol(design))</div></pre></td></tr></table></figure>
<p>差异表达分析: 使用”limma-voom“</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">### DGE with voom</div><div class="line">v &lt;- voom(genelist.norm, design, plot=TRUE)</div><div class="line">#v &lt;- voom(counts, design, plot=TRUE)</div><div class="line">fit &lt;- lmFit(v, design)</div><div class="line">fit &lt;- eBayes(fit)</div><div class="line">all &lt;- topTable(fit, coef=ncol(design), number=10000)</div><div class="line">sig.limma &lt;- all[all$adj.P.Val &lt; 0.01, ]</div><div class="line">fit &lt;- treat(fit, lfc=log2(1.2))</div><div class="line">topTreat(fit, coef=ncol(design))</div></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2017/10/06/BioInformation/生信-转录组学习笔记06reads计数/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/10/06/BioInformation/生信-转录组学习笔记06reads计数/" itemprop="url">转录组学习笔记06-reads计数</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-10-06T12:00:00+08:00">
                2017-10-06
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/生信实战项目/" itemprop="url" rel="index">
                    <span itemprop="name">生信实战项目</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  315
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  2
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="任务："><a href="#任务：" class="headerlink" title="任务："></a>任务：</h2><h3 id="生成另一组数据"><a href="#生成另一组数据" class="headerlink" title="生成另一组数据"></a>生成另一组数据</h3><p>下载的文件中，人类的测序数据只有3个（1个对照，2个实验），由于DESeq2分析必须有重复，因此，为了学习RNA-seq分析，这里需要再生成一个对照组，但在实际实验过程中，这必须要有重复，这里生成只是一种临时的手段。以下的代码是徐洲更同学的代码，我直接复制用了。 </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line"># import data if sample are small</div><div class="line">options(stringsAsFactors = FALSE)</div><div class="line">control &lt;- read.table(&quot;D:\\netdisk\\bioinfo.notes\\data\\SRR3589956.count&quot;,</div><div class="line">                      sep=&quot;\t&quot;, col.names = c(&quot;gene_id&quot;,&quot;control&quot;))</div><div class="line">rep1 &lt;- read.table(&quot;D:\\netdisk\\bioinfo.notes\\data\\SRR3589957.count&quot;,</div><div class="line">                   sep=&quot;\t&quot;, col.names = c(&quot;gene_id&quot;,&quot;rep1&quot;))</div><div class="line">rep2 &lt;- read.table(&quot;D:\\netdisk\\bioinfo.notes\\data\\SRR3589958.count&quot;,</div><div class="line">                   sep=&quot;\t&quot;,col.names = c(&quot;gene_id&quot;,&quot;rep2&quot;))</div><div class="line"># merge data and delete the unuseful row</div><div class="line"></div><div class="line">raw_count &lt;- merge(merge(control, rep1, by=&quot;gene_id&quot;), rep2, by=&quot;gene_id&quot;)</div><div class="line">raw_count_filt &lt;- raw_count[-1:-5,]</div><div class="line"></div><div class="line">ENSEMBL &lt;- gsub(&quot;(.*?)\\.\\d*?_\\d&quot;, &quot;\\1&quot;, raw_count_filt$gene_id)</div><div class="line">row.names(raw_count_filt) &lt;- ENSEMBL</div><div class="line">## the sample problem</div><div class="line"></div><div class="line">delta_mean &lt;- abs(mean(raw_count_filt$rep1) - mean(raw_count_filt$rep2))</div><div class="line"></div><div class="line">sampleNum &lt;- length(raw_count_filt$control)</div><div class="line">sampleMean &lt;- mean(raw_count_filt$control)</div><div class="line"></div><div class="line">control2 &lt;- integer(sampleNum)</div><div class="line">for (i in 1:sampleNum)&#123;  </div><div class="line">  if(raw_count_filt$control[i] &lt; sampleMean)&#123;</div><div class="line">  control2[i] &lt;- raw_count_filt$control[i] + abs(raw_count_filt$rep1[i] - raw_count_filt$rep2[i])</div><div class="line">&#125;  </div><div class="line">  else&#123;</div><div class="line">  control2[i] &lt;- raw_count_filt$control[i] + rpois(1,delta_mean)</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"># add data to raw_count</div><div class="line"></div><div class="line">raw_count_filt$control2 &lt;- control2</div></pre></td></tr></table></figure>
<p>上述代码将4组（其中包括我们自己生成的一个对照组）的reads进行了合并，现在查看AKAP95（ENSG00000105127）的表达量，如下所示：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">raw_count_filt[rownames(raw_count_filt)==&quot;ENSG00000105127&quot;,]</div></pre></td></tr></table></figure></p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/rnaseq111.png" alt=""></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2017/10/05/BioInformation/生信-转录组学习笔记05序列比对/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/10/05/BioInformation/生信-转录组学习笔记05序列比对/" itemprop="url">转录组学习笔记05-序列比对</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-10-05T12:00:00+08:00">
                2017-10-05
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/生信实战项目/" itemprop="url" rel="index">
                    <span itemprop="name">生信实战项目</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  932
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  4
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="任务："><a href="#任务：" class="headerlink" title="任务："></a>任务：</h2><blockquote>
<ol>
<li>搞懂hisat2的用法。</li>
<li>直接去hisat2的主页下载index文件即可，然后把fastq格式的reads比对上去得到sam文件。</li>
<li>接着用samtools把它转为bam文件，并且排序(注意N和P两种排序区别)索引好，载入IGV，再截图几个基因看看。</li>
<li>顺便对bam文件进行简单QC，参考直播我的基因组系列。 来源于生信技能树：<a href="http://www.biotrainee.com/forum.php?mod=viewthread&amp;tid=1750#lastpost" target="_blank" rel="external">http://www.biotrainee.com/forum.php?mod=viewthread&amp;tid=1750#lastpost</a></li>
</ol>
</blockquote>
<h2 id="比对软件"><a href="#比对软件" class="headerlink" title="比对软件"></a>比对软件</h2><p> HISAT2：<a href="http://ccb.jhu.edu/software/hisat2/index.shtml" target="_blank" rel="external">http://ccb.jhu.edu/software/hisat2/index.shtml</a><br>参考资料：<a href="http://blog.biochen.com/archives/337" target="_blank" rel="external">http://blog.biochen.com/archives/337</a></p>
<p>STAR：<a href="https://codeload.github.com/alexdobin/STAR/zip/master" target="_blank" rel="external">https://codeload.github.com/alexdobin/STAR/zip/master</a><br>参考资料：<a href="http://www.bio-info-trainee.com/727.html" target="_blank" rel="external">http://www.bio-info-trainee.com/727.html</a></p>
<p>TopHat：<a href="http://ccb.jhu.edu/software/tophat/index.shtml" target="_blank" rel="external">http://ccb.jhu.edu/software/tophat/index.shtml</a><br>参考资料：<a href="http://blog.sina.com.cn/s/blog_8808cae20101amqp.html" target="_blank" rel="external">http://blog.sina.com.cn/s/blog_8808cae20101amqp.html</a></p>
<p>RapMap：<a href="https://github.com/COMBINE-lab/RapMap" target="_blank" rel="external">https://github.com/COMBINE-lab/RapMap</a><br>参考：<a href="https://academic.oup.com/bioinformatics/article/32/12/i192/2288985/RapMap-a-rapid-sensitive-and-accurate-tool-for" target="_blank" rel="external">https://academic.oup.com/bioinformatics/article/32/12/i192/2288985/RapMap-a-rapid-sensitive-and-accurate-tool-for</a></p>
<p>CIDANE：<a href="http://ccb.jhu.edu/software/cidane/" target="_blank" rel="external">http://ccb.jhu.edu/software/cidane/</a><br>参考文献：<a href="https://genomebiology.biomedcentral.com/articles/10.1186/s13059-015-0865-0" target="_blank" rel="external">https://genomebiology.biomedcentral.com/articles/10.1186/s13059-015-0865-0</a></p>
<p>CLASS2 ：<a href="https://sourceforge.net/projects/splicebox/files/?source=navbar" target="_blank" rel="external">https://sourceforge.net/projects/splicebox/files/?source=navbar</a><br>参考文献：<a href="https://academic.oup.com/nar/article/44/10/e98/2516329/CLASS2-accurate-and-efficient-splice-variant" target="_blank" rel="external">https://academic.oup.com/nar/article/44/10/e98/2516329/CLASS2-accurate-and-efficient-splice-variant</a></p>
<blockquote>
<p>内容主要参考：<a href="http://www.360doc.com/content/16/1223/13/29483982_617058719.shtml" target="_blank" rel="external">http://www.360doc.com/content/16/1223/13/29483982_617058719.shtml</a></p>
</blockquote>
<h3 id="1-HISAT2的使用"><a href="#1-HISAT2的使用" class="headerlink" title="1. HISAT2的使用"></a>1. HISAT2的使用</h3><p>人类和小鼠的索引有现成的，HISAT2官网可以直接下载进行序列比对。如下图所示：选择hg19和mm10的index，文章中RNA-Seq测序数据，可以包括人类的3个数据和小鼠的4个数据，因此需要小鼠和人类的索引。</p>
<h3 id="人类和小鼠index下载"><a href="#人类和小鼠index下载" class="headerlink" title="人类和小鼠index下载"></a>人类和小鼠index下载</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">mkdir -p ~/disk2/data/reference/index</div><div class="line">cd ~/disk2/data/reference/index</div><div class="line">wget ftp://ftp.ccb.jhu.edu/pub/infphilo/hisat2/data/hg19.tar.gz</div><div class="line"> wget ftp://ftp.ccb.jhu.edu/pub/infphilo/hisat2/data/mm10.tar.gz</div><div class="line"># 解压得到两个目录，hg19和mm10</div><div class="line">tar -zxvf *.tar.gz</div><div class="line"># 删除压缩包</div><div class="line">rm -rf *.tar.gz</div></pre></td></tr></table></figure>
<h3 id="比对序列，得到sam文件"><a href="#比对序列，得到sam文件" class="headerlink" title="比对序列，得到sam文件"></a>比对序列，得到sam文件</h3><p>Usage：hisat2 [options]* -x {-1 -2 | -U | —sra-acc } [-S ]</p>
<p>参数： </p>
<blockquote>
<p>-x 指定index文件<br>-1 双端测序第一个文件<br>-2 双端测序第二个文件<br>-U 单端测序文件<br>—sra-acc SRA accession number<br>-S 指定输出的格式，一般指定为sam</p>
</blockquote>
<p>代码如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">for ((i=56;i&lt;=58;i++));</div><div class="line">do hisat2 -t -x /media/w/新加卷/Download/reference/hg19/genome -1 /media/w/新加卷/Download/outdata/_media_w_新加卷_Download_data_SRR35899$&#123;i&#125;.sra_1.fastq.gz -2 /media/w/新加卷/Download/outdata/_media_w_新加卷_Download_data_SRR35899$&#123;i&#125;.sra_2.fastq.gz -S /media/w/新加卷/Download/align/SRR35899$&#123;i&#125;.sam;</div><div class="line">done for ((i=59;i&lt;=62;i++));</div><div class="line">do hisat2 -t -x /media/w/新加卷/Download/reference/hg19/genome -1 /media/w/新加卷/Download/outdata/_media_w_新加卷_Download_data_SRR35899$&#123;i&#125;.sra_1.fastq.gz -2 /media/w/新加卷/Download/outdata/_media_w_新加卷_Download_data_SRR35899$&#123;i&#125;.sra_2.fastq.gz -S /media/w/新加卷/Download/align/SRR35899$&#123;i&#125;.sam;</div><div class="line">done</div></pre></td></tr></table></figure></p>
<h3 id="SAMTools"><a href="#SAMTools" class="headerlink" title="SAMTools"></a>SAMTools</h3><p>SAM（sequence Alignment/mapping)数据格式是目前高通量测序中存放比对数据的标准格式，当然他可以用于存放未比对的数据。所以，SAM的格式说明</p>
<p>而目前处理SAM格式的工具主要是SAMTools，这是Heng Li大神写的，除了C语言版本，还有Java的Picard，Python的Pysam，Common lisp的cl-sam等其他版本。SAMTools的主要功能如下：</p>
<blockquote>
<p>view: BAM-SAM/SAM-BAM 转换和提取部分比对<br>sort: 比对排序<br>merge: 聚合多个排序比对<br>index: 索引排序比对<br>faidx: 建立FASTA索引，提取部分序列<br>tview: 文本格式查看序列<br>pileup: 产生基于位置的结果和 consensus/indel calling<br>最常用的三板斧就是格式转换，排序，索引。而进阶教程就是看文档提高。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">for i in `seq 56 58`</div><div class="line">do</div><div class="line">    samtools view -S SRR35899$&#123;i&#125;.sam -b &gt; SRR35899$&#123;i&#125;.bam </div><div class="line">    # 将sam文件转化为bam文件；参数-S表示输入sam文件，参数-b表示输出文件为bam，最后重定向输入bam文件</div><div class="line">    </div><div class="line">    samtools sort SRR35899$&#123;i&#125;.bam -o SRR35899$&#123;i&#125;_sorted.bam</div><div class="line">    # 对所有的bam文件进行排序；</div><div class="line">    </div><div class="line">    samtools index SRR35899$&#123;i&#125;_sorted.bam</div><div class="line">    将所有的排序文件建立索引，索引文件</div><div class="line">done</div></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2017/10/04/BioInformation/生信-转录组学习笔记04了解参考基因组及基因注释/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/10/04/BioInformation/生信-转录组学习笔记04了解参考基因组及基因注释/" itemprop="url">转录组学习笔记04-了解参考基因组及基因注释</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-10-04T12:02:00+08:00">
                2017-10-04
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/生信实战项目/" itemprop="url" rel="index">
                    <span itemprop="name">生信实战项目</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  1,935
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  7
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="目标"><a href="#目标" class="headerlink" title="目标"></a>目标</h2><blockquote>
<p>在UCSC下载hg19参考基因组，群主博客有详细说明，从gencode数据库下载基因注释文件，并且用IGV去查看你感兴趣的基因的结构，例如TP53，EGFR等等。 截图几个基因的IGV可视化结构！还可以下载ENSEMBL，NCBI的GTF，也导入IGV看看，截图基因结构。了解IGV常识。 来源于生信技能树：<a href="http://www.biotrainee.com/forum.php?mod=viewthread&amp;tid=1750#lastpost" target="_blank" rel="external">http://www.biotrainee.com/forum.php?mod=viewthread&amp;tid=1750#lastpost</a></p>
</blockquote>
<h2 id="什么是参考基因组？"><a href="#什么是参考基因组？" class="headerlink" title="什么是参考基因组？"></a>什么是参考基因组？</h2><blockquote>
<p>测序得到的是几百bp的短read， 相当于把拼图打散了给你。如果没有参考基因组，从头(de novo)组装等于是重走人类基因组计划的老路，也就是打散了拼图，却不告诉你原来是什么样子，那么任务将会及其艰巨。还好人类基因组已经组装好了，我们只需要把我们测得序列回贴（mapping)回去，毕竟人与人之间的差距只有不到1%差异, 允许mismatch就行。</p>
<p>参考基因组对新手来说，是一个很大的坑，hg19、GRCH37、 ensembl 75这3种基因组版本应该是大家见得比较多的了，国际通用的人类参考基因组，其实他们储存的是同样的fasta序列，只是分别对应着三种国际生物信息学数据库资源收集存储单位，即NCBI，UCSC及ENSEMBL各自发布的基因组信息而已。有一些参考基因组比较小众，存储的序列也不一样，比如BGI做的炎黄基因组，还有DNA双螺旋结构提出者沃森（Watson）的基因组，还有2016年发表在nature上面的号称最完善的韩国人做的基因组。前期我们先不考虑这些小众基因组，主要就下载hg19和hg38，都是UCSC提供的，虽然hg38相比hg19来说，做了很多改进，优点也不少，但因为目前为止很多注释信息都是针对于hg19的坐标系统来的，我们就都下载了，正好自己探究一下。也顺便下载一个小鼠的最新版参考基因组吧，反正比对也就是睡个觉的功夫，顺便分析一下结果，看看比对率是不是很低。</p>
</blockquote>
<h3 id="参考基因组hg19下载"><a href="#参考基因组hg19下载" class="headerlink" title="参考基因组hg19下载"></a>参考基因组hg19下载</h3><p>这里下载的是USCS版本的参考基因组。</p>
<h4 id="下载USCS版本的hg19"><a href="#下载USCS版本的hg19" class="headerlink" title="下载USCS版本的hg19"></a>下载USCS版本的hg19</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">mkdir -p ~/disk2/data/reference/genome</div><div class="line">cd ~/disk2/data/reference/genome</div><div class="line">nohup wget http://hgdownload.soe.ucsc.edu/goldenPath/hg19/bigZips/chromFa.tar.gz &amp;</div><div class="line"># 解压，得到所有染色体的信息</div><div class="line">tar -zxvf chromFa.tar.gz</div><div class="line"># 将所有的染色体信息整合在一起，重定向写入hg19.fa文件，得到参考基因组</div><div class="line">cat *.fa &gt; hg19.fa</div><div class="line"># 将多余的染色体信息文件删除，节省空间</div><div class="line">$ rm -rf chr*</div></pre></td></tr></table></figure>
<p>由于下载速度慢，我就改用迅雷下载了，将所有染色体信息整合后，得到新的hg19.fa文件。</p>
<h2 id="什么是参考基因组注释？"><a href="#什么是参考基因组注释？" class="headerlink" title="什么是参考基因组注释？"></a>什么是参考基因组注释？</h2><blockquote>
<p>参考基因组是一部无字天书，要想解读书中的内容，需要额外的注释信息协助。因此下载完参考基因后，就是去gencode数据库（<a href="http://www.gencodegenes.org/)下载基因组注释文件。简单来讲注释文件就是基因组的说明书，告诉我们哪些序列是编码蛋白的基因，哪些是非编码基因，外显子、内含子、UTR等的位置等等。注释文件在以上三个提供参考基因组的网站中都有提供，比如Ensemble。但是现在最权威的人类和小鼠基因组的注释还属Gencode数据库。" target="_blank" rel="external">http://www.gencodegenes.org/)下载基因组注释文件。简单来讲注释文件就是基因组的说明书，告诉我们哪些序列是编码蛋白的基因，哪些是非编码基因，外显子、内含子、UTR等的位置等等。注释文件在以上三个提供参考基因组的网站中都有提供，比如Ensemble。但是现在最权威的人类和小鼠基因组的注释还属Gencode数据库。</a></p>
</blockquote>
<h3 id="参考基因组注释下载"><a href="#参考基因组注释下载" class="headerlink" title="参考基因组注释下载"></a>参考基因组注释下载</h3><p>进入人和小鼠基因组注释信息官网<a href="http://www.gencodegenes.org/" target="_blank" rel="external">GENCODE</a>，选择data-&gt;human-&gt;GRCh37-mapped Releases，下载最新第26版本的hg19人类基因组注释信息。点击进入下载页面，将GTF和GFF3全部下载，解压，如下所示：<br><img src="http://ortxpw68f.bkt.clouddn.com/rnqseqresult15.png" alt=""></p>
<p>可以看到已经有新的参考基因组注释了，不过现在还用老的，跟参考资料中的保持一致一样，单击26，进入下载界面，下载第一行的注释信息，即Comprehensive gene annotaton中的GTF和GFF3，如下所示：</p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/rnqseqresult16.png" alt=""></p>
<h4 id="GFF文件与GTF文件的区别"><a href="#GFF文件与GTF文件的区别" class="headerlink" title="GFF文件与GTF文件的区别"></a>GFF文件与GTF文件的区别</h4><p>GFF全称为general feature format，这种格式主要是用来注释基因组。<br>GTF全称为gene transfer format，主要是用来对基因进行注释。</p>
<h5 id="GFF"><a href="#GFF" class="headerlink" title="GFF"></a>GFF</h5><p>GFF文件是一种用来描述基因组特征的文件，现在我们所使用的大部分都是第三版）（GFF3）。GFF允许使用#作为注释符号，例如很多GFF文件都会使用如下的两行来表明其版本其创建日期：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">##gff-version 2</div><div class="line">##created 11/11/11</div></pre></td></tr></table></figure></p>
<p>GFF文件每一列所代表的含义后面表格中有，但请注意，它的第3列feature type是不受约束的，你可以使用任意的名称。我们需要注意的是GFF文件的第9列，从第二版开始(GFF2)，所有的属性都以标签=值的方式呈现，各个属性之间以;作为分隔符<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ID=geneAExon1;Name=geneA;Parent=geneA;Organism=human</div></pre></td></tr></table></figure></p>
<p>在最新版本的GFF文件中(GFF3)，有一些是已经预先定义的属性特征，并且这些特征往往还有特殊的含义：ID这个标签实在各行都要有的；另外有一个Parent的属性，它表明了当前的特征是Parent特征的子集。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">Contig01  PFAM  gene  501  750  .  +  0  ID=geneA;Name=geneA</div><div class="line">Contig01  PFAM  exon  501  650  .  +  2  ID=exonA1;Parent=geneA</div><div class="line">Contig01  PFAM  exon  700  750  .  +  2  ID=exonA2;Parent=geneA</div></pre></td></tr></table></figure>
<h5 id="GTF"><a href="#GTF" class="headerlink" title="GTF"></a>GTF</h5><p>当前所广泛使用的GTF格式为第二版(GTF2)，它主要是用来描述基因的注释。GTF格式有两个硬性标准：</p>
<ul>
<li>根据所使用的软件的不同，feature types是必须注明的。</li>
<li>第9列必须以gene_id以及transcript_id开头,GTF文件的第9列同GFF文件不同，虽然同样是标签与值配对的情况，但标签与值之间以空格分开，且每个特征之后都要有分号;（包括最后一个特征）</li>
</ul>
<p>列|GTF2|GFF3<br>|:-:|:-:|:-:|<br>|1.reference sequence name|same|same<br>|2.annotation source    |same|    same<br>|3.feature type|    feature requirements depend on software|    can be anything|<br>|4.start coordinate|    same|    same<br>|5. end coordinate    |same    |same<br>|6.score    |not used    |optional<br>|7.strand    |same|    same<br>|8.frame    |same    |same<br>|9.attributes    |空格分隔    |=分隔|</p>
<h2 id="IGV下载及使用"><a href="#IGV下载及使用" class="headerlink" title="IGV下载及使用"></a>IGV下载及使用</h2><p>Integrative Genomics Viewer(IGV)是一种探索大型综合基因组数据的高性能交互式可视化工具。它支持各种各样的数据类型，包括基于芯片测序、二代测序数据和基因组注释数据等。</p>
<h3 id="IGV下载"><a href="#IGV下载" class="headerlink" title="IGV下载"></a>IGV下载</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">wget http://data.broadinstitute.org/igv/projects/downloads/IGV_2.3.97.zip</div><div class="line">unzip IGV_2.3.97.zip &amp;&amp; mv IGV_2.3.97 ~/biosoft</div><div class="line"># 添加环境变量</div><div class="line">vim ~/.bashrc</div><div class="line">PATH=$PATH:~/biosoft/IGV_2.3.97</div><div class="line">source ~/.bashrc</div><div class="line"># 运行IGV，Linux直接运行igv.sh可以开启IGV窗口，但是会比较慢，要耐心等待。</div><div class="line">igv.sh</div></pre></td></tr></table></figure>
<p>如下所示：<br><img src="http://ortxpw68f.bkt.clouddn.com/gene.png" alt=""></p>
<ol>
<li>将gff3进行排序，选择Tools-Run igvtools，进入以下igvtools窗口：</li>
<li>获得sorted文件：command选择sort，再选择输入的注释文件，点击Run，就可以生成sorted.gff3文件。 </li>
<li>通过file-&gt;load from file…选择sorted文件，打开。选择区域的大小，来看某些基因的信息，蓝色的粗线条就是代表基因。说到底，IGV就是一个将基因组及其注释信息可视化的工具。</li>
<li>载入基因组，选择Genome菜单，load我们之前已经下载好的hg19.fa基因组。<br><a href="http://" target="_blank" rel="external"></a><h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2></li>
<li><a href="http://www.jianshu.com/p/48b5a0972301" title="GTF/GFF文件的差异及其相互转换" target="_blank" rel="external">西瓜要吃我：GTF/GFF文件的差异及其相互转换</a></li>
<li><a href="https://mp.weixin.qq.com/s?src=11&amp;timestamp=1506517822&amp;ver=418&amp;signature=QNwxvwkv4bNMDcJz2vUTLviJoBKxkHbGxGJ43uI7BYy-A-mFegoSGjQzA8bAabAaTG8i-UrJUfAN9-urbdwOdAMRKD6YjHdEhSrEwJbFrDju6T-hNaTlF3jyI3GM32yi&amp;new=1" target="_blank" rel="external">从零开始学转录组：了解参考基因组及基因注释</a></li>
<li><a href="http://www.bio-info-trainee.com/1985.html" target="_blank" rel="external">【直播】我的基因组（五）:测试数据及参考基因组的准备</a></li>
<li><a href="https://mp.weixin.qq.com/s?src=11&amp;timestamp=1506519445&amp;ver=418&amp;signature=zsljCkmEwtWskZsTgvrZWMFje3IV1oND44lIkV9hNPFUoDJNlQXu7VHE51HlLImOwXDgcZjHZG9eGoetHpDFjXQiB0qoCfrIt8tw8IUNYwNDPja2pskXJaEfltNzU7Xp&amp;new=1" target="_blank" rel="external">如何下载注释文件并查看基因结构</a></li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2017/10/03/BioInformation/生信-转录组学习笔记03了解fastq测序数据/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/10/03/BioInformation/生信-转录组学习笔记03了解fastq测序数据/" itemprop="url">转录组学习笔记03-了解fastq测序数据</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-10-03T12:00:00+08:00">
                2017-10-03
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/生信实战项目/" itemprop="url" rel="index">
                    <span itemprop="name">生信实战项目</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  3,124
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  12
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="任务："><a href="#任务：" class="headerlink" title="任务："></a>任务：</h2><blockquote>
<p>需要用安装好的sratoolkit把sra文件转换为fastq格式的测序文件，并且用fastqc软件测试测序文件的质量！ 作业，理解测序reads，GC含量，质量值，接头，index，fastqc的全部报告，搜索中文教程，并发在论坛上面。 来源于生信技能树：<a href="http://www.biotrainee.com/forum.php?mod=viewthread&amp;tid=1750#lastpost" target="_blank" rel="external">http://www.biotrainee.com/forum.php?mod=viewthread&amp;tid=1750#lastpost</a></p>
</blockquote>
<h3 id="将sra转换为fastq格式"><a href="#将sra转换为fastq格式" class="headerlink" title="将sra转换为fastq格式"></a>将sra转换为fastq格式</h3><h4 id="sra格式"><a href="#sra格式" class="headerlink" title="sra格式"></a>sra格式</h4><p>下载的原始数据是sra格式，SRA（Sequence ReadArchive）数据库是用于存储二代测序的原始数据，包括 454，Illumina，SOLiD，IonTorrent，Helicos 和 CompleteGenomics。除了原始序列数据外，SRA现在也存在raw reads在参考基因的比对信息。</p>
<h4 id="fastq格式："><a href="#fastq格式：" class="headerlink" title="fastq格式："></a>fastq格式：</h4><p>Fastq格式是一种基于文本的存储生物序列和对应碱基（或氨基酸）质量的文件格式。最初由桑格研究所（Wellcome Trust Sanger Institute）开发出来，现已成为存储高通量测序数据的事实标准。</p>
<h4 id="fastq格式说明"><a href="#fastq格式说明" class="headerlink" title="fastq格式说明"></a>fastq格式说明</h4><p>FASTQ文件中每个序列通常有四行：</p>
<ol>
<li>序列标识以及相关的描述信息，以‘@’开头；后面跟着序列的唯一ID以及相关说明内容。 </li>
<li>第二行是核酸序列，是有ATCGN字符组成</li>
<li>第三行以‘+’开头，后面是序列标示符、描述信息，或者什么也不加</li>
<li>第四行，每个测序碱基质量，是用ASCII码来表示的，与第二行的字符数一致。 碱基质量得分与错误率的换算关系： Q = -10log10p（p表示测序的错误率，Q表示碱基质量分数） ASCII值与碱基质量得分之间的关系： Phred64 Q=ASCII转换后的数值-64 Phred33 Q=ASCII转换后的数值-33</li>
</ol>
<h5 id="一个典型的fastq文件如下所示："><a href="#一个典型的fastq文件如下所示：" class="headerlink" title="一个典型的fastq文件如下所示："></a>一个典型的fastq文件如下所示：</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">@SEQ_ID</div><div class="line">GATTTGGGGTTCAAAGCAGTATCGATCAAATAGTAAATCCATTTGTTCAACTCACAGTTT</div><div class="line">+</div><div class="line">!&apos;&apos;*((((***+))%%%++)(%%%%).1***-+*&apos;&apos;))**55CCF&gt;&gt;&gt;&gt;&gt;&gt;CCCCCCC65</div></pre></td></tr></table></figure>
<blockquote>
<p>如何判断是Phred64 还是 Phred33 ？ ASCII值小于等于58（相应的质量得分小于等于25）对应的字符只有在Phred+33的编码中被使用，所有Phred+64所使用的字符的ASCII值都大于等于59。在通常情况下，ASCII值大于等于74的字符只出现在Phred+64中。如果是最近两年的测序数据，一般都是Phred33形式的。参考文章：<a href="http://blog.csdn.net/huyongfeijoe/article/details/51613827" target="_blank" rel="external">http://blog.csdn.net/huyongfeijoe/article/details/51613827</a></p>
</blockquote>
<h4 id="转换工具：fastq-dump"><a href="#转换工具：fastq-dump" class="headerlink" title="转换工具：fastq-dump"></a>转换工具：fastq-dump</h4><p>将sra格式转换为fastq格式的工具是sratoolkit的fastq-dump，可以先用fastq-dump -h看一下帮助文件，分为如下几个部分：</p>
<blockquote>
<p>输入： -A|—accession 序列号<br>处理中: Read Splitting, Full Spot Filters, Common Filters, Filters based on alignments, Filters for individual reads。 基本都是些过滤参数。不太常用<br>输出： -O|—outdir 输出文件夹， -Z|—stdout 输出到标准输出， —gzip/—bzip2 输出为压缩格式<br>多文件选项： 常用的就是—split-3，split-3表示如果是单端测序则一个sra文件出来一个fastq文件，如果是双末端，则一个sra问件对应两个fastq问件SRRXXXXXX_1.fastq,SRRXXXXXX_2.fastq<br>格式化： 分为序列， 质量等，不常用<br>—gzip 使得输出的结果是.gz 的格式</p>
</blockquote>
<p>现在将disk2/sra下的sra文件转化为fastq格式，其中输入目录为disk2/sra，输出目录为/disk2/data/rna-seq，命令如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">for ((i=56;i&lt;=62;i++))</div><div class="line">do fastq-dump --gzip --split-3 -A ~/disk2/sra/SRR35899$i.sra -O ~/disk2/data/rna-seq</div><div class="line">done</div></pre></td></tr></table></figure>
<p>转换后的结果如下所示：<br><img src="http://ortxpw68f.bkt.clouddn.com/rnqseqfastq.png" alt=""></p>
<h3 id="对fastqc格式进行质控"><a href="#对fastqc格式进行质控" class="headerlink" title="对fastqc格式进行质控"></a>对fastqc格式进行质控</h3><h4 id="工具：Fastqc"><a href="#工具：Fastqc" class="headerlink" title="工具：Fastqc"></a>工具：Fastqc</h4><p>用法如下所示：</p>
<blockquote>
<p>fastqc [-o output dir] [—(no)extract] [-f fastq|bam|sam] [-c contaminant file] seqfile1 .. seqfileN </p>
<ol>
<li>参数： -o 输出目录，需自己创建目录 </li>
<li>—(no)extract 是否解压输出文件，默认是自动解压缩zip文件。加上—noextract不解压文件。 </li>
<li>-f 指定输入文件的类型，支持fastq|bam|sam三种格式的文件，默认自动识别。 </li>
<li>-t 同时处理的文件数目。 </li>
<li>-c 是contaminant 文件，会从中搜索overpresent 序列。</li>
</ol>
</blockquote>
<p>代码如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">mkdir -p ~/disk2/data/QC</div><div class="line">cd ~/disk2/data/rna-seq</div><div class="line"># 将所有的数据进行质控，得到zip的压缩文件和html文件</div><div class="line">fastqc -o ~/disk2/data/QC *.fastq.gz</div></pre></td></tr></table></figure>
<h4 id="质控结果查看："><a href="#质控结果查看：" class="headerlink" title="质控结果查看："></a>质控结果查看：</h4><h5 id="1-质控后的文件如下所示："><a href="#1-质控后的文件如下所示：" class="headerlink" title="1. 质控后的文件如下所示："></a>1. 质控后的文件如下所示：</h5><p><img src="http://ortxpw68f.bkt.clouddn.com/rnqseqqc.png" alt=""></p>
<p>质控结果有14个html文件，可以选择用浏览器打开查看最终的QC reports。随便打开一个质控结果文件，如下所示：</p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/rnaseqqc1.png" alt=""></p>
<h5 id="2-质控报告的内容"><a href="#2-质控报告的内容" class="headerlink" title="2. 质控报告的内容"></a>2. 质控报告的内容</h5><p>左边是目录概要，一共12项内容，如下所示：</p>
<ol>
<li>Basic Statistics</li>
<li>Per base sequence quality</li>
<li>Per tile sequence quality</li>
<li>Per sequence quality scores</li>
<li>Per base sequence content</li>
<li>Per sequence GC content</li>
<li>Per base N content</li>
<li>Sequence Length Distribution</li>
<li>Sequence Duplication Levels</li>
<li>Overrepresented sequences</li>
<li>Adapter Content</li>
<li>Kmer Content</li>
</ol>
<p>可以点击想要看的结果，右边会跳转到特定详细的可视化结果。绿色代表“通过”，黄色代表“警告”，红色代表“不通过，失败”，如下所示：<br><img src="http://ortxpw68f.bkt.clouddn.com/rnaseqresult1.png" alt=""></p>
<h6 id="2-1-Basic-Statistics"><a href="#2-1-Basic-Statistics" class="headerlink" title="2.1 Basic Statistics"></a>2.1 Basic Statistics</h6><p>基本的数据统计包括文件名，文件类型，编码形式，总的序列数，质量差的序列，序列平均长度，GC含量。<br><img src="http://ortxpw68f.bkt.clouddn.com/rnaseqresult2.png" alt=""></p>
<h6 id="2-2-Per-base-sequence-quality"><a href="#2-2-Per-base-sequence-quality" class="headerlink" title="2.2 Per base sequence quality"></a>2.2 Per base sequence quality</h6><p><img src="http://ortxpw68f.bkt.clouddn.com/rnqseqresult3.png" alt=""></p>
<p>图片太大，下部图片如下所示：</p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/rnqseqresult4.png" alt=""><br>上图表示的是每个read各位置碱基的测序质量，具体的理解如下所示：</p>
<ol>
<li>横轴表示碱基的位置，数字就是表示碱基，即1到51个碱基。</li>
<li>纵轴是质量分数，Quality score=-10log10p（p代表错误率），所以当质量分数为40的时候，p就是0.0001，质量算高了。</li>
<li>图中每1个boxplot，都是该位置的所有序列的测序质量的一个统计，上面的bar是90%分位数，下面的bar是10%分位数，箱子的中间的横线是50%分位数，箱子的上边是75%分位数，下边是25%分位数。</li>
<li>红色线代表中位数，蓝色代表平均数的连线，黄色是25%-75%区间，触须是10%-90%区间。若任一位置的下四分位数低于10或者中位数低于25，出现“警告”；若任一位置的下四分位数低于5或者中位数低于20，出现“失败，Fail”。</li>
</ol>
<p>一般要求此图中，所有位置的10%分位数大于20,也就是我们常说的Q20过滤（即质量数低于20的reads清除掉）W。</p>
<h6 id="2-3-Per-tile-sequence-quality"><a href="#2-3-Per-tile-sequence-quality" class="headerlink" title="2.3 Per tile sequence quality"></a>2.3 Per tile sequence quality</h6><p><img src="http://ortxpw68f.bkt.clouddn.com/rnaseqresult5.png" alt=""></p>
<p>检查reads中每一个碱基位置在不同的测序小孔之间的偏离度，蓝色代表偏离度小，质量好，越红代表偏离度越大，质量越差。纵轴是tail的Index编号。<br>这个图主要是为了防止，在测序过程中，某些tail受到不可控因素的影响而出现测序质量偏低。蓝色代表测序质量很高，暖色代表测序质量不高，如果某些tail出现暖色，可以在后续分析中把该tail测序的结果全部都去除</p>
<h6 id="2-4-Per-sequence-quality-scores，reads"><a href="#2-4-Per-sequence-quality-scores，reads" class="headerlink" title="2.4 Per sequence quality scores，reads"></a>2.4 Per sequence quality scores，reads</h6><p>质量的分布，当峰值小于27时，警告；当峰值小于20时，fail。可以看出这个测序的报告峰值在38左右。<br>假如我测的1条序列长度为101bp，那么这101个位置每个位置Q之的平均值就是这条reads的质量值。该图横轴是0-40，表示Q值，纵轴是每个值对应的reads数目</p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/rnaseqresult6.png" alt=""></p>
<h6 id="2-5-Per-base-sequence-content"><a href="#2-5-Per-base-sequence-content" class="headerlink" title="2.5 Per base sequence content"></a>2.5 Per base sequence content</h6><p>对所有reads的每一个位置，统计ATCG四种碱基的分布，横轴为位置，这里是1-51bp，纵轴为碱基含量（百分数），正常情况下每个位置每种碱基出现的概率是相近的，四条线应该平行且相近。当部分位置碱基的比例出现bias时，即四条线在某些位置纷乱交织，往往提示我们有overrepresented sequence的污染。本结果前10个位置，每种碱基频率有明显的差别，说明有污染。当任一位置的A/T比例与G/C比例相差超过10%，报”WARN”；当任一位置的A/T比例与G/C比例相差超过20%，报”FAIL”。<br>理论上来说，A和T应该相等，G和C应该相等，但是一般测序的时候，刚开始测序仪状态不稳定，很可能出现上图的情况。像这种情况，即使测序的得分很高，也需要cut开始部分的序列信息，一般遇到到这种情况，会cut前面5bp。</p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/rnqseqresult7.png" alt=""></p>
<h6 id="2-6-Per-Sequence-GC-Content"><a href="#2-6-Per-Sequence-GC-Content" class="headerlink" title="2.6 Per Sequence GC Content"></a>2.6 Per Sequence GC Content</h6><p>统计reads的平均GC含量的分布。横轴是0 - 100%； 纵轴是每条序列GC含量对应的数量。红线是实际情况，蓝线是理论分布（正态分布，均值不一定在50%，而是由平均GC含量推断的），两个应该比较接近才比较好。 曲线形状的偏差往往是由于文库的污染或是部分reads构成的子集有偏差（overrepresented reads）。形状接近正态但偏离理论分布的情况提示我们可能有系统偏差。偏离理论分布的reads超过15%时，报”WARN”；偏离理论分布的reads超过30%时，报”FAIL”。当红色的线出现双峰，基本肯定是混入了其他物种的DNA序列。这张图中的信息良好。</p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/rnqseqresult8.png" alt=""></p>
<h6 id="2-7-Per-base-N-content"><a href="#2-7-Per-base-N-content" class="headerlink" title="2.7 Per base N content"></a>2.7 Per base N content</h6><p>当测序仪器不能辨别某条reads的某个位置到底是什么碱基时，就会产生“N”，统计N的比率。正常情况下，N值非常小。当任意位置的N的比例超过5%，报”WARN”；当任意位置的N的比例超过20%，报”FAIL”。<br><img src="http://ortxpw68f.bkt.clouddn.com/rnqseqresult9.png" alt=""></p>
<h6 id="2-8-Sequence-Length-Distribution"><a href="#2-8-Sequence-Length-Distribution" class="headerlink" title="2.8 Sequence Length Distribution"></a>2.8 Sequence Length Distribution</h6><p>reads长度分布，每次测序仪测出来的长度在理论上应该是完全相等的，但是总会有一些偏差。比如此图中，51bp是主要的，但是还是有少量的50和52的长度，不过数量比较少，不影响后续分析。当测序的长度不同时，如果很严重，则表明测序仪在此次测序过程中产生的数据不可信。当reads长度不一致时报”WARN”；当有长度为0的read时报“FAIL”。</p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/rnqseqresult10.png" alt=""></p>
<h6 id="2-9-Sequence-Duplication-Levels"><a href="#2-9-Sequence-Duplication-Levels" class="headerlink" title="2.9 Sequence Duplication Levels"></a>2.9 Sequence Duplication Levels</h6><p>统计不同拷贝数的reads的频率。测序深度越高，越容易产生一定程度的duplication，这是正常的现象，但如果duplication的程度很高，就提示我们可能有bias的存在。横坐标是duplication的次数，纵坐标是duplicated reads的数目，以unique reads的总数作为100%。下图中，横坐标表示序列重复水平；纵坐标代表重复水平序列占所有序列的百分比。下图中大于10个重复的reads占总序列的20%以上，其他依次类推。当非unique的reads占总数的比例大于20%时，报”WARN”；当非unique的reads占总数的比例大于50%时，报”FAIL“。</p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/rnqseqresult11.png" alt=""></p>
<h6 id="2-10-Overrepresented-sequences"><a href="#2-10-Overrepresented-sequences" class="headerlink" title="2.10 Overrepresented sequences"></a>2.10 Overrepresented sequences</h6><p>一条序列的重复数，因为一个转录组中有非常多的转录本，一条序列再怎么多也不太会占整个转录组的一小部分（比如1%），如果出现这种情况，不是这种转录本巨量表达，就是样品被污染。这个模块列出来大于全部转录组1%的reads序列，但是因为用的是前200,000条，所以其实参考意义不大，完全可以忽略。</p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/rnqseqresult12.png" alt=""></p>
<h6 id="2-11-Adapter-content"><a href="#2-11-Adapter-content" class="headerlink" title="2.11 Adapter content"></a>2.11 Adapter content</h6><p>接头含量。①此图衡量的是序列中两端adapter的情况；②如果在当时fastqc分析的时候-a选项没有内容，则默认使用图例中的四种通用adapter序列进行统计；③本例中adapter都已经去除，如果有adapter序列没有去除干净的情况，在后续分析的时候需要先使用cutadapt软件进行去接头。</p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/rnqseqresult13.png" alt=""></p>
<h6 id="2-12-Kmer-content"><a href="#2-12-Kmer-content" class="headerlink" title="2.12 Kmer content"></a>2.12 Kmer content</h6><p><img src="http://ortxpw68f.bkt.clouddn.com/rnqseqresult14.png" alt=""><br>①这个图统计的是，在序列中某些特征的短序列重复出现的次数；② 我们可以看到1-8bp的时候图例中的几种短序列都出现了非常多的次数，一般来说，出现这种情况，要么是adapter没有去除干净，而又没有使用-a参数；要么就是序列本身可能重复度比较高，如建库PCR的时候出现了bias；④ 对于这种情况，我的办法是可以cut掉前面的一些长度，可以试着cut 5~8bp</p>
<h3 id="批量质控结果查看MultiQC"><a href="#批量质控结果查看MultiQC" class="headerlink" title="批量质控结果查看MultiQC"></a>批量质控结果查看MultiQC</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"># 安装multiqc</div><div class="line">$ conda install -c bioconda multiqc</div><div class="line"># 测试</div><div class="line">$ multiqc --help</div><div class="line"># 进入存放QC结果的文件夹，空白处右键“在终端打开”</div><div class="line"></div><div class="line"># 扫描结果文件，忽略html文件</div><div class="line">$ multiqc ./*fastqc.zip --ignore *.html</div><div class="line"># 最后会默认生成一个名为multiqc_report.html文件，用浏览器查看</div></pre></td></tr></table></figure>
<p>参考资料：<br><a href="https://zhuanlan.zhihu.com/p/20731723" target="_blank" rel="external">孟浩巍.20160410 测序分析——使用 FastQC 做质控</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2017/10/02/BioInformation/生信-转录组学习笔记02-读文章获取测序数据/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/10/02/BioInformation/生信-转录组学习笔记02-读文章获取测序数据/" itemprop="url">转录组学习笔记02-读文献下载测序数据</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-10-02T12:00:00+08:00">
                2017-10-02
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/生信实战项目/" itemprop="url" rel="index">
                    <span itemprop="name">生信实战项目</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  1,984
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  8
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="任务目标："><a href="#任务目标：" class="headerlink" title="任务目标："></a>任务目标：</h2><blockquote>
<p>本系列课程学习的文章是：AKAP95 regulates splicing through scaffolding RNAs and RNA processing factors. Nat Commun 2016 Nov 8;7:13347. PMID: 27824034 很容易在文章里面找到数据地址GSE81916 这样就可以下载sra。</p>
</blockquote>
<h2 id="文章主要内容"><a href="#文章主要内容" class="headerlink" title="文章主要内容"></a>文章主要内容</h2><h3 id="测序物种"><a href="#测序物种" class="headerlink" title="测序物种"></a>测序物种</h3><p>人类，小鼠；</p>
<h3 id="实验类型"><a href="#实验类型" class="headerlink" title="实验类型"></a>实验类型</h3><p>高通量测序</p>
<h3 id="摘要"><a href="#摘要" class="headerlink" title="摘要"></a>摘要</h3><p>pre-mRNA的可变剪切与高等生物基因表达的复杂性有关，但是可变剪切位点的选择却未研究清楚。作者在以前的研究中发现了一个染色质相关的蛋白AKAP95（AKAP8）在强化染色质转录方向有着明显的影响。在本文的研究中，APAKP95能与许多涉及转录和RNA加工的因子相互作用，调节pre-mRNA的剪接。AKAP95直接促进内源基因FAM126A的特异性外显子的体外剪接和包含。 AKAP95N-末端富含YG的结构域在与RNA加工因子（例如hnRNP蛋白）结合的过程中有着重要的作用，它的锌指结构域对于pre-mRNA的结合至关重要。基因组结合的分析显示，AKAP95优先结合人类转录组中大量pre-mRNA的近端内含子区域，AKAP95的敲除能导致多外显子增加的减少。AKAP95还可以选择性地协调hnRNP H/ F和U蛋白来调节可变剪接事件。进一步表明，AKAP95与自身直接相互作用。总之，实验的研究结果表明，AKAP95是pre-mRNA剪接的新型，并且是正向调节因子，它有可能是一个转录和剪接调节整合子，并且实验提出了一个模型，即AKAP95通过支架RNA和RNA加工因子调节pre-mRNA剪接，并促进剪接位点之间的信息交流。</p>
<p>原英文摘要：</p>
<blockquote>
<p>Alternative splicing of pre-mRNAs significantly contributes to the complexity of gene expression in higher organisms, but the regulation of the splice site selection remains incompletely understood. We have previously demonstrated that a chromatin-associated protein, AKAP95 (AKAP8), has a remarkable activity in enhancing chromatin transcription. In this study, we have shown that AKAP95 physically interacts with many factors involved in transcription and RNA processing, and functionally regulates pre-mRNA splicing. AKAP95 directly promotes splicing in vitro and the inclusion of a specific exon of an endogenous gene FAM126A. The N-terminal YG-rich domain of AKAP95 is important for its binding to RNA processing factors including selective groups of hnRNP proteins, and its zinc finger domains are critical for pre-mRNA binding. Genome-wide binding assays revealed that AKAP95 bound preferentially to proximal intronic regions on a large number of pre-mRNAs in human transcriptome, and AKAP95 depletion predominantly resulted in reduced inclusion of many exons. AKAP95 also selectively coordinates with hnRNP H/F and U proteins in regulating alternative splicing events. We have further shown that AKAP95 directly interacts with itself. Taken together, our results establish AKAP95 as a novel and mostly positive regulator of pre-mRNA splicing and a possible integrator of transcription and splicing regulation, and support a model that AKAP95 regulates pre-mRNA splicing via through scaffolding RNAs and RNA processing factors and facilitating the splice site communication.</p>
</blockquote>
<h3 id="样本信息"><a href="#样本信息" class="headerlink" title="样本信息"></a>样本信息</h3><p>样本1-8是RIP-seq的数据，研究的是AKAP95与转录组的结合，样本9-15是mRNA-seq的数据，研究的是在293细胞或小鼠ES细胞中敲减了AKAP95的数据（其中9-11是293细胞的数据，有3个，12-15是小鼠ES细胞的数据，有4个）。</p>
<h3 id="文章思路"><a href="#文章思路" class="headerlink" title="文章思路"></a>文章思路</h3><p>1.AKAP95的N末端区域参与该蛋白与RNA加工因子的结合，这些RNA加工因子包括hnRNPs。<br>2.APAK95与许多RNA加工因子的结合暗示了AKAP95在RNA加工方面发挥了作用，这些作用包括pre-RNA剪接。实验结果表明，AKAP95直接调控minigene pre-mRNA剪接，AKAP95的N末端与ZFs是其功能发挥的结构域。<br>3.为了寻找AKAP95剪接调控的内源靶点。经过一系列实验表明：AKAP95和hnRNP F参与调节FAM126A外显子11的剪接（实验中提到了敲减AKAP95后，FAM126A的外显子11会被跳过，而在野生型中则正常剪接）。<br>4.利用深度测序的方法寻的找内源AKAP95与人类转录组的结合。测序手段是RIP，其结果是发现AKAp95能与pre-mRNAs结合。<br><strong>5. （核心，也就是这个笔记学习的部分）问题：评估AKAP95对可变剪接的全局影响，实验手段是：①人类294细胞和小鼠ES细胞中敲减了AKAP95基因-&gt;②RNA-seq-&gt;③DEXseq分析。</strong>AKAP95的敲减会导致更多的外显子使用（exon）减少，这表明AKAP95会全局促进外显子增加（exon inclusion）。看文献我的理解是，有了AKAP95基因后，该基因的表达产物会导致FAM126A的外显子10，11，12连接起来，如果敲低了AKAP95这个基因，FAM126A的外显子10与12连接起来，会跳过外显子11。因此AKAP95的功能就在于调节FAM126A的可变剪接。exon inclusion我的理解是，外显子的利用，以此文献为例说明，exon inclusion指的就是FAM126A的外显子11的利用，AKAP95会促进AKAP95外显子11的利用，如果没有AKAP95，则FAM126A的外显子10就会跳过外显子11，与外显子12连接起来，exon inclusion就降低。<br>6.后续的实验作者又研究了AKA95的一些作用机理，略。</p>
<h3 id="文章结果"><a href="#文章结果" class="headerlink" title="文章结果"></a>文章结果</h3><h4 id="a-b图"><a href="#a-b图" class="headerlink" title="a.b图"></a>a.b图</h4><p>a图是火山图。火山图常用于展示显著差异表达的基因，这里有两个关键词：显著是指P<0.05，差异表达一般我们按照fold change(倍数变化)="">=2.0作为标准。<br>当我们拿到基因表达的P值和倍数后，为了用火山图展示结果，一般需要把倍数进行Log2的转化（下图a的x轴），比如某基因在实验组表达水平是对照组的4倍，log2（4）=2，同样的如果是1/4，也就是0.25，转换后的结果就是-2。<br>P值进行-log10的转化，-log10（0.01）约等于2，由于P值越小表示越显著，所以我们进行-log10（P value）转化后，转化值越大表示差异约显著，比如-log10（0.001）=3  &gt;  -log10(0.01)=2 &gt;  -log10(0.05)=1.30（下图a的y轴）。<br><img src="http://ortxpw68f.bkt.clouddn.com/rnaseq001a.png" alt=""><br>火山图有三种颜色，黄色与红色都是Padj小于0.01的基因（P值经过了FDR校正，即false discovery rate）。红色又表示基因变化超过2倍的基因。b图是饼图，它表示外显子使用(exon usage)的增加与降低数目。</0.05，差异表达一般我们按照fold></p>
<h4 id="c-d图"><a href="#c-d图" class="headerlink" title="c.d图"></a>c.d图</h4><p><img src="http://ortxpw68f.bkt.clouddn.com/rnaseq002a.png" alt=""></p>
<h4 id="e图"><a href="#e图" class="headerlink" title="e图"></a>e图</h4><p><img src="http://ortxpw68f.bkt.clouddn.com/rnaseq003a.png" alt=""></p>
<h4 id="f图"><a href="#f图" class="headerlink" title="f图"></a>f图</h4><p><img src="http://ortxpw68f.bkt.clouddn.com/rnaseq004a.png" alt=""></p>
<h3 id="文章所用的生信方法"><a href="#文章所用的生信方法" class="headerlink" title="文章所用的生信方法"></a>文章所用的生信方法</h3><p>在后文的Bioinformatic analyses部分</p>
<h4 id="比对"><a href="#比对" class="headerlink" title="比对"></a>比对</h4><p>比对软件：TopHat (v2.0.13)<br>参考基因组：human reference genome (GRCh37/hg19)<br>GTF文件： GTF version GRCh37.70<br>只保留MQ &gt;30的map结果<br>Picard-tools (v1.126)： 计算平均插入大小(mean insert sizes)和标准差<br>read count: 软件：HTSeq v0.6.0</p>
<h4 id="差异表达分析"><a href="#差异表达分析" class="headerlink" title="差异表达分析"></a>差异表达分析</h4><p>DESeq (v3.0)<br>DEXSeq (v3.1)</p>
<h4 id="富集分析"><a href="#富集分析" class="headerlink" title="富集分析"></a>富集分析</h4><p>GO分析：DAVID (<a href="http://david.ncifcrf.gov/" target="_blank" rel="external">http://david.ncifcrf.gov/</a>)</p>
<h1 id="数据下载"><a href="#数据下载" class="headerlink" title="数据下载"></a>数据下载</h1><p>进入NCBI的GEO数据库<a href="https://www.ncbi.nlm.nih.gov/geo/" target="_blank" rel="external">https://www.ncbi.nlm.nih.gov/geo/</a><br>搜索GSE81916，如下所示：<br><img src="http://ortxpw68f.bkt.clouddn.com/RNAseq001.png" alt=""></p>
<p>输入GSE81916，单击Search即可，见到数据说明及下载页面，如下所示：</p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/rnaseq002c.png" alt=""></p>
<p>下面有一段话是对这些数据的描述，即：</p>
<p>&gt;</p>
<blockquote>
<p>Overall design    Samples 1-8 are RNA-immunoprecipitation &gt; (RIP)-seq to determine AKAP95 binding to the<br>transcriptome. Samples 9-15 are mRNA-seq to determine<br>effect of AKAP95 knockdown in human 293 cells (9-11) or &gt; mouse ES cells (12-15).</p>
</blockquote>
<p>大意就是样本9-15是mRNA-seq的数据，而样本1-8是RNA免疫组化的数据。我们只需要9-15的数据，单击红框链接即可进入数据下载页面，如下所示：</p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/rnaseq002d.png" alt=""></p>
<p>单击第一行的SRP/SRP075/SRP075747右侧的ftp，即可进入数据下载界面：<br><img src="http://ortxpw68f.bkt.clouddn.com/rnaseq003.png" alt=""></p>
<p>现在下载SRR3589956-SRR3589962的7个数据（3个人类，4个小鼠），命令如下：</p>
<p>此命令是将数据下载到disk2/sra的目录下，</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">cd ~/disk2 &amp;&amp; mkdir sra</div><div class="line">for ((i=56;i&lt;=62;i=i++));do wget ftp://ftp-trace.ncbi.nlm.nih.gov/sra/sra-instant/reads/ByStudy/sra/SRP/SRP075/SRP075747/SRR35899$i/SRR35899$i.sra ;done</div></pre></td></tr></table></figure>
<p>当时觉得数据下载慢，我就直接用迅雷下载了，数据下载后如下所示：<br><img src="http://ortxpw68f.bkt.clouddn.com/rnaseq004.png" alt=""></p>
<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><ol>
<li><a href="https://mp.weixin.qq.com/s?src=11&amp;timestamp=1507359643&amp;ver=437&amp;signature=cWtmQqrEoi7fnwdGF63u2mcQ0P6cJpcV4aDJ6AHHSJBEDxuP2Wb65am9apJEQaPs1U6NBoVE5EJ0XK1MEatZyKjd9OlDcpEB0T3-abbjsFTl01OZznhVOV-eQh1gW8n1&amp;new=1" target="_blank" rel="external">浙大植物学小白的转录组笔记</a></li>
<li><a href="http://www.jianshu.com/p/d717957828c8" target="_blank" rel="external">转录组入门（2）：读文章拿到测序数据</a></li>
<li><a href="https://mp.weixin.qq.com/s?src=11&amp;timestamp=1507611528&amp;ver=443&amp;signature=s4y*meB6oWf0zVZIxQ9EEpNJ5P0whexjL2DcoTcwbgYBOqzhv-2jZk2U86FRlrGFW*6XSnTwgcVLt7HXwvLGWSF9z4qErLcHhdtjy6V0Qz3fa*VQAmLJGou2QXklqI-a&amp;new=1" target="_blank" rel="external">如何看懂和绘制火山图？</a></li>
<li><a href="https://mp.weixin.qq.com/s?src=3&amp;timestamp=1507708087&amp;ver=1&amp;signature=sDBGiyaFarX9G5wtSOQZmeNuqVjXrtAwT3TPqeKPH3B9tyOi4-U3kaq2-5g6xncNA1WKDJrGvJdfB995Br2sSem-IImvEgNWliDhuFDKxHojoVe5DioWWgBDBR7xLSWz-yUqZnnXKXLamRkn598rPLLCf5fRp-0KTirlcjpl1fw=" target="_blank" rel="external">人气推文p值、E值、FDR、q值…你晕菜了吗？续集来啦！</a></li>
<li><a href="https://mp.weixin.qq.com/s?src=3&amp;timestamp=1507708087&amp;ver=1&amp;signature=YQpqTHl4WpYahQH2jvnkPWMm3-T9BnyoL5l9GZy2AhftTiyYF6Oq7lLBfskA8f6Po3rBZY4qSWogpaGi233BtEoRvexLfcbp-PcbWjrKu-XduuIMh136EjzWY*57k9brIInLLwcPx*QLsHkpvkiOHHMv-SrKCyVPf38TWe-Dl70=" target="_blank" rel="external">揭秘：FDR背后的真相</a></li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/6/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/6/">6</a><span class="page-number current">7</span><a class="page-number" href="/page/8/">8</a><span class="space">&hellip;</span><a class="page-number" href="/page/10/">10</a><a class="extend next" rel="next" href="/page/8/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">RVDSD</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">94</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">9</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">83</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          <div class="links-of-author motion-element">
            
          </div>

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

<div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">RVDSD</span>

  
</div>



<div class="powered-by">
<i class="fa fa-user-md"></i><span id="busuanzi_container_site_uv">
  本站访客数:<span id="busuanzi_value_site_uv"></span>
</span>
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.3</div>




<div class="theme-info">
  <div class="powered-by"></div>
  <span class="post-count">博客全站共314.9k字</span>
</div>

        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.3"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.3"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.3"></script>



  


  




	





  





  










  
  <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/valine@1.1.4/dist/Valine.min.js"></script>
  <script type="text/javascript">
    new Valine({
        av: AV,
        el: '#vcomments' ,
        verify: true,
        notify: true,
        app_id: '4ORLDMxXCFDLSHPJ4wSSDkkw-gzGzoHsz',
        app_key: 'HSWpCY7XlN0pGV5DCrKoC0ic',
        placeholder: 'Comment input placeholder'
    });
  </script>



  





  

  

  
  

  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config("");
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="custom_mathjax_source">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->
  


  

  

</body>
</html>
