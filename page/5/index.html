<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.3" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.3">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.3" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta property="og:type" content="website">
<meta property="og:title" content="RVDSD的个人笔记本">
<meta property="og:url" content="http://rvdsd.top/page/5/index.html">
<meta property="og:site_name" content="RVDSD的个人笔记本">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="RVDSD的个人笔记本">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.3',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://rvdsd.top/page/5/"/>





  <title>RVDSD的个人笔记本</title><!-- hexo-inject:begin --><!-- hexo-inject:end -->
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">RVDSD的个人笔记本</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">学习过程中的输出</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2018/08/18/BioStatistics/生物统计-15判别分析/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/08/18/BioStatistics/生物统计-15判别分析/" itemprop="url">判别分析笔记</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-08-18T12:02:00+08:00">
                2018-08-18
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/生物统计/" itemprop="url" rel="index">
                    <span itemprop="name">生物统计</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  1,316
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  5
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="前言">前言</h2>
<p>一般的回归是指因变量为定量变量的情况，而logistic回归主要处理因变量为只取两个值的定性变量情况。如果作为因变量的定性变量取多于两个值的时候，就需要使用线性判别分析(linear discriminant analysis)来处理。判别分析根据自变量来预测因变量的类型。</p>
<h2 id="判别分析原理">判别分析原理</h2>
<p>差别分析是利用部分已知类别的观测数据来建立模型，这样的数据称为训练集(training set)。我们这里介绍的线性判别分析所得到的模型是一组线性差别公式；每个公式是自变量的一个线性组合；公式的个数和类别数目一样。有了公式之后，就可以把每个未知类别的自变量观测值代入那些差别公式，算出和类别一样多的值；相应于哪一类的值最大，则把该观测值判为属于该类。</p>
<p>判别分析的原理并不复杂，可以简单地描述如下。</p>
<p>如果作为属性变量的因变量有k个预付（即观测值应该分成k个类），而自变量包含p个变量，那么每一个观测值就是p维空间的一个点。整个训练集的各个点（假定有n个点）就按照已知的类别在p维空间中形成共有n个点的k个点群。那么，对于一个未知类别的点，如果离哪一群近，就可以分到哪一集。关键的细节问题是如何定义“远近”或距离。关键是确定一些准则，使得每一个点群内部的点接近，而使各群之间尽量分开。不同的准则造就了不同的差别或分类方法。这里不讨论这些方法的数学细节，这里仅仅就是线性差别分析一种方法，介绍如何通过R得到结果及结果的解释。这里先把p维空间的点按照最能够分开各类的原则投影到二维空间，再根据二维空间这些点的分布得到判别函数。</p>
<p>如何来确定判别分析模型的效果呢？最基本的就是用一个没有参加建模的已知观测值类别的数据来验证。这样的数据集称为测试集或检验集(test set)。把通过模型预测的这些观测值的类别和它们已知的类别比较，就知道有多少划分错了，由此可以计算出误差来。</p>
<h2 id="案例分析">案例分析</h2>
<p>R自带了一个数据集，即<code>iris</code>。这是一个鸢尾花(iris)的数据，该数据给出了150个鸢尾花的萼片长(sepal length)、萼片宽(sepal width)、花瓣长(petal length)、花瓣宽(petal width)以及这些花的种类(Species)这五个变量。萼片和花瓣的长宽是四个定量变量，而各类为分类变量（有3个值，为setosa、versicolour、virginica）。现在，我们建立一个模型，根据萼片和花瓣这四个度量来把鸢尾花进行分类，这里的鸢尾花一共有3种，每种都有50个观测值。</p>
<p>现在我们在每种鸢尾花中也能耐选择一半，也就是25个作为测试集，另外25个用来建模。三种鸢尾花一起，训练集和测试集各有75个观测。由于选择测试集和训练集的过程是随机的，每次计算的结果也不相同，在R软件中，对于不同的成随机数种子，我们得到的结果也不尽相同。下面是对两个随机数种子得到的两个测试集判别结果，每个格子中的数目是相应的真实类的观测被划分到预测类的频数，如下所示：</p>
<p>随机种子数：set.seed(5)</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">library</span>(MASS)</div><div class="line">set.seed(<span class="number">5</span>)</div><div class="line">samp &lt;- c(sample(<span class="number">1</span>:<span class="number">50</span>,<span class="number">25</span>),sample(<span class="number">51</span>:<span class="number">100</span>,<span class="number">25</span>),sample(<span class="number">101</span>:<span class="number">150</span>,<span class="number">25</span>))</div><div class="line">a &lt;- lda(Species~.,data=iris,shuset=samp)</div><div class="line">summary(predict(a,iris[-samp,])$class)</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&gt; summary(predict(a,iris[-samp,])$class)</div><div class="line">    setosa versicolor  virginica </div><div class="line">        25         25         25</div></pre></td></tr></table></figure>
<p>随机种子数：set.seed(4)</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">library</span>(MASS)</div><div class="line">set.seed(<span class="number">4</span>)</div><div class="line">samp &lt;- c(sample(<span class="number">1</span>:<span class="number">50</span>,<span class="number">25</span>),sample(<span class="number">51</span>:<span class="number">100</span>,<span class="number">25</span>),sample(<span class="number">101</span>:<span class="number">150</span>,<span class="number">25</span>))</div><div class="line">a &lt;- lda(Species~.,data=iris,shuset=samp)</div><div class="line">summary(predict(a,iris[-samp,])$class)</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&gt; summary(predict(a,iris[-samp,])$class)</div><div class="line">    setosa versicolor  virginica </div><div class="line">        25         23         27</div></pre></td></tr></table></figure>
<p>由这两个结果可知，在第一个随机种子下（set.seed(5)）下，测试集中的每个类别完全划分正确，在第二个随机种子下（set.seed(4)），错误地划分了4个类别，出错率为4/75。</p>
<p>下图是在建立线性差别函数过程中，把75个训练集的四维空间点投影到二维空间的结果：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">library</span>(mda)</div><div class="line">z&lt;-fda(Species~.,data=iris[samp,])$fit$fitted</div><div class="line">plot(z,pch=c(rep(<span class="number">19</span>,<span class="number">25</span>),rep(<span class="number">2</span>,<span class="number">25</span>),rep(<span class="number">8</span>,<span class="number">25</span>)),xlab=<span class="string">""</span>,ylab=<span class="string">""</span>)</div></pre></td></tr></table></figure>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180819/HJDbc61Eim.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>可以看也，setosa（用实心圆点标记）离另外两种很远，而versicolor（用空心三角形标记）和virginica（用星号标记）这两类则离得比较近，容易划分错，我们从第二个随机种子（set.seed(4)）中也能看出来，出错的应时这两类。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2018/08/18/Linux/Linux命令收集/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/08/18/Linux/Linux命令收集/" itemprop="url">Linux命令收集</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-08-18T12:00:00+08:00">
                2018-08-18
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Linux/" itemprop="url" rel="index">
                    <span itemprop="name">Linux</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  136
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  1
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="下载">下载</h3>
<p><code>curl</code>，用法如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">curl http://downloads.yeastgenome.org/curation/chromosomal_feature/saccharomyces_cerevisiae.gff -o sc.gff</div></pre></td></tr></table></figure>
<p>这个命令是将某个URL的信息下载下来，并通过<code>-o</code>参数，将其输出到<code>sc.gff</code>文件中，其中,<code>-progress</code>是显示进度条，这个是选用的。</p>
<p><code>prefetch</code></p>
<h3 id="查看文件">查看文件</h3>
<p><code>ls</code></p>
<h2 id="文本相关">文本相关</h2>
<h3 id="文本统计">文本统计</h3>
<p><code>wc</code></p>
<h3 id="文本排序">文本排序</h3>
<p><code>sort</code></p>
<h3 id="去重">去重</h3>
<p><code>unique</code></p>
<h3 id="查看文本">查看文本</h3>
<p><code>head</code></p>
<p><code>tail</code></p>
<p><code>less</code></p>
<p><code>more</code></p>
<p><code>cat</code></p>
<h3 id="正则表达式">正则表达式</h3>
<p><code>grep</code></p>
<p><code>awk</code></p>
<p><code>sed</code></p>
<hr>
<h2 id="文件操作">文件操作</h2>
<h3 id="查找文件">查找文件</h3>
<p><code>find</code></p>
<p><code>locate</code></p>
<h3 id="压缩">压缩</h3>
<p><code>unzip</code></p>
<hr>
<h3 id="目录操作">目录操作</h3>
<p>切换目录：<code>cd</code></p>
<p>新建目录：<code>mkdir</code></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2018/08/17/Linux/Linux文档的查阅/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/08/17/Linux/Linux文档的查阅/" itemprop="url">Linux文档的查阅</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-08-17T12:00:00+08:00">
                2018-08-17
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Linux/" itemprop="url" rel="index">
                    <span itemprop="name">Linux</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  0
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  1
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2018/07/14/BioStatistics/0统计学与数学书籍汇总/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/07/14/BioStatistics/0统计学与数学书籍汇总/" itemprop="url">统计学与数学书籍汇总</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-07-14T12:10:54+08:00">
                2018-07-14
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/生物统计/" itemprop="url" rel="index">
                    <span itemprop="name">生物统计</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  2,420
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  8
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="前言">前言</h2>
<p>我觉得统计学的知识点很碎，仅看一本书是不太容易学好统计学的，这篇笔记就介绍几本有关统计学的书，这些书是我看过的，也有正在看的，也有看了一部分太难理解放弃的，我大致按照由易到难的顺序列出了几本（当然还有很多优秀的书没看过，就没列出来），这些书可以在京东或淘宝上买到，大部分书也可以通过搜索引擎找到相应下载的地方，考虑到知识产权的问题，这里不提供PDF版的书籍下载地址。</p>
<h2 id="零基础">零基础</h2>
<h4 id="漫画统计学入门">《漫画统计学入门》</h4>
<p>作者: 拉里-戈尼克 / 沃尔科特-史密斯 出版社: 辽宁教育出版社 ，译者: 梁杰，出版年: 2002-1</p>
<p>这本书就是以漫画的形式把统计学原理给讲了一下，非常适合零基础的人入门，没有复杂的公式，可以从直观上克服对统计学的那种畏惧心理，但是如果要深入理解统计学，这本书远远不够。</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180920/205H40fcDI.jpg?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h4 id="漫画统计学">《漫画统计学》</h4>
<p>作者: [日] 高桥信 ，出版社: 科学出版社，原作名: マンガでわかる統計学，译者: 陈刚 ，出版年: 2009-8</p>
<p>这本书跟《漫画统计学入门》类似，这本书只讲了统计学的一些基本原理，这本书是一个叫欧姆社系列漫画书中的一本，其余有关统计的书还有《漫画统计学之因子分析》，《漫画统计学之回归分析》，与数学有关的书有《漫画微分方程》《漫画线性代数》。</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180920/jJ5kj241AA.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h4 id="女士品茶">《女士品茶》</h4>
<p>作者: 萨尔斯伯格 出版社: 中国统计出版社 副标题: 20世纪统计怎样变革了科学 原作名: The Lady Tasting Tea: How Statistics Revolutionized Science in the Twentieth Century 译者: 邱东等 出版年: 2004-11-01</p>
<p>这本书以某位喝茶的英国女士的假设学说为起点，写了数理统计学历史中的一些大牛，例如戈塞物，费歇尔，皮尔逊等一大批牛人的统计学故事，这本书其实不算作是统计学书，更像是统计学的科普书。对于提高统计学方面的兴趣的思维还是比较有好处的。</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180920/fd14HLgh90.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h2 id="入门">入门</h2>
<h4 id="白话统计">《白话统计》</h4>
<p>《白话统计》，冯国双，2018，电子工业出版社。</p>
<p>2018年的新书，没有复杂的公式，非常简单，能把统计学原理以最浅显的语言给讲出来，比较适合那些没有太多数学基础的同学，不过要深入理解统计学，这本书还是不够。我觉得这本书更适合作为统计学教材（例如孙振球的《医学统计学》）的辅助用书。</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180920/6I06L1J3KF.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h4 id="深入浅出统计学">《深入浅出统计学》</h4>
<p>《深入浅出统计学》，DawnGriffiths. 深入浅出统计学[M]. 电子工业出版社, 2012.</p>
<p>本书涵盖的知识点包括：信息可视化、概率计算、几何分布、二项分布及泊松分布、正态分布、统计抽样、置信区间的构建、假设检验、卡方分布、相关于回归等等， 没有太多数学公式，很好理解。</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180920/3cB4B0BaaG.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h4 id="深入浅出数据分析">《深入浅出数据分析》</h4>
<p>作者MichaelMilton. 深入浅出数据分析[M]. 电子工业出版社, 2010.</p>
<p>这本书可以与《深入浅出统计学》配合使用，可以看作是前一本的升级版。</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180920/biI99liiCc.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h4 id="行为科学统计">《行为科学统计》</h4>
<p>《行为科学统计》，作者是 [美] F·J·Gravetter / [美] L·B·Wallnau，中文貌似最新的只有第7版，第7版是2008年出版的，有点早了。可以看英文的，英文已经出到第10版了，名字是《Statistics for the Behavioral Sciences》(10th)，第10版是2016年出的。</p>
<p>这本书本来就是为社会学，心理学这些数学基础比较薄弱的学科的学生写的，同样适用于生物学（毕竟数学基础也很薄弱），读起来并不困难。</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180920/C4H4egjCel.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180920/bD7L8j6Fc1.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h2 id="统计学基础">统计学基础</h2>
<p>这一部分的书可以与后面提到的有关R语言的书配合看。 ####《医学统计学》</p>
<p>国内的医学统计学书都差不多，去京东上挑一本销量比较大的就行，从头到尾看一下，把统计学的知识理一下，不懂的地方可以找其他的统计学书补充一下，再用R把书中的案例给计算一下就行，我平时看的是孙振球的《医学统计学》。</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180927/f7Bkh3d67g.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h4 id="统计思维程序员数学之概率统计">《统计思维——程序员数学之概率统计》</h4>
<p>Allen B.Downey著，张建锋，陈钢 译，人民邮电出版社，书不长，很快就可以读完，对几个统计学基础的概念介绍了一下。 <img src="http://ortxpw68f.bkt.clouddn.com/professional/180920/ihfdkGijm1.png?imageslim" alt="mark"></p>
<h4 id="从数据到结论">《从数据到结论》</h4>
<p>作者吴喜之，把一些统计学的概念与原理讲得很清楚，公式不多，比较简单。</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180920/lJjm024lbL.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h4 id="从概念到数据分析">《从概念到数据分析》</h4>
<p>2008年高等教育出版社出版的图书，作者是吴喜之 ，里面使用R语言把一些基本的统计学概念给计算了一下，对于理解统计学很有帮助，公式不多，书很薄，很快就能看完，可以与他的《从数据到结论》结合起来看。</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180920/L4fl1BfGgC.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h4 id="医学统计学基础与典型错误辨析">《医学统计学基础与典型错误辨析》</h4>
<p>作者胡良平，书比较老，但我觉得比较有价值，作者收集了医学上常见的一些统计学错误，由于医学生（或者说是生物背景的学生）的统计学基础很多并不是很好，因此经常出现一些统计学的错误，这本书就挑了不少这方面的论文，主要是中文论文里的错误，有精力了可以看看。 <img src="http://ortxpw68f.bkt.clouddn.com/professional/180920/AGbm6IKEC4.png?imageslim" alt="mark"></p>
<h4 id="数理统计学教程">《数理统计学教程》</h4>
<p>陈希孺的书，公式比较多，适合对统计学想深入了解的同学，需要一定的数学基础。 <img src="http://ortxpw68f.bkt.clouddn.com/professional/180920/5CKG09eGje.png?imageslim" alt="mark"></p>
<h4 id="统计学习基础数据挖掘推理与预测">《统计学习基础——数据挖掘、推理与预测》</h4>
<p>原书名是《The Elements of Statistical Learning》，副标题是《Data Mining, Inference, and Prediction, Second Edition》，据说是统计学领域的经典之作，不过貌似需要一定的数学基础，这本书并不太好理解。 <img src="http://ortxpw68f.bkt.clouddn.com/professional/180920/3lb11FI4k8.png?imageslim" alt="mark"> 英文版的封面如下所示： <img src="http://ortxpw68f.bkt.clouddn.com/professional/180927/6FghfK6hbg.png?imageslim" alt="mark"></p>
<h2 id="统计学与r">统计学与R</h2>
<p>这一部分的书可以与一些统计学的书配合看。</p>
<h4 id="r语言统计入门">《R语言统计入门》</h4>
<p>原名为Introductory Statistics with R second Edition，常用的统计方法与R实现，没多少公式，很好理解。书的前面部分是对R操作的一些简介，后面就是利用R在常规的统计学中的应用。</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180927/B4IHmb7eF5.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h4 id="r语言与统计分析">《R语言与统计分析》</h4>
<p>作者汤银才，书中有很多案例，使用R语言把统计学中常见的方法给演示了出来，适合有一些统计学基础的同学，书中的R代码都很短，很好理解，适合那些又想学R语言，又想学统计学的同学，不过书比较老，2008年出的，但统计学的方法基本上变化不大，比前面的那本略难。 <img src="http://ortxpw68f.bkt.clouddn.com/professional/180927/04h5clAH89.png?imageslim" alt="mark"></p>
<h4 id="多元统计分析与r语言建模">《多元统计分析与R语言建模》</h4>
<p>作者王赋会，介绍了常见的一些统计学方法原理与R语言实现。这些统计学方法包括广义线性模型、判别分析、聚类分析、主成分分析、因子分析、对应分析、典型相关分析等，虽然有公式，但我觉得通过查资料，还是能理解的。 <img src="http://ortxpw68f.bkt.clouddn.com/professional/180927/cjKAg78m7C.png?imageslim" alt="mark"></p>
<h4 id="复杂数据统计方法基于r的应用">《复杂数据统计方法——基于R的应用》</h4>
<p>作者吴喜之，书中的数据都是从国外网站上下载的，这本书是2012年出版的，介绍了一些常见的经典统计学方法以及机器学习方法，公式不多。 <img src="http://ortxpw68f.bkt.clouddn.com/professional/180927/FlLcg4AlJm.png?imageslim" alt="mark"></p>
<h2 id="网上的一些资料">网上的一些资料</h2>
<p>这一部分的资料主要是网上的一些不错的资料，有两个。</p>
<h4 id="医学统计学及sas应用之r语言实现">《医学统计学及SAS应用之R语言实现》</h4>
<p>这个资料最初是我从丁香园上看到的，作者不详，只知道是一名留日的医学博士，并非统计学出身，他学了R语言之后，就把《医学统计学及SAS应用》这本书中的案例重新计算了一下，这个资料网上有，能搜到，只有代码与计算结果，如下所示： <img src="http://ortxpw68f.bkt.clouddn.com/professional/180927/7DFiLjJ2Ci.png?imageslim" alt="mark"> 如果看这个资料，需要配合看《医学统计学及SAS应用》。 <strong>《医学统计学及SAS应用》</strong>的作者是王炳顺，这本书主要讲的是医学统计学中的一些案例与SAS的计算过程，如果要看这本书，只需要看书中的统计学原理、案例与SAS的计算结果就行，SAS的使用可以不看，可以自己使用R语言把书中的案例计算一下，然后对比一下自己的计算结果与SAS的计算结果，以及计算结果如何解读。 <img src="http://ortxpw68f.bkt.clouddn.com/professional/180927/5DDiECCh5D.png?imageslim" alt="mark"></p>
<h4 id="医学统计分析与r语言">《医学统计分析与R语言》</h4>
<p>作者梁雪枫，光明日报出版社。这本书里面对医学统计学介绍的极为详细，对数学与统计学基础也要求比较高，如果没有相应的基础读起来比较吃力。这本书很奇怪的是，在京东与淘宝上都搜不到，我还是在豆瓣的评论中找到了下载地址，如果想对统计学有进一步了解的同学，可以看看这本书。 <img src="http://ortxpw68f.bkt.clouddn.com/professional/180927/Ie62E0bfab.png?imageslim" alt="mark"></p>
<h2 id="数学相关资源与书籍整理">数学相关资源与书籍整理</h2>
<p>结城浩的系列书籍，包括《数学女孩系列》，《程序员的数学》系列。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2018/06/24/BIoTools/各种基因名转换/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/06/24/BIoTools/各种基因名转换/" itemprop="url">各种基因名笔记</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-06-24T12:00:00+08:00">
                2018-06-24
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/生信工具/" itemprop="url" rel="index">
                    <span itemprop="name">生信工具</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  1,507
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  6
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="基因名">基因名</h2>
<p>不同的数据据中的对于一个基因的描述不同，例如p53，它又叫P53，又叫TP53，或BCC7，或ENSG00000141510或OTTHUMG00000162125。通常来说，对p53的描述使用的是Official Gene Symbol（例如TP53）。</p>
<p>另外，在NCBI数据库中我们查找TP53，会出现下面这些信息：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190303173528.png">

</div>
<p>现在我们从第一行开始解释：</p>
<ol style="list-style-type: decimal">
<li><code>TP53 tumor protein p53 [ Homo sapiens (human) ]</code>：它表示这个基因是TP53肿瘤蛋白53，TP表示的是tumor protein，p表示的是protein，53的意思是这个蛋白的分子量是53kDa（其实当初在跑SDS-PAGE胶时，这个蛋白位于53kDa附近，就命名为p53，其实后来发现，这个蛋白中富含脯氨酸，在SDS-PAGE胶中迁移速度偏慢，它表示出来的分子量要比实际的分子量大，此蛋白的实际分子量是43.7kDa，不过由于命名太久了，也就将错就错了），后面的<code>Homo sapiens (human)</code>是人类的意思，它表示这个基因是人源的。</li>
<li><code>Gene ID</code>：7157，表示的是基因的entrez的系统代号，Entrez 是美国国家生物技术信息中心所提供的在线资源检索器。该资源将GenBank序列与其原始文献出处链接在一起。如果我们在Entrez中直接检索7157，也能直接搜索到TP53。Entrez ID实际上是指的Entrez gene ID，是对应于染色体上一个gene location的。每一个发现的基因都会被编制一个统一的编号，而Entrez ID是指的来自于NCBI旗下的Entrez gene数据库所使用的编号。每个基因的编号具有唯一性，包括不同种属生物间的同源基因编号也不相同，例如同样是TP53基因，人源TP53的Entrez ID为7157，zebrafish源的Entrez ID为30590，chichen源的Entrez ID为396200。EntrezID标记的基因具有唯一性，可以理解为它就是基因的身份证，通过一串数字就能区分每个基因。</li>
<li><code>Official Symbol</code>，这个是我们常用的这个基因的名称，即TP53，这个命名是由HGNC批准的，HGNC的全称是HUGO Gene Nomenclature Committee，其中HUGO的全称是Human Genome Organisation，即国际人类基因组组织，而HGNC则是HUGO基因命名委员会。</li>
<li><code>Official Full Name</code>，官方的全称。</li>
<li><code>Ensembl:ENSG00000141510</code>：ENSEMBL是一个由由英国Sanger研究所Wellcome基金会及欧洲分子生物学实验室所属分部欧洲生物信息学研究所共同协作运营的一个数据库。Ensembl数据库的基因名称后面有的还有个小数点，这个表示基因的版本号，没多少用处，在进行生信分析的时候，可以去掉。</li>
<li>MIM:191170。OMIM 为“0nline Mendelian Inheritance in Man”的简称，即在线《人类孟德尔遗传》，是一个关于人类基因和遗传紊乱的数据库（持续更新）。主要着眼于遗传性的基因疾病，包括文本信息和相关参考信息、序列纪录、图谱和相关其他数据库。其中MIM号就是在OMIM数据库中的基因编号。</li>
<li><code>Vega:OTTHUMG00000162125</code>。脊椎动物基因组注释（Vertebrate Genome Annotation，Vega）数据库已经被设计为浏览来自各种脊椎动物基因组的完结序列的人工注释的一个社区资源。它的核心数据库是基于Ensembl样式的模式，扩展到包含精选-特异的元数据。</li>
</ol>
<p>常用的基因名转换工具：</p>
<ol style="list-style-type: decimal">
<li><p>DAVID：https://david.ncifcrf.gov/</p></li>
<li><p>Absolute Gene ID Conversion Tools：http://bioinformatics.louisville.edu/abid/</p></li>
<li><p>bioDBnet：（https://biodbnet-abcc.ncifcrf.gov/db/db2db.php）</p></li>
<li><p>ENSEMBL biomart：（http://asia.ensembl.org/biomart/martview/bbd9fa2dd0eac95aa098be3514472b0e）</p></li>
</ol>
<h2 id="r包转换基因名">R包转换基因名</h2>
<p>使用R包来转换基因通常有三种方法。</p>
<h3 id="clusterprofiler包的bitr函数">clusterProfiler包的bitr函数</h3>
<p>bitr<code>是</code>clusterProfiler`包中的一个函数，它用于生物ID的转换，用法如下所示:</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">bitr(geneID, fromType, toType, OrgDb, drop = <span class="literal">TRUE</span>)</div></pre></td></tr></table></figure>
<p>其中，geneID是输入的基因ID，fromType是输入的ID类型，<code>toType</code>是输出的ID类型，<code>OrgDb</code>注释的db文件，<code>drop</code>剔除NA数据与否。</p>
<p><code>bitr</code>中的各种基因ID参数名称如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&gt; keytypes(org.Mm.eg.db)</div><div class="line"> [<span class="number">1</span>] <span class="string">"ACCNUM"</span>       <span class="string">"ALIAS"</span>        <span class="string">"ENSEMBL"</span>      <span class="string">"ENSEMBLPROT"</span>  <span class="string">"ENSEMBLTRANS"</span></div><div class="line"> [<span class="number">6</span>] <span class="string">"ENTREZID"</span>     <span class="string">"ENZYME"</span>       <span class="string">"EVIDENCE"</span>     <span class="string">"EVIDENCEALL"</span>  <span class="string">"GENENAME"</span>    </div><div class="line">[<span class="number">11</span>] <span class="string">"GO"</span>           <span class="string">"GOALL"</span>        <span class="string">"IPI"</span>          <span class="string">"MGI"</span>          <span class="string">"ONTOLOGY"</span>    </div><div class="line">[<span class="number">16</span>] <span class="string">"ONTOLOGYALL"</span>  <span class="string">"PATH"</span>         <span class="string">"PFAM"</span>         <span class="string">"PMID"</span>         <span class="string">"PROSITE"</span>     </div><div class="line">[<span class="number">21</span>] <span class="string">"REFSEQ"</span>       <span class="string">"SYMBOL"</span>       <span class="string">"UNIGENE"</span>      <span class="string">"UNIPROT"</span></div></pre></td></tr></table></figure>
<p>首先需要加载注释文件，小鼠使用<code>org.Mm.eg.db</code>文件，人类使用<code>org.Hs.eg.db</code>文件。如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">source</span>(<span class="string">"http://bioconductor.org/biocLite.R"</span>)</div><div class="line">options(BioC_mirror=<span class="string">"http://mirrors.ustc.edu.cn/bioc/"</span>)</div><div class="line">biocLite(<span class="string">"clusterProfiler"</span>)</div><div class="line">biocLite(<span class="string">'org.Hs.eg.db'</span>)</div><div class="line">biocLite(<span class="string">'org.Mn.eg.db'</span>)</div><div class="line"><span class="keyword">library</span>(<span class="string">"clusterProfiler"</span>)</div><div class="line">gene.df &lt;- bitr(gene, fromType = <span class="string">"ENTREZID"</span>, <span class="comment">#fromType是指你的数据ID类型是属于哪一类的</span></div><div class="line">                toType = c(<span class="string">"ENSEMBL"</span>, <span class="string">"SYMBOL"</span>), <span class="comment">#toType是指你要转换成哪种ID类型，可以写多种，也可以只写一种</span></div><div class="line">                OrgDb = org.Hs.eg.db)<span class="comment">#Orgdb是指对应的注释包是哪个</span></div><div class="line">head(gene.df)</div></pre></td></tr></table></figure>
<p>上面的代码运行结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">&gt; head(gene.df)</div><div class="line">  ENTREZID         ENSEMBL SYMBOL</div><div class="line"><span class="number">1</span>     <span class="number">4312</span> ENSG00000196611   MMP1</div><div class="line"><span class="number">2</span>     <span class="number">8318</span> ENSG00000093009  CDC45</div><div class="line"><span class="number">3</span>    <span class="number">10874</span> ENSG00000109255    NMU</div><div class="line"><span class="number">4</span>    <span class="number">55143</span> ENSG00000134690  CDCA8</div><div class="line"><span class="number">5</span>    <span class="number">55388</span> ENSG00000065328  MCM10</div><div class="line"><span class="number">6</span>      <span class="number">991</span> ENSG00000117399  CDC20</div></pre></td></tr></table></figure>
<h2 id="使用mget函数">使用mget函数</h2>
<p>如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">library</span>(AnnotationDbi)</div><div class="line">mySymbols &lt;- mget(gene,</div><div class="line">                  org.Hs.egSYMBOL, <span class="comment">#这个是可以选择的，选择不同，转换的ID类型也不一样</span></div><div class="line">                  ifnotfound=<span class="literal">NA</span>)</div><div class="line">head(mySymbols)</div><div class="line">class(mySymbols)</div></pre></td></tr></table></figure>
<p>运行结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">&gt; head(mySymbols)</div><div class="line">$`4312`</div><div class="line">[<span class="number">1</span>] <span class="string">"MMP1"</span></div><div class="line"></div><div class="line">$`8318`</div><div class="line">[<span class="number">1</span>] <span class="string">"CDC45"</span></div><div class="line"></div><div class="line">$`10874`</div><div class="line">[<span class="number">1</span>] <span class="string">"NMU"</span></div><div class="line"></div><div class="line">$`55143`</div><div class="line">[<span class="number">1</span>] <span class="string">"CDCA8"</span></div><div class="line"></div><div class="line">$`55388`</div><div class="line">[<span class="number">1</span>] <span class="string">"MCM10"</span></div><div class="line"></div><div class="line">$`991`</div><div class="line">[<span class="number">1</span>] <span class="string">"CDC20"</span></div><div class="line"></div><div class="line">&gt; class(mySymbols)</div><div class="line">[<span class="number">1</span>] <span class="string">"list"</span></div></pre></td></tr></table></figure>
<h3 id="select函数">select()函数</h3>
<p>如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">geneIDselect &lt;-select(org.Hs.eg.db, <span class="comment">#.db是这个芯片数据对应的注释包</span></div><div class="line">                      keys=gene,</div><div class="line">                      columns=c(<span class="string">"SYMBOL"</span>,<span class="string">"ENSEMBL"</span>,<span class="string">"GENENAME"</span>), <span class="comment">#clolumns参数是你要转换的ID类型是什么，这里选择三个。</span></div><div class="line">                      keytype=<span class="string">"ENTREZID"</span> )<span class="comment">#函数里面的keytype与keys参数是对应的，keys是你输入的那些数据，keytype是指这些数据是属于什么类型的数据。 </span></div><div class="line">head(geneIDselect)</div></pre></td></tr></table></figure>
<p>运行结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">&gt; head(geneIDselect)</div><div class="line">  ENTREZID SYMBOL         ENSEMBL</div><div class="line"><span class="number">1</span>     <span class="number">4312</span>   MMP1 ENSG00000196611</div><div class="line"><span class="number">2</span>     <span class="number">8318</span>  CDC45 ENSG00000093009</div><div class="line"><span class="number">3</span>    <span class="number">10874</span>    NMU ENSG00000109255</div><div class="line"><span class="number">4</span>    <span class="number">55143</span>  CDCA8 ENSG00000134690</div><div class="line"><span class="number">5</span>    <span class="number">55388</span>  MCM10 ENSG00000065328</div><div class="line"><span class="number">6</span>      <span class="number">991</span>  CDC20 ENSG00000117399</div><div class="line">                                                     GENENAME</div><div class="line"><span class="number">1</span>                                   matrix metallopeptidase <span class="number">1</span></div><div class="line"><span class="number">2</span>                                      cell division cycle <span class="number">45</span></div><div class="line"><span class="number">3</span>                                                neuromedin U</div><div class="line"><span class="number">4</span>                            cell division cycle associated <span class="number">8</span></div><div class="line"><span class="number">5</span> minichromosome maintenance <span class="number">10</span> replication initiation factor</div><div class="line"><span class="number">6</span>                                      cell division cycle <span class="number">20</span></div></pre></td></tr></table></figure>
<h2 id="参考资料">参考资料</h2>
<ol style="list-style-type: decimal">
<li><a href="https://blog.csdn.net/liufeichendi/article/details/78819884" target="_blank" rel="external">各类基因ID转换</a></li>
<li>简述几种Gene ID的转换方法<br>
</li>
<li><a href="https://www.douban.com/note/544090098/" target="_blank" rel="external">OMIM数据库</a></li>
<li><a href="https://vip.biotrainee.com/d/109-entrez-id" target="_blank" rel="external">浅谈Entrez ID</a></li>
<li><a href="https://blog.csdn.net/weixin_40739969/article/details/89354167" target="_blank" rel="external">Gene id 转换(三种基因各种id转换方法)</a></li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2018/06/23/BioStatistics/生物统计-06非参数检验/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/06/23/BioStatistics/生物统计-06非参数检验/" itemprop="url">非参数检验笔记</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-06-23T12:02:00+08:00">
                2018-06-23
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/生物统计/" itemprop="url" rel="index">
                    <span itemprop="name">生物统计</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  5,564
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  24
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="前言">前言</h2>
<p>非参数检验(non-parametric test)是相对于参数检验(parametric test)而言的。如果总体分布为已知的数学形式，用参数检验，反之用非参数检验。当总体分布不能由已知的数学形式表达，没有总体参数时，就无法用参数检验，两个或多个正态总体方差不等，也不能用t检验或F检验的参数检验。对于不满足参数检验条件的数据，一是进行变量变换，使其满足参数检验条件，另外就是用非参数检验。非参检验对总体分布不作严格假定，又称任意分布检验(distribution-free test)，《医学统计学》（第三版，孙振球）书中采用的是秩转换的非参数检验，即将数值变量从小到大排列，再计算检验统计量。</p>
<p>非参数检验在总体分布未知时有很大的优越性，在分布未时，如果还假定总体诸如正态分布那样的已知分布，在进行统计推断时就可能产生错误。非参数检验总是比传统检验案例，但是在总体分布形式已经已知时，非参数检验就不如传统方法效率高，这是因为非参数方法利用的利息要少些。往往在传统方法可以拒绝零假设的情况下，非参数检验无法拒绝。用统计的术语来说，在总体分布已知时，传统方法有较大的功效(power)，效率要高；但非参数统计在总体分布未知时，效率往往比假定了错误总体分布时的传统方法要高，有时候要高很多。</p>
<h2 id="秩的概念">秩的概念</h2>
<p>非参数检验中的秩(rank)是最常用的概念，秩就是该数据按照升序排列后，每个观测值的位置。例如我们有下面的数据（样本量为10），其中第一行为数据本身，第二行就是它们的秩，可以看出，3最小，秩为1，13其次，秩为2，而最大的是98，秩为10，我们使用rank(x)表示x的秩，通常也用Ri表示观测值<span class="math inline">\(x_{i}\)</span>的秩，如下所示：</p>
<table>
<thead>
<tr class="header">
<th><span class="math inline">\(x_{i}\)</span></th>
<th>98</th>
<th>67</th>
<th>63</th>
<th>3</th>
<th>38</th>
<th>16</th>
<th>21</th>
<th>53</th>
<th>13</th>
<th>81</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(R_{i}=rank(x_{i})\)</span></td>
<td>10</td>
<td>8</td>
<td>7</td>
<td>1</td>
<td>5</td>
<td>3</td>
<td>4</td>
<td>6</td>
<td>2</td>
<td>9</td>
</tr>
</tbody>
</table>
<h2 id="非参数检验的原理">非参数检验的原理</h2>
<p>如果零假设中确定了一个中位数<span class="math inline">\(M_{0}\)</span>，那么样本点应该以同样的概率出现在<span class="math inline">\(M_{0}\)</span>的两边，也就是说，如果每个样本点送去零假设的中位数，那么得到的差值有些为正，有些为负，如果零假设正确，那么正负符号数目应该差不多，如果差得很多，这就意味着零假设有问题，可以拒绝零假设。这也就是所谓的<strong>符号检验(sign test)</strong>。</p>
<p>这里没有涉及任何总体分布，在零假设下，样本点和<span class="math inline">\(M_{0}\)</span>的差值中负号的个数（记为<span class="math inline">\(S^-\)</span>）应该服从二项分布Bin(n,α)，而正号的个数（记为<span class="math inline">\(S^+\)</span>）䚱服从二项分布Bin(n,1-α)，注意，对于已知对称的分布，由于中位数和均值相等，对中位数的检验等同于对均值的检验，我们通过一个例子来解释符号检验。</p>
<h2 id="单样本的关于总体中位数的符号检验">单样本的关于总体中位数的符号检验</h2>
<p>案例A，质量监督部门对商店里出售的某厂家的西洋参片进行了抽查，对于25包写明为净重100g的西洋参片的称重结果如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180819/EhJ1bCk5HA.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>这里的总体分布未知（我们只是假设未知，其实它的分布是可以计算出来的），用M表示总体中位数，容易计算出，样本中位数为m=98.36，因为人们怀疑厂家包装的西洋参片分量。由于对于重量的总体分布不清楚，决定对其进行符号检验，需要的检验如下所示：</p>
<p><span class="math display">\[H_{0}:M=100\iff H_{1}:M&lt;100\]</span></p>
<p>按照零假设，每个观测值（每包西洋参的净重）大于中位数<span class="math inline">\(M_{0}=100\)</span>的概率和小于100的概率都是0.5，这应该服从二项分布Bin(25,0.5)，容易计算出大于100的只有<span class="math inline">\(S^+=8\)</span>，这样的参数为n=25，p=0.5的二项分布变量小于或等于8的概率为0.05388，这就是p值，历引，对于显著性水平α=0.05，根据这个符号检验，我们没有足够的证据拒绝零假设。在R中计算的过程如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">&gt; pbinom(<span class="number">8</span>,<span class="number">25</span>,<span class="number">0.5</span>)</div><div class="line">[<span class="number">1</span>] <span class="number">0.05387607</span></div><div class="line"><span class="comment"># 或者按另外一种方法：</span></div><div class="line">&gt; raw &lt;-c(<span class="number">99.05</span>,<span class="number">100.25</span>,<span class="number">102.56</span>,<span class="number">99.15</span>,<span class="number">104.89</span>,<span class="number">101.86</span>,<span class="number">96.37</span>,<span class="number">96.79</span>,<span class="number">99.37</span>,</div><div class="line">+         <span class="number">96.9</span>,<span class="number">93.94</span>,<span class="number">92.97</span>,<span class="number">108.28</span>,<span class="number">96.86</span>,<span class="number">93.94</span>,<span class="number">98.27</span>,<span class="number">98.36</span>,<span class="number">100.81</span>,<span class="number">92.99</span>,</div><div class="line">+         <span class="number">103.72</span>,<span class="number">90.66</span>,<span class="number">98.24</span>,<span class="number">97.87</span>,<span class="number">99.21</span>,<span class="number">101.79</span>)</div><div class="line">&gt; pbinom(length(raw[raw&gt;=<span class="number">100</span>]),<span class="number">25</span>,<span class="number">0.5</span>)</div><div class="line">[<span class="number">1</span>] <span class="number">0.05387607</span></div></pre></td></tr></table></figure>
<p>一般来说，根据样本中位数和零假设中的待检验总体中位数<span class="math inline">\(M_{0}\)</span>的比较，我们的检验为下面三种形式之一（记样本中位数为m），如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180819/3j1H5fkEb9.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>这里的关于中位数的符号检验概率，完全可以很容易地推广到关于总体α分位数的符号检验中，如果零假设中确定了一个α分位数<span class="math inline">\(Q_{\alpha0}\)</span></p>
<p>那么，样本点应该以概率α出现在<span class="math inline">\(Q_{\alpha0}\)</span>的左边，或者以概率1-α出现在<span class="math inline">\(Q_{\alpha0}\)</span>的右边，因此样本点减去<span class="math inline">\(Q_{\alpha0}\)</span>差值中铅的个数（记为<span class="math inline">\(S^-\)</span>）应该服从二项分布Bin(n,α)，而正号的个数（记为<span class="math inline">\(S^+\)</span>）应该服从二项分布Bin(n,1-α)。当α=0.5时，总体α分位数就是总体中位数。</p>
<h2 id="单样本的关于对称总体中位数的wilcoxon符号秩检验">单样本的关于对称总体中位数的Wilcoxon符号秩检验</h2>
<p>前面的符号检验仅仅用了样本点和零假设的中位数或α分位数的差的符号，我们可以看到，检验的结果p值大于0.05，但是这种检验方法没有利用这些差的大小，下面介绍的Wilcoxn符号秩检验（Wilcoxon signed-rank test）把差的绝对值的秩分别按照不同的符号相加作为其检验统计量，这里把对总体唯一假定是总体具有对称分布，这种检验方法我们可以看到，它的功效要比前面介绍的高（计算出来的p值小于0.05）。</p>
<h3 id="wilcoxon符号秩检验原理">Wilcoxon符号秩检验原理</h3>
<p>Wilcoxon符号秩检验的原理是这样的，假定<span class="math inline">\(x_{1},x_{2},\cdots,x_{n}\)</span>为来自连续对称总体的一个样本，如果我们的假设检验问题的零假设为中位数（均值）<span class="math inline">\(M=M_{0}\)</span>。那么，对于符号检验而言，只需计算<span class="math inline">\(x_{i}-M_{0}(i=1,2,\cdots,n)\)</span>中有多少正负符号，即可利用二项分布的概率来计算p值。但对于Wilcoxon符号秩检验，则要把<span class="math inline">\(|x_{i}-M_{0}|\)</span>排序，得到<span class="math inline">\(|x_{i}-M_{0}|\)</span>的秩。然后把<span class="math inline">\(x_{i}-M_{0}\)</span>的符号加到相应的秩上面。于是，就可以得到既带有正号的秩，又带有负号的秩，对带负号的秩的绝对值求和，即把满足<span class="math inline">\(x_{i}-M_{0}&lt;0\)</span>的<span class="math inline">\(|x_{i}-M_{0}|\)</span>的秩求和，并用<span class="math inline">\(W^+\)</span>表示。如果<span class="math inline">\(M_{0}\)</span>的确是中位娄和，那么<span class="math inline">\(W^-\)</span>和<span class="math inline">\(W^+\)</span>应该大体上差不多。如果<span class="math inline">\(W^-\)</span>或者<span class="math inline">\(W^+\)</span>过大或过小，则应该怀疑中位数<span class="math inline">\(M=M_{0}\)</span>的零假设。令<span class="math inline">\(W=min(W^-,W^+)\)</span>，则当W太小时，应该拒绝零假设。这个W就是Wilcoxon符号秩检验统计量。</p>
<h2 id="r中的非参数检验函数">R中的非参数检验函数</h2>
<p>在R中进行Wilcoxon检验的函数是<code>wilcoxon.test</code>，使用方法如下所示：</p>
<p>如果总体不服从正态分布，那么T检验就不再适用，此时我们可以利用非参数方法推断中位数。wilcoxon.test函数可实现符号秩检验，如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">x &lt;- rnorm(50,mean=10,sd=5)</div><div class="line">wilcox.test(x,conf.int=T) #指定conf.int让函数返回中位数的置信区间</div><div class="line">wilcox.test(x,mu=1) #指定mu让函数返回中位数为10的检验结果</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">&gt; wilcox.test(x,conf.int=T) #指定conf.int让函数返回中位数的置信区间</div><div class="line"></div><div class="line">	Wilcoxon signed rank test with continuity correction</div><div class="line"></div><div class="line">data:  x</div><div class="line">V = 1271, p-value = 9.93e-10</div><div class="line">alternative hypothesis: true location is not equal to 0</div><div class="line">95 percent confidence interval:</div><div class="line">  9.31246 12.20277</div><div class="line">sample estimates:</div><div class="line">(pseudo)median </div><div class="line">       10.7765 </div><div class="line"></div><div class="line">&gt; wilcox.test(x,mu=1) #指定mu让函数返回中位数为10的检验结果</div><div class="line"></div><div class="line">	Wilcoxon signed rank test with continuity correction</div><div class="line"></div><div class="line">data:  x</div><div class="line">V = 1269, p-value = 1.121e-09</div><div class="line">alternative hypothesis: true location is not equal to 1</div></pre></td></tr></table></figure>
<h2 id="单个样本wilcoxon检验案例">单个样本Wilcoxon检验案例</h2>
<h4 id="案例a">案例A</h4>
<p>现在我们再看一下前面的那个案例A，使用Wilcoxon检验来看一下，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">&gt; raw &lt;-c(<span class="number">99.05</span>,<span class="number">100.25</span>,<span class="number">102.56</span>,<span class="number">99.15</span>,<span class="number">104.89</span>,<span class="number">101.86</span>,<span class="number">96.37</span>,<span class="number">96.79</span>,<span class="number">99.37</span>,</div><div class="line">+         <span class="number">96.9</span>,<span class="number">93.94</span>,<span class="number">92.97</span>,<span class="number">108.28</span>,<span class="number">96.86</span>,<span class="number">93.94</span>,<span class="number">98.27</span>,<span class="number">98.36</span>,<span class="number">100.81</span>,<span class="number">92.99</span>,</div><div class="line">+         <span class="number">103.72</span>,<span class="number">90.66</span>,<span class="number">98.24</span>,<span class="number">97.87</span>,<span class="number">99.21</span>,<span class="number">101.79</span>)</div><div class="line">&gt; wilcox.test(raw,mu=<span class="number">100</span>,alternative = <span class="string">"less"</span>)</div><div class="line"></div><div class="line">	Wilcoxon signed rank test with continuity correction</div><div class="line"></div><div class="line">data:  raw</div><div class="line">V = <span class="number">100</span>, p-value = <span class="number">0.04763</span></div><div class="line">alternative hypothesis: true location is less than <span class="number">100</span></div><div class="line"></div><div class="line">Warning message:</div><div class="line">In wilcox.test.default(raw, mu = <span class="number">100</span>, alternative = <span class="string">"less"</span>) :</div><div class="line">  无法精確計算带连结的p值</div></pre></td></tr></table></figure>
<h4 id="案例b">案例B</h4>
<p>现在再看一个案例B，下面是随机挑选了12袋包装上写的重量是15g的干酵母粉，并进行称重所得到的重量的数据，如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">12.39,15.64,14,14.17,14.08,14.16,13.94,14.61,14.7,12.81,14.12,13.37</div></pre></td></tr></table></figure>
<p>由于总体中位数是14.1，而零假设的总体均值是15，因此我们可以怀疑这种袋装酵母粉不够分量，相应的关于中位数的检验如下所示：</p>
<p><span class="math display">\[H_{0}:M=15\iff H_{1}:M&lt;15\]</span></p>
<p>假定总体是对称分布的，因此可以应用Wilcoxon符号秩检验，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">&gt; raw_b &lt;- c(<span class="number">12.39</span>,<span class="number">15.64</span>,<span class="number">14</span>,<span class="number">14.17</span>,<span class="number">14.08</span>,<span class="number">14.16</span>,<span class="number">13.94</span>,<span class="number">14.61</span>,<span class="number">14.7</span>,<span class="number">12.81</span>,<span class="number">14.12</span>,<span class="number">13.37</span>)</div><div class="line">&gt; wilcox.test(raw_b,m=<span class="number">15</span>,alternative = <span class="string">"less"</span>)</div><div class="line"></div><div class="line">	Wilcoxon signed rank test</div><div class="line"></div><div class="line">data:  raw_b</div><div class="line">V = <span class="number">3</span>, p-value = <span class="number">0.001221</span></div><div class="line">alternative hypothesis: true location is less than <span class="number">15</span></div></pre></td></tr></table></figure>
<h4 id="案例c">案例C</h4>
<p>例8-2 已知某地正常人尿氟含量的中位数为45.30μmol/L 。今在该地某厂随机抽取12名工人，测得尿氟含量见表8-2第（1）栏。问该厂工人的尿氟含量是否高于当地正常人的尿氟含量？（《医学统计学》，第三版，孙振球，P134）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">data82 &lt;- c(44.21,45.30,46.39,49.47,51.05,53.16,53.26,54.37,57.16,67.37,71.05,87.37)</div><div class="line">wilcox.test(data82-45.30)</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">&gt; wilcox.test(data82-45.30)</div><div class="line"></div><div class="line">	Wilcoxon signed rank test with continuity correction</div><div class="line"></div><div class="line">data:  data82 - 45.3</div><div class="line">V = 65, p-value = 0.005099</div><div class="line">alternative hypothesis: true location is not equal to 0</div></pre></td></tr></table></figure>
<p>这个结果与书上有出入，书中提到，p值是小于0.005，则R的计算出来是0.005099，小于0.05，但SPSS的计算结果与R一致。</p>
<h2 id="两个独立样本wilcoxon检验mann-whitney-u检验">两个独立样本Wilcoxon检验（Mann-Whitney U检验）</h2>
<p>如果是比较两个正态总体均值，那么就是使用t检验（检验均值之差为<span class="math inline">\(\mu_{1}-\mu_{2}\)</span>），如果不知道两组数据是否服从哪种特定的总体分布，我们就要考虑比较两组数据的中位数大小，我们需要的唯一定义就是两个总体的分布有类似的形状，但不要求对称。这里介绍的检验的原理很简单，假定第一个样本有m个观测值<span class="math inline">\(x_{1},\cdots,x_{m}\)</span>，第二个有n个观测值，<span class="math inline">\(y_{1},\cdots,y_{n}\)</span>。把两个样本混合之后把这个m+n个观测值按照大小次序排序，然后记下每个观测值在混合排序下面的秩，之后分别把两个样本所得到的秩相加。记第一个样本观测值的秩的和为<span class="math inline">\(W_{x}\)</span>，而第二个样本秩的和为<span class="math inline">\(W_{Y}\)</span>。这两个值可以互相推算，称为Wilcoxon统计量。该统计量的分布和两个总体分布无关，，由此分布可以得到p值。直观上看，如果<span class="math inline">\(W_{x}\)</span>与<span class="math inline">\(W_{Y}\)</span>之中有一个显著地大（或显著地小），则可以选择拒绝零假设。这个检验注称为Wilcoxon秩和检验(Wilcoxon rank-sum test)，也称为Mann-Whitney检验或Mann-Whitney-Wilcoxon检验。之所以有两个名称，这是因为Wilcoxon统计量和由Mann-Whitney导出的检验统计量等价。Mann-Whitney统计量也是一对：<span class="math inline">\(W_{XY}\)</span>和<span class="math inline">\(W_{YX}\)</span>；定义为两个样本中满足<span class="math inline">\(x_{i}&gt;y_{i}\)</span>的数目，而<span class="math inline">\(W_{XY}\)</span>定义为两个样本中满足<span class="math inline">\(x_{i}&lt;y_{i}\)</span>的数目。检验时，一般使用<span class="math inline">\(W=min(W_{XY},W_{YX})\)</span>作为检验统计量。</p>
<p>案例A：（《医学统计学》，第三版，孙振球，P136）</p>
<p>对10例肺癌病人和12例矽肺0期工人用X光片测量肺门横径右侧距RD值（cm），结果如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">肺癌：2.78,3.23,4.2,4.87,5.12,6.21,7.18,8.05,8.56,9.6</div><div class="line">矽肺：3.23,3.5,4.04,4.15,4.28,4.34,4.47,4.64,4.75,4.82,4.95,5.1</div></pre></td></tr></table></figure>
<p>问肺癌病人的RD值是否高于矽肺0期工人的RD值？</p>
<p>思路：第一组数据的样本量为10，中位数是5.665，第二组数据的样本量为12，中位数是4.405，这两个中位数看上去有点差异，令这两组数据的总体中位数分别为<span class="math inline">\(M_{1}\)</span>和<span class="math inline">\(M_{2}\)</span>，现在进行检验，如下所示：</p>
<p><span class="math display">\[H_{0}:M_{1}=M_{2}\iff H_{1}:M_{1}&gt;M_{2}\]</span></p>
<p>计算过程如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">lc &lt;- c(2.78,3.23,4.2,4.87,5.12,6.21,7.18,8.05,8.56,9.6)</div><div class="line">si &lt;- c(3.23,3.5,4.04,4.15,4.28,4.34,4.47,4.64,4.75,4.82,4.95,5.1)</div><div class="line">wilcox.test(lc,si,correct=T)</div></pre></td></tr></table></figure>
<p>从结果中我们可以看到，p值等于0.04318，同时也得到中间结果<span class="math inline">\(W_{XY}=86.5\)</span>，因此哦可以说，对于大于p值的显著必不平都可以拒绝零假设，也就是说，这两组数据的中位数有显著性的差异。</p>
<h2 id="配对wilcoxon符号秩检验">配对Wilcoxon符号秩检验</h2>
<p>例8-1：对12份血清分别用原方法（检测时间20分钟）和新方法（检测时间10分钟）测谷-丙转氨酶，结果见表8-1的（2）、（3）栏。问两法所得结果有无差别？（《医学统计学》，第三版，孙振球，P132） <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">old &lt;- c(60,142,195,80,242,220,190,25,198,38,236,95)</div><div class="line">new &lt;- c(76,152,243,82,240,220,205,38,243,44,190,100)</div><div class="line">wilcox.test(old,new,paired = TRUE)</div></pre></td></tr></table></figure></p>
<p>结果如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">&gt; old &lt;- c(60,142,195,80,242,220,190,25,198,38,236,95)</div><div class="line">&gt; new &lt;- c(76,152,243,82,240,220,205,38,243,44,190,100)</div><div class="line">&gt; wilcox.test(old,new,paired = TRUE)</div><div class="line"></div><div class="line">	Wilcoxon signed rank test with continuity correction</div><div class="line"></div><div class="line">data:  old and new</div><div class="line">V = 11.5, p-value = 0.06175</div><div class="line">alternative hypothesis: true location shift is not equal to 0</div><div class="line"></div><div class="line">Warning messages:</div><div class="line">1: In wilcox.test.default(old, new, paired = TRUE) :</div><div class="line">  无法精確計算带连结的p值</div><div class="line">2: In wilcox.test.default(old, new, paired = TRUE) :</div><div class="line">  有0时无法計算精確的p值</div></pre></td></tr></table></figure>
<h2 id="有序的秩检验">有序的秩检验</h2>
<p>例8-4 39名吸烟工人和40名不吸烟工人的碳氧血红蛋白HbCO(%)含量见表8-6。问吸烟工人的HbCO(%)含量是否高于不吸烟工人的HbCO(%)含量？</p>
<h3 id="例8-4第1种方法wilcox.test检验">例8-4第1种方法：Wilcox.test检验：</h3>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">smoke &lt;- c(1,8,16,10,4)</div><div class="line">no.smoke &lt;-c(2,23,11,4,0)</div><div class="line">rank.c &lt;- c(1:5)</div><div class="line">group1 &lt;- rep(rank.c,smoke)</div><div class="line">group2 &lt;- rep(rank.c,no.smoke)</div><div class="line">data84 &lt;- c(group1,group2)</div><div class="line">group.f &lt;-factor(c(rep(1,length(group1)),rep(2,length(group2))))</div><div class="line">wilcox.test(data84~group.f)</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">&gt; wilcox.test(data84~group.f)</div><div class="line"></div><div class="line">        Wilcoxon rank sum test with continuity correction</div><div class="line"></div><div class="line">data:  data84 by group.f</div><div class="line">W = <span class="number">1137</span>, p-value = <span class="number">0.0002181</span></div><div class="line">alternative hypothesis: true location shift is not equal to <span class="number">0</span></div><div class="line"></div><div class="line">Warning message:</div><div class="line">In wilcox.test.default(x = c(<span class="number">1L</span>, <span class="number">2L</span>, <span class="number">2L</span>, <span class="number">2L</span>, <span class="number">2L</span>, <span class="number">2L</span>, <span class="number">2L</span>, <span class="number">2L</span>, <span class="number">2L</span>,  :</div><div class="line">  无法精確計算带连结的p值</div></pre></td></tr></table></figure>
<h3 id="例8-4第2种方法kruskal检验">例8-4第2种方法：Kruskal检验：</h3>
<p>Kurskal-Wallis检验是Wilcoxon方法（其实是Mann-Whitney检验）用于多于两个样本的时候的升级版。当对两个样本进行比较的时候，Kurskal-Wallis检验与Mann-Whitney检验是等价的。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">kruskal.test(data84~group.f)</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&gt; kruskal.test(data84~group.f)</div><div class="line"></div><div class="line">        Kruskal-Wallis rank sum test</div><div class="line"></div><div class="line">data:  data84 by group.f</div><div class="line">Kruskal-Wallis chi-squared = <span class="number">13.707</span>, df = <span class="number">1</span>, p-value = <span class="number">0.0002137</span></div></pre></td></tr></table></figure>
<h3 id="例8-4第2种方法ridit检验">例8-4第2种方法：Ridit检验:</h3>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">data84 &lt;- matrix(c(1,8,16,10,4,2,23,11,4,0),nrow=5)</div><div class="line">dimnames(data84) &lt;- list(cone=c(&quot;very low&quot;,&quot;low&quot;,&quot;median&quot;,&quot;a bit high&quot;,&quot;high&quot;),</div><div class="line">worker=c(&quot;smoker&quot;,&quot;no-smoker&quot;))</div><div class="line">if(!require(&quot;Ridit&quot;))&#123;</div><div class="line">  install.packages(&quot;Ridit&quot;)</div><div class="line">  library(Ridit)</div><div class="line">&#125;</div><div class="line">ridit(data84,2)</div><div class="line">chisq.test(data84)</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">&gt; ridit(data84,<span class="number">2</span>)</div><div class="line"></div><div class="line">Ridit Analysis:</div><div class="line"></div><div class="line">Group   Label           Mean Ridit</div><div class="line">-----   -----           ----------</div><div class="line"><span class="number">1</span>       smoker          <span class="number">0.6159</span></div><div class="line"><span class="number">2</span>       no-smoker       <span class="number">0.387</span></div><div class="line"></div><div class="line">Reference: Total of all groups </div><div class="line">chi-squared = <span class="number">13.707</span>, df = <span class="number">1</span>, p-value = <span class="number">0.0002137</span></div><div class="line"></div><div class="line">&gt; chisq.test(data84)</div><div class="line"></div><div class="line">        Pearson<span class="string">'s Chi-squared test</span></div><div class="line"><span class="string"></span></div><div class="line"><span class="string">data:  data84</span></div><div class="line"><span class="string">X-squared = 15.079, df = 4, p-value = 0.004541</span></div><div class="line"><span class="string"></span></div><div class="line"><span class="string">Warning message:</span></div><div class="line"><span class="string">In chisq.test(data84) : Chi-squared近似算法有可能不准</span></div></pre></td></tr></table></figure>
<h2 id="例8-5">例8-5</h2>
<p>用三种药物杀灭钉螺，每批用200只活钉螺，用药后清点每批钉螺的死亡数、再计算死亡率（%），结果见表8-9。问三种药物杀灭钉螺的效果有无差别？</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">drug &lt;-rep(c(&quot;甲药&quot;,&quot;乙药&quot;,&quot;丙药&quot;),each=5)</div><div class="line">data &lt;- c(32.5,35.5,40.5,46,49,16,20.5,22.5,29,36,6.5,9.0,12.5,18,24)</div><div class="line">data85 &lt;- data.frame(drug,data)</div><div class="line">kruskal.test(data85$data~data85$drug)</div></pre></td></tr></table></figure>
<h2 id="例8-6">例8-6</h2>
<p>比较小白鼠接种三种不同菌型伤寒杆菌9D、11C和DSC1后存活日数，结果见表8-10。问小白鼠接种三种不同菌型伤寒杆菌的存活日数有无差别？ <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">mice &lt;- as.factor(c(rep(&quot;9D&quot;,10),rep(&quot;11C&quot;,9),rep(&quot;DSC1&quot;,11)))</div><div class="line">data86 &lt;- c(2,2,2,3,4,4,4,5,7,7,5,5,6,6,6,7,8,10,12,3,5,6,6,6,7,7,9,10,11,11)</div><div class="line">data86 &lt;- data.frame(mice,data)</div><div class="line">kruskal.test(data86$data~data86$mice)</div></pre></td></tr></table></figure></p>
<h2 id="例8-7">例8-7</h2>
<p>四种疾病患者痰液内嗜酸性白细胞的检查结果见表8-11。问四种疾病患者痰液内的嗜酸性白细胞有无差别？注：这道例题与《医学统计学及SAS应用》（上海交通大学）的9.11类似 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">x1 &lt;- c(0,2,9,6)</div><div class="line">x2 &lt;- c(3,5,5,2)</div><div class="line">x3 &lt;- c(5,7,3,2)</div><div class="line">x4 &lt;- c(3,5,3,0)</div><div class="line"> </div><div class="line">freq &lt;- function(x)&#123;</div><div class="line">count &lt;-c()</div><div class="line">for(i in 1:4)&#123;</div><div class="line">count1 &lt;-c(rep(i,x[i]))</div><div class="line">count &lt;- append(count,count1)</div><div class="line">&#125;</div><div class="line">return(count)&#125;</div><div class="line">data87 &lt;-c(freq(x1),freq(x2),freq(x3),freq(x4))</div><div class="line">group &lt;- c(rep(1,sum(x1)),rep(2,sum(x2)),rep(3,sum(x3)),rep(4,sum(x4)))</div><div class="line">kruskal.test(data87~group)</div></pre></td></tr></table></figure></p>
<h2 id="例8-8">例8-8</h2>
<p>对例8-6资料（表8-10）作三个样本间的两两比较，Nemenyi检验。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"># 需要安装下列包：</div><div class="line">if(!require(&quot;pgirmess&quot;))&#123;</div><div class="line">  install.packages(&quot;pgirmess&quot;)</div><div class="line">  library(pgirmess)</div><div class="line">&#125;</div><div class="line">if(!require(&quot;coin&quot;))&#123;</div><div class="line">  install.packages(&quot;coin&quot;)</div><div class="line">  library(coin)</div><div class="line">&#125;</div><div class="line">if(!require(&quot;multcomp&quot;))&#123;</div><div class="line">  install.packages(&quot;multcomp&quot;)</div><div class="line">  library(multcomp)</div><div class="line">&#125;</div><div class="line"></div><div class="line">mice &lt;- as.factor(c(rep(&quot;9D&quot;,10),rep(&quot;11C&quot;,9),rep(&quot;DSC1&quot;,11)))</div><div class="line">data &lt;- c(2,2,2,3,4,4,4,5,7,7,5,5,6,6,6,7,8,10,12,3,5,6,6,6,7,7,9,10,11,11)</div><div class="line">data88 &lt;- data.frame(mice,data)</div><div class="line">kruskal.test(data~mice,data=data88)</div><div class="line">kruskalmc(data~mice, data=data88, probs=0.05) # 使用kruskalmc函数做两两比较，但此方法不能给出具体的值</div><div class="line"># 下面构建函数计算具体的p值</div><div class="line">mult &lt;- oneway_test(data ~ mice, data = data88,</div><div class="line">ytrafo = function(data) trafo(data, numeric_trafo = rank),</div><div class="line">xtrafo = function(data) trafo(data, factor_trafo = function(x)</div><div class="line">model.matrix(~x - 1) %*% t(contrMat(table(x), &quot;Tukey&quot;))),</div><div class="line">teststat = &quot;max&quot;, distribution = approximate(B = 90000)) </div><div class="line">pvalue(mult, method = &quot;single-step&quot;) #计算具体的p值</div></pre></td></tr></table></figure>
<h2 id="例8-9">例8-9</h2>
<p>8名受试对象在相同实验条件下分别接受4种不同频率声音的刺激，他们的反应率（%）资料见表8-12。问4种频率声音刺激的反应率是否有差别？ <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">freA &lt;- c(8.40,11.60,9.40,9.80,8.30,8.60,8.90,7.80)</div><div class="line">freB &lt;- c(9.60,12.70,9.10,8.70,8.00,9.80,9.00,8.20)</div><div class="line">freC &lt;- c(9.80,11.80,10.40,9.90,8.60,9.60,10.60,8.50)</div><div class="line">freD &lt;- c(11.70,12.00,9.80,12.00,8.60,10.60,11.40,10.80)</div><div class="line">matrix89 &lt;- matrix(c(freA,freB,freC,freD),nrow=8,dimnames=list(no=1:8,c(&quot;A&quot;,&quot;B&quot;,&quot;C&quot;,&quot;D&quot;)))</div><div class="line">friedman.test(matrix89)</div></pre></td></tr></table></figure></p>
<p>对两个以上样本进行比较的Kruskal-Wallis 秩和检验 kruskal.test() kruskal.test(formula, data, subset, na.action, …) 例子 为了比较属于同一类的四种不同食谱的营养效果，将25只老鼠随机的氛围4组，每组分别为8只，4只，7只和6只，采用食谱甲乙丙丁喂养，假设其他条件均值相同，12周后测得体重增加量如表所示，在alpha=0.05水平上，检验各食谱的营养效果是否有显著差异。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">food&lt;-data.frame(</div><div class="line">x=c(164, 190, 203, 205, 206, 214, 228, 257,</div><div class="line">185, 197, 201, 231,</div><div class="line">187, 212, 215, 220, 248, 265, 281,</div><div class="line">202, 204, 207, 227, 230, 276),</div><div class="line">g=factor(rep(1:4, c(8,4,7,6)))</div><div class="line">)</div><div class="line">kruskal.test(x~g, data=food)</div></pre></td></tr></table></figure>
<p>另一种写法 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">kruskal.test(food$x, food$g)</div></pre></td></tr></table></figure></p>
<p>或 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">A&lt;-c(164, 190, 203, 205, 206, 214, 228, 257)</div><div class="line">B&lt;-c(185, 197, 201, 231)</div><div class="line">C&lt;-c(187, 212, 215, 220, 248, 265, 281)</div><div class="line">D&lt;-c(202, 204, 207, 227, 230, 276)</div><div class="line">kruskal.test(list(A,B,C,D))</div></pre></td></tr></table></figure></p>
<p>　　利用R做Nemenyi的检验方法有人介绍过，SPSS里面没有现成的方法，需要编程，这里用R来做一下这个检验，原文是在丁香园引用的，参见<a href="http://www.dxy.cn/bbs/thread/26928446#26928446" target="_blank" rel="external">（R语言）秩和检验后两两比较方法之Nemenyi 检验及其他</a>这篇帖子。　　</p>
<p>原题：比较以下三组之间的数据，看有无差异<br>
第一组：293,409,392,213,409,57,97,244,254,352,168； 第二组：441,538,390,589,244,409,72,168,254,374 ； 第三组：807,833,409,914,380,883,254,993,667 ； 将上面三组数据录入data20140501，分两列，第一列为cd，第2列为group，存为csv格式。</p>
<p>源代码如下： <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">datanemenyi &lt;- read.csv(&quot;D:/Tutorial/20151219Statistics/data/rdata/data20140501.csv&quot;) #导入源数据文件  </div><div class="line">str(datanemenyi) #查看数据结构</div><div class="line">datanemenyi$group &lt;- as.factor(datanemenyi$group);datanemenyi #将group转化为因子类型  </div><div class="line">kruskal.test(cd~group, data=datanemenyi)  # Kruskal-Wallis检验，类似于参数检验的ANOVA检验  </div><div class="line"></div><div class="line">library(pgirmess)</div><div class="line">library(coin)  </div><div class="line">library(multcomp) # 安装并加载要用到的包  </div><div class="line">kruskalmc(cd~group, data=datanemenyi, probs=0.05) # 使用kruskalmc函数做两两比较，此法不能给出精确p值  </div><div class="line"></div><div class="line">mult &lt;- oneway_test(cd ~ group, data = datanemenyi,</div><div class="line">   ytrafo = function(data) trafo(data, numeric_trafo = rank),</div><div class="line">  xtrafo = function(data) trafo(data, factor_trafo = function(x)</div><div class="line">  model.matrix(~x - 1) %*% t(contrMat(table(x), &quot;Tukey&quot;))),</div><div class="line">  teststat = &quot;max&quot;, distribution = approximate(B = 90000))</div><div class="line"></div><div class="line">pvalue(mult, method = &quot;single-step&quot;)</div></pre></td></tr></table></figure></p>
<p>这个结果与原代码的运行结果不同</p>
<h2 id="参考资料">参考资料</h2>
<ol style="list-style-type: decimal">
<li>关于Nemenyi检验的方法是参照丁香园的，原贴地址如下，帖子的作者有把写过《医学统计学及SAS应用》之R语言实现这本电子书，下载地址如下:<a href="http://www.dxy.cn/bbs/thread/26928446#26928446" target="_blank" rel="external">Nemenyi检验方法</a></li>
<li><a href="http://d.dxy.cn/detail/6143147" target="_blank" rel="external">《医学统计学及SAS应用》之R语言实现</a></li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2018/06/13/BIoTools/高通量qPCR均一化方法总结/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/06/13/BIoTools/高通量qPCR均一化方法总结/" itemprop="url">高通量qPCR均一化方法总结</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-06-13T12:00:00+08:00">
                2018-06-13
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/生信工具/" itemprop="url" rel="index">
                    <span itemprop="name">生信工具</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  685
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  3
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>去年看到一篇讲miRNA的文献，这篇文献的信息如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Zhang, B. J., et al. (2016). &quot;MicroRNA-23a Curbs Necrosis during Early T Cell Activation by Enforcing Intracellular Reactive Oxygen Species Equilibrium.&quot; Immunity 44(3): 568-581.</div></pre></td></tr></table></figure>
<p>这篇文章是杜克大学的李启靖教授于2016年发表在Immunity上的，这里只讲一下文章前面对miRNA高通量数据的筛选，常规的miRNA数据来源是芯片，测序，但这篇文献里面的miRNA数据表达谱是用RT-qPCR法做的（原理就是反转录部分采用了检测miRNA的加尾法，在qPCR部分使用了Labcyte的Echo550声波移液器与ABI ViiA7高通量qPCR仪)。一共做了300多个miRNA，文献附件中给出了每个样本的每个miRNA的相对表达值，与原始Ct值。在这里重复一下文献中的数据分析。</p>
<p>先看一下文献中最终的数据（只列了前5行），如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190325210137.png">

</div>
<p>再看一下相应的原始数据：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190325210208.png">

</div>
<p>从原始数据上大致可以猜出已经扣了内参（文献中提到了使用了4个内参，多内参均一化是采用几何平均数的方法来处理的）。</p>
<p>现在描述一下如何计算。</p>
<p>第一步，均一化原始数据，将原始数据导入R中，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">setwd(<span class="string">"D:\netdisk\bioinfo.notes\MicroRNA-23a Curbs Necrosis during Early T Cel"</span>)</div><div class="line">rawdata_miRNA &lt;- read.delim(<span class="string">"clipboard"</span>,header=<span class="literal">T</span>)</div><div class="line">str(rawdata_miRNA)</div><div class="line">raw_array &lt;- as.matrix(rawdata_miRNA[,<span class="number">2</span>:<span class="number">11</span>])</div><div class="line">raw_norm &lt;- t(apply(raw_array,<span class="number">1</span>,scale))</div><div class="line">colnames(raw_norm) &lt;- colnames(rawdata_miRNA)[-<span class="number">1</span>]</div><div class="line">dimnames(raw_norm)[<span class="number">1</span>] &lt;- rawdata_miRNA[<span class="number">1</span>]</div><div class="line">write.csv(raw_norm,<span class="string">"Literature_norm.csv"</span>)</div></pre></td></tr></table></figure>
<p>第二步，打开导出的数据（这里只显示了前5行），如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190325210416.png">

</div>
<p>将计算结果与文献附件中的计算结果对比，下面是文献附件中的均一化后的结果：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190325210451.png">

</div>
<p>可以发现，计算结果与文献中的结果基本上是一致的，现在计算每组样本中每个miRNA相对表达量。</p>
<p>第三步，在计算每组样本中每个miRNA相对表达量的同时，要先求相同样本之间的平均数，例如第14天的有2个样本，第5天有2个样本，求它们平均数，有的只有1个样本，不用管（其中1个样本是3只小鼠的混合样本，具体的可以参考文献的Methods部分），计算结果如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190325210644.png">

</div>
<p>第四步，求相对表达量，直接以上面的数据的相反数为2的指数求幂即可，例如Naïve组的Let-7a是0.2983，则其相对表达量就是2^-0.2983=0.81321，再乘以100，同理，求出所有样本中miRNA的相对表达量，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190325210722.png">

</div>
<p>再看一下文献中的数据，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190325210743.png">

</div>
<p>可以发现两者的数据是一样的。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2018/06/12/BIoTools/分析miRNA时空表达的聚类工具/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/06/12/BIoTools/分析miRNA时空表达的聚类工具/" itemprop="url">生信-一个分析miRNA时空表达的聚类工具</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-06-12T12:00:00+08:00">
                2018-06-12
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/生信工具/" itemprop="url" rel="index">
                    <span itemprop="name">生信工具</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  1,192
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  4
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="文献信息">文献信息</h2>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Zhang B, Liu S Q, Li C, et al. MicroRNA-23a curbs necrosis during earlyT cell activation by enforcing intracellular reactive oxygen speciesequilibrium[J]. Immunity, 2016, 44(3):568-581.</div></pre></td></tr></table></figure>
<h2 id="文献内容">文献内容</h2>
<p>这篇文献是2016年发在《Immunity》的，文献的主要内容是，当宿主细胞与抗原接触时，细胞内就会产生活性氧基团（ROS），参与T细胞受体（TCR）的信号转导，但是如果ROS的生成不受控制的话，ROS就会对组织造成损伤。作者研究的则是某个miRNA参与了这个过程，在筛选过程中，作者找到了一个miRNA，即miR-23a，它参与细胞的保护。从机理上讲，miR-23a的靶基因是PPIF，PPIF的作用是控制线粒体通透性转换孔，因此miR-23a作用于PPIF，能够阻止ROS的流入，从而维持线粒体的完整性。我们所关注的重点就是作者有关miRNA的筛选工作。为了寻找miRNA介导的抗原诱导CD4 T细胞的应答。作者研究了不同时间点，CD4 T细胞的miRNA表达谱。具体操作是，从转基因LLO118 TCR（LLO118-Thy1.2+）小鼠体内取出20万个naive CD4 T细胞，转移到野生型小鼠（Thy1.1+）体内，接着给野生型小鼠注射亚致死剂量的Listeria菌（LLO是Listeria菌的一个蛋白），然后在不同的时间点，收集小鼠的抗原特异性CD4 T细胞，用高通量qPCR的手段检测miRNA的表达谱（一共是361个miRNA），时间点是6个（分别是第0天，第3天，第5天，第7天，第14天，第28天。</p>
<p>我们处理这些数据的常规方法就是做热图，热图虽然能够聚类，但是很难反应出miRNA不同的聚类随时间变化的趋势，作者在处理这些数据时，采用了一个工具，叫ExpressCluster，这个工具能将不同时间的表达谱进行聚类，并且将不同的聚类结果以时间的形式呈现出现，如文献中的fig.1a所示（文献中一共有9个聚类，作者选择了第3个聚类）的那样。因此，这个工具很适应用于研究不同时间点基因表达谱的变化。</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190325213231.jpg">

</div>
<p>我们就介绍一下这个工具如何使用，首先去官网下载相应的工具，下载后解压即可，里面有3个文件，一个是ExpressCluster程序，一个是使用手册，另外一个不用管。如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190325213251.jpg">

</div>
<p>现在我们利用文献的原始数据重复一下文献中的图片生成过程。此过程包括：下载原始数据（文献的附件里中有原始文件，也有均一化后的数据），修改为GCT格式，导入ExpressCluster生成聚类图，前面均一化的过程比较简单，我们略去不讲，直接进入转换GCT文件这一步。</p>
<p>GCT文件格式是一类制表符分隔的文件，它描述的是基因的表达数据，它的数据格式如下图所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190325213311.jpg">

</div>
<p>后文的网址中有GCT的参考数据，下载下来，用Excel就可以打开，打开时，文献类型选择“所有文件”，</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190325213337.jpg">

</div>
<p>将其中的数据替换为文献中的数据：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190325213356.jpg">

</div>
<p>需要注意的一点是，黄色标注的地方需要修改，361表示检测的基因是361个，6表示数据有6组，Description不用管。保存后，就可以用ExpressCluster打开了，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190325213414.jpg">

</div>
<p>AVAILABLE（红色方框）中的是每组数据的名称，选中它们，单击绿色箭头，转移到SELECTED中，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190325213438.jpg">

</div>
<p>接着，单击APPLY绿色按钮（上图），过滤数据，再在下面的Clusters（K）（绿色方框）中输入聚类的数目，文献中是9组，我们这里输入9，随后，最下面的GENERATE（红色方框）会变成蓝色，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190325213457.jpg">

</div>
<p>单击后，开始生成聚类图，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190325213517.jpg">

</div>
<p>在右上角的查询框（红色方框）中输入miR-23a，查询miR-23a的位置，发现miR-23a在cluster3中，此时再单击右侧中的f(x)（红色方框），可以在相对值与实际值之间进行转换，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190325213530.jpg">

</div>
<p>保存图片（绿色方框），生成的图片如下：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190325213543.png">

</div>
<p>此外，该工具还能生成热图，单击下图中的红色方框，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190325213602.png">

</div>
<p>生成的热图如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190325213616.png">

</div>
<p>ExpressCLuster中还有许多高级功能，此篇教程只是简单地入门，重复了一下文献中的图形，具体的其他操作可以参照操作手册。</p>
<p><strong>参考资料；</strong></p>
<ol style="list-style-type: decimal">
<li><p>GCT文件格式：http://software.broadinstitute.org/cancer/software/genepattern/file-formats-guide#GCT</p></li>
<li><p>ExpressCluster下载地址：http://cbdm.hms.harvard.edu/LabMembersPges/SD.html</p></li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2018/06/07/StatQuest/生物统计-StatQuest学习笔记05-线性模型/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/06/07/StatQuest/生物统计-StatQuest学习笔记05-线性模型/" itemprop="url">StatQuest学习笔记05——线性模型</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-06-07T12:10:54+08:00">
                2018-06-07
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/生统之StatQuest/" itemprop="url" rel="index">
                    <span itemprop="name">生统之StatQuest</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  12,136
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  47
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="前言主要内容">前言——主要内容</h2>
<p>这篇笔记是StatQuest视频教程的第16到22。其中第16内容是线性回归（Linear Regression，它也叫一般线性模型 即General Linear Models）的基本原理；第17内容是在R语言中进行线性回归；第18内容是多重线性回归；第19内容是R主语言与多重线性回归；第20内容是一般线性模型中的t检验与ANOVA；第21内容是设计矩阵；第22内容是在R语言中设计矩阵。</p>
<h2 id="线性回归主要思想">线性回归主要思想</h2>
<p>线性回归的主要思想就是利用最小二乘法找到最佳拟合曲线，计算<span class="math inline">\({R}^2\)</span>，计算p值，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707093039.png">

</div>
<p>在第4篇笔记中，我们利用了最小二乘法计算了小鼠的体重与大小的线性关系，具体的计算过程可以参见上一篇笔记，最终的线性回归方程如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707093122.png">

</div>
<p>由于这个方程的斜率不为0，因此我们知道小鼠的体重的话，就能够预测小鼠的大小。此时我们要看一下这个回归方程的好坏程度，也就是看一下<span class="math inline">\({R}^2\)</span>的意义，第一步，计算小鼠的平均大小，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707093137.png">

</div>
<p>将这些小鼠大小的点投射到y轴上，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707093153.png">

</div>
<p>下图中的黑色横线就是小鼠大小的平均值，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707093205.png">

</div>
<p>接着计算离均差平方和（SS），这里需要与残差平方和进行区分。</p>
<p>离均差平方和是指一组数据中，每个数据与均值差值的平方，英文就是SS，全称为sum of squares of deviation from mean ），而残差平方和（SSE）是指观察值与拟合值之间的差异的平方，图计算的是SS：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707093217.png">

</div>
<p>SS的公式，而这组数据的方差则是指SS除以样本数，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707093228.png">

</div>
<p>此时再回到原始数据，我们将通过最小二乘得到的曲线与每个原始值差值的平方加起来，这个是残差平方和SS(fit)（这个其实就是上篇笔记中提到的SSE），残差平方和除以样本数，就是残差的平均方差（即Var(fit)=SS(fit)/n，这个值没有找到相应的术语），它的公式如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707093239.png">

</div>
<p>通常来说，变异等于总的离均差平方和除以样本数，也就是均方差，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707093256.png">

</div>
<p>下图的左图是小鼠的大小的变异（variance），右图是原始数据与回归曲线之间的变异：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707093309.png">

</div>
<p>如果将上述左图的点与自身均值差值的平方和与右图中原始数据的点和拟合的曲线的距离相比，右边这种通过最小二乘法得到的曲线的变异更小。因此我们在右图中可以知道，如果考虑了小鼠的体重，那么这条曲线可以解释小鼠大小的变异，也就是说，小鼠体重越大，它的大小就越大，反之，也是如此，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707093319.png">

</div>
<p><span class="math inline">\({R}^2\)</span>指的就是小鼠的体重可以解释小鼠大小的程度，它的公式如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707093343.png">

</div>
<p>经计算，发现原始数据的均方差为11.1，拟合曲线的均方差为4.4，那么<span class="math inline">\({R}^2\)</span>的结果如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707093429.png">

</div>
<p>从上图我们可以说，当考虑了小鼠的体重时，小鼠的大小的变异程度会降低60%（这是与原始数据只考虑小鼠的大小，不考虑小鼠的体重相比），也可以说，小鼠大小的变异可以解释小鼠体重变异的60%。</p>
<p>我们也可以采用平方和来计算，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707093445.png">

</div>
<p>我们再看一个案例，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707093619.png">

</div>
<p>在这个案例中，拟合曲线的变异是0，因此小鼠的体重可以解释小鼠大小100%的变异。</p>
<p>再看一个案例，在这个案例中，我们知道小鼠的体重，但是无法根据小鼠的体重来预测小鼠的大小，因为原始数据的变异为11.1，拟合曲线的变异也是11.1，那么<span class="math inline">\({R}^2\)</span>就等于0，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707093629.png">

</div>
<p>当我们计算离均差平方和（SS(mean)）时，我们会将忽略小鼠的体重，将每个数据点投射到y轴（也就是小鼠的大小上），如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707093653.png">

</div>
<p>此时我们绘制一条小鼠大小的平均值曲线，如下图所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707093704.png">

</div>
<p>此时计算这些数据点距离这个平均值曲线的距离，也就是SS(mean）)，最终我们会得到这个回归曲线，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707093716.png">

</div>
<p>以上就是最小二乘法求线性回归的基本思想，它可以应用到更复杂的公式中去，它的思想就是，先计算原始数据的离均差平方和SS(mean)，再计算这些数据与拟合曲线的的差值平方和，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707093729.png">

</div>
<h2 id="复杂案例">复杂案例</h2>
<p>此时我们再看一个稍微复杂的案例。</p>
<p>还是以小鼠为例说明，如果我们知道小鼠的体重（<code>weight</code>），尾巴长度（<code>tail length</code>）和小鼠的身体长度（<code>body length</code>），我们就可以根据前两个变量来预测第三个变量，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707093740.png">

</div>
<p>此时，我们将这3个变量投射到一个三维坐标系中，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707093757.png">

</div>
<p>例如我们有一个数据，它在坐标中的位置就如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707093807.png">

</div>
<p>现在把所有的数据点都放到这个坐标中，则如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707093825.png">

</div>
<p>此时，我们利用最小二乘法来计算拟合曲线，由于这是三维坐标，这个曲线其实是不是曲线（在二维坐标中是曲线，在三维坐标中就是一个平面了），而是一个平面，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707093836.png">

</div>
<p>这个平面的方程就如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707093907.png">

</div>
<p>其中，y是身体长度，x是体重，z是尾巴长度，而0.1则是在y轴上的截矩。如果我们知道一个小鼠的体重和尾巴长度，那么我们就能计算出小鼠的身体长度，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707093920.png">

</div>
<p>此时，我们按照二维坐标的计算方式来计算<span class="math inline">\({R}^2\)</span>，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707093932.png">

</div>
<p>此时，这个z轴数据是没用的，它并不会用于计算SS(fit)，此时可以将z值视为0并不会影响预测小鼠的身体长度，然后使用最小二乘法，如下所示（这一步的推导过程我不理解）：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707093947.png">

</div>
<p>在上图中，把z视为0，意味着，与更少的参数相比，更多的参数并不会让SS(fit)更差（字面翻译，具体原理还没弄懂）。换句话说，像下面的这个公式那样：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707094001.png">

</div>
<p>虽然Mouse size这个等号后面有很多参数，但是这个公式与下面Mouse size = 0.3 + mouse weight是差不多的，剔除的那几个参数并不会影响Mouse size，因此可以把那些不必要的参数系数设为0，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707094010.png">

</div>
<p>由于存在一些随机因素，小老鼠在这个数据集中得到硬币朝上（get heads）概率并不比大老鼠的高，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707094028.png">

</div>
<p>因此在这个公式中，如果有更多的参数，那么我们就有了更多的随机事情来降低SS(fit)，导致产生一个更好的<span class="math inline">\({R}^2\)</span>，因此人们会使用一个调整的<span class="math inline">\({R}^2\)</span>（adjusted <span class="math inline">\({R}^2\)</span>，从本质上来讲，就是参数的数据来对<span class="math inline">\({R}^2\)</span>进行校正。</p>
<p><span class="math inline">\({R}^2\)</span>虽然是一个很重要的指标，但是它也有一些局限，看下面的案例：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707094042.png">

</div>
<p>在上图中，只有2个点，计算的SS(mean)=10，SS(fit)=0，后者等于0是因为你总能画出经过两个点的直线，并求出其方程，因此求出的R的平方就是100%，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707094053.png">

</div>
<p>虽然R的平方是100%，这是一个很好的数字，但是任意两个数字都能得到同样的R的平方（其实在利用Qubit测文库的时候，就只是使用了2个标准品，标准品虽然含量非常准，但也是一个非常粗糙的估计，因此在对文库进行定量时，还要配合使用qPCR），下面的这两个数字得到的R的平方也是100%，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707094106.png">

</div>
<p>为了解决这个问题，我们需要研究一下R的平方是否有统计学意义，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707094123.png">

</div>
<p>在计算p值之前，我们先看一下<span class="math inline">\({R}^2\)</span>是如何定义的，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707094136.png">

</div>
<p>在小鼠的体重与大小的数据中，我们得到的<span class="math inline">\({R}^2\)</span>是0.6，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707094146.png">

</div>
<p>在计算<span class="math inline">\({R}^2\)</span>方面，我们会使用一个统计量，即F，F的公式如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707094159.png">

</div>
<p><span class="math inline">\({R}^2\)</span>的计算公式和F统计量的计算公式的分子是一样的，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707094209.png">

</div>
<p>这个分子的意义就是小鼠体重的变异，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707094220.png">

</div>
<p>F的分母有点不太一样，它的意义如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707094230.png">

</div>
<p>在上图中，下图中的蓝色虚线就是拟合曲线与实际值的差值，它的平方和就变异程度，也就是无法被体重解释的小鼠大小的程度，现在再看一下<span class="math inline">\({R}^2\)</span>和F统计量的公式，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707094241.png">

</div>
<p>这两个公式的有一部分是一样的，也就是那些平方和，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707094253.png">

</div>
<p>转换到图形上，则是这个样子：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707094304.png">

</div>
<p>F统计量分母中的一部分是拟合后的平方和，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707094317.png">

</div>
<p>F后面的那一坨东西是自由度，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707094327.png">

</div>
<p>我们此时看一下什么是自由度，就先从红色方框中的部分开始，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707094337.png">

</div>
<p>拟合曲线中有2个参数，即y=y-intercept + slope x中有intercept和slope这两个参数，它就有2个自由度，而均值的公式是y=y-intercept，它只有一个参数，因此它就是1个自由度。换话句话说，与均值的公式相比，拟合曲线多了一个自由度，即斜率，斜率代表了体重与大小的关系，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707094350.png">

</div>
<p>那么原来红色方框中的那一部分的值就是1，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707094401.png">

</div>
<p>那么F统计量的分子就是由这个多出来的参数解释的变异程度，在这个案例中，就是由小鼠的体重解释小鼠大小的变异程度，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707094410.png">

</div>
<p>如果我们使用小鼠的体重，尾巴长度来解释小鼠大小的变异，就是这个样子：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707094506.png">

</div>
<p>它的拟合曲线的自由度就是3，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707094529.png">

</div>
<p>此时我们再看一下F统计量的分子，这个分母就是由拟合曲线无法解释的程度，这个分母中的有一个参数n，随后我们会解释，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707094541.png">

</div>
<p>直观上讲，如果我们的公式中有更多的的参数，那么我们就需要多的数据来估计它们，例如我们只需要2个点就能绘制出一条直线，但是我们如果要绘制一个平面，那么至少需要3个点。再接着看F统计量，如果拟合曲线比较好，那么F的值就是一个比较大的数字（从公式上也能看出来，拟合比较好的话，肯定是我们解释的程度要远远大于不能解释的程度），如下图所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707094600.png">

</div>
<p>此时，我们需要把F值转换为p值，先看一个小案例，下面的是一组随机数据，它们计算出来的F值是2，把F值绘制到一个直方图上，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707094614.png">

</div>
<p>再来看一组数据，计算其SS(mean)和SS(fit)，计算F值，再添加到直方图上，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707094624.png">

</div>
<p>再来计算一组随机数据，方法同上，得到F值为1，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707094637.png">

</div>
<p>不断地重复这个过程，我们会得到很多F值，然后把它们都绘制到直方图上，例如其中一个F值是6，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707094648.png">

</div>
<p>从上面的这个图中我们可以知道这些信息：</p>
<ol style="list-style-type: decimal">
<li>x轴上对应的是F值，从左到右依次增大；</li>
<li>F值越大，这个F值的点占到整个直方图中的比例也就越低，换句话讲，就是F值更大，它就是一个越不容易得到的值，如果把得到F值的这个概率定为p，那么，F值越大，p值就越小（也就是说F值越大，它越是一个极端的值，不太容易出现）。</li>
</ol>
<p>此时，把上面的直方图用一条曲线拟合起来，事实上，我们在计算F值对应的p值时，通常是使用曲线，而不是直方图，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707094830.png">

</div>
<p>此时我们看一个F值的分布，F值的分布曲线是由其自由度决定的，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707094846.png">

</div>
<p>再看由两个F分布叠加的图形，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707094901.png">

</div>
<p>从这张图形上我们可以看出，自由度越大，F分布的曲线下降得越厉害，也就是说，拟合曲线中的参数越多（自由度高），样本数目赵多，p值越小。其实这也是F分布的原理。</p>
<h2 id="r语言与线性回归">R语言与线性回归</h2>
<p>此时我们看一下原始数据，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">weight = <span class="number">0.9</span>, <span class="number">1.8</span>, <span class="number">2.4</span>, <span class="number">3.5</span>, <span class="number">3.9</span>, <span class="number">4.4</span>, <span class="number">5.1</span>, <span class="number">5.6</span>, <span class="number">6.3</span></div><div class="line">size = <span class="number">1.4</span>, <span class="number">2.6</span>, <span class="number">1.0</span>, <span class="number">3.7</span>, <span class="number">5.5</span>, <span class="number">3.2</span>, <span class="number">3.0</span>, <span class="number">4.9</span>, <span class="number">6.3</span></div></pre></td></tr></table></figure>
<p>此时绘制出小鼠的体重与其大小的散点图，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">weight &lt;- c(<span class="number">0.9</span>, <span class="number">1.8</span>, <span class="number">2.4</span>, <span class="number">3.5</span>, <span class="number">3.9</span>, <span class="number">4.4</span>, <span class="number">5.1</span>, <span class="number">5.6</span>, <span class="number">6.3</span>)</div><div class="line">size &lt;- c(<span class="number">1.4</span>, <span class="number">2.6</span>, <span class="number">1.0</span>, <span class="number">3.7</span>, <span class="number">5.5</span>, <span class="number">3.2</span>, <span class="number">3.0</span>, <span class="number">4.9</span>, <span class="number">6.3</span>)</div><div class="line">mouse.data &lt;- data.frame(weight, size)</div><div class="line">head(mouse.data)</div><div class="line">plot(mouse.data$weight,mouse.data$size)</div><div class="line">mouse.regression &lt;- lm(size~weight, data=mouse.data)</div><div class="line">summary(mouse.regression)</div></pre></td></tr></table></figure>
<p>图形如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707094916.png">

</div>
<p>线性回归统计结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">&gt; summary(mouse.regression)</div><div class="line"></div><div class="line">Call:</div><div class="line">lm(formula = size ~ weight, data = mouse.data)</div><div class="line"></div><div class="line">Residuals:</div><div class="line">    Min      1Q  Median      3Q     Max </div><div class="line">-<span class="number">1.5482</span> -<span class="number">0.8037</span>  <span class="number">0.1186</span>  <span class="number">0.6186</span>  <span class="number">1.8852</span> </div><div class="line"></div><div class="line">Coefficients:</div><div class="line">            Estimate Std. Error t value Pr(&gt;|t|)  </div><div class="line">(Intercept)   <span class="number">0.5813</span>     <span class="number">0.9647</span>   <span class="number">0.603</span>   <span class="number">0.5658</span>  </div><div class="line">weight        <span class="number">0.7778</span>     <span class="number">0.2334</span>   <span class="number">3.332</span>   <span class="number">0.0126</span> *</div><div class="line">---</div><div class="line">Signif. codes:  <span class="number">0</span> ‘***’ <span class="number">0.001</span> ‘**’ <span class="number">0.01</span> ‘*’ <span class="number">0.05</span> ‘.’ <span class="number">0.1</span> ‘ ’ <span class="number">1</span></div><div class="line"></div><div class="line">Residual standard error: <span class="number">1.19</span> on <span class="number">7</span> degrees of freedom</div><div class="line">Multiple R-squared:  <span class="number">0.6133</span>,	Adjusted R-squared:  <span class="number">0.558</span> </div><div class="line"><span class="literal">F</span>-statistic:  <span class="number">11.1</span> on <span class="number">1</span> and <span class="number">7</span> DF,  p-value: <span class="number">0.01256</span></div></pre></td></tr></table></figure>
<p>现在解释一下这个结果：</p>
<p>第一部分：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Call:</div><div class="line">lm(formula = size ~ weight, data = mouse.data)</div></pre></td></tr></table></figure>
<p>这一行表示的是使用<code>lm()</code>函数进行线性回归的公式，这里的size是自变量，weight是因变量，数据集来源于<code>mouse.data</code>。</p>
<p>第二部分：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">Residuals:</div><div class="line">    Min      1Q  Median      3Q     Max </div><div class="line">-<span class="number">1.5482</span> -<span class="number">0.8037</span>  <span class="number">0.1186</span>  <span class="number">0.6186</span>  <span class="number">1.8852</span></div></pre></td></tr></table></figure>
<p>这是残差的结果，它表示原始数据距离拟合曲线的距离的 一些统计情况，如果是理想情况，那么正值与负值的频率是一样的，也就是说原始值在拟合曲线上方与下方的点是一样的。</p>
<p>第三部分：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">Coefficients:</div><div class="line">            Estimate Std. Error t value Pr(&gt;|t|)  </div><div class="line">(Intercept)   <span class="number">0.5813</span>     <span class="number">0.9647</span>   <span class="number">0.603</span>   <span class="number">0.5658</span>  </div><div class="line">weight        <span class="number">0.7778</span>     <span class="number">0.2334</span>   <span class="number">3.332</span>   <span class="number">0.0126</span> *</div><div class="line">Signif. codes:  <span class="number">0</span> ‘***’ <span class="number">0.001</span> ‘**’ <span class="number">0.01</span> ‘*’ <span class="number">0.05</span> ‘.’ <span class="number">0.1</span> ‘ ’ <span class="number">1</span></div><div class="line"></div><div class="line">Residual standard error: <span class="number">1.19</span> on <span class="number">7</span> degrees of freedom</div></pre></td></tr></table></figure>
<p>这一部分是经过最小二乘法计算得到出的拟合曲线的系数，其中第1列第1个数字0.5813，就是截矩，截矩下方的0.7778是斜率，那么得到的拟合曲线公式就是：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">size = <span class="number">0.5813</span> + <span class="number">0.7778</span> x weight</div></pre></td></tr></table></figure>
<p>第2列与第3列是回归曲线的截矩与斜率的标准差与t值。第4列，也就是最后一列，是这些估计值的p值，通常来说，我们并不关注截矩的这个值。也就是说，它的p值大小我们不乎。但是，斜率，也就是说<code>weight</code>的这个p值必须要小于0.05，也就是说，它必须要有统计学意义，只有这样，我们才能对小鼠的大小进行一个可靠的估计，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707094938.png">

</div>
<p>这个案例的线性回归结果中，<code>weight</code>的p值是小于0.05的，也就是说它有意义，它后面有一个<code>*</code>号，这个<code>*</code>表示p值大于0.01，小于0.5，我们可以在统计结果中看到<code>*</code>的数量对应的p值大小。</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707095003.png">

</div>
<p>最后一行是下面的内容：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Residual standard error: <span class="number">1.19</span> on <span class="number">7</span> degrees of freedom</div></pre></td></tr></table></figure>
<p>它表示，拟合曲线有7个自由度，残差的标准差为1.19。</p>
<p>第四部分：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Multiple R-squared:  <span class="number">0.6133</span>,	Adjusted R-squared:  <span class="number">0.558</span> </div><div class="line"><span class="literal">F</span>-statistic:  <span class="number">11.1</span> on <span class="number">1</span> and <span class="number">7</span> DF,  p-value: <span class="number">0.01256</span></div></pre></td></tr></table></figure>
<p>在这一部分的结果中，我们可以得到这些信息：</p>
<ol style="list-style-type: decimal">
<li><code>Multiple R-squared:  0.6133</code>表示的是<span class="math inline">\({R}^2\)</span>，它表示体重可以解释61%的小鼠大小的变异，这已经是很好的结果了；</li>
<li><code>Adjusted R-squared:  0.558</code>这个是由参数的多少调控后的<span class="math inline">\({R}^2\)</span>的值；</li>
<li><code>F-statistic:  11.1 on 1 and 7 DF,</code>这表示F的统计量为11.1，1和7是两个自由度；</li>
<li><code>p-value: 0.01256</code>这是F统计量对应的结果。</li>
</ol>
<p>最后我们可以在这个散点图上添加拟合曲线，输入命令<code>abline(mouse.regression, col=&quot;blue&quot;)</code>即可，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707095037.png">

</div>
<h2 id="多元线性回归">多元线性回归</h2>
<p>前面我们讲的线性回归其实只有2个变量（小鼠的体重与小鼠的大小），这种线性回归可以视为简单线性回归，其实线性回归还可以涉及到多个变量，这就是多元线性回归。而很多不太理解线性回归的人通常认为简单线性回归与多元线性回归差异很大，其实它们在本质上没多少区别。下图的左图是简单线性回归，右图是多元线性回归，在计算<span class="math inline">\({R}^2\)</span>方面，它们没有区别，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707095051.png">

</div>
<p>在多元线性回归中，需要对<span class="math inline">\({R}^2\)</span>进行调整，从而与多元线性回归方程中的多个参数对应，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707095108.png">

</div>
<p>在计算F值时，这两种回归的原理是一样的，只是简单线性回归的p(fit)=2，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707095122.png">

</div>
<p>多元线性回归的p(fit)=3（只是在这个案例中，多元线性回归的p(fit)=3，如果是其他的案例，还要具体情况具体分析），如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707095132.png">

</div>
<p>它们的截矩都是一样的，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707095143.png">

</div>
<p>此时我们分别将这两种回归方程中各个数据点与截矩进行对比，来找出这两个回归的优劣：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707095152.png">

</div>
<p>比较均值可能不太容易看出来，我们可以将这两个回归直接相互进行对比，我们就能知道，我们是否值得花时间和精力收集额外的一个数据，并将其添加到回归方程中，即一个小鼠尾巴（tail length）这个数据，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707095201.png">

</div>
<p>此时，我们按照之前计算F的方法来计算一下这两个线性回归方和的F值，跟先前计算F值不太相同的地方在于，我们使用了简单线性回归的来替换原来的均值，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707095214.png">

</div>
<p>SS(simple)如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707095228.png">

</div>
<p>此时，p(simple)=2，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707095244.png">

</div>
<p>SS(multiple)如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707095255.png">

</div>
<p>而p(multiple)=3，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707095305.png">

</div>
<p>如果简单线性回归和多元线性回归的<span class="math inline">\({R}^2\)</span>差值很大，并且p值很小，那么向简单线性回归中添加一个小鼠尾巴变量（tail length）就是有必要的，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707095326.png">

</div>
<h2 id="r语言与多重线性回归">R语言与多重线性回归</h2>
<p>此时，我们添加上小鼠尾巴的数据，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">tail = <span class="number">0.7</span>, <span class="number">1.3</span>, <span class="number">0.7</span>, <span class="number">2.0</span>, <span class="number">3.6</span>, <span class="number">3.0</span>, <span class="number">2.9</span>, <span class="number">3.9</span>, <span class="number">4.0</span></div></pre></td></tr></table></figure>
<p>构建小鼠的三个变量的数据框，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">weight &lt;- c(<span class="number">0.9</span>, <span class="number">1.8</span>, <span class="number">2.4</span>, <span class="number">3.5</span>, <span class="number">3.9</span>, <span class="number">4.4</span>, <span class="number">5.1</span>, <span class="number">5.6</span>, <span class="number">6.3</span>)</div><div class="line">size &lt;- c(<span class="number">1.4</span>, <span class="number">2.6</span>, <span class="number">1.0</span>, <span class="number">3.7</span>, <span class="number">5.5</span>, <span class="number">3.2</span>, <span class="number">3.0</span>, <span class="number">4.9</span>, <span class="number">6.3</span>)</div><div class="line">tail &lt;- c(<span class="number">0.7</span>, <span class="number">1.3</span>, <span class="number">0.7</span>, <span class="number">2.0</span>, <span class="number">3.6</span>, <span class="number">3.0</span>, <span class="number">2.9</span>, <span class="number">3.9</span>, <span class="number">4.0</span>)</div><div class="line">mouse.data &lt;- data.frame(size,weight,tail)</div><div class="line">head(mouse.data)</div></pre></td></tr></table></figure>
<p>构建好的数据框如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">&gt; head(mouse.data)</div><div class="line">  size weight tail</div><div class="line"><span class="number">1</span>  <span class="number">1.4</span>    <span class="number">0.9</span>  <span class="number">0.7</span></div><div class="line"><span class="number">2</span>  <span class="number">2.6</span>    <span class="number">1.8</span>  <span class="number">1.3</span></div><div class="line"><span class="number">3</span>  <span class="number">1.0</span>    <span class="number">2.4</span>  <span class="number">0.7</span></div><div class="line"><span class="number">4</span>  <span class="number">3.7</span>    <span class="number">3.5</span>  <span class="number">2.0</span></div><div class="line"><span class="number">5</span>  <span class="number">5.5</span>    <span class="number">3.9</span>  <span class="number">3.6</span></div><div class="line"><span class="number">6</span>  <span class="number">3.2</span>    <span class="number">4.4</span>  <span class="number">3.0</span></div></pre></td></tr></table></figure>
<h3 id="简单线性回归">简单线性回归</h3>
<p>我们先回顾一下简单线性回归，先绘制小鼠体重与其大小的散点图，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">plot(mouse.data$weight,mouse.data$size)</div></pre></td></tr></table></figure>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707095338.png">

</div>
<p>然后利用<code>lm()</code>函数来对小鼠的这体重和大小这两个变量做回归分析，再用<code>aline()</code>函数添加回归曲线，代码如下：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">simple.regression &lt;- lm(size ~ weight, data=mouse.data)</div><div class="line">summary(simple.regression)</div><div class="line">abline(simple.regressin, col=<span class="string">"red"</span>,lwd = <span class="number">2</span>)</div></pre></td></tr></table></figure>
<p>简单线性回归结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">&gt; summary(simple.regression)</div><div class="line"></div><div class="line">Call:</div><div class="line">lm(formula = size ~ weight, data = mouse.data)</div><div class="line"></div><div class="line">Residuals:</div><div class="line">    Min      1Q  Median      3Q     Max </div><div class="line">-<span class="number">1.5482</span> -<span class="number">0.8037</span>  <span class="number">0.1186</span>  <span class="number">0.6186</span>  <span class="number">1.8852</span> </div><div class="line"></div><div class="line">Coefficients:</div><div class="line">            Estimate Std. Error t value Pr(&gt;|t|)  </div><div class="line">(Intercept)   <span class="number">0.5813</span>     <span class="number">0.9647</span>   <span class="number">0.603</span>   <span class="number">0.5658</span>  </div><div class="line">weight        <span class="number">0.7778</span>     <span class="number">0.2334</span>   <span class="number">3.332</span>   <span class="number">0.0126</span> *</div><div class="line">---</div><div class="line">Signif. codes:  <span class="number">0</span> ‘***’ <span class="number">0.001</span> ‘**’ <span class="number">0.01</span> ‘*’ <span class="number">0.05</span> ‘.’ <span class="number">0.1</span> ‘ ’ <span class="number">1</span></div><div class="line"></div><div class="line">Residual standard error: <span class="number">1.19</span> on <span class="number">7</span> degrees of freedom</div><div class="line">Multiple R-squared:  <span class="number">0.6133</span>,	Adjusted R-squared:  <span class="number">0.558</span> </div><div class="line"><span class="literal">F</span>-statistic:  <span class="number">11.1</span> on <span class="number">1</span> and <span class="number">7</span> DF,  p-value: <span class="number">0.01256</span></div></pre></td></tr></table></figure>
<p>回归曲线如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707095351.png">

</div>
<h3 id="多元线性回归-1">多元线性回归</h3>
<p>绘制多元线性回归的散点图，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">plot(mouse.data)</div></pre></td></tr></table></figure>
<p>图片如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707095406.png">

</div>
<p>在绘制多元线性回归的图形时，不用指定x轴与y轴，R会把所有的变量进行排列组合，绘制出一多个图形，现在解释一下这个图形；</p>
<p>第一：size与weight，x轴是weight，y轴是size</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707095428.png">

</div>
<p>第二，看下面的图形，x轴是size，y轴是weigth：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707095439.png">

</div>
<p>上述的这两个图形是非常相似的，只是它们的坐标轴颠倒了一下：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707095449.png">

</div>
<p>第三，size与tail，这两个变量位于整张图形的对角上，它们的图形也非常相似，也是xy轴颠倒了一下：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707095502.png">

</div>
<p>同样类似的还有weight和tail变量：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707095511.png">

</div>
<p>从图形上我们可以看出来，weight和tail与size相关，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707095520.png">

</div>
<p>weight和tail也有一定的相关关系，这表明，这两个变量也能够为我们提供一些类似的信息，但我们的模型有可能不太需要这些信息：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707095556.png">

</div>
<p>此时，我们使用<code>lm()</code>函数进行多元线性回归分析，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">multiple.regression &lt;- lm(size ~weight + tail, data=mouse.data)</div></pre></td></tr></table></figure>
<p>在R中，我们指定各种变量的位置的依据如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707095617.png">

</div>
<p>默认情况下，y轴截矩和两个斜率如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707095630.png">

</div>
<p>查看一下多元线性回归的结果，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">&gt; summary(multiple.regression)</div><div class="line"></div><div class="line">Call:</div><div class="line">lm(formula = size ~ weight + tail, data = mouse.data)</div><div class="line"></div><div class="line">Residuals:</div><div class="line">     Min       1Q   Median       3Q      Max </div><div class="line">-<span class="number">0.99928</span> -<span class="number">0.38648</span> -<span class="number">0.06967</span>  <span class="number">0.34454</span>  <span class="number">1.07932</span> </div><div class="line"></div><div class="line">Coefficients:</div><div class="line">            Estimate Std. Error t value Pr(&gt;|t|)  </div><div class="line">(Intercept)   <span class="number">0.7070</span>     <span class="number">0.6510</span>   <span class="number">1.086</span>   <span class="number">0.3192</span>  </div><div class="line">weight       -<span class="number">0.3293</span>     <span class="number">0.3933</span>  -<span class="number">0.837</span>   <span class="number">0.4345</span>  </div><div class="line">tail          <span class="number">1.6470</span>     <span class="number">0.5363</span>   <span class="number">3.071</span>   <span class="number">0.0219</span> *</div><div class="line">---</div><div class="line">Signif. codes:  <span class="number">0</span> ‘***’ <span class="number">0.001</span> ‘**’ <span class="number">0.01</span> ‘*’ <span class="number">0.05</span> ‘.’ <span class="number">0.1</span> ‘ ’ <span class="number">1</span></div><div class="line"></div><div class="line">Residual standard error: <span class="number">0.8017</span> on <span class="number">6</span> degrees of freedom</div><div class="line">Multiple R-squared:  <span class="number">0.8496</span>,	Adjusted R-squared:  <span class="number">0.7995</span> </div><div class="line"><span class="literal">F</span>-statistic: <span class="number">16.95</span> on <span class="number">2</span> and <span class="number">6</span> DF,  p-value: <span class="number">0.003399</span></div></pre></td></tr></table></figure>
<p>上述结果与简单线性回归类似，我们看一下最后一部分：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Multiple R-squared:  <span class="number">0.8496</span>,	Adjusted R-squared:  <span class="number">0.7995</span> </div><div class="line"><span class="literal">F</span>-statistic: <span class="number">16.95</span> on <span class="number">2</span> and <span class="number">6</span> DF,  p-value: <span class="number">0.003399</span></div></pre></td></tr></table></figure>
<p><span class="math inline">\({R}^2\)</span>的值为0.8496，调整后的值为0.7995，F值为16.95，p值为0.003399，这个拟合效果是非常好的。</p>
<p>我们再看一下各个自变量的系数，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">Coefficients:</div><div class="line">            Estimate Std. Error t value Pr(&gt;|t|)  </div><div class="line">(Intercept)   <span class="number">0.7070</span>     <span class="number">0.6510</span>   <span class="number">1.086</span>   <span class="number">0.3192</span>  </div><div class="line">weight       -<span class="number">0.3293</span>     <span class="number">0.3933</span>  -<span class="number">0.837</span>   <span class="number">0.4345</span>  </div><div class="line">tail          <span class="number">1.6470</span>     <span class="number">0.5363</span>   <span class="number">3.071</span>   <span class="number">0.0219</span> *</div><div class="line">---</div><div class="line">Signif. codes:  <span class="number">0</span> ‘***’ <span class="number">0.001</span> ‘**’ <span class="number">0.01</span> ‘*’ <span class="number">0.05</span> ‘.’ <span class="number">0.1</span> ‘ ’ <span class="number">1</span></div></pre></td></tr></table></figure>
<p>我们看一下weight这个自变量的系数，并将它与简单线性回归中的weight进行对比，也就是如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707095647.png">

</div>
<p>在多元线性回归中，weight的系数为-0.3293，Pr(&gt;|t|)为0.4345；而在简单线性回归中，weight的系数为0.7778，Pr(&gt;|t|)为0.0126。</p>
<p>这就说明，与只使用tail这一个变量来预测小鼠的大小相比，我们使用weight和tail这两个变量并不是非常显著。</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707095705.png">

</div>
<p>我们再看一下tail这个变量，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707095717.png">

</div>
<p>tail这个变量的p值为0.0219。这就说明，我们使用weight和tail这两个变量比只使用weight这个变量来预测小鼠的大小（size），有显著的区别。</p>
<p>结论就是，我们使用weight和tail这两个变量来预测小鼠的size是比较好的：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707095731.png">

</div>
<p>但是，如果我们精力与时间有限，那么我们可以中使用小鼠的tail来预测其size，不用考虑weight变量：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707095743.png">

</div>
<h2 id="t检验与anova">t检验与ANOVA</h2>
<h3 id="t检验与一般线性模型">t检验与一般线性模型</h3>
<blockquote>
<p>统计学初学者通常会首选接触到t检验、方差分析、线性回归等方法，不少人的感觉就是，t检验用于两组均值比较，方差分析用于多组均值比较，而线性回归则用于自变量对因变量的影响分析。看起来似乎没有什么关系，但它们却统一在一个模型下，这就是一般线性模型（General Linear Model）。一般线性模型并不是一个具体的模型，而是多种方法的统称，像t检验、方差分析、线性回归等都从属于一般线性模型的范畴。</p>
<p>——《白话统计》（冯国双.P22.2018）</p>
</blockquote>
<h3 id="回顾线性回归">回顾线性回归</h3>
<p>线性回归就是对两个变量采用最小二乘法，求出其线性回归方程，从而使用一个变量预测另外一个变量，在前面的案例中，我们就是检测了小鼠的体重和小鼠的大小，从而求出线性回归方向，从线性回归方程中，我们知道这两个特点：</p>
<ol style="list-style-type: decimal">
<li>小鼠的体重对于小鼠的大小预测的效果怎么样（这个要看<span class="math inline">\({R}^2\)</span>，这个值越大，表示预测效果越好）；</li>
<li>我们得到的这个线性回归方程是否有统计学意义（这个要看p值，p值小于某个阈值（通常是0.05）就表示有意义）。</li>
</ol>
<p>如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707095800.png">

</div>
<h3 id="将线性回归方程应用于t检验">将线性回归方程应用于t检验</h3>
<p>此时，我们研究一下能否将线性回归方程的思想应用到t检验上（其实是能的），看下面的案例，在这个案例中，我们有一个对照组，有一个突变组，研究了它们某个基因的表达情况，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707095812.png">

</div>
<p>t检验的目标就在于比较两且数据的均值，并观察它们是否有统计学上的差异，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707095827.png">

</div>
<p>如果有一个相同的方法可以计算线性回归和t检验的p值，那么我们就可以在更加复杂的情况下，使用这种方法：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707095839.png">

</div>
<p>下图分别是线性回归和t检验的散点图：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707095852.png">

</div>
<p>此时， 我们开始计算F值（由F值就能计算出p值）。</p>
<p>第一步：先忽略x轴坐标的意义，分别计算线性回归图形中所有点的均值和t检验中所有点的均值（即把control和mutant这两组数据混在一块，计算出一个均值），如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707095902.png">

</div>
<p>第二步：计算残差平方和，即原始数据点的对应的y轴坐标减去均值，平方后的和，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707095916.png">

</div>
<p>这个计算过程比较简单。</p>
<p>第三步：找出拟合曲线，此时就需要x轴的坐标了：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707095928.png">

</div>
<p>其中线性回归这个图形的拟合曲线很好找，但是t检验这一组的拟合曲线不太好找，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707095938.png">

</div>
<p>此时，我们先针对control组找到一个拟合曲线，其实就是它的均值所在位置：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707095950.png">

</div>
<p>得到的曲线为y=2.2，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707100007.png">

</div>
<p>对于mutant组同样如此，它的回归曲线方程为y=3.6，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707100018.png">

</div>
<p>此时，我们就得到了线性回归这一组数据的拟合曲线，以及t检验这一组中的两条回归曲线，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707100028.png">

</div>
<p>此时，我们将t检验这一组图形中的两条曲线合并为一个方程，接着计算F值：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707100040.png">

</div>
<p>虽然t检验组中的这两条曲线看起来比较诡异，但我们还是能接受的：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707100053.png">

</div>
<p>将这两条曲线的方程合并为一条，那么这个方程就如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707100106.png">

</div>
<p>其中，红色部分表示的是control组的均值，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707100119.png">

</div>
<p>绿色的3.6是mutant组的均值：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707100131.png">

</div>
<p>残差为蓝色的部分，但这条曲线也是比较诡异的，我们计算control组时，它的mutant这组的系数为0，其实就相当于y=1 x 2.2 + residual了，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707100149.png">

</div>
<p>那么control组中的这几个点的计算过程如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707100201.png">

</div>
<p>对于mutant这一组，当我们计算它时，它的control的系数为0，那么这个公式就变成了y = 1 x 3.6 + residual了，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707100213.png">

</div>
<p>计算mutant组的数据时，就是0乘以control，加上1乘以mutant，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707100236.png">

</div>
<p>还有：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707100251.png">

</div>
<p>现在得到了所有的数据点：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707100435.jpg">

</div>
<p>现在我们把这个计算过程中的系数提取出来，看一下：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707100506.jpg">

</div>
<p>这个系数看起来给人的印象就是这样的：在分别计算两组的数据时，它们相应的系数（一个是2.2，一个是3.6）就是像是有一对开关在控制，在control组中，2.2的系数为1，3.6的系数为0，mutant正好相反。因此，提取它们，构成一个设计矩阵，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707100514.jpg">

</div>
<p>这个矩阵我们称为设计矩阵（design matrix），它代表了原始的数据，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707100520.jpg">

</div>
<p>其中column1表示control组的开或关（on or off）：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707100530.jpg">

</div>
<p>column2表示了mutant组的开或关：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707100536.jpg">

</div>
<p>在实际运用中，每个column都已经是默认存在了，那么这个公式就会写为如下形式：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707100547.jpg">

</div>
<p>此时，我们就拟合了control和mutant数据，把它们放到了一个公式里（其实是一个矩阵），现在计算F值和p值了，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707100618.jpg">

</div>
<p>第四步：计算SS(fit)，即实际值与拟合曲线差值的平方和：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707100624.jpg">

</div>
<p>计算结果如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707100632.jpg">

</div>
<p>F值的计算结果如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707100637.jpg">

</div>
<p>在左图的线性回归图形中，ｙ轴表示的是小鼠的平均大小，ｐ(mean)=1，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707100643.jpg">

</div>
<p>在右图的t检验中，y轴表示的是平均基因的表达水平，p(mean)=1，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707100656.jpg">

</div>
<p>同理，线性回归中的p(fit)=2，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707100702.jpg">

</div>
<p>t检验中的p(fit)=2，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707100709.jpg">

</div>
<p>现在计算p值，先看一下过程，先计算一SS(mean)，然后计算SS(fit)，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707100715.jpg">

</div>
<p>t检验的p值和F值的计算至此结束，需要注意的是，我们在前面构建的矩阵并不是t检验的一个标准矩阵（这里先不管这个），接着看ANOVA。</p>
<h3 id="将线性回归方程应用于anova">将线性回归方程应用于ANOVA</h3>
<p>为了方便理解，我们可以将ANOVA看成升级版的t检验，t检验用于比较两组的数据，ANOVA用于比较多组之间的数据，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707100830.jpg">

</div>
<p>第一步：计算SS(mean)：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707100835.jpg">

</div>
<p>第二步：计算SS(fit)：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707100841.jpg">

</div>
<p>第三步：设计矩阵：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707100851.jpg">

</div>
<p>第四步：计算F值</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707100856.jpg">

</div>
<h2 id="设计矩阵">设计矩阵</h2>
<h3 id="矩阵的查看">矩阵的查看</h3>
<p>在后文，一般线性模型（General Linear Models）都缩写为GLM。在前面的部分中，我们提到了，我们设计的那个矩阵并不是一个标准的矩阵（下图左图），右图才是一个标准的t检验矩阵，如下所示：</p>
<p><img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707100911.jpg">这个标准的矩阵对应的这个方程有点不太一样，它的后面是<code>difference(mutant - control)</code>，我们看一下这个新的矩阵：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707100927.jpg">

</div>
<p>在这个矩阵中，第1列所有的数据（control和mutant）都变成了（mean(control)），如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707100935.jpg">

</div>
<p>不过，第2列中，只有mutant的数据变成了<code>difference(mutant - control)</code>，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707100945.jpg">

</div>
<p>例如，下图的数字<code>1</code>对应的数据点（我暂把它叫做A点，它是control组中的点），就是<code>mean(control)</code>的“开”，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707100952.jpg">

</div>
<p>同理，数字<code>0</code>表示A点对应的就是<code>difference(mutant - control)</code>的“关”，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707100957.jpg">

</div>
<p>这样我们就很好理解了，control组中的A这个点的对应的<code>mean(control)</code>这个系数为1，A点对应的<code>difference(mutant-control)</code>这个系数为0，加起来，就是A点的这个数字。同时，在mutant中的某个点（我把它称为B点，它位于mutant组），它对应的<code>mean(control)</code>这个系数为1（这个好理解，因为它后面还有mutant - control），对应的<code>difference(mutant-control)</code>这个系数也为1，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707101003.jpg">

</div>
<p>以下两个方程（设计矩阵和标准矩阵）的残差是相同的，它们也有相同的参数，因此<code>p(fit)</code>也是相同的：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707101010.jpg">

</div>
<p>因此，它们的F值也是相同的：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707101018.jpg">

</div>
<p>现在我们面临一个疑问：即使这两个方程的结果都一样，为什么右边的这个方程更普遍？原作者认为这可能与回归有关：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707101027.jpg">

</div>
<p>我们先看一下这个设计矩阵是如何工作的，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707101033.jpg">

</div>
<p>设计矩阵的第1列的这个系数是与<code>mean(control)</code>相乘的，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707101039.jpg">

</div>
<p>第2列的数字是与<code>difference(mutant - control)</code>相乘的，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707101045.jpg">

</div>
<p>将<code>mean(control)</code>乘以1，那就是它的原始数字，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707101051.jpg">

</div>
<p>将<code>difference(mutant - control)</code>乘以0，就是没有，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707101057.jpg">

</div>
<p>这个设计矩阵中的数字是1和1，因此它非常适合做t检验或ANOVA，因为这些数字可以代表不同的分类（其实我们也可以使用其它的数字）：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707101103.jpg">

</div>
<p>例如，下面是一个线性回归的设计矩阵，这个矩阵就与左边的这个线性回归方程是等价的：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707101111.jpg">

</div>
<p>在这个矩阵的第1列，都是数字1，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707101118.jpg">

</div>
<p>第2列是这些点在对应的x轴上的坐标，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707101123.jpg">

</div>
<p>我们现在看一下第1行，它对应的是第1个点，如下所示：</p>
<p><img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707101135.jpg">此时用1乘以这个这个公式中的系数（<code>y-intercept</code>），这就表示，这个系数（<code>y-intercept</code>）处于打开（<code>on</code>）的状态，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707101142.jpg">

</div>
<p>再用第1行的第2个数字（也就是0.9）乘以斜率（slope），如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707101148.jpg">

</div>
<p>为了这让个过程更加具体，我们把这个方程中的矩阵和斜率用具体的数字替换一下，计算出拟合曲线上的真实数据，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707101154.jpg">

</div>
<p>拟合的曲线斜率非常小，它为0.01（注意：这条拟合曲线与前面我们做的简单线性回归的曲线不同，因为这里面的数据跟前面的貌似不是一批的），如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707101200.jpg">

</div>
<p>它的斜率为0.8，与第1个数据点相乘，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707101205.jpg">

</div>
<p>经计算，得到0.73，它对应的是就是拟合曲线上的第一个点，就是绿叉的那个点，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707101211.jpg">

</div>
<p>现在我们看第2行，它对应的是第2个点，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707101220.jpg">

</div>
<p>现在我们计算拟合曲线上对应的第2个点，下图绿叉所在位置，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707101226.jpg">

</div>
<p>现在把这个矩阵中所有的点都在拟合曲线上计算出来，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707101232.jpg">

</div>
<p>一旦计算出这些拟合曲线上的点，那么我们就可以计算其残差，并计算p值，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707101238.jpg">

</div>
<p>用这个案例就是为了说明，设计矩阵不一定只含有１和０，也可以含有一组其它的数字，将这数字投射到方程中，一次投射一行：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707101248.jpg">

</div>
<p>我们再看t检验的案例，t检验的这种案例更加常见，因此我们后文中的案例都按照这种格式进行，如下的所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707101254.jpg">

</div>
<p>现在我们知道了，我们可以把任何数字都放到一个设计矩阵里。</p>
<h3 id="第1个案例">第1个案例</h3>
<p>现在我们再看一些案例，这些案例混合了t检验与线性回归，下图是两种不同种类的小鼠的体重与大小，不同颜色用于区分不同种类的小鼠，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707101332.jpg">

</div>
<p>其中，红色是对照组小鼠，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707101343.jpg">

</div>
<p>绿色的是突变组小鼠（mutant）如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707101350.jpg">

</div>
<p>从直观上我们就能够看出，突变组小鼠的比较大，如下所示：</p>
<p><img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707101357.jpg">换句话说，突变组与对照组小鼠趋势是这个样子的：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707101404.jpg">

</div>
<p>我们现在面临的问题就是：如何使用统计学的方法来判断这两组小鼠是否有统计学意义上的差别？</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707101413.jpg">

</div>
<p>如果我们对整体小鼠（包括mutant和control）做一个回归，那么我们也无法找出这两组小鼠是否有差异，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707101421.jpg">

</div>
<p>如果我们忽略小鼠的体重与大小之间的关系，只对小鼠的大小做一个统计，我们就发现，小鼠的大小（size）并没有统计学意义上的差别，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707101426.jpg">

</div>
<p>由于小鼠的体重（weight）和大小（size）之间的这个关系与小鼠的类型有关，因此我们可以把这两种因素归到一种统计学方法中来，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707101432.jpg">

</div>
<p>换句话讲，我们并不直接比较小鼠的大小（这个比较是用t检验来进行的），而是用另外的一种方法来比较，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707101438.jpg">

</div>
<p>这种方法就是，比较这两种小鼠的回归曲线，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707101444.jpg">

</div>
<p>为了比较这两个曲线，我们需要一个含有对照组小鼠方程截矩的方程，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707101450.jpg">

</div>
<p>这个方程还要含有突变组小鼠与对照组小鼠的差值，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707101456.jpg">

</div>
<p>这个方程还要含有斜率（在这个案例中，这两条曲线的斜率是相同的，但在实际运用中，可能不同），如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707101501.jpg">

</div>
<p>这就意味着，我们需要一个设计矩阵，这个矩阵的第1列是数字1，它们是y轴上的某些点，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707101506.jpg">

</div>
<p>设计矩阵的第2列是0和1，它们代表<code>mutant off</code>（也就是突变组与对照组的差值），如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707101512.jpg">

</div>
<p>其中0代表<code>off</code>，它代表control的off，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707101517.jpg">

</div>
<p>1代表mutant小鼠，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707101524.jpg">

</div>
<p>第3列是小鼠的体重，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707101530.jpg">

</div>
<p>绿色的是突变组，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707101536.jpg">

</div>
<p>现在看第1行，1，0，2.4对应的方程的数字如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707101544.jpg">

</div>
<p>它投射到拟合曲线上的点如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707101549.jpg">

</div>
<p>第2行的数字对应到方程上如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707101555.jpg">

</div>
<p>第2个点投射到拟合曲线上就是这个样子：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707101600.jpg">

</div>
<p>把所有的点投射到相应的曲线上，就如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707101606.jpg">

</div>
<p>一旦我们确定了拟合曲线上的点的位置，就可以计算其残差，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707101611.jpg">

</div>
<h4 id="第1个simpler-model">第1个simpler model</h4>
<p>此时我们把这个复杂的模型（用fancy model表示）与简单的模型（simpler model）比较，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707101639.jpg">

</div>
<p>此时，把这个fancy model的残差平方和代入到下面的公式中，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707101644.jpg">

</div>
<p>其中fancy model有3个参数，也就是<code>p(fancy)</code>为3，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707101652.jpg">

</div>
<p>把simple的SS代入到下面方程，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707101741.jpg">

</div>
<p>simple方程中的参数只有1个，也就是说<code>p(simple)</code>为1，代入到下面的方程，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707101751.jpg">

</div>
<p>最终得到的F值为21.88，p值为0.003，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707101756.jpg">

</div>
<p>这里需要提一下的是，simpler model可以是任何的模型，下图中这个simpler model就是一个简单线性回归模型，如下所示：</p>
<h4 id="第2个simpler-model">第2个simpler model</h4>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707101803.jpg">

</div>
<p>我们用这个simple model来计算一下，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707101903.jpg">

</div>
<p>得到的结果为F值是32.6，p值为0.0023，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707101813.jpg">

</div>
<p>从上图的结果来看，使用小鼠的体重(weight)和种类(type)能够比只使用小鼠的体重(weigth)更好地预测小鼠的大小(size)。再看下面的一个simpler model，在这个模型中，我们忽略了小鼠的体重，如下所示：</p>
<h4 id="第3个simpler-model">第3个simpler model</h4>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707101932.jpg">

</div>
<p>现在把这个simpler model的平方和加入到F值的公式中，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707101937.jpg">

</div>
<p>这次得到的F值与p值如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707101945.jpg">

</div>
<p>这个结果的p值与第一个simpler model（即考虑全部的小鼠平均值的那个模型）的p值相比，它更小，这就说明，使用小鼠的体重(weight)和类型(type)来预测小鼠的大小，比只使用类型(type)更好。</p>
<h3 id="第2个案例批次效应">第2个案例：批次效应</h3>
<p>现在A实验室（Lab A）做了一个实验，如下图左图所示，而B实验室（Lab B）实验重复了A实验室的实验。现在我们要综合这两次的实验结果，观察一下，mutant组与control相比，有没有差异，但是，这两次实验不是一次做的，因此存在批次效果（batch effect），我们现在要解决的问题是，如何消除这个批次效应，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707102002.jpg">

</div>
<p>首选，我们先计算一下Ａ实验的control组的均值，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707102006.jpg">

</div>
<p>第二，我们计算一下B实验的control这个结果与A实验的control这个均值的差值，这用于研究批次效应，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707102012.jpg">

</div>
<p>第三，我们再加入mutant和control数据的差值，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707102017.jpg">

</div>
<p>此时，设计一个矩阵，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707102022.jpg">

</div>
<p>从本质上来讲， 我们想知道上述方程最后一项重要不重要。也就是说矩阵最后一项重要与否，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707102027.jpg">

</div>
<p>现在我们比较这个复杂方程（simple equation）与简单方程（simpler equation，简单方程忽略了control与mutant的分组）的区别，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707102032.jpg">

</div>
<p>如果得到一个很小的p值，那么这就告诉我们要研究control与mutant的差异，这就意味着我control和mutant之间存在着显著性差异。</p>
<h2 id="r语言与设计矩阵">R语言与设计矩阵</h2>
<h3 id="第1案例小鼠体重">第1案例：小鼠体重</h3>
<p>还看前文的案例，我们想知道mutant组的小鼠和control的小鼠在size上是否有统计学意义上的差别。我们分别做了这两种小鼠的回归曲线，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707102039.jpg">

</div>
<p>此时我们使用R语言来进行分析，输入以下代码：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">Type &lt;- factor(c(</div><div class="line">  rep(<span class="string">"Control"</span>, times=<span class="number">4</span>),</div><div class="line">  rep(<span class="string">"Mutant"</span>, times=<span class="number">4</span>)))</div><div class="line"></div><div class="line">Weight &lt;- c(<span class="number">2.4</span>, <span class="number">3.5</span>, <span class="number">4.4</span>, <span class="number">4.9</span>, <span class="number">1.7</span>, <span class="number">2.8</span>, <span class="number">3.2</span>, <span class="number">3.9</span>)</div><div class="line">Size &lt;- c(<span class="number">1.9</span>, <span class="number">3</span>, <span class="number">2.9</span>, <span class="number">3.7</span>, <span class="number">2.8</span>, <span class="number">3.3</span>, <span class="number">3.9</span>, <span class="number">4.8</span>)</div><div class="line">model.matrix(~Type+Weight)</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">&gt; Type &lt;- factor(c(</div><div class="line">+   rep(<span class="string">"Control"</span>, times=<span class="number">4</span>),</div><div class="line">+   rep(<span class="string">"Mutant"</span>, times=<span class="number">4</span>)))</div><div class="line">&gt; </div><div class="line">&gt; Weight &lt;- c(<span class="number">2.4</span>, <span class="number">3.5</span>, <span class="number">4.4</span>, <span class="number">4.9</span>, <span class="number">1.7</span>, <span class="number">2.8</span>, <span class="number">3.2</span>, <span class="number">3.9</span>)</div><div class="line">&gt; Size &lt;- c(<span class="number">1.9</span>, <span class="number">3</span>, <span class="number">2.9</span>, <span class="number">3.7</span>, <span class="number">2.8</span>, <span class="number">3.3</span>, <span class="number">3.9</span>, <span class="number">4.8</span>)</div><div class="line">&gt; model.matrix(~Type+Weight)</div><div class="line">  (Intercept) TypeMutant Weight</div><div class="line"><span class="number">1</span>           <span class="number">1</span>          <span class="number">0</span>    <span class="number">2.4</span></div><div class="line"><span class="number">2</span>           <span class="number">1</span>          <span class="number">0</span>    <span class="number">3.5</span></div><div class="line"><span class="number">3</span>           <span class="number">1</span>          <span class="number">0</span>    <span class="number">4.4</span></div><div class="line"><span class="number">4</span>           <span class="number">1</span>          <span class="number">0</span>    <span class="number">4.9</span></div><div class="line"><span class="number">5</span>           <span class="number">1</span>          <span class="number">1</span>    <span class="number">1.7</span></div><div class="line"><span class="number">6</span>           <span class="number">1</span>          <span class="number">1</span>    <span class="number">2.8</span></div><div class="line"><span class="number">7</span>           <span class="number">1</span>          <span class="number">1</span>    <span class="number">3.2</span></div><div class="line"><span class="number">8</span>           <span class="number">1</span>          <span class="number">1</span>    <span class="number">3.9</span></div><div class="line">attr(,<span class="string">"assign"</span>)</div><div class="line">[<span class="number">1</span>] <span class="number">0</span> <span class="number">1</span> <span class="number">2</span></div><div class="line">attr(,<span class="string">"contrasts"</span>)</div><div class="line">attr(,<span class="string">"contrasts"</span>)$Type</div><div class="line">[<span class="number">1</span>] <span class="string">"contr.treatment"</span></div></pre></td></tr></table></figure>
<p>其中<code>model.matrix()</code>这个函数是用于构建设计矩阵的，它能自动将因子型数据转换为哑变量（dumpy variables）。构建好的矩阵的所代表的第1列是对照组的截矩，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707102046.jpg">

</div>
<p>第2列代表的数据是mutant与control的差值，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707102052.jpg">

</div>
<p>最后1列是如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707102103.jpg">

</div>
<p>现在构建线性回归模型，结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">&gt; model &lt;- lm(Size~Type + Weight)</div><div class="line">&gt; summary(model)</div><div class="line"></div><div class="line">Call:</div><div class="line">lm(formula = Size ~ Type + Weight)</div><div class="line"></div><div class="line">Residuals:</div><div class="line">       <span class="number">1</span>        <span class="number">2</span>        <span class="number">3</span>        <span class="number">4</span>        <span class="number">5</span>        <span class="number">6</span>        <span class="number">7</span>        <span class="number">8</span> </div><div class="line"> <span class="number">0.05455</span>  <span class="number">0.34562</span> -<span class="number">0.41623</span>  <span class="number">0.01607</span> -<span class="number">0.01753</span> -<span class="number">0.32646</span> -<span class="number">0.02062</span>  <span class="number">0.36461</span> </div><div class="line"></div><div class="line">Coefficients:</div><div class="line">            Estimate Std. Error t value Pr(&gt;|t|)   </div><div class="line">(Intercept)  <span class="number">0.08052</span>    <span class="number">0.52744</span>   <span class="number">0.153</span>  <span class="number">0.88463</span>   </div><div class="line">TypeMutant   <span class="number">1.48685</span>    <span class="number">0.26023</span>   <span class="number">5.714</span>  <span class="number">0.00230</span> **</div><div class="line">Weight       <span class="number">0.73539</span>    <span class="number">0.13194</span>   <span class="number">5.574</span>  <span class="number">0.00256</span> **</div><div class="line">---</div><div class="line">Signif. codes:  <span class="number">0</span> ‘***’ <span class="number">0.001</span> ‘**’ <span class="number">0.01</span> ‘*’ <span class="number">0.05</span> ‘.’ <span class="number">0.1</span> ‘ ’ <span class="number">1</span></div><div class="line"></div><div class="line">Residual standard error: <span class="number">0.3275</span> on <span class="number">5</span> degrees of freedom</div><div class="line">Multiple R-squared:  <span class="number">0.8975</span>,	Adjusted R-squared:  <span class="number">0.8564</span> </div><div class="line"><span class="literal">F</span>-statistic: <span class="number">21.88</span> on <span class="number">2</span> and <span class="number">5</span> DF,  p-value: <span class="number">0.003367</span></div></pre></td></tr></table></figure>
<p>现在看这个结果，第1部分如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">Call:</div><div class="line">lm(formula = Size ~ Type + Weight)</div><div class="line"></div><div class="line">Residuals:</div><div class="line">       <span class="number">1</span>        <span class="number">2</span>        <span class="number">3</span>        <span class="number">4</span>        <span class="number">5</span>        <span class="number">6</span>        <span class="number">7</span>        <span class="number">8</span> </div><div class="line"> <span class="number">0.05455</span>  <span class="number">0.34562</span> -<span class="number">0.41623</span>  <span class="number">0.01607</span> -<span class="number">0.01753</span> -<span class="number">0.32646</span> -<span class="number">0.02062</span>  <span class="number">0.36461</span></div></pre></td></tr></table></figure>
<p>这是每个数据与拟合曲线的残差。</p>
<p>第2部分，我们看最后的信息：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Multiple R-squared:  <span class="number">0.8975</span>,	Adjusted R-squared:  <span class="number">0.8564</span></div></pre></td></tr></table></figure>
<p>这些是多重<span class="math inline">\({R}^2\)</span>，因为我们的拟合曲线是一个比复杂的方程（它有2个参数），后面的是根据参数的数量调整后的<span class="math inline">\({R}^2\)</span>。最后就是F值与p值了，p值为0.003367，这个p值是线性回归的p值整体数据（其实就是simpler model）对比后的p值，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707102109.jpg">

</div>
<p>接着看各项的系数，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">Coefficients:</div><div class="line">            Estimate Std. Error t value Pr(&gt;|t|)   </div><div class="line">(Intercept)  <span class="number">0.08052</span>    <span class="number">0.52744</span>   <span class="number">0.153</span>  <span class="number">0.88463</span>   </div><div class="line">TypeMutant   <span class="number">1.48685</span>    <span class="number">0.26023</span>   <span class="number">5.714</span>  <span class="number">0.00230</span> **</div><div class="line">Weight       <span class="number">0.73539</span>    <span class="number">0.13194</span>   <span class="number">5.574</span>  <span class="number">0.00256</span> **</div><div class="line">---</div><div class="line">Signif. codes:  <span class="number">0</span> ‘***’ <span class="number">0.001</span> ‘**’ <span class="number">0.01</span> ‘*’ <span class="number">0.05</span> ‘.’ <span class="number">0.1</span> ‘ ’ <span class="number">1</span></div></pre></td></tr></table></figure>
<p>结果中<code>Weight</code>这个变量的p值为0.00256，它表示的是，如果在这个复杂模型（fancy model）中剔除<code>Weight</code>这个变量，构建成的简单模型（simpler model）与原始数据的拟合效果。它反映的是一个复杂模型的统计效果和只用常规t检验的统计效果的比较（p值小于0.05，说明前者的统计效果更好）。换句话讲，它反映了复杂模型中剔除了<code>Weight</code>这个变量后，使用最小二乘法进行的检验与原复杂模型检验的比较，由于p值很小，这就说明了<code>Weight</code>这个变量的重要性。</p>
<p>同理，<code>TypeMutant</code>这个变量对应的p值为0.00230，它反映的是原复杂方程（fancy model）与该方程剔除小鼠类型这个变量后的比较（剔除了小鼠类型的这个变量，就变成了普通线性回归方程）。</p>
<h3 id="第2案例批次效果">第2案例：批次效果</h3>
<p>这个案例还是前面的那个案例，在这个案例中，我们会看到两个实验室做的同一个实验，它们存在着批次效应，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707102552.png">

</div>
<p>现在使用R语言进行分析，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">Lab &lt;- factor(c(rep(<span class="string">"A"</span>,times=<span class="number">6</span>),rep(<span class="string">"B"</span>,times=<span class="number">6</span>)))</div><div class="line">Type &lt;- factor(c(rep(<span class="string">"Control"</span>, times = <span class="number">3</span>),rep(<span class="string">"Mutant"</span>, times = <span class="number">3</span>),rep(<span class="string">"Control"</span>, times = <span class="number">3</span>),rep(<span class="string">"Mutant"</span>, times = <span class="number">3</span>)))</div><div class="line">Expression &lt;- c(<span class="number">1.7</span>, <span class="number">2</span>, <span class="number">2.2</span>,<span class="number">3.1</span>, <span class="number">3.6</span>, <span class="number">3.9</span>, <span class="number">0.9</span>, <span class="number">1.2</span>, <span class="number">1.9</span>, <span class="number">1.8</span>, <span class="number">2.2</span>, <span class="number">2.9</span>)</div><div class="line">model.matrix(~Lab+Type)</div></pre></td></tr></table></figure>
<p>构建好的设计矩阵如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">&gt; model.matrix(~Lab+Type)</div><div class="line">   (Intercept) LabB TypeMutant</div><div class="line"><span class="number">1</span>            <span class="number">1</span>    <span class="number">0</span>          <span class="number">0</span></div><div class="line"><span class="number">2</span>            <span class="number">1</span>    <span class="number">0</span>          <span class="number">0</span></div><div class="line"><span class="number">3</span>            <span class="number">1</span>    <span class="number">0</span>          <span class="number">0</span></div><div class="line"><span class="number">4</span>            <span class="number">1</span>    <span class="number">0</span>          <span class="number">1</span></div><div class="line"><span class="number">5</span>            <span class="number">1</span>    <span class="number">0</span>          <span class="number">1</span></div><div class="line"><span class="number">6</span>            <span class="number">1</span>    <span class="number">0</span>          <span class="number">1</span></div><div class="line"><span class="number">7</span>            <span class="number">1</span>    <span class="number">1</span>          <span class="number">0</span></div><div class="line"><span class="number">8</span>            <span class="number">1</span>    <span class="number">1</span>          <span class="number">0</span></div><div class="line"><span class="number">9</span>            <span class="number">1</span>    <span class="number">1</span>          <span class="number">0</span></div><div class="line"><span class="number">10</span>           <span class="number">1</span>    <span class="number">1</span>          <span class="number">1</span></div><div class="line"><span class="number">11</span>           <span class="number">1</span>    <span class="number">1</span>          <span class="number">1</span></div><div class="line"><span class="number">12</span>           <span class="number">1</span>    <span class="number">1</span>          <span class="number">1</span></div><div class="line">attr(,<span class="string">"assign"</span>)</div><div class="line">[<span class="number">1</span>] <span class="number">0</span> <span class="number">1</span> <span class="number">2</span></div><div class="line">attr(,<span class="string">"contrasts"</span>)</div><div class="line">attr(,<span class="string">"contrasts"</span>)$Lab</div><div class="line">[<span class="number">1</span>] <span class="string">"contr.treatment"</span></div><div class="line"></div><div class="line">attr(,<span class="string">"contrasts"</span>)$Type</div><div class="line">[<span class="number">1</span>] <span class="string">"contr.treatment"</span></div></pre></td></tr></table></figure>
<p>第1列代表的是<code>Lab A control mean</code>，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707102127.jpg">

</div>
<p>第2列是<code>lab B offset</code>，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707102506.png">

</div>
<p>第3列是<code>difference(mutant - control)</code>，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707102453.png">

</div>
<p>现在计算一下批次效应，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">batch.lm &lt;- lm(Expression ~ Lab + Type)</div><div class="line">summary(batch.lm)</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">&gt; summary(batch.lm)</div><div class="line"></div><div class="line">Call:</div><div class="line">lm(formula = Expression ~ Lab + Type)</div><div class="line"></div><div class="line">Residuals:</div><div class="line">    Min      1Q  Median      3Q     Max </div><div class="line">-<span class="number">0.6500</span> -<span class="number">0.2833</span> -<span class="number">0.0500</span>  <span class="number">0.2750</span>  <span class="number">0.7167</span> </div><div class="line"></div><div class="line">Coefficients:</div><div class="line">            Estimate Std. Error t value Pr(&gt;|t|)    </div><div class="line">(Intercept)   <span class="number">2.1167</span>     <span class="number">0.2279</span>   <span class="number">9.287</span>  <span class="number">6.6e-06</span> ***</div><div class="line">LabB         -<span class="number">0.9333</span>     <span class="number">0.2632</span>  -<span class="number">3.546</span> <span class="number">0.006250</span> ** </div><div class="line">TypeMutant    <span class="number">1.2667</span>     <span class="number">0.2632</span>   <span class="number">4.813</span> <span class="number">0.000956</span> ***</div><div class="line">---</div><div class="line">Signif. codes:  <span class="number">0</span> ‘***’ <span class="number">0.001</span> ‘**’ <span class="number">0.01</span> ‘*’ <span class="number">0.05</span> ‘.’ <span class="number">0.1</span> ‘ ’ <span class="number">1</span></div><div class="line"></div><div class="line">Residual standard error: <span class="number">0.4558</span> on <span class="number">9</span> degrees of freedom</div><div class="line">Multiple R-squared:  <span class="number">0.7989</span>,	Adjusted R-squared:  <span class="number">0.7542</span> </div><div class="line"><span class="literal">F</span>-statistic: <span class="number">17.87</span> on <span class="number">2</span> and <span class="number">9</span> DF,  p-value: <span class="number">0.0007342</span></div></pre></td></tr></table></figure>
<p>这个结果跟先前多元回归的结果类似，最后一部分就是<span class="math inline">\({R}^2\)</span>以及调整后的<span class="math inline">\({R}^2\)</span>，它的p值为0.0007342，但是这个p值不是我们所需要的，这个p值代表的是复杂方程与一个简单方程（也就是下图中<code>y = overall mean</code>）的统计学差异，这个p值是不能用于判断mutant和control差异的，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707102425.jpg">

</div>
<p>我们再看一下<code>TypeMutant</code>这个变量对应的p值，这个p值是0.000956，这个才是我们所需要的p值，它表示的是，我们去掉<code>difference(mutant - control)</code>这个变量后，我们是否还能拟合出一条好的曲线（我个人理解就是：原假设就是去掉`TypeMutant后，剩下的数据能够拟合出一条好的曲线方程，但是结果却是p值小于0.05，是一个非常小的值，因此原假设不成立，也就是说这个变量不能去掉），如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707102353.jpg">

</div>
<p>总之，这个变量（<code>TypeMutant</code>）是我们所需要的，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707102207.jpg">

</div>
<p>这个案例说明的是，我们在做线性回归时，不一定总要看最终的p值（也就是统计结果右下角的p值），而是针对自己具体的容易来查找相应的p值。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2018/06/06/StatQuest/生物统计-StatQuest学习笔记06-分位数及其应用/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/06/06/StatQuest/生物统计-StatQuest学习笔记06-分位数及其应用/" itemprop="url">StatQuest学习笔记06——分位数及其应用</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-06-06T12:10:54+08:00">
                2018-06-06
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/生统之StatQuest/" itemprop="url" rel="index">
                    <span itemprop="name">生统之StatQuest</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  2,709
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  9
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="前言主要内容">前言——主要内容</h2>
<p>这篇笔记的内容是StatQuest视频文件的第23，24，25。文件第23讲的是分位数(quantiles)与百分位数(percentiles)；文件24讲的是QQ图；文件25讲的是分位数的均一化。</p>
<h2 id="分位数">分位数</h2>
<p>先看一个案例，我们检测了一些基因的表达情况，下图是第1个基因的表达数据：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707103122.jpg">

</div>
<p>最终，我们检测了15个基因的表达情况，它们的数据如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707103128.jpg">

</div>
<p>从图上我们可以看出，坐标中一共有15个点，如果我们从下向上数，数到第8个点时，划一条线，这个条的上方有50%的点，即7个点，下方也有50%的点，即7个点，这个点就叫做中位数（median），如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707103134.jpg">

</div>
<p>从技术角度来讲，中位数就是一个百分比数（quantile），因为它把这一组数据划分成了2个部分，每部分所占的点数占总数目都是相同的，有时候，这个点也被标为0.5，也时候也被标为50%。</p>
<blockquote>
<p>中位数(median)是将n个变量值从小到大排列，位置居于中间的那个数。当n为奇数时取位次居中的变量值，当n为偶数时，取位次居中的两个变量值的均值。</p>
<p>百分位数(percentile)是一种位置指标，用Px来表示，读作第X百分位数。一个百分位数Px将全部产变量值分为两部分，在Px处若无相同变量值，则在不包含Px的全部变量值中有X%的变量值小于它，有(100-X)%变量值大于它。故百分位数是一个界值，其重要用途是确定医学参考值范围（reference range）。中位数实际上是第50百分位数。</p>
<p>——《医学统计学》（第四版）.孙振球.2014</p>
</blockquote>
<p>从下图中我们可以看到，这个中位数的值为4.5，也就是说第50分位数的值为4.5，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707103139.jpg">

</div>
<p>现在我们再添加两条线，再加上前面的50%分位数的线，这三条线就把整个数据分成了4部分，其中最下面的那条线叫0.25或25%百分位数，因为大概为25%的点低于它，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707103146.jpg">

</div>
<p>最上面的线叫75%百分位数，因为约有75%的点低于它，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707103150.jpg">

</div>
<p>通常来说，分位数就是那些能够把数据集分为相同区间组的线，这是技术上的定义。而百分位数（percentiles）则是指那些能够把数据集分为100份相同区间的分位数（quantiles），不过在实际运用中，这个术语非常灵活。例如我们把50%百分位数称为中位数，把75%百分位数称为第75百分位数（这就与我们引用教材中的命名相同了），如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707103156.jpg">

</div>
<p>最低下的数字，也就是最小的数字，称为0%百分位数，也叫第0百分位数，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707103159.jpg">

</div>
<p>倒数第2个数字则是第7百分位数，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707103204.jpg">

</div>
<p>在R语言中，有专门计算分位数的函数，就是<code>quantile()</code>，它提供了9种不同的方法来计算分位数，其结果可能略微有所不同。这就说明，如果你的数据集很小，那么这个函数按照不同方法计算出来的分位数就有很大的同，如果数据集很大，那么计算结果就大体相同。</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707103213.jpg">

</div>
<h2 id="qq图">QQ图</h2>
<p>QQ图的全称为Quantile-Quantile图，也就是分位数的图，它研究的是数据是否符合正态分布。还以前面的基因表达为例来说明一下，我们检测了15个基因表达值，这些数据服是否服从正态分布？这就需要QQ图来回答，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707103223.jpg">

</div>
<p>第一步：计算出每个点的百分位数，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707103229.jpg">

</div>
<p>第二步：绘制出正态分布曲线，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707103234.jpg">

</div>
<p>第三步：将同样的分位数映射到这个正态分布曲线上（我的理解就是某个数字，例如0.6，它的分位数是0.07的话，那么就在正态分布曲线上找到相应的一条直线x，这条直线与正态分布曲线构成的左边面积为0.07，其余的数字都这么做），如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707103238.jpg">

</div>
<p>数据集中有15个点，它们把这批数据分成了相同区间的组（equal sized group）（注：我的理解就是，这个相同区间指的是分位数的比，而不是实际值，例如我有100个点，这个点从小到大排列，每个点都会有自己相应的分位数，如果把按它们各自的分位数进行划分，那么可以把100%划分为100份1%），那么这些数据对应的分位数都投射到正态分布区间上，就是下面的这个图，从图上可以知道，中间部分的直线间隔小，两边的直线间隔长，这个很好理解，因为划分是按面积进行划分的，面积代表了概率，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707103243.jpg">

</div>
<p>对于正态分布曲线来说，“相同区间的组”（equal sized groups）意味着一个数据在每组中的概率是相同的（一组就是由x轴，正态分布曲线，两侧的红线构成的狭长区域）：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707103247.jpg">

</div>
<p>现在就可以绘制QQ图了，如下所示：</p>
<p><img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707103251.jpg">QQ图含有2个坐标，横坐标是正态分布的x轴，纵坐标是原始数据的分位数，现在我们绘制原始数据中最小的那个点，它的数值是0.6，这个数值对应的就是纵坐标，它的这个值所对应的分位数在正态分布曲线上的点是x轴上-1.5的点，此时将它们绘制到QQ图上，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707103256.jpg">

</div>
<p>接着，把所有的点都绘制到QQ图上，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707103303.jpg">

</div>
<p>此时，我们看一下这些点是否与下面红色的直线重合（这个红色的直线其实就是y=x，如果数据符合正态分布，那么它就重合），如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707103307.jpg">

</div>
<p>这些点貌似与红色的线重合得并不多，我们再看一下这些数据与另外的一种分布（这种分布就是均匀分布，即uniform distribution）的比较，第1步，求出各个数据点对应的分位数，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707103314.jpg">

</div>
<p>第二步：绘制出相应均值分布的曲线，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707103318.png">

</div>
<p>第三步：将原始数据对应的分位数投射到这个曲线上：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707103322.jpg">

</div>
<p>第四步：绘制QQ图，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707103325.jpg">

</div>
<p>我们此时发现，这组数据与均值分布对应的红色直线比较匹配，它就更加杂得均值分布，下图是数据与正态分布的QQ图的比较：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707103332.jpg">

</div>
<h2 id="比较两组数据">比较两组数据</h2>
<p>现在我们再来看一个案例，在这个案例中，我们比较这两组数据，其中第二组数据比较少，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707103342.jpg">

</div>
<p>第二组数据只有4个数字，其实就是4个四分位数（我觉得视频中有问题，四分位数分别为25%，50%，75%的百分位数，只有3个，视频中却说有4个），因此我们也可以找出第一组数据中相应的四分位数，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707103346.jpg">

</div>
<p>在第一组中，与第二组第一个数字（也就是3.8）百分位数相同的是2.5，那么就在QQ图 纵坐标的位置画一条直线（这个直线是y=2.5，即下图的黑色虚线），此时在横坐标上画出x=3.8的直线（下图红色虚线，代表第二组中的3.8），两个直线交叉就是第1个点在QQ图上的位置，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707103352.jpg">

</div>
<p>然后依次画出第二组中4个点与第一组中相应点构成的点，连成直线，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707103355.jpg">

</div>
<p>由于上图中QQ图的点很少，很难判断这两组数据是否是相同的分布，因此为了判断两组数据是否服从同样的分布，需要收集更多的点。</p>
<h2 id="分位数的标准化">分位数的标准化</h2>
<p>先看一个案例，例如我们手中有一批芯片（基因表达芯片，非集成电路）的数据，芯片有以下这些特点：</p>
<ol style="list-style-type: decimal">
<li>检测样本中基因活跃的程度（其实就是基因表达量的高低）；</li>
<li>芯片检测基因的活跃程度是通过不同颜色的光来达到的；</li>
<li>如果你检测芯片的仪器的光源更亮，那么这批数据就比其他的仪器检测到的信号更强。</li>
</ol>
<p>由于芯片的这些特点，我们就需要对芯片的数据进行标准化，从而研究不同样本之间的差异是由技术重复引起的，还是实验因素引起的，芯片数据标准化的过程跟生物的关系不大，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707103401.jpg">

</div>
<p>我们来看一下原始数据，下图中的不同颜色表示不同的基因，这个数据中的每个点已经转换为了光强的密度值（intensity values），如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707103406.jpg">

</div>
<p>下面是每个样本的均值，</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707103412.jpg">

</div>
<p>每个样本的均值都不同，这表明，我们需要校正所有光的强度，分位数标准化（quantile normalization）就是为了解决这个问题的，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707103417.jpg">

</div>
<p>第一步，我们先看每个样本中亮度最强的那个点，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707103421.jpg">

</div>
<p>第二步：计算这3个点的均值，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707103425.jpg">

</div>
<p>第三步：把这些均值投射到一个新的坐标轴上，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707103430.jpg">

</div>
<p>那么，样本1中强度最大的那个点（就是蓝色的点）的分位数标准化的值的就是上面我们计算出来的均值，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707103437.jpg">

</div>
<p>样本2和样本3中那两个点也是如此，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707103442.jpg">

</div>
<p>第四步：现在把亮度强度次亮的点再投射到这个新的坐标轴上，方法与前面的一样，也是先救出均值，然后再投射，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707103446.jpg">

</div>
<p>所有的点都按照这样处理，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707103453.jpg">

</div>
<p>经过这样的分位数标准化后，每个样本的数据基本上都一样了，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707103458.jpg">

</div>
<p>并且，每个样本中不同基因的原始次序也得到了保留，sample 1中的红色基因原来是最后一个，经处理后中，还是最后一个，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190707103503.jpg">

</div>
<p>以上的整个过程就是分位数标准化的整个过程，因为标准化后的数据与原始数据都有相同的分位数。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/4/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/4/">4</a><span class="page-number current">5</span><a class="page-number" href="/page/6/">6</a><span class="space">&hellip;</span><a class="page-number" href="/page/17/">17</a><a class="extend next" rel="next" href="/page/6/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">RVDSD</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">166</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">11</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">46</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          <div class="links-of-author motion-element">
            
          </div>

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

<div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">RVDSD</span>

  
</div>



<div class="powered-by">
<i class="fa fa-user-md"></i><span id="busuanzi_container_site_pv">
  本站访客数:<span id="busuanzi_value_site_uv"></span>
</span>
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.3</div>




<div class="theme-info">
  <div class="powered-by"></div>
  <span class="post-count">博客全站共630.8k字</span>
</div>

        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.3"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.3"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.3"></script>



  


  




	





  





  












  





  

  

  
  

  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config("");
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="custom_mathjax_source">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->
  


  

  

</body>
</html>
