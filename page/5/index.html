<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.3" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.3">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.3" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta property="og:type" content="website">
<meta property="og:title" content="RVDSD的个人笔记本">
<meta property="og:url" content="http://rvdsd.top/page/5/index.html">
<meta property="og:site_name" content="RVDSD的个人笔记本">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="RVDSD的个人笔记本">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.3',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://rvdsd.top/page/5/"/>





  <title>RVDSD的个人笔记本</title><!-- hexo-inject:begin --><!-- hexo-inject:end -->
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">RVDSD的个人笔记本</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">学习过程中的输出</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2018/06/11/BioStatistics/生物统计-StatQuest学习笔记10-t检验/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/06/11/BioStatistics/生物统计-StatQuest学习笔记10-t检验/" itemprop="url">StatQuest学习笔记10——t检验</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-06-11T12:10:54+08:00">
                2018-06-11
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/生物统计/" itemprop="url" rel="index">
                    <span itemprop="name">生物统计</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  110
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  1
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="笔记略">笔记（略）</h2>
<p>这篇笔记是是StatQuest视频教程的第32个，主要内容是讲t检验的，原视频只是作者的口头讲解，并没有相应的示意图，公式等，我以前也写有关t检验的一些笔记，可以参考这两篇笔记，它们分别是<a href="http://rvdsd.top/2017/06/20/%E7%94%9F%E7%89%A9%E7%BB%9F%E8%AE%A1-02%E6%AD%A3%E6%80%81%E5%88%86%E5%B8%83%E4%B8%8ET%E6%A3%80%E9%AA%8C/">《正态分布与t检验》</a>和<a href="http://rvdsd.top/2017/06/21/%E7%94%9F%E7%89%A9%E7%BB%9F%E8%AE%A1-02b%E6%AD%A3%E6%80%81%E5%88%86%E5%B8%83%E4%B8%8ET%E6%A3%80%E9%AA%8C%E7%9A%84%E8%AE%A1%E7%AE%97%E5%8E%9F%E7%90%86/">《正态分布与t检验的计算原理》</a>。</p>
<p>这篇笔记就不写了。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2018/06/10/BioStatistics/生物统计-StatQuest学习笔记09-Fisher精确检验/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/06/10/BioStatistics/生物统计-StatQuest学习笔记09-Fisher精确检验/" itemprop="url">StatQuest学习笔记09——Fisher精确检验</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-06-10T12:10:54+08:00">
                2018-06-10
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/生物统计/" itemprop="url" rel="index">
                    <span itemprop="name">生物统计</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  1,018
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  4
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="前言">前言</h2>
<p>以前我也写过有关统计学的笔记，本来是想结合StatQuest把原来的笔记整理一下，后来一想，还是算了，直接把StatQuest的系列教程做成笔记，这样比较系统，也会避免笔记冗余。这篇笔记是StatQuest视频教程的第31个，主要内容是Fisher精确检验与超几何分布，Fisher精确检验我以前的笔记中也有，就是<a href="http://rvdsd.top/2017/08/18/%E7%94%9F%E7%89%A9%E7%BB%9F%E8%AE%A1-07%E5%8D%A1%E6%96%B9%E5%88%86%E6%9E%90/">《卡方检验》这篇笔记</a>。</p>
<h2 id="fisher精确检验">Fisher精确检验</h2>
<p>我们还以MM豆（MM豆是M&amp;M巧克力豆的缩写，美国的一个品牌）为例进行说明。</p>
<p>此时我从MM豆的盒子里抓了一把MM豆，这批MM豆有8个，其中有7个蓝豆，1个红豆。此时问题来：</p>
<ol style="list-style-type: decimal">
<li>如何描述袋子中的MM豆颜色的分布？</li>
<li>我这个盒子里的蓝豆的比例是不是比正常的要高一些（正常MM豆中的蓝豆比例为21%）？</li>
<li>我能否计算这个MM豆样本的p值？</li>
</ol>
<p>如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180615/mmcdHDbkcm.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>MM豆的盒子里有40个MM豆，它的各种MM豆的颜色比例如下图所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180615/4a1CaGGi91.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时，我用直方图来研究一下我的这盒MM豆是否是一个特例（就是说跟平常所见的MM豆的颜色比例不同），下面我们就以我手中的这8个MM豆（7个蓝豆，1个红豆）为基础，来计算一下这个概率，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180615/ah8A1E6932.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>首先我事先说明一下，我们在计算这批MM豆的概率时，不用考虑它们的顺序，也就是说，当我拿出7个蓝豆与1个红豆的时候，不用在意这8个MM豆是如何排序的，就像是下面的这个样子：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180615/H5ifIHFhJb.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>现在让我们计算一下这7个蓝豆和1个红豆的概率，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180615/h0I5CA13gK.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>第1步：第1个MM豆是蓝色，此时它的概率为8/40，如何计算呢？就是因为一盒MM豆中按照正常的比例（这个比例是作者从MM豆的官网上查的），它有40个MM豆，有8个蓝豆，此时蓝豆的概率就是8/40，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180615/IkKb8c5IAm.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>第2步：还是1个蓝豆，它的概率是7/39，如何计算呢？因为此时已经拿出了一个蓝豆了，这盒MM豆剩下的就只有39个了，蓝豆还有7个，那么蓝豆的概率就是7/39，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180615/2IK9FLB0DJ.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>按照这种方法计算下去，第3个蓝豆的概率就是6/38，第4个蓝豆的概率就是5/37，最后，第8个MM豆是红色的概率就是5/33，计算结束。</p>
<p>现在把这8个概率相乘，就是我们手中有7个蓝豆和1个红豆的概率，最终的结果为0.000000065，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180615/e3glC7akke.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>这个概率是非常小的，不过我们需要记住的是，我们此时没有考虑MM豆的顺序，如果我们考虑了MM豆的顺序的话，我们还可以再计算一次，方法跟前面的是一样的，考虑了顺序之后，就是下面的这个样子：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180615/7BFH0B6G7D.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>最终的计算结果是0.00000053，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180615/D5Kd8344K9.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时我们计算出了出现这个事件的概率（也就是说7个蓝豆和1个红豆）了，那么，我们如何计算p值呢？首选我们要知道，p值是一系列小概率事件的总和，还包括下面的这些情况，例如8个蓝豆，还有7个橘黄豆和1个蓝豆，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180615/47ldmdfJ3l.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>后来经过计算，这个p值为0.01，那么我们就可以说，我的这盒MM豆是特例。</p>
<h2 id="fisher精确检验与超几何分布">Fisher精确检验与超几何分布</h2>
<p>另外在这个视频教程的题目中提到了超几何分布，Fisher精确检验可以视为超几何分布的一种变形，超几何分布在GO分析方面有着重要的作用，先留个坑，等视频学完了再填上。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2018/06/09/BioStatistics/生物统计-StatQuest学习笔记08-比数与比数比/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/06/09/BioStatistics/生物统计-StatQuest学习笔记08-比数与比数比/" itemprop="url">StatQuest学习笔记08——比数与比数比</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-06-09T12:10:54+08:00">
                2018-06-09
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/生物统计/" itemprop="url" rel="index">
                    <span itemprop="name">生物统计</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  5,110
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  19
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="前言主要内容">前言——主要内容</h2>
<p>这篇笔记的主要内容是StatQuest视频教程的第29与30，第29的内容是比值比（Odds）与比值比的log转换（LogOdds）。第30的内容是oddo ratio。</p>
<h2 id="ratio与rate的区别">ratio与rate的区别</h2>
<p>原视频中有几个术语比较容易混淆，下面是几个英文的注释。</p>
<p>ratio：译为“相对比”，通常简称为“比”，是指一个数字与另外一个数字的比值，它可以是两个有关的同类指标之比，也可以是不同性质的指标之比，常以倍数或百分数来表示，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/6b95A70IKe.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>这里的甲、乙指标值可以是绝对数、相对数或平均数等。我们看下面的一个表：</p>
<table>
<thead>
<tr class="header">
<th></th>
<th>某地区某年居民钩虫感染人数</th>
<th></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>年龄组/岁</td>
<td>检查人数</td>
<td>感染人数</td>
</tr>
<tr class="even">
<td>0-14</td>
<td>453</td>
<td>48</td>
</tr>
<tr class="odd">
<td>15-49</td>
<td>824</td>
<td>78</td>
</tr>
<tr class="even">
<td>50及以上</td>
<td>206</td>
<td>18</td>
</tr>
<tr class="odd">
<td>合计</td>
<td>1483</td>
<td>144</td>
</tr>
</tbody>
</table>
<p>这个表示中，0-14岁组与15-49岁组钩虫感染人数相对比为48/78X100%=61.54%，0-14岁组与15-49岁组钩虫感染率的相对比为10.60%/9.47%=1.12（倍）。</p>
<p>rate：对应的中文翻译是“率”，率是一个具有时间概率的比，用于说明在某一时期内某个现象发生的频率或旨度。某事件在某时间的发生率为表示为：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/geI52f8KAB.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>率常以百分率（%）、千分率、万分率（1/万）、十万分率（1/10万）等表示，在用率的指标时，应说明观察时时期的时间单位。常用的率有生存率、发病率。例如2000年初，在某地区调查了1000名60岁以上的老人，经检查发现，有80人患糖尿病。在2001年初随访这1000名60岁以上的老人，并进行体验，发生其中有95名老人患有糖尿病，那么糖尿病的发病率为：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/Jej9g3h56m.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>也就是说，这个地区60岁以上的老人在2000年的糖尿病发病率为1.63%。</p>
<p>——上述内容引用自《医学统计学及SAS应用》（王炳顺.2014）</p>
<h2 id="odds与odds-ratio翻译的区别">odds与odds ratio翻译的区别</h2>
<p>odds与odds ratio这两个词容易弄混，后来找了一本书（颜虹. 医学统计学.第2版[M]. 人民卫生出版社, 2010.），根据书里的翻译如下：</p>
<p>odds：翻译为<code>优势比</code>或<code>比数</code>或<code>比值</code>，在不同的情况下，可以译成不同的名称，例如在比赛时，可以译为“胜算”，在赌博时，也可以译为“胜率”，在疾病方面，也可以译为“风险”。为了方便理解与描述，后文中我会在括号中注明。</p>
<p>odds ratio：翻译为<code>比数比</code>或<code>比值比</code>。</p>
<p>后文会详细讲这两个术语的区别，为了避免搞混淆，此篇笔记都会使用中英文来描述比数和比数比。</p>
<h2 id="odds">odds</h2>
<p>关于比数（odds），我们先举一个例子。</p>
<p>你或许这么说过，“我支持的球队踢赢的概率可能是1:4”。这里暗含的意思就是有5场比赛，其中我的支持的球队会赢1场（下图蓝点所示），会输4场（下图红点所示），如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/559Gc7IGfl.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>那么此时我们使用比数（odds）来表示<code>1:4</code>，我们也可以说是<code>1/4</code>，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/7CkcCg0720.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>计算一下，就是0.25。也就是说我支持的球队赢的胜算是0.25（注：odds在这里译为了胜算，因为我觉得在球赛这种场合使用比数比较不太合适，这里可以理解为“胜算”）。</p>
<p>再把这个案例修改一下，如果我支持的球队赢得比赛的胜算（odds）是5:3，那么实际上暗示会有8场比赛，在这8场比赛中，我支持的球队会赢5场（蓝点所示），如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/H5EC6Bc8kb.png" alt="mark">
<p class="caption">mark</p>
</div>
<p>因此球队赢的胜算（odds）就是<code>5/3</code>，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/Bi538jJFBm.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>计算结果就是1.7。我们可以说我支持的球队赢的胜算（odds）是1.7。</p>
<p>需要注意的是，比数（odds，这里又切换到了统计学术语）与概率（probability）不同，比数（odds）指的是某些发生的事情与不发生的事情的比值，那么在这个案例中，比数（odds）的计算就是赢的事件数目（蓝色点）除以输的事件数目（红色点）如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/3b9G0cIG25.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>而概率（probability）则指的发生的事情数目（蓝色点）除以所有的事件数目（赢的（蓝色点）和输的（红色点）），如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/i2ieh5Ikel.png?" alt="mark">
<p class="caption">mark</p>
</div>
<p>因此，在前文中介绍的案例里，赢的比数就是5比3，也就是1.7，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/LHjJ2jBBGD.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>而赢的概率则是5/8，也就是0.625，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/Jg1CKCcB3a.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时我们就理解了比数（odds）与概率（probability）的区别。</p>
<p>此时我们看一下如何从概率（probability）中计算比值比（odds）。在上个案例中，我们看到了，赢的比数（odds）为1.7，概率为0.625，我们还可以计算一下输入的概率，也就是3/8=0.375。其实也就是<code>1-赢的概率=1-5/8=3/8=0.375</code>，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/19EGjmfjgC.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时我们用赢的概率除以输的概率，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/Hf8F1chdGe.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>计算后，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/a969im15F8.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>上述讲了两种计算比数（odds）的方式，一种是根据事件数目计算，一种是根据概率计算。但经常使用的是则是第二种，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/LF8dIDleF6.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h2 id="log-odds">log odds</h2>
<p>再回到最初的案例，也就是我支持的球队在5场比赛中，可能赢1场的那个案例，它的比数（odds）计算如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/gHKJACBFJc.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>如果我支持的球队表现更差，胜算（odds，就是比数，我是为了方便描述比赛）为1:8，那么就是下面的情况：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/I71bLljBGh.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>如果我支持的球队表现再差，假设胜算（odds）为1:16，那么就是下面的情况：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/Bg7eJG3iLG.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>或者还差呢，比如1:32，这基本上就接近0了，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/Fbd4H86Jc5.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>我们再假设一下，我支持的球队很好，有可能踢个4:3，或1.3，也就是下面的样子：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/KHLCaIH7fJ.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>如果还好，比如8:3（或2.7），如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/KI91Dd94jG.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>如果非常好，例如32:3（或者说是10.7），如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/gFBfBCIIFc.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>在这个案例中，我们知道，最初球队的胜算（odds，比数）是1，然后上下波动，差的时候，是从很小的值（基本上接近于0了）到1，如果很好的时候，则是从1到很大。此时，我们把这个比数（odds）放到一个数轴上表示，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/4bCj1E4G1k.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>红色的箭头表示的就是球队比较差的时候，输的胜算（odds，比数），如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/Ekb3a8480J.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>蓝色的则相反，表示的是球队赢的胜算（odds，比数），如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/CbjlCgi0Kc.png?" alt="mark">
<p class="caption">mark</p>
</div>
<p>但是，这个数轴不太直观，因为红色与蓝色不对称，比较起来不方便，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/aFEhDcE4fj.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>例如，如果胜算（odds）是1比6的话，也就是说1/6=0.17，它就在下面的这个位置：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/i9dejLbgk2.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>如果胜算（odds，比数）是6比1的话，也就是6/1=6，它就在很远处，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/LkC3EH0ee5.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>但是这些比数（odds）的程度都比较类似（一个是1比6，一个是6比1），但是区别很大，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/BcDh2g455b.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>为了方便观察，我们可以把比数（odds）进行一个log转换来解决这个问题，转换后的数轴如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/l1mJ7Ck27j.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>例如，如果比数是1:6，那么经过log转换（<code>log(1/6)=log(0.17)=-1.79</code>）则是下面这个样子：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/07d8lj5cf1.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>如果比数（odds）是6比1，经过log转换，则是下面的这个样子：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/DIJhECde8K.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>我们通过使用log转换，这两个相似的值就很对称了，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/l5Jg0ealC6.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h2 id="odds深入">odds深入</h2>
<p>在我们刚涉及比数（odds）时，是按事件数目计算的，接着我们又按概率进行了计算，这两种方法在本质上是相同的，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/lJL3DJme53.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>最后我们又涉及了比数（odds）的log转换，此时我们需要注意的是，概率的比值（ratio of probabilities）的log转换称为logit函数（logit function），它是logistic回归（logistic regression)的基础，如下所示：<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/I4AF8BJHlA.png?imageslim" alt="mark"></p>
<p>此时我们明白了比数（odds）和比数的log转换，那么它有什么用处呢，看下面的一个案例。在下面的这个案例里，如果随机选择一对加起来的值为100的两个数字，然后利用这对数字计算log(odds)，并且绘制出直方图，这个直方图就比较类似于正态分布了，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/5m4l3k0icd.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>添加上正态分布曲线，就是下面的这个样子：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/Jj1aH48mF2.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>使用log(odds)在解决某些统计学问题方面很有用，尤其是在我们计算赢/输概率方面，或者是yes/no，或者是true/false这些情况时（我觉得这与二项分布有些类似，以后补一下）。</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/Bl38HbB0C1.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>最后，我们需要注意的是比数（odds）虽然是一个比率（ratio），但它与比数比（odds ratio）是不同的，至于有哪些不同，后文会提到。</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/51EEjg3AeD.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h2 id="odds-ratio">odds ratio</h2>
<p>当我们说比数（odds）的时候，我们仅指两个事件发生的<code>比（ratio）</code>的<code>比值</code>，还以前面的案例为例说明，例如比数（odds）我们指的是我支持的球队获胜的<code>比（ratio）</code>除以我支持的球队失败的比例，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/fLb0C8J9hD.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>我们用图型表示就是下面的这个样子，蓝色圆形表示赢，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/kamJHggC7F.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>红色圆形表示输，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/Cb4HidD7Fd.png" alt="mark">
<p class="caption">mark</p>
</div>
<p>那么我支持的球队赢的<code>比数（odds）</code>就是蓝色的圆形除以红色的圆形，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/cHGCAeE81H.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时，我们计算一下圆形的数目，就可以计算出<code>比数（odds）</code>，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/j601Agb8i0.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时需要注意的是，即使<code>比数（odds）</code>是一个<code>比（ratio）</code>，它也不是人们所谓的<code>比数比（odds ratio）</code>，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/i1KgdF20bb.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>当人们说<code>比数比（odds ratio）</code>的时候，事实上他们是在说<code>比数的比（ratio of odds）</code>（这几个术语很拗口，为了避免混淆，我都会在括号时注明英文），分子与分母都是一个比数（odds），如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/C6GaFkaKIL.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>计算可得0.17，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/cg5E454hD4.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>就像我们计算某件事情的比数（odds）时，如果分母比分子大很多，那么比数比（odds ratio）就位于0到1这个区间上，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/21KBIGe7Kk.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>相反，如果分子很大，分母很小，那么比数比（odds ratio）就位于1到极大这个区间上，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/kK5de6cLGI.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>与比数（odds）类似，我们也可以把比数比（odds ratio）进行log转换，让它们看起来比较对称，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/2D7D7m12cC.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>例如，比数比（odds ratio）为<code>(2/4)/(3/1)</code>，进行log转换，即<code>log(odds ratio)=-1.79</code>，比数比（odds ratio）为<code>(3/1)/(2/4)</code>，进行log转换，即<code>log(odds ratio)=1.79</code>，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/eAk1J6C8D5.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时我们就得到了转换后的比数比（odds ratio），如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/C6KleC6hFg.png" alt="mark">
<p class="caption">mark</p>
</div>
<h2 id="odds-ratio案例">odds ratio案例</h2>
<p>此时，我们看一个案例，<code>Has cancer</code>表示得癌症的情况，Yes是得，No是不得，<code>Has the mutated gene</code>表示含有突变基因的情况，Yes是含有突变基因，No是不含突变基因，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/KF4fAKCkGe.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>方框中的数据是356个（356=23+117+6+210），其中，我们从是否得癌症的角度来看，29个人得癌症（29=23+3），327人不得癌症（327=117+210），我们从是否含有突变基因的角度来看，含有突变基因的人数是140（140=23+117），不含突变基因的人数是216（216=6+210）。</p>
<p>此时，我们可以使用比数比（odds ratio）来研究突变基因与癌症之间的关系，如果一个人含有突变基因，那么它得病症的风险（odds，比数）有多高？如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/ie440mJ2mc.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>如果一个人含有突变基因，那么他得癌症的的风险（odds）为<code>23/117</code>，如果一个人不含突变基因，那么他得癌症的风险就是<code>6/210</code>，此时我们把<code>23/117</code>放在分子上，把<code>6/210</code>放在分母上，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/KK8fb09agf.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>它们整体上被称为比数比（odds ratio），如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/ad6cb4cAmc.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>经计算，可得比数比（odds ratio）为6.88，这个数字告诉我们，含有突变基因的人得癌症的风险要比不含突变基因的人风险高出6.88倍，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/3h9DJE5JhG.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>把6.88进行log转换，就得到了1.93，这个转换的意义类似于线性回归中的<span class="math inline">\({R}^2\)</span>，它表示的是两个事件（在这个案例中是突变基因与癌症的关系）的关联程度，它们的值反映了事件的效应程度（effect size），如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/f8HEJf32AC.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>当这个值很大的时候，表示突变基因是癌症的一个很好的指标，如果这个值比较小，那么突变基因就不是癌症的一个很好指标，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/mBj0kbhChF.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时还有一个问题，还是与线性回归中的<span class="math inline">\({R}^2\)</span>一样，我们要知道，这个值是否有统计学上的意义，一共有3种方式来计算比数比（odds ratio），如下所示：</p>
<ol style="list-style-type: decimal">
<li>Fisher’s 精确检验</li>
<li>Chi-Square检验</li>
<li>The Wald检验（有人喜欢用这种方法来计算p值与置信区间）</li>
</ol>
<p>至于哪种方法好，目前还没有一个统计的认识，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/6m7D4D7I1h.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h3 id="fisher精确检验">Fisher精确检验</h3>
<p>我们先用Fisher精确检验来计算。</p>
<p>第一步，我们先把这几个数字当作是某个袋子中的不同颜色的巧克力豆（注：原视频说把这些豆子是M&amp;M豆，后来查了一下，这是美国的一个巧克力豆品牌，简称为MM豆，它有各种颜色），得癌症的用红色表示，不得的用蓝色表示，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/m64L1AAl53.png?" alt="mark">
<p class="caption">mark</p>
</div>
<p>第二步，在得癌症的人中，数字是29，也就是29=26+3，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/4db9k1CGA6.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>第三步：不得癌症的人的数字是327，也就是327=117+210，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/91Kl21jbCg.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>第四步：计算我们抓到23个红豆和117个蓝豆的p值，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/1eDb3F2DKa.png?" alt="mark">
<p class="caption">mark</p>
</div>
<p>经计算，这个p值为0.00001，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/Ihf95jEJIB.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h3 id="chi-square检验">Chi-square检验</h3>
<p>我们再用Chi-square来检验一下p值，它的原理就是通过比较理论值与真实值之间的差异来计算p值的。</p>
<p>第一步，我们先假设突变基因与癌症没有关系，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/9EGKacdK0A.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>第二步：计算整体中得癌症的概率，在这个数据集中，得癌症的人是29个，即29=23+6，那么它除以总的人数356（356=23+117+6+210）就是得癌症的概率，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/BIFj96L4B1.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>第三步：计算不同组中得得癌症的理论人数，以含有这个突变基因的组为例（这个组的人数是140，即140=23+117），那么这个组中得癌症的理论人数应该为140 x 0.08 = 11.2，如下所示：<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/Egkkg6IIf0.png?imageslim" alt="mark"></p>
<p>按照同样的方法，把所有组的理论得癌症人数都计算出来，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/6C66hLF6mk.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>第四步：比较理论值与观察值，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/5hb9IgCFD0.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>至于有2个p值，这主要是因为卡方检验通常是不连续数据，但样本量足够大的话，可以视为连续数据。因此在进行卡方检验时，可以使用连续性校正，也可以不使用。</p>
<h3 id="wald检验">Wald检验</h3>
<p>这种检验常常用于计算logistic回归中的比数比（odds ratios）的显示性与置信区间，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/Jccj8AlA9b.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>Wald检验会充分利用<code>log(odds ratios)</code>，它通常是服从正态分布的，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/HbeEICbIe8.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>这个直方图是由10000个随机的<code>log(odds ratio)</code>生成的，它告诉我们如果突变基因与癌症没有关系的话，可能的p值大小，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/j1D5J28Ei8.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>如果要在自己的计算机上绘制这个直方图，那么随机选择的人的数目就是300到400。在这个案例中我们计算的步骤如下（Wald检验不懂，我只能照着字面翻译）：</p>
<p>第一，我们选择的是325（数字位于300到400之间）；</p>
<p>第二，针对每个样本选择一个0到1之间的随机数，例如0.01，0.73，0.95；</p>
<p>第三，小于0.08的那些随机数就是得样本得癌症的概率，例如，17除以325就是0.05，小于0.08；</p>
<p>第四，为每个样本再挑选1个位于0到1之间的随机数字；</p>
<p>第五，小于0.05的那些随机数字就是含有突变基因的人数。</p>
<p>至少，我们会得到一个矩阵，这个矩阵中的值和基因与癌症之间的关系无关，下面主是这个矩阵，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/EI6KEl5bHf.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>𦘀，计算<code>log(odds ratio)</code>，做10000万次，然后绘制出直方图，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/CGk0kkj7gF.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>这个直方图的正态分布曲线如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/mKF8FIJjBd.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>在x=0处，log(odds ratio)=0，它表示不同组之间的比数（odds）没有差异，这个正态分布的标准差为0.43，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/Bgj15Lc0fH.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>通常使用观测值来估计标准差，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/IimeGaA54a.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>计算过程如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/E3Fj5iJ1kH.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>最终结果是0.47，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/HdajILDm7G.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>我们可以发现，这个0.47与0.43还是比较接近的。</p>
<p>Wald检验所做的就是观测值的<code>log(odds ratio)</code>距离0有多少个标准差，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/lL1GaegCfC.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>由于Wald检验通常使用估计的标准差（这里就是0.47），那么我们使用一个中心为0，标准差为0.47的正态分布区曲线来替换原来的直方图，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/bL4DH4kBbb.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时计算一下观测值的<code>log(odds ratio)</code>，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/7c414G74Le.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>计算可得<code>log(odds ratio)=1.93</code>，它位于曲线的右侧部分，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/3HEB90a8CJ.png" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时我们计算一个这个值距离0有几个标准差，我们只用它除以标准差即可，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/3HEB90a8CJ.png" alt="mark">
<p class="caption">mark</p>
</div>
<p>经计算可得，观测值的<code>log(odds ratio)</code>距离0有4.11个标准差，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/cIlL3l978i.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>按照我们平时的计算规则，通常偏离2个标准差的p值会小于0.05，那么此时我们就可以知道<code>log(odds ratio)</code>在统计学上的显著的，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/LbhLDmIAm1.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>不过，为了得到一个精确的双尾检验的p值，我们可以求出大于1.93以及小于-的.93的曲线下面积，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/H03ebDKGDc.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>不过上述是传统的，利用标准正态曲线计算的方式，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/0f5kcCmeGd.png" alt="mark">
<p class="caption">mark</p>
</div>
<p>利用这种方法就意味着，大于4.11以及小于-4.11的曲线下面积的点都加在了一起，其中4.11是<code>log(odds ratio)</code>离均值标准差的数目，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/JDF3j5JI1i.png" alt="mark">
<p class="caption">mark</p>
</div>
<p>最终我们计算的结果就是，突变基因与癌症之间没有关系的p值是0.00005，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/6akb28lB9B.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h3 id="三种方法总结">三种方法总结</h3>
<p>前面我们使用了3种方法来计算p值，当我们生成10000个随机的<code>log(odds ratios)</code>时，我们分别使用这3种方法来检验，如果检验符合预期，那么有5%的可能性p值是小于0.05的，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/C6Hhij57DF.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>从这三种方法的计算结果来看，它们在限制p值方面都表现得很好，因此你所做的就是找出你自己专业领域中最常用的方法。就作者个人的看法，如果都能通过所有的检验，那么他会选择一个在边界上的p值。</p>
<h2 id="总结">总结</h2>
<p>比数比（odds ratio）就是比数（odds）的比，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/aA3j7FAHIB.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p><code>log(odds ratio)</code>就是<code>odds ratio</code>进行log转换，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/lhHieH3KKL.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>比数比（odds ratio）会告诉我们两件事情之间的联系，例如有某种突变基因的人是否会增加其得癌症的风险（odds），如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/iGHdmijA93.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>有三种方法来计算两个事件之间的p值，分别为Fisher精确检验，Chi-Square检验，Wald检验，在前面的案例中，这3个检验得到的p值如下所示：<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/BJK6mji22a.png?imageslim" alt="mark"></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2018/06/08/BioStatistics/生物统计-StatQuest学习笔记07-最大似然法详解/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/06/08/BioStatistics/生物统计-StatQuest学习笔记07-最大似然法详解/" itemprop="url">StatQuest学习笔记07——最大似然法详解</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-06-08T12:10:54+08:00">
                2018-06-08
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/生物统计/" itemprop="url" rel="index">
                    <span itemprop="name">生物统计</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  3,190
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  11
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="主要内容">主要内容</h2>
<p>这篇笔记的主要内容是讲最大似然法的，笔记源于StatQuest的视频文件26，27，28。其中文件26内容为j最大似然法（Maximun likelihood）的原理；文件27内容为指数分布；文件28内容为概率和似然。</p>
<h2 id="最大似然法">最大似然法</h2>
<p>我们先看一种情况，下面是一批小鼠的体重数据：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/G2bG66j2e6.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>最大似然法的目的就是找出这批数据最符合哪种分布，而分布呢，有很多种，例如正态分布（Normal），指数分布（Exponential），γ分布（Gamma）等，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/A533eK7I4H.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>再次回到小鼠的体重数据，小鼠的体重貌似是服合正态分布的，就是下面的这种分布：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/AKcDCeA1d5.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>如果是服从正态分布，那么这批数据就有以下这些特点：</p>
<p>第一，大多数的测量数据（小鼠的体重）都接近于均值，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/0h1aBdFbh5.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>第二，这一批的数据都在均值的左右两侧大概呈对称分布，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/KKjLlmBF4A.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>不过正态分布也有各种形状，下图中的形状从左到右就是比较瘦的（skinny），正常的（medium），比较胖的（Large Boned），如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/Fc2jdaKfiA.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>一旦我们确定了我们这批数据是服从正态分布的，那么我们就要确定这批数据的中心在哪里，在这么多的正态分布中，为什么这个比那个更好：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/il1c0hCH9a.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>在找到想要正态分布之前，我们先随便看一个正态分布，看它与我们的数据匹配的程度，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/KDC6aJ8fF8.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>在下图中，这个正态分布的均值（也就是中间的虚线直线）意思就是，我们测量的多个数据应该在它附近分布。不过，我们的小鼠数据貌似不太在它的均值附近分布，大多数的数据都远离它，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/Debki7BDGm.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时，我们再换一个正态分布，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/dgFf151A27.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>在这个正态分布中，我们可以看到，小鼠的体重有很大概率分布在这个曲线的下方，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/4J3G20EF8F.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>我们继续换正态分布曲线，在下面的这个曲线中，我们看到，小鼠体重的数值在很大程度上是分布在曲线的左侧，离曲线的中心位置很远，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/hGC8c0bbcB.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>现在我们绘制一下，不同的正态分布曲线能够覆盖小鼠体重数据的可能性（likelihood），黑色的虚线就是正态分布曲线的均值所在位置，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180920/7Ejm3k6hla.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>从这张图可以看出，红色圈起来的点所在的位置有最大的可能性（maximizes the likelihood）观测到小鼠体重。把这个点所在的正态分布曲线提取出来，就是下面的这条曲线：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/l7fdmBidA0.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时，我们就找到均值的最大可能的估计值，就是下面的这个黑色虚线：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/lAE06L5gik.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时，我们再绘制对标准差的最大可能估计值，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/DJD3fjEbJF.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>按照上面的绘制不同曲线均值的方法来绘制标准差的最大可能观测值，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/923L4FIaJe.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>其中的绿色曲线就是符合我们的小鼠体重数据的曲线，能够最大可能地估计这批数据的均值与标准差，它是最终我们想要的正态分布曲线，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/EgLhFlkAed.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时我们明白，当有人说他们最大可能地估计了均值或标准差的时候，你就知道，你所观察到的东西就是你最大可能所观察所到的东西，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180920/D4bC8EdH8e.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>对于大多数人来说，“概率（probability）”和“似然（likelihood）”就是一样的。但是，在我们这个教程里，“似然”专门指的是我们所讲的内容，也就是说，似然指的是，你有一批数据，你要找到符合这个数据的某个分布，寻找方法就是找到这个分布的均值和标准差（我觉得这两个参数只适用于正态分布），如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/KDiECKcGJf.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>另外我又找了一些资料，总结一下最大似然法与概率的区别（在后文还会讲到）：</p>
<p>极大似然估计，通俗理解来说，就是利用已知的样本结果信息，反推最具有可能（最大概率）导致这些样本结果出现的模型参数值。举个例子。</p>
<p>假如有一个罐子，里面有黑白两种颜色的球，数目多少不知，两种颜色的比例也不知。我 们想知道罐中白球和黑球的比例，但我们不能把罐中的球全部拿出来数。现在我们可以每次任意从已经摇匀的罐中拿一个球出来，记录球的颜色，然后把拿出来的球 再放回罐中。这个过程可以重复，我们可以用记录的球的颜色来估计罐中黑白球的比例。假如在前面的一百次重复记录中，有七十次是白球，请问罐中白球所占的比例最有可能是多少？很多人马上就有答案了：70%。而其后的理论支撑是什么呢？就最大似然法。</p>
<p>而概率，就是我们已知现在某事件的概率，来计算它可能的结果。打个比方就是，我们知道一个袋子里有100个球，30个白球，70个黑球，伸手进去抓一个球，是黑球的概率是多少？这就是概率。</p>
<h2 id="最大似然法与指数分布">最大似然法与指数分布</h2>
<h3 id="什么是指数分布">什么是指数分布</h3>
<p>指数分布研究的是事件的时间间隔的概率，像下面这些都属于指数分布：你收到两条微信之间的时间间隔，婴儿出生的时间间隔，来电的时间间隔，奶粉销售的时间间隔，网站访问的时间间隔，它的分布曲线如下所示，其中y轴和x轴与曲线围成的面积是1：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180920/KK3m1E598a.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>如果我们对某个事件感兴趣，那么它在在0到5秒内发生的概率就是<code>x=0</code>到<code>x=5</code>之间的这个面积，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/dCkl0iDHkL.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>这个曲线的方程如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/4A63hgaL62.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时我们在x轴上找到一个值（红叉所在位置），把它代入方程，得到y值，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/cdL3jg3Bjk.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>其中λ表示是的“率”(rate)，它表示的是事情发生的频率，如果λ=1，那么这个公式描述的就是正在发生的事情（就像你此时正在看这个视频这个事件），如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/maG6G7Dji0.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>如果λ=2（红线），这条曲线描述的就是某些人正在看视频，频率是每秒发生2次，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/L42gAL2GAi.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>如果λ=0.5（黑线），它描述的就是每2秒有1个人在看视频，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/Glb943FIFc.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h3 id="最大似然法与指数分布-1">最大似然法与指数分布</h3>
<p>我们利用最大然法来找某组数据符合指数分布的目标就是要找到<code>λ</code>值，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/kl790i15ji.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>因此，我们（指作者自己）收入了一些该视频观看的时间，其中数据如下：</p>
<p>x1=第1次观看视频与第2次观看视频之间的时间；</p>
<p>x2=第2次观看视频与第3次观看视频之间的时间；</p>
<p>x3=第3次观看视频与第4次观看视频之间的时间；</p>
<p>…</p>
<p>xn=第n次观看视频与第n+1次观看视频之间的时间。</p>
<p>其中n就是我们的数据数目，此时我们假设我们已经有了一个很好的<code>λ</code>值。那么这个<code>λ</code>是我们第1次数据<code>x1</code>值的可能性是多少呢，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/KFEC5Ca5G6.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>在上面的公式里，<code>L</code>表示概率，整个公式表示，<code>x1</code>时的概率，同样的，我们可以代入x2，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/2HADD68JDH.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>那么在x1和x2存在时，λ可能的值是多少呢？下面是计算过程：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/IG4EcELFBe.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>如果是x1，x2到xn呢？计算过程如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/mAgIb44g7H.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>但是，如果我们没有一个很好的λ值呢，为了找到这个λ值，我们需要这么计算（其实就是对下面的这个方程求导，然后令导数等于0即可）：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/gi73kidmIE.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>上述的<code>L</code>及其后面的公式总体叫做“最大似然函数”（Likelihood function），求它的过程如下所示：</p>
<p>第一步，求出最大似然函数的导数，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/60aBkBBAI6.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>我们发现，导数的右边含有自然常数<code>e</code>，因此我们可以进行一个log转换，接着计算就行，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/5D79DjleBA.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>第二步，令导数等于0，接着再计算，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180920/8GG57caJje.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>从最终的计算结果来看，当我们收集了很多事件之间的时间间隔时，我们把它们代入公式，我们就得到了对λ的最佳估计值，然后我们就可以将这个λ代入指数方程了。</p>
<h3 id="一个案例">一个案例</h3>
<p>例如，如果在第1次观看和第2次观看之间的时间间隔是2秒，也就是说x1=2，在第2次观看和第3次观看之间的时间间隔是2.5秒，那么x2=2.5，而在第3次和第4次观看之间的时间间隔是1.5秒，那么x3=1.5，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/67EJGbIlIH.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>代入方程，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180920/ccA1i7cD3L.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h2 id="概率与最大似然估计">概率与最大似然估计</h2>
<p>我们先看一下小鼠体重的正态分布，它的均值是32，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/JIdki7iamG.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>标准差为2.5，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/KjFfeL5bD7.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>最低值是24，最高值是40，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/EBD3G8EmA8.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时，我们计算一下32克到34克之间小鼠的概率：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/FF6FAKGD25.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>它的概率就是由正态分布曲线，x轴，以及x=32，x=34围成的面积，就是下面的红色面积部分，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/79bE0CLGce.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>经计算，这个面积是0.29，这就是说当我们随机选择一个小鼠时，它的体重在32克到34克之间的概率是29%，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/EHD0dDFH9J.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>那么在数学上，我们可以用<code>pr</code>这个符号来表示表示这个概率，完整的表示方法就是<code>pr(体重在32到43之间 | 均值 = 32，标准差=2.5)=0.29</code>，这个公式中间有一个竖线，即<code>|</code>，它表示<code>given</code>，就是说给定的条件，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/3l767EGmhB.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>现在我们计算一下，随机挑选一只小鼠，它体重大于34克的概率，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/fcghi5jLfJ.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>当我们在讨论概率的时候，我们讨论的就是在一个已知分布下，求满足某个条件的概率，就是前面两个案例。现在我们转向最大似然法，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/d13mAcLaKJ.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>在讲最大似然法时，我们先假定已经称了1只小鼠的体重了（其实也可以是几只），它的体重是34，它在图中的位置就是红点所在位置：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/3430b9DI70.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>那么我们称1只小鼠是34克在下图正态分布曲线上的可能性就在下面的这个点上：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/6I5a6cmHcf.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>从数学上，我们可以用下面的这个公式来表示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/I4ljB0cLGa.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p><code>L</code>就是Likelihood的缩写，<code>L(mean = 32 and standard deviation = 2.5)</code>表示：某点个在一个分布（均值为32，标准差为2.5）的可能性，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180920/4GDAlEdb24.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>这个竖线<code>|</code>表示给定条件（其实就是我们称的小鼠的体重）的意思：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/3J1mLC5cDF.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>竖线后面的就是具体的条件（小鼠体重是34克），最终计算的结果是0.12，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/EIHKckIkgg.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时，我们就可以说，我们称了一只小鼠，它的体重是34克，它在某个正态分布曲线（均值为32，标准差为2.5）上的可能性（likelihood）是12%。此时，我们再换一个正态分布曲线（它的均值是34，标准差为2.5），如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/ILhJ04A5k0.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>经计算，它在这条曲线上的可能性是21%，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180920/b3IHGc6f26.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>从上面的讲解我们可以得到这些结论：</p>
<ol style="list-style-type: decimal">
<li><p>概率（probability）指的是某个固定曲线下的面积，它表示为<code>pr(data | distribution)</code>；</p></li>
<li><p>似然（Likelihood）指的是对于某个固定的点，它对应的y轴上的数值，这个y轴上的数值在不同的曲线上的取值是不同的，用数学表示就是<code>L(distribution | data)</code>，如下所示：</p></li>
</ol>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/6fcKA16jAg.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>也可以是这样：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/J9kFKaJA0J.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>概率的计算公式如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180614/GClke7D5cL.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>## 参考资料</p>
<p><a href="https://www.zhihu.com/question/20447622" target="_blank" rel="external">1.最大似然估计和最小二乘法怎么理解？</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2018/06/07/BioStatistics/生物统计-StatQuest学习笔记05-线性模型/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/06/07/BioStatistics/生物统计-StatQuest学习笔记05-线性模型/" itemprop="url">StatQuest学习笔记05——线性模型</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-06-07T12:10:54+08:00">
                2018-06-07
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/生物统计/" itemprop="url" rel="index">
                    <span itemprop="name">生物统计</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  12,377
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  48
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="前言主要内容">前言——主要内容</h2>
<p>这篇笔记是StatQuest视频教程的第16到22。其中第16内容是线性回归（Linear Regression，它也叫一般线性模型 即General Linear Models）的基本原理；第17内容是在R语言中进行线性回归；第18内容是多重线性回归；第19内容是R主语言与多重线性回归；第20内容是一般线性模型中的t检验与ANOVA；第21内容是设计矩阵；第22内容是在R语言中设计矩阵。</p>
<h2 id="线性回归主要思想">线性回归主要思想</h2>
<p>线性回归的主要思想就是利用最小二乘法找到最佳拟合曲线，计算<span class="math inline">\({R}^2\)</span>，计算p值，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/b5am62BhE2.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>在第4篇笔记中，我们利用了最小二乘法计算了小鼠的体重与大小的线性关系，具体的计算过程可以参见上一篇笔记，最终的线性回归方程如下所示：<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/gDe3AGfDBj.png?imageslim" alt="mark"></p>
<p>由于这个方程的斜率不为0，因此我们知道小鼠的体重的话，就能够预测小鼠的大小。此时我们要看一下这个回归方程的好坏程度，也就是看一下<span class="math inline">\({R}^2\)</span>的意义，第一步，计算小鼠的平均大小，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/llg8BiCmIl.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>将这些小鼠大小的点投射到y轴上，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/E4GC21lG41.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>下图中的黑色横线就是小鼠大小的平均值，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/d2l3L45a4e.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>接着计算离均差平方和（SS），这里需要与残差平方和进行区分。</p>
<p>离均差平方和是指一组数据中，每个数据与均值差值的平方，英文就是SS，全称为sum of squares of deviation from mean ），而残差平方和（SSE）是指观察值与拟合值之间的差异的平方，图计算的是SS：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/hLfHFHcjcI.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>SS的公式，而这组数据的方差则是指SS除以样本数，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/kJG4CG8I8L.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时再回到原始数据，我们将通过最小二乘得到的曲线与每个原始值差值的平方加起来，这个是残差平方和SS(fit)（这个其实就是上篇笔记中提到的SSE），残差平方和除以样本数，就是残差的平均方差（即Var(fit)=SS(fit)/n，这个值没有找到相应的术语），它的公式如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/ADA8Jeb8Dl.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>通常来说，变异等于总的离均差平方和除以样本数，也就是均方差，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/fFIaGgfmAA.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>下图的左图是小鼠的大小的变异（variance），右图是原始数据与回归曲线之间的变异：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/9ejGaaCEH9.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>如果将上述左图的点与自身均值差值的平方和与右图中原始数据的点和拟合的曲线的距离相比，右边这种通过最小二乘法得到的曲线的变异更小。因此我们在右图中可以知道，如果考虑了小鼠的体重，那么这条曲线可以解释小鼠大小的变异，也就是说，小鼠体重越大，它的大小就越大，反之，也是如此，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/mbkIaFaBI5.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p><span class="math inline">\({R}^2\)</span>指的就是小鼠的体重可以解释小鼠大小的程度，它的公式如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/am90i94fe3.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>经计算，发现原始数据的均言状为11.1，拟合曲线的均方差为4.4，那么<span class="math inline">\({R}^2\)</span>的结果如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/biakGCAiG1.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>从上图我们可以说，当考虑了小鼠的体重时，小鼠的大小的变异程度会降低60%（这是与原始数据只考虑小鼠的大小，不考虑小鼠的体重相比），也可以说，小鼠大小的变异可以解释小鼠体重变异的60%。</p>
<p>我们也可以采用平方和来计算，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/HL5IbhEmFb.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>我们再看一个案例，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/hG3E3cf0Km.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>在这个案例中，拟合曲线的变异是0，因此小鼠的体重可以解释小鼠大小100%的变异。</p>
<p>再看一个案例，在这个案例中，我们知道小鼠的体重，但是无法根据小鼠的体重来预测小鼠的大小，因为原始数据的变异为11.1，拟合曲线的变异也是11.1，那么<span class="math inline">\({R}^2\)</span>就等于0，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/jH78Fa0ICc.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>当我们计算离均差平方和（SS(mean)）时，我们会将忽略小鼠的体重，将每个数据点投射到y轴（也就是小鼠的大小上），如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/Kc9JJ6bgB1.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时我们绘制一条小鼠大小的平均值曲线，如下图所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/3fh8agIiBH.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时计算这些数据点距离这个平均值曲线的距离，也就是SS(mean）)，最终我们会得到这个回归曲线，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/g98DJFkcIG.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>以上就是最小二乘法求线性回归的基本思想，它可以应用到更复杂的公式中去，它的思想就是，先计算原始数据的离均差平方和SS(mean)，再计算这些数据与拟合曲线的的差值平方和，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/k5AI8FkF13.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h2 id="复杂案例">复杂案例</h2>
<p>此时我们再看一个稍微复杂的案例。</p>
<p>还是以小鼠为例说明，如果我们知道小鼠的体重（<code>weight</code>），尾巴长度（<code>tail length</code>）和小鼠的身体长度（<code>body length</code>），我们就可以根据前两个变量来预测第三个变量，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/fjGACBGgKK.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时，我们将这3个变量投射到一个三维坐标系中，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/K10C6i7hcK.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>例如我们有一个数据，它在坐标中的位置就如下所示：<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/DmeicEd6f8.png?imageslim" alt="mark"></p>
<p>现在把所有的数据点都放到这个坐标中，则如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/jBam00c63F.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时，我们利用最小二乘法来计算拟合曲线，由于这是三维坐标，这个曲线其实是不是曲线（在二维坐标中是曲线，在三维坐标中就是一个平面了），而是一个平面，如下所示：<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/cA3bj677If.png?imageslim" alt="mark"></p>
<p>这个平面的方程就如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/3K885habj7.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>其中，y是身体长度，x是体重，z是尾巴长度，而0.1则是在y轴上的截矩。如果我们知道一个小鼠的体重和尾巴长度，那么我们就能计算出小鼠的身体长度，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/4Fim4ElIHI.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时，我们按照二维坐标的计算方式来计算<span class="math inline">\({R}^2\)</span>，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/52aL6bKfGg.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时，这个z轴数据是没用的，它并不会用于计算SS(fit)，此时可以将z值视为0并不会影响预测小鼠的身体长度，然后使用最小二乘法，如下所示（这一步的推导过程我不理解）：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/AH5Edak0Em.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>在上图中，把z视为0，意味着，与更少的参数相比，更多的参数并不会让SS(fit)更差（字面翻译，具体原理还没弄懂）。换句话说，像下面的这个公式那样：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/dDblkBkjkE.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>虽然Mouse size这个等号后面有很多参数，但是这个公式与下面Mouse size = 0.3 + mouse weight是差不多的，剔除的那几个参数并不会影响Mouse size，因此可以把那些不必要的参数系数设为0，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/50bBJ7ALcf.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>由于存在一些随机因素，小老鼠在这个数据集中得到硬币朝上（get heads）概率并不比大老鼠的高，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/9FGeEHF7lI.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>因此在这个公式中，如果有更多的参数，那么我们就有了更多的随机事情来降低SS(fit)，导致产生一个更好的<span class="math inline">\({R}^2\)</span>，因此人们会使用一个调整的<span class="math inline">\({R}^2\)</span>（adjusted <span class="math inline">\({R}^2\)</span>，从本质上来讲，就是参数的数据来对<span class="math inline">\({R}^2\)</span>进行校正。</p>
<p><span class="math inline">\({R}^2\)</span>虽然是一个很重要的指标，但是它也有一些局限，看下面的案例：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/lgDGeBbE07.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>在上图中，只有2个点，计算的SS(mean)=10，SS(fit)=0，后者等于0是因为你总能画出经过两个点的直线，并求出其方程，因此求出的R的平方就是100%，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/61Ib3a9mCD.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>虽然R的平方是100%，这是一个很好的数字，但是任意两个数字都能得到同样的R的平方（其实在利用Qubit测文库的时候，就只是使用了2个标准品，标准品虽然含量非常准，但也是一个非常粗糙的估计，因此在对文库进行定量时，还要配合使用qPCR），下面的这两个数字得到的R的平方也是100%，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/4becki579f.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>为了解决这个问题，我们需要研究一下R的平方是否有统计学意义，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/A0D1LmjL79.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>在计算p值之前，我们先看一下<span class="math inline">\({R}^2\)</span>是如何定义的，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/KeCFjAGcKB.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>在小鼠的体重与大小的数据中，我们得到的<span class="math inline">\({R}^2\)</span>是0.6，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/68kEKmLaGc.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>在计算<span class="math inline">\({R}^2\)</span>方面，我们会使用一个统计量，即F，F的公式如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/2a18Lh3dm8.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p><span class="math inline">\({R}^2\)</span>的计算公式和F统计量的计算公式的分子是一样的，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/hh1jDb2m3b.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>这个分子的意义就是小鼠体重的变异，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/1IAk8bAGJj.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>F的分母有点不太一样，它的意义如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/JFeFa4H7j1.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>在上图中，下图中的蓝色虚线就是拟合曲线与实际值的差值，它的平方和就变异程度，也就是无法被体重解释的小鼠大小的程度，现在再看一下<span class="math inline">\({R}^2\)</span>和F统计量的公式，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/Em7j9A2ed1.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>这两个公式的有一部分是一样的，也就是那些平方和，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/aedJcKB2iH.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>转换到图形上，则是这个样子：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/I1B6K7Ahi8.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>F统计量分母中的一部分是拟合后的平方和，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/4ebc09Fbfm.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>F后面的那一坨东西是自由度，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/D7Bej0lC12.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>我们此时看一下什么是自由度，就先从红色方框中的部分开始，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/8aE5cflKFH.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>拟合曲线中有2个参数，即y=y-intercept + slope x中有intercept和slope这两个参数，它就有2个自由度，而均值的公式是y=y-intercept，它只有一个参数，因此它就是1个自由度。换话句话说，与均值的公式相比，拟合曲线多了一个自由度，即斜率，斜率代表了体重与大小的关系，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/AdAhH4ffki.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>那么原来红色方框中的那一部分的值就是1，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/Fe7mjdAjc4.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>那么F统计量的分子就是由这个多出来的参数解释的变异程度，在这个案例中，就是由小鼠的体重解释小鼠大小的变异程度，如下所示： <img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/mimdidHdEd.png?imageslim" alt="mark"></p>
<p>如果我们使用小鼠的体重，尾巴长度来解释小鼠大小的变异，就是这个样子：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/deie0Im1kC.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>它的拟合曲线的自由度就是3，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/dE1GCC46KI.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时我们再看一下F统计量的分子，这个分母就是由拟合曲线无法解释的程度，这个分母中的有一个参数n，随后我们会解释，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/f1FCFjHd46.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>直观上讲，如果我们的公式中有更多的的参数，那么我们就需要多的数据来估计它们，例如我们只需要2个点就能绘制出一条直线，但是我们如果要绘制一个平面，那么至少需要3个点。再接着看F统计量，如果拟合曲线比较好，那么F的值就是一个比较大的数字（从公式上也能看出来，拟合比较好的话，肯定是我们解释的程度要远远大于不能解释的程度），如下图所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/K5J78EcCA6.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时，我们需要把F值转换为p值，先看一个小案例，下面的是一组随机数据，它们计算出来的F值是2，把F值绘制到一个直方图上，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/99GH7G9bCC.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>再来看一组数据，计算其SS(mean)和SS(fit)，计算F值，再添加到直方图上，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/8mABdhme89.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>再来计算一组随机数据，方法同上，得到F值为1，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/Bccac0BCk4.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>不断地重复这个过程，我们会得到很多F值，然后把它们都绘制到直方图上，例如其中一个F值是6，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/40ehheJDij.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>从上面的这个图中我们可以知道这些信息：</p>
<ol style="list-style-type: decimal">
<li>x轴上对应的是F值，从左到右依次增大；</li>
<li>F值越大，这个F值的点占到整个直方图中的比例也就越低，换句话讲，就是F值更大，它就是一个越不容易得到的值，如果把得到F值的这个概率定为p，那么，F值越大，p值就越小（也就是说F值越大，它越是一个极端的值，不太容易出现）。</li>
</ol>
<p>此时，把上面的直方图用一条曲线拟合起来，事实上，我们在计算F值对应的p值时，通常是使用曲线，而不是直方图，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/d9Kfka3l1h.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时我们看一个F值的分布，F值的分布曲线是由其自由度决定的，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/c3KFKc0Dii.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>再看由两个F分布叠加的图形，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/52IAkleAm9.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>从这张图形上我们可以看出，自由度越大，F分布的曲线下降得越厉害，也就是说，拟合曲线中的参数越多（自由度高），样本数目赵多，p值越小。其实这也是F分布的原理。</p>
<h2 id="r语言与线性回归">R语言与线性回归</h2>
<p>此时我们看一下原始数据，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">weight = <span class="number">0.9</span>, <span class="number">1.8</span>, <span class="number">2.4</span>, <span class="number">3.5</span>, <span class="number">3.9</span>, <span class="number">4.4</span>, <span class="number">5.1</span>, <span class="number">5.6</span>, <span class="number">6.3</span></div><div class="line">size = <span class="number">1.4</span>, <span class="number">2.6</span>, <span class="number">1.0</span>, <span class="number">3.7</span>, <span class="number">5.5</span>, <span class="number">3.2</span>, <span class="number">3.0</span>, <span class="number">4.9</span>, <span class="number">6.3</span></div></pre></td></tr></table></figure>
<p>此时绘制出小鼠的体重与其大小的散点图，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">weight &lt;- c(<span class="number">0.9</span>, <span class="number">1.8</span>, <span class="number">2.4</span>, <span class="number">3.5</span>, <span class="number">3.9</span>, <span class="number">4.4</span>, <span class="number">5.1</span>, <span class="number">5.6</span>, <span class="number">6.3</span>)</div><div class="line">size &lt;- c(<span class="number">1.4</span>, <span class="number">2.6</span>, <span class="number">1.0</span>, <span class="number">3.7</span>, <span class="number">5.5</span>, <span class="number">3.2</span>, <span class="number">3.0</span>, <span class="number">4.9</span>, <span class="number">6.3</span>)</div><div class="line">mouse.data &lt;- data.frame(weight, size)</div><div class="line">head(mouse.data)</div><div class="line">plot(mouse.data$weight,mouse.data$size)</div><div class="line">mouse.regression &lt;- lm(size~weight, data=mouse.data)</div><div class="line">summary(mouse.regression)</div></pre></td></tr></table></figure>
<p>图形如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/mB45b3bhFj.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>线性回归统计结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">&gt; summary(mouse.regression)</div><div class="line"></div><div class="line">Call:</div><div class="line">lm(formula = size ~ weight, data = mouse.data)</div><div class="line"></div><div class="line">Residuals:</div><div class="line">    Min      1Q  Median      3Q     Max </div><div class="line">-<span class="number">1.5482</span> -<span class="number">0.8037</span>  <span class="number">0.1186</span>  <span class="number">0.6186</span>  <span class="number">1.8852</span> </div><div class="line"></div><div class="line">Coefficients:</div><div class="line">            Estimate Std. Error t value Pr(&gt;|t|)  </div><div class="line">(Intercept)   <span class="number">0.5813</span>     <span class="number">0.9647</span>   <span class="number">0.603</span>   <span class="number">0.5658</span>  </div><div class="line">weight        <span class="number">0.7778</span>     <span class="number">0.2334</span>   <span class="number">3.332</span>   <span class="number">0.0126</span> *</div><div class="line">---</div><div class="line">Signif. codes:  <span class="number">0</span> ‘***’ <span class="number">0.001</span> ‘**’ <span class="number">0.01</span> ‘*’ <span class="number">0.05</span> ‘.’ <span class="number">0.1</span> ‘ ’ <span class="number">1</span></div><div class="line"></div><div class="line">Residual standard error: <span class="number">1.19</span> on <span class="number">7</span> degrees of freedom</div><div class="line">Multiple R-squared:  <span class="number">0.6133</span>,	Adjusted R-squared:  <span class="number">0.558</span> </div><div class="line"><span class="literal">F</span>-statistic:  <span class="number">11.1</span> on <span class="number">1</span> and <span class="number">7</span> DF,  p-value: <span class="number">0.01256</span></div></pre></td></tr></table></figure>
<p>现在解释一下这个结果：</p>
<p>第一部分：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Call:</div><div class="line">lm(formula = size ~ weight, data = mouse.data)</div></pre></td></tr></table></figure>
<p>这一行表示的是使用<code>lm()</code>函数进行线性回归的公式，这里的size是自变量，weight是因变量，数据集来源于<code>mouse.data</code>。</p>
<p>第二部分：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">Residuals:</div><div class="line">    Min      1Q  Median      3Q     Max </div><div class="line">-<span class="number">1.5482</span> -<span class="number">0.8037</span>  <span class="number">0.1186</span>  <span class="number">0.6186</span>  <span class="number">1.8852</span></div></pre></td></tr></table></figure>
<p>这是残差的结果，它表示原始数据距离拟合曲线的距离的 一些统计情况，如果是理想情况，那么正值与负值的频率是一样的，也就是说原始值在拟合曲线上方与下方的点是一样的。</p>
<p>第三部分：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">Coefficients:</div><div class="line">            Estimate Std. Error t value Pr(&gt;|t|)  </div><div class="line">(Intercept)   <span class="number">0.5813</span>     <span class="number">0.9647</span>   <span class="number">0.603</span>   <span class="number">0.5658</span>  </div><div class="line">weight        <span class="number">0.7778</span>     <span class="number">0.2334</span>   <span class="number">3.332</span>   <span class="number">0.0126</span> *</div><div class="line">Signif. codes:  <span class="number">0</span> ‘***’ <span class="number">0.001</span> ‘**’ <span class="number">0.01</span> ‘*’ <span class="number">0.05</span> ‘.’ <span class="number">0.1</span> ‘ ’ <span class="number">1</span></div><div class="line"></div><div class="line">Residual standard error: <span class="number">1.19</span> on <span class="number">7</span> degrees of freedom</div></pre></td></tr></table></figure>
<p>这一部分是经过最小二乘法计算得到出的拟合曲线的系数，其中第1列第1个数字0.5813，就是截矩，截矩下方的0.7778是斜率，那么得到的拟合曲线公式就是：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">size = <span class="number">0.5813</span> + <span class="number">0.7778</span> x weight</div></pre></td></tr></table></figure>
<p>第2列与第3列是回归曲线的截矩与斜率的标准差与t值。第4列，也就是最后一列，是这些估计值的p值，通常来说，我们并不关注截矩的这个值。也就是说，它的p值大小我们不乎。但是，斜率，也就是说<code>weight</code>的这个p值必须要小于0.05，也就是说，它必须要有统计学意义，只有这样，我们才能对小鼠的大小进行一个可靠的估计，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/LmCbG3mKf7.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>这个案例的线性回归结果中，<code>weight</code>的p值是小于0.05的，也就是说它有意义，它后面有一个<code>*</code>号，这个<code>*</code>表示p值大于0.01，小于0.5，我们可以在统计结果中看到<code>*</code>的数量对应的p值大小。</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/idblehLefG.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>最后一行是下面的内容：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Residual standard error: <span class="number">1.19</span> on <span class="number">7</span> degrees of freedom</div></pre></td></tr></table></figure>
<p>它表示，拟合曲线有7个自由度，残差的标准差为1.19。</p>
<p>第四部分：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Multiple R-squared:  <span class="number">0.6133</span>,	Adjusted R-squared:  <span class="number">0.558</span> </div><div class="line"><span class="literal">F</span>-statistic:  <span class="number">11.1</span> on <span class="number">1</span> and <span class="number">7</span> DF,  p-value: <span class="number">0.01256</span></div></pre></td></tr></table></figure>
<p>在这一部分的结果中，我们可以得到这些信息：</p>
<ol style="list-style-type: decimal">
<li><code>Multiple R-squared:  0.6133</code>表示的是<span class="math inline">\({R}^2\)</span>，它表示体重可以解释61%的小鼠大小的变异，这已经是很好的结果了；</li>
<li><code>Adjusted R-squared:  0.558</code>这个是由参数的多少调控后的<span class="math inline">\({R}^2\)</span>的值；</li>
<li><code>F-statistic:  11.1 on 1 and 7 DF,</code>这表示F的统计量为11.1，1和7是两个自由度；</li>
<li><code>p-value: 0.01256</code>这是F统计量对应的结果。</li>
</ol>
<p>最后我们可以在这个散点图上添加拟合曲线，输入命令<code>abline(mouse.regression, col=&quot;blue&quot;)</code>即可，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/1DlbA0BIHC.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h2 id="多元线性回归">多元线性回归</h2>
<p>前面我们讲的线性回归其实只有2个变量（小鼠的体重与小鼠的大小），这种线性回归可以视为简单线性回归，其实线性回归还可以涉及到多个变量，这就是多元线性回归。而很多不太理解线性回归的人通常认为简单线性回归与多元线性回归差异很大，其实它们在本质上没多少区别。下图的左图是简单线性回归，右图是多元线性回归，在计算<span class="math inline">\({R}^2\)</span>方面，它们没有区别，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/L3AjJJADAi.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>在多元线性回归中，需要对<span class="math inline">\({R}^2\)</span>进行调整，从而与多元线性回归方程中的多个参数对应，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/EBd3ka3BlB.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>在计算F值时，这两种回归的原理是一样的，只是简单线性回归的p(fit)=2，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/6h3BFmAELJ.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>多元线性回归的p(fit)=3（只是在这个案例中，多元线性回归的p(fit)=3，如果是其他的案例，还要具体情况具体分析），如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/lEd21cAea6.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>它们的截矩都是一样的，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/K1Ad3CefB4.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时我们分别将这两种回归方程中各个数据点与截矩进行对比，来找出这两个回归的优劣：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/EHdJ8fmKcG.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>比较均值可能不太容易看出来，我们可以将这两个回归直接相互进行对比，我们就能知道，我们是否值得花时间和精力收集额外的一个数据，并将其添加到回归方程中，即一个小鼠尾巴（tail length）这个数据，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/1e1K67dfDd.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时，我们按照之前计算F的方法来计算一下这两个线性回归方和的F值，跟先前计算F值不太相同的地方在于，我们使用了简单线性回归的来替换原来的均值，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/1241K9DH4A.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>SS(simple)如下所示： <img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/GK17d0HekG.png?imageslim" alt="mark"></p>
<p>此时，p(simple)=2，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/6ai40dD4iF.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>SS(multiple)如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/2gBkebL1md.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>而p(multiple)=3，如下所示： <img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/f3A4ID9e5E.png?imageslim" alt="mark"></p>
<p>如果简单线性回归和多元线性回归的<span class="math inline">\({R}^2\)</span>差值很大，并且p值很小，那么向简单线性回归中添加一个小鼠尾巴变量（tail length）就是有必要的，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/EEmBbl22IJ.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h2 id="r语言与多重线性回归">R语言与多重线性回归</h2>
<p>此时，我们添加上小鼠尾巴的数据，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">tail = <span class="number">0.7</span>, <span class="number">1.3</span>, <span class="number">0.7</span>, <span class="number">2.0</span>, <span class="number">3.6</span>, <span class="number">3.0</span>, <span class="number">2.9</span>, <span class="number">3.9</span>, <span class="number">4.0</span></div></pre></td></tr></table></figure>
<p>构建小鼠的三个变量的数据框，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">weight &lt;- c(<span class="number">0.9</span>, <span class="number">1.8</span>, <span class="number">2.4</span>, <span class="number">3.5</span>, <span class="number">3.9</span>, <span class="number">4.4</span>, <span class="number">5.1</span>, <span class="number">5.6</span>, <span class="number">6.3</span>)</div><div class="line">size &lt;- c(<span class="number">1.4</span>, <span class="number">2.6</span>, <span class="number">1.0</span>, <span class="number">3.7</span>, <span class="number">5.5</span>, <span class="number">3.2</span>, <span class="number">3.0</span>, <span class="number">4.9</span>, <span class="number">6.3</span>)</div><div class="line">tail &lt;- c(<span class="number">0.7</span>, <span class="number">1.3</span>, <span class="number">0.7</span>, <span class="number">2.0</span>, <span class="number">3.6</span>, <span class="number">3.0</span>, <span class="number">2.9</span>, <span class="number">3.9</span>, <span class="number">4.0</span>)</div><div class="line">mouse.data &lt;- data.frame(size,weight,tail)</div><div class="line">head(mouse.data)</div></pre></td></tr></table></figure>
<p>构建好的数据框如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">&gt; head(mouse.data)</div><div class="line">  size weight tail</div><div class="line"><span class="number">1</span>  <span class="number">1.4</span>    <span class="number">0.9</span>  <span class="number">0.7</span></div><div class="line"><span class="number">2</span>  <span class="number">2.6</span>    <span class="number">1.8</span>  <span class="number">1.3</span></div><div class="line"><span class="number">3</span>  <span class="number">1.0</span>    <span class="number">2.4</span>  <span class="number">0.7</span></div><div class="line"><span class="number">4</span>  <span class="number">3.7</span>    <span class="number">3.5</span>  <span class="number">2.0</span></div><div class="line"><span class="number">5</span>  <span class="number">5.5</span>    <span class="number">3.9</span>  <span class="number">3.6</span></div><div class="line"><span class="number">6</span>  <span class="number">3.2</span>    <span class="number">4.4</span>  <span class="number">3.0</span></div></pre></td></tr></table></figure>
<h3 id="简单线性回归">简单线性回归</h3>
<p>我们先回顾一下简单线性回归，先绘制小鼠体重与其大小的散点图，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">plot(mouse.data$weight,mouse.data$size)</div></pre></td></tr></table></figure>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/6B08Ik4kc5.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>然后利用<code>lm()</code>函数来对小鼠的这体重和大小这两个变量做回归分析，再用<code>aline()</code>函数添加回归曲线，代码如下：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">simple.regression &lt;- lm(size ~ weight, data=mouse.data)</div><div class="line">summary(simple.regression)</div><div class="line">abline(simple.regressin, col=<span class="string">"red"</span>,lwd = <span class="number">2</span>)</div></pre></td></tr></table></figure>
<p>简单线性回归结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">&gt; summary(simple.regression)</div><div class="line"></div><div class="line">Call:</div><div class="line">lm(formula = size ~ weight, data = mouse.data)</div><div class="line"></div><div class="line">Residuals:</div><div class="line">    Min      1Q  Median      3Q     Max </div><div class="line">-<span class="number">1.5482</span> -<span class="number">0.8037</span>  <span class="number">0.1186</span>  <span class="number">0.6186</span>  <span class="number">1.8852</span> </div><div class="line"></div><div class="line">Coefficients:</div><div class="line">            Estimate Std. Error t value Pr(&gt;|t|)  </div><div class="line">(Intercept)   <span class="number">0.5813</span>     <span class="number">0.9647</span>   <span class="number">0.603</span>   <span class="number">0.5658</span>  </div><div class="line">weight        <span class="number">0.7778</span>     <span class="number">0.2334</span>   <span class="number">3.332</span>   <span class="number">0.0126</span> *</div><div class="line">---</div><div class="line">Signif. codes:  <span class="number">0</span> ‘***’ <span class="number">0.001</span> ‘**’ <span class="number">0.01</span> ‘*’ <span class="number">0.05</span> ‘.’ <span class="number">0.1</span> ‘ ’ <span class="number">1</span></div><div class="line"></div><div class="line">Residual standard error: <span class="number">1.19</span> on <span class="number">7</span> degrees of freedom</div><div class="line">Multiple R-squared:  <span class="number">0.6133</span>,	Adjusted R-squared:  <span class="number">0.558</span> </div><div class="line"><span class="literal">F</span>-statistic:  <span class="number">11.1</span> on <span class="number">1</span> and <span class="number">7</span> DF,  p-value: <span class="number">0.01256</span></div></pre></td></tr></table></figure>
<p>回归曲线如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/dJc87Gk5I2.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h3 id="多元线性回归-1">多元线性回归</h3>
<p>绘制多元线性回归的散点图，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">plot(mouse.data)</div></pre></td></tr></table></figure>
<p>图片如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/BfdIBAdAkc.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>在绘制多元线性回归的图形时，不用指定x轴与y轴，R会把所有的变量进行排列组合，绘制出一多个图形，现在解释一下这个图形；</p>
<p>第一：size与weight，x轴是weight，y轴是size</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/2Kedkad23K.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>第二，看下面的图形，x轴是size，y轴是weigth：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/Fh0l691dH1.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>上述的这两个图形是非常相似的，只是它们的坐标轴颠倒了一下：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/7hig584A28.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>第三，size与tail，这两个变量位于整张图形的对角上，它们的图形也非常相似，也是xy轴颠倒了一下：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/9FlEik9ffK.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>同样类似的还有weight和tail变量：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/mJFjmaj8c4.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>从图形上我们可以看出来，weight和tail与size相关，如下所示： <img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/E8cCI7HLJI.png?imageslim" alt="mark"></p>
<p>weigth和tail也有一定的相关关系，这表明，这两个变量也能够为我们提供一些类似的信息，但我们的模型有可能不太需要这些信息：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/cdifciDf6f.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时，我们使用<code>lm()</code>函数进行多元线性回归分析，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">multiple.regression &lt;- lm(size ~weight + tail, data=mouse.data)</div></pre></td></tr></table></figure>
<p>在R中，我们指定各种变量的位置的依据如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/FHIcEjgh3j.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>默认情况下，y轴截矩和两个斜率如下所示： <img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/9FHEmm6f9E.png?imageslim" alt="mark"></p>
<p>查看一下多元线性回归的结果，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">&gt; summary(multiple.regression)</div><div class="line"></div><div class="line">Call:</div><div class="line">lm(formula = size ~ weight + tail, data = mouse.data)</div><div class="line"></div><div class="line">Residuals:</div><div class="line">     Min       1Q   Median       3Q      Max </div><div class="line">-<span class="number">0.99928</span> -<span class="number">0.38648</span> -<span class="number">0.06967</span>  <span class="number">0.34454</span>  <span class="number">1.07932</span> </div><div class="line"></div><div class="line">Coefficients:</div><div class="line">            Estimate Std. Error t value Pr(&gt;|t|)  </div><div class="line">(Intercept)   <span class="number">0.7070</span>     <span class="number">0.6510</span>   <span class="number">1.086</span>   <span class="number">0.3192</span>  </div><div class="line">weight       -<span class="number">0.3293</span>     <span class="number">0.3933</span>  -<span class="number">0.837</span>   <span class="number">0.4345</span>  </div><div class="line">tail          <span class="number">1.6470</span>     <span class="number">0.5363</span>   <span class="number">3.071</span>   <span class="number">0.0219</span> *</div><div class="line">---</div><div class="line">Signif. codes:  <span class="number">0</span> ‘***’ <span class="number">0.001</span> ‘**’ <span class="number">0.01</span> ‘*’ <span class="number">0.05</span> ‘.’ <span class="number">0.1</span> ‘ ’ <span class="number">1</span></div><div class="line"></div><div class="line">Residual standard error: <span class="number">0.8017</span> on <span class="number">6</span> degrees of freedom</div><div class="line">Multiple R-squared:  <span class="number">0.8496</span>,	Adjusted R-squared:  <span class="number">0.7995</span> </div><div class="line"><span class="literal">F</span>-statistic: <span class="number">16.95</span> on <span class="number">2</span> and <span class="number">6</span> DF,  p-value: <span class="number">0.003399</span></div></pre></td></tr></table></figure>
<p>上述结果与简单线性回归类似，我们看一下最后一部分：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Multiple R-squared:  <span class="number">0.8496</span>,	Adjusted R-squared:  <span class="number">0.7995</span> </div><div class="line"><span class="literal">F</span>-statistic: <span class="number">16.95</span> on <span class="number">2</span> and <span class="number">6</span> DF,  p-value: <span class="number">0.003399</span></div></pre></td></tr></table></figure>
<p><span class="math inline">\({R}^2\)</span>的值为0.8496，调整后的值为0.7995，F值为16.95，p值为0.003399，这个拟合效果是非常好的。</p>
<p>我们再看一下各个自变量的系数，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">Coefficients:</div><div class="line">            Estimate Std. Error t value Pr(&gt;|t|)  </div><div class="line">(Intercept)   <span class="number">0.7070</span>     <span class="number">0.6510</span>   <span class="number">1.086</span>   <span class="number">0.3192</span>  </div><div class="line">weight       -<span class="number">0.3293</span>     <span class="number">0.3933</span>  -<span class="number">0.837</span>   <span class="number">0.4345</span>  </div><div class="line">tail          <span class="number">1.6470</span>     <span class="number">0.5363</span>   <span class="number">3.071</span>   <span class="number">0.0219</span> *</div><div class="line">---</div><div class="line">Signif. codes:  <span class="number">0</span> ‘***’ <span class="number">0.001</span> ‘**’ <span class="number">0.01</span> ‘*’ <span class="number">0.05</span> ‘.’ <span class="number">0.1</span> ‘ ’ <span class="number">1</span></div></pre></td></tr></table></figure>
<p>我们看一下weight这个自变量的系数，并将它与简单线性回归中的weight进行对比，也就是如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/G441KBEfgh.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>在多元线性回归中，weight的系数为-0.3293，Pr(&gt;|t|)为0.4345；而在简单线性回归中，weight的系数为0.7778，Pr(&gt;|t|)为0.0126。</p>
<p>这就说明，与只使用tail这一个变量来预测小鼠的大小相比，我们使用weight和tail这两个变量并不是非常显著。</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/0E7H27II1H.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>我们再看一下tail这个变量，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/HmH4Emm2ik.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>tail这个变量的p值为0.0219。这就说明，我们使用weight和tail这两个变量比只使用weight这个变量来预测小鼠的大小（size），有显著的区别。</p>
<p>结论就是，我们使用weight和tail这两个变量来预测小鼠的size是比较好的：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/giJHm4FdIE.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>但是，如果我们精力与时间有限，那么我们可以中使用小鼠的tail来预测其size，不用考虑weight变量：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/keaaAHdDJH.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h2 id="t检验与anova">t检验与ANOVA</h2>
<h3 id="t检验与一般线性模型">t检验与一般线性模型</h3>
<blockquote>
<p>统计学初学者通常会首选接触到t检验、方差分析、线性回归等方法，不少人的感觉就是，t检验用于两组均值比较，方差分析用于多组均值比较，而线性回归则用于自变量对因变量的影响分析。看起来似乎没有什么关系，但它们却统一在一个模型下，这就是一般线性模型（General Linear Model）。一般线性模型并不是一个具体的模型，而是多种方法的统称，像t检验、方差分析、线性回归等都从属于一般线性模型的范畴。</p>
<p>——《白话统计》（冯国双.P22.2018）</p>
</blockquote>
<h3 id="回顾线性回归">回顾线性回归</h3>
<p>线性回归就是对两个变量采用最小二乘法，求出其线性回归方程，从而使用一个变量预测另外一个变量，在前面的案例中，我们就是检测了小鼠的体重和小鼠的大小，从而求出线性回归方向，从线性回归方程中，我们知道这两个特点：</p>
<ol style="list-style-type: decimal">
<li>小鼠的体重对于小鼠的大小预测的效果怎么样（这个要看<span class="math inline">\({R}^2\)</span>，这个值越大，表示预测效果越好）；</li>
<li>我们得到的这个线性回归方程是否有统计学意义（这个要看p值，p值小于某个阈值（通常是0.05）就表示有意义）。</li>
</ol>
<p>如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/6LJ3DcI98e.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h3 id="将线性回归方程应用于t检验">将线性回归方程应用于t检验</h3>
<p>此时，我们研究一下能否将线性回归方程的思想应用到t检验上（其实是能的），看下面的案例，在这个案例中，我们有一个对照组，有一个突变组，研究了它们某个基因的表达情况，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/GLHFlbGmB8.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>t检验的目标就在于比较两且数据的均值，并观察它们是否有统计学上的差异，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/LkFi3KB9hm.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>如果有一个相同的方法可以计算线性回归和t检验的p值，那么我们就可以在更加复杂的情况下，使用这种方法：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/H9mhjL8aa2.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>下图分别是线性回归和t检验的散点图：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/CE4biCi4Lc.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时， 我们开始计算F值（由F值就能计算出p值）。</p>
<p>第一步：先忽略x轴坐标的意义，分别计算线性回归图形中所有点的均值和t检验中所有点的均值（即把control和mutant这两组数据混在一块，计算出一个均值），如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/EFJBJe6k85.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>第二步：计算残差平方和，即原始数据点的对应的y轴坐标减去均值，平方后的和，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/aIhi62cG56.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>这个计算过程比较简单。</p>
<p>第三步：找出拟合曲线，此时就需要x轴的坐标了：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/AmgbBhI0jb.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>其中线性回归这个图形的拟合曲线很好找，但是t检验这一组的拟合曲线不太好找，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/L0238fde2m.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时，我们先针对control组找到一个拟合曲线，其实就是它的均值所在位置： <img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/E9fhE2Ab0e.png?imageslim" alt="mark"></p>
<p>得到的曲线为y=2.2，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/9HHDLadaG4.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>对于mutant组同样如此，它的回归曲线方程为y=3.6，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/7A6bi7fhdK.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时，我们就得到了线性回归这一组数据的拟合曲线，以及t检验这一组中的两条回归曲线，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/G4mmJfAF8m.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时，我们将t检验这一组图形中的两条曲线合并为一个方程，接着计算F值：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/i132JLa3j5.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>虽然t检验组中的这两条曲线看起来比较诡异，但我们还是能接受的：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/FdAGjD352G.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>将这两条曲线的方程合并为一条，那么这个方程就如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/7JJk0k6c4E.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>其中，红色部分表示的是control组的均值，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/9lDAi1KAKj.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>绿色的3.6是mutant组的均值：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/miBhEGbIjg.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>残差为蓝色的部分，但这条曲线也是比较诡异的，我们计算control组时，它的mutant这组的系数为0，其实就相当于y=1 x 2.2 + residual了，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/d99gliBJFg.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>那么control组中的这几个点的计算过程如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/D7IfhDmI51.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>对于mutant这一组，当我们计算它时，它的control的系数为0，那么这个公式就变成了y = 1 x 3.6 + residual了，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/LGcFcCiLE8.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>计算mutant组的数据时，就是0乘以control，加上1乘以mutant，如下所示：<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/0IdHc78fi4.png?imageslim" alt="mark"></p>
<p>还有：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/kfmkb31k43.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>现在得到了所有的数据点：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/gcBdih5Eh7.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>现在我们把这个计算过程中的系数提取出来，看一下：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/h7cGiH85Fd.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>这个系数看起来给人的印象就是这样的：在分别计算两组的数据时，它们相应的系数（一个是2.2，一个是3.6）就是像是有一对开关在控制，在control组中，2.2的系数为1，3.6的系数为0，mutant正好相反。因此，提取它们，构成一个设计矩阵，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/dJeH3BbI60.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>这个矩阵我们称为设计矩阵（design matrix），它代表了原始的数据，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/8DEgLc391I.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>其中column1表示control组的开或关（on or off）：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/0k4Gl8FaC1.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>column2表示了mutant组的开或关：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/GgBlF7BcBI.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>在实际运用中，每个column都已经是默认存在了，那么这个公式就会写为如下形式：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/G27h5cfFgE.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时，我们就拟合了control和mutant数据，把它们放到了一个公式里（其实是一个矩阵），现在计算F值和p值了，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/acG6HaJAgI.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>第四步：计算SS(fit)，即实际值与拟合曲线差值的平方和：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/AEEGb7j53m.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>计算结果如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/F6kiEKi9EI.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>F值的计算结果如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/cFblAKkLKc.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>在左图的线性回归图形中，ｙ轴表示的是小鼠的平均大小，ｐ(mean)=1，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/fm1gedjIhD.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>在右图的t检验中，y轴表示的是平均基因的表达水平，p(mean)=1，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/LeLE5diefL.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>同理，线性回归中的p(fit)=2，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/kAf1jCG9IA.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>t检验中的p(fit)=2，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/jIiFcacC56.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>现在计算p值，先看一下过程，先计算一SS(mean)，然后计算SS(fit)，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/0b1CCAeKlA.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>t检验的p值和F值的计算至此结束，需要注意的是，我们在前面构建的矩阵并不是t检验的一个标准矩阵（这里先不管这个），接着看ANOVA。</p>
<h3 id="将线性回归方程应用于anova">将线性回归方程应用于ANOVA</h3>
<p>为了方便理解，我们可以将ANOVA看成升级版的t检验，t检验用于比较两组的数据，ANOVA用于比较多组之间的数据，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/lCal3jlKCF.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>第一步：计算SS(mean)：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/6bg4EJaKj6.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>第二步：计算SS(fit)：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/B440i3K50a.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>第三步：设计矩阵：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/hED17hKKfD.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>第四步：计算F值</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/BLIDaf0hB8.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h2 id="设计矩阵">设计矩阵</h2>
<h3 id="矩阵的查看">矩阵的查看</h3>
<p>在后文，一般线性模型（General Linear Models）都缩写为GLM。在前面的部分中，我们提到了，我们设计的那个矩阵并不是一个标准的矩阵（下图左图），右图才是一个标准的t检验矩阵，如下所示：<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/GdkGiH7FDm.png?imageslim" alt="mark"></p>
<p>这个标准的矩阵对应的这个方程有点不太一样，它的后面是<code>difference(mutant - control)</code>，我们看一下这个新的矩阵：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/A99eE8b5g9.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>在这个矩阵中，第1列所有的数据（control和mutant）都变成了（mean(control)），如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/iFLm6glAGH.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>不过，第2列中，只有mutant的数据变成了<code>difference(mutant - control)</code>，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/blBeig6hi9.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>例如，下图的数字<code>1</code>对应的数据点（我暂把它叫做A点，它是control组中的点），就是<code>mean(control)</code>的“开”，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/BcC9ghbC6C.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>同理，数字<code>0</code>表示A点对应的就是<code>difference(mutant - control)</code>的“关”，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/dCEGDaC0ka.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>这样我们就很好理解了，control组中的A这个点的对应的<code>mean(control)</code>这个系数为1，A点对应的<code>difference(mutant-control)</code>这个系数为0，加起来，就是A点的这个数字。同时，在mutant中的某个点（我把它称为B点，它位于mutant组），它对应的<code>mean(control)</code>这个系数为1（这个好理解，因为它后面还有mutant - control），对应的<code>difference(mutant-control)</code>这个系数也为1，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/Fe2b5elGfG.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>以下两个方程（设计矩阵和标准矩阵）的残差是相同的，它们也有相同的参数，因此<code>p(fit)</code>也是相同的：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/6IImg9jfb1.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>因此，它们的F值也是相同的：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/gJGLcBFiK1.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>现在我们面临一个疑问：即使这两个方程的结果都一样，为什么右边的这个方程更普遍？原作者认为这可能与回归有关：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180608/3KkADALmhB.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>我们先看一下这个设计矩阵是如何工作的，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/m2bj3Kea05.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>设计矩阵的第1列的这个系数是与<code>mean(control)</code>相乘的，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/4LiHhK1AeH.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>第2列的数字是与<code>difference(mutant - control)</code>相乘的，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/GimBajCIGC.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>将<code>mean(control)</code>乘以1，那就是它的原始数字，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/F8hei3EjjG.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>将<code>difference(mutant - control)</code>乘以0，就是没有，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/Em2Bd0Lil0.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>这个设计矩阵中的数字是1和1，因此它非常适合做t检验或ANOVA，因为这些数字可以代表不同的分类（其实我们也可以使用其它的数字）：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/aKgJ8bcHJ0.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>例如，下面是一个线性回归的设计矩阵，这个矩阵就与左边的这个线性回归方程是等价的：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/iklFeDjmga.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>在这个矩阵的第1列，都是数字1，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/ahl0AefBhi.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>第2列是这些点在对应的x轴上的坐标，如下所示： <img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/8jaKd3i191.png?imageslim" alt="mark"></p>
<p>我们现在看一下第1行，它对应的是第1个点，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/107I2ag8bE.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时用1乘以这个这个公式中的系数（<code>y-intercept</code>），这就表示，这个系数（<code>y-intercept</code>）处于打开（<code>on</code>）的状态，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/5FlGa5jE0H.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>再用第1行的第2个数字（也就是0.9）乘以斜率（slope），如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/4IIB2B5H6g.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>为了这让个过程更加具体，我们把这个方程中的矩阵和斜率用具体的数字替换一下，计算出拟合曲线上的真实数据，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/m6FLbjdIaH.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>拟合的曲线斜率非常小，它为0.01（注意：这条拟合曲线与前面我们做的简单线性回归的曲线不同，因为这里面的数据跟前面的貌似不是一批的），如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/9GFKJajlmF.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>它的斜率为0.8，与第1个数据点相乘，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/eb4GjH0hHG.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>经计算，得到0.73，它对应的是就是拟合曲线上的第一个点，就是绿叉的那个点，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/l741A6l9e0.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>现在我们看第2行，它对应的是第2个点，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/a27J2cbJde.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>现在我们计算拟合曲线上对应的第2个点，下图绿叉所在位置，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/b8KgjaK890.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>现在把这个矩阵中所有的点都在拟合曲线上计算出来，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/GIcJaBiKdL.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>一旦计算出这些拟合曲线上的点，那么我们就可以计算其残差，并计算p值，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/G48i1fk7jF.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>用这个案例就是为了说明，设计矩阵不一定只含有１和０，也可以含有一组其它的数字，将这数字投射到方程中，一次投射一行：<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/flJL6e12Ki.png?imageslim" alt="mark"></p>
<p>我们再看t检验的案例，t检验的这种案例更加常见，因此我们后文中的案例都按照这种格式进行，如下的所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/1EEBKlmiFk.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>现在我们知道了，我们可以把任何数字都放到一个设计矩阵里。</p>
<h3 id="第1个案例">第1个案例</h3>
<p>现在我们再看一些案例，这些案例混合了t检验与线性回归，下图是两种不同种类的小鼠的体重与大小，不同颜色用于区分不同种类的小鼠，如下所示：<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/cFlHI0CfaI.png?imageslim" alt="mark"></p>
<p>其中，红色是对照组小鼠，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/icFgLJhI0K.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>绿色的是突变组小鼠（mutant）如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/39l1h0g69c.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>从直观上我们就能够看出，突变组小鼠的比较大，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/G7Hl2c9C37.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>换句话说，突变组与对照组小鼠趋势是这个样子的：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/mm24JGJ4de.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>我们现在面临的问题就是：如何使用统计学的方法来判断这两组小鼠是否有统计学意义上的差别？</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/gbAKh7i2II.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>如果我们对整体小鼠（包括mutant和control）做一个回归，那么我们也无法找出这两组小鼠是否有差异，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/L2jJB4fCdC.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>如果我们忽略小鼠的体重与大小之间的关系，只对小鼠的大小做一个统计，我们就发现，小鼠的大小（size）并没有统计学意义上的差别，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/Eici3kF67B.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>由于小鼠的体重（weight）和大小（size）之间的这个关系与小鼠的类型有关，因此我们可以把这两种因素归到一种统计学方法中来，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/cc5HGChmha.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>换句话讲，我们并不直接比较小鼠的大小（这个比较是用t检验来进行的），而是用另外的一种方法来比较，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/9CHm1cABEj.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>这种方法就是，比较这两种小鼠的回归曲线，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/iICEdEgm3B.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>为了比较这两个曲线，我们需要一个含有对照组小鼠方程截矩的方程，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/aE8iab1fa7.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>这个方程还要含有突变组小鼠与对照组小鼠的差值，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/J0JgE0LCf9.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>这个方程还要含有斜率（在这个案例中，这两条曲线的斜率是相同的，但在实际运用中，可能不同），如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/KhHjbd2Bkm.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>这就意味着，我们需要一个设计矩阵，这个矩阵的第1列是数字1，它们是y轴上的某些点，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/GCEGaC7k95.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>设计矩阵的第2列是0和1，它们代表<code>mutant off</code>（也就是突变组与对照组的差值），如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/IKK1I4bBgd.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>其中0代表<code>off</code>，它代表control的off，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/DF0eeA2fD9.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>1代表mutant小鼠，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/a15BIFEF4G.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>第3列是小鼠的体重，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/1mL6ikcB2K.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>绿色的是突变组，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/JA1aBd1Ch2.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>现在看第1行，1，0，2.4对应的方程的数字如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/2Fb2Ekbech.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>它投射到拟合曲线上的点如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/8EHhm00Gl2.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>第2行的数字对应到方程上如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/KD9LEGdE66.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>第2个点投射到拟合曲线上就是这个样子：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/jh08kjcK1g.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>把所有的点投射到相应的曲线上，就如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/ada6b1mh2H.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>一旦我们确定了拟合曲线上的点的位置，就可以计算其残差，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/FkAB9F61hF.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h4 id="第1个simpler-model">第1个simpler model</h4>
<p>此时我们把这个复杂的模型（用fancy model表示）与简单的模型（simpler model）比较，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/JdAF8D7JHK.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时，把这个fancy model的残差平方和代入到下面的公式中，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/Bglelf67AF.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>其中fancy model有3个驎肆，也就是<code>p(fancy)</code>为3，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/Bi8acFcci5.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>把simple的SS代入到下面方程，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/l66KAlBDgd.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>simple方程中的参数只有1个，也就是说<code>p(simple)</code>为1，代入到下面的方程，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/7hhFgB4KbB.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>最终得到的F值为21.88，p值为0.003，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/G460mAGFeK.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>这里需要提一下的是，simpler model可以是任何的模型，下图中这个simpler model就是一个简单线性回归模型，如下所示：</p>
<h4 id="第2个simpler-model">第2个simpler model</h4>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/EIGKGmFfeC.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>我们用这个simple model来计算一下，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/b10Gi4bjBl.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>得到的结果为F值是32.6，p值为0.0023，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/Glf5IGallL.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>从上图的结果来看，使用小鼠的体重(weight)和种类(type)能够比只使用小鼠的体重(weigth)更好地预测小鼠的大小(size)。再看下面的一个simpler model，在这个模型中，我们忽略了小鼠的体重，如下所示：</p>
<h4 id="第3个simpler-model">第3个simpler model</h4>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/8jBk4g0DCJ.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>现在把这个simpler model的平方和加入到F值的公式中，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/HJgcLHAaJe.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>这次得到的F值与p值如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/aAg7hm0GFf.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>这个结果的p值与第一个simpler model（即考虑全部的小鼠平均值的那个模型）的p值相比，它更小，这就说明，使用小鼠的体重(weight)和类型(type)来预测小鼠的大小，比只使用类型(type)更好。</p>
<h3 id="第2个案例批次效应">第2个案例：批次效应</h3>
<p>现在A实验室（Lab A）做了一个实验，如下图左图所示，而B实验室（Lab B）实验重复了A实验室的实验。现在我们要综合这两次的实验结果，观察一下，mutant组与control相比，有没有差异，但是，这两次实验不是一次做的，因此存在批次效果（batch effect），我们现在要解决的问题是，如何消除这个批次效应，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/2jJjgdHf5b.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>首选，我们先计算一下Ａ实验的control组的均值，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/il242KgDjA.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>第二，我们计算一下B实验的control这个结果与A实验的control这个均值的差值，这用于研究批次效应，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/3a5dl05fL1.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>第三，我们再加入mutant和control数据的差值，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/LD2jhElBJf.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时，设计一个矩阵，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/dc4E06mKie.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>从本质上来讲， 我们想知道上述方程最后一项重要不重要。也就是说矩阵最后一项重要与否，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/FkcLaII31A.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>现在我们比较这个复杂方程（simple equation）与简单方程（simpler equation，简单方程忽略了control与mutant的分组）的区别，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/5kB9503KLg.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>如果得到一个很小的p值，那么这就告诉我们要研究control与mutant的差异，这就意味着我control和mutant之间存在着显著性差异。</p>
<h2 id="r语言与设计矩阵">R语言与设计矩阵</h2>
<h3 id="第1案例小鼠体重">第1案例：小鼠体重</h3>
<p>还看前文的案例，我们想知道mutant组的小鼠和control的小鼠在size上是否有统计学意义上的差别。我们分别做了这两种小鼠的回归曲线，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/diAKf67jEg.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时我们使用R语言来进行分析，输入以下代码：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">Type &lt;- factor(c(</div><div class="line">  rep(<span class="string">"Control"</span>, times=<span class="number">4</span>),</div><div class="line">  rep(<span class="string">"Mutant"</span>, times=<span class="number">4</span>)))</div><div class="line"></div><div class="line">Weight &lt;- c(<span class="number">2.4</span>, <span class="number">3.5</span>, <span class="number">4.4</span>, <span class="number">4.9</span>, <span class="number">1.7</span>, <span class="number">2.8</span>, <span class="number">3.2</span>, <span class="number">3.9</span>)</div><div class="line">Size &lt;- c(<span class="number">1.9</span>, <span class="number">3</span>, <span class="number">2.9</span>, <span class="number">3.7</span>, <span class="number">2.8</span>, <span class="number">3.3</span>, <span class="number">3.9</span>, <span class="number">4.8</span>)</div><div class="line">model.matrix(~Type+Weight)</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">&gt; Type &lt;- factor(c(</div><div class="line">+   rep(<span class="string">"Control"</span>, times=<span class="number">4</span>),</div><div class="line">+   rep(<span class="string">"Mutant"</span>, times=<span class="number">4</span>)))</div><div class="line">&gt; </div><div class="line">&gt; Weight &lt;- c(<span class="number">2.4</span>, <span class="number">3.5</span>, <span class="number">4.4</span>, <span class="number">4.9</span>, <span class="number">1.7</span>, <span class="number">2.8</span>, <span class="number">3.2</span>, <span class="number">3.9</span>)</div><div class="line">&gt; Size &lt;- c(<span class="number">1.9</span>, <span class="number">3</span>, <span class="number">2.9</span>, <span class="number">3.7</span>, <span class="number">2.8</span>, <span class="number">3.3</span>, <span class="number">3.9</span>, <span class="number">4.8</span>)</div><div class="line">&gt; model.matrix(~Type+Weight)</div><div class="line">  (Intercept) TypeMutant Weight</div><div class="line"><span class="number">1</span>           <span class="number">1</span>          <span class="number">0</span>    <span class="number">2.4</span></div><div class="line"><span class="number">2</span>           <span class="number">1</span>          <span class="number">0</span>    <span class="number">3.5</span></div><div class="line"><span class="number">3</span>           <span class="number">1</span>          <span class="number">0</span>    <span class="number">4.4</span></div><div class="line"><span class="number">4</span>           <span class="number">1</span>          <span class="number">0</span>    <span class="number">4.9</span></div><div class="line"><span class="number">5</span>           <span class="number">1</span>          <span class="number">1</span>    <span class="number">1.7</span></div><div class="line"><span class="number">6</span>           <span class="number">1</span>          <span class="number">1</span>    <span class="number">2.8</span></div><div class="line"><span class="number">7</span>           <span class="number">1</span>          <span class="number">1</span>    <span class="number">3.2</span></div><div class="line"><span class="number">8</span>           <span class="number">1</span>          <span class="number">1</span>    <span class="number">3.9</span></div><div class="line">attr(,<span class="string">"assign"</span>)</div><div class="line">[<span class="number">1</span>] <span class="number">0</span> <span class="number">1</span> <span class="number">2</span></div><div class="line">attr(,<span class="string">"contrasts"</span>)</div><div class="line">attr(,<span class="string">"contrasts"</span>)$Type</div><div class="line">[<span class="number">1</span>] <span class="string">"contr.treatment"</span></div></pre></td></tr></table></figure>
<p>其中<code>model.matrix()</code>这个函数是用于构建设计矩阵的，它能自动将因子型数据转换为哑变量（dumpy variables）。构建好的矩阵的所代表的第1列是对照组的截矩，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/l243efGHmd.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>第2列代表的数据是mutant与control的差值，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/643akHHHG6.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>最后1列是如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/aGID394LIg.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>现在构建线性回归模型，结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">&gt; model &lt;- lm(Size~Type + Weight)</div><div class="line">&gt; summary(model)</div><div class="line"></div><div class="line">Call:</div><div class="line">lm(formula = Size ~ Type + Weight)</div><div class="line"></div><div class="line">Residuals:</div><div class="line">       <span class="number">1</span>        <span class="number">2</span>        <span class="number">3</span>        <span class="number">4</span>        <span class="number">5</span>        <span class="number">6</span>        <span class="number">7</span>        <span class="number">8</span> </div><div class="line"> <span class="number">0.05455</span>  <span class="number">0.34562</span> -<span class="number">0.41623</span>  <span class="number">0.01607</span> -<span class="number">0.01753</span> -<span class="number">0.32646</span> -<span class="number">0.02062</span>  <span class="number">0.36461</span> </div><div class="line"></div><div class="line">Coefficients:</div><div class="line">            Estimate Std. Error t value Pr(&gt;|t|)   </div><div class="line">(Intercept)  <span class="number">0.08052</span>    <span class="number">0.52744</span>   <span class="number">0.153</span>  <span class="number">0.88463</span>   </div><div class="line">TypeMutant   <span class="number">1.48685</span>    <span class="number">0.26023</span>   <span class="number">5.714</span>  <span class="number">0.00230</span> **</div><div class="line">Weight       <span class="number">0.73539</span>    <span class="number">0.13194</span>   <span class="number">5.574</span>  <span class="number">0.00256</span> **</div><div class="line">---</div><div class="line">Signif. codes:  <span class="number">0</span> ‘***’ <span class="number">0.001</span> ‘**’ <span class="number">0.01</span> ‘*’ <span class="number">0.05</span> ‘.’ <span class="number">0.1</span> ‘ ’ <span class="number">1</span></div><div class="line"></div><div class="line">Residual standard error: <span class="number">0.3275</span> on <span class="number">5</span> degrees of freedom</div><div class="line">Multiple R-squared:  <span class="number">0.8975</span>,	Adjusted R-squared:  <span class="number">0.8564</span> </div><div class="line"><span class="literal">F</span>-statistic: <span class="number">21.88</span> on <span class="number">2</span> and <span class="number">5</span> DF,  p-value: <span class="number">0.003367</span></div></pre></td></tr></table></figure>
<p>现在看这个结果，第1部分如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">Call:</div><div class="line">lm(formula = Size ~ Type + Weight)</div><div class="line"></div><div class="line">Residuals:</div><div class="line">       <span class="number">1</span>        <span class="number">2</span>        <span class="number">3</span>        <span class="number">4</span>        <span class="number">5</span>        <span class="number">6</span>        <span class="number">7</span>        <span class="number">8</span> </div><div class="line"> <span class="number">0.05455</span>  <span class="number">0.34562</span> -<span class="number">0.41623</span>  <span class="number">0.01607</span> -<span class="number">0.01753</span> -<span class="number">0.32646</span> -<span class="number">0.02062</span>  <span class="number">0.36461</span></div></pre></td></tr></table></figure>
<p>这是每个数据与拟合曲线的残差。</p>
<p>第2部分，我们看最后的信息：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Multiple R-squared:  <span class="number">0.8975</span>,	Adjusted R-squared:  <span class="number">0.8564</span></div></pre></td></tr></table></figure>
<p>这些是多重<span class="math inline">\({R}^2\)</span>，因为我们的拟合曲线是一个比复杂的方程（它有2个参数），后面的是根据参数的数量调整后的<span class="math inline">\({R}^2\)</span>。最后就是F值与p值了，p值为0.003367，这个p值是线性回归的p值整体数据（其实就是simpler model）对比后的p值，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/795FC9glmE.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>接着看各项的系数，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">Coefficients:</div><div class="line">            Estimate Std. Error t value Pr(&gt;|t|)   </div><div class="line">(Intercept)  <span class="number">0.08052</span>    <span class="number">0.52744</span>   <span class="number">0.153</span>  <span class="number">0.88463</span>   </div><div class="line">TypeMutant   <span class="number">1.48685</span>    <span class="number">0.26023</span>   <span class="number">5.714</span>  <span class="number">0.00230</span> **</div><div class="line">Weight       <span class="number">0.73539</span>    <span class="number">0.13194</span>   <span class="number">5.574</span>  <span class="number">0.00256</span> **</div><div class="line">---</div><div class="line">Signif. codes:  <span class="number">0</span> ‘***’ <span class="number">0.001</span> ‘**’ <span class="number">0.01</span> ‘*’ <span class="number">0.05</span> ‘.’ <span class="number">0.1</span> ‘ ’ <span class="number">1</span></div></pre></td></tr></table></figure>
<p>结果中<code>Weight</code>这个变量的p值为0.00256，它表示的是，如果在这个复杂模型（fancy model）中剔除<code>Weight</code>这个变量，构建成的简单模型（simpler model）与原始数据的拟合效果。它反映的是一个复杂模型的统计效果和只用常规t检验的统计效果的比较（p值小于0.05，说明前者的统计效果更好）。换句话讲，它反映了复杂模型中剔除了<code>Weight</code>这个变量后，使用最小二乘法进行的检验与原复杂模型检验的比较，由于p值很小，这就说明了<code>Weight</code>这个变量的重要性，如下所示：</p>
<div class="figure">
<img src="C:\Users\20161111\AppData\Local\Temp\1528527862818.png" alt="1528527862818">
<p class="caption">1528527862818</p>
</div>
<p>同理，<code>TypeMutant</code>这个变量对应的p值为0.00230，它反映的是原复杂方程（fancy model）与该方程剔除小鼠类型这个变量后的比较（剔除了小鼠类型的这个变量，就变成了普通线性回归方程），如下所示：</p>
<div class="figure">
<img src="C:\Users\20161111\AppData\Local\Temp\1528528001774.png" alt="1528528001774">
<p class="caption">1528528001774</p>
</div>
<p>在图形上反映的效果就是如下所示：</p>
<div class="figure">
<img src="C:\Users\20161111\AppData\Local\Temp\1528528032377.png" alt="1528528032377">
<p class="caption">1528528032377</p>
</div>
<h3 id="第2案例批次效果">第2案例：批次效果</h3>
<p>这个案例还是前面的那个案例，在这个案例中，我们会看到两个实验室做的同一个实验，它们存在着批次效应，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/3a8ffJEfj0.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>现在使用R语言进行分析，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">Lab &lt;- factor(c(rep(<span class="string">"A"</span>,times=<span class="number">6</span>),rep(<span class="string">"B"</span>,times=<span class="number">6</span>)))</div><div class="line">Type &lt;- factor(c(rep(<span class="string">"Control"</span>, times = <span class="number">3</span>),rep(<span class="string">"Mutant"</span>, times = <span class="number">3</span>),rep(<span class="string">"Control"</span>, times = <span class="number">3</span>),rep(<span class="string">"Mutant"</span>, times = <span class="number">3</span>)))</div><div class="line">Expression &lt;- c(<span class="number">1.7</span>, <span class="number">2</span>, <span class="number">2.2</span>,<span class="number">3.1</span>, <span class="number">3.6</span>, <span class="number">3.9</span>, <span class="number">0.9</span>, <span class="number">1.2</span>, <span class="number">1.9</span>, <span class="number">1.8</span>, <span class="number">2.2</span>, <span class="number">2.9</span>)</div><div class="line">model.matrix(~Lab+Type)</div></pre></td></tr></table></figure>
<p>构建好的设计矩阵如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">&gt; model.matrix(~Lab+Type)</div><div class="line">   (Intercept) LabB TypeMutant</div><div class="line"><span class="number">1</span>            <span class="number">1</span>    <span class="number">0</span>          <span class="number">0</span></div><div class="line"><span class="number">2</span>            <span class="number">1</span>    <span class="number">0</span>          <span class="number">0</span></div><div class="line"><span class="number">3</span>            <span class="number">1</span>    <span class="number">0</span>          <span class="number">0</span></div><div class="line"><span class="number">4</span>            <span class="number">1</span>    <span class="number">0</span>          <span class="number">1</span></div><div class="line"><span class="number">5</span>            <span class="number">1</span>    <span class="number">0</span>          <span class="number">1</span></div><div class="line"><span class="number">6</span>            <span class="number">1</span>    <span class="number">0</span>          <span class="number">1</span></div><div class="line"><span class="number">7</span>            <span class="number">1</span>    <span class="number">1</span>          <span class="number">0</span></div><div class="line"><span class="number">8</span>            <span class="number">1</span>    <span class="number">1</span>          <span class="number">0</span></div><div class="line"><span class="number">9</span>            <span class="number">1</span>    <span class="number">1</span>          <span class="number">0</span></div><div class="line"><span class="number">10</span>           <span class="number">1</span>    <span class="number">1</span>          <span class="number">1</span></div><div class="line"><span class="number">11</span>           <span class="number">1</span>    <span class="number">1</span>          <span class="number">1</span></div><div class="line"><span class="number">12</span>           <span class="number">1</span>    <span class="number">1</span>          <span class="number">1</span></div><div class="line">attr(,<span class="string">"assign"</span>)</div><div class="line">[<span class="number">1</span>] <span class="number">0</span> <span class="number">1</span> <span class="number">2</span></div><div class="line">attr(,<span class="string">"contrasts"</span>)</div><div class="line">attr(,<span class="string">"contrasts"</span>)$Lab</div><div class="line">[<span class="number">1</span>] <span class="string">"contr.treatment"</span></div><div class="line"></div><div class="line">attr(,<span class="string">"contrasts"</span>)$Type</div><div class="line">[<span class="number">1</span>] <span class="string">"contr.treatment"</span></div></pre></td></tr></table></figure>
<p>第1列代表的是<code>Lab A control mean</code>，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/0a92eJifbD.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>第2列是<code>lab B offset</code>，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/4A1H3CLAiF.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>第3列是<code>difference(mutant - control)</code>，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/K99lj4kiFe.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>现在计算一下批次效应，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">batch.lm &lt;- lm(Expression ~ Lab + Type)</div><div class="line">summary(batch.lm)</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">&gt; summary(batch.lm)</div><div class="line"></div><div class="line">Call:</div><div class="line">lm(formula = Expression ~ Lab + Type)</div><div class="line"></div><div class="line">Residuals:</div><div class="line">    Min      1Q  Median      3Q     Max </div><div class="line">-<span class="number">0.6500</span> -<span class="number">0.2833</span> -<span class="number">0.0500</span>  <span class="number">0.2750</span>  <span class="number">0.7167</span> </div><div class="line"></div><div class="line">Coefficients:</div><div class="line">            Estimate Std. Error t value Pr(&gt;|t|)    </div><div class="line">(Intercept)   <span class="number">2.1167</span>     <span class="number">0.2279</span>   <span class="number">9.287</span>  <span class="number">6.6e-06</span> ***</div><div class="line">LabB         -<span class="number">0.9333</span>     <span class="number">0.2632</span>  -<span class="number">3.546</span> <span class="number">0.006250</span> ** </div><div class="line">TypeMutant    <span class="number">1.2667</span>     <span class="number">0.2632</span>   <span class="number">4.813</span> <span class="number">0.000956</span> ***</div><div class="line">---</div><div class="line">Signif. codes:  <span class="number">0</span> ‘***’ <span class="number">0.001</span> ‘**’ <span class="number">0.01</span> ‘*’ <span class="number">0.05</span> ‘.’ <span class="number">0.1</span> ‘ ’ <span class="number">1</span></div><div class="line"></div><div class="line">Residual standard error: <span class="number">0.4558</span> on <span class="number">9</span> degrees of freedom</div><div class="line">Multiple R-squared:  <span class="number">0.7989</span>,	Adjusted R-squared:  <span class="number">0.7542</span> </div><div class="line"><span class="literal">F</span>-statistic: <span class="number">17.87</span> on <span class="number">2</span> and <span class="number">9</span> DF,  p-value: <span class="number">0.0007342</span></div></pre></td></tr></table></figure>
<p>这个结果跟先前多元回归的结果类似，最后一部分就是<span class="math inline">\({R}^2\)</span>以及调整后的<span class="math inline">\({R}^2\)</span>，它的p值为0.0007342，但是这个p值不是我们所需要的，这个p值代表的是复杂方程与一个简单方程（也就是下图中<code>y = overall mean</code>）的统计学差异，这个p值是不能用于判断mutant和control差异的，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/0igg1hhhD4.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>我们再看一下<code>TypeMutant</code>这个变量对应的p值，这个p值是0.000956，这个才是我们所需要的p值，它表示的是，我们去掉<code>difference(mutant - control)</code>这个变量后，我们是否还能拟合出一条好的曲线（我个人理解就是：原假设就是去掉`TypeMutant后，剩下的数据能够拟合出一条好的曲线方程，但是结果却是p值小于0.05，是一个非常小的值，因此原假设不成立，也就是说这个变量不能去掉），如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/BgK78jg4jJ.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>总之，这个变量（<code>TypeMutant</code>）是我们所需要的，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/3fH8h8jFf7.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>这个案例说明的是，我们在做线性回归时，不一定总要看最终的p值（也就是统计结果右下角的p值），而是针对自己具体的容易来查找相应的p值。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2018/06/06/BioStatistics/生物统计-StatQuest学习笔记06-分位数及其应用/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/06/06/BioStatistics/生物统计-StatQuest学习笔记06-分位数及其应用/" itemprop="url">StatQuest学习笔记06——分位数及其应用</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-06-06T12:10:54+08:00">
                2018-06-06
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/生物统计/" itemprop="url" rel="index">
                    <span itemprop="name">生物统计</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  2,751
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  10
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="前言主要内容">前言——主要内容</h2>
<p>这篇笔记的内容是StatQuest视频文件的第23，24，25。文件第23讲的是分位数(quantiles)与百分位数(percentiles)；文件24讲的是QQ图；文件25讲的是分位数的均一化。</p>
<h2 id="分位数">分位数</h2>
<p>先看一个案例，我们检测了一些基因的表达情况，下图是第1个基因的表达数据：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/C5efDi5GHF.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>最终，我们检测了15个基因的表达情况，它们的数据如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/FbebD6AEk7.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>从图上我们可以看出，坐标中一共有15个点，如果我们从下向上数，数到第8个点时，划一条线，这个条的上方有50%的点，即7个点，下方也有50%的点，即7个点，这个点就叫做中位数（median），如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/mk1IHI58ei.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>从技术角度来讲，中位数就是一个百分比数（quantile），因为它把这一组数据划分成了2个部分，每部分所占的点数占总数目都是相同的，有时候，这个点也被标为0.5，也时候也被标为50%。</p>
<blockquote>
<p>中位数(median)是将n个变量值从小到大排列，位置居于中间的那个数。当n为奇数时取位次居中的变量值，当n为偶数时，取位次居中的两个变量值的均值。</p>
<p>百分位数(percentile)是一种位置指标，用Px来表示，读作第X百分位数。一个百分位数Px将全部产变量值分为两部分，在Px处若无相同变量值，则在不包含Px的全部变量值中有X%的变量值小于它，有(100-X)%变量值大于它。故百分位数是一个界值，其重要用途是确定医学参考值范围（reference range）。中位数实际上是第50百分位数。</p>
<p>——《医学统计学》（第四版）.孙振球.2014</p>
</blockquote>
<p>从下图中我们可以看到，这个中位数的值为4.5，也就是说第50分位数的值为4.5，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/Fgmb94Al6i.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>现在我们再添加两条线，再加上前面的50%分位数的线，这三条线就把整个数据分成了4部分，其中最下面的那条线叫0.25或25%百分位数，因为大概为25%的点低于它，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/CjCaci7h1b.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>最上面的线叫75%百分位数，因为约有75%的点低于它，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/hK1Jm20lJ2.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>通常来说，分位数就是那些能够把数据集分为相同区间组的线，这是技术上的定义。而百分位数（percentiles）则是指那些能够把数据集分为100份相同区间的分位数（quantiles），不过在实际运用中，这个术语非常灵活。例如我们把50%百分位数称为中位数，把75%百分位数称为第75百分位数（这就与我们引用教材中的命名相同了），如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/Lcb75988CI.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>最低下的数字，也就是最小的数字，称为0%百分位数，也叫第0百分位数，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/892elmg3fJ.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>倒数第2个数字则是第7百分位数，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/b4D04fdG2d.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>在R语言中，有专门计算分位数的函数，就是<code>quantile()</code>，它提供了9种不同的方法来计算分位数，其结果可能略微有所不同。这就说明，如果你的数据集很小，那么这个函数按照不同方法计算出来的分位数就有很大的同，如果数据集很大，那么计算结果就大体相同。</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/adcHLIcEI0.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h2 id="qq图">QQ图</h2>
<p>QQ图的全称为Quantile-Quantile图，也就是分位数的图，它研究的是数据是否符合正态分布。还以前面的基因表达为例来说明一下，我们检测了15个基因表达值，这些数据服是否服从正态分布？这就需要QQ图来回答，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/KDfCIcbih3.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>第一步：计算出每个点的百分位数，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/Bh6HHGa9Gm.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>第二步：绘制出正态分布曲线，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/8lBcEgEKg8.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>第三步：将同样的分位数映射到这个正态分布曲线上（我的理解就是某个数字，例如0.6，它的分位数是0.07的话，那么就在正态分布曲线上找到相应的一条直线x，这条直线与正态分布曲线构成的左边面积为0.07，其余的数字都这么做），如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/La9igA8E9B.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>数据集中有15个点，它们把这批数据分成了相同区间的组（equal sized group）（注：我的理解就是，这个相同区间指的是分位数的比，而不是实际值，例如我有100个点，这个点从小到大排列，每个点都会有自己相应的分位数，如果把按它们各自的分位数进行划分，那么可以把100%划分为100份1%），那么这些数据对应的分位数都投射到正态分布区间上，就是下面的这个图，从图上可以知道，中间部分的直线间隔小，两边的直线间隔长，这个很好理解，因为划分是按面积进行划分的，面积代表了概率，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/aIeF92g7bE.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>对于正态分布曲线来说，“相同区间的组”（equal sized groups）意味着一个数据在每组中的概率是相同的（一组就是由x轴，正态分布曲线，两侧的红线构成的狭长区域）：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/i162da0eBi.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>现在就可以绘制QQ图了，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/lclf3IBclk.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>QQ图含有2个坐标，横坐标是正态分布的x轴，纵坐标是原始数据的分位数，现在我们绘制原始数据中最小的那个点，它的数值是0.6，这个数值对应的就是纵坐标，它的这个值所对应的分位数在正态分布曲线上的点是x轴上-1.5的点，此时将它们绘制到QQ图上，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/h854FF2J76.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>接着，把所有的点都绘制到QQ图上，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/40l6692Jde.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时，我们看一下这些点是否与下面红色的直线重合（这个红色的直线其实就是y=x，如果数据符合正态分布，那么它就重合），如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/0edaBDCFeF.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>这些点貌似与红色的线重合得并不多，我们再看一下这些数据与另外的一种分布（这种分布就是均匀分布，即uniform distribution）的比较，第1步，求出各个数据点对应的分位数，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/36ifhJ2mdG.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>第二步：绘制出相应均值分布的曲线，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/L7KL1eDiCH.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>第三步：将原始数据对应的分位数投射到这个曲线上：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/e4kBaCJc5d.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>第四步：绘制QQ图，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/KL4EBdmHfD.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>我们此时发现，这组数据与均值分布对应的红色直线比较匹配，它就更加杂得均值分布，下图是数据与正态分布的QQ图的比较：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/HA0Ekm3KaI.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h2 id="比较两组数据">比较两组数据</h2>
<p>现在我们再来看一个案例，在这个案例中，我们比较这两组数据，其中第二组数据比较少，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/hjf32C9ebj.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>第二组数据只有4个数字，其实就是4个四分位数（我觉得视频中有问题，四分位数分别为25%，50%，75%的百分位数，只有3个，视频中却说有4个），因此我们也可以找出第一组数据中相应的四分位数，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/0FJLIDeffb.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>在第一组中，与第二组第一个数字（也就是3.8）百分位数相同的是2.5，那么就在QQ图 纵坐标的位置画一条直线（这个直线是y=2.5，即下图的黑色虚线），此时在横坐标上画出x=3.8的直线（下图红色虚线，代表第二组中的3.8），两个直线交叉就是第1个点在QQ图上的位置，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/5374e6mI0D.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>然后依次画出第二组中4个点与第一组中相应点构成的点，连成直线，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/Bgc7L3E9La.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>由于上图中QQ图的点很少，很难判断这两组数据是否是相同的分布，因此为了判断两组数据是否服从同样的分布，需要收集更多的点。</p>
<h2 id="分位数的标准化">分位数的标准化</h2>
<p>先看一个案例，例如我们手中有一批芯片（基因表达芯片，非集成电路）的数据，芯片有以下这些特点：</p>
<ol style="list-style-type: decimal">
<li>检测样本中基因活跃的程度（其实就是基因表达量的高低）；</li>
<li>芯片检测基因的活跃程度是通过不同颜色的光来达到的；</li>
<li>如果你检测芯片的仪器的光源更亮，那么这批数据就比其他的仪器检测到的信号更强。</li>
</ol>
<p>由于芯片的这些特点，我们就需要对芯片的数据进行标准化，从而研究不同样本之间的差异是由技术重复引起的，还是实验因素引起的，芯片数据标准化的过程跟生物的关系不大，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/ig2DDi48gg.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>我们来看一下原始数据，下图中的不同颜色表示不同的基因，这个数据中的每个点已经转换为了光强的密度值（intensity values），如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/C5hblj7KLD.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>下面是每个样本的均值，</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/kiDAIi8IaK.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>每个样本的均值都不同，这表明，我们需要校正所有光的强度，分位数标准化（quantile normalization）就是为了解决这个问题的，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/iemjHHEG75.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>第一步，我们先看每个样本中亮度最强的那个点，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/1ejfmmD3JC.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>第二步：计算这3个点的均值，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/I2FGcHcHJL.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>第三步：把这些均值投射到一个新的坐标轴上，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/2FhGmiCGbh.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>那么，样本1中强度最大的那个点（就是蓝色的点）的分位数标准化的值的就是上面我们计算出来的均值，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/B3LL2KLKhL.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>样本2和样本3中那两个点也是如此，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/9md269cb34.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>第四步：现在把亮度强度次亮的点再投射到这个新的坐标轴上，方法与前面的一样，也是先救出均值，然后再投射，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/Figi3gkK7c.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>所有的点都按照这样处理，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/KBddbLEaG4.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>经过这样的分位数标准化后，每个样本的数据基本上都一样了，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/l1lH0kG0ja.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>并且，每个样本中不同基因的原始次序也得到了保留，sample 1中的红色基因原来是最后一个，经处理后中，还是最后一个，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/EeEf0Lhib2.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>以上的整个过程就是分位数标准化的整个过程，因为标准化后的数据与原始数据都有相同的分位数。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2018/06/04/BioStatistics/生物统计-StatQuest学习笔记04-拟合/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/06/04/BioStatistics/生物统计-StatQuest学习笔记04-拟合/" itemprop="url">StatQuest学习笔记04——拟合</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-06-04T12:10:54+08:00">
                2018-06-04
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/生物统计/" itemprop="url" rel="index">
                    <span itemprop="name">生物统计</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  4,973
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  17
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="前言主要内容">前言——主要内容</h2>
<p>这篇笔记是StatQuest视频的第13到第15，文件13内容是拟合度；文件14是内容是线性回归；文件15是局部加权最小二乘法。</p>
<p>在这篇笔记中，我们需要弄清楚几个问题：</p>
<ol style="list-style-type: decimal">
<li>什么是相关系数（correlation，简称为R），相关系数的值有什么意义？</li>
<li>我们为什么关注R的平方？</li>
<li>最小二乘法的原理。</li>
</ol>
<h2 id="第1个案例r的平方">第1个案例：R的平方</h2>
<p>先看一个案例，下图是小鼠的体重与小鼠编号的散点图，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180606/I88BACB2C7.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>红色的是点是小鼠的体重，黑色的横线是平均值。x轴上是小鼠的编号，如果我们要查看这组数据的变异（variation），我们就把每只小鼠的体重送去平均值，然后再平方，再加起来（这个在统计学上叫离均差平方和，英文是sum of squares of deviations from mean），用数学公式就是下面的这个样子：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180606/Hj239BG5DE.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时我们再找一种方法绘制这个散点图，此时将x轴坐标改为小鼠的大小，y轴还是小鼠的体重，此时散点图就是下图这个样子：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180606/D9bfjL9i7g.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时，它的平均值还是不变的，还是如下图的样子：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180606/7bmGhLBi4J.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>从这个图上，我们直观上可以看出，小鼠的体重貌似是随着小鼠的大小而增加的（这个很好理解，不解释）。此时，我们可以再想一下，我们是否能够通过小鼠的大小来预测它的体重？我们画一条线，大致符合这些数据点的分布，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180606/Hd2jFhEd2l.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时，如果我们已知一个小鼠的大小（size），我们就能够根据这条直线大致知道这个小鼠的体重。但是此时有个问题，这条直接是否能够比平均值代表这批小鼠的大小与体重的关系？其实是可以的，我们有个指标，就是R的平方，它能判断某条直线是否代表了小鼠的大小和体重的关系，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180606/F4aD1GFGBE.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时我们可以计算这个直线与均值的差异，其实就是计算<span class="math inline">\({R}^2\)</span>（顺便说一句，写统计学笔记，免不了要使用公式，现在markdown中对公式支持的比较好的是mathjax语法，而为目前来看，Typora（最新版），为知笔记对mathjax语法支持都不错），计算公式如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180606/AKlI1J7Jke.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>通过计算，var(mean)=32,Var(line)=6，根据公式，<span class="math inline">\({R}^2\)</span>如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180606/GFLkH7010k.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>注：<span class="math inline">\({R}^2\)</span>在统计学上叫决定系数（determination coefficient），它反映了因变量的变异能够被模型（纳入的自变量）所解释的比例，也就是模型解释的变异占总变异的比例，此案例中，这条直线能够解释81%的体重与大小的关系。</p>
<p>这个案例中讲的情况我们在用BCA测蛋白浓度法时经常使用，x轴是吸光度，y轴是蛋白含量，通过做曲线，找出吸光度与蛋白浓度的关系，曲线做得好，R的平方能达到0.99，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180606/E05A82dC09.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h2 id="第2个案例">第2个案例</h2>
<p>再看一个案例，在这个案例中，x轴是小鼠嗅岩石所花的时间（我不太清楚这是什么实验，照字面翻译了），y轴是小鼠的体重，它的散点图以及计算的R平方如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180606/AD9j5DJ4c5.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>结果显示，R的平方是6%，它也就是说小鼠嗅岩石所花的时间与小鼠的体重关系不大，这条蓝色只能解释6%的变异。</p>
<h2 id="r平方的意义">R平方的意义</h2>
<p>因此，我们在做某条直线来表示两个变量之间的关系时，如果R的平方是0.9，那么我们可以说，这条直接可以解释这两个变量90%的变异。如果是0.01，那么我们可以说，这条直接只能解释这两个变量1%的变异，也就是说这两个变量没什么关系。</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180606/910Bd7Cgak.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h2 id="r与r的平方">R与R的平方</h2>
<p>那么什么是R，什么是R的平方呢？什么时候使用这两个参数？看下图的解释：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180606/78KEgaKB9J.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>通过情况，评估一个直线的好坏，都是看R平方的，它直接代表了变异，更好解释直线的拟合好坏，而不是看R（很多统计软件中也都是这样）。例如一个直线的R是0.7，另外一个是0.5，那么转换为R的平方，肯定是前者比后者要好，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180606/4B22cJ13Fh.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>但R的平方也有局限，就是R的平方都是正值，没有负值，它不代表两个变量的具体关系，也就是说，这两个变量是正相关（一个增加，另外一个也增加），还是负相关（一个增加，另外一个减少），此时就要看R了，R是正值，表示正相关，R是负值，表示负相关。</p>
<p>结论就是，R的平方表示直线的拟合程度，R表示了两个变量变化的关系。</p>
<h2 id="线性回归">线性回归</h2>
<p>先看一个场景，下图是某个散点图：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180606/2a53hIiL2J.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时我们要绘制一条直线来代表这些点，这些直线可以有多条，就像下面的这些直线一样：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180606/DJIKHe7aLC.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>但此时有个问题：哪一条直线最合适？</p>
<p>问题解决思路如下：</p>
<p>第一，假如我们先随便找条直接，例如y=3.5这条直线，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180606/0JE9m2bal5.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>我们可以计算这些点与这条直线的接近程序，例如第一个点（x1,y1），如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180606/gI7lG006j2.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>那么第2个点的距离就是这个样子：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180606/f1F3dF4ijH.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>再接着，计算第3个，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180606/3C19h8gAAH.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>还有第4个点：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180606/9c527i8590.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>这第4个点与前面3个点不太一样，因为，b-y4是一个负值，第5个点也是如下：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180606/C23lIeDkG8.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>第4个点与第5个点和前面的点不太一样，因为前面的b-y1，b-y2，b-y3都是正值，那么最终计算这些点与这个条直接的距离总和时，会相互抵消，为了避免这个问题，可以将所有的数值平方，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180606/cfkahca5D4.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时，计算一下这些值的平方，数值为24.62，这个数值在统计学上叫残差平方和（sum of squared residuals，简称SSE），残差（residual）指的是实际数据与拟合曲线的差值平方的和，这个值越小，表示实际的数值离拟合曲线的距离越小，也就是越能代表这些真实的数据，求出的这条曲线的方程的过程叫线性回归（Linear regression）。</p>
<p>此时，我们再换条曲线试试，就是把上面的这条曲线旋转一下，再计算一下SSE，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180606/fcglJic4Bd.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>它的SSE是18.72，貌似比第一曲线更好，再旋转一下看看：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180606/7A5CI3h038.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>它的SSE是14.05，貌似更好，再旋转一下试试：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180606/2h8fH1gh8j.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>这个SSE是31.71，貌似就比较差了。此时我们再看一下常规的曲线方程，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180606/m2kEF7kaem.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>其中，a代表这条曲线的斜率，b代表截矩。我们要寻找最佳的拟合曲线必然是SSE最小的那条。而在统计学中，我们经常把下面的公式叫做残差平方和，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180606/B5IBG15h4l.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>由于我们寻找这条曲线（寻找这条曲线，其实就是寻找这条曲线的斜率与截矩）的方法是通过寻找最小的SSE这个原理实现的，因此，这种求直线的方法就叫做最小二乘法（Least squares）（为什么这种方法的中文译名与英语差异这么大？因为平方在中国古代的数学中就叫二乘，因此这种方法就翻译成了最小二乘法），如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180606/JDmgEJ3HBl.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>如果我们将上面的这些曲线以及旋转后的曲线的SSE绘制出来，我们就会得到下面的这个图形：<img src="http://ortxpw68f.bkt.clouddn.com/professional/180606/HBiI9JEALI.png?imageslim" alt="mark"></p>
<p>x轴上是各种曲线的形状（它们拥有不同的斜率与截矩），y轴是SSE。上面的散点图的本质其实也是一条曲线（数学上的曲线包括弯曲的线与直线，它是点运动的集合），如何找到最佳拟合的曲线（这条曲线指提原始数据的拟合曲线）呢，就是对曲线（这里的曲线指的上图的这条曲线，也就是不同斜率和截矩下的各种曲线的SSE的集合）求导（derivative），那么导数为0时，也就是SSE最小（导数的推导与意义可以参见高中数学），如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180606/IlaCmBLlL0.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>过程如下：</p>
<p>先看第一个点：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180606/60f84gccKJ.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>再看第二个点：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180606/8IaamD6I56.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>第三个点：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180606/1bHhicc2Da.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>在第三个点处的导数斜率为0（这点很重要），还有这些点：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180606/dgi53mCaee.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>再回头看第3个点：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180606/iaa56BhjLi.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>我们只需要记住，在对原始数据进行拟合时，曲线的旋转代表了不同的斜率a和截矩b。</p>
<p>在计算最佳的拟合曲线时，我们还使用一种三维坐标系（x轴是斜率，y辆是截矩，z值是SSE），如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180606/h661AB8AB2.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>那么如果我们选定一个截矩，然后绘制不同斜率对应的SSE，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180606/388D924jFa.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>接着，我们按照同样的方法绘制大量不同截矩与斜率的曲线对应的SSE，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180606/k9f3kclAIG.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>然后计算这些曲线的斜率与截矩的导数，然后找出导数为0时的斜率与截矩。这种方法的计算过程通常是由计算机完成的。最终求出的线性回归方程如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180606/68cK9g8L4G.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h2 id="局部线性回归">局部线性回归</h2>
<p>现在我看一个散点图，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180606/L0iI9gf5kk.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>我们如果对这散点进行拟合，困难貌似比较大，因为这些散点图不可能用一个方程表示的直线进行拟合。因此，我们为了拟合这种散点图，就要换一种方法，这种方法的核心思想是：</p>
<p>第一，将这些散点通过一个滑动的窗口将它们分成更小的部分，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/2754EGKj3D.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>第二，在每个滑动窗口中，对这一小部分数据进行拟合，求出它的线性回归方向，此时，就跟线性回归一样了，最终再把这些线性回归方程汇总起来，其本质我觉得就是微积分的思想，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/2im7m9Il3g.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>下面是具体的思维过程，上面的散点图有点复杂，我们先看一个比较简单的散点图，我们把下面的散点图以x轴的5个单位为基本单位进行窗口的划分，那么第一个滑动窗口中含有5个数据点，就是图中绿色方框圈起来的部分，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/Hi5di4l7Aa.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时，我们把这个方框中的第一个点称为这个窗口的焦点（focal point），如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/D4HI84ab12.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>在第一个滑动窗口的这5个点中，第2个点就是最接近焦点的点，它距离焦点是1个单位，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/8hDacHf4Hk.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>第3个点就是第2个最接近焦点的点，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/iEBja97flL.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>同理，还有第3个，第4个最接近焦点的点，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/IB930je8bl.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时，我们对这5个点做一个“加权最小二乘”（weighted least squares），离焦点最近的点它的权重（weight）就大（权重可以理解为影响拟合曲线的影响力），如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/f8mB03iJ4f.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>由上述描述可知，焦点的权重最大，而其余点的权重与其跟焦点的距离成反比，最远的点（也就是上图中4号点）权重最小，此时，我们先做一个普通的最小二乘法线性回归，此时的回归并不考虑各个点的权重，它的曲线如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/7K4mKbHBJa.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>我们再做一个加权后的线性回归，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/6Lkc9Je5g7.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>从图中可以知，最后一个点的权重小，它对于这线曲线的斜率影响不大，并不会把斜率拉高，此时我就对这5个数据点有了一条拟合曲线，此时，我们把第1个点（也就是上图黑色的点）的x轴坐标代入这个拟合的曲线方程，求出一个新的点的坐标，这个新的点的坐标就是我们最终要拟合的曲线上的点，就是下图的红叉所在位置（虽然这个红叉在图片上与第1个点重合，但它们不是一个点），如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/ckL3L8f6HJ.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>我们再继续。此时我们把第2个点当作是焦点，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/lDfA33l186.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>这个滑动窗口中还是含有原来的4个点，但是离焦点最近的点的已经变成了2个，它们离焦点是1个单位，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/BgKfBdCHiH.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>接着，离焦点次近一点的是离焦点有2个单位的点，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/KGaial5089.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>最远的点，是距离焦点有3个单位的点，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/iBJj3FEl1m.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时，我们使用加权最小二乘法时，焦点权重最大，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/faL4m0i9L7.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>两边的两个点权重次之，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/f5Dc4il0m7.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>最远的点，权重最小，此时我们画出拟合曲线，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/B6f5D80Kjm.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时，我们利用这个方程求出最终要拟合曲线上的点（这个点的x轴坐标与上面第2个点的x轴坐标一样，但y轴坐标不一样），因此，这个红叉所在点（虽然图片上看上去这个红叉是与第2个点重合，其实是不是重合的）是我们最终要拟合的曲线上的第2个点，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/9ieKF2IlFb.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时，我们再研究第3个点，将它当成焦点，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/G31G6e8hii.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>方法如同第1个点和第2个点一样，以第3个点为焦点拟合的曲线如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/DaGKkifCj7.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>其中，红叉的地方，就是我们最终要拟合的曲线上的点，接着，我们看第4个点，如果第4个点是焦点的话，此时有点不太一样，这个滑动窗口与前面第1，2，3个点的窗口都有所不同（1，2，3个点的窗口其实是一样的，因为距离它们最近的5个点都相同），而第4个点的话，离它最近的4个点（一个窗口一共是5个点），并不包括第1个点，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/I2K851gC1H.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>离第4个点最近的两个点在它的两边，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/Fd52hD8FhJ.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>其次，离它最近的两个点是稍远一点的，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/0EHHhC7h7L.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>从图上可知，我们划分窗口宽度的时候，只考虑x轴，并不考虑y轴。此时，我们采用加权最小二乘法进行拟合，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/3jfdDA4b2C.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>然后，根据这条曲线，计算我们最终要拟合曲线上的点，它的求法是将第4个点的x轴坐标代入上面的曲线方程，求出这个拟合曲线上的点，如下所示（此时的这个点与第4个点并不重合，只是x轴坐标一样）：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/25GhCh0dfF.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时，我们再看一下我们前面求出的新的点，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/kEL3LDjl2m.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>按照这个方法，我们划出一个窗口，然后求出这个窗口中的拟合曲线，然后计算这个窗口中焦点对应的最终拟合曲线上的新的点，最终，求出的所有新的点如下图中的红叉所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/L9ddJi9mf5.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>从下面的图我们可知，黑色椭圆中的这些点是被最上面的点拉上去了，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/e3IL99dLg9.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>而最上面的这个点就是个离群点（outliner），为了避免这个点对整体拟合效果的影响，我们需要根据这个点距离原始点和新生成点的距离，对这个点额外添加一个权重，如下所示：<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/e102G9aG6J.png?imageslim" alt="mark"></p>
<p>从上面的图还可以知道，大括号标中的点的权重比较低，因为原始点与新生成的点距离比较远。而下面的这个点权重更低，因为它离得更远，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/8LiGDcHKHB.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>根据新生成的点与原始点之间的距离，我们可以计算出新的权重，这样我们此时就有了两组权重，</p>
<p>第一组就是基于每个窗口中，每个点距离焦点距离的原始权重，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/KgAkeA274i.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>第二组就是基于原始点与新生成点的距离的权重，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/H7klAefk8j.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>根据这些权重调整了原始点与新生成点的位置后，我们就可以看到“新-新”的点（new-new point），从下图中的第4个点和第5个点就能明显看出来，它们之间的距离缩短了，如下所示，利用这些调整后的点绘制曲线，就会显得更加光滑。</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/Bh0A3adHCH.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>我们把所有的点都进行调整，我们就会得到一个完美，平滑的回归曲线，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/10HH8A1kEL.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>不过，这个调整过程要不断地进行几次才能得到理想的平滑曲线，以下就是最终得到的曲线：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/1cAB3l9K6d.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h3 id="另外的思考">另外的思考</h3>
<p>我们试想一下，在第1个窗口中，我们采用回归曲线是直线，其实它也可以做成抛物线，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/m01AKA5Bbi.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>我们先看一个案例，还是最初的散点图：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/A6AllAK8FG.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>下图的黑色曲线是在每一步都采用了加权最小二乘法得到的曲线，蓝色曲线是在每一步都采用了抛物线进行拟合的曲线：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/J7lbh4a9l2.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>从图中我们可以看到，貌似划线的拟合效果更好。在而R语言中，如果只想拟合为常规的这种直线，可以采用<code>lowess()</code>函数，如果想要拟合为抛物线或直线，可以采用<code>loess()</code>函数，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/a9elCdCeI9.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>在Ｒ中，使用<code>loess()</code>函数还能绘制出曲线的置信区间，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/aDH2Lb7cem.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>关于滑动窗口的设置取决于用户自身，滑动窗口的划分可以按照精确的单位进行划分，也可以按照百分比来进行划分，下图我认为是使用了5%这个比例来进行划分的（从图上大概可以看出来，5%的比例范围内，这个曲线是直线）：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/FAbeGjJ88h.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>下图的蓝色拟合曲线是使用了总数据点的三分之一进行窗口划分的：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/d72h86EFj5.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>下图的红色曲线是使用了R语言中<code>loess()</code>这个函数的默认值进行拟合的，而它的默认值是75%的数据点，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/E16gaHkf5D.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h3 id="关于权重">关于权重</h3>
<p>计算权重的公式仅仅是出于数学上的考虑，并没有考虑它们的生物学或物理学上的意义。</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/Hb8GjCGj0g.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>下图的左图是考虑了每个数据点距离x轴的距离后计算的权重，下图的右图是考虑了原始数据点与新生成数据点的距离后计算的权重：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/Cg0b0h8I0h.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>下图左图是对这两种权重进行比较，我们可以发现，这两种权重有一些微妙的差别，而右图表示的是另外的一种权重函数（右图没听清楚原视频中说的是什么意思，有空翻一下书再来补充）：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/LaIeacaadC.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2018/06/03/BioStatistics/生物统计-StatQuest学习笔记03-标准差、标准与置信区间/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/06/03/BioStatistics/生物统计-StatQuest学习笔记03-标准差、标准与置信区间/" itemprop="url">StatQuest学习笔记03——标准差、标准与置信区间</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-06-03T12:10:54+08:00">
                2018-06-03
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/生物统计/" itemprop="url" rel="index">
                    <span itemprop="name">生物统计</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  1,790
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  6
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="前言主要内容">前言——主要内容</h2>
<p>这是StatQuest视频教程的第8-12个。</p>
<p>第8个视频的内容为标准差，标准误，第9个视频是柱状图与饼状图；第10个视频是对数转换以及对数的运算，这个非常简单；第11个视频：置信区间；第12个视频：</p>
<h2 id="标准差与标准误">标准差与标准误</h2>
<p>看下面的案例，这5个点是5只小鼠的体重，其中红色竖线是均值，红色横线就是标准差（standard deviation），它表示的是数据的分布情况，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180605/BCF6eHaj20.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>接着，我们在5个时间点，又分别测量了这5只小鼠的体重，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180605/EEEFheLeLe.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>我们分别计算一下这5次检测的均值与标准差，就是下图中竖线与横线所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180605/am7ieAacGG.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时，将这5次测量数据的均值放到一起，计算这些均值的均值与标准差，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180605/jI2LD0blBe.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时，我们称这个均值的标准差为标准误（The Standard Error,SE，有的书会称为SEM）。</p>
<h2 id="标准差与标准误的区分">标准差与标准误的区分</h2>
<h3 id="标准差">标准差</h3>
<p>标准差研究 提一次测量中，数据的变异程度，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180605/4ikdCf83fI.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h3 id="标准误">标准误</h3>
<p>标准误研究的是多次测量的变异程度，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180605/ic1e8AI204.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h3 id="标准误的估算">标准误的估算</h3>
<p>对于标准误比较让人糊涂的地方在于，虽然标准误研究的是多次测量的变异，但是，一次的检测数据也能估算出标准误（其实就是标准差除以样本数的平方根）。因此，如果你只有一次检测的数据，也是能够画出标准误的曲线的（在GraphPad中就能发现这种绘图方法）。</p>
<p>但是，多数情况下，绘图中经常出现的是标准差，而不是标准误（虽然标准误很好看），因为图形展示的通常是你的测量数据，而不是研究几次测量数据的变异。</p>
<h2 id="饼状图与柱状图">饼状图与柱状图</h2>
<p>这两种图的用途很好区分，从形状上就能看出，饼状图通常是研究不同成分在整体中的比例，柱状图通常是研究不同成分自身的数据，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180605/45Fc3Fdm5I.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>如果是两组数据，只看柱状图不太容易看出它们整体中各种成分的差异，如果是饼状图就很容易看出来了，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180605/0f892mC7jF.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h2 id="对数">对数</h2>
<p>先看一组数据，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180605/1A0BFa043J.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>在上图中，左边数轴上是0到8，而这些数字可以写成2的指数幂形式，这样的话，1就是2的0次方，2是2的1次方，4是2的2次方，相应的的5，6，7都可以这么写，只是它们的指数不是整数，这样的话，我们将这个数轴转换一下，让这些数字的指数作为数轴上的数字，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180605/5ecG44194D.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>从上图可知，使用了一个对数log转换，将原始数字转换成了以2为底的对数形式。</p>
<p>在生物学中，RT-qPCR的数据基本上都是以2为底的对数的形式展现的，我们经常看到RT-qPCR的数值不是整数，这也好理解，因为PCR的扩增效率不可能是100%（如果是100%，则肯定是整数）。在qPCR的数据处理中，通常使用的是几何均数。几何均数是对各变量值的连乘积开项数次方根。 另外，在对转录组数据进行分析时，也通常使用对数，对于差异基因的结果，通常也是对数表示的，正数表示基因表达上调，反之，下调。</p>
<h2 id="置信区间confidence-intervals">置信区间（confidence intervals）</h2>
<p>先看一个场景，下图是我们检测了一批雌性小鼠（12只）的体重，其中红色竖线是这次数据的均值：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180605/89hkG8j5kb.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时，我们从这批小鼠中自举（bootstrap）一些样本，例如我们随机选取12只（肯定有重复挑中的小鼠，这个没有关系），如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180605/lG74dJm6jh.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>关于自举：</p>
<blockquote>
<p>自举的思想：</p>
<p>从给定训练集中有放回的均匀抽样，也就是说，每当选中一个样本，它等可能地被再次选中并被再次添加到训练集中。从初始样本重复随机替换抽样，生成一个或一系列待检验统计量的经验分布。 无需假设一个特定的理论分布，便可生成统计量的置信区间，并能检验统计假设。</p>
</blockquote>
<p>自举后，计算这次抽样的均数，然后再自举，再算均数，这个过程持续很多次（大于1000次），计算出的均数如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180605/b45IGE8k1E.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时我们计算置信区间，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180605/Illf8bdDE2.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>这个95%的置信区间就是指，它覆盖了这次自举所有数据的95%均值范围。由于这个置信区间覆盖了95%的均值，那么我们就知道，均数在这个区间之外的概率是不到5%（0.05只是一个界限）。那也就是说，任何在这个区间之外的数字的概率p值是小于0.05的（也就是说有显著意义）。</p>
<h3 id="置信区间的用处">置信区间的用处</h3>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180605/iGbemGdE30.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>先看置信区间的示意图：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180605/Cm49lc46b1.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>均值是对“真实”值的估计（真实值是无法知道的，只能通过不断地测量一步一步接近）。</p>
<p>它有95%的可能落在95%的置信区间内，下图的绿色椭圆的范围是在95%的置信区间之外，它的最右边是20，我们可以发现，在这个绿色椭圆之内也有一个均值（是通过自举法计算的），也就是说这个均值落在了这个绿色的椭圆之内，那么均值落在它里面的概率是多少？这个概率我们通常用p值来表示。从图形上可以看出来，这个绿色椭圆的范围是在95%的置信区间之外，因此我们就可以推断出此时p值是小于0.05的（这只是一种非常粗糙的推断，具体的推导过程可以看相关的数学书），因此我们就可以下结论：“真实”值出现在95%区间以外的概率不到5%（也就是说p值小于0.05时有统计学意义）。</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180605/KhHLl4jgJB.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h3 id="两个数据集的比较">两个数据集的比较</h3>
<p>再看一个案例，下图是雌性小鼠与在雄性小鼠体重的测量结果，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180605/AIibFKF7jL.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>其中，上图的黑色横线表示的是各自的95%置信区间。从图片上我们就可以直接看出，这两组数据的95%置信区间并不重复，它是有统计学意义的，也就是说我们可以直接看出来p值是小于0.05的（在实际运用中不可以这么做，还是要通过t检验进行计算）。但是，如果它们的95%置信区间有部分重合，就像下面的这个样子：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180605/bB89CE917d.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时就要进行t检验了。</p>
<h2 id="section"></h2>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2018/06/02/BioStatistics/生物统计-StatQuest学习笔记02-样本量与重复/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/06/02/BioStatistics/生物统计-StatQuest学习笔记02-样本量与重复/" itemprop="url">StatQuest学习笔记02——样本量与重复</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-06-02T12:10:54+08:00">
                2018-06-02
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/生物统计/" itemprop="url" rel="index">
                    <span itemprop="name">生物统计</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  1,895
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  7
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="前言">前言</h2>
<p>这是StatQuest视频教程的第6、第7个。</p>
<h2 id="技术重复">技术重复</h2>
<p>现在考虑一个场景，我们要对一批人进行采血，并对这些血样进行基因表达的分析。此时我们先对A进行采血，A的血样我们会检测3次，这3次就叫技术重复（technical replicates），因为我们是对同一个样品进行了测序，研究其基因表达谱，这其实类似于我们做RT-qPCR中的复孔（RT-qPCR我们通常对同一个样本的同一个基因做3个复孔）。</p>
<p>做技术重复我们要解决的问题是：</p>
<ol style="list-style-type: decimal">
<li><p>能够对一个人的基因表达谱进行更加精确地检测；</p></li>
<li><p>能够评估一次实验数据是否精确，例如我们做了3次技术重复，这3次结果都非常接近，那么这批数据就非常可信，相反，如果这3次结果差异很大，那么这批数据就不太可信。通常来说，如果我们开发出了一种新的检测方法，3次技术重复是必不可少的。</p></li>
</ol>
<p>再看下面的案例：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180604/lLemJgLbjm.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>如果我们对同一个人采血，采血了3次，对这3次分别检测他的基因表达，这3次实验我们也认为是技术重复，因为此时研究的对象是同一个人。此时我们从这3次实验中可以获知一些方法之外的信息，因为这3次实验的差异（差异可能很小），可能与一些除了检测方法之外的因素有关。</p>
<h2 id="生物学重复">生物学重复</h2>
<p>现在我们再看一种情况，此时有三个人，分别为A，B，C，我们分别取他们的血样，进行基因检验，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180604/fbg9f18jd4.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>这三个分别来自于A，B，C三个人（男性）的重复称为生物学重复，生物学重复主要是为了研究一类对象中的基因表达情况，这个一类对象可以是人类，或者是小鼠，或者是植物，或者是细胞系（cell lines）。这个实验主要是为了研究男性的基因表达情况，从这些数据中你不太可能知道女性的基因表达情况。如果我只想研究Y染色体的基因表达情况，这就是一个很好的实验。但是，如果我想研究整个人类（包括男性与女性）的基因表达情况，我还需要检测女性的基因表达情况，然后汇总起来分析。</p>
<p>再来看一个情况。如果只检测A的基因表达情况，那么最终的结果只能说是研究了A的基因表达情况，而不是B或C的基因表达，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180604/840Ch0hkE1.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h2 id="技术重复和生物学重复的使用">技术重复和生物学重复的使用</h2>
<p>在实际运用过得中，可以联合使用生物学重复和技术重复，这主要取决于实验类型。有时候如果增加更多的生物学重复，就可以不用技术重复，如果看文献的话，我们经常看到，某实验检测了几十个某病毒的基因表达谱，这些数据通常就不做技术重复，另外，还有一些实验，例如使用的是细胞系，细胞系的样本之间通常差异很小，都是由一个克隆长出来的，因此细胞系的通常也不做技术重复，只做2个生物学重复就行（有的还是做3个生物学重复），如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180604/K3kf0BDmIb.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h2 id="样本量simple-size">样本量（simple size）</h2>
<p>试想以下场景：</p>
<ol style="list-style-type: decimal">
<li>我们对蓝色男性的基因表达有兴趣；</li>
<li>我们是一个小鼠遗传学家，我们可以把这个蓝色的对象视为一种特殊品系的小鼠，例如C57BL/6；</li>
<li>我们对植物感兴趣，此时我们把这个蓝色的对象视为某个品种的树木。</li>
</ol>
<p>先看第一种场景：我们要对这三个蓝色男性（此时这个蓝色男性不再表示一个人，而是某个民族，例如汉族）进行采血，然后检测其基因表达，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180604/mFlbGm4Ccd.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>这样，我们就检测了3次汉族男性的基因表达情况，此时我们用N来表示样本数目，此时N=3。即使我们对每个血液样本检测了2次基因表达情况，如下所示，此时的样本数目仍然是3：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180604/G61Bj5BleL.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>其中一个样本的2次检测就是技术重复，只是用于评估基因检测方法是否精确，它不会告诉我们这3个样本之间的差异。如果我们研究基因检测方法的精确性，那么我们就需要多进行几次技术重复，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180604/gh8JbCe82d.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时，N=4（这个4表示对一个样本做了4次技术重复，注意与前面的生物学重复进行区分），我们要注意，技术重复只是在描述一个方法时才有意义。</p>
<h2 id="有效样品量effective-sample-size">有效样品量（effective sample size）</h2>
<p>此时我们看一种比较复杂的情况，现在我们要研究一些男性基因表达谱的常规特征，这个时候就需要检测多个不同的男性，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180605/agj0f7jEci.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>在这个方案里，我们要检测除了蓝色男性之外的其他男性的基因表达情况，也就是说，我们要检测蓝色，黄色，绿色男性的基因表达情况，此时N=3。此到很好理解N=3，但是，如果蓝色是双胞胎，我们检测了这4个人的基因表达情况，也就是如下所示的情况，此时N值就不一定等于3了，如果说N值为4，也有点不太对劲，如下所示：<img src="http://ortxpw68f.bkt.clouddn.com/professional/180605/d7hBlk00JI.png?imageslim" alt="mark"></p>
<p>事实上，此时N值是位于3到4之间的数字。双胞胎其实也是两个不同的的，独立的人，但他们的基因是高度相关的，至少与黄色，绿色人相比，这两个蓝色人的基因更加相似：<img src="http://ortxpw68f.bkt.clouddn.com/professional/180605/baKAI2glCa.png?imageslim" alt="mark"></p>
<p>如果我们计算一下这对双胞胎的基因相关性（correlation），那么我们就能计算出有效的相样量（effective sample size）：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180605/md5dakKkAg.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>例如，如果我们计算出这对双胞胎的相关性是0.7（具体的计算过程先不要管），那么，有效的样本数就是如下所示的公式：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180605/30bH9h3bDc.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>代入公式，则为：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180605/Cec16i95ma.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>因此，当这两个双胞胎高度相关时，他们就不能被视作是2个样本，而是1.18个样本：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180605/7h195jF6EB.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>如果这对双胞胎之间的相关性很低，比如说是0.1，那么代入公式，有效样本量就如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180605/I0D41050F6.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时这两个双胞胎就相当于1.82个样本（这种算法很好理解，毕竟，如果两个人非常相似，就相当于是一个人了）。</p>
<p>在实际情况中，有效样本数的计算更加复杂，不过基本思想是一致的，也就是说，如果样本之间高度相似，它们不能被视为一个样本。</p>
<h2 id="总结">总结</h2>
<ol style="list-style-type: decimal">
<li>技术重复用于评估方法的准确性。</li>
<li>生物学重复用于评估其个物种的特性；</li>
<li>涉及多个样本的时候，如果某两个样本比较相似，要考虑到有效的样本数。</li>
</ol>
<h2 id="补充知识点">补充知识点</h2>
<p>effective sample size：</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2018/06/02/BioStatistics/生物统计-05正态分布/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/06/02/BioStatistics/生物统计-05正态分布/" itemprop="url">正态分布笔记</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-06-02T12:00:00+08:00">
                2018-06-02
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/生物统计/" itemprop="url" rel="index">
                    <span itemprop="name">生物统计</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  5,775
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  23
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="连续型变量的分布">连续型变量的分布</h2>
<p>连续型变量是在连续区间取值，例如质量、长度、面积、体积、寿命、距离等就是连续型变量，现在试想一下连续变量观测值的直方图；如想其纵坐标为相对频数，那么所有这些矩形条的<strong>高度</strong>和为1，那么完全可以重新设置量纲，例这些矩形条的<strong>面积</strong>为1，如果不断增加观测值，并不断增加直方图的矩形条的数目，这些直方图就会越来越像一条光滑曲线，其下面的面积和为1，这种曲线就是<strong>概率密度函数(probability density function, pdf)</strong>，简称为密度函数或密度，下图就展示了逐渐增加矩形条数的直方图和一个形状类型的密度曲线：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">par(mfrow=c(<span class="number">2</span>,<span class="number">2</span>))</div><div class="line">x=rnorm(<span class="number">10000</span>)</div><div class="line">z&lt;-seq(-<span class="number">4</span>,<span class="number">4</span>,length=<span class="number">10000</span>)</div><div class="line">hist(x,<span class="number">20</span>,probability=<span class="literal">T</span>,col=<span class="number">2</span>)</div><div class="line">hist(x,<span class="number">50</span>,probability=<span class="literal">T</span>,col=<span class="number">2</span>)</div><div class="line">hist(x,<span class="number">100</span>,probability=<span class="literal">T</span>,col=<span class="number">2</span>)</div><div class="line">plot(z,dnorm(z),type=<span class="string">"l"</span>,</div><div class="line">     xlab=<span class="string">"x"</span>,ylab=<span class="string">"Density Function"</span>,</div><div class="line">     bty=<span class="string">"n"</span>,</div><div class="line">     main=<span class="string">"Dencity Function of x"</span>)</div></pre></td></tr></table></figure>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180814/lc436IHfHE.jpeg?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h4 id="什么是密度">什么是密度？</h4>
<p>这里说一下密度，密度是描述变量分布的一个重要概率，简单地说，它描述变量取各个值的可能性大小，变量在密度曲线高的位置取值的可能性比在低的位置取值的可能性大。在概率密度曲线中，纵坐标就是密度(Density)。</p>
<p>而密度曲线(density curve)是分布的一个数字模型，按照定义，任何密度曲线下的总面积都是1，在一个区间的密度曲线下的面积为出现在这个区间中的观测值占所有观测值的比例。</p>
<p>在矩形面积和为1的直方图中，连续变量落入某个矩阵的概率为该矩形的面积，类似地，连续变量落入一个区间的<strong>概率</strong>就是<strong>概率密度函数曲线</strong>在这个区间上所覆盖的面积，也就是密度函数在这个区间上的积分，根据初等微积分，连续函数在一个点的积分是0（因为曲线下面的面积退化成一条垂直于x轴，平行于y轴的直线），因此对于连续变量，取任何一个单独特定值的概率都是0，而只有变量取值于某个（或若干个）区间的概率才有可能大于0。连续变量和离散变量类似，它的密度函数（这时用f表示随机变量X的密度函数）必须满足<span class="math inline">\(f(x) \geq 0\)</span>，而且密度曲线下面覆盖的总面积为1，即：</p>
<p><span class="math inline">\(\int_{-\infty} ^{ \infty }{f(x)}\,{\rm d}x=1\)</span></p>
<p>而X落入区间(a,b)的概率则为： <span class="math inline">\(P(a\leq X \leq b)=\int_a^b{f(x)\,{\rm d}x}\)</span></p>
<p>连续变量也有累积分布函数(cumulative distribution function, CDF)，定义为：</p>
<p><span class="math inline">\(F(x)=P(X\leq x)=\int_{-\infty} ^{x }{f(x)}\,{\rm d}x\)</span></p>
<p>这样，和离散变量一样，如果要求P(a<x≦b)的值，就可以通过两个累积分布f(b)和f(a)之间在用公式获得，如下所示： $p(a\leq="" x="" \leq="" b)="P(X\leq" b)-p(x\leq="" a)="F(b)-F(a)$" 而不用根据密度函数求积分了。="" 连续随机变量也有描述变量“位置”的总体均数、总体中位数、总体百分位数以及描述变量分布（集中）程度的总体标准差和总体方差等概念，对于连续分布随机变量x，它的总体均值（通常用μ表示）定义为：="" $\mu="E(X)=\int_{-\infty}" ^{="" \infty="" }{xf(x)}\,{\rm="" d}x$="" 这也称为x的数学期望，变量x的总体方差（通常用$\delta^2$表示），定义为：="" $\delta^2="Var(X)=\int_{-\infty}" }{(x-\mu)f(x)}\,{\rm="" 总体标准差定义为总体方差的平方根，如下所示：="" $\delta="\sqrt{Var(X)}=\sqrt{\int_{-\infty}" d}x}$="" ##="" 正态分布="" 下图是四个二项分布图，这四个二项分布有共同的p="0.1，但是有不同的n，分别为5，20，50，500，可以看出，当n较小时，分布很不对称，当n增加时，分布变得对称，实际上，当n充分大时，二项分布趋向于一个连续型对称分布，这就是正态分布(normal" distribution)，如下所示：="" <figure="" class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">n&lt;-c(<span class="number">5</span>,<span class="number">20</span>,<span class="number">50</span>,<span class="number">500</span>)</div><div class="line">p&lt;-<span class="number">0.1</span></div><div class="line">par(mfrow=c(<span class="number">2</span>,<span class="number">2</span>))</div><div class="line">barplot(dbinom(<span class="number">0</span>:n[<span class="number">1</span>],n[<span class="number">1</span>],p),main=<span class="string">"Binomial(5,0.1)"</span>)</div><div class="line">barplot(dbinom(<span class="number">0</span>:(<span class="number">2</span>*floor(<span class="number">2</span>*n[<span class="number">2</span>]/<span class="number">5</span>)),n[<span class="number">2</span>],p),main=<span class="string">"Binomial(20,0.1)"</span>)</div><div class="line">barplot(dbinom(<span class="number">0</span>:(floor(n[<span class="number">3</span>]/<span class="number">3</span>)),n[<span class="number">3</span>],p),main=<span class="string">"Binomial(50,0.1)"</span>)</div><div class="line">barplot(dbinom(<span class="number">25</span>:<span class="number">75</span>,n[<span class="number">4</span>],p),main=<span class="string">"Binomial(500,0.1)"</span>)</div></pre></td></tr></table></x≦b)的值，就可以通过两个累积分布f(b)和f(a)之间在用公式获得，如下所示：></p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180814/J2GhBlFFml.jpeg?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>在实际生活中，近似地服从正态分布的变量也很常见，例如测量误差，商品的重量或尺寸，某特定人群的身高和体重等，此外，在一定条件下，许多不是正态分布的样本均值在样本量很大时，也可用正态分布来近似估计。</p>
<p>正态分布也是一族分布，不同的正态分布根据它们的均值和标准差不同而有所区别，因此一个正态分布用<span class="math inline">\(N(\mu,\delta)\)</span>表示，其中<span class="math inline">\(\mu\)</span>是总体均值，而<span class="math inline">\(\delta\)</span>是总体标准差，正态分布也常用<span class="math inline">\(N(\nu,\delta^2)\)</span>来表示，这里的<span class="math inline">\(\delta^2\)</span>为总体方差，这些总体参数在实际问题中是未知的，但可以估计，例如用样本均值和样本标准差来估计总体均值和总体标准差，正态分布的密度曲线是一个对称的钟形曲线（最高点在均值处），正态分布<span class="math inline">\(N(\mu,\delta)\)</span>的密度函数如下所示：<img src="http://ortxpw68f.bkt.clouddn.com/professional/180814/45hm76GKm2.png?imageslim" alt="mark"></p>
<h3 id="正态分布的推导">正态分布的推导</h3>
<p>在理解正态分布的时候，如果知道它的推导过程，以及曲线下面积是如何求的，就会对正态分布的理解更深入，但是这涉及到一定的数学知识，包括大数定量，微积分等，目前我没有能力理解这些，具体的可以看陈希孺的《概率论与数理统计》等资料。不过真正用这个函数来计算正态变量概率数值的情况不多，多数直接采用累积分布函数来计算的。</p>
<h2 id="正态分布密度曲线">正态分布密度曲线</h2>
<p>下面分别绘制均值（以下用m表示）为0，标准差（以下用sd表示）为1，m=0，sd=0.5，m=0，sd=2，m=-2，sd=1的正态分布密度曲线（密度曲线下面的积分面积对应的就是相应范围内的概率），可以看出不同的均值与标准差，正态分布的密度曲线形状就不一样：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">set.seed(1000)</div><div class="line">x &lt;- seq(-5,5,length.out=100)</div><div class="line">y &lt;- dnorm(x,0,1)</div><div class="line">plot(x,y,col=&quot;red&quot;,xlim=c(-5,5),ylim=c(0,1),type=&quot;l&quot;,</div><div class="line">xaxs=&quot;i&quot;,yaxs=&quot;i&quot;,ylab=&quot;density&quot;,xlab=&quot;&quot;,</div><div class="line">main=&quot;The Normal Density Distribution&quot;)</div><div class="line">lines(x,dnorm(x,0,0.5),col=&quot;green&quot;)</div><div class="line">lines(x,dnorm(x,0,2),col=&quot;blue&quot;)</div><div class="line">lines(x,dnorm(x,-2,1),col=&quot;orange&quot;)</div><div class="line">legend(&quot;topright&quot;,legend=paste(&quot;m=&quot;,c(0,0,0,-2),&quot;sd=&quot;,c(1,0.5,2,1)),lwd=1,col=c(&quot;red&quot;,&quot;green&quot;,&quot;blue&quot;,&quot;orange&quot;))</div></pre></td></tr></table></figure>
<p>结果如下所示：<img src="http://ortxpw68f.bkt.clouddn.com/normaldistribution.png"></p>
<h2 id="正态分布的概率计算">正态分布的概率计算</h2>
<p>作为一个连续变量，正态变量落在某区间的概率不是等于在这个区间上，密度曲线下面的面积，下图的阴影面积等于标准正态分布变量落在区间(-1.5,1.5)中的概率，如果密度函数为<span class="math inline">\(\phi(x)\)</span>，那么这个面积就等于以下的积分，如下所示： <span class="math inline">\(\int_{-1.5}^{1.5}{\phi(x)}\,{\rm d}x=\Phi(1.5)-\Phi(-1.5)\)</span></p>
<p>在计算机未广泛应用之前，为了方便计算，数学家们就编制了标准正态分布表，而在计算机广泛使用之后，则很容易计算出服从正态分布的数据的某个范围的概率，但为了理解正态分布的原理，还是先看一下如何使用标准正态分布表来计算一下标准正态分布变量落在区间(-1.5,1.5)中的概率。</p>
<p>在使用标准正态表之前，我们知道这些信息：</p>
<ol style="list-style-type: decimal">
<li>标准正态分布是关于y轴对称的；</li>
<li>标准正态分布的概率是落在-1.5到1.5这个区间内的曲线下面积；</li>
</ol>
<p>现在查表，可以知道1.5对应的这个数值是0.9332，它表示小于1.5的曲线下面积是0.9332，-1.5没法查，但是可以查-1.5对称的曲线下面积，-1.5关于y轴对称的直线是0.5，它的曲线下面积为0.6915，也就是说小于0.5的曲线下面积为0.6915，那么大于0.5的曲线下面积为1-0.6915=0.3085，这个0.3085其实就是小于-1.5的曲线下面积，那么标准正态分布变量落在区间(-1.5,1.5)中的概率就是0.9332-0.3085=0.6247</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180814/dIKJmdh26g.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>也就是这下面的这个灰色面积，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">x&lt;-c(seq(-<span class="number">4</span>,<span class="number">4</span>,length=<span class="number">1000</span>))</div><div class="line">y&lt;-dnorm(x)</div><div class="line">r1&lt;-<span class="number">0.5</span></div><div class="line">r2&lt;-<span class="number">1.5</span></div><div class="line">x2&lt;-c(r1,r1,x[x&lt;r2&amp;x&gt;r1],r2,r2)</div><div class="line">y2&lt;-c(<span class="number">0</span>,dnorm(c(r1,x[x&lt;r2&amp;x&gt;r1],r2)),<span class="number">0</span>)</div><div class="line">plot(x,y,type=<span class="string">"l"</span>,main=<span class="string">"P(-0.5&lt;Z&lt;1.5)=0.6246553"</span>,xlab=<span class="string">"z"</span>,ylab=expression(phi(z)))</div><div class="line">abline(<span class="number">0</span>,<span class="number">0</span>)</div><div class="line">polygon(x2,y2,col=<span class="string">"grey"</span>)</div></pre></td></tr></table></figure>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180814/b406a008fK.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>不过，现在一般不用查表，使用软件计算即可，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; pnorm(<span class="number">1.5</span>)-pnorm(-<span class="number">0.5</span>)</div><div class="line">[<span class="number">1</span>] <span class="number">0.6246553</span></div></pre></td></tr></table></figure>
<h2 id="正态分布累积曲线">正态分布累积曲线</h2>
<p>代码如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">set.seed(1000)</div><div class="line">x &lt;- seq(-5,5,length.out=100)</div><div class="line">y &lt;- pnorm(x,0,1)</div><div class="line">plot(x,y,col=&quot;red&quot;,xlim=c(-5,5),ylim=c(0,1),type=&quot;l&quot;,</div><div class="line">xaxs=&quot;i&quot;,yaxs=&quot;i&quot;,ylab=&quot;density&quot;,xlab=&quot;&quot;,</div><div class="line">main=&quot;The Normal Cumulative Distribution&quot;)</div><div class="line">lines(x,pnorm(x,0,0.5),col=&quot;green&quot;)</div><div class="line">lines(x,pnorm(x,0,2),col=&quot;blue&quot;)</div><div class="line">lines(x,pnorm(x,-2,1),col=&quot;orange&quot;)</div><div class="line">legend(&quot;bottomright&quot;,legend=paste(&quot;m=&quot;,c(0,0,0,-2),&quot;sd=&quot;,c(1,0.5,2,1)),lwd=1,col=c(&quot;red&quot;,&quot;green&quot;,&quot;blue&quot;,&quot;orange&quot;))</div></pre></td></tr></table></figure>
<p>结果如下所示：<img src="http://ortxpw68f.bkt.clouddn.com/normalcumulative.png"></p>
<h2 id="总体分位数和尾概率">总体分位数和尾概率</h2>
<p>对于连续型随机变量X，<strong>α下侧分位数</strong>（又称<strong>α分位数</strong>，<strong>α-quantil</strong>e）定义为满足关系<span class="math inline">\(P(X\leq x)=\alpha\)</span>的数x，这里的α称为下（左）侧尾概率(lower/left tail probability)。</p>
<p><strong>α上侧分位数</strong>（又称<strong>α上分位数</strong>，<strong>α-upper quantile</strong>）定义为它满足<span class="math inline">\(P(X\geq x)=\alpha\)</span>的数x，这里的α称为上（右）侧尾概率(upper/right tail probability)。</p>
<p>对于连续分布，α上侧分位数等于(1-α)下侧分位数，而(1-α)下侧分位数等于α上侧分位数，通常用<span class="math inline">\(z_{\alpha}\)</span>表示标准正态分布α的上侧分位数，即对于标准正态分布变量Z，有<span class="math inline">\(P(Z&gt;z_{\alpha})=\alpha\)</span>，有些文献用符号<span class="math inline">\(z_{1-\alpha}\)</span>而不是<span class="math inline">\(z_{\alpha}\)</span>来表示α上侧分位数。</p>
<p>下图表示的就是标准正态分布0.05上侧分位数<span class="math inline">\(z_{\alpha}=z_{0.05}(=1.645)\)</span>，图形右边在区间<span class="math inline">\((z_{0.05},+\infty)\)</span>曲线下的面积等于相应的尾概率(α=0.05)：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">x&lt;-c(seq(-<span class="number">4</span>,<span class="number">4</span>,length=<span class="number">1000</span>))</div><div class="line">y&lt;-dnorm(x)</div><div class="line">plot(x,y,type=<span class="string">"l"</span>,xlab=<span class="string">"z"</span>,ylab=expression(phi(z)))</div><div class="line">abline(<span class="number">0</span>,<span class="number">0</span>)</div><div class="line">r&lt;-qnorm(<span class="number">0.05</span>,low=<span class="literal">F</span>)</div><div class="line">polygon(c(r,r,x[x&gt;r]),c(<span class="number">0</span>,dnorm(c(r,x[x&gt;r]))),col=<span class="string">"red"</span>)</div><div class="line">text(<span class="number">0</span>,<span class="number">0.2</span>,expression(P(Z&lt;z[<span class="number">0.05</span>])==<span class="number">0.95</span>))</div><div class="line">text(<span class="number">2.5</span>,<span class="number">0.08</span>,expression(P(Z&gt;z[<span class="number">0.05</span>])==<span class="number">0.05</span>))</div><div class="line">text(<span class="number">1.5</span>,<span class="number">0.02</span>,expression(P(z[<span class="number">0.05</span>])==<span class="number">1.645</span>))</div></pre></td></tr></table></figure>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180814/EDjF9l72Le.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>随后要介绍的<span class="math inline">\(\chi^2\)</span>分布，t分布和F分布都是由正态分布变量导出的三种分布。</p>
<h2 id="正态分布案例之一">正态分布案例之一</h2>
<p>再看一个案例：</p>
<p>B县的全体高一学生参加某补习班的数学测验，计算分数后得知“数学测验结果”可视为平均值为45，标准差为10的正态分布，那么这些数据就可以表示为这个样子：</p>
<p>绘制出平均值为45，标准差为10的正态分布表示，下图斜线部分的面积是0.5，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180604/cGaHI75934.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>还可以得到出这些信息：</p>
<p>第一：得分在45分以上的考生比例，占全体考生总数的0.5（50%）；</p>
<p>第二：从全体考生中，随机抽出一个人，其得分在45分以上的概率为0.5（50%）；</p>
<p>第三，将这些数学成绩标准化后（也就是常说的Z转换），0以上的考比例，占全体考生总数的0.5（50%），如下所示（看红线，不要看0.29）：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180604/hd4Fc52cIA.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>再继续这个案例，由于它是符合平均数为45，标准差为10的正态分布，那么，如果我要求某一个分数以上的考生比例，例如63分以上的考生比例，它的计算过程就是先把这个数字转换到标准正态分布上，过程如下所示（这就是Z转换）：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180604/kFdbi5EiEg.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>然后从标准正态分布表查1.8，它对应的数字是0.4641，这个数字表示的是小于63这个数字的概率，那么大于63的概率就是：0.5-0.4641=0.0359（3.59%）。它对应的面积就是下面的这个样子：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180604/ibjJ1Dlk2c.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>将它转换为标准正态分布，则是这个样子：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180604/1iCjJefj5l.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>不过现在过计算正态分布并不需要查表，查表只是了解一下这个计算原理，现在都用计算机计算了。</p>
<h2 id="r语言正态分布函数">R语言正态分布函数</h2>
<p>R语言中与正态分布有关的函数如下所示：</p>
<ol style="list-style-type: decimal">
<li>密度函数： dnorm(x, mean = 0, sd = 1, log = FALSE)</li>
<li>分布函数： pnorm(q, mean = 0, sd = 1, lower.tail = TRUE, log.p = FALSE)</li>
<li>分位数函数：qnorm(p, mean = 0, sd = 1, lower.tail = TRUE, log.p = FALSE)</li>
<li>随机函数： rnorm(n, mean = 0, sd = 1) 其余的分布函数与正态分布的前缀相同。</li>
</ol>
<h3 id="正态分布相应的概率计算">正态分布相应的概率计算</h3>
<p>求正态N(3.1.5)变量X在区间(2,4)中的概率p，如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pnorm(4,3,1.5)-pnorm(2,3,1.5)</div></pre></td></tr></table></figure>
<blockquote>
<p>pnorm(4,3,1.5)-pnorm(2,3,1.5) [1] 0.4950149</p>
</blockquote>
<h2 id="正态分布的检验">正态分布的检验</h2>
<p>判断数据是否符合正态分布通常用的是非参数检验方法（因为总体分布未知）</p>
<h3 id="shapiro.test函数">shapiro.test()函数</h3>
<p>Shapiro-Wilk正态分布检验: 用来检验是否数据符合正态分布，类似于线性回归的方法一样，是检验其于回归曲线的残差。该方法推荐在样本量很小的时候使用，样本在3到5000之间。该检验原假设为H0:数据集符合正态分布，统计量W 最大值是1，越接近1，表示样本与正态分布匹配。如果p-value小于显著性水平α(0.05)，则拒绝H0，表示样本不符合正态分布，如果p-value在大于显著性水平，则接受H0，表示样本符合正态分布。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">set.seed(1)</div><div class="line">s &lt;- rnorm(1000)</div><div class="line">shapiro.test(s)</div></pre></td></tr></table></figure>
<p>其结果为： Shapiro-Wilk normality test</p>
<p>data: s W = 0.9988, p-value = 0.7256</p>
<p>结论: W接近1，p-value&gt;0.05，不能拒绝原假设，所以数据集s符合正态分布。</p>
<h3 id="kolmogorov-smirnov连续分布检验">Kolmogorov-Smirnov连续分布检验</h3>
<p>Kolmogorov-Smirnov连续分布检验:检验单一样本是不是服从某一预先假设的特定分布的方法。以样本数据的累计频数分布与特定理论分布比较，若两者间的差距很小，则推论该样本取自某特定分布族。 该检验原假设为H0:数据集符合正态分布，H1:样本所来自的总体分布不符合正态分布。令F0(x)表示预先假设的理论分布，Fn(x)表示随机样本的累计概率(频率)函数. 统计量D为: D=max|F0(x) - Fn(x)|，D值越小，越接近0，表示样本数据越接近正态分布，如果p-value小于显著性水平α(0.05)，则拒绝H0。</p>
<p>Kolmogorov-Smirnov 检验,用法如下： ks.test(x, y, …, alternative = c(“two.sided”, “less”, “greater”), exact = NULL) R语言中ks.test有四个参数，第一个参数x为观测值向量，第二个参数y为第二观测值向量或者累计分布函数或者一个真正的累积分布函数如pnorm，只对连续CDF有效。第三个参数为指明是单侧检验还是双侧检验，exact参数为NULL或者一个逻辑值，表明是否需要计算精确的P值。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">set.seed(1)</div><div class="line">s &lt;- rnorm(1000)</div><div class="line">ks.test(s,&quot;pnorm&quot;)</div></pre></td></tr></table></figure>
<p>结果如下： One-sample Kolmogorov-Smirnov test</p>
<p>data: s D = 0.0211, p-value = 0.7673 alternative hypothesis: two-sided</p>
<p>D值很小, p-value&gt;0.05，不能拒绝原假设，所以数据集s符合正态分布。</p>
<h3 id="ks的第二案例应用">KS的第二案例应用</h3>
<h4 id="比较两组数据的分布是否相同">比较两组数据的分布是否相同</h4>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ks.test(rnorm(100),rnorm(50))</div></pre></td></tr></table></figure>
<blockquote>
<p>Two-sample Kolmogorov-Smirnov test</p>
</blockquote>
<blockquote>
<p>data: rnorm(100) and rnorm(50) D = 0.14, p-value = 0.5185 alternative hypothesis: two-sided</p>
</blockquote>
<p>在这一案例中，我们比较了两个均值和方差一样的观测值，他们D值很小，p值大于0.05，所以我们不能拒绝两个观测值分布相同的假设。</p>
<h4 id="ks比较某一数据符合某一分布">KS比较某一数据符合某一分布</h4>
<p>检验一组数据是否符合均匀分布（生成均匀分布的函数为runif))，如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ks.test(rnorm(100),&quot;punif&quot;)</div></pre></td></tr></table></figure>
<p>结果中p-value为2.2e-16，我们用rnorm(100)生成的是正态分布的数据，因此它不符合均匀分布（参数为punif）。如果参数设为pnorm，再看一下。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ks.test(rnorm(100),&quot;pnorm&quot;)</div></pre></td></tr></table></figure>
<p>结果的p值为0.6722，符合正态分布。</p>
<h3 id="pearson-拟合优度chi-square检验">Pearson 拟合优度chi-square检验</h3>
<p>（略）</p>
<h3 id="qq图">QQ图</h3>
<p>正态概率图用于检查一组数据是否服从正态分布。是实数与正态分布数据之间函数关系的散点图。如果这组实数服从正态分布，正态概率图将是一条直线。通常，概率图也可以用于确定一组数据是否服从任一已知分布，如二项分布或泊松分布。</p>
<p>QQ图是quantile—quantile的简写，一个根据正态分布的分位数，一个是样本分位数；如果两者在一条直线上，说明样本符合状态分布的分位数，即服从正态分布。QQ图是一种散点图,对应于正态分布的QQ图,就是由标准正态分布的分位数为横坐标,样本值为纵坐标的散点图. 要利用QQ图鉴别样本数据是否近似于正态分布,只需看QQ图上的点是否近似地在一条直线附近,而且该直线的斜率为标准差,截距为均值. 用QQ图还可获得样本偏度和峰度的粗略信息。</p>
<p>另外，还有一种PP图。P-P图是根据变量的累积比例与指定分布的累积比例之间的关系所绘制的图形。通过P-P图可以检验数据是否符合指定的分布。当数据符合指定分布时，P-P图中各点近似呈一条直线。如果P-P图中各点不呈直线，但有一定规律，可以对变量数据进行转换，使转换后的数据更接近指定分布。 Q-Q图同样可以用于检验数据的分布，所不同的是，Q-Q图是用变量数据分布的分位数与所指定分布的分位数之间的关系曲线来进行检验的。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">set.seed(1)</div><div class="line">s &lt;- rnorm(1000)</div><div class="line">qqnorm(s)</div><div class="line">qqline(s,col=&quot;red&quot;)</div></pre></td></tr></table></figure>
<p>结果如下所示：<img src="http://ortxpw68f.bkt.clouddn.com/qqpic.png"></p>
<p>解释：纵轴是数据的实际分位数，横轴是正态分布的理论分位数，红线是45度的参考线，如果数据是正态分布，则散点应该落在直线上。即实际分位数与理论分位数偏差不大。说明来自正态总体。</p>
<h3 id="峰度与偏度">峰度与偏度</h3>
<h4 id="峰度kurtosis">峰度（Kurtosis）</h4>
<p>峰度是描述某变量所有取值分布形态陡缓程度的统计量，它是和正态分布相比较的。 公式如下所示： <span class="math display">\[Kurtosis=\frac{\sum(X-\mu)^{4}}{\delta^{4}} -3\]</span> 正态分布的Kurtosis为K=3,为了描述方便，有时候需要减3（上述公式就减了3），有的公式没有，但原理是相同的。 <img src="http://ortxpw68f.bkt.clouddn.com/Kurtosis.png"> Kurtosis=0 与正态分布的陡缓程度相同。 Kurtosis&gt;0 比正态分布的高峰更加陡峭——尖顶峰 Kurtosis&lt;0 比正态分布的高峰来得平台——平顶峰</p>
<h4 id="偏度skewness">偏度（Skewness）</h4>
<p>偏度是描述某变量取值分布对称性的统计量。公式如下 <span class="math display">\[Skewness=\sum[(\frac{X-\mu}{\delta})^3]\]</span> <img src="http://ortxpw68f.bkt.clouddn.com/Skewness.png"> Skewness=0 分布形态与正态分布偏度相同 Skewness&gt;0 正偏差数值较大，为正偏或右偏。长尾巴拖在右边。 Skewness&lt;0 负偏差数值较大，为负偏或左偏。长尾巴拖在左边。</p>
<h3 id="正态分布检验补充案例">正态分布检验补充案例</h3>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">words1 = rnorm(100)</div><div class="line">words2 = rt(100, df=3)</div><div class="line"></div><div class="line">plot(density(words1))</div><div class="line">lines(density(words2))</div><div class="line">shapiro.test(words1)</div><div class="line">shapiro.test(words2)</div><div class="line"></div><div class="line">par(mfrow=c(2,1))</div><div class="line">qqnorm(words1);qqline(words1, col = 2)</div><div class="line">qqnorm(words2);qqline(words2, col = 2)</div></pre></td></tr></table></figure>
<p>words1与words2密度图如下所示： <img src="http://ortxpw68f.bkt.clouddn.com/test%20normalDistribution.png"></p>
<p>从图上大致可以看出来words1与标准正态图比较接近。</p>
<p>用shapiro检验后的结果如下所示： <img src="http://ortxpw68f.bkt.clouddn.com/test%20normalDistribution2.png"></p>
<p>从计算结果来看，words1是p值为0.09861，大于0.05，不能否定原假定，因此words1符合正态分布。同理,words2不符合正态分布。</p>
<p>QQ图的结果如下所示： <img src="http://ortxpw68f.bkt.clouddn.com/test%20normalDistribution3.png"></p>
<p>从QQ图中可以看出，words1符合正态分布，而words2不符合正态分布。</p>
<h2 id="r语言中进行正态分布检验的其它包">R语言中进行正态分布检验的其它包</h2>
<h3 id="nortest包">nortest包</h3>
<p>lillie.test()可以实行更精确的Kolmogorov-Smirnov检验。</p>
<p>ad.test()进行Anderson-Darling正态性检验。</p>
<p>cvm.test()进行Cramer-von Mises正态性检验。</p>
<p>pearson.test()进行Pearson卡方正态性检验。</p>
<p>sf.test()进行Shapiro-Francia正态性检验。</p>
<h3 id="fbasics包">fBasics包</h3>
<p>ksnormTest() 进行Kolmogorov-Smirnov正态性检验。</p>
<p>shapiroTest() 进行Shapiro-Wilk正态性检验。</p>
<p>jarqueberaTest() 进行jarque-Bera正态性检验。</p>
<p>dagoTest() 进行D’Agostino正态性检验。</p>
<p>adTest() 进行Anderson-Darling正态性检验。</p>
<p>cvmTest() 进行Cramer-von Mises正态性检验。</p>
<p>lillieTest() 进行Lilliefors(KS)正态性检验。</p>
<p>pchiTest() 进行Pearson chi-square正态性检验。</p>
<p>sfTest() 进行Shapiro-Francia正态性检验。</p>
<p>jbTest() Finite sample adjusted JB LM and ALM test。</p>
<p>normalTest() 进行Kolmogorov-Smirnov正态性检验。</p>
<h3 id="jarque-bera-test检验正态分布">Jarque-Bera Test检验正态分布</h3>
<p>Jarque-Bera检验是用于总体分布的正态性检验的一种方式。该检验基于数据样本的偏度和峰度，评价给定数据服从未知均值和方差正态分布的假设是否成立，正态分布的偏度（三阶矩）S=0，峰度（四阶矩）K=3，若样本来自正态总体，则他们分别在0，3附近。基于此构造一个包含x2(卡方)统计量：n为样本容量,k为自由度。代码如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">install.packages(<span class="string">"tseries"</span>)</div><div class="line"><span class="keyword">library</span>(tseries)</div><div class="line">set.seed(<span class="number">1</span>)</div><div class="line">x &lt;- rnorm(<span class="number">150</span>)</div><div class="line">res &lt;- jarque.bera.test(x)</div><div class="line">names(res)</div><div class="line">res$p.value</div></pre></td></tr></table></figure>
<p>运行结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">&gt; set.seed(<span class="number">1</span>)</div><div class="line">&gt; x &lt;- rnorm(<span class="number">150</span>)</div><div class="line">&gt; res &lt;- jarque.bera.test(x)</div><div class="line">&gt; names(res)</div><div class="line">[<span class="number">1</span>] <span class="string">"statistic"</span> <span class="string">"parameter"</span> <span class="string">"p.value"</span>   <span class="string">"method"</span>    <span class="string">"data.name"</span></div><div class="line">&gt; res$p.value</div><div class="line">[<span class="number">1</span>] <span class="number">0.8601533</span></div></pre></td></tr></table></figure>
<p>p值大于0.05，可以视为符合正态分布。</p>
<h2 id="案例第二用jarque-bera-test检验正态分布">案例第二：用Jarque-Bera Test检验正态分布</h2>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">install.packages(<span class="string">"Ecdat"</span>)</div><div class="line"><span class="keyword">library</span>(Ecdat)</div><div class="line">data(SP500)</div><div class="line">class(SP500)</div><div class="line">SPreturn &lt;- SP500$r500</div><div class="line">res &lt;- jarque.bera.test(SPreturn)</div><div class="line">names(res)</div><div class="line">res$p.value</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">&gt; class(SP500)</div><div class="line">[<span class="number">1</span>] <span class="string">"data.frame"</span></div><div class="line">&gt; <span class="keyword">library</span>(Ecdat)</div><div class="line">&gt; data(SP500)</div><div class="line">&gt; class(SP500)</div><div class="line">[<span class="number">1</span>] <span class="string">"data.frame"</span></div><div class="line">&gt; SPreturn &lt;- SP500$r500</div><div class="line">&gt; res &lt;- jarque.bera.test(SPreturn)</div><div class="line">&gt; names(res)</div><div class="line">[<span class="number">1</span>] <span class="string">"statistic"</span> <span class="string">"parameter"</span> <span class="string">"p.value"</span>   <span class="string">"method"</span>    <span class="string">"data.name"</span></div><div class="line">&gt; res$p.value</div><div class="line">[<span class="number">1</span>] <span class="number">0</span></div></pre></td></tr></table></figure>
<h3 id="正态分布检验补充案例-1">正态分布检验补充案例</h3>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">words1 = rnorm(100)</div><div class="line">words2 = rt(100, df=3)</div><div class="line"></div><div class="line">plot(density(words1))</div><div class="line">lines(density(words2))</div><div class="line">shapiro.test(words1)</div><div class="line">shapiro.test(words2)</div><div class="line"></div><div class="line">par(mfrow=c(2,1))</div><div class="line">qqnorm(words1);qqline(words1, col = 2)</div><div class="line">qqnorm(words2);qqline(words2, col = 2)</div></pre></td></tr></table></figure>
<p>words1与words2密度图如下所示： <img src="http://ortxpw68f.bkt.clouddn.com/test%20normalDistribution.png"></p>
<p>从图上大致可以看出来words1与标准正态图比较接近。</p>
<p>用shapiro检验后的结果如下所示： <img src="http://ortxpw68f.bkt.clouddn.com/test%20normalDistribution2.png"></p>
<p>从计算结果来看，words1是p值为0.09861，大于0.05，不能否定原假定，因此words1符合正态分布。同理,words2不符合正态分布。</p>
<p>QQ图的结果如下所示： <img src="http://ortxpw68f.bkt.clouddn.com/test%20normalDistribution3.png"></p>
<p>从QQ图中可以看出，words1符合正态分布，而words2不符合正态分布。</p>
<h2 id="参考资料">参考资料</h2>
<ol style="list-style-type: decimal">
<li><a href="http://blog.sina.com.cn/s/blog_670445240101m4z3.html" target="_blank" rel="external">每日一生信–富集分析（超几何分布）（Fisher’s Exact Test）</a></li>
<li><a href="http://blog.sina.com.cn/s/blog_5d1edf6a0100ujcv.html" target="_blank" rel="external">R 超几何分布</a></li>
<li><a href="https://en.wikipedia.org/wiki/Hypergeometric_distribution" target="_blank" rel="external">Wikipedia:Hypergeometric distribution</a></li>
<li>DawnGriffiths. 深入浅出统计学[M]. 电子工业出版社, 2012.</li>
<li>高桥信陈刚. 漫画统计学[M]. 科学出版社, 2009.</li>
<li>拉里·戈尼克, 沃尔科特·史密斯. 漫画统计学入门[M]. 辽宁教育出版社, 2002.</li>
<li>陈希孺.概率论与数理统计[M].中国科学技术大学出版社,1992.</li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/4/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/4/">4</a><span class="page-number current">5</span><a class="page-number" href="/page/6/">6</a><span class="space">&hellip;</span><a class="page-number" href="/page/16/">16</a><a class="extend next" rel="next" href="/page/6/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">RVDSD</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">151</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">13</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">62</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          <div class="links-of-author motion-element">
            
          </div>

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

<div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">RVDSD</span>

  
</div>



<div class="powered-by">
<i class="fa fa-user-md"></i><span id="busuanzi_container_site_uv">
  本站访客数:<span id="busuanzi_value_site_uv"></span>
</span>
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.3</div>




<div class="theme-info">
  <div class="powered-by"></div>
  <span class="post-count">博客全站共560.8k字</span>
</div>

        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.3"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.3"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.3"></script>



  


  




	





  





  










  
  <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/valine@1.1.4/dist/Valine.min.js"></script>
  <script type="text/javascript">
    new Valine({
        av: AV,
        el: '#vcomments' ,
        verify: true,
        notify: true,
        app_id: '4ORLDMxXCFDLSHPJ4wSSDkkw-gzGzoHsz',
        app_key: 'HSWpCY7XlN0pGV5DCrKoC0ic',
        placeholder: 'Comment input placeholder'
    });
  </script>



  





  

  

  
  

  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config("");
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="custom_mathjax_source">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->
  


  

  

</body>
</html>
