
 <!DOCTYPE HTML>
<html lang="zh-Hans">
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8">
  
    <title>我的笔记</title>
    <meta name="viewport" content="width=device-width, initial-scale=1,user-scalable=no">
    
    <meta name="author" content="RVDSD">
    

    
    <meta property="og:type" content="website">
<meta property="og:title" content="我的笔记">
<meta property="og:url" content="http://rvdsd.top/page/2/index.html">
<meta property="og:site_name" content="我的笔记">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="我的笔记">

    
    <link rel="alternative" href="/atom.xml" title="我的笔记" type="application/atom+xml">
    
    
    <link rel="icon" href="/img/favicon.ico">
    
    
    <link rel="apple-touch-icon" href="/img/jacman.jpg">
    <link rel="apple-touch-icon-precomposed" href="/img/jacman.jpg">
    
    <link rel="stylesheet" href="/css/style.css"><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</head>

  <body>
    <!-- hexo-inject:begin --><!-- hexo-inject:end --><header>
      
<div>
		
			<div id="imglogo">
				<a href="/"><img src="/img/logo.png" alt="我的笔记" title="我的笔记"/></a>
			</div>
			
			<div id="textlogo">
				<h1 class="site-name"><a href="/" title="我的笔记">我的笔记</a></h1>
				<h2 class="blog-motto">学习过程中的输出</h2>
			</div>
			<div class="navbar"><a class="navbutton navmobile" href="#" title="菜单">
			</a></div>
			<nav class="animated">
				<ul>
					<ul>
					 
						<li><a href="/">Home</a></li>
					
						<li><a href="/archives">Archives</a></li>
					
						<li><a href="/about">About</a></li>
					
					<li>
 					
					<form class="search" action="//google.com/search" method="get" accept-charset="utf-8">
						<label>Search</label>
						<input type="search" id="search" name="q" autocomplete="off" maxlength="20" placeholder="搜索" />
						<input type="hidden" name="q" value="site:rvdsd.top">
					</form>
					
					</li>
				</ul>
			</nav>			
</div>
    </header>
    <div id="container">
      <div id="main">

   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2017/07/02/病毒包装笔记(2)-质粒/" title="病毒包装笔记(2)-质粒" itemprop="url">病毒包装笔记(2)-质粒</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="RVDSD" target="_blank" itemprop="author">RVDSD</a>
		
  <p class="article-time">
    <time datetime="2017-07-02T04:00:00.000Z" itemprop="datePublished"> 发表于 2017-07-02</time>
    
  </p>
</header>
    <div class="article-content">
        
        <h2 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h2><p>1952年Joshua Lederberg创造一个词“质粒(Plasmid)”，它指的是任何染色体外的遗传决定物质，共价、闭合、环状双链DNA（cccDNA），大小从1kb~1000kb。质粒是一种独立于染色体外独立复制的双链DNA片段，通常都含有基因。尽管质粒在细菌、古细菌和真核细胞中都有发现，但质粒对于细菌的生物学意义更加重要，因为细菌与细菌之间可以通过鞭毛等相互交换质粒信息，而这种遗传信息的交换是有利的，因为质粒上面含有耐药基因等信息。</p>
<p>但天然存在的野生型质粒有着一些缺点，例如分子量大(＞15kb)、拷贝数低、单一酶切位点少、遗传标记不理想等缺陷，不能满足克隆载体的要求。因此需要进行改造：</p>
<ol>
<li>去除多余的和功能研究无关的片段删除掉，将质粒的长度从15kb缩短到1~5kb。</li>
<li>给它添加上各种元件，例如安装各种酶切位点，遗传标记，例如抗性基因（氨苄霉素、卡那霉素、四环素…）、报告基因（luciferase、EGFP…）等。</li>
</ol>
<h2 id="质粒的分类（原核-真核-穿梭载体）"><a href="#质粒的分类（原核-真核-穿梭载体）" class="headerlink" title="质粒的分类（原核/真核/穿梭载体）"></a>质粒的分类（原核/真核/穿梭载体）</h2><ol>
<li>克隆载体：能带动外源基因，在宿主细胞中复制扩增。它是用来克隆和扩增DNA片段（基因）的载体，这类载体没有启动子等启动转录、翻译的元件。 </li>
<li>表达载体：具有克隆载体的基本元件（ori,Ampr,Mcs等）还具有转录/翻译所必需的DNA序列。 </li>
<li>穿梭载体是指一类人工构建的具有两种不同复制起点和选择标记，因而可以在两种不同类群宿主中存活和复制的质粒载体。此概念不仅用于不同的微生物菌群之间，也可以推广到真核生物表达载体的构建，如用于枯草的pBE2、酵母的pPIC9K、哺乳动物表达载体pMT2 和用于植物细胞的Ti 质粒。这些穿梭载体不仅可以在大肠杆菌中复制扩增，也可以在相应的枯草、酵母、动物或植物细胞中扩增和表达。这样利于对质粒的分子生物学操作和大量制备。</li>
<li>基因下调载体：用于减少某个内源基因的表达，该载体上含有针对目标基因mRNA的shRNA，起到基因沉默的作用，下调基因的蛋白表达。 </li>
<li>病毒质粒：基于病毒的基因组改造而成的质粒，可以独立包装成为病毒颗粒，巧妙地去除了病毒的感染致病性却保留了病毒的其他功能，为功能基因的灵活进入细胞并整合到基因组中提供了非常方便的工具。</li>
</ol>
<h2 id="质粒的命名"><a href="#质粒的命名" class="headerlink" title="　质粒的命名"></a>　质粒的命名</h2><p>pUC19、pEGFP-N3。小写字母p代表质粒”plasmid”，2~4个大写字母代表发明者、实验室名称或者其他表型性状（EGFP是增强型绿色荧光蛋白）。</p>
<h2 id="质粒图谱"><a href="#质粒图谱" class="headerlink" title="质粒图谱"></a>质粒图谱</h2><h3 id="质粒图谱如下所示：第一张图："><a href="#质粒图谱如下所示：第一张图：" class="headerlink" title="质粒图谱如下所示：第一张图："></a>质粒图谱如下所示：第一张图：</h3><p><img src="http://ortxpw68f.bkt.clouddn.com/pl.png" alt=""></p>
<hr>
<h3 id="质粒图谱：第二张图："><a href="#质粒图谱：第二张图：" class="headerlink" title="质粒图谱：第二张图："></a>质粒图谱：第二张图：</h3><p><img src="http://ortxpw68f.bkt.clouddn.com/pw.jpg" alt=""></p>
<ol>
<li><p>箭头。大多数质粒都会有箭头，箭头有两种解释。一种是代表转录方向，转录方向主要是由启动子开始的一个大箭头，是启动子启动序列的顺序。另一种是复制起始位点的方向，复制起始位点就是该质粒在大肠杆菌等细菌或真菌中DNA复制的一个方向。我们还需要提到的是F1启动子（图上的f1 ori）代表的是噬菌体的复制起始方向，只能复制出单链的DNA哦，但是可以用来测序。看懂转录的方向，这样就方便设计插入片段的位置和方向性。复制起始位点Ori，了解质粒的类型（原核/真核/穿梭质粒）：招募复制蛋白，进行质粒的自我复制，增加拷贝数，随着细胞的增殖而增殖；</p>
</li>
<li><p>抗性基因：加抗性基因的原因是因为质粒对于一般细胞来讲不是必需元件，在没有抗生素的培养基中不断增殖的过程中，质粒载体慢慢就丢失了，只有培养基里面加入抗生素，抗性基因赋予宿主菌分解抗生素的能力，细胞才会需要该质粒。常见抗性基因有：<strong>Ampr</strong> 水解β－内酰胺环，解除氨苄的毒性；<strong>tetr</strong> 可以阻止四环素进入细胞；<strong>camr</strong> 生成氯霉素羟乙酰基衍生物，使之失去毒性；<strong>neor（kanr）</strong> 氨基糖苷磷酸转移酶 使G418（长那霉素衍生物）失活。</p>
</li>
<li><p>多克隆位点（MCS）：它具有多个限制内切酶的单一切点，便于要研究的基因的插入。如果在这些位点外有外源基因的插入，会导致某种标志基因的失活，而便于筛选，最常见的是β-半乳糖苷酶的蓝白斑筛选系统。</p>
</li>
<li><p>是否含有表达系统元件，即启动子（promoter）－核糖体结合位点（RBS）－转录终止信号（AATAAA同时是poly A）。这是用来区别克隆载体与表达载体。克隆载体中加入一些与表达调控有关的元件即成为表达载体。选用那种载体，还是要以实验目的为准绳。<strong>启动子</strong>是促进DNA转录的DNA顺序，这个DNA区域常在基因或操纵子编码顺序的上游，是DNA分子上可以与RNApol特异性结合并使之开始转录的部位，但启动子本身不被转录。<strong>增强子/沉默子</strong>－是真核基因组（包括真核病毒基因组）中的一种具有增强邻近基因转录过程的调控顺序。其作用与增强子所在的位置或方向无关。即在所调控基因上游或下游均可发挥作用。/沉默子－负增强子，负调控序列。<strong>克核糖体结合位点/起始密码/SD序列（Rbs/AGU/SDs）</strong>：mRNA有核糖体。<strong>转录终止顺序（终止子）/翻译终止密码子</strong>结构基因的最后一个外显子中有一个AATAAA的保守序列，此位点down－stream有一段GT或T富丰区，这2部分共同构成poly（A）加尾信号。结构基因的最后一个外显子中有一个AATAAA的保守序列，此位点down－stream有一段GT或T富丰区，这2部分共同构成poly（A）加尾信号。</p>
</li>
<li>报告基因：例如β-半乳糖苷酶、EGFP、luciferase等，便于迅速检查功能基因是否表达的阳性判断，表达成功的蛋白在小鼠体内分布位置，直接看EGFP、luciferase的荧光就ok。</li>
<li>引物结合区（primer）：一般位于多克隆位点区的上、下游，便于通用引物的PCR验证、测序验证之用。</li>
</ol>
<h2 id="质粒的查询"><a href="#质粒的查询" class="headerlink" title="质粒的查询"></a>质粒的查询</h2><p>Vectorpedia<br><a href="http://www.addgene.org/pgvec1?f=v&amp;cmd=listvecinfo" target="_blank" rel="external">http://www.addgene.org/pgvec1?f=v&amp;cmd=listvecinfo</a></p>
<p>google<br>检索式子：质粒名 ＋ map<br>质粒名 ＋sequence ＋filetype:txt or filetype:pdf 或者：进入 google，点击图片搜索，直接查找图谱。</p>
<p>google scholar<br>有些质粒是经过改造的，所以通过上述方法不能查询到相应信息。这时，可以在 google scholar 中输入质粒名称，可以直观地看哪些学者在何文章中使用了该质粒，从而可了解到质粒的来源; 或者籍此向作者咨询或索取。</p>
<p>大量图谱：<a href="http://www.embl-hamburg.de" target="_blank" rel="external">http://www.embl-hamburg.de</a></p>
<p>PET 系列载体信息：<a href="http://www.merckbiosciences.com/g.asp?f=NVG/pETtable.html" target="_blank" rel="external">http://www.merckbiosciences.com/g.asp?f=NVG/pETtable.html</a></p>
<h2 id="转染"><a href="#转染" class="headerlink" title="转染"></a>转染</h2><p>以转染293T细胞为例，使用Lipofiter (汉恒)/DNA转染试剂（biotool），或lipo2000/3000，Fugen HD等转染试剂。</p>
<p>参考资料</p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/生物实验笔记/">生物实验笔记</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/分子生物学/">分子生物学</a><a href="/tags/病毒包装/">病毒包装</a><a href="/tags/生物工具/">生物工具</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2017/07/01/病毒包装笔记(1)-慢病毒/" title="病毒包装笔记(1)-慢病毒" itemprop="url">病毒包装笔记(1)-慢病毒</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="RVDSD" target="_blank" itemprop="author">RVDSD</a>
		
  <p class="article-time">
    <time datetime="2017-07-01T04:00:00.000Z" itemprop="datePublished"> 发表于 2017-07-01</time>
    
  </p>
</header>
    <div class="article-content">
        
        <h2 id="慢病毒背景"><a href="#慢病毒背景" class="headerlink" title="慢病毒背景"></a>慢病毒背景</h2><p>慢病毒包括<strong>灵长类慢病毒</strong>，如人类免疫缺陷病毒(HIV)和猴免疫缺陷病毒(SIV)，以及<strong>非灵长类慢病毒</strong>如猫免疫缺陷病毒(FIV)、马传染性贫血病毒(EIAV)、牛免疫缺陷病毒(BIV)和<strong>维斯纳-梅迪病毒(VMV)</strong>等。目前，HIV-1、HIV-2、SIV、FIV及EIAV被广泛研究用作基因治疗的载体，而其中又以HIV-1最为热门。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">注：慢病毒的英文是lentivirus，它是反转录病毒科下的一个属，此属病毒的特征是需要较长的时间才能培养出来，例如人类免疫缺陷病毒(HIV)、猴免疫缺陷病毒(SIV)、猫免疫缺陷病毒(FIV)都是慢病毒属，慢病毒属的原文是Lentivirus，其中Lenti-在拉丁文中有慢的意思，因此称为慢病毒。慢病毒属可以由宿主细胞直接感染周围的细胞，不必经由形成病毒颗粒此一步骤。它一般的逆转录病毒载体不同，慢病毒对分裂细胞和非分裂细胞均具有感染能力。由于这一特点目前慢病毒也被广泛地应用于表达RNA干预的研究中。慢病毒属是反转录病毒科下的一个属，此属病毒的特征是需要较长的时间才能培养出来，例如人类免疫缺陷病毒(HIV)、猴免疫缺陷病毒(SIV)、猫免疫缺陷病毒(FIV)都是慢病毒属，慢病毒属的原文是Lentivirus，其中Lenti-在拉丁文中有慢的意思。</div></pre></td></tr></table></figure>
<h2 id="HIV-1病毒形态与结构"><a href="#HIV-1病毒形态与结构" class="headerlink" title="HIV-1病毒形态与结构"></a>HIV-1病毒形态与结构</h2><p>现在的慢病毒包装系统通常是由HIV-1病毒改造而来的，因此有必要了解一下HIV-1的结构与功能。HIV-1的基因组由两条相同的正股RNA链在5′端通过部分碱基互补配对而成二聚体。病毒基因组全长约9200bp，含有gag、pol、env 3个结构基因以及tat、rev、nef、vif、vpr、vpu6个调节基因。在病毒基因组的5′端和3′端各有相同的一段核苷酸序列，称为长末端重复序列(longterminalrepeat，LTR)。</p>
<h3 id="HIV-1的病毒结构如下所示"><a href="#HIV-1的病毒结构如下所示" class="headerlink" title="HIV-1的病毒结构如下所示"></a>HIV-1的病毒结构如下所示<img src="http://ortxpw68f.bkt.clouddn.com/HIV-1.png" alt=""></h3><h4 id="各个元件的作用："><a href="#各个元件的作用：" class="headerlink" title="各个元件的作用："></a>各个元件的作用：</h4><h5 id="编码病毒的基本结构："><a href="#编码病毒的基本结构：" class="headerlink" title="编码病毒的基本结构："></a>编码病毒的基本结构：</h5><ol>
<li>gag基因编码病毒的核心蛋白，即p55的蛋白前体，经蛋白酶裂解而形成病毒的核衣壳蛋白(p7)、内膜蛋白(p17)和衣壳蛋白(p24)。</li>
<li>pol基因编码病毒复制所需的酶类。</li>
<li>env基因编码病毒的包膜糖蛋白，决定病毒感染宿主的靶向性。编码p55的蛋白前体，经蛋白酶裂解而形成病毒的核衣壳蛋白(p7)、内膜蛋白(p17)和衣壳蛋白(p24)。</li>
</ol>
<h5 id="调节基因"><a href="#调节基因" class="headerlink" title="调节基因"></a>调节基因</h5><ol>
<li>tat基因编码的gp14是一种反式激活的转录因子，与LTR结合后能促进病毒所有基因的转录。</li>
<li>rev基因编码的产物gp19能促进未经拼接的大mRNA分子从细胞核向胞浆转运，并相对减少拼接后小mRNA分子的数量。</li>
<li>nef基因编码负调节蛋白，对病毒的结构蛋白和调节蛋白的表达均有下调作用。</li>
<li>vif编码产物与病毒体的感染性有关，vpu产物与病毒的装配、成熟和释放有关，而vpr编码产物的功能尚不清楚。</li>
</ol>
<h2 id="HIV-1生活史"><a href="#HIV-1生活史" class="headerlink" title="HIV-1生活史"></a>HIV-1生活史</h2><p>　　HIV-1病毒通过gp120与宿主细胞的CD4分子和趋化因子受体结合，然后将病毒的基因(RNA)、蛋白及酶等释放到宿主细胞内;随后，逆转录酶将病毒RNA转录成DNA，病毒DNA在整合酶的作用下插入宿主细胞核的基因组中，此时的病毒DNA也称为原病毒;紧接着，原病毒转录成mRNA，mRNA从细胞核进入细胞质，并利用宿主细胞的原料合成病毒的各种成分(蛋白质)，新合成的各种蛋白、酶及RNA等聚集在宿主细胞的膜下，病毒的包膜蛋白(gp120，gp41)插入宿主细胞的细胞膜并形成一种未成熟的病毒(<strong>此时病毒无传染性，这也是包病毒中病毒包膜质粒的作用</strong>);最后蛋白酶将病毒核心中的许多过长的蛋白及酶切短，便形成成熟的病毒。病毒利用宿主细胞的细胞膜将自己包被起来，离开该细胞去寻找新的宿主。</p>
<h2 id="慢病素是操作基因的工具"><a href="#慢病素是操作基因的工具" class="headerlink" title="慢病素是操作基因的工具"></a>慢病素是操作基因的工具</h2><h3 id="引入外源基因"><a href="#引入外源基因" class="headerlink" title="引入外源基因"></a>引入外源基因</h3><p>慢病毒和逆转录病毒基因递送系统利用了逆转录病毒复制方面的性质以获得目标核酸序列稳定的整合。核酸转染只能获得瞬时的转基因表达（这种转染能在宿主细胞中引入外源基因，但无法稳定遗传），而基于逆转录病毒和慢病毒的系统却可以获得外源基因稳定的整合，外源基因于是被遗传下去随重复的细胞分裂持续表达。慢病毒和逆转录病毒载体的一个重要特征是他们产生的是复制有缺陷的，即自身无活性的病毒颗粒。这使得目标序列得以转运，而在目标细胞中不存在连续的病毒复制。</p>
<h3 id="用于RNAi的研究"><a href="#用于RNAi的研究" class="headerlink" title="用于RNAi的研究"></a>用于RNAi的研究</h3><p>慢病毒也被广泛地应用于表达RNAi的研究中。由于有些类型细胞脂质体转染效果差，转移到细胞内的siRNA半衰期短，体外合成siRNA对基因表达的抑制作用通常是短暂的，因而使其应用受到较大的限制。采用事先在体外构建能够表达siRNA的载体, 然后转移到细胞内转录siRNA的策略，不但使脂质体有效转染的细胞种类增加，而且对基因表达抑制效果也不逊色于体外合成siRNA，在长期稳定表达载体的细胞中，甚至可以发挥长期阻断基因表达的作用。在所构建的siRNA表达载体中，是由rna聚合酶Ⅲ启动子来指导RNA合成的，这是因为RNA聚合酶Ⅲ有明确的起始和终止序列，而且合成的RNA不会带poly A尾。当RNA聚合酶Ⅲ遇到连续4个或5个T时，它指导的转录就会停止，在转录产物3’端形成1~4个U。U6和H1 RNA启动子是两种RNA聚合酶Ⅲ依赖的启动子，其特点是启动子自身元素均位于转录区的上游，适合于表达～21ntRNA和～50ntRNA茎环结构(stem loop)。在siRNA表达载体中，构成siRNA的正义与反义链，可由各自的启动子分别转录,然后两条链互补结合形成siRNA;也可由载体直接表达小发卡状RNA(small hairpin RNA, shRNA), 载体包含位于RNA聚合酶Ⅲ启动子和4～5T转录终止位点之间的茎环结构序列，转录后即可折叠成具有1~4 个U 3 ’突出端的茎环结构，在细胞内进一步加工成siRNA。构建载体前通常要通过合成siRNA的方法，寻找高效的siRNA，然后从中挑选符合载体要求的序列，将其引入siRNA表达载体。</p>
<h2 id="慢病毒载体的构建"><a href="#慢病毒载体的构建" class="headerlink" title="慢病毒载体的构建"></a>慢病毒载体的构建</h2><p>慢病毒载体（Lentiviral vector,LVs）是在HIV-1病毒基础上改造而成的病毒载体系统，它能高效的将目的基因（或RNAi）导入动物和人的原代细胞或细胞系。慢病毒载体基因组是正链RNA，其基因组进入细胞后，在细胞浆中被其自身携带的反转录酶反转为DNA，形成DNA整合前复合体，进入细胞核后，DNA整合到细胞基因组中。整合后的DNA转录mRNA，回到细胞浆中，表达目的蛋白；或产生RNAi干扰。</p>
<h3 id="慢病毒包装系统的组成"><a href="#慢病毒包装系统的组成" class="headerlink" title="慢病毒包装系统的组成"></a>慢病毒包装系统的组成</h3><p>该系统由<strong>[1]包装质粒、[2]载体质粒、[3]包膜质粒及</strong>3种质粒组成。</p>
<p><strong>包装质粒</strong>：这一部分能够表达出各种病毒酶蛋白。包装质粒由HIV基因组去除了包装、逆转录和整合所需的顺式作用序列而构建，能够反式提供产生病毒颗粒所必需的蛋白表达HIV复制所需的全部反式激活蛋白，但不产生病毒包膜蛋白及辅助蛋白vpu。它由HIV前病毒基因组作简单修改得到，其5′端LTR由（LTR本身也有启动子活性）异源病毒启动子/增强子元件取代。为了防止来自辅助质粒的RNA衣壳化，特意将5′端主要剪接供体位点(splice donor site)和gag编码序列起始端之间的包装信号区(E/Ψ region)删除，而下游的启动子由外源多聚腺苷酸信号(polyA)取代。另外利用点突变将env编码序列打断，但仍然保留rev反应元件。这样的辅助结构能表达所有的病毒蛋白，包括tat及rev(env除外)。</p>
<p><strong>载体质粒</strong>：该质粒用于将目标基因递送至靶细胞。载体成分与包装成分互补，即含有包装、逆转录和整合所需的HIV顺式作用序列，同时具有异源启动子控制下的多克隆位点及在此位点插入的目的基因。为降低载体质粒与包装质粒这两种成分同源重组恢复成野生型病毒的可能，因此需尽量减少两者的同源性，例如将包装成分上5′LTR换成巨细胞病毒(CMV)早期启动子、3′LTR换成SV40 polyA等。它携带了5′端LTR和全部5′端非翻译区域(包括gag编码序列的350个核苷酸)，另外还带有rev应答元件(Revresponsiveelement，RRE)及3′端LTR，其瞬时表达盒采用巨细胞病毒(CMV)启动子及增强子元件，在某些研究领域，可以携带绿色荧光蛋白基因、荧光素酶基因或半乳糖苷酶基因作为生物标记。</p>
<p><strong>包膜质粒</strong>:病毒载体可以借助其他病原体的外壳蛋白包装成假病毒，以改变其嗜性。最常用的是疱疹性口腔炎病毒膜融合包膜G糖蛋白（VSV-G）。,env由单独的包膜质粒携带并在病毒生产过程中共转染后表达。本系统包膜质粒的改进之处在于，引入了VSV-G基因表达包膜结构，这样做的结果至少具有3个方面的积极意义:</p>
<p>①包膜的更换进一步降低了HIV-1载体恢复成野生型病毒的可能;<br>②使HIV载体感染宿主的范围不再仅限于CD4+细胞，而扩大到几乎能感染所有组织来源的细胞;<br>③VSV的包膜赋予HIV载体颗粒高度的稳定性，使其能够通过超速离心而浓缩，达到高滴度。使HIV-1载体滴度由105转录单位(TU)/ml达到108TU/ml。这样的改进无疑是HIV载体系统走向应用而迈出的一大步。</p>
<h4 id="第二代HIV-1来源的慢病毒载体"><a href="#第二代HIV-1来源的慢病毒载体" class="headerlink" title="第二代HIV-1来源的慢病毒载体"></a>第二代HIV-1来源的慢病毒载体</h4><p>　　尽管第一代载体产生RCR的几率极小，仍然不能忽略产生的可能性。毕竟包装质粒可以表达除env外所有HIV-1病毒蛋白，其中部分蛋白与HIV-1的毒力密切相关，且已发现部分蛋白对细胞存在潜在的毒害作用，比如:vpr可引起细胞周期停滞，vif能抑制某些细胞的生长而Nef能引起凋亡。1997年，Zufferey等将包装质粒上的vif、vpr、vpu和nef基因敲除，从而得到第二代慢病毒载体，而其他方面与上述第一代载体系统一致。研究发现即使全部4个调节基因都被敲除。病毒颗粒的产量也不会受到影响。这种载体仍然具有体外感染非分裂期细胞、在体感染分化成熟大鼠神经元的能力，但是目前尚不能确定这种载体是否能转染全部种类细胞。由于敲除的调节基因与野生型HIV-1病毒的生活周期以及毒力密切相关，所以这些载体即使发生多位点重组形成RCR，亲代病毒仍不具有致病性。</p>
<h4 id="第三代HIV-1来源的慢病毒载体"><a href="#第三代HIV-1来源的慢病毒载体" class="headerlink" title="第三代HIV-1来源的慢病毒载体"></a>第三代HIV-1来源的慢病毒载体</h4><p>　　利用慢病毒来源的包装系统的最大问题在于生产过程中可能产生复制型病毒。当质粒DNA转染进入包装细胞，以及辅助质粒及载体质粒的RNA包装入同一病毒颗粒时，将有可能发生重组。减少这种可能性的方法之一就是减少辅助质粒与载体质粒的同源性。另一个方法便是将gag/pol和rev编码序列隔离，分散在不同的质粒。这样的包装系统需要四质粒来代替原有的三质粒包装系统。质粒一携带了gag/pol编码序列及RRE;质粒二包含了编码rev的序列;质粒三是载体质粒;质粒四表达env。采用四质粒代替三质粒系统、除去tat均减少了产生复制型病毒的可能性，从而增加了载体系统的安全性。</p>
<h4 id="自身失活型-SIN-慢病毒载体"><a href="#自身失活型-SIN-慢病毒载体" class="headerlink" title="自身失活型(SIN)慢病毒载体"></a>自身失活型(SIN)慢病毒载体</h4><p>　　由于具有逆转录方式的特点，在逆转录过程中存在于病毒基因组3′端U3区的启动子/增强子元件将被复制，并置于前病毒两端的LTR。因此，3′LTR的U3区启动子发生失活突变后，将在逆转录过程中转移至5′LTR。如果这样的载体整合入靶细胞，将不会产生完整长度的载体RNA，因此命名为“自身失活型载体”。这种技术最先应用于莫洛尼氏小鼠白血病病毒(MoMLV)载体和鸟类的脾坏死病毒(SNV)载体。进一步研究表明，U3区的频繁突变将导致病毒滴度下降，原因是该区域的某些序列是载体有效多聚腺苷酸化所必需的。在HIV-1基因组内，核心多聚腺苷酸化信号存在R区。现已证实，U3区序列能影响多聚腺苷的酸化效率。与MoMLV相比，将HIV-1的3′LTRU3区(除上述多聚腺苷酸化增强相关序列，以及病毒整合酶识别的U3区5′末端外)删除后并不会影响滴度。这种删除能确保病毒RNA逆转录并整合入靶细胞染色体后，从5′LTR端启动子起始的复制被有效抑制。这种设计的另一个优势是能增强瞬时表达效率，这可能与减少了病毒LTR和细胞启动子之间的启动子竞争有关。</p>
<h3 id="慢病毒载体的包装"><a href="#慢病毒载体的包装" class="headerlink" title="慢病毒载体的包装"></a>慢病毒载体的包装</h3><p>　　大部分研发人员目前都使用瞬时转染293T细胞的方式生产病毒载体。这种方法的缺点在于生产获得的病毒载体可能会出现有缺陷的基因组。为了生产高质量的载体，必须筛选合适的包装细胞系，而建立包装细胞系的最大难点在于某些病毒蛋白具有细胞毒性。比如，vpr能诱导细胞停滞在G2期，不利于建立vpr蛋白高表达的细胞系，病毒蛋白水解酶同样能水解细胞内的蛋白，不利于建立稳定表达病毒gag-pol蛋白的细胞系;VSV-G蛋白的表达同样对细胞具有毒性。目前，为了建立合适的慢病毒载体包装细胞系，许多科学家都在尝试使用诱导型或可调节的启动子来克服病毒蛋白的细胞毒作用。</p>
<h2 id="慢病毒的包装过程"><a href="#慢病毒的包装过程" class="headerlink" title="慢病毒的包装过程"></a>慢病毒的包装过程</h2><h3 id="所用质粒"><a href="#所用质粒" class="headerlink" title="所用质粒"></a>所用质粒</h3><p>本实验室现在使用的慢病毒包装系统为三质粒系统，三个质粒分别为①psPAX2（包装质粒），②pMD2G（包膜质粒），③目的质粒（载体质粒）。从网上的信息来看，这是第二代慢病毒包装系统。</p>
<h3 id="慢病毒载体滴度的测定"><a href="#慢病毒载体滴度的测定" class="headerlink" title="慢病毒载体滴度的测定"></a>慢病毒载体滴度的测定</h3><p>　　慢病毒载体滴度可以参考腺病毒载体滴度的检测方法，将病毒与293细胞共培养后，通过流式细胞仪检测GFP蛋白表达水平来分析病毒滴度，病毒滴度为表达GFP的细胞数乘以相应稀释倍数。另外，还可以通过TaqManPCR检测细胞中病毒拷贝数的方法检测滴度。</p>
<h3 id="病毒包装的简单流程"><a href="#病毒包装的简单流程" class="headerlink" title="病毒包装的简单流程"></a>病毒包装的简单流程</h3><p>本文只是背景资料搜集，因此不涉及具体的实验操作。大致操作如下：</p>
<ol>
<li><strong>转化</strong>：目的在于将质粒进行扩增，质粒的本质就是DNA，在一定条件下可以进行大量扩增，因此在拿到质粒的第一件事情就是先扩增出大量的质粒进行备份（前提是这个质粒的序列是对的）；常用的宿主细胞是DHalpha大肠杆菌。</li>
<li>孵育293FT细胞。细胞株293T，慢病毒的包装细胞，为贴壁依赖型成上皮样细胞，生长培养基为DMEM(含10%FBS)。贴壁细胞经培养生长增殖形成单层细胞。菌株大肠杆菌菌株DH5α。用于扩增慢病毒载体和辅助包装载体质粒。这种细胞是已经被筛选出来专门用来合成病毒的。将1中的质粒转染到293FT细胞中，进入病毒包装，提取病毒，进入下一步的转染操作。</li>
<li>目的细胞：就是自己最终实验所用到的细胞，例如DC2.4细胞。将包装好的病毒对目的细胞进行感染。</li>
<li>分离目的细胞：质粒上通常带有报告基因，例如GFP，成功被病毒感染的细胞通常会表达这些绿色荧光蛋白，通过FACS就可以将细胞进行筛选出来，然后继续养细胞，长到一定密度后，再通常一定手段（例如WB或qPCR来鉴定目的基因是否导入或者是目的基因是否被敲除，这取决于具体的实验设计）。</li>
</ol>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/生物实验笔记/">生物实验笔记</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/分子生物学/">分子生物学</a><a href="/tags/病毒包装/">病毒包装</a><a href="/tags/生物工具/">生物工具</a><a href="/tags/知识背景/">知识背景</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2017/06/28/文献笔记-巨噬细胞/" title="巨噬细胞" itemprop="url">巨噬细胞</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="RVDSD" target="_blank" itemprop="author">RVDSD</a>
		
  <p class="article-time">
    <time datetime="2017-06-28T04:00:00.000Z" itemprop="datePublished"> 发表于 2017-06-28</time>
    
  </p>
</header>
    <div class="article-content">
        
        <p>主要文献信息：<br>Ginhoux, F., et al. (2016). “New insights into the multidimensional concept of macrophage ontogeny, activation and function.” Nat Immunol 17(1): 34-40.</p>
<h2 id="巨噬细胞分类"><a href="#巨噬细胞分类" class="headerlink" title="巨噬细胞分类"></a>巨噬细胞分类</h2><p>经典活化型：LPS与IFN-gamma的刺激会诱导一个炎症表型，它能促进TH1应答，有抗菌，抗肿瘤的特性。这种表型称为“经典活化型”，即M1型（classically activated macrophage）。Adams,  D.O.  &amp;  Hamilton,  T.A.  The  cell  biology  of  macrophage  activation.  Annu. Rev. Immunol. 2, 283–318 (1984).</p>
<p>替代活化型巨噬细胞：IL-4或IL-13刺激，特征是产生促炎细胞因子，偏向精氨酸代谢为鸟氨酸（ornithine），表达精氨酸酶，清道夫受体表达增加，吞噬活性增强。即M2型。Stein,  M.,  Keshav,  S.,  Harris,  N.  &amp;  Gordon,  S.  Interleukin  4  potently  enhances murine macrophage mannose receptor activity: a marker of alternative immunologic macrophage activation. J. Exp. Med. 176, 287–292 (1992).</p>
<h2 id="小鼠品系差异"><a href="#小鼠品系差异" class="headerlink" title="小鼠品系差异"></a>小鼠品系差异</h2><p>C57BL/6小鼠的巨噬细胞经LPS刺激后可以将精氨酸代谢为NO，在LPS与IFN-gamma处理后表现出TH1样细胞因子的应答。BALB/c小鼠的巨噬细胞偏向于TH2应答，它将精氨酸代谢为鸟氨酸。因此巨噬细胞分为M1型和M2型。Mills, C.D., Kincaid, K., Alt, J.M., Heilman, M.J. &amp; Hill, A.M. M-1/M-2 macrophages and the Th1/Th2 paradigm. J. Immunol. 164, 6166–6173 (2000).这样划分主要是依照TH1和TH2细胞的应答进行的。</p>
<h2 id="M2细胞的严密划分"><a href="#M2细胞的严密划分" class="headerlink" title="M2细胞的严密划分"></a>M2细胞的严密划分</h2><p>M2细胞红抗炎因子现后表现出一些精密的不同，因此可以进一步划分，即M2a（由IL-4或IL-13诱导），M2b（IL-10诱导），M2c（免疫复合物与LPS诱导）。 Mantovani,  A.  et  al.  The  chemokine  system  in  diverse  forms  of  macrophage<br>activation and polarization. Trends Immunol. 25, 677–686 (2004).</p>
<h2 id="M1-M2划分的不足"><a href="#M1-M2划分的不足" class="headerlink" title="M1-M2划分的不足"></a>M1-M2划分的不足</h2><p>某些疾病中的巨噬细胞不明确地表现出M1和M2表型。<strong>(1)</strong> Egawa, M. et al. Inflammatory monocytes recruited to allergic skin acquire an anti-inflammatory  M2  phenotype  via  basophil-derived  interleukin-4.  Immunity  38, 570–580 (2013).<strong>(2)</strong>Arnold,  L.  et  al.  Inflammatory  monocytes  recruited  after  skeletal  muscle  injury switch  into  antiinflammatory  macrophages  to  support  myogenesis.  J.  Exp.  Med. 204, 1057–1069 (2007).<strong>(3)</strong>Nahrendorf,  M.  &amp;  Swirski,  F.K.  Monocyte  and  macrophage  heterogeneity  in  the heart. Circ. Res. 112, 1624–1633 (2013).</p>
<p>巨噬细胞的微环境决定了巨噬细胞的表型。</p>
<p>除了以下的情况以外，单核细胞不会参与组织巨噬细胞的稳态：肠道，皮肤，心脏（在这三个地方，单核细胞会分化为巨噬细胞）。<strong>(1)</strong>Bain, C.C. et al. Constant replenishment from circulating monocytes maintains the macrophage  pool  in  the  intestine  of  adult  mice.  Nat.  Immunol.  15,  929–937 (2014).<strong>(2)</strong>Tamoutounour, S. et al. Origins and functional specialization of macrophages and of conventional and monocyte-derived dendritic cells in mouse skin. Immunity 39,925–938 (2013).<strong>(3)</strong>Epelman, S. et al. Embryonic and adult-derived resident cardiac macrophages are maintained through distinct mechanisms at steady state and during inflammation. Immunity 40, 91–104 (2014).<br>在一些炎症中，源于胚胎祖细胞的巨噬细胞可以自我更新。 Ginhoux, F. &amp; Jung, S. Monocytes and macrophages: developmental pathways and tissue homeostasis. Nat. Rev. Immunol. 14, 392–404 (2014).</p>
<h2 id="巨噬细胞起源"><a href="#巨噬细胞起源" class="headerlink" title="巨噬细胞起源"></a>巨噬细胞起源</h2><p>参见fig.1<img src="http://ortxpw68f.bkt.clouddn.com/macrophage.png" alt=""></p>
<p>巨噬细胞起源有：（1）</p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/文献笔记/">文献笔记</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/基础知识/">基础知识</a><a href="/tags/天然免疫/">天然免疫</a><a href="/tags/实验方法/">实验方法</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2017/06/28/文献笔记-中性粒细胞/" title="中性粒细胞笔记" itemprop="url">中性粒细胞笔记</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="RVDSD" target="_blank" itemprop="author">RVDSD</a>
		
  <p class="article-time">
    <time datetime="2017-06-28T04:00:00.000Z" itemprop="datePublished"> 发表于 2017-06-28</time>
    
  </p>
</header>
    <div class="article-content">
        
        <h2 id="中性粒细胞背景"><a href="#中性粒细胞背景" class="headerlink" title="中性粒细胞背景"></a>中性粒细胞背景</h2><p>中性粒细胞（neutrophils）是循环中白细胞中最非常的细胞。19世纪晚期，Paul Ehrlich用新发明的细胞染色方法研究白细胞（leukocytes）中的亚群，他发现白细胞中存在着一些亚群，其中的一类他称为“多型核细胞”（polymorphous nucleus），即中性粒细胞。</p>
<h2 id="中性粒细胞特征"><a href="#中性粒细胞特征" class="headerlink" title="中性粒细胞特征"></a>中性粒细胞特征</h2><ol>
<li>细胞核呈多核；</li>
<li>含有颗粒状的细胞质，里面含有抗菌物质。</li>
<li>细胞数量：小鼠循环血液中占30%，人类的则占70%.</li>
</ol>
<h2 id="活化"><a href="#活化" class="headerlink" title="活化"></a>活化</h2><p>炎症部位，细菌来源的物质以及宿主产生的炎症信号非常丰富。这些物质及信号包括LPS，fMLP，TNF-alpha，IL-1beta，IL-17会促进内皮细胞产生黏附因子（adhesion），即P-选择素，E-选择素，一些整合素家族的成员（ICAMs）。中性粒细胞表面有两个分子：PSGL-1，L-选择素，这两个分子可以识别内皮细胞的炎症信号，一旦中性粒细胞与内皮细胞随机接触，这两个物质就分别与P选择素和E选择素结合，将中性粒细胞固定在内皮表面。接着中性粒细胞会在内皮表面进行翻滚。</p>
<p>PSGL-1和L-选择素的接触会诱导各种激酶的活化，包括Src家族汽配Syk，还有PI3K，以及p3丝裂原激活蛋白激酶，这种级联反应会改变中性粒细胞的生物学特征，并使细胞进入整合素活化阶段，产生更牢固的黏附。</p>
<p>牢固结合的阶段是由beta2整合素家族蛋白介导的（LFA-a和Mac-1），牢固结合之后就是跨内皮细胞的迁移。随着中性粒细胞在内皮上的翻滚，加上趋化因子，细胞因子，细胞产物的作用，中性粒细胞表面的beta2整合素开始聚合，它的配体是ICAM-1。之后，中性粒细胞产生尖锐边缘的片足，趋化因子受体和吞噬受体会在片足上集合，细胞骨架会重构，向着趋化因子浓度梯度的方向进行迁移，从而诱发中性粒细胞的氧爆作用(oxidative burst)。</p>
<p>中性粒细胞的招募示意图如下所示：<img src="http://ortxpw68f.bkt.clouddn.com/Neutrophil%20recruitment%20to%20sites%20of%20in%EF%AC%82ammation..png" alt=""><br>NET为neutrophil extracellular traps。</p>
<h2 id="中性粒细胞的杀菌物质"><a href="#中性粒细胞的杀菌物质" class="headerlink" title="中性粒细胞的杀菌物质"></a>中性粒细胞的杀菌物质</h2><p>三种颗粒：</p>
<ol>
<li>Azurophilic granules (嗜天青颗粒，也称为as peroxidase-positive或primary granules) ，尺寸最大，直径约为0.3 μM，这是中性粒细胞成熟中最先生成的颗粒，含有 myeloperoxidase (MPO)。</li>
<li>specific颗粒</li>
<li>gelatinase颗粒。</li>
<li><img src="http://ortxpw68f.bkt.clouddn.com/Neutrophil%20granules..png" alt=""></li>
</ol>
<h2 id="中性粒细胞的分离"><a href="#中性粒细胞的分离" class="headerlink" title="中性粒细胞的分离"></a>中性粒细胞的分离</h2><p>根据中性粒细胞的来源（外周血，骨髓，腹腔），中性粒细胞的分离有三种方法：</p>
<h3 id="从骨髓中分离中性粒细胞"><a href="#从骨髓中分离中性粒细胞" class="headerlink" title="从骨髓中分离中性粒细胞"></a>从骨髓中分离中性粒细胞</h3><h4 id="实验原理"><a href="#实验原理" class="headerlink" title="实验原理"></a>实验原理</h4><p>Histopaque主要由葡聚糖、泛影葡胺钠组成，并调整成不同的密度，利用密度梯度离心或双重梯度离心技术，从人、大鼠、小鼠或其他小型哺乳动物全血中分离纯化单核细胞、淋巴细胞和粒细胞等。</p>
<h4 id="实验材料与试剂"><a href="#实验材料与试剂" class="headerlink" title="实验材料与试剂"></a>实验材料与试剂</h4><ol>
<li>Histopaque 1077（密度梯度离心液，Sigma- Aldrich, catalog number: 10771 ; MP Biomedicals, catalog number: 091692254，这个型号是1077）</li>
<li>Histopaque 1119</li>
<li>无菌PBS（HBSS或Hanks液）</li>
<li>离心机</li>
<li>双抗</li>
<li>1640培养基</li>
<li>剪刀，15cm离心管</li>
</ol>
<h4 id="实验步骤"><a href="#实验步骤" class="headerlink" title="实验步骤"></a>实验步骤</h4><ol>
<li>处死小鼠，取出小鼠的股骨和胫骨；</li>
<li>放75%的酒精中消毒，随后再放入无菌PBS冲掉多余的酒精；</li>
<li>剪掉骨头的一头，用PBS冲洗骨头，冲洗三次；</li>
<li>四摄氏度，2000rmp离心5分钟，去掉上清；</li>
<li>用2mL的无菌PBS重悬；</li>
<li>在15mL的离心管底部中加入3mL的Histopaque 1119；</li>
<li>其次，缓慢加入3mL的Histopaque 1077；</li>
<li>最后，缓慢将2mL的细胞悬液加入到Histopaque 1-77的上层；</li>
<li>2000rpm，no brake,no accelerate，4摄氏度，离心30分钟；</li>
<li>在 Histopaque 1119和Histopaque 1077界面处取白色层的细胞；</li>
<li>用加入了双抗的1640培养基冲洗1次（1400rpm，7min，4摄氏度）；</li>
<li>取合适量细胞流式染色Ly-6G和CD11b；</li>
<li>30min后清洗细胞，上机检测细胞纯度。<br>Histopaque的加入分层如下图右图所示：<br><img src="http://ortxpw68f.bkt.clouddn.com/Histopaque.png" alt=""></li>
</ol>
<h3 id="外周血中性粒细胞的分离"><a href="#外周血中性粒细胞的分离" class="headerlink" title="外周血中性粒细胞的分离"></a>外周血中性粒细胞的分离</h3><h4 id="实验步骤-1"><a href="#实验步骤-1" class="headerlink" title="实验步骤"></a>实验步骤</h4><ol>
<li>收集4mL的PMBC，加入肝素化的试管中；</li>
<li>在15mL的离心管中加入4mL的Histopaque。</li>
<li>将PMBC轻轻加到Histopaque的上层（要注意Histopaque与PMBC呈现明显的两层，动作不能过大）。</li>
<li>100g，离心30分钟，刹车与加速都要调到最小。</li>
<li>吸取白色的细胞层（位于Histopaque和培养基之间，如下图的左图所示），这一步要在10分钟内完成 。</li>
<li>用PBS清洗细胞两次（100g，10分钟），4mL的PBMC约能取到1X10e7-8个细胞。<br><img src="http://ortxpw68f.bkt.clouddn.com/Histopaque.png" alt=""></li>
</ol>
<h4 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h4><ol>
<li>Histopaque与所要离心的外周血体积比为1:1。</li>
<li>Histopaque的储存温度是4摄氏度，在使用之前，要将Histopaque置于室温下1到2个小时，使其温度与室温接近，因为PBMC在低温下会发生冷休克（cold shock），并有可能在离心过程中形成聚集物。</li>
</ol>
<h2 id="中性粒细胞杀伤作用评价"><a href="#中性粒细胞杀伤作用评价" class="headerlink" title="中性粒细胞杀伤作用评价"></a>中性粒细胞杀伤作用评价</h2><p>（Blank, B. S., et al. (2014). “Misregulation of the broad-range phospholipase C activity increases the susceptibility of Listeria monocytogenes to intracellular killing by neutrophils.” Microbes and Infection 16(2): 104-113.）</p>
<ol>
<li>纯化后的BMN（骨髓来源中性粒细胞）用1640培养基混匀（加10% FBS，10mM HEPES），抑肽酶（aprotinin）浓度为0.4ug/mL，浓度为2X10e7/mL。</li>
<li>加入细菌，离心10分钟，700g。</li>
<li>孵育25分钟（吞菌）</li>
<li>用Opti-MEM培养基（含有50ug/ gentamicin）来替代原来的培养基；</li>
<li>感染25分钟后（从离心后开始计算时间），用含有200ug/mL的gentamicin的完全培养基清洗细胞；，</li>
<li>继续孵育30分钟，杀死细胞外细菌；</li>
</ol>
<h2 id="中性粒细胞的流式鉴定"><a href="#中性粒细胞的流式鉴定" class="headerlink" title="中性粒细胞的流式鉴定"></a>中性粒细胞的流式鉴定</h2><h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><ol>
<li>Amulic B, Cazalet C, Hayes G L, et al. Neutrophil Function: From Mechanisms to Disease[J]. Annual Review of Immunology, 2012, 30(1):459.</li>
<li><a href="http://www.bioon.com/trends/news/609626.shtml" target="_blank" rel="external">http://www.bioon.com/trends/news/609626.shtml</a></li>
<li>Panda, S. K., S. Kumar, N. C. Tupperwar, T. Vaidya, A. George, S. Rath, V. Bal and B. Ravindran (2012). Chitohexaose activates macrophages by alternate pathway through TLR4 and blocks endotoxemia. PLoS Pathog 8(5): e1002717.</li>
<li>Boari, J. T. and Rodríguez, E. A. (2012). Adoptive Transfer of Isolated Bone Marrow Neutrophils. Bio-protocol 2(23): e298. DOI: 10.21769/BioProtoc.298; Full Text</li>
<li>Tosello Boari, J., Amezcua Vesely, M. C., Bermejo, D. A., Ramello, M. C., Montes, C. L., Cejas, H., Gruppi, A. and Acosta Rodriguez, E. V. (2012). IL-17RA signaling reduces inflammation and mortality during Trypanosoma cruzi infection by recruiting suppressive IL-10-producing neutrophils. PLoS Pathog 8(4): e1002658.</li>
<li>Swamydas M, Lionakis MS. Isolation, Purification and Labeling of Mouse Bone Marrow Neutrophils for Functional Studies and Adoptive Transfer Experiments. Journal of Visualized Experiments : JoVE. 2013;(77):50586. doi:10.3791/50586.</li>
</ol>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/文献笔记/">文献笔记</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/基础知识/">基础知识</a><a href="/tags/天然免疫/">天然免疫</a><a href="/tags/实验方法/">实验方法</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2017/06/22/医学统计学-第19章生存分析(2)/" title="COX比例风险回归模型" itemprop="url">COX比例风险回归模型</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="RVDSD" target="_blank" itemprop="author">RVDSD</a>
		
  <p class="article-time">
    <time datetime="2017-06-22T04:02:00.000Z" itemprop="datePublished"> 发表于 2017-06-22</time>
    
  </p>
</header>
    <div class="article-content">
        
        <h2 id="COx回归模型简介"><a href="#COx回归模型简介" class="headerlink" title="COx回归模型简介"></a>COx回归模型简介</h2><p>Kaplan-Meier法与寿命表法研究的是单个分组变量的生存分析，而Cox比例风险回归模型（Cox proportional hazard regression medel）研究的由是多因素生存分析的主要方法。此方法是由英国统计学家Cox提出的而因此命名。</p>
<h3 id="Cox模型的基本形式"><a href="#Cox模型的基本形式" class="headerlink" title="Cox模型的基本形式"></a>Cox模型的基本形式</h3><script type="math/tex; mode=display">h(t,{\bf{X}})=h_{0} exp({\bf{\beta' X}})=h_{0}exp(\beta_{1}X_{1}+\beta_{2}X_{2}+\cdots+\beta_{m}X_{m})</script><p>其中$h(t,{\bf{X}})$是具有协变量${\bf{X}}$的个体在时刻t时的风险函数，t为生存时间，${\bf{X}}=(X<em>{1},X</em>{2},\cdots,X<em>{m})’$是可能影响生存时间的有关因素，也称协变量，这些变量可以是定量的，也可以是定性的，在整个观察期间内不随时间的变化而变化。$h</em>{0}(t)$是所有协变量取0时的风险函数，称为基线风险函数（）。${\bf{\beta}}=(\beta1,\beta2,\cdots,\beta<em>{m})’$为Cox模型的回归系数，是一组估的回归参数。由于此公式右侧的$h</em>{0}(t)$不需要服从特定的分布是形状，具有非参数的特点，而指数部分$exp({\bf{\beta’X}})$具有参数模型的形式，因此模型又称为半参数模型（semi-parametric model）。</p>
<p>如果采用生存率表示，则模型可写为：</p>
<script type="math/tex; mode=display">S(t,{\bf{X}}=S_{0}(t)^{exp({\bf{\beta'X}})}=S_{0}(t)^{exp(\beta_{1}X_{1}+\beta_{2}X_{2}+\cdots+\beta_{m}X_{m})}</script><p>其中S(t,X)是具有协变量X的个体在时刻t时的生存率，$S_{0}(t)$为在时刻t的基线生存率。</p>
<h3 id="RR或HR"><a href="#RR或HR" class="headerlink" title="RR或HR"></a>RR或HR</h3><p>两个分别具有协变量$X<em>{i}$和$X</em>{j}$的个体，其风险函数之比筄为相对危险度（risk ration，RR）或风险比（hazard ration，HR），是一个与时间无关的量，即</p>
<script type="math/tex; mode=display">h(t,{\bf{X_{i}}}/h(t,{\bf{X_{j}}}=exp[{\bf{\beta(X_{i}-X_{j)})}}]</script><p>例如$X<em>{i}$是暴露组观察对象对应各因素的聚会，$X</em>{j}$是非暴露组观察对象对应各因素的取值，求得${\bf{\beta}}$的估计时后就能救出暴露组对非暴露组的相对危险度估计。</p>
<h3 id="因素的初步筛选与最佳模型的建立"><a href="#因素的初步筛选与最佳模型的建立" class="headerlink" title="因素的初步筛选与最佳模型的建立"></a>因素的初步筛选与最佳模型的建立</h3><p><strong>1. 因素的筛选</strong>：影响生存时间的因素称为协变量，当协变量较多时，需要对这些协商量进行筛选。</p>
<p><strong>2. 最佳模型的建立</strong>：为建立最佳模型常需要对研究的因素进行筛选，筛选因素的方法有前进法，后退法和逐步回归法。在逐步筛选变量建立多元Cox回归模型的时候需要规定检验水准，以确定方程中引入哪些因素和剔除哪些因素，一般情况下确定引入检验的水准为0.05，剔除检验水准为0.1。检验各因素是否有统计学意义的方法有似然比检验、Wald检验和计分检验。</p>
<h3 id="比例风险假定的检验"><a href="#比例风险假定的检验" class="headerlink" title="比例风险假定的检验"></a>比例风险假定的检验</h3><p>Cox比例风险回归模型的主要前提是假定风险比值$h(t)/h_{0}(t)$为固定值，即协变量对生存率的影响不随时间的改变而改变，只有该条件得到满足，Cox回归模型的结果才有效，检验这一假定条件的方法有：</p>
<p>①如果分类协变量的每一组别的Kaplan-Meier生存曲线间无交叉，同满足比例风险假定；</p>
<p>②以生存时间t为横轴，对数生存率$ln[-ln\hat{S}(t)]$为纵轴，绘制分类协变量每一组别的生存曲线，如果协变量各组别对应的曲线平行，则满足风险比例条件；</p>
<p>③对于连续型协变量，可将每个协变量与对数生存时间的交互作用项$(Xln(t))$放入回归模型中，如果交互作用项无统计学意义，则满足风险比例条件。</p>
<p>当风险比例的假定条件不成立时，可采用如下方法解决：①将不成比例的协变量作为分层变量，然后再用其余变量进行多元Cox回归模型分析；②采用参数回归模型替代Cox回归模型进行分析。</p>
<h3 id="案例分析流程"><a href="#案例分析流程" class="headerlink" title="案例分析流程"></a>案例分析流程</h3><h4 id="案例"><a href="#案例" class="headerlink" title="案例"></a>案例</h4><p>（例19-5）为探讨某恶性肿瘤的预后，某研究值得收集了63例患者的生存时间生存结局及影响因素。影响因素包括患者年龄、性别、组织学类型、治疗方式、淋巴结转移、肿瘤浸润程度，生存时间t以月计算。变量的同形和所收集的资料分别见下表，试用Cox回归模型进行分析。<br><img src="http://ortxpw68f.bkt.clouddn.com/cox1.png" alt=""></p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/cox2.png" alt=""></p>
<p>完整数据<a href="https://github.com/20170505a/raw_data/blob/master/data_szq_survival_cox1.csv" target="_blank" rel="external">单击此处</a>。</p>
<h4 id="R包及函数"><a href="#R包及函数" class="headerlink" title="R包及函数"></a>R包及函数</h4><p>所用到R包为survival，所用函数如下所示：</p>
<ol>
<li>coxph：构建COX回归模型</li>
<li>cox.zph：检验PH假设是否成立</li>
<li>survreg：构建参数模型</li>
</ol>
<h4 id="计算流程"><a href="#计算流程" class="headerlink" title="计算流程"></a>计算流程</h4><h5 id="导入原始数据："><a href="#导入原始数据：" class="headerlink" title="导入原始数据："></a>导入原始数据：</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">data1905 &lt;- read.csv(&quot;https://raw.githubusercontent.com/20170505a/raw_data/master/data_szq_survival_cox1.csv&quot;,sep=&quot;,&quot;)</div><div class="line"># read raw data</div></pre></td></tr></table></figure>
<h5 id="构建生存分析对象："><a href="#构建生存分析对象：" class="headerlink" title="构建生存分析对象："></a>构建生存分析对象：</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">data1905.surv &lt;- Surv(data1905$t,data1905$Y)</div><div class="line">coxph.data1905 &lt;- coxph(data1905.surv ~ X1+X2+X3+X4+X5+X6,</div><div class="line">                        data=data1905,</div><div class="line">                        method=&quot;breslow&quot;)</div></pre></td></tr></table></figure>
<h5 id="筛选变量："><a href="#筛选变量：" class="headerlink" title="筛选变量："></a>筛选变量：</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">step(coxph.data1905)</div></pre></td></tr></table></figure>
<p>结果如下所示：<img src="http://ortxpw68f.bkt.clouddn.com/cox3.jpg" alt=""></p>
<h5 id="AIC信息准则"><a href="#AIC信息准则" class="headerlink" title="AIC信息准则"></a>AIC信息准则</h5><p>从筛选的变量结果来看，里面含有AIC的字样，AIC的全称为Akaike information criterion，这是衡量统计模型拟合优良性的一种标准，由于它为日本统计学家赤池弘次创立和发展的，因此又称赤池信息量准则。</p>
<p>在一般的情况下，AIC可以表示为： AIC=2k-2ln(L)<br>其中：k是参数的数量，L是似然函数。 假设条件是模型的误差服从独立正态分布。 让n为观察数，RSS为剩余平方和，那么AIC变为： AIC=2k+nln(RSS/n)。</p>
<p>AIC鼓励数据拟合的优良性但是尽量避免出现过度拟合(Overfitting)的情况。<strong>所以优先考虑的模型应是AIC值最小的那一个</strong>。赤池信息准则的方法是寻找可以最好地解释数据但包含最少自由参数的模型。</p>
<p>从<code>step(coxph.data1905)</code>计算的结果来看，筛选出来的变量是X4和X5，如下所示：<br><img src="http://ortxpw68f.bkt.clouddn.com/cox4.jpg" alt=""></p>
<p>然后对X4和X5进行Cox回归，如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">fit &lt;- coxph(data1905.surv~X4+X5,data=data1905,method = &quot;breslow&quot;)</div><div class="line">fit</div></pre></td></tr></table></figure>
<p>结果如下所示：<br><img src="http://ortxpw68f.bkt.clouddn.com/cox5.png" alt=""></p>
<p>从结果中可以看来，新型疗法的死亡风险只是传统疗法的0.172倍，协变量X5对应的相对危险度为2.538，这说明有淋巴结转移者的死亡风险是无淋巴结转移风险者的2.5倍。</p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/医学统计学/">医学统计学</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/基础统计/">基础统计</a><a href="/tags/基础知识/">基础知识</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2017/06/21/医学统计学-第19章生存分析(1)/" title="生存分析" itemprop="url">生存分析</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="RVDSD" target="_blank" itemprop="author">RVDSD</a>
		
  <p class="article-time">
    <time datetime="2017-06-21T04:01:00.000Z" itemprop="datePublished"> 发表于 2017-06-21</time>
    
  </p>
</header>
    <div class="article-content">
        
        <h2 id="生存分析"><a href="#生存分析" class="headerlink" title="生存分析"></a>生存分析</h2><p>使用对象：生存分析（survival analysis）使是将事件的结果和出现这一结果所经历的时间结合起来分析的一类统计分析方法，不仅考虑事件是否出现，而且也考虑事件出现的时间长短，因此这类方法也称为事件时间分析（time-to-event analysis）。</p>
<p>生存分析的资料通常有以下特点：①同时考虑生存时间和生存结局；②通常含有删失数据；③生存时间的分布通常不服从正态分析。</p>
<h3 id="以案例说明各种术语"><a href="#以案例说明各种术语" class="headerlink" title="以案例说明各种术语"></a>以案例说明各种术语</h3><p>以教材中的案例一下：<br>例19-1  为了估计HIV（人类免疫缺陷病毒）阳性患者的生存时间，某研究者进行了临床随访研究。研究对象是于2002年1月1日至2004年12月31日期间在某市确诊为HIV阳性者，随访这些对象直至死于AIDS（艾滋病）或其并发症（status=1为死亡，0为删失），研究截至日期为2008年12月31日。并记录每个研究对象的性别（sex=1为男， 0为女）、年龄（age，岁）、是否用药（drug=1为用药，0为不用），2017-09-26 15:09:14结果见表19-1所示。<br><img src="http://ortxpw68f.bkt.clouddn.com/19-1.png" alt=""></p>
<h4 id="起始事件、终点事件、生存时间"><a href="#起始事件、终点事件、生存时间" class="headerlink" title="起始事件、终点事件、生存时间"></a>起始事件、终点事件、生存时间</h4><p>事件可以分为起始事件（initial event）和终点事件（terminal event），从起始事件到终点事件之间所经历的时间跨度为生存时间（survival time），常记为随机㸄T，其中T&gt;=0，其值记为t。</p>
<p>在例19-1中的起始事件就是“确认HIV明性”，感兴趣的终点事件为“死于AIDS或其并发症”。表19-1中的起始日期（entdate）至终点日期（enddate）之间的月数就是生存时间（time），如编号ID个体的生存时间t=10个月。</p>
<h4 id="生存时间的分布"><a href="#生存时间的分布" class="headerlink" title="生存时间的分布"></a>生存时间的分布</h4><p>生存时间的分布通常不呈正态分布，而呈偏态分布，如呈指数分析、Weibul分布、Gompertz分布、对数Logistic分布等，下图就是19-1中的生存间分布图，其中组距为6个月，横轴是生存时间，纵轴是频率（%，其分子为频数，分母为总例数）：<br><img src="http://ortxpw68f.bkt.clouddn.com/19-1-2.png" alt=""></p>
<h4 id="删失"><a href="#删失" class="headerlink" title="删失"></a>删失</h4><p>生存结局（status）分为“死亡”和“删失”两类，“死亡”是感兴趣的终点事件，其它的终点事件或生存结局都归于删失（censoring，也称为示截尾或终检）。产生删失的原因可能为：①研究截至日期时，感兴趣终点事件仍未出现；②因搬迁等原因失去联系，不知感兴趣终点事件何时发生或是否会发生；③困其它各种原因中途退出；④死亡其它“事件”，例如交通事故或其它产生。</p>
<p>删失分为左删失、区间删失、右删失3类。</p>
<p>左删失：只知道感兴趣终点事件会在目前知晓时间（如截至时间、失访时间、死于其它疾病时间）之前发生。</p>
<p>区间删失：只知道感兴趣终点事件会在某一区间内发生。</p>
<p>右删失：只知道感兴趣终点事件会在知晓昱是之后发生。例如表19-1的ID=2个体的生存时间为1个月，因为是删失个体，所以该个体至少可以存活1个月，记为t=1+(月)，采用“+”就表示个体为右删失。</p>
<h4 id="生存时间图示"><a href="#生存时间图示" class="headerlink" title="生存时间图示"></a>生存时间图示</h4><p>每一个体进入随访队列的时间可以相同也可以不相同，当起时间不相同的时候，一般应规定一个时间范围，如例19-1就规定2002年1月1日至2004年12月31日。通常研究也会规研究截至时间，例19-1就规定为2008年12月31日。为了采用图形反映生存时间，特从表19-1中取出了个5个个体。生存结局根据记录的“终点事件”获得。生存时间通地客经2列和第3列的起始日期与终点日期计算获得。<br><img src="http://ortxpw68f.bkt.clouddn.com/19-1-3.png" alt=""><br><img src="http://ortxpw68f.bkt.clouddn.com/19-1-4.png" alt=""><br>图19-2分别采用年历时间（图19-2a）和生存时间（图19-2b）反映了表19-2中5个个体的生存情况，用“X”表示“死亡”，用“o”表示“删失”。第4、29、78号个体“死于AIDS”，即死于感兴趣的终点事件，其终点标记为“X”。第38号、39号个体为删失数据，其终点标记为“o”。第38号个体删失的原因为“失访”；第89号个体删失的原因为已到“截至日期”，感兴趣终点事件仍然没有发生。</p>
<h4 id="生存率"><a href="#生存率" class="headerlink" title="生存率"></a>生存率</h4><p>如果对图19-1的生存时间直方图拟合一条光滑曲线（图19-3），如下所示：<img src="http://ortxpw68f.bkt.clouddn.com/19-1-5%EF%BC%882%EF%BC%89.png" alt="曲线"><br>则这条曲线就是死亡概率密度函数（probability density funciotn,PDF）曲线，死亡概率密度函数记为f(t)，其定义为：</p>
<script type="math/tex; mode=display">f(t)=\lim_{\Delta \to 0} \frac{P(t\leq T< t + \Delta t)}{\Delta t}</script><p>如果资料中没有删失数据，则生存率如下所示：</p>
<script type="math/tex; mode=display">S(t)=P(Tt)=\frac{t时刻仍存活的例数}{观察总例数}</script><p>如果含有删失数据，则要分时段计算生存概率。假定观察对象在各个时段的生存事件独立，应用概率乘法定量将各时段的生存概率相乘得到生存率，如下所示：</p>
<script type="math/tex; mode=display">S(t)=p_{1}\cdot p_{2} \cdots p_{i} \cdots p_{k}=S(t_{k-1})\cdot p_{k}</script><p>其中</p>
<script type="math/tex; mode=display">p_{i}(i=1,2, \cdots,k)$$是各时段的生存概率。对于以区间陈列的生存时间资料，可以采用以下的公式来计算死亡概率密度函数值：
$$f(t)=[S(t_{i-1})-S(t_{i})]</script><p>其中，$wi$为第i区间的时间宽度，$S(t<em>{i-1})$、$S(t</em>{i})$分别是时间$t<em>{i-1})$和$t</em>{i})$的生存率。</p>
<h4 id="生存概率与死亡概率"><a href="#生存概率与死亡概率" class="headerlink" title="生存概率与死亡概率"></a>生存概率与死亡概率</h4><p>生存概率（probablity of survival）表示某时段开始时存活的个体，到该时段估结束时仍存活的可能性。如年生存要纺表示年初尚存人口存活满一年的可能性。如下所示：</p>
<script type="math/tex; mode=display">p=\frac{活过该年人数}{某年年初人数}</script><p>死亡概率（probablity of death）表示某时段开始时存活的个体，在该时段内死亡的可能性。如年死亡概率表示年初尚存人口在今后1年内死亡的可能性，如下所示：</p>
<script type="math/tex; mode=display">q=\frac{该年内死亡人数}{某年年初人口数}</script><p>显然，死亡概率$q=1-p$。</p>
<p>注：死亡概率与一般死亡率（death rate或mortality rate）有所不同，如年死亡率：</p>
<script type="math/tex; mode=display">m=\frac{该年内死亡人数}{某年平均人口数}</script><p>其分母不同，为”某年平均人口数”，但分子相同。</p>
<h4 id="风险函数"><a href="#风险函数" class="headerlink" title="风险函数"></a>风险函数</h4><p>风险率（hazard rate）或风险函数（hazard funciton）记为h(t)，定义如下所示：</p>
<script type="math/tex; mode=display">f(t)=\lim_{\Delta \to 0} \frac{P[(t\leq T< t + \Delta t|(T\geq t))}{\Delta t}=\frac{f(t)}{S(t)}</script><p>公式解读：已生存到时间t的观察对象在t时刻的瞬时死亡率。为非负数，且可以$&gt;1$。当Δt=1，$h(t)\approx P(t\leq T &lt; t+1|T \geq t)$，此时的风险率就是时刻t存活的个体在此后一个单位时段内的死亡概率。</p>
<p>累积风险函数（cumulative hazard function），记为H(t)，与和正函数之间的关系为H(t)=-lnS(t)</p>
<h2 id="生存分析的两种方法"><a href="#生存分析的两种方法" class="headerlink" title="生存分析的两种方法"></a>生存分析的两种方法</h2><h3 id="Kaplan-Meier法"><a href="#Kaplan-Meier法" class="headerlink" title="Kaplan-Meier法"></a>Kaplan-Meier法</h3><p>R中与生存分析有关的包是survival，会涉及到三个函数，如下所示：</p>
<ul>
<li>Surv：用于创建生存数据对象</li>
<li>survfit：创建KM生存曲线或是Cox调整生存曲线</li>
<li>survdiff：用于不同组的统计检验，其中rho数量参数用以指定检验类型，0为log-rank法或Mantel-Haenszel法，1为Wilcoxon法，默认为0。</li>
</ul>
<h4 id="案例1：Kaplan-Meier法，生存曲线，"><a href="#案例1：Kaplan-Meier法，生存曲线，" class="headerlink" title="案例1：Kaplan-Meier法，生存曲线，"></a>案例1：Kaplan-Meier法，生存曲线，</h4><p>例19-2  为了比较不同手术方法治疗肾上腺肿瘤的疗效，某研究者随机将43例病人分成两组，甲组23例、乙组20例的生存时间（月）如下所示：</p>
<h5 id="原始数据如下所示："><a href="#原始数据如下所示：" class="headerlink" title="原始数据如下所示："></a>原始数据如下所示：</h5><p>甲组：1，3，5（3），6（3），7，8，10（2），14+，17，19+，20+ ，22+，26+，31+，34， 34+，44，59</p>
<p>乙组：1（2），2，3（2），4（3），  6（2），8，9（2），10，11，12，13，15，17，18<br>其中有“+”者是删失数据，表示病人仍生存或失访，括号内为重复死亡数。试计算甲组的生存率与标准误。</p>
<p>计算过程如下所示：</p>
<h5 id="导入原始数据"><a href="#导入原始数据" class="headerlink" title="导入原始数据"></a>导入原始数据</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">library(survival)</div><div class="line">library(coin)</div><div class="line"></div><div class="line"># 导入例题19-02的数据文件</div><div class="line">data1902 &lt;- read.csv(&quot;https://raw.githubusercontent.com/20170505a/raw_data/master/data_szq_1902.csv&quot;,sep=&quot;,&quot;)</div><div class="line"></div><div class="line">str(data1902) # 查看数据结构</div></pre></td></tr></table></figure>
<p>如下所示：</p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/survival-1.jpg" alt=""></p>
<p>可以发现，group都是整数型，需要将其转换为因子类型的数据：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">data1902$group &lt;-as.factor(data1902$group) #将分组转化为因子类型的数据</div><div class="line">str(data1902)</div></pre></td></tr></table></figure>
<p>转换结果如下所示：</p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/survival-2.jpg" alt=""></p>
<h5 id="创建生存分析的对象："><a href="#创建生存分析的对象：" class="headerlink" title="创建生存分析的对象："></a>创建生存分析的对象：</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">Surv(data1902$t,data1902$status==1) </div><div class="line">#此语句的意思是创建一个生存分析对象；</div><div class="line">#status==1表示完整数据，0为删失数据；</div><div class="line"># 其中&quot;+&quot;是删失的数据，表示病人仍生存或失访</div></pre></td></tr></table></figure>
<p>生存分析对象如下所示：</p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/survival-4.jpg" alt=""></p>
<h5 id="生存分析各种参数进行计算："><a href="#生存分析各种参数进行计算：" class="headerlink" title="生存分析各种参数进行计算："></a>生存分析各种参数进行计算：</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">data.fit &lt;- survfit(Surv(t,status==1)~group,data=data1902) </div><div class="line">summary(data.fit)</div><div class="line"># 查看分析结果，group=1表示甲组，2表示乙组</div></pre></td></tr></table></figure>
<p>计算结果如下所示：</p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/survival-3.jpg" alt=""></p>
<h5 id="Surv-结果说明："><a href="#Surv-结果说明：" class="headerlink" title="Surv()结果说明："></a>Surv()结果说明：</h5><ol>
<li>time表示的是生存时间，这里与教材中的不太一样，教材中的信息比较全，而R中只列举了有死亡事件出现的生存时间，例如教材中的14个月有数据，而R中没有，因为在14月这个生存时间内，没有死亡，但R中没有列出，没有教材中的详细</li>
<li>n代表处于风险中的人数，这个数字就是上一个生存时间内的人数减去上一个生存时间内的死亡人数</li>
<li>n.event代表的是事件数，默认的status==1表示的是1代表死亡；</li>
<li>survival表示的是生存率</li>
<li>std.err表示的是生存率的标准误；</li>
<li>lower 95% CI：下95%置信区间；</li>
<li>upper 95% CI：上95%置信区间。</li>
</ol>
<h5 id="Log-Rank检验："><a href="#Log-Rank检验：" class="headerlink" title="Log-Rank检验："></a>Log-Rank检验：</h5><p>这里使用的是Log-Rank检验法，</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">survdiff(Surv(t,status==1)~group,data=data1902)</div><div class="line"># 比较两条生存曲线的差异，用的是Log-rank检验</div></pre></td></tr></table></figure>
<p>如下所示<br><img src="http://ortxpw68f.bkt.clouddn.com/survival-5.jpg" alt="">：</p>
<p>可以发现，${\chi}^2$ 值为8.8，p值为0.00309，可见这两种组别的数据有差异。</p>
<h5 id="绘制生存曲线："><a href="#绘制生存曲线：" class="headerlink" title="绘制生存曲线："></a>绘制生存曲线：</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">plot(data.fit,col=c(&quot;red&quot;,&quot;blue&quot;),lwd=1) #绘图</div><div class="line"></div><div class="line">legend(&quot;topright&quot;,legend=c(&quot;甲组&quot;,&quot;乙组&quot;),col=c(&quot;red&quot;,&quot;blue&quot;),lty=1,cex=0.8,adj=-0.7,bty=&quot;o&quot;) </div><div class="line">#加图例</div></pre></td></tr></table></figure>
<p>如下所示：</p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/survival-6.png" alt=""></p>
<p>或者使用survminer包中的ggsurvplot生成图片：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">library(survminer)</div><div class="line">data.fit &lt;- survfit(Surv(data1$time~data1$status)~data1$group)</div><div class="line">ggsurvplot(data.fit,legend.title = &quot;Sex&quot;,legend.labs = c(&quot;甲组&quot;, &quot;乙组&quot;))</div></pre></td></tr></table></figure>
<p>如下所示：<br><img src="http://ortxpw68f.bkt.clouddn.com/ggsurvplot.png" alt=""></p>
<h5 id="中位数生存时间"><a href="#中位数生存时间" class="headerlink" title="中位数生存时间"></a>中位数生存时间</h5><p>中位数生存时间（median survival time）又称为生存时间的中位数，表示刚好有50%的个体其存活期大于该时间。</p>
<p>计算中位数生存时间的方法有两种：</p>
<p>①在纵轴生存率为0.5处画一条与横轴平等的线，并与生存率曲线相交，然后自交点画垂线与横轴相交，此效应对应的时间点即为中位生存时间，但结果较粗略，如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">plot(data.fit,col=c(&quot;red&quot;,&quot;blue&quot;),lwd=1) #绘图</div><div class="line"></div><div class="line">legend(&quot;topright&quot;,legend=c(&quot;甲组&quot;,&quot;乙组&quot;),col=c(&quot;red&quot;,&quot;blue&quot;),lty=1,cex=0.8,adj=-0.7,bty=&quot;o&quot;) </div><div class="line">#加图例 </div><div class="line"></div><div class="line">abline(h=0.5)</div></pre></td></tr></table></figure>
<p><img src="http://ortxpw68f.bkt.clouddn.com/suvival-median2.jpeg" alt=""></p>
<p>②线性内插法，原理见书，但R中有类似的方法，如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">a &lt;- which(data1902$group==1)</div><div class="line">b &lt;- which(data1902$group==2)</div><div class="line">data1902[a]</div><div class="line">data1902[b]</div><div class="line">median_a &lt;- Surv(data1902[a,]$t,data1902[a,]$status==1)</div><div class="line">median_b &lt;- Surv(data1902[b,]$t,data1902[b,]$status==1)</div><div class="line">summary(median_a)</div><div class="line">summary(median_b)</div></pre></td></tr></table></figure>
<p><img src="http://ortxpw68f.bkt.clouddn.com/survival-median.png" alt=""></p>
<p>可以看到，甲组的中位数生存时间为10个月；乙组为7个月，跟书中略有出入。</p>
<h2 id="案例分析补充"><a href="#案例分析补充" class="headerlink" title="案例分析补充"></a>案例分析补充</h2><h3 id="案例1"><a href="#案例1" class="headerlink" title="案例1"></a>案例1</h3><p>某研究者分别用免疫疗法、药物与免疫结合疗法治疗黑色素瘤患者，经随访得到各患的生存时间（月）见下表（孙振球. 医学统计学习题解答-第4版[M]. 人民卫生出版社, 2015.P136）。</p>
<ol>
<li>试彩乘积极限法计算其生存率及其标准误。</li>
<li>对两组的生存率进行log-rank可检验。</li>
<li>绘制生存曲线。</li>
</ol>
<p>计算过程如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">library(survival)</div><div class="line">library(coin)</div><div class="line">data1&lt;- read.csv(&quot;https://raw.githubusercontent.com/20170505a/raw_data/master/data_szq_survival_case1.csv&quot;,sep=&quot;,&quot;)</div><div class="line">data1$group &lt;-as.factor(data1$group) #将分组转化为因子类型的数据</div><div class="line">Surv(data1$time,data1$status==1)</div><div class="line">data.fit &lt;- survfit(Surv(data1$t,data1$status==1)~data1$group) </div><div class="line">summary(data.fit)</div><div class="line">survdiff(Surv(time,status==1)~group,data=data1) </div><div class="line">plot(data.fit,col=c(&quot;red&quot;,&quot;blue&quot;),lwd=1) #绘图</div><div class="line">legend(&quot;topright&quot;,legend=c(&quot;BCG治疗组&quot;,&quot;药物和BCG治疗组&quot;),col=c(&quot;red&quot;,&quot;blue&quot;),lty=1,cex=0.8,x.intersp=1,bty=&quot;o&quot;)</div></pre></td></tr></table></figure>
<p>标准误与生存率：</p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/survival_case1_1.png" alt=""></p>
<p>两组进行比较：<br><img src="http://ortxpw68f.bkt.clouddn.com/survival_case1_2.png" alt=""><br>p值为0.811，还不能认为两种治疗方法有差异。</p>
<p>生存曲线：<br><img src="http://ortxpw68f.bkt.clouddn.com/survival_case1_3.png" alt=""></p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/医学统计学/">医学统计学</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/基础统计/">基础统计</a><a href="/tags/基础知识/">基础知识</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2017/06/21/医学统计学- 第04章方差分析/" title="方差分析(1)" itemprop="url">方差分析(1)</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="RVDSD" target="_blank" itemprop="author">RVDSD</a>
		
  <p class="article-time">
    <time datetime="2017-06-21T04:01:00.000Z" itemprop="datePublished"> 发表于 2017-06-21</time>
    
  </p>
</header>
    <div class="article-content">
        
        <h2 id="方差分析的基本思想及应用条件"><a href="#方差分析的基本思想及应用条件" class="headerlink" title="方差分析的基本思想及应用条件"></a>方差分析的基本思想及应用条件</h2><h3 id="方差分析的基本思想"><a href="#方差分析的基本思想" class="headerlink" title="方差分析的基本思想"></a>方差分析的基本思想</h3><p>在进行科学研究时，有时要按实验设计将所研究的对象分为多个处理组进行不同的处理，其中处理因素(treatment)至少有两个水平（level）。这类科研资料的纹夫杂质，是通过所获得的样本信息来推断各处理组均数间的差别是否有统计学意义，即处理是否有影响。常用采用的分析方法就是方差分析（ANOVA，analysis of variance），这是由英国统计学家R.A.Fisher首创，以F例中，故方差分析又称为F检验。</p>
<p>设处理因素有$g(g\geq 2)$个不同水平，实验对象随机分为$g$组，分别接受不同水平的干预，第$i(i=1,2,\dots,g)$组的样本含量为$n<em>{i}$，第$i$处理组的第$j(j=1,2,…n</em>{i})$个观测值用$X_{ij}$来表示，其计算结果可能可以整理成以下面的形式，如下所示：<br><img src="http://ortxpw68f.bkt.clouddn.com/anova11.png" alt=""></p>
<p>方差分析的目的就是在$H<em>{0}:\mu</em>{1}=\mu<em>{2}\dots=\mu</em>{<em>{g}}$成立的条件下，通过分析各处理组均数之间的差别大小，推荐$g$个总体均数$\bar{X}</em>{i}$间有无差别，从面说明处理因素的效应是否存在。</p>
<p>记总均数为$\bar{X}=\sum<em>{i=1}^g\sum</em>{j=1}^{n<em>{j}}X</em>{ij}/N$，各处理组均数为$\bar{X}=\sum<em>{j=1}^{n</em>{i}}X<em>{ij}/n</em>{i}$,总例数为$N=n<em>{1}+n</em>{2}+\dots+n_{g}$，g为处理组数。</p>
<p>实验数据有三个不同的变异：<br><strong>1. 总变异</strong>。全部观测值大小不同，这种变异称为总变异。总变异的大小可能用离均差平方和(sum of squares of deviations from eman,SS)来表示，即各观测值$X<em>{ij}$与总均数$\bar{X}$差值的平方和，记为$SS</em>{总}$。公式略。</p>
<p><strong>2. 组间变异</strong>。各处理组由于接受处理的水平不同，各组的样本均数$\bar{X}<em>{i}（i=1,2,\dots,g）$也大小不等，这种变异称为组间变异，其大小用各组均数$\bar{X</em>{i}}$与总均数$\bar{X}$的离均差平方和表示，记为$SS_{组间}$，计算公式略。</p>
<p>各组均数之间相关越悬殊，它们与总均数的差值越在在，$SS<em>{组间}$就越大，反之$SS</em>{组间}$就越小。$SS_{组间}$反应了各组均数的变异，存在这种变异的原因有：①随机误差；②处理的不同水平可能对实验结果的影响。</p>
<p><strong>3. 组内变异</strong>。在同一处理组中，虽然每个实验对象接受的处理相同，但观测值仍各不相同，这种变异称为组内变异（误差）。组内变异用组内各观测值$X<em>{ij}$与其所在组的均数$\bar{X</em>{i}}$的差值的平方和表示，记为$SS_{组内}$，表示随机误差的影响。公式略。</p>
<p>总离均差平方和分解为组间离均差平方和与组内离均差平方和，就有了以下公式：</p>
<script type="math/tex; mode=display">SS_{总}=SS_{组间}+SS_{组内}</script><p>各离均差平方和的自由度为：</p>
<script type="math/tex; mode=display">\nu_{总}=N-1，\nu_{组间}=g-1,\nu_{组内}=N-g</script><p>变异程序除与离均差平方和的大小腾外，还与其自由度有关，由于各部分自由度不相等，因此积分离均差平方和不能直接比较，须将各部分离均差平方和除以相应的自由度，其比值称为均方差，简称为均方（mean square, MS)。公式为：</p>
<script type="math/tex; mode=display">MS_{组间}=\frac{SS_{组间}}{\nu_{组间}}</script><script type="math/tex; mode=display">MS_{组内}=\frac{SS_{组内}}{\nu_{组内}}</script><p>如果各组样本的总体均数相等($H<em>{0}:\mu</em>{1}=\mu<em>{2}\dots=\mu</em>{_{g}}$)，即各处理组的样本来自相同的总体，无处理因素的作用，则组间变异同组内变异一样，只反映随机误差作用的大小，组间均方与组内无方的比值称为F统计量，如下所示：</p>
<script type="math/tex; mode=display">F=\frac{MS_{组间}}{MS_{组内}}</script><p>如果F值接近于1，就没有理由拒绝$H<em>{0}$;反之，F值越大，拒绝$H</em>{0}$的理由越充分，数理统计的理论证明，当$H_{0}$成立时，F统计量服从F分布，方差分析是单侧F检验。</p>
<h3 id="方差分析的应用条件"><a href="#方差分析的应用条件" class="headerlink" title="方差分析的应用条件"></a>方差分析的应用条件</h3><p>多个样本均数比较的方差分析其应用条件为：①各样本是相互独立的随机样本，均来自**正态分布总体；②相互比较的各样本的总体方差相等，即具有等方差齐性。</p>
<h2 id="R中的方差分析函数"><a href="#R中的方差分析函数" class="headerlink" title="R中的方差分析函数"></a>R中的方差分析函数</h2><p>所用的函数为aov()：<br>语法为：aov（formula,data=dataframe）<br>R表达式中的特殊符号：</p>
<h2 id="案例分析"><a href="#案例分析" class="headerlink" title="案例分析"></a>案例分析</h2><h3 id="案例一：常规单因素方差分析"><a href="#案例一：常规单因素方差分析" class="headerlink" title="案例一：常规单因素方差分析"></a>案例一：常规单因素方差分析</h3><p>单因素方差分析（one-way ANOVA）是指对单因素试验结果进行分析，检验因素对试验结果有无显著性影响的方法。单因素方差分析是用来检验多个平均数之间的差异，从而确定因素对试验结果有无显著性影响的一种统计方法。对于完全随机设计试验且处理数大于2时可以用单因素方差分析（等于2 时用t检验）。离差平方和的分解公式为：SST(总和)=SSR(组间)+SSE(组内)，F统计量为MSR/MSE，MSR=SSR/k-1,MSE=SSE/n-k。其中SST为总离差、SSR为组间平方和、SSE为组内平方和或残差平方和、MSR为组间均方差、MSE为组内均方差。</p>
<h4 id="案例1-1"><a href="#案例1-1" class="headerlink" title="案例1.1"></a>案例1.1</h4><p>单因素方差分析例4-2：某医生为了研究一种降血脂新药的临床疗效，按统一纳入标准选择120名高血脂患者，采用完全随机设计方法将患者等分为4组（具体分组方法见例4-1），进行双盲试验。6周后测得低密度脂蛋白作为试验结果，见表4-3。问4个处理组患者的低密度脂蛋白含量总体均数有无差别?<br>数据如下所示：<img src="http://ortxpw68f.bkt.clouddn.com/data_szq_402.png" alt=""></p>
<p><strong>计算过程如下所示：</strong></p>
<p><strong>1. 导入数据</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">anova1 &lt;- read.csv(&quot;https://raw.githubusercontent.com/20170505a/raw_data/master/data_szq_402.csv&quot;,sep=&quot;,&quot;)</div><div class="line">library(reshape2)</div><div class="line">anova1 &lt;- melt(anova1)</div></pre></td></tr></table></figure>
<p><strong>2. 正态检验</strong></p>
<p>方差分析需要一定的假设，即数据集应该符合正态和各组的方差相等，可以分别用shapiro.test和bartlett.test检验从P值观察到这两个假设是符合的。对于不符合假设的情况，我们就要用到非参数方法，例如Kruskal-Wallis秩和检验</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">shapiro.test(anova1$value)</div></pre></td></tr></table></figure>
<p>结果如下所示：<img src="http://ortxpw68f.bkt.clouddn.com/anova3.png" alt=""></p>
<p>P值大于0.05说明数据正态P值大于0.05说明数据正态</p>
<p><strong>3. 方差齐性检验:</strong><br>方差齐性检验就是检验各组样本所代表的总体方差是否一致的检验，两样本方差齐性检验使用Bartlett法，同样，它也适用于多样本的方差齐性检验，它是它要求所检验的样本总体符合正态分页，当不符合正态分布的时候，就不能使用，则要用Levene检验。Levene检验不受数据颁贩限制，是一种稳健的检验，因而被广泛地认为是一种标准的检验方差齐性的检验。</p>
<p><strong>方差齐性通常用bartlett检验</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">bartlett.test(anova1$value~anova1$variable)</div></pre></td></tr></table></figure>
<p>结果如下所示：<img src="http://ortxpw68f.bkt.clouddn.com/anova1.png" alt=""></p>
<p>结果显示p值大于0.05，可认为方差齐性。</p>
<p>或者用<strong>levene检验：</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">library(car)</div><div class="line">leveneTest(anova1$value~anova1$variable)</div></pre></td></tr></table></figure>
<p>结果如下所示：<img src="http://ortxpw68f.bkt.clouddn.com/anova2.png" alt=""><br>结果发现sig值大于0.05,表明符合方差齐性假设,可以进行进一步的参数检验。</p>
<p><strong>4. 检验整体均值是否有差异</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">result &lt;- aov(value~variable,data=anova1)</div><div class="line">summary(result)</div></pre></td></tr></table></figure>
<p>结果如下所示：<img src="http://ortxpw68f.bkt.clouddn.com/anova4.png" alt=""></p>
<p>其中p值小于0.001，因此各组之间存在显著性差异。另外，R给出的F值是24.88，而书中的例子是24.93，书中的值是由查F表得来的，是个范围，R中的是具体值。</p>
<p><strong>5. 均数间的多重比较</strong></p>
<p>方差分析得出总体之间有差异，要进一步知道哪两组之间有差异，就要使用均数间的多重比较，常用的比较方法有SNK检验（q检验），LSD检验，Bonferroni检验，Dunnett检验，TurkeyHSD检验。</p>
<p><strong>现在计算各组之间的均数与SD</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">aggregate(anova1$value,by=list(anova1$variable),FUN=mean)</div><div class="line">aggregate(anova1$value,by=list(anova1$variable),FUN=sd)</div></pre></td></tr></table></figure>
<p>结果如下所示：<img src="http://ortxpw68f.bkt.clouddn.com/anova1_mean_sd.png" alt=""></p>
<p><strong>绘制箱形图可能观察到不同因素对于因变量的影响</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">plot.design(value ~ variable,data =anova1, main = &quot;Group means&quot;) </div><div class="line"># plot.design was inclued in packages &quot;graphics&quot;</div></pre></td></tr></table></figure>
<p><img src="http://ortxpw68f.bkt.clouddn.com/anova13.png" alt=""></p>
<p><strong>绘制有置信区间的组均值图</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">library(gplots)</div><div class="line">plotmeans(value ~ variable,data =anova1 )</div></pre></td></tr></table></figure>
<p>图片如下所示：<br><img src="http://ortxpw68f.bkt.clouddn.com/anova12.png" alt=""></p>
<p><strong>LSD检验与TukeyHSD检验</strong><br>通过方差分析后，如果整体有差异，则进一步进行两两比较，常用的方法用LSD和TukeyHSD方法，如下所示：</p>
<p><strong>LSD检验</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">library(agricolae) #此包中有LSD检验</div><div class="line">result &lt;- LSD.test(result,&quot;variable&quot;,p.adj=&quot;bonferroni&quot;)</div><div class="line">result</div></pre></td></tr></table></figure>
<p>结果如下所示：<img src="http://ortxpw68f.bkt.clouddn.com/anova5.png" alt=""></p>
<p>注：R给出的F值是24.88，而书中的例子是24.93，书中的值是由查F表得来的，是个范围，R中的是具体值。<br>Bonferroni校正(“bonferroni”)，用于多重比较的p值校正，次数不多时适用。如果在同一数据集上同时检验n个独立的假设，那么用于每一假设的统计显著水平，应为仅检验一个假设时的显著水平的1/n。举个例子：如要在同一数据集上检验两个独立的假设，显著水平设为常见的0.05。此时用于检验该两个假设应使用更严格的0.025。即0.05* (1/2)。该方法是由Carlo Emilio Bonferroni发展的，因此称Bonferroni校正。在药理实验中，动物数通常不会太多，用Bonferroni校正的居多。</p>
<p><strong>TukeyHSD()检验</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">result2 &lt;- aov(value~variable,data=anova1)</div><div class="line">result.tukey &lt;- TukeyHSD(result2)</div><div class="line">result.tukey</div><div class="line">plot(result.tukey)</div></pre></td></tr></table></figure>
<p>结果如下所示：<br><img src="http://ortxpw68f.bkt.clouddn.com/anova_tukey.png" alt=""></p>
<p>图片结果：<br><img src="http://ortxpw68f.bkt.clouddn.com/anova_tukey_plot.png" alt=""></p>
<h4 id="案例1-2"><a href="#案例1-2" class="headerlink" title="案例1.2"></a>案例1.2</h4><p>例5.1 某单位研究不同药物对小白鼠的镇咳作用，抽取40只小白鼠随机分配到各个药物组中，实验时先用0.2mL NH4OH对小白鼠喷雾，测定其发生咳嗽时间。以给药前后发生咳嗽时间的差值衡量不同药物的镇咳作用，结果见表5.1.试比较3种药物的平均推迟咳嗽时间的差异有无差异。（王炳顺. 医学统计学及SAS应用[M]. 上海交通大学出版社, 2007.）</p>
<p>计算过程如下所示：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">anova2 &lt;- read.csv(&quot;https://raw.githubusercontent.com/20170505a/raw_data/master/data_anova_01.csv&quot;,sep=&quot;,&quot;)</div><div class="line"># input raw data </div><div class="line"># 王炳顺. 医学统计学及SAS应用[M]. 上海交通大学出版社, 2007.例5.1</div><div class="line"></div><div class="line">anova2$group &lt;- as.factor(anova2$group)</div><div class="line">library(car)</div><div class="line">leveneTest(anova2$time~anova2$group)</div><div class="line">result &lt;- aov(anova2$time~anova2$group)</div><div class="line">summary(result)</div><div class="line">compareresult &lt;- TukeyHSD(result)</div><div class="line">compareresult</div><div class="line">plot(compareresult)</div></pre></td></tr></table></figure></p>
<p>结果如下所示：<img src="http://ortxpw68f.bkt.clouddn.com/anova2.1.png" alt=""></p>
<p>两两比较的结果<br><img src="http://ortxpw68f.bkt.clouddn.com/anova2.2.png" alt=""></p>
<p>绘图：<br><img src="http://ortxpw68f.bkt.clouddn.com/anova2.3.png" alt=""></p>
<h3 id="案例二：双因素方差分析（Two-way-ANOVA）"><a href="#案例二：双因素方差分析（Two-way-ANOVA）" class="headerlink" title="案例二：双因素方差分析（Two-way ANOVA）"></a>案例二：双因素方差分析（Two-way ANOVA）</h3><h3 id="案例四：重复测量方差分析"><a href="#案例四：重复测量方差分析" class="headerlink" title="案例四：重复测量方差分析"></a>案例四：重复测量方差分析</h3>
        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/医学统计学/">医学统计学</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/基础统计/">基础统计</a><a href="/tags/基础知识/">基础知识</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2017/06/20/医学统计学-第03章正态分布与T检验/" title="正态分布与t检验" itemprop="url">正态分布与t检验</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="RVDSD" target="_blank" itemprop="author">RVDSD</a>
		
  <p class="article-time">
    <time datetime="2017-06-20T04:00:00.000Z" itemprop="datePublished"> 发表于 2017-06-20</time>
    
  </p>
</header>
    <div class="article-content">
        
        <h2 id="标准误与标准差的区别"><a href="#标准误与标准差的区别" class="headerlink" title="标准误与标准差的区别"></a>标准误与标准差的区别</h2><p>这一内容<a href="http://rvdsd.top/2017/06/19/%E5%8C%BB%E5%AD%A6%E7%BB%9F%E8%AE%A1%E5%AD%A6-%E7%AC%AC02%E7%AB%A0%E6%95%B0%E6%8D%AE%E6%8F%8F%E8%BF%B0/">前文</a>已经提到。</p>
<h2 id="正态分布介绍"><a href="#正态分布介绍" class="headerlink" title="正态分布介绍"></a>正态分布介绍</h2><h3 id="正态分布定义"><a href="#正态分布定义" class="headerlink" title="正态分布定义"></a>正态分布定义</h3><p>若随机变量X服从一个数学期望为$\mu$、方差为$(\sigma)^2$的正态分布，记为N($\mu$，$(\sigma)^2$)。其概率密度函数为正态分布的期望值$\mu$决定了其位置，其标准差$\sigma$决定了分布的幅度。因其曲线呈钟形，因此人们又经常称之为钟形曲线。我们通常所说的标准正态分布是$\mu$ = 0,$\sigma$ = 1的正态分布。</p>
<h2 id="R语言正态分布函数"><a href="#R语言正态分布函数" class="headerlink" title="R语言正态分布函数"></a>R语言正态分布函数</h2><p>R语言中与正态分布有关的函数如下所示：</p>
<ol>
<li>密度函数： dnorm(x, mean = 0, sd = 1, log = FALSE)</li>
<li>分布函数： pnorm(q, mean = 0, sd = 1, lower.tail = TRUE, log.p = FALSE)</li>
<li>分位数函数：qnorm(p, mean = 0, sd = 1, lower.tail = TRUE, log.p = FALSE)</li>
<li>随机函数： rnorm(n, mean = 0, sd = 1)<br>其余的分布函数与正态分布的前缀相同。</li>
</ol>
<h3 id="正态分布相应的概率计算"><a href="#正态分布相应的概率计算" class="headerlink" title="正态分布相应的概率计算"></a>正态分布相应的概率计算</h3><p>求正态N(3.1.5)变量X在区间(2,4)中的概率p，如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pnorm(4,3,1.5)-pnorm(2,3,1.5)</div></pre></td></tr></table></figure>
<blockquote>
<p>pnorm(4,3,1.5)-pnorm(2,3,1.5)<br>[1] 0.4950149</p>
</blockquote>
<h2 id="正态分布密度曲线"><a href="#正态分布密度曲线" class="headerlink" title="正态分布密度曲线"></a>正态分布密度曲线</h2><p>下面分别绘制均值（以下用m表示）为0，标准差（以下用sd表示）为1，m=0，sd=0.5，m=0，sd=2，m=-2，sd=1的正态分布密度曲线（密度曲线下面的积分面积对应的就是相应范围内的概率）。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">set.seed(1000)</div><div class="line">x &lt;- seq(-5,5,length.out=100)</div><div class="line">y &lt;- dnorm(x,0,1)</div><div class="line">plot(x,y,col=&quot;red&quot;,xlim=c(-5,5),ylim=c(0,1),type=&quot;l&quot;,</div><div class="line">xaxs=&quot;i&quot;,yaxs=&quot;i&quot;,ylab=&quot;density&quot;,xlab=&quot;&quot;,</div><div class="line">main=&quot;The Normal Density Distribution&quot;)</div><div class="line">lines(x,dnorm(x,0,0.5),col=&quot;green&quot;)</div><div class="line">lines(x,dnorm(x,0,2),col=&quot;blue&quot;)</div><div class="line">lines(x,dnorm(x,-2,1),col=&quot;orange&quot;)</div><div class="line">legend(&quot;topright&quot;,legend=paste(&quot;m=&quot;,c(0,0,0,-2),&quot;sd=&quot;,c(1,0.5,2,1)),lwd=1,col=c(&quot;red&quot;,&quot;green&quot;,&quot;blue&quot;,&quot;orange&quot;))</div></pre></td></tr></table></figure>
<p>结果如下所示：<img src="http://ortxpw68f.bkt.clouddn.com/normaldistribution.png" alt=""></p>
<h2 id="正态分布累积曲线"><a href="#正态分布累积曲线" class="headerlink" title="正态分布累积曲线"></a>正态分布累积曲线</h2><p>代码如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">set.seed(1000)</div><div class="line">x &lt;- seq(-5,5,length.out=100)</div><div class="line">y &lt;- pnorm(x,0,1)</div><div class="line">plot(x,y,col=&quot;red&quot;,xlim=c(-5,5),ylim=c(0,1),type=&quot;l&quot;,</div><div class="line">xaxs=&quot;i&quot;,yaxs=&quot;i&quot;,ylab=&quot;density&quot;,xlab=&quot;&quot;,</div><div class="line">main=&quot;The Normal Cumulative Distribution&quot;)</div><div class="line">lines(x,pnorm(x,0,0.5),col=&quot;green&quot;)</div><div class="line">lines(x,pnorm(x,0,2),col=&quot;blue&quot;)</div><div class="line">lines(x,pnorm(x,-2,1),col=&quot;orange&quot;)</div><div class="line">legend(&quot;bottomright&quot;,legend=paste(&quot;m=&quot;,c(0,0,0,-2),&quot;sd=&quot;,c(1,0.5,2,1)),lwd=1,col=c(&quot;red&quot;,&quot;green&quot;,&quot;blue&quot;,&quot;orange&quot;))</div></pre></td></tr></table></figure>
<p>结果如下所示：<img src="http://ortxpw68f.bkt.clouddn.com/normalcumulative.png" alt=""></p>
<h2 id="正态分布的检验"><a href="#正态分布的检验" class="headerlink" title="正态分布的检验"></a>正态分布的检验</h2><p>判断数据是否符合正态分布通常用的是非参数检验方法（因为总体分布未知）</p>
<h3 id="shapiro-test-函数"><a href="#shapiro-test-函数" class="headerlink" title="shapiro.test()函数"></a>shapiro.test()函数</h3><p>Shapiro-Wilk正态分布检验: 用来检验是否数据符合正态分布，类似于线性回归的方法一样，是检验其于回归曲线的残差。该方法推荐在样本量很小的时候使用，样本在3到5000之间。该检验原假设为H0:数据集符合正态分布，统计量W 最大值是1，越接近1，表示样本与正态分布匹配。如果p-value小于显著性水平α(0.05)，则拒绝H0，表示样本不符合正态分布，如果p-value在大于显著性水平，则接受H0，表示样本符合正态分布。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">set.seed(1)</div><div class="line">s &lt;- rnorm(1000)</div><div class="line">shapiro.test(s)</div></pre></td></tr></table></figure>
<p>其结果为：<br>Shapiro-Wilk normality test</p>
<p>data:  s<br>W = 0.9988, p-value = 0.7256</p>
<p>结论: W接近1，p-value&gt;0.05，不能拒绝原假设，所以数据集s符合正态分布。</p>
<h3 id="Kolmogorov-Smirnov连续分布检验"><a href="#Kolmogorov-Smirnov连续分布检验" class="headerlink" title="Kolmogorov-Smirnov连续分布检验"></a>Kolmogorov-Smirnov连续分布检验</h3><p>Kolmogorov-Smirnov连续分布检验:检验单一样本是不是服从某一预先假设的特定分布的方法。以样本数据的累计频数分布与特定理论分布比较，若两者间的差距很小，则推论该样本取自某特定分布族。<br>该检验原假设为H0:数据集符合正态分布，H1:样本所来自的总体分布不符合正态分布。令F0(x)表示预先假设的理论分布，Fn(x)表示随机样本的累计概率(频率)函数.<br>统计量D为: D=max|F0(x) - Fn(x)|，D值越小，越接近0，表示样本数据越接近正态分布，如果p-value小于显著性水平α(0.05)，则拒绝H0。</p>
<p>Kolmogorov-Smirnov 检验,用法如下： ks.test(x, y, …, alternative = c(“two.sided”, “less”, “greater”), exact = NULL)<br>R语言中ks.test有四个参数，第一个参数x为观测值向量，第二个参数y为第二观测值向量或者累计分布函数或者一个真正的累积分布函数如pnorm，只对连续CDF有效。第三个参数为指明是单侧检验还是双侧检验，exact参数为NULL或者一个逻辑值，表明是否需要计算精确的P值。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">set.seed(1)</div><div class="line">s &lt;- rnorm(1000)</div><div class="line">ks.test(s,&quot;pnorm&quot;)</div></pre></td></tr></table></figure>
<p>结果如下：<br>One-sample Kolmogorov-Smirnov test</p>
<p>data:  s<br>D = 0.0211, p-value = 0.7673<br>alternative hypothesis: two-sided</p>
<p>D值很小, p-value&gt;0.05，不能拒绝原假设，所以数据集s符合正态分布。</p>
<h3 id="KS的第二案例应用"><a href="#KS的第二案例应用" class="headerlink" title="KS的第二案例应用"></a>KS的第二案例应用</h3><h4 id="比较两组数据的分布是否相同"><a href="#比较两组数据的分布是否相同" class="headerlink" title="比较两组数据的分布是否相同"></a>比较两组数据的分布是否相同</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ks.test(rnorm(100),rnorm(50))</div></pre></td></tr></table></figure>
<blockquote>
<p>   Two-sample Kolmogorov-Smirnov test</p>
<p>data:  rnorm(100) and rnorm(50)<br>D = 0.14, p-value = 0.5185<br>alternative hypothesis: two-sided</p>
</blockquote>
<p>在这一案例中，我们比较了两个均值和方差一样的观测值，他们D值很小，p值大于0.05，所以我们不能拒绝两个观测值分布相同的假设。</p>
<h4 id="KS比较某一数据符合某一分布"><a href="#KS比较某一数据符合某一分布" class="headerlink" title="KS比较某一数据符合某一分布"></a>KS比较某一数据符合某一分布</h4><p>检验一组数据是否符合均匀分布（生成均匀分布的函数为runif))，如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ks.test(rnorm(100),&quot;punif&quot;)</div></pre></td></tr></table></figure>
<p>结果中p-value为2.2e-16，我们用rnorm(100)生成的是正态分布的数据，因此它不符合均匀分布（参数为punif）。如果参数设为pnorm，再看一下。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ks.test(rnorm(100),&quot;pnorm&quot;)</div></pre></td></tr></table></figure>
<p>结果的p值为0.6722，符合正态分布。</p>
<h3 id="Pearson-拟合优度chi-square检验"><a href="#Pearson-拟合优度chi-square检验" class="headerlink" title="Pearson 拟合优度chi-square检验"></a>Pearson 拟合优度chi-square检验</h3><p>（略）</p>
<h3 id="QQ图"><a href="#QQ图" class="headerlink" title="QQ图"></a>QQ图</h3><p>正态概率图用于检查一组数据是否服从正态分布。是实数与正态分布数据之间函数关系的散点图。如果这组实数服从正态分布，正态概率图将是一条直线。通常，概率图也可以用于确定一组数据是否服从任一已知分布，如二项分布或泊松分布。</p>
<p>QQ图是quantile—quantile的简写，一个根据正态分布的分位数，一个是样本分位数；如果两者在一条直线上，说明样本符合状态分布的分位数，即服从正态分布。QQ图是一种散点图,对应于正态分布的QQ图,就是由标准正态分布的分位数为横坐标,样本值为纵坐标的散点图. 要利用QQ图鉴别样本数据是否近似于正态分布,只需看QQ图上的点是否近似地在一条直线附近,而且该直线的斜率为标准差,截距为均值. 用QQ图还可获得样本偏度和峰度的粗略信息。</p>
<p>另外，还有一种PP图。P-P图是根据变量的累积比例与指定分布的累积比例之间的关系所绘制的图形。通过P-P图可以检验数据是否符合指定的分布。当数据符合指定分布时，P-P图中各点近似呈一条直线。如果P-P图中各点不呈直线，但有一定规律，可以对变量数据进行转换，使转换后的数据更接近指定分布。 Q-Q图同样可以用于检验数据的分布，所不同的是，Q-Q图是用变量数据分布的分位数与所指定分布的分位数之间的关系曲线来进行检验的。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">set.seed(1)</div><div class="line">s &lt;- rnorm(1000)</div><div class="line">qqnorm(s)</div><div class="line">qqline(s,col=&quot;red&quot;)</div></pre></td></tr></table></figure>
<p>结果如下所示：<img src="http://ortxpw68f.bkt.clouddn.com/qqpic.png" alt=""></p>
<p>解释：纵轴是数据的实际分位数，横轴是正态分布的理论分位数，红线是45度的参考线，如果数据是正态分布，则散点应该落在直线上。即实际分位数与理论分位数偏差不大。说明来自正态总体。</p>
<h3 id="峰度与偏度"><a href="#峰度与偏度" class="headerlink" title="峰度与偏度"></a>峰度与偏度</h3><h4 id="峰度（Kurtosis）"><a href="#峰度（Kurtosis）" class="headerlink" title="峰度（Kurtosis）"></a>峰度（Kurtosis）</h4><p>峰度是描述某变量所有取值分布形态陡缓程度的统计量，它是和正态分布相比较的。<br>公式如下所示：</p>
<script type="math/tex; mode=display">Kurtosis=\frac{\sum(X-\mu)^{4}}{\delta^{4}} -3</script><p>正态分布的Kurtosis为K=3,为了描述方便，有时候需要减3（上述公式就减了3），有的公式没有，但原理是相同的。<br><img src="http://ortxpw68f.bkt.clouddn.com/Kurtosis.png" alt=""><br>Kurtosis=0       与正态分布的陡缓程度相同。<br>Kurtosis&gt;0       比正态分布的高峰更加陡峭——尖顶峰<br>Kurtosis&lt;0       比正态分布的高峰来得平台——平顶峰</p>
<h4 id="偏度（Skewness）"><a href="#偏度（Skewness）" class="headerlink" title="偏度（Skewness）"></a>偏度（Skewness）</h4><p>偏度是描述某变量取值分布对称性的统计量。公式如下</p>
<script type="math/tex; mode=display">Skewness=\sum[(\frac{X-\mu}{\delta})^3]</script><p><img src="http://ortxpw68f.bkt.clouddn.com/Skewness.png" alt=""><br>Skewness=0     分布形态与正态分布偏度相同<br>Skewness&gt;0     正偏差数值较大，为正偏或右偏。长尾巴拖在右边。<br>Skewness&lt;0     负偏差数值较大，为负偏或左偏。长尾巴拖在左边。</p>
<h3 id="正态分布检验补充案例"><a href="#正态分布检验补充案例" class="headerlink" title="正态分布检验补充案例"></a>正态分布检验补充案例</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">words1 = rnorm(100)</div><div class="line">words2 = rt(100, df=3)</div><div class="line"></div><div class="line">plot(density(words1))</div><div class="line">lines(density(words2))</div><div class="line">shapiro.test(words1)</div><div class="line">shapiro.test(words2)</div><div class="line"></div><div class="line">par(mfrow=c(2,1))</div><div class="line">qqnorm(words1);qqline(words1, col = 2)</div><div class="line">qqnorm(words2);qqline(words2, col = 2)</div></pre></td></tr></table></figure>
<p>words1与words2密度图如下所示：<br><img src="http://ortxpw68f.bkt.clouddn.com/test%20normalDistribution.png" alt=""></p>
<p>从图上大致可以看出来words1与标准正态图比较接近。</p>
<p>用shapiro检验后的结果如下所示：<br><img src="http://ortxpw68f.bkt.clouddn.com/test%20normalDistribution2.png" alt=""></p>
<p>从计算结果来看，words1是p值为0.09861，大于0.05，不能否定原假定，因此words1符合正态分布。同理,words2不符合正态分布。</p>
<p>QQ图的结果如下所示：<br><img src="http://ortxpw68f.bkt.clouddn.com/test%20normalDistribution3.png" alt=""></p>
<p>从QQ图中可以看出，words1符合正态分布，而words2不符合正态分布。</p>
<h2 id="R语言中进行正态分布检验的其它包"><a href="#R语言中进行正态分布检验的其它包" class="headerlink" title="R语言中进行正态分布检验的其它包"></a>R语言中进行正态分布检验的其它包</h2><h3 id="nortest包"><a href="#nortest包" class="headerlink" title="nortest包"></a>nortest包</h3><p>lillie.test()可以实行更精确的Kolmogorov-Smirnov检验。</p>
<p>ad.test()进行Anderson-Darling正态性检验。</p>
<p>cvm.test()进行Cramer-von Mises正态性检验。</p>
<p>pearson.test()进行Pearson卡方正态性检验。</p>
<p>sf.test()进行Shapiro-Francia正态性检验。</p>
<h3 id="fBasics包"><a href="#fBasics包" class="headerlink" title="fBasics包"></a>fBasics包</h3><p>ksnormTest() 进行Kolmogorov-Smirnov正态性检验。</p>
<p>shapiroTest() 进行Shapiro-Wilk正态性检验。</p>
<p>jarqueberaTest() 进行jarque-Bera正态性检验。</p>
<p>dagoTest() 进行D’Agostino正态性检验。</p>
<p>adTest() 进行Anderson-Darling正态性检验。</p>
<p>cvmTest() 进行Cramer-von Mises正态性检验。</p>
<p>lillieTest() 进行Lilliefors(KS)正态性检验。</p>
<p>pchiTest() 进行Pearson chi-square正态性检验。</p>
<p>sfTest() 进行Shapiro-Francia正态性检验。</p>
<p>jbTest() Finite sample adjusted JB LM and ALM test。</p>
<p>normalTest() 进行Kolmogorov-Smirnov正态性检验。</p>
<h2 id="t分布"><a href="#t分布" class="headerlink" title="t分布"></a>t分布</h2><p>学生t-分布（Student’s t-distribution），可简称为t分布。应用在估计呈正态分布的总体之平均数。</p>
<h3 id="t分布的密度分布图"><a href="#t分布的密度分布图" class="headerlink" title="t分布的密度分布图"></a>t分布的密度分布图</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">set.seed(1000)</div><div class="line">x &lt;- seq(-5,5,length.out=1000)</div><div class="line">y &lt;- dt(x,1,0)</div><div class="line">plot(x,y,col=&quot;red&quot;,xlim=c(-5,5),ylim=c(0,0.5),type=&quot;l&quot;,</div><div class="line">xaxs=&quot;i&quot;,yaxs=&quot;i&quot;,ylab=&quot;density&quot;,xlab=&quot;&quot;,</div><div class="line">main=&quot;The T density distribution&quot;)</div><div class="line">lines(x,dt(x,5,0),col=&quot;green&quot;)</div><div class="line">lines(x,dt(x,5,2),col=&quot;blue&quot;)</div><div class="line">lines(x,dt(x,50,4),col=&quot;orange&quot;)</div><div class="line">legend(&quot;topleft&quot;,legend=paste(&quot;df=&quot;,c(1,5,5,50),&quot;ncp=&quot;,c(0,0,2,4)),lwd=1,col=c(&quot;red&quot;,&quot;green&quot;,&quot;blue&quot;,&quot;orange&quot;))</div></pre></td></tr></table></figure>
<p><img src="http://ortxpw68f.bkt.clouddn.com/t%20density%20distribution.png" alt=""></p>
<h2 id="t分布的累积分布图"><a href="#t分布的累积分布图" class="headerlink" title="t分布的累积分布图"></a>t分布的累积分布图</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">set.seed(1)</div><div class="line">x&lt;-seq(-5,5,length.out=1000)</div><div class="line">y&lt;-pt(x,1,0)</div><div class="line">plot(x,y,col=&quot;red&quot;,xlim=c(-5,5),ylim=c(0,0.5),type=&apos;l&apos;,</div><div class="line">xaxs=&quot;i&quot;, yaxs=&quot;i&quot;,ylab=&apos;density&apos;,xlab=&apos;&apos;,</div><div class="line">main=&quot;The T Cumulative Distribution Function&quot;)</div><div class="line">lines(x,pt(x,5,0),col=&quot;green&quot;)</div><div class="line">lines(x,pt(x,5,2),col=&quot;blue&quot;)</div><div class="line">lines(x,pt(x,50,4),col=&quot;orange&quot;)</div><div class="line">legend(&quot;topleft&quot;,legend=paste(&quot;df=&quot;,c(1,5,5,50),&quot; ncp=&quot;, c(0,0,2,4)), lwd=1, col=c(&quot;red&quot;, &quot;green&quot;,&quot;blue&quot;,&quot;orange&quot;))</div></pre></td></tr></table></figure>
<h2 id="某一数据是否符合t分布"><a href="#某一数据是否符合t分布" class="headerlink" title="某一数据是否符合t分布"></a>某一数据是否符合t分布</h2><p>Kolmogorov-Smirnov连续分布检验: 检验单一样本是不是服从某一预先假设的特定分布的方法。以样本数据的累计频数分布与特定理论分布比较，若两者间的差距很小，则推论该样本取自某特定分布族。<br>该检验原假设为H0:数据集符合T分布，H1:样本所来自的总体分布不符合T分布。令F0(x)表示预先假设的理论分布，Fn(x)表示随机样本的累计概率(频率)函数.<br>统计量D为: D=max|F0(x) - Fn(x)|<br>D值越小，越接近0，表示样本数据越接近T分布<br>p值，如果p-value小于显著性水平α(0.05)，则拒绝H0</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">set.seed(1)</div><div class="line">S&lt;-rt(1000, 1,2)</div><div class="line">ks.test(S, &quot;pt&quot;, 1, 2)</div></pre></td></tr></table></figure>
<p>其中p-value = 0.5461，说明数据集S符合df1=1, ncp=2的T分布</p>
<h2 id="方差齐性检验"><a href="#方差齐性检验" class="headerlink" title="方差齐性检验"></a>方差齐性检验</h2><p>t检验过程，是对两样本均数(mean)差别的显著性进行检验。惟t检验须知道两个总体的方差(Variances)是否相等；t检验值的计算会因方差是否相等而有所不同。也就是说，t检验须视乎方差齐性(Equality of Variances)结果。但现在多数统计软件中已经有了方差不齐情况下的检验。另外，在ANOVA检验中，也要进行方差齐性检验。</p>
<h2 id="t检验"><a href="#t检验" class="headerlink" title="t检验"></a>t检验</h2><p>T检验，亦称student t检验（Student’s t test），主要用于样本含量较小（例如n&lt;30），<strong>总体标准差σ未知</strong>的正态分布资料。</p>
<p>在此要提一下Z检验。<br>Z检验是一般用于<strong>大样本（即样本容量大于30）</strong>平均值差异性检验的方法。它是用<strong>标准正态分布</strong>的理论来推断差异发生的概率，从而比较两个平均数&gt;平均数的差异是否显著。当<strong>已知标准差</strong>时，验证一组数的均值是否与某一期望值相等时，用Z检验。</p>
<p>R中t检验的函数为t.test()，参数如下所示：<br>t.test(x, …)</p>
<p>t.test(x, y = NULL,alternative = c(“two.sided”, “less”, “greater”),mu = 0, paired = FALSE, var.equal = FALSE,      conf.level = 0.95, …)</p>
<p>参数说明：<br>其中x, y是我们样本数据构成的向量，alternative表示备择假设的形式，“two.sided”表示双边检验（H1: 1≠μ2）， “less”表示单边检验（H1:μ1&lt;μ2），“greater”表示单边检验（H1:μ1&gt;μ2），paired表示样本是否是配对的，var.equal表示两总体方差是否相等。</p>
<h3 id="案例运用"><a href="#案例运用" class="headerlink" title="案例运用"></a>案例运用</h3><h4 id="配对t检验"><a href="#配对t检验" class="headerlink" title="配对t检验"></a>配对t检验</h4><p>例3-6为比较两种方法对乳酸饮料中脂肪含量测定结果是否不同，随机抽取了10份乳酸饮料制品，分别用脂肪酸水解法和哥特里－罗紫法测定其结果如表3-5第(1)~(3)栏。问两法测定结果是否不同？</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">raw_data &lt;- read.csv(&quot;https://raw.githubusercontent.com/20170505a/raw_data/master/data_szq_306.csv&quot;,sep=&quot;\t&quot;)</div><div class="line"># read raw data</div><div class="line"></div><div class="line">t.test(raw_data$result[1:10]-raw_data$result[11:20],mu=0)</div></pre></td></tr></table></figure>
<p>结果与书中相同，但我觉得这个方法不一定要用配对t检验，普通的t检验也能胜任。</p>
<h4 id="双样本t检验"><a href="#双样本t检验" class="headerlink" title="双样本t检验"></a>双样本t检验</h4><p>例3-7  为研究国产四类新药阿卡波糖胶囊的降血糖效果，某医院用40名II型糖尿病病人进行同期随机对照试验。研究者将这些病人随机等分到试验组(用阿卡波糖胶囊)和对照组(用拜唐苹胶囊)，分别测得试验开始前和8周时的空腹血糖，算得空腹血糖下降值见表3-6，能否认为该国产四类新药阿卡波糖胶囊与拜唐苹胶囊对空腹血糖的降糖效果不同？</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">raw_data &lt;- read.csv(&quot;https://raw.githubusercontent.com/20170505a/raw_data/master/data_szq_307.csv&quot;,,header=T,sep=&quot;,&quot;)</div><div class="line"></div><div class="line">a &lt;- as.numeric(raw_data[,1])</div><div class="line">b &lt;- as.numeric(raw_data[,2])</div><div class="line">t.test(a,b)</div></pre></td></tr></table></figure>
<p>结果p值为0.525。因此尚不能认为阿卡波糖胶囊与拜唐苹胶囊对空腹血糖的降糖效果不同。</p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/医学统计学/">医学统计学</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/基础统计/">基础统计</a><a href="/tags/基础知识/">基础知识</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2017/06/19/医学统计学-第02章数据描述/" title="数据的描述" itemprop="url">数据的描述</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="RVDSD" target="_blank" itemprop="author">RVDSD</a>
		
  <p class="article-time">
    <time datetime="2017-06-19T10:33:54.000Z" itemprop="datePublished"> 发表于 2017-06-19</time>
    
  </p>
</header>
    <div class="article-content">
        
        <h2 id="常见数据的类型"><a href="#常见数据的类型" class="headerlink" title="常见数据的类型"></a>常见数据的类型</h2><h3 id="离散型数据-discrete-data"><a href="#离散型数据-discrete-data" class="headerlink" title="离散型数据(discrete data)"></a>离散型数据(discrete data)</h3><p>离散型数据本质上是一种分类。最典型的例子，就是性别、种族、职业、教育程度等。在多数情况下，离散型数据并没有具体的数值（比如性别中的男和女），或者虽然形式上由数值表示，但数值本身并没有明确的意义（比如用邮政编码来记录受试者居住的地域）。有些离散变量是有某种顺序关系的，比如说教育程度可以从低到高排列，而有些离散变量并没有这种顺序，比如说某个基因的基因型。这两种情况分别称为有序变量(ordinal variable)和名义变量(nominal variable)。</p>
<h3 id="连续型数据-continuous-data"><a href="#连续型数据-continuous-data" class="headerlink" title="连续型数据(continuous data)"></a>连续型数据(continuous data)</h3><p>连续型数据的数值有具体的科学意义，并且可以在数轴上的某个范围连续取值比如身高、体重、血糖浓度、肾小球滤过率等。</p>
<h2 id="极差"><a href="#极差" class="headerlink" title="极差"></a>极差</h2><p>一组变量值中最大值与最小值的差值。</p>
<h2 id="均值"><a href="#均值" class="headerlink" title="均值"></a>均值</h2><p>太简单，略。</p>
<h3 id="算术均值-arithmatic-mean"><a href="#算术均值-arithmatic-mean" class="headerlink" title="算术均值(arithmatic mean)"></a>算术均值(arithmatic mean)</h3><p>算术平均数是对集中趋势的最常用的描述。我们对某个量进行了n次观测，把测量到的数值分别记为X1, X2,…, Xn，那么要得到算术平均数，只需把X1到Xn加起来，再除以数据的个数n。数学公式为：</p>
<script type="math/tex; mode=display">\bar{X}=\frac{\sum_{i=1}^nX{_i}}{n}</script><h3 id="几何均值（geometric-mean）"><a href="#几何均值（geometric-mean）" class="headerlink" title="几何均值（geometric mean）"></a>几何均值（geometric mean）</h3><p>几何平均数是指n个观察值连乘积的n次方根。</p>
<h2 id="中位数-median"><a href="#中位数-median" class="headerlink" title="中位数(median)"></a>中位数(median)</h2><p>中位数是把该变量所有取值从小到大（或从大到小）排序，取最中间的一个（例如总共有21个数，则取排行第11的）。如果样本量是偶数，则取中间两个数的平均。</p>
<h2 id="众数"><a href="#众数" class="headerlink" title="众数"></a>众数</h2><p>一组数据中出现次数最多的数值，叫众数，有时众数在一组数中有好几个。用M表示。 理性理解：简单的说，就是一组数据中占比例最多的那个数。</p>
<p>例如：2，3，3，3，4，5的众数是3。 但是，如果有两个或两个以上个数出现次数都是最多的，那么这几个数都是这组数据的众数。 例如：2，2，3，3，4，5的众数是2和3。 其次，如果所有数据出现的次数都一样，那么这组数据没有众数。 例如：2，3，4，5没有众数。</p>
<h2 id="百分位数-percentile"><a href="#百分位数-percentile" class="headerlink" title="百分位数(percentile)"></a>百分位数(percentile)</h2><p>如果将一组数据从小到大排序，并计算相应的累计百分位，则某一百分位所对应数据的值就称为这一百分位的百分位数。可表示为：一组n个观测值按数值大小排列。如，处于p%位置的值称第p百分位数。</p>
<h3 id="百分位数的计算"><a href="#百分位数的计算" class="headerlink" title="百分位数的计算"></a>百分位数的计算</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">w&lt;-c(75.0,64.0,47.4,66.9,62.2,62.2,58.7,63.5,66.6,64.0,57.0,69.0,56.9,50.0,72.0) # 建立向量w</div><div class="line">quantile(w) # 给出w的四分位数</div><div class="line">quantile(w,probs=seq(0,1,0.2),na.rm=FALSE) # 给出向量w的20%，40%分位数</div><div class="line">quantile(w,0.80) # 求w的80%分位数</div><div class="line">quantile(w,0.75)- quantile(w,0.25) #半极差计算</div></pre></td></tr></table></figure>
<p>结果如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">&gt; quantile(w) # 给出w的四分位数</div><div class="line">   0%   25%   50%   75%  100% </div><div class="line">47.40 57.85 63.50 66.75 75.00 </div><div class="line">&gt; quantile(w,probs=seq(0,1,0.2),na.rm=FALSE) # 给出向量w的20%，40%分位数</div><div class="line">   0%   20%   40%   60%   80%  100% </div><div class="line">47.40 56.98 62.20 64.00 67.32 75.00 </div><div class="line">&gt; quantile(w,0.80) # 求w的80%分位数</div><div class="line">  80% </div><div class="line">67.32 </div><div class="line">&gt; quantile(w,0.75)- quantile(w,0.25) #半极差计算</div><div class="line">75% </div><div class="line">8.9</div></pre></td></tr></table></figure></p>
<p>另外一种方法是用<code>cumsum()</code>函数来计算：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">cumsum(round(table(w)/length(w)*100,2)) # cumsum表示的是累积之和</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&gt; cumsum(round(table(w)/length(w)*100,2)) # cumsum表示的是累积之和</div><div class="line">  47.4     50   56.9     57   58.7   62.2   63.5     64   66.6   66.9     69     72     75 </div><div class="line">  6.67  13.34  20.01  26.68  33.35  46.68  53.35  66.68  73.35  80.02  86.69  93.36 100.03</div></pre></td></tr></table></figure>
<h2 id="四分位数（Quartile"><a href="#四分位数（Quartile" class="headerlink" title="四分位数（Quartile)"></a>四分位数（Quartile)</h2><p>统计学中，把所有数值由小到大排列并分成四等份，处于三个分割点位置的数值就是四分位数。第一，四分位数 (Q1)，又称“较小四分位数”，等于该样本中所有数值由小到大排列后第25%的数字。第二，四分位数 (Q2)，又称“中位数”，等于该样本中所有数值由小到大排列后第50%的数字。第三，四分位数 (Q3)，又称“较大四分位数”，等于该样本中所有数值由小到大排列后第75%的数字。第三，四分位数与第一四分位数的差距又称四分位距（InterQuartile Range,IQR）。四分位距的优点在于，与全距（极差）相比，较少受异常值的影响。 R中用来显示四分位数的函数是quantile，另外用boxplot可以绘制出某个数据集的箱线图。</p>
<p>箱线图结果<code>boxplot(w)</code>如下所示<img src="http://ortxpw68f.bkt.clouddn.com/boxplot2.png" alt=""></p>
<p>条睛线图的解读：最下面是下界，最上面的圆圈是上界，上界的圆圈是异常值，中间矩形的底边是下分位数，上边是上四分位数，中间的粗线是中位数，箱体的高是四分位距<br>。</p>
<h2 id="极差-1"><a href="#极差-1" class="headerlink" title="极差"></a>极差</h2><p>又叫全距(Range)，是用来表示统计资料中的变异量数(measures of variation)，其最大值与最小值之间的差距；即最大值减最小值后所得之数据。</p>
<h2 id="四分位数"><a href="#四分位数" class="headerlink" title="四分位数"></a>四分位数</h2><p>把所有数据点从小到大排列，并且分成样本量相等的四块。那么，这四块之间就会产生三个分界点（称为四分位点，quartile)，从小到大分别用Q1, Q2, Q3表示。如果我们取Q3和Q1之差，那么这就是四分位差(interquartile range)，也称为内距。由于四分位差不考虑首尾两端的数据点。</p>
<h2 id="变异系数-coefficient-of-variation"><a href="#变异系数-coefficient-of-variation" class="headerlink" title="变异系数(coefficient of variation)"></a>变异系数(coefficient of variation)</h2><p>简称为CV，标准差与均值的比值。公式为：</p>
<script type="math/tex; mode=display">CV=\frac{S}{\bar{X}}\times100\%</script><h2 id="箱线图和频率直方图"><a href="#箱线图和频率直方图" class="headerlink" title="箱线图和频率直方图"></a>箱线图和频率直方图</h2><p>箱线图(boxplot)汇集了中位数、四分位差以及一些其他信息，能够使我们对样本的分布有一个直观的了解，也可以让我们快速发现数据中可能存在的错误（例如因为数据录入或单位错误导致的异常值）。它之所以被称为箱线图，是因为它用一个“箱子”来表示我们的数据中最靠中间的一半（即Q1和Q3之间的所有数据点），而用箱子上下的两根“胡须”来表示数据的上下限范围。箱线图的画法以及含义见下图。</p>
<h2 id="方差"><a href="#方差" class="headerlink" title="方差"></a>方差</h2><p>方差（variance）也称均方差（mean square deviation），它反映的是一组数据的平均离散水平，就总体而言，应该考虑每一个变量值X与均数u的差值，即离均差(X-$\mu$)，由于离均差(X-$\mu$)有正有负，最终所有==离均差的和$(X-\mu)$==为0，因此离均差的和无法描述一组数据的变异大小。因此将离均差平方后相加得到平方和$Var(X)=E(X-\mu)^2$，这就是==离均差平方和（sum of squares of deviations from mean）==，这就消除了正负的影响。虽然离均差平方和消除了正负的影响，但是如果变量值N越大，则离均差平方和也越大，为此，将离均离平方和除以N就得到了方差，方差用$\delta^2$表示，计算公式为：</p>
<script type="math/tex; mode=display">\delta^2={\frac{\sum(X-\mu)^2}{N}}</script><h2 id="标准差"><a href="#标准差" class="headerlink" title="标准差"></a>标准差</h2><p>标准差（standard deviation）是方差的正平方根，其单位与原变量值的单位相同，总体标准差用表示，计算公式为：</p>
<script type="math/tex; mode=display">\delta=\sqrt{\frac{\sum(X-\mu)^2}{N}}</script><h3 id="标准差计算函数"><a href="#标准差计算函数" class="headerlink" title="标准差计算函数"></a>标准差计算函数</h3><p>在Excel中计算方差的公式为<code>STDEV.P</code>和<code>STDEV.S</code>其中，STDEV.P计算时，认为你给出的数据是总体，因此它的分母为N，而STDEV.S计算时，认为你给出的数据是样本，因此它的分母为N-1。</p>
<p>而在R中，用到的函数为<code>sd</code>，默认的就是样本，因此分母为N-1。</p>
<h3 id="样本标准差"><a href="#样本标准差" class="headerlink" title="样本标准差"></a>样本标准差</h3><p>一般情况下，总体均数$\mu$未知，需要用样本无数估计，数理统计证明：若用样本个数n来代替N，计算出的样本方差对的估计偏小，需要将n用n-1来替代，样本方差</p>
<script type="math/tex; mode=display">S=\sqrt{\frac{\sum(X-\bar{X})^2}{n-1}}</script><h2 id="标准误与标准差的区别"><a href="#标准误与标准差的区别" class="headerlink" title="标准误与标准差的区别"></a>标准误与标准差的区别</h2><p>在医学统计中，还经常遇到标准差与标准误。例如我们要调查地区A中10岁男孩的身高。如果全部都统计下来，直接测是最准确的数据。但是成本高，不现实。因此需要进行采样，一次测量100个男孩的身高，求这一次的均值M1与标准差S1，如果采样10次，每次都取100人，我们会得到10个均值，分别记为M1，M2，M3…M10，对这10个均值再求一个均值M以及标准差S，其中这个标准差S就是标准误，即均值的标准差。</p>
<h3 id="标准误与标准差的联系"><a href="#标准误与标准差的联系" class="headerlink" title="标准误与标准差的联系"></a>标准误与标准差的联系</h3><p>SEM表示每次抽样获得的均数的标准差，因此如果要获取SEM，就必须做很多次抽样，这样也非常麻烦，但是标准误与标准差虽然不是一个概念，但在数学上有一定的联系，其公式如下所示：</p>
<script type="math/tex; mode=display">SEM=SD/\sqrt{N}</script><h2 id="正态分布"><a href="#正态分布" class="headerlink" title="正态分布"></a>正态分布</h2><p>若随机变量X服从一个数学期望为$\mu$、方差为${\sigma}^2$的正态分布，记为$N(\mu,{\sigma}^2)$。其概率密度函数为正态分布的期望值$\mu$决定了其位置，其标准差$\sigma$决定了分布的幅度。因其曲线呈钟形，因此人们又经常称之为钟形曲线。我们通常所说的标准正态分布，即$\mu$ = 0,$\sigma$ = 1的正态分布，其公式为：</p>
<script type="math/tex; mode=display">p(x|\mu,\sigma)=\mathcal{N}(x|\mu,\sigma)=\frac{1}{\sigma\sqrt{2\pi}}\exp(-\frac{(x-\mu)^2}{2\sigma^2})</script><h2 id="医学参考值"><a href="#医学参考值" class="headerlink" title="医学参考值"></a>医学参考值</h2><p>医学参考值（reference value）是指包括约大多数正常人的人体形态、功能和代谢产物等各种生理及生化指标常数，也称正常值。由于存在个体差异，生物医学数据并非常数而是在一定范围内波动，帮采用学参考值范围（medical reference range）作为判定正常和异常的参考标准。<br>医学参考值范围涉及采用单侧界值还是双侧界值的问题，这通常是依据医学专业知识而定，例如课本（医学统计学，孙振球，第四版）中的例2-1的红细胞数无论过低或过高均属异常，就采用双侧参考值范围制定下侧和上侧界值；血清转氨酶仅过高异常，应采用单侧参考值范围制定上侧界值；肺活量仅过低异常，就采用单侧参考值范围制定下侧界值。医学上常用的参考值范围有90%，95%，99%等，其中95%最常用。</p>
<p>其中确定参考值的方法通常有两种，分别为正态分布法和百分位数法。</p>
<h3 id="正态分布法"><a href="#正态分布法" class="headerlink" title="正态分布法"></a>正态分布法</h3><p>对于服从正态分布的医学数据，可采用正态分布法计算参考值的范围，其计和公式为：<br>双侧1-$1-\alpha$参考值范围为：$\bar{X}\pm\mu<em>{\alpha/2}S$<br>单侧1-$\alpha$的参考值范围为：$&gt;\bar{X}-\mu</em>{\alpha/2}S$。<br>其中$bar{X}$为无数，S为标准差，$\mu$值可以查表得到。</p>
<p>案例：现在我们计算课本<sup><a href="#fn_１" id="reffn_１">１</a></sup>例2-1的资料估计正常成年女子的红细胞数的95%的参考值范围。计算结果如下所示：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">raw_data &lt;- read.csv(&quot;https://raw.githubusercontent.com/20170505a/raw_data/master/data_szq_201.csv&quot;) #导入数据</div><div class="line">extract_data &lt;- raw_data[,1] # 提取第一列数据</div><div class="line">sd1 &lt;- sd(extract_data)</div><div class="line">mean1 &lt;- mean(extract_data)</div><div class="line">mean1 - 1.96*sd1 # 参考值的下限</div><div class="line">mean1 + 1.96*sd1 # 参考值的上限</div></pre></td></tr></table></figure></p>
<p>因此参考值的范围为3.353299，5.104657。</p>
<h3 id="百分位数法"><a href="#百分位数法" class="headerlink" title="百分位数法"></a>百分位数法</h3><p>偏态分布资料医学参考值范围的制定通常采用百分位数法，所要求的样本含量比正态分布法要多（不低于100），其计算公式为：<br>双侧$1-\alpha$参透值范围为：$P<em>{100\alpha/2}{\sim}P</em>{100-100\alpha/2}$</p>
<p>单侧$1-\alpha$参透值范围为：$&gt;P<em>{100\alpha}$或$&gt;P</em>{100-100\alpha}$<br>案例：课本无原始数据，此题略过。</p>
<h2 id="补充：部分例题的计算"><a href="#补充：部分例题的计算" class="headerlink" title="补充：部分例题的计算"></a>补充：部分例题的计算</h2><h3 id="例题2-1的描述性统计"><a href="#例题2-1的描述性统计" class="headerlink" title="例题2-1的描述性统计"></a>例题2-1的描述性统计</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div></pre></td><td class="code"><pre><div class="line">raw_data &lt;- read.csv(&quot;https://raw.githubusercontent.com/20170505a/raw_data/master/data_szq_201.csv&quot;) </div><div class="line">#导入数据</div><div class="line"></div><div class="line">extract_data &lt;- raw_data[,1] </div><div class="line"># 提取第一列数据</div><div class="line"></div><div class="line">library(reshape2)</div><div class="line">breaks&lt;-seq(from = 3.07, to = 5.47, by = 0.2) </div><div class="line"># 产生各个组距</div><div class="line"></div><div class="line">data_table&lt;-cut(extract_data,breaks=breaks,right=FALSE) </div><div class="line">#分组,right=FALSE表示左闭右开</div><div class="line"></div><div class="line">library(reshape2) </div><div class="line">#载入reshape2包，使用其中的melt函数</div><div class="line"></div><div class="line">melt(table(data_table)) </div><div class="line">#查看频数分布</div><div class="line"></div><div class="line">middle_data&lt;-c() </div><div class="line">#求组中值，组中值从表中可以看出来就是区间两边的数的平均数</div><div class="line"></div><div class="line">for(i in seq(1,12))&#123;</div><div class="line">  middle &lt;- (breaks[i]+breaks[i+1])*0.5</div><div class="line">  middle_data&lt;-append(middle_data,middle)</div><div class="line">&#125;</div><div class="line"></div><div class="line"># 绘图表</div><div class="line">hist(extract_data,breaks,</div><div class="line">     right=FALSE,main=&quot;&quot;,</div><div class="line">     xlab=&quot;&quot;,ylab=&quot;频数&quot;,</div><div class="line">     axes=FALSE,</div><div class="line">     border=&quot;grey&quot;,</div><div class="line">     col=&quot;red&quot;,freq=F)</div><div class="line">#data为数据集，breaks则是分组依据，right=FALSE则是左开右闭,xlab，ylab控制坐标</div><div class="line"></div><div class="line">lines(density(extract_data)) </div><div class="line">#加入概率密度曲线</div><div class="line"></div><div class="line">title(xlab=&quot;红细胞数(×10e-12/L)&quot;,line=0.8)</div><div class="line">#加x轴的标题，往下超过x轴垂直距离为0.8个行距</div><div class="line"></div><div class="line">text(4.5,-2.8,&quot;-12&quot;,cex=0.5)</div><div class="line">mtext(&quot;138名正常成年女性红细胞数的频数分布&quot;,1,line=2.5,cex=1.2,font=2)</div><div class="line">#加主标题,1表示为下方</div><div class="line"># line=2.5表示超过x轴垂直距离为2.5个行距</div><div class="line"># cex为字体扩大倍数</div><div class="line"># font=2表示加粗</div><div class="line"></div><div class="line">abline(h=0)</div><div class="line">#绘制y=0的线段，用此线表示x轴</div><div class="line"></div><div class="line">axis(1,at=middle_data,tick=FALSE,pos=0.03)</div><div class="line"># 绘制x轴，坐标为middle_data</div><div class="line"># tick=FALSE表示坐标刻度不绘出,pos=1表示坐标轴在y=1处</div><div class="line"></div><div class="line">axis(2)</div><div class="line">#绘制y轴</div></pre></td></tr></table></figure>
<p>频数分布如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">&gt; melt(table(data_table)) #查看频数分布</div><div class="line">    data_table value</div><div class="line">1  [3.07,3.27)     2</div><div class="line">2  [3.27,3.47)     3</div><div class="line">3  [3.47,3.67)     9</div><div class="line">4  [3.67,3.87)    14</div><div class="line">5  [3.87,4.07)    22</div><div class="line">6  [4.07,4.27)    30</div><div class="line">7  [4.27,4.47)    21</div><div class="line">8  [4.47,4.67)    15</div><div class="line">9  [4.67,4.87)    10</div><div class="line">10 [4.87,5.07)     6</div><div class="line">11 [5.07,5.27)     4</div><div class="line">12 [5.27,5.47)     2</div></pre></td></tr></table></figure>
<p>图表如下所示<img src="http://ortxpw68f.bkt.clouddn.com/fig21.png" alt="">：</p>
<p>对例2-1，例2-2和例2-14已计算出某医院随机抽查的138名成年女子的红细胞数均数 ，标准差 。试估计该医院所抽查成年女子的红细胞数：①在4.0 以下者占成年女子总人数的百分比；②在4.00~5.00 之间者占成年女子总人数的百分比；③在5.00 以上者占成年女子总人数的百分比。<br>计算过程如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">mean.data &lt;- mean(extract_data)</div><div class="line">sd.data &lt;- sd(extract_data)</div><div class="line">pnorm((4-mean.data)/sd.data) # 4.0以下的百分比</div><div class="line">pnorm((5-mean.data)/sd.data) #5.0以下的百分比</div><div class="line">1-pnorm((5-mean.data)/sd.data) #5.0以上的百分比</div><div class="line">pnorm((5-mean.data)/sd.data)-pnorm((4-mean.data)/sd.data) #在4.00~5.00 之间的百分比</div><div class="line"></div><div class="line">#或者是：</div><div class="line">pnorm(5,mean(data),sd(data))-pnorm(4,mean(data),sd(data))</div><div class="line"></div><div class="line"># 绘制数据集的正态分布图</div><div class="line">x &lt;- seq(min(extract_data)-0.52,max(extract_data)+0.52,length=1000)</div><div class="line">y &lt;- dnorm(x,mean(extract_data),sd(extract_data))</div><div class="line">r1 &lt;- 4</div><div class="line">r2 &lt;- 5</div><div class="line">x2 &lt;- c(r1,r1,x[x&lt;r2&amp;x&gt;r1],r2,r2)</div><div class="line">y2=c(0,dnorm(c(r1,x[x&lt;r2&amp;x&gt;r1],r2),mean(data),sd(data)),0)</div><div class="line">plot(x,y,type=&quot;l&quot;,xlab=&quot;&quot;,ylab=&quot;&quot;,lty=1)</div><div class="line">abline(0,0)</div><div class="line">polygon(x2,y2,col=&quot;grey&quot;)</div></pre></td></tr></table></figure></p>
<p><strong>结果如下所示：</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">[1] 0.3041459</div><div class="line">&gt; pnorm((5-mean.data)/sd.data) #5.0以下的百分比</div><div class="line">[1] 0.9578038</div><div class="line">&gt; 1-pnorm((5-mean.data)/sd.data) #5.0以上的百分比</div><div class="line">[1] 0.04219616</div><div class="line">&gt; pnorm((5-mean.data)/sd.data)-pnorm((4-mean.data)/sd.data) #在4.00~5.00 之间的百分比</div><div class="line">[1] 0.653658</div><div class="line">&gt; pnorm(5,mean(data),sd(data))-pnorm(4,mean(data),sd(data))</div><div class="line">[1] 0.6532998</div><div class="line">结果与书中的不太一样，但结果接近，我估计是因为书中是查表，用的是近似值，R中的比较精确</div></pre></td></tr></table></figure></p>
<p>数据的正态分布图如下所示<img src="http://ortxpw68f.bkt.clouddn.com/fig22.png" alt="">：</p>
<h3 id="例2-4：几何均数"><a href="#例2-4：几何均数" class="headerlink" title="例2-4：几何均数"></a>例2-4：几何均数</h3><p>某地5例微丝蚴血症患者治疗7年后用间接荧光抗体试验没得某抗体满意度例数分别为10，20，40，40，160，求几何均数。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">data24&lt;-c(10,20,40,40,160)</div><div class="line">exp(mean(log(data24)))</div></pre></td></tr></table></figure>
<p>结果如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&gt; data24</div><div class="line">[1]  10  20  40  40 160</div><div class="line">&gt; exp(mean(log(data24)))</div><div class="line">[1] 34.82202</div></pre></td></tr></table></figure></p>
<h3 id="例2-5-平均抗体滴度"><a href="#例2-5-平均抗体滴度" class="headerlink" title="例2-5 平均抗体滴度"></a>例2-5 平均抗体滴度</h3><p>69例风湿关节炎(RA)患者血清EBV-VCA-IgG抗体满意度的分布，求其平均抗体滴度。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">data25&lt;-c(10,40,80,160,160,320,640,640,10,40,80,160,160,320,640,640,</div><div class="line">10,40,80,160,320,320,640,640,10,40,80,160,320,320,640,640,20,40,80,</div><div class="line">160,320,320,640,1280,20,40,80,160,320,320,640,1280,20,40,80,160,320,</div><div class="line">320,640,40,40,80,160,320,320,640,40,80,80,160,320,640,640)</div><div class="line">x &lt;- table(data25)</div><div class="line">x &lt;- data.frame(x)</div><div class="line">x$countdown &lt;- as.numeric(levels(x$data25))</div><div class="line">x$lgX &lt;- round(log10(x$countdown),4)</div><div class="line">x$flgX &lt;- round(x$Freq*x$lgX,4)</div></pre></td></tr></table></figure>
<p>结果为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">&gt; x</div><div class="line">  data25 Freq countdown    lgX    flgX</div><div class="line">1     10    4        10 1.0000  4.0000</div><div class="line">2     20    3        20 1.3010  3.9030</div><div class="line">3     40   10        40 1.6021 16.0210</div><div class="line">4     80   10        80 1.9031 19.0310</div><div class="line">5    160   11       160 2.2041 24.2451</div><div class="line">6    320   15       320 2.5051 37.5765</div><div class="line">7    640   14       640 2.8062 39.2868</div><div class="line">8   1280    2      1280 3.1072  6.2144</div><div class="line"></div><div class="line">上述结果是书中的频数表，与R的计算关系不大，在R中可以直接计算，如下</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; exp(mean(log(data25)))</div><div class="line">[1] 150.6411</div></pre></td></tr></table></figure>
<h3 id="例2-6-中位数"><a href="#例2-6-中位数" class="headerlink" title="例2-6  中位数"></a>例2-6  中位数</h3><p>7名病人患某病的潜伏期分别为2，3，4，5，6，9，16天，求其中位数。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&gt; data26&lt;-c(2,3,4,5,6,9,16)</div><div class="line">&gt; median(data26)</div><div class="line">[1] 5</div></pre></td></tr></table></figure>
<h3 id="例2-11：均数和极差"><a href="#例2-11：均数和极差" class="headerlink" title="例2-11：均数和极差"></a>例2-11：均数和极差</h3><p>试计算下面三组同龄男孩的身高 均数和极差。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">range.f &lt;- function (x) (max(x)-min(x))</div><div class="line">甲组 &lt;- c(90,95,100,105,110)</div><div class="line">乙组 &lt;- c(96,98,100,102,104)</div><div class="line">丙组 &lt;- c(96,99,100,101,104)</div><div class="line">range.f(甲组)</div><div class="line">mean(甲组)</div><div class="line">range.f(乙组)</div><div class="line">mean(乙组)</div><div class="line">range.f(丙组)</div><div class="line">mean(丙组)</div></pre></td></tr></table></figure></p>
<p>结果如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">&gt; range.f(甲组)</div><div class="line">[1] 20</div><div class="line">&gt; mean(甲组)</div><div class="line">[1] 100</div><div class="line">&gt; range.f(乙组)</div><div class="line">[1] 8</div><div class="line">&gt; mean(乙组)</div><div class="line">[1] 100</div><div class="line">&gt; range.f(丙组)</div><div class="line">[1] 8</div><div class="line">&gt; mean(丙组)</div><div class="line">[1] 100</div></pre></td></tr></table></figure>
<blockquote id="fn_１">
<sup>１</sup>. 如无特殊注明，课本均指的是：孙振球 and 徐勇勇 (2014). 医学统计学.第4版, 人民卫生出版社.<a href="#reffn_１" title="Jump back to footnote [１] in the text."> &#8617;</a>
</blockquote>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/医学统计学/">医学统计学</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/基础统计/">基础统计</a><a href="/tags/基础知识/">基础知识</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2017/06/18/医学统计学-第01章绪论/" title="医学统计学术语" itemprop="url">医学统计学术语</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="RVDSD" target="_blank" itemprop="author">RVDSD</a>
		
  <p class="article-time">
    <time datetime="2017-06-18T04:00:00.000Z" itemprop="datePublished"> 发表于 2017-06-18</time>
    
  </p>
</header>
    <div class="article-content">
        
        <h2 id="观察单位（observed-unit）"><a href="#观察单位（observed-unit）" class="headerlink" title="观察单位（observed unit）"></a>观察单位（observed unit）</h2><p>也叫个体（individual），是统计研究中的基本单位，它可以是一个人，一头动物，也可能是特指一群人（例如一个家庭、一个幼儿园，一个自然村）。</p>
<h2 id="总体（population）"><a href="#总体（population）" class="headerlink" title="总体（population）"></a>总体（population）</h2><p>根据研究目的而确定的同质观察单位的全体，更确切地说，它是同质的所有观察单位某种观察值的集合，例如调查某地2008年7岁正常女童的身高，而其中的观察单位（个体）则是每个女童。由于这里的总体明确规定了空间、时间、人群范围内有限个观察单位，因此称为<strong>有限总体（finite populaton）</strong>。而在一些情况下，总体的概念则是设想的或抽象的，例如研究某治疗慢性前列腺增生的药物的疗效，这里的总体的同质基础是慢性前列腺增生患者，该总体应包括用该药治疗的所有前列腺增生症患者的治疗结果，没有时间和空间的限制，其观察单位的全体数只是理论上存在的，因此可以视为“无限”，称为<strong>无限总体（infinite populaton）</strong>。</p>
<p>  为了降低成本，因此在医学研究中通常彩从总体中抽取样本（sample）的方法，根据样本信息来推断总体特征，这种方法叫<strong>抽样研究（sampling research）</strong>，从总体中抽取部分观察单位的过程称为<strong>抽样（sampling）</strong>。</p>
<p>  为了保证样本的代表性，抽样必须遵循<strong>随机化（randomizatoin）</strong>原则。从总体中随机抽得的部分观察单位，其实际测量的集合就是样本，该样本中包含的观察单位数称为该样本的<strong>样本含量（sample size）</strong>。例中从某地2008年7岁正常女童中，随机抽取了110名女童，测量身高，得到了110名女童的身高测量值，组成了样本；也可能从就诊的前列腺增生症患者中随机抽取了100名患者，并观察药物的治疗效果，就组成了治疗效果的样本。</p>
<h2 id="变量（variable）："><a href="#变量（variable）：" class="headerlink" title="变量（variable）："></a>变量（variable）：</h2><p>  确定总体后，研究者对每个观察单位的某项特征进行观察或测量，这种特征能表现观察单位的变量异，就是变量。例如某地7岁女童的身高，体重都可以视为变量。</p>
<h2 id="计量资料（measurement-data）"><a href="#计量资料（measurement-data）" class="headerlink" title="计量资料（measurement data）"></a>计量资料（measurement data）</h2><p>  又叫定量资料（quantitative data）或数值变量资料(numerical variable)，表现为数值大小，一般有试题衡单位，例如身高多少厘米，体重多少公斤。根据测量值是否连续，又可分为连续型（continuous）和离散型（discrete），连续理革可在褛范围内聚任意值，例如身高，体重，而离散型只能取整数值，例如死亡人数。</p>
<h2 id="计数资料（enumeration-data）"><a href="#计数资料（enumeration-data）" class="headerlink" title="计数资料（enumeration data）"></a>计数资料（enumeration data）</h2><p>  又称定性资料(qualitative data )或无序分类（unordered categorical varibale）变量资料，亦称为名义变量资料，它的变量值是定性的，表现为互不相容的特性，例如结果的阴阳，家族史的有无等，分为两种：一种是二分类，例如治愈与未治愈，另一种是多分类，例如血型，A型，B型，AB型和O型。</p>
<h2 id="等级资料（ranked-data）"><a href="#等级资料（ranked-data）" class="headerlink" title="等级资料（ranked data）"></a>等级资料（ranked data）</h2><p>  又称半定量资料（semi-quantitative data）或有序分类变量（ordinal categorical variable）资料：它将观察单位按某种程度分为等级，例如某药物治疗的效果为治愈、显效、好转、无效。</p>
<h2 id="其它补充"><a href="#其它补充" class="headerlink" title="其它补充"></a>其它补充</h2><h3 id="强度相对数"><a href="#强度相对数" class="headerlink" title="强度相对数"></a>强度相对数</h3><p>说明某现象发生的频率或强度，称为率。常以百分率(%)、千分率(‰)、万分率(1/万)、十万分率（1/10万）等表示。<br> 例5-1：2839名职工，发生高血压5人，高血压发病率为5/2839=1.76‰。</p>
<h3 id="结构相对数"><a href="#结构相对数" class="headerlink" title="结构相对数"></a>结构相对数</h3><p>表示事物内部某一部分的个体数与该事物部分个体数的总和之比，用来说明各构成部分在总体中所占的比重或分布，称为构成比，通常以100%为比例基数。<br>例5-2  某医院1990年因五种疾病死亡的人数共190人，其中死于恶性肿瘤者58人，恶性肿瘤死亡人数占五种疾病死亡人数的构成比为58/190=30.53% 。</p>
<h3 id="相对比"><a href="#相对比" class="headerlink" title="相对比"></a>相对比</h3><p>相对比简称比(ratio)，是两个有关指标之比，说明两指标间的比例关系，通常以倍数或百分数（%）表示。例如某年医院出生婴儿中，男性为370，女性为358，则婴儿性别比为370/358*100=103</p>
<h3 id="同比"><a href="#同比" class="headerlink" title="同比"></a>同比</h3><p>发展速度主要是为了消除季节变动的影响，用以说明本期发展水平与去年同期发展水平对比而达到的相对发展速度。如，本期2月比去年2月，本期6月比去年6月等。其计算公式为：同比发展速度=本期发展水平/去年同期发展水平×100%。</p>
<h3 id="环比"><a href="#环比" class="headerlink" title="环比"></a>环比</h3><p>当前水平与前一时期水平之比，表明现象逐期的发展速度。如计算一年内各月与前一个月对比，即2月比1月，3月比2月，4月比3月 ……12月比11月，说明逐月的发展程度。</p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/医学统计学/">医学统计学</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/基础统计/">基础统计</a><a href="/tags/基础知识/">基础知识</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>







  <nav id="page-nav" class="clearfix">
    <a class="extend prev" rel="prev" href="/"><span></span>Prev</a><a class="page-number" href="/">1</a><span class="page-number current">2</span>
  </nav>

</div>
      <div class="openaside"><a class="navbutton" href="#" title="显示侧边栏"></a></div>

<div id="asidepart">
<div class="closeaside"><a class="closebutton" href="#" title="隐藏侧边栏"></a></div>
<aside class="clearfix">

  


  
<div class="categorieslist">
	<p class="asidetitle">分类</p>
		<ul>
		
		  
			<li><a href="/categories/医学统计学/" title="医学统计学">医学统计学<sup>7</sup></a></li>
		  
		
		  
			<li><a href="/categories/文献笔记/" title="文献笔记">文献笔记<sup>3</sup></a></li>
		  
		
		  
			<li><a href="/categories/生物信息学/" title="生物信息学">生物信息学<sup>2</sup></a></li>
		  
		
		  
			<li><a href="/categories/生物实验笔记/" title="生物实验笔记">生物实验笔记<sup>8</sup></a></li>
		  
		
		</ul>
</div>


  
<div class="tagslist">
	<p class="asidetitle">标签</p>
		<ul class="clearfix">
		
			
				<li><a href="/tags/基础知识/" title="基础知识">基础知识<sup>9</sup></a></li>
			
		
			
				<li><a href="/tags/基础统计/" title="基础统计">基础统计<sup>7</sup></a></li>
			
		
			
				<li><a href="/tags/分子生物学/" title="分子生物学">分子生物学<sup>7</sup></a></li>
			
		
			
				<li><a href="/tags/生物工具/" title="生物工具">生物工具<sup>6</sup></a></li>
			
		
			
				<li><a href="/tags/病毒包装/" title="病毒包装">病毒包装<sup>6</sup></a></li>
			
		
			
				<li><a href="/tags/知识背景/" title="知识背景">知识背景<sup>5</sup></a></li>
			
		
			
				<li><a href="/tags/实验方法/" title="实验方法">实验方法<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/天然免疫/" title="天然免疫">天然免疫<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/生物信息学/" title="生物信息学">生物信息学<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/分子克隆/" title="分子克隆">分子克隆<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/基因敲除/" title="基因敲除">基因敲除<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/斑马鱼/" title="斑马鱼">斑马鱼<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/文献阅读/" title="文献阅读">文献阅读<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/软件安装/" title="软件安装">软件安装<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/Linux/" title="Linux">Linux<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/Python/" title="Python">Python<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/基因编辑/" title="基因编辑">基因编辑<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/生物技术/" title="生物技术">生物技术<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/RNA-Seq/" title="RNA-Seq">RNA-Seq<sup>1</sup></a></li>
			
		
		</ul>
</div>


  <div class="linkslist">
  <p class="asidetitle">友情链接</p>
    <ul>
        
          <li>
            
            	<a href="https://coderq.com" target="_blank" title="一个面向程序员交流分享的新一代社区">码农圈</a>
            
          </li>
        
          <li>
            
            	<a href="http://wuchong.me" target="_blank" title="Jark&#39;s Blog">Jark&#39;s Blog</a>
            
          </li>
        
    </ul>
</div>

  


  <div class="rsspart">
	<a href="/atom.xml" target="_blank" title="rss">RSS 订阅</a>
</div>

  <div class="weiboshow">
  <p class="asidetitle">新浪微博</p>
    <iframe width="100%" height="119" class="share_self"  frameborder="0" scrolling="no" src="http://widget.weibo.com/weiboshow/index.php?language=&width=0&height=119&fansRow=2&ptype=1&speed=0&skin=9&isTitle=1&noborder=1&isWeibo=0&isFans=0&uid=&verifier=b3593ceb&dpc=1"></iframe>
</div>


</aside>
</div>
    </div>
    <footer><div id="footer" >
	
	<div class="line">
		<span></span>
		<div class="author"></div>
	</div>
	
	
	<section class="info">
		<p> Hello ,I&#39;m Larry Page in Google. <br/>
			This is my blog,believe it or not.</p>
	</section>
	 
	<div class="social-font" class="clearfix">
		
		<a href="http://weibo.com/2176287895" target="_blank" class="icon-weibo" title="微博"></a>
		
		
		
		
		
		
		
		
		
		
	</div>
			
		

		<p class="copyright">
		Powered by <a href="http://hexo.io" target="_blank" title="hexo">hexo</a> and Theme by <a href="https://github.com/wuchong/jacman" target="_blank" title="Jacman">Jacman</a> © 2017 
		
		<a href="/about" target="_blank" title="RVDSD">RVDSD</a>
		
		
		</p>
</div>
</footer>
    <script src="/js/jquery-2.0.3.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/jquery.qrcode-0.12.0.min.js"></script>

<script type="text/javascript">
$(document).ready(function(){ 
  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      o = $('.openaside');
  c.click(function(){
    a.addClass('fadeOut').css('display', 'none');
    o.css('display', 'block').addClass('fadeIn');
    m.addClass('moveMain');
  });
  o.click(function(){
    o.css('display', 'none').removeClass('beforeFadeIn');
    a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');      
    m.removeClass('moveMain');
  });
  $(window).scroll(function(){
    o.css("top",Math.max(80,260-$(this).scrollTop()));
  });
  
  $(window).resize(function(){
    getSize(); 
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else{
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      o.css('display', 'none');
        
    }
  });
});
</script>










<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
$(document).ready(function(){ 
  $('.article-content').each(function(i){
    $(this).find('img').each(function(){
      if ($(this).parent().hasClass('fancybox')) return;
      var alt = this.alt;
      if (alt) $(this).after('<span class="caption">' + alt + '</span>');
      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox"></a>');
    });
    $(this).find('.fancybox').each(function(){
      $(this).attr('rel', 'article' + i);
    });
  });
  if($.fancybox){
    $('.fancybox').fancybox();
  }
}); 
</script>



<!-- Analytics Begin -->



<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?e6d1f421bbc9962127a50488f9ed37d1";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>



<!-- Analytics End -->

<!-- Totop Begin -->

	<div id="totop">
	<a title="返回顶部"><img src="/img/scrollup.png"/></a>
	</div>
	<script src="/js/totop.js"></script>

<!-- Totop End -->

<!-- MathJax Begin -->
<!-- mathjax config similar to math.stackexchange -->

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


<!-- MathJax End -->

<!-- Tiny_search Begin -->

<!-- Tiny_search End --><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({"tex2jax":{"inlineMath":[["$","$"],["\\(","\\)"]],"skipTags":["script","noscript","style","textarea","pre","code"],"processEscapes":true},"TeX":{"equationNumbers":{"autoNumber":"AMS"}}});
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->

  </body>
 </html>
