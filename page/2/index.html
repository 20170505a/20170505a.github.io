<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.3" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.3">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.3" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta property="og:type" content="website">
<meta property="og:title" content="RVDSD的个人笔记本">
<meta property="og:url" content="http://rvdsd.top/page/2/index.html">
<meta property="og:site_name" content="RVDSD的个人笔记本">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="RVDSD的个人笔记本">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.3',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://rvdsd.top/page/2/"/>





  <title>RVDSD的个人笔记本</title><!-- hexo-inject:begin --><!-- hexo-inject:end -->
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">RVDSD的个人笔记本</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">学习过程中的输出</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2019/08/04/DAL/DALS004_Inference03_CLT_T_test/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/08/04/DAL/DALS004_Inference03_CLT_T_test/" itemprop="url">DALS004-统计推断(Inference)02-CLT与T-test</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-08-04T12:00:00+08:00">
                2019-08-04
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/生物统计/" itemprop="url" rel="index">
                    <span itemprop="name">生物统计</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  9,967
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  40
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="前言">前言</h2>
<p>这篇笔记是《Data Analysis for the Life Sciences》的第2章：统计推断(Inference)的第3部分。这一部分的主要内容涉及中心极限理论，t检验和功效计算。</p>
<h2 id="中心极限定理central-limit-theorem与t分布">中心极限定理(Central Limit Theorem)与t分布</h2>
<h3 id="中心极限定理clt">中心极限定理(CLT)</h3>
<p>当样本的数目非常大的，一个随机样本的均值<span class="math inline">\(\bar{Y}\)</span>就会服从正态分布，这个正态分布的均值是总体均值(<span class="math inline">\(\mu_{Y}\)</span>)，标准差是总体的标准差<span class="math inline">\(\sigma_{Y}\)</span>除以样本的数目<span class="math inline">\(N\)</span>的平方根。</p>
<p>如果我们将一个随机变量减去一个常数，那么这个新生成的随机变量就会领衔这个常数，从数学角度来说，如果<span class="math inline">\(X\)</span>是一个服从均值为<span class="math inline">\(\mu\)</span>的分布，<span class="math inline">\(a\)</span>是一个常数，那么<span class="math inline">\(X-a\)</span>的均值的分布的均值就是<span class="math inline">\(\mu-a\)</span>。这个也适应用乘法与标准差(SD)。</p>
<p>如果<span class="math inline">\(X\)</span>是一个随机变量，它的分布的均值<span class="math inline">\(\mu\)</span>和标准差(SD)为<span class="math inline">\(\sigma\)</span>，而<span class="math inline">\(a\)</span>是一个常数，那么<span class="math inline">\(aX\)</span>这个新的随机变量分布的均值是<span class="math inline">\(a\mu\)</span>，标准差为<span class="math inline">\(|a|\sigma\)</span>。为了说明这个问题，我们就假设，每只小鼠的体重都减去10，那么平均体重也应该会减去10，类似的，如果我们将小鼠的体重单位由克(g, gram)换成毫克(mg, milligram)，也就相当于把原来的数字都乘以了1000，那么数字的扩散程度也会变大。</p>
<p>这就说明了，如果我们获得了<span class="math inline">\(N\)</span>个样本，那么这个公式<span class="math inline">\(\frac{\overline{Y}-\mu}{\sigma_{Y} / \sqrt{N}}\)</span>就接近于均值为0，标准差为1的正态分布。</p>
<p>现在我们感兴趣的是两个样本的均值的差值。这个数学公式就比较有用了。</p>
<p>如果我们有两个随机变量，即<span class="math inline">\(X\)</span>和<span class="math inline">\(Y\)</span>，它们的总体均值与总体均值差为<span class="math inline">\(\mu_{X}\)</span>和<span class="math inline">\(\mu_{Y}\)</span>，<span class="math inline">\(\sigma_{X}\)</span>和<span class="math inline">\(\sigma_{Y}\)</span>，然后我们就会得到这些结果：</p>
<p><span class="math inline">\(X+Y\)</span>的均值：<span class="math inline">\(\mu_{X}+\mu_{Y}\)</span>。</p>
<p>也会得到<span class="math inline">\(Y-X\)</span>的均值，其实这也相当于<span class="math inline">\(Y-X=Y+aX\)</span>，其中<span class="math inline">\(a=-1\)</span>，这其实也就是说<span class="math inline">\(Y-X\)</span>的均值为<span class="math inline">\(\mu_{Y}-\mu_{X}\)</span>。</p>
<p>如果说<span class="math inline">\(X\)</span>和<span class="math inline">\(Y\)</span>是相互独立的样本，那么<span class="math inline">\(Y+X\)</span>的方差，就是<span class="math inline">\(\sigma_{Y}^2+\sigma_{X}^2\)</span>，从这里我们可以推到，<span class="math inline">\(Y-X\)</span>，也即<span class="math inline">\(Y+aX\)</span>（其中a为-1）的方差是<span class="math inline">\(\sigma_{Y}^2+a^2\sigma_{X}^2=\sigma_{Y}^2+\sigma_{X}^2\)</span>。因此说，<span class="math inline">\(Y-X\)</span>这个差值的方差也是两个样本的方差和，这有点反直觉，我们需要知道的就是，X与Y这两个样本是相互独立的，它们确实不相互影响。</p>
<p>从数学角度来理解上面的内容对我们的研究目（两个样本的均值，以及均值的差值）。因此这两个样本都服从正态分布，它们的差值也服从正态分布，方差是两个样本总体的方差之和。在零假设（也就是说这两个样本所代表的两个总体的均值没有差异）成立的前提下，样本均值<span class="math inline">\(\bar{Y}-\bar{X}\)</span>的差值的分布接近于均值为0（也就是说没有差异），标准差为<span class="math inline">\(\sqrt{\sigma_{X}^{2}+\sigma_{Y}^{2}} / \sqrt{N}\)</span>的正态分布，也就是说下面的这个公式： <span class="math display">\[
\frac{\overline{Y}-\overline{X}}{\sqrt{\frac{\sigma_{X}^{2}}{M}+\frac{\sigma_{Y}^{2}}{N}}}
\]</span> 的值接近于标准正态分布（均值为0，标准差为1）。</p>
<p>通过这种近似计算，我们就能够将计算p值的过程简单化，因为我们知道任何值在标准正态分布下的比例。例如，这些值中只有5%的比例会大于2（绝对值），计算过程如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pnorm(-<span class="number">2</span>) + (<span class="number">1</span> - pnorm(<span class="number">2</span>))</div></pre></td></tr></table></figure>
<p>计算结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; pnorm(-<span class="number">2</span>) + (<span class="number">1</span> - pnorm(<span class="number">2</span>))</div><div class="line">[<span class="number">1</span>] <span class="number">0.04550026</span></div></pre></td></tr></table></figure>
<p>从上面结果我们就可以知道，只有5%的可能性会大于2，我们前面计算的obstdiff的值是3.020833，因此12只小鼠足够了，不需要买更多的小鼠。</p>
<p>但是，这还没完。因为我们并不知道总体的标准差，也就是不知道<span class="math inline">\(\sigma_{X}\)</span>与<span class="math inline">\(\sigma_{Y}\)</span>。它们是未知的总体参数，但是，我们可以通过样本的标准差对它们进行估算，估算的总体标准差我们不能希腊字母<span class="math inline">\(\mu\)</span>来表示，只能用<span class="math inline">\(s\)</span>来表示，那么它们的估计值如下所示： <span class="math display">\[
s_{X}^{2}=\frac{1}{M-1} \sum_{i=1}^{M}\left(X_{i}-\overline{X}\right)^{2} \text { and } s_{Y}^{2}=\frac{1}{N-1} \sum_{i=1}^{N}\left(Y_{i}-\overline{Y}\right)^{2}
\]</span> 我们需要注意的是，上面的公式里面除以的是<span class="math inline">\(M-1\)</span>与<span class="math inline">\(N-1\)</span>，而不是前面的<span class="math inline">\(M\)</span>与<span class="math inline">\(N\)</span>，这有数学方面计算的原因，这里不表，记住就行。但是，为了更加直观地说明一些东西，我们还是要涉及一点。试想，如果你有2个数，把它们画在数轴上，它们之间的距离如果是L，那么中间的那一点就是它们的平均值，这个平均值离它们的距离分别都是0.5L。因此，从这个角度来说，你从这2个数中的一个就能够获取这个信息（这涉及自由度的问题），而不需要2个数，这点不怎么重要，重要的一点是，我们是用了<span class="math inline">\(s_{X}\)</span>和<span class="math inline">\(s_{Y}\)</span>来估计总体的均值，即<span class="math inline">\(\sigma_{X}\)</span>和<span class="math inline">\(\sigma_{Y}\)</span>，因为总体均值未知，只能靠样本均值来估计。</p>
<p>因此我们就把前面的那个公式： <span class="math display">\[
\frac{\overline{Y}-\overline{X}}{\sqrt{\frac{\sigma_{X}^{2}}{M}+\frac{\sigma_{Y}^{2}}{N}}}
\]</span> 定义为下面的这个样子： <span class="math display">\[
\frac{\overline{Y}-\overline{X}}{\sqrt{\frac{s_{X}^{2}}{M}+\frac{s_{Y}^{2}}{N}}}
\]</span> 如果<span class="math inline">\(M=N\)</span>，那么公式就可以化简为如下所示： <span class="math display">\[
\sqrt{N} \frac{\overline{Y}-\overline{X}}{\sqrt{s_{X}^{2}+s_{Y}^{2}}}
\]</span> CLT告诉我们，当M与N足够大的时候，上面的这个随机变量就会服从均值为0，标准差为1的正态分布。</p>
<h3 id="t分布">t分布</h3>
<p>CLT的计算依赖于大量的样本，也就是我们指的渐进性结果。当CLT不适用时，还需要另外一种不依赖于渐进性结果的选择。当原始总体来源于一个变量，也就是<span class="math inline">\(Y\)</span>时，如果这个<span class="math inline">\(Y\)</span>是服从均值为0的标准正态分布，那么我们就可以计算下面这个变量的分布： <span class="math display">\[
\sqrt{N} \frac{\overline{Y}}{s_{Y}}
\]</span> 这是两个随机变量的比值，因此这个比值不一定服从正态分布。事实上，这个公式的分母会偶然变小，因此就相应地会增加观察到更大值的概率。Gosset最初发现的这种分布，由于他开始在论文中以Student的名义投的稿，因此就称这种分布为Student‘s t-distribution，也就是t分布。</p>
<p>现在我们以小鼠的表型数据为例说明一下，我们创建2向量，一个当作对照总体，一个当作高脂总体，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">url &lt;- <span class="string">"https://raw.githubusercontent.com/genomicsclass/dagdata/master/inst/extd\</span></div><div class="line"><span class="string">ata/mice_pheno.csv"</span></div><div class="line">filename &lt;- <span class="string">"mice_pheno.csv"</span></div><div class="line">download(url,destfile=filename)</div><div class="line">dat &lt;- read.csv(filename)</div><div class="line">head(dat)</div><div class="line"></div><div class="line"><span class="keyword">library</span>(dplyr)</div><div class="line">controlPopulation &lt;- filter(dat, Sex == <span class="string">"F"</span> &amp; Diet == <span class="string">"chow"</span>) %&gt;% select(Bodyweight) %&gt;% unlist</div><div class="line">hfPopulation &lt;- filter(dat, Sex == <span class="string">"F"</span> &amp; Diet == <span class="string">"hf"</span>) %&gt;% select(Bodyweight) %&gt;% unlist</div></pre></td></tr></table></figure>
<p>这里需要注意提，我们假设的是的<span class="math inline">\(y_{1},y_{2},\dots,y_{n}\)</span>的分布，而不是随机变量<span class="math inline">\(\bar{Y}\)</span>的分布。现在我们来看一下这两个总体的分布：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">library</span>(rafalib)</div><div class="line">mypar(<span class="number">1</span>,<span class="number">2</span>)</div><div class="line">hist(hfPopulation)</div><div class="line">hist(controlPopulation)</div></pre></td></tr></table></figure>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190721200113.png">

</div>
<p>我们可以使用qq图来确认一下上面的分布是比较接近正态分布的，这里我们只作初步了解，更详细的了解在后面。如果在qq图上，点大致都藻在一条直线附近，它们就属于正态分布，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">mypar(<span class="number">1</span>,<span class="number">2</span>)</div><div class="line">qqnorm(hfPopulation)</div><div class="line">qqline(hfPopulation)</div><div class="line">qqnorm(controlPopulation)</div><div class="line">qqline(controlPopulation)</div></pre></td></tr></table></figure>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190721200657.png">

</div>
<h2 id="练习">练习</h2>
<p>P47</p>
<h2 id="中心极限定理的实际运用">中心极限定理的实际运用</h2>
<p>现在我们使用上面的数据来看一下，中心极限定理是如何逼近样本的均值的：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">url &lt;- <span class="string">"https://raw.githubusercontent.com/genomicsclass/dagdata/master/inst/extd\</span></div><div class="line"><span class="string">ata/mice_pheno.csv"</span></div><div class="line">filename &lt;- <span class="string">"mice_pheno.csv"</span></div><div class="line">download(url,destfile=filename)</div><div class="line">dat &lt;- read.csv(filename)</div><div class="line">head(dat)</div><div class="line"></div><div class="line"><span class="keyword">library</span>(dplyr)</div><div class="line">controlPopulation &lt;- filter(dat, Sex == <span class="string">"F"</span> &amp; Diet == <span class="string">"chow"</span>) %&gt;% select(Bodyweight) %&gt;% unlist</div><div class="line">hfPopulation &lt;- filter(dat, Sex == <span class="string">"F"</span> &amp; Diet == <span class="string">"hf"</span>) %&gt;% select(Bodyweight) %&gt;% unlist</div><div class="line">mu_hf &lt;- mean(hfPopulation)</div><div class="line">mu_control &lt;- mean(controlPopulation)</div><div class="line">mu_hf - mu_control</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">&gt; head(dat)</div><div class="line">  Sex Diet Bodyweight</div><div class="line"><span class="number">1</span>   <span class="literal">F</span>   hf      <span class="number">31.94</span></div><div class="line"><span class="number">2</span>   <span class="literal">F</span>   hf      <span class="number">32.48</span></div><div class="line"><span class="number">3</span>   <span class="literal">F</span>   hf      <span class="number">22.82</span></div><div class="line"><span class="number">4</span>   <span class="literal">F</span>   hf      <span class="number">19.92</span></div><div class="line"><span class="number">5</span>   <span class="literal">F</span>   hf      <span class="number">32.22</span></div><div class="line"><span class="number">6</span>   <span class="literal">F</span>   hf      <span class="number">27.50</span></div><div class="line">&gt; </div><div class="line">&gt; <span class="keyword">library</span>(dplyr)</div><div class="line">&gt; controlPopulation &lt;- filter(dat, Sex == <span class="string">"F"</span> &amp; Diet == <span class="string">"chow"</span>) %&gt;% select(Bodyweight) %&gt;% unlist</div><div class="line">&gt; hfPopulation &lt;- filter(dat, Sex == <span class="string">"F"</span> &amp; Diet == <span class="string">"hf"</span>) %&gt;% select(Bodyweight) %&gt;% unlist</div><div class="line">&gt; mu_hf &lt;- mean(hfPopulation)</div><div class="line">&gt; mu_control &lt;- mean(controlPopulation)</div><div class="line">&gt; mu_hf - mu_control</div><div class="line">[<span class="number">1</span>] <span class="number">2.375517</span></div></pre></td></tr></table></figure>
<p>现在计算一下种群的标准差，这里不要使用R的<code>sd()</code>函数，因此这个函数是计算样本的标准差的，它会除以<code>(n-1)</code>，当我们想要对总体进行估计时，按以下代码计算：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">x &lt;- controlPopulation</div><div class="line">N &lt;- length(x)</div><div class="line">populationvar &lt;- mean((x-mean(x))^<span class="number">2</span>)</div><div class="line">populationvar</div><div class="line">var(x)</div><div class="line">var(x)*(N-<span class="number">1</span>)/N</div><div class="line">identical(var(x)*(N-<span class="number">1</span>)/N,populationvar)</div><div class="line">identical(var(x), populationvar)</div></pre></td></tr></table></figure>
<p>计算结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">&gt; populationvar</div><div class="line">[<span class="number">1</span>] <span class="number">11.67205</span></div><div class="line">&gt; var(x)</div><div class="line">[<span class="number">1</span>] <span class="number">11.72416</span></div><div class="line">&gt; var(x)*(N-<span class="number">1</span>)/N</div><div class="line">[<span class="number">1</span>] <span class="number">11.67205</span></div><div class="line">&gt; identical(var(x)*(N-<span class="number">1</span>)/N,populationvar)</div><div class="line">[<span class="number">1</span>] <span class="literal">TRUE</span></div><div class="line">&gt; identical(var(x), populationvar)</div><div class="line">[<span class="number">1</span>] <span class="literal">FALSE</span></div></pre></td></tr></table></figure>
<p>因此，为了在数学计算上是准确的，我们不使用<code>sd()</code>或<code>var()</code>函数，我们可以使用<code>rafalib</code>包中的<code>popvar()</code>与<code>popsd()</code>函数，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">library</span>(rafalib)</div><div class="line">sd_hf &lt;- popsd(hfPopulation)</div><div class="line">sd_control &lt;- popsd(controlPopulation)</div></pre></td></tr></table></figure>
<p>这里需要注意，在实际统计中，我们并不会计算总体参数，我们通常是由样本来估计总体参数，现在我们从总体中抽样，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">N &lt;- <span class="number">12</span></div><div class="line">hf &lt;- sample(hfPopulation, N)</div><div class="line">control &lt;- sample(controlPopulation,N)</div></pre></td></tr></table></figure>
<p>CLT告诉我们，对于更大的N来说，这些样本都近拉于正态分布。作为一种经验，这个N通常是大于30，这仅是一个经验法则，具体来说，它还需要取决于总体的分布。这里我们实际上可以查看一下近似值，并对各种N值进行计算，代码如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Ns &lt;- c(<span class="number">3</span>, <span class="number">12</span>, <span class="number">25</span>, <span class="number">50</span>)</div><div class="line">B &lt;- <span class="number">10000</span></div><div class="line">res &lt;- sapply(Ns, <span class="keyword">function</span>(n)&#123;</div><div class="line">  replicate(B, mean(sample(hfPopulation, n)) - mean(sample(controlPopulation, n)))</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<p>现在使用qq图看一下CLT理论对这些数据的近似值的适应情况。如果这些数据非常接近正态分布，那么这些数据点就会落在一个直线上（这个直接是正态分布的分位数(quantiles))。越偏离，说明数据越不符合正态分布，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">mypar(<span class="number">2</span>,<span class="number">2</span>)</div><div class="line"><span class="keyword">for</span> (i <span class="keyword">in</span> seq(along=Ns))&#123;</div><div class="line">  titleavg &lt;- signif(mean(res[,i]),<span class="number">3</span>)</div><div class="line">  titlesd &lt;- signif(popsd(res[,i]),<span class="number">3</span>)</div><div class="line">  title &lt;- paste0(<span class="string">"N="</span>, Ns[i], <span class="string">"Avg="</span>, titleavg, <span class="string">" SD="</span>, titlesd)</div><div class="line">  qqnorm(res[,i], main = title)</div><div class="line">  qqline(res[,i], col=<span class="number">2</span>)</div><div class="line">  </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190721204249.png">

</div>
<p>从上面结果可以看出来，第3组数据的拟合结果最合适，这是因为它的总体相对最接近正态分布，平均值也最接近于正态分布。在实际中，我们可以计算这样一个比值：除以估计的标准误差来判断，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">Ns &lt;- c(<span class="number">3</span>, <span class="number">12</span>, <span class="number">25</span>, <span class="number">50</span>)</div><div class="line">B &lt;- <span class="number">10000</span></div><div class="line">computetstat &lt;- <span class="keyword">function</span>(n)&#123;</div><div class="line">  y &lt;- sample(hfPopulation, n)</div><div class="line">  x &lt;- sample(controlPopulation, n)</div><div class="line">  (mean(y)- mean(x))/sqrt(var(y)/n+var(x)/n)</div><div class="line">&#125;</div><div class="line">res &lt;- sapply(Ns, <span class="keyword">function</span>(n)&#123;</div><div class="line">  replicate(B, computetstat(n))</div><div class="line">&#125;)</div><div class="line"></div><div class="line">mypar(<span class="number">2</span>,<span class="number">2</span>)</div><div class="line"><span class="keyword">for</span> (i <span class="keyword">in</span> seq(along=Ns))&#123;</div><div class="line">  qqnorm(res[,i], main = Ns[i])</div><div class="line">  qqline(res[,i], col=<span class="number">2</span>)</div><div class="line">  </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190721205303.png">

</div>
<p>从上面可以看出来，当<span class="math inline">\(N=3\)</span>时，CLT并不会提供一个有用的估计，当<span class="math inline">\(N=12\)</span>时，在较大值的点方面，稍微有点偏离。当<span class="math inline">\(N=25\)</span>或<span class="math inline">\(N=50\)</span>时，所有的点基本上都在直线上。</p>
<p>也就是说，在这个案例中，只要<span class="math inline">\(N=12\)</span>就能证明CLT，就像前言提到的那样，在多数情况下，这种模拟并不会很好。我们在这里只是通过这种模拟手段来说明CLT背后的思想与局限。</p>
<h2 id="练习-1">练习</h2>
<p>P52</p>
<h2 id="t检验的实际计算">t检验的实际计算</h2>
<p>现在我们来看一下如何通过计算得到p值，先来导入数据，在这一步中，我们要确定哪些是treatment组，哪些是control组，并且计算出它们的均值差异，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">library</span>(dplyr)</div><div class="line">dir &lt;- system.file(package = <span class="string">"dagdata"</span>)</div><div class="line">filename &lt;- file.path(dir,<span class="string">"extdata/femaleMiceWeights.csv"</span>)</div><div class="line">dat &lt;- read.csv(filename)</div><div class="line">control &lt;- filter(dat,Diet==<span class="string">"chow"</span>) %&gt;% select(Bodyweight) %&gt;% unlist</div><div class="line">treatment &lt;- filter(dat,Diet==<span class="string">"hf"</span>) %&gt;% select(Bodyweight) %&gt;% unlist</div><div class="line">diff &lt;- mean(treatment) - mean(control)</div><div class="line">print(diff)</div></pre></td></tr></table></figure>
<p>计算结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; print(diff)</div><div class="line">[<span class="number">1</span>] <span class="number">3.020833</span></div></pre></td></tr></table></figure>
<p>现在我们开始计算p值，上面的代码中有一个<code>diff</code>变量，可以称为<code>observed effect size</code>，这是一个随机变量，我们还知道，在零假设的前提下，<code>diff</code>均值的分布是0，而这个随机变量分布的标准误则是总体的标准差(population standard deviation)除了样本数目的平方根，如下所示： <span class="math display">\[
S E(\overline{X})=\sigma / \sqrt{N}
\]</span> 我们使用样本样本标准差(sample standard deviation)来对总体的标准差(population standard deviation)进行估计，在R中，也可以使用的<code>sd()</code>函数来计算标准误(SE)，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sd(control)/sqrt(length(control))</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; sd(control)/sqrt(length(control))</div><div class="line">[<span class="number">1</span>] <span class="number">0.8725323</span></div></pre></td></tr></table></figure>
<p>这个值就是样本均值(sample average)的SE，不过实际上，我们相想要的是<code>diff</code>的SE。我们前面已经知道了，统计学理论告诉我们，两个随机变量差的方差是原两个随机变量方差的和，因此我们计算一下方差以及平方根：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">se &lt;- sqrt(</div><div class="line">var(treatment)/length(treatment) +</div><div class="line">var(control)/length(control)</div><div class="line">)</div><div class="line">se</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; se</div><div class="line">[<span class="number">1</span>] <span class="number">1.469867</span></div></pre></td></tr></table></figure>
<p>统计学理论还告诉我们，如果我们将一个随机变量除以其SE，我们就会得到一个SE为1的新的随机变量，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">tstat &lt;- diff/se</div><div class="line">tstat</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&gt; tstat &lt;- diff/se</div><div class="line">&gt; tstat</div><div class="line">[<span class="number">1</span>] <span class="number">2.055174</span></div></pre></td></tr></table></figure>
<p>上面计算出来的<code>tstat</code>就是我们称的t统计量(t-statistic)。这是两个随机变量的比值，因此它也是一个随机变量。一旦我们知道了这个随机的分布，我们就很容易计算出其p值。</p>
<p>前面我们提到，CLT可以告诉我们，如果有大样本(large sample size)，那么样本的均值<code>mean(treatment)</code>和<code>mean(control)</code>都服从正态分布。统计学理论告诉我们，两个正态分布的随机变量的差值还服从正态分布，因此CLT也告诉我们，<code>tstat</code>接近于均值为0(零假设)，SD为1（我们除以它的SE）的正态分布。</p>
<p>现在我们要计算一下p值，此时我们需要问的一个问题就是：一个服从正态分布的随机变量有多大的概率会大于<code>diff</code>？R语言中的有一个<code>pnorm()</code>函数有解决这个问题。<code>pnorm(a)</code>会以返回一个值，这个值就是概率，它表示在一个标准正态分布中，一个随机变量低于<code>a</code> 的概率，具体这个函数的原理与用法，可以参考这篇笔记《R语言中dnorm, pnorm, qnorm与rnorm以及随机数》。</p>
<p>如果要计算大于<code>a</code>的概率，那么可以使用<code>1-pnorm(a)</code>，如果我们想知道看到一些像diff这种极端事件的概率：例如要么小于（更多的时候指的是负值）<code>-abs(diff)</code>，要么是大于<code>abs(diff)</code>，那么我们也可以过计算这两个尾部区域的概率：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">righttail &lt;- <span class="number">1</span>-pnorm(abs(tstat))</div><div class="line">lefttail &lt;- pnorm(-abs(tstat))</div><div class="line">pval &lt;- lefttail + righttail</div><div class="line">print(pval)</div></pre></td></tr></table></figure>
<p>计算结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; print(pval)</div><div class="line">[<span class="number">1</span>] <span class="number">0.0398622</span></div></pre></td></tr></table></figure>
<p>在这个案例中，p值小于0.05，根据传统的p值阈值0.05，我们就可以下给结论，这种差值有统计学意义。</p>
<p>现在我们就面临一个问题，CLT只有在大样本的前提下才有效，12个样本这个数目够么？根据经验法则，通常大于30个样本（这仅仅是经验法则），就能满足CLT。我们计算的这个p值，只有在假设成立的前提下才是有效的近似值，而实际情况并非如此，还好，除了CLT之外，我们还有另外一种选择。</p>
<h2 id="t分布的实际计算">t分布的实际计算</h2>
<p>如果一个总体的分布是正态分布，那么我们在不需要CLT思想的前提下，就可以计算出t-statistic的精确分布。但是，如果我们只有小样本，我们就很难知道总体是否是正态的。但是，对于一些常见的统计量，例如体重，我们就可以猜测它的总体分布非常接近于正态分布，因此我们可以使用这种近似。此外，我们可以使用对样本画qq图，它会显示出样本的分布，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">library</span>(rafalib)</div><div class="line">mypar(<span class="number">1</span>,<span class="number">2</span>)</div><div class="line">qqnorm(treatment)</div><div class="line">qqline(treatment,col=<span class="number">2</span>)</div><div class="line">qqnorm(control)</div><div class="line">qqline(control,col=<span class="number">2</span>)</div></pre></td></tr></table></figure>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190727104205.png">

</div>
<p>如果我们使用这种近似计算，那么从统计学理论角度来讲我们随机变量<code>tstat</code>的分布就服从一个t分布(<code>-t-distribution</code>)，这种分布比正态分布更复杂。t分布没有像正态分布那样的位置参数( location parameter )，正态分布的参数是自由度(<code>degrees of freedom</code>)，R中的<code>t.test()</code>函数可以用于计算相应的p值，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">t.test(treatment, control)</div></pre></td></tr></table></figure>
<p>计算结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">&gt; t.test(treatment, control)</div><div class="line"></div><div class="line">	Welch Two Sample t-test</div><div class="line"></div><div class="line">data:  treatment and control</div><div class="line">t = <span class="number">2.0552</span>, df = <span class="number">20.236</span>, p-value = <span class="number">0.053</span></div><div class="line">alternative hypothesis: true difference <span class="keyword">in</span> means is not equal to <span class="number">0</span></div><div class="line"><span class="number">95</span> percent confidence interval:</div><div class="line"> -<span class="number">0.04296563</span>  <span class="number">6.08463229</span></div><div class="line">sample estimates:</div><div class="line">mean of x mean of y </div><div class="line"> <span class="number">26.83417</span>  <span class="number">23.81333</span></div></pre></td></tr></table></figure>
<p>如果只想看p值，那么使用以下代码即可，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">result &lt;- t.test(treatment,control)</div><div class="line">result$p.value</div></pre></td></tr></table></figure>
<p>结果如下：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&gt; result &lt;- t.test(treatment,control)</div><div class="line">&gt; result$p.value</div><div class="line">[<span class="number">1</span>] <span class="number">0.05299888</span></div></pre></td></tr></table></figure>
<p>从计算结果来看，这个p值有点大，这是因为在CLT近似的计算中，<code>tstat</code>的分布实际上是固定的（对于大样本来说，分母实际上就是固定的），而t分布的近似计算则是考虑到了分母（差值的标准误）是一个随机变量，是不固定的，样本数目越小，那分母的变化就越大。</p>
<p>这样来看的，我们使用了两种方法，得到了2个不同的p值，这在数据分析过程中很常见，因为我们是使用了不同的前提，不同的近似，因此会得到不同的结果。在后面讲到的功效计算(power calculation)中，我们会讲到I类错误，II类错误。在这里我们只说一下，使用CLT近似会错误地拒绝( incorrectly reject )零假设(假阳性)，而t分布则会错误地接受(inccorrectly acept)零假设(假阴性)。</p>
<p>在R中计算t检验如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">library</span>(dplyr)</div><div class="line">dir &lt;- system.file(package = <span class="string">"dagdata"</span>)</div><div class="line">filename &lt;- file.path(dir,<span class="string">"extdata/mice_pheno.csv"</span>)</div><div class="line">dat &lt;- read.csv(filename)</div><div class="line">control &lt;- filter(dat,Diet==<span class="string">"chow"</span>) %&gt;% select(Bodyweight)</div><div class="line">treatment &lt;- filter(dat,Diet==<span class="string">"hf"</span>) %&gt;% select(Bodyweight)</div><div class="line">t.test(treatment,control)</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">&gt; t.test(treatment,control)</div><div class="line"></div><div class="line">	Welch Two Sample t-test</div><div class="line"></div><div class="line">data:  treatment and control</div><div class="line">t = <span class="number">7.1932</span>, df = <span class="number">735.02</span>, p-value = <span class="number">1.563e-12</span></div><div class="line">alternative hypothesis: true difference <span class="keyword">in</span> means is not equal to <span class="number">0</span></div><div class="line"><span class="number">95</span> percent confidence interval:</div><div class="line"> <span class="number">2.231533</span> <span class="number">3.906857</span></div><div class="line">sample estimates:</div><div class="line">mean of x mean of y </div><div class="line"> <span class="number">30.48201</span>  <span class="number">27.41281</span></div></pre></td></tr></table></figure>
<h2 id="置信区间confidence-intervals">置信区间(Confidence Intervals)</h2>
<p>在生命科学研究中，仅在研究结论中报道p值是不够的，因为统计学上的显著性无法保证科学研究上的意义。例如在对体重的差异进行统计时，使用大样本的情况下，即使是1毫克的差异，也有可能有统计学意义，不过这种1毫克的差异是一个重要的发现么？我们能否说明，某个因素导致了不到1%的体重变化？仅报道p值是无法提供一些有价值的信息的，也不会提供有关效应量(the effect size)的信息，效应量(effect size)就是我们前面提到的观察到的差异(observed difference)。有的时候，效应量会用除以对照组的均值，因此会表示为百分比。</p>
<p>为了纠正仅报道p值偏差，另外一个统计量就提了出来，即置信区间(confidence intervals)。置信区间包括了估计的效应量(estimated effect size)，以及与这个估计有关的不确定性(uncertainty)，现在我们使用这批小鼠数据来计算一下置信区间。</p>
<h3 id="总体均值的置信区间">总体均值的置信区间</h3>
<p>在我们展示如何过计算两组差值的置信区间之前，我们先来看一下如何计算对照组雌性小鼠的总体均值的置信区间。随后，我们会计算样本的置留区间，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">dir &lt;- system.file(package = <span class="string">"dagdata"</span>)</div><div class="line">filename &lt;- file.path(dir,<span class="string">"extdata/mice_pheno.csv"</span>)</div><div class="line">dat &lt;- read.csv(filename)</div><div class="line">chowPopulation &lt;- dat[dat$Sex==<span class="string">"F"</span> &amp; dat$Diet==<span class="string">"chow"</span>,<span class="number">3</span>]</div><div class="line">mu_chow &lt;- mean(chowPopulation)</div><div class="line">print(mu_chow)</div></pre></td></tr></table></figure>
<p>计算结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; print(mu_chow)</div><div class="line">[<span class="number">1</span>] <span class="number">23.89338</span></div></pre></td></tr></table></figure>
<p>现在计算的结果就是 总体均值<span class="math inline">\(\mu_{X}\)</span>。</p>
<p>现在我们对这个结果进行估计，在实际分析过程中，我们并不会获取所有的总体，因此我们也像前面计算p值那样，我们来演示一下，通过抽样的方法来计算置信区间，现在我们先抽30个样本，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">N &lt;- <span class="number">30</span></div><div class="line">chow &lt;- sample(chowPopulation, N)</div><div class="line">print(mean(chow))</div></pre></td></tr></table></figure>
<p>计算结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; print(mean(chow))</div><div class="line">[<span class="number">1</span>] <span class="number">23.95033</span></div></pre></td></tr></table></figure>
<p>我们知道这个均值是一个随机变量，因此样本均值并不是一个非常好的估计。实际上，我们使用这个案例只是为了计算这个样本的均值，每次计算并非完全一样，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">&gt; N &lt;- <span class="number">30</span></div><div class="line">&gt; chow &lt;- sample(chowPopulation, N)</div><div class="line">&gt; print(mean(chow))</div><div class="line">[<span class="number">1</span>] <span class="number">23.48467</span></div><div class="line">&gt; </div><div class="line">&gt; N &lt;- <span class="number">30</span></div><div class="line">&gt; chow &lt;- sample(chowPopulation, N)</div><div class="line">&gt; print(mean(chow))</div><div class="line">[<span class="number">1</span>] <span class="number">25.22967</span></div><div class="line">&gt; </div><div class="line">&gt; N &lt;- <span class="number">30</span></div><div class="line">&gt; chow &lt;- sample(chowPopulation, N)</div><div class="line">&gt; print(mean(chow))</div><div class="line">[<span class="number">1</span>] <span class="number">23.732</span></div></pre></td></tr></table></figure>
<p>如上所示，每次抽样计算的均值都不一样。现在我们来了解一下置信区间，置信区间一种报道你数据中样本均值的一种统计学表示方法，它能明确地显示出随机变量的变异程度。</p>
<p>现在我们的的样本是30，CLT告诉我们，<span class="math inline">\(\bar{X}\)</span>或chow组的均值(mean)服从一个均值为<span class="math inline">\(\mu_{X}\)</span>（这个是chowPopulaiton这个总体的均值，即<code>mean(chowPopulation)</code>，这个均值服从均值为<span class="math inline">\(\mu_{X}\)</span>，标准误<span class="math inline">\(s_{X} / \sqrt{N}\)</span>的标准分布，计算过程如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">se &lt;- sd(chow)/sqrt(N)</div><div class="line">print(se)</div></pre></td></tr></table></figure>
<p>计算结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&gt; se &lt;- sd(chow)/sqrt(N)</div><div class="line">&gt; print(se)</div><div class="line">[<span class="number">1</span>] <span class="number">0.597656</span></div></pre></td></tr></table></figure>
<h3 id="定义区间">定义区间</h3>
<p>95%置信区间是一个随机区间，这个区间有95%概率落在我们估计值的参数中。这里需要注意的是，说95%的随机区间将会包括真值，并不等于说真值有95%的概率落在我们的区间中。为了构建置信区间，我们需要注意，CLT告诉我们，<span class="math inline">\(\sqrt{N}\left(\overline{X}-\mu_{X}\right) / s_{X}\)</span>服从均值为0，SD为1的正态分布，这个概率也就是以下事件的概率： <span class="math display">\[
-2 \leq \sqrt{N}\left(\overline{X}-\mu_{X}\right) / s_{X} \leq 2
\]</span> 在R中的计算为：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pnorm(<span class="number">2</span>) - pnorm(-<span class="number">2</span>)</div></pre></td></tr></table></figure>
<p>计算结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; pnorm(<span class="number">2</span>) - pnorm(-<span class="number">2</span>)</div><div class="line">[<span class="number">1</span>] <span class="number">0.9544997</span></div></pre></td></tr></table></figure>
<p>这个值与95%很接近，也就是<code>qnorm(1-0.05/2)</code>的这个值，现在我们把上面的公式变换一下，把<span class="math inline">\(\mu_{X}\)</span>放中间，就成了如下的样子： <span class="math display">\[
\overline{X}-2 s_{X} / \sqrt{N} \leq \mu_{X} \leq \overline{X}+2 s_{X} / \sqrt{N}
\]</span></p>
<p>也就是上面这个值的概率是95%。需要注意的是，区间<span class="math inline">\(\overline{X} \pm 2 s_{X} / \sqrt{N}\)</span>是两个边界，它们是随机的。此外，我们需要明确一下，置信区间的定义是，95%的随机区间（random intervals)包含真正的固定值<span class="math inline">\(\mu_{X}\)</span>。对于一个计算结果来说，计算出来的这个特定的区间，它要么包括固定的总体均值<span class="math inline">\(\mu\)</span>，要么不包括。</p>
<p>现在我们来模拟一下其中的思路，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">N &lt;- <span class="number">30</span></div><div class="line">chow &lt;- sample(chowPopulation, N)</div><div class="line">se &lt;- sd(chow)/sqrt(N)</div><div class="line">Q &lt;- qnorm(<span class="number">1</span> - <span class="number">0.05</span>/<span class="number">2</span>)</div><div class="line">interval &lt;- c(mean(chow)-Q*se, mean(chow) + Q*se)</div><div class="line">interval</div><div class="line">interval[<span class="number">1</span>] &lt; mu_chow &amp; interval[<span class="number">2</span>] &gt; mu_chow</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&gt; interval</div><div class="line">[<span class="number">1</span>] <span class="number">22.17089</span> <span class="number">24.58044</span></div><div class="line">&gt; interval[<span class="number">1</span>] &lt; mu_chow &amp; interval[<span class="number">2</span>] &gt; mu_chow</div><div class="line">[<span class="number">1</span>] <span class="literal">TRUE</span></div></pre></td></tr></table></figure>
<p>从上面我们可以看到，这个区间覆盖了总体均值<span class="math inline">\(\mu_{X}\)</span>或<code>mean(chowPopulation)</code>。但是，如果我们再取另外一批样本的话，有可能不会覆盖总体均值<span class="math inline">\(\mu_{X}\)</span>，但是，统计学理论告诉我们，经过均数次抽样后，这个样本覆盖均值的概率是95%。由于我们能够获取总体数据，现在我们来看一些样本：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">library</span>(rafalib)</div><div class="line">B &lt;- <span class="number">250</span></div><div class="line">mypar()</div><div class="line">plot(mean(chowPopulation)+c(-<span class="number">7</span>, <span class="number">7</span>), c(<span class="number">1</span>,<span class="number">1</span>), type=<span class="string">"n"</span>,</div><div class="line">     xlab=<span class="string">"weight"</span>, ylab = <span class="string">"interval"</span>, ylim=c(<span class="number">1</span>,B))</div><div class="line">abline(v=mean(chowPopulation))</div><div class="line"><span class="keyword">for</span> (i <span class="keyword">in</span> <span class="number">1</span>:B)&#123;</div><div class="line">  chow &lt;- sample(chowPopulation, N)</div><div class="line">  sd &lt;- sd(chow)/sqrt(N)</div><div class="line">  interval &lt;- c(mean(chow)-Q*se, mean(chow)+Q*se)</div><div class="line">  covered &lt;- </div><div class="line">    mean(chowPopulation) &lt;= interval[<span class="number">2</span>] &amp; mean(chowPopulation) &gt;= interval[<span class="number">1</span>]</div><div class="line">  color &lt;- ifelse(covered, <span class="number">1</span>,<span class="number">2</span>)</div><div class="line">  lines(interval, c(i, i), col= color)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190727142655.png">

</div>
<p>在这个案例中，我们模拟了250次随机抽样，计算了250次置信区间，其中颜色表示这个区间是否包含总体均值，其中绿色是包括的，棕色是不包括的。</p>
<p>上面这个案例的置信区间比较大（这个案例除以的是是<span class="math inline">\(\sqrt{5}\)</span>，而非<span class="math inline">\(\sqrt{30}\)</span>），我们可以看到很多区间并未覆盖<span class="math inline">\(\mu_{X}\)</span>，这是因为CLT错误地告诉了我们(chow)的均值是近似地接近于正态分布，实际上这个数据是不太符合正态分布的（在接近<span class="math inline">\(\pm \infty\)</span>的地方，它有一个比较扁平的尾巴）。这种错误会影响我们计算<code>Q</code>值，而这个<code>Q</code>值在计算的时，是以正态分布为前提,，使用<code>qnorm()</code>来计算的。在这种情况下，数据会更符合t分布，现在我们使用<code>qt()</code>函数来计算<code>Q</code>值，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">mypar()</div><div class="line">plot(mean(chowPopulation)+ c(-<span class="number">7</span>,<span class="number">7</span>), c(<span class="number">1</span>,<span class="number">1</span>),type=<span class="string">"n"</span>,</div><div class="line">     xlab=<span class="string">"weight"</span>,ylab=<span class="string">"interval"</span>,ylim=c(<span class="number">1</span>,B))</div><div class="line">abline(v=mean(chowPopulation))</div><div class="line">Q &lt;- qt(<span class="number">1</span>-<span class="number">0.05</span>/<span class="number">2</span>, df=<span class="number">4</span>)</div><div class="line">N &lt;- <span class="number">5</span></div><div class="line"><span class="keyword">for</span> (i <span class="keyword">in</span> <span class="number">1</span>:B)&#123;</div><div class="line">  chow &lt;- sample(chowPopulation, N)</div><div class="line">  se &lt;- sd(chow)/sqrt(N)</div><div class="line">  interval &lt;- c(mean(chow)-Q*se, mean(chow)+Q*se)</div><div class="line">  covered &lt;- mean(chowPopulation) &lt;= interval[<span class="number">2</span>] &amp; mean(chowPopulation) &gt;= interval[<span class="number">1</span>]</div><div class="line">  color &lt;- ifelse(covered, <span class="number">1</span>,<span class="number">2</span>)</div><div class="line">  lines(interval, c(i,i), col=color)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190728085017.png">

</div>
<p>上面这个图中，我们使用了小样本来模拟了250次计算，得到了它的95%置信区间，这个置信区间是基于t分布进行计算的。与前面的那个案例相比，这个案例中置信区间更大，这是因为t分布的尾部更为扁平，得到的置信区间就更大，现在我们来计算一下t分布的累积分分布，并拿它与正态分布比较一下，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">qt(<span class="number">1</span>-<span class="number">0.05</span>/<span class="number">2</span>, df=<span class="number">4</span>)</div><div class="line">qnorm(<span class="number">1</span>-<span class="number">0.05</span>/<span class="number">2</span>)</div></pre></td></tr></table></figure>
<p>计算结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&gt; qt(<span class="number">1</span>-<span class="number">0.05</span>/<span class="number">2</span>, df=<span class="number">4</span>)</div><div class="line">[<span class="number">1</span>] <span class="number">2.776445</span></div><div class="line">&gt; qnorm(<span class="number">1</span>-<span class="number">0.05</span>/<span class="number">2</span>)</div><div class="line">[<span class="number">1</span>] <span class="number">1.959964</span></div></pre></td></tr></table></figure>
<p>从上面结果就可以看出来，t分布的置信区间更大，因此它才能以更大的概率(例如95%)来覆盖<span class="math inline">\(\mu_{X}\)</span>。</p>
<h3 id="置信区间与p值的关系">置信区间与p值的关系</h3>
<p>作者推荐报道实验结果时使用置信区间，而非仅用p值，对于某些原因，我们可能只需要提供p值即可，或者是提供0.05或0.01水平上的统计结果，其实置信区间也能提供这些信息。</p>
<p>当我们谈论t检验(t-test)的p值时，我们实际上是在谈论我们观察到的这两个样本的差值(<span class="math inline">\(\overline{Y}-\overline{X}\)</span>)以及更极端情况下差值的概率，就像是谈论两个总体之间的总体均值之差等于0这种极端情况下的概率。因此我们可以构建一个含有这个观察到的差值的置信区间，不过我们不再写为<span class="math inline">\(\overline{Y}-\overline{X}\)</span>这种形成，而是写为一种新的形式，即<span class="math inline">\(d \equiv \overline{Y}-\overline{X}\)</span>。</p>
<p>当我们来写一个差值的95%置信区间时，使用CLT则会写为<span class="math inline">\(d \pm 2 s_{d} / \sqrt{N}\)</span>这种形式，这个结果并不包含0（假阳性）。因为置信区间不含0，这就暗示了，<span class="math inline">\(d-2 s_{d} / \sqrt{N}&gt;0\)</span>或<span class="math inline">\(d+2 s_{d} / \sqrt{N}&lt;0\)</span>，这种表达形式还说明，<span class="math inline">\(\sqrt{N} d / s_{d}&gt;2\)</span>或<span class="math inline">\(\sqrt{N} d / s_{d}&lt;2\)</span>。这说明，t统计量比2更极端，反过来又说明，p值必然小于0.05（为了更加精确地计算，可以使用<code>qnorm(0.05/2)</code>来替换2）。如果使用t分布来取代CLT，则使用使用<code>qt(0.05/2, df=N-2</code>。总之，一个95%或99%置信区间并不包含0，p它们的p值必然小于0.05或小于0.01。</p>
<p>现在我们使用t检验来计算一下<code>d</code>的置信区间，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">t.test(treatment,control,conf.level=<span class="number">0.95</span>)$conf.int</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&gt; t.test(treatment,control,conf.level=<span class="number">0.95</span>)$conf.int</div><div class="line">[<span class="number">1</span>] <span class="number">2.231533</span> <span class="number">3.906857</span></div><div class="line">attr(,<span class="string">"conf.level"</span>)</div><div class="line">[<span class="number">1</span>] <span class="number">0.95</span></div></pre></td></tr></table></figure>
<p>如果我们把置信水平改为0.9，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&gt; t.test(treatment,control,conf.level=<span class="number">0.90</span>)$conf.int</div><div class="line">[<span class="number">1</span>] <span class="number">2.366479</span> <span class="number">3.771911</span></div><div class="line">attr(,<span class="string">"conf.level"</span>)</div><div class="line">[<span class="number">1</span>] <span class="number">0.9</span></div></pre></td></tr></table></figure>
<p>可以发现，置信区间变小了。</p>
<h2 id="功效计算">功效计算</h2>
<p>在前面的案例中，我们研究了不同包含对小鼠体重的影响，由于我们在使用这个案例的时候，我们研究的是总体，发现了这两种包含对小鼠的体重有着明显的影响，计算结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">library</span>(dplyr)</div><div class="line">dir &lt;- system.file(package = <span class="string">"dagdata"</span>)</div><div class="line">filename &lt;- file.path(dir,<span class="string">"extdata/mice_pheno.csv"</span>)</div><div class="line">dat &lt;- read.csv(filename)</div><div class="line">controlPopulation &lt;- filter(dat, Sex == <span class="string">"F"</span> &amp; Diet == <span class="string">"chow"</span>) %&gt;% dplyr::select(Bodyweight) %&gt;% unlist</div><div class="line">hfPopulation &lt;- filter(dat, Sex == <span class="string">"F"</span> &amp; Diet == <span class="string">"hf"</span>) %&gt;% dplyr::select(Bodyweight) %&gt;% unlist</div><div class="line"></div><div class="line">mu_hf &lt;- mean(hfPopulation)</div><div class="line">mu_control &lt;- mean(controlPopulation)</div><div class="line">print(mu_hf - mu_control)</div><div class="line">print((mu_hf - mu_control)/mu_control*<span class="number">100</span>)</div></pre></td></tr></table></figure>
<p>计算结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&gt; print(mu_hf - mu_control)</div><div class="line">[<span class="number">1</span>] <span class="number">2.375517</span></div><div class="line">&gt; print((mu_hf - mu_control)/mu_control*<span class="number">100</span>)</div><div class="line">[<span class="number">1</span>] <span class="number">9.942157</span></div></pre></td></tr></table></figure>
<p>某些情况下，我们会采用抽样的形式，抽取一定数目的小鼠体重作为样本，此时就不能使用总体的计算方法，而是采用t检验，此时计算得到的p值不一定小于0.05，例如。我们随机抽取5只小鼠来计算一下，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">set.seed(<span class="number">1</span>)</div><div class="line">N &lt;- <span class="number">5</span></div><div class="line">hf &lt;- sample(hfPopulation, N)</div><div class="line">control &lt;- sample(controlPopulation, N)</div><div class="line">t.test(hf,control)$p.value</div></pre></td></tr></table></figure>
<p>计算结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; t.test(hf,control)$p.value</div><div class="line">[<span class="number">1</span>] <span class="number">0.1410204</span></div></pre></td></tr></table></figure>
<p>前后两种的计算方法出现了差异，第一次计算（使用小鼠的总体来进行计算）与第二次计算（随机抽两组的5只小鼠来计算）的p值不一样，是否出现了错误？</p>
<p>在第二次计算中，p值大于0.05，因此我们不拒绝零假设，从而说饮食对小鼠的体重没有影响么？能否这么讲？答案不是能。我们只能说，无法拒绝零假设（注意，没有后面那半句：包含对小鼠的体重没有影响）。我们无法拒绝零假设，并不意味着零假设一定为真。在这个特殊的案例中，这里我们面临的一个问题就是，我们没有足够的功效(power)。如果你从事科学研究，很有可能在某些时候不得不做一个功效计算。在很多情况下，这是一种首选义务，因此它可以帮助你在人的研究中，避免使用过多的小鼠，或者是避免使用过多的受试患者。现在我们就来解释一下统计功效(statistical power)的含义。</p>
<h3 id="错误类型">错误类型</h3>
<p>我们要有这么一个意识，即，一旦我们做统计，就有可能犯错误，这也就是为什么p值不等于0。在进行统计时，当p值很小时，这说明我们可以拒绝零假设，但是这种拒绝也有可能犯错误（虽然犯错误的概率很低），例如零假设确实是真时。例如当p值等于0.05时，那么我们重复20实验，就有可能1次会发生零假设成功的事件，统计学家把这种错误称为I类错误(<code>type I error</code>)。</p>
<p>I类错误的定义就是，零假设成立时，我们拒绝了（其实不应该拒绝的），也就是所谓假阳性。这里为什么使用0.05，而不使用0.00001呢？这是因为如果阈值设得过低，成本会非常高。此时我们还要引入II类错误(<code>type I error</code>)，II类错误是指，零假设不成立，但是我们接受了零假设，也就是所谓的假阴性。前面我们抽样了5只小鼠，计算得到的值大于0.05，因此我们无法拒绝零假设（在0.05这个水平上），此时所犯的错误就是II类错误，也就是假阴性（从总体上看，实际上是有差异的，但是我们没有发现）。如果我们把阈值提高到0.25，我们就不会犯这个错误了（计算出的p值为0.1410204），不过通常情况下，不会这么干。</p>
<h3 id="与0.01阈值cut-off">0.05与0.01阈值(cut-off)</h3>
<p>多数的期刊或监管机构都坚持0.01或0.05的显著性水平，当然这么做无可厚非。我们本书的目标就之一就是让读者对p值以及置信区间有一个更深入的理解，以便读者能够在一些情况下做出合理的选择。不幸的是，这些阈值在某些程度上已经滥用，不过这是又是一个容易引起争论的话量，此处不表。</p>
<h3 id="功效计算-1">功效计算</h3>
<p>功效(power)是指：当零假设为假时，拒绝它的概率，原书的描述如下所示：</p>
<blockquote>
<p>Power is the probability of rejecting the null when the null is false.</p>
</blockquote>
<p>不过“零假设为假”这种情况比较复杂，因为在许多情况下，零假设都有可能为假。<span class="math inline">\(\Delta \equiv \overline{Y}-\overline{X}\)</span>可以是任意的，功效实际上要依赖于这个参数，功效同时还依赖于你估计值的标准误，反过来，标准误又依赖于样本数目，以及总体标准差。实际情况中，我们并不知道一些<span class="math inline">\(\Delta\)</span>，<span class="math inline">\(\sigma_{X}\)</span>，<span class="math inline">\(\sigma_{Y}\)</span>值以及样本数目这些值。但是通过统计学理论，我们可以计算功效，R中的<code>pwr</code>包可以进行这样的计算，现在我们来模拟一下这个过程：</p>
<p>第一步：确定样本数目，我们确定为12，即<code>N &lt;- 12</code>；</p>
<p>第二步：设定拒绝零假设的阈值，这里为0.05，也就是常见的p值水平，即<code>alpha &lt;- 0.05</code>；</p>
<p>第三步：设计重复抽样次数，我们会重复地进行抽样，来计算一下拒绝零假设的比例，这里设为2000，即<code>B &lt;- 2000</code>；</p>
<p>这个模拟过程就是：我们会从对照组和处理组中抽取<code>N</code>个样本，使用t检验来计算p值，观察p值是否小于0.05，现在我们把这个过程写为一个函数，代码如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">N &lt;- <span class="number">12</span></div><div class="line">alpha &lt;- <span class="number">0.05</span></div><div class="line">B &lt;- <span class="number">2000</span></div><div class="line"></div><div class="line">reject &lt;- <span class="keyword">function</span>(N, alpha=<span class="number">0.05</span>)&#123;</div><div class="line">  hf &lt;- sample(hfPopulation, N)</div><div class="line">  control &lt;- sample(controlPopulation, N)</div><div class="line">  pval &lt;- t.test(hf, control)$p.value</div><div class="line">  pval &lt; alpha</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>如果样本数目为12，那么我们是否能拒绝零假设呢，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; reject(<span class="number">12</span>)</div><div class="line">[<span class="number">1</span>] <span class="literal">FALSE</span></div></pre></td></tr></table></figure>
<p>答案是不能。现在我们使用<code>replicate()</code>函数来重复2000次，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">N &lt;- <span class="number">12</span></div><div class="line">rejections &lt;- replicate(B, reject(N))</div><div class="line">mean(rejections)</div></pre></td></tr></table></figure>
<p>计算结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; mean(rejections)</div><div class="line">[<span class="number">1</span>] <span class="number">0.218</span></div></pre></td></tr></table></figure>
<p>其中<code>rejecctions</code>的结果是一个逻辑值，即里面只有<code>TRUE</code>或<code>FALSE</code>，其中<code>TRUE</code>为1，<code>FALSE</code>是0，那么我们计算的均值，即<code>mean(rejections)</code>就是<code>TRUE</code>所占的比例，因此我们计算出来的功效为0.218。这就是为什么，当我们知道零假设为假时，t检验也无法拒绝的原因。当样本数目为12时，功效是21.8%，对为能够在0.05水平上降低假阳性，那么我们可以设置更高的阈值，但这会导致II类错误的增多。</p>
<p>现在我们来看一下，功效是如何随着N的变化而变化的，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">Ns &lt;- seq(<span class="number">5</span>,<span class="number">50</span>, <span class="number">5</span>)</div><div class="line">power &lt;- sapply(Ns, <span class="keyword">function</span>(N)&#123;</div><div class="line">  rejections &lt;- replicate(B, reject(N))</div><div class="line">  mean(rejections)</div><div class="line">&#125;)</div><div class="line">power</div></pre></td></tr></table></figure>
<p>计算结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; power</div><div class="line"> [<span class="number">1</span>] <span class="number">0.0960</span> <span class="number">0.1640</span> <span class="number">0.2775</span> <span class="number">0.3775</span> <span class="number">0.4795</span> <span class="number">0.5540</span> <span class="number">0.6415</span> <span class="number">0.7075</span> <span class="number">0.7725</span> <span class="number">0.8160</span></div></pre></td></tr></table></figure>
<p>从上面的结果我们可以发现，随着N的增加，功效也在增加，曲线如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">plot(Ns, power, type = <span class="string">"b"</span>)</div></pre></td></tr></table></figure>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190728122626.jpeg">

</div>
<p>再来看一个案例。我们把<code>alpha</code>这个拒绝阈值改变一下，再来看一下功效的变化。如果想要降低I类错误，那么功效就会越小，也就说，我们需要在两类错误之间进行权衡，现在我们看下面的代码，在保证N值相同的前提下，改变<code>alpha</code>后功效的大小：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">N &lt;- <span class="number">30</span></div><div class="line">alphas &lt;- c(<span class="number">0.1</span>, <span class="number">0.05</span>, <span class="number">0.01</span>, <span class="number">0.001</span>, <span class="number">0.001</span>)</div><div class="line">power &lt;- sapply(alphas, <span class="keyword">function</span>(alpha)&#123;</div><div class="line">  rejections &lt;- replicate(B, reject(N, alpha=alpha))</div><div class="line">  mean(rejections)</div><div class="line">&#125;)</div><div class="line">plot(alphas, power, xlab=<span class="string">"alpha"</span>, type=<span class="string">"b"</span>, log=<span class="string">"x"</span>)</div></pre></td></tr></table></figure>
<p>变化曲线如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190728123209.jpeg">

</div>
<p>在实际统计中，没有绝对的功效，也没有绝对的alpha值，但是我们要理解这背后的统计学硬。</p>
<h3 id="替代假设下的p值">替代假设下的p值</h3>
<p>当零假设为假，替代假设为真时，那么p值有的时候就比较任意了。当替代假设为真时，我们通过增加样本数目，可以得到一个尽可能小的p值，通过从总体中不断抽取更大的样本数，我们就会知道p值的这种特性，现在看一下这个过程。</p>
<p>第一步：构建一个函数，这个函数能够返回一个样本数目为N时的p值，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">calculatePvalue &lt;- <span class="keyword">function</span>(N)&#123;</div><div class="line">  hf &lt;- sample(hfPopulation,N)</div><div class="line">  control &lt;- sample(controlPopulation, N)</div><div class="line">  t.test(hf, control)$p.value</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>第二步：设定样本数目，对于每个样本数目的计算，我们会得到一系列p值，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Ns &lt;- seq(<span class="number">10</span>, <span class="number">200</span>, by=<span class="number">10</span>)</div><div class="line">Ns_rep &lt;- rep(Ns, each=<span class="number">10</span>)</div></pre></td></tr></table></figure>
<p>第三步：计算p值，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pvalues &lt;- sapply(Ns_rep, calculatePvalue)</div></pre></td></tr></table></figure>
<p>第四步：绘制样本数目与其对应的p值，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">plot(Ns_rep, pvalues, log=<span class="string">"y"</span>, xlab=<span class="string">"Sample size"</span>,</div><div class="line">     ylab=<span class="string">"p-value"</span>)</div><div class="line">abline(h=c(<span class="number">0.01</span>, <span class="number">0.05</span>), col=<span class="string">"red"</span>, lwd=<span class="number">2</span>)</div></pre></td></tr></table></figure>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190728125345.jpeg">

</div>
<p>上图是随着样本数目的变化，p值的变化。从上面结果可以看出，当替代假设成立时，随着样本数目的增多，p值会越来越小，从上面的两条红线分别是0.01与0.05的区间。</p>
<p>一旦我们在某个阈值上拒绝了零假设，我们如果想要获得一个更小的p值，那么就需要更多的样本，例如实验小鼠。样本增大会增加我们对差值<span class="math inline">\(\Delta\)</span>估计的精确性，但是，这个p值的降低仅仅是数学计算的自然结果。因为在计算p值时，它公式中的分母是样本数目的平方根，即<span class="math inline">\(\sqrt{N}\)</span>，即如果<span class="math inline">\(\Delta\)</span>不等于0，随着N的增加，p值必然降低。</p>
<p>因此，一个好的统计学结果需要列出效应量(effect size)与置信区间。效应量的计算是：将差值(difference)和置信区间(confidence interval)除以对照总体的均值，获得一个百分数，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">N &lt;- <span class="number">12</span></div><div class="line">hf &lt;- sample(hfPopulation, N)</div><div class="line">control &lt;- sample(controlPopulation, N)</div><div class="line">diff &lt;- mean(hf) - mean(control)</div><div class="line">diff/mean(control)*<span class="number">100</span></div><div class="line">t.test(hf, control)$conf.int / mean(control) * <span class="number">100</span></div></pre></td></tr></table></figure>
<p>计算结果为：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&gt; diff/mean(control)*<span class="number">100</span></div><div class="line">[<span class="number">1</span>] <span class="number">5.783149</span></div><div class="line">&gt; t.test(hf, control)$conf.int / mean(control) * <span class="number">100</span></div><div class="line">[<span class="number">1</span>] -<span class="number">8.169363</span> <span class="number">19.735661</span></div><div class="line">attr(,<span class="string">"conf.level"</span>)</div><div class="line">[<span class="number">1</span>] <span class="number">0.95</span></div></pre></td></tr></table></figure>
<p>此外，我们还可以写出一个名为<code>Cohen's d</code>的统计量，它是两组之间的差值除以这两组总和的标准差，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">sd_pool &lt;- sqrt(((N-<span class="number">1</span>)*var(hf) + (N-<span class="number">1</span>)*var(control))/(<span class="number">2</span>*N - <span class="number">2</span>))</div><div class="line">diff / sd_pool</div></pre></td></tr></table></figure>
<p>计算结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&gt; sd_pool &lt;- sqrt(((N-<span class="number">1</span>)*var(hf) + (N-<span class="number">1</span>)*var(control))/(<span class="number">2</span>*N - <span class="number">2</span>))</div><div class="line">&gt; diff / sd_pool</div><div class="line">[<span class="number">1</span>] <span class="number">0.3510624</span></div></pre></td></tr></table></figure>
<p>这个结果告诉我们，hf组的小鼠体重的均值与对照组(control)小鼠体重平均值偏离多少个标准差。在替代假设下，t统计量会随着样本数目的增加而增加，但是效应量(effect size)与<code>Cohen's d</code>却会变得更加精确。</p>
<h3 id="练习-2">练习</h3>
<p>P76</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2019/08/03/DAL/DALS003_Inference02_Population_Estimates/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/08/03/DAL/DALS003_Inference02_Population_Estimates/" itemprop="url">DALS003-统计推断(Inference)02-总体与样本估计</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-08-03T12:00:00+08:00">
                2019-08-03
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/生物统计/" itemprop="url" rel="index">
                    <span itemprop="name">生物统计</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  996
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  4
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="前言">前言</h2>
<p>这篇笔记是《Data Analysis for the Life Sciences》的第2章：统计推断(Inference)的第2部分。这一部分的主要内容涉及一些统计学的术语，即总体，样本和估计。</p>
<h2 id="总体population样本sample和估计estimates">总体(population)、样本(Sample)和估计(Estimates)</h2>
<h3 id="总体参数population-parameters">总体参数(population parameters)</h3>
<p>在小鼠体重的案例中，我们有两种总体，对照组雌性小鼠，高脂组雌性小鼠，其中体重是我们感兴趣的指标。现在我们假设种群的数目是固定的，而其中的随机误差就来源于抽样。我们使用下面的这个数据集来作为案例，这是因为我们正好有这种类型小鼠的数据，现在导入数据，跟前面的流程一下，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">library</span>(downloader)</div><div class="line">url &lt;- <span class="string">"https://raw.githubusercontent.com/genomicsclass/dagdata/master/inst/extd\</span></div><div class="line"><span class="string">ata/mice_pheno.csv"</span></div><div class="line">filename &lt;- <span class="string">"mice_pheno.csv"</span></div><div class="line">download(url,destfile=filename)</div><div class="line">dat &lt;- read.csv(filename)</div><div class="line">head(dat)</div></pre></td></tr></table></figure>
<p>计算结果如下：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">&gt; head(dat)</div><div class="line">  Sex Diet Bodyweight</div><div class="line"><span class="number">1</span>   <span class="literal">F</span>   hf      <span class="number">31.94</span></div><div class="line"><span class="number">2</span>   <span class="literal">F</span>   hf      <span class="number">32.48</span></div><div class="line"><span class="number">3</span>   <span class="literal">F</span>   hf      <span class="number">22.82</span></div><div class="line"><span class="number">4</span>   <span class="literal">F</span>   hf      <span class="number">19.92</span></div><div class="line"><span class="number">5</span>   <span class="literal">F</span>   hf      <span class="number">32.22</span></div><div class="line"><span class="number">6</span>   <span class="literal">F</span>   hf      <span class="number">27.50</span></div></pre></td></tr></table></figure>
<p>现在挑一个对照组的种群，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">library</span>(dplyr)</div><div class="line">controlPopulation &lt;- filter(dat,Sex == <span class="string">"F"</span> &amp; Diet == <span class="string">"chow"</span>) %&gt;% dplyr::select(Bodyweight) %&gt;% unlist</div><div class="line">head(controlPopulation)</div><div class="line">length(controlPopulation)</div></pre></td></tr></table></figure>
<p>如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&gt; head(controlPopulation)</div><div class="line">Bodyweight1 Bodyweight2 Bodyweight3 Bodyweight4 Bodyweight5 Bodyweight6 </div><div class="line">      <span class="number">27.03</span>       <span class="number">24.80</span>       <span class="number">27.02</span>       <span class="number">28.07</span>       <span class="number">23.55</span>       <span class="number">22.72</span> </div><div class="line">&gt; length(controlPopulation)</div><div class="line">[<span class="number">1</span>] <span class="number">225</span></div></pre></td></tr></table></figure>
<p>我们通常使用<span class="math inline">\(x_{1},x_{2},\dots,x_{m}\)</span>来表示对照组的这些数据，其中<span class="math inline">\(m\)</span>表示上述总体中的数字的数目。</p>
<p>现在我们来挑hf组的总体，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">hfPopulation &lt;- filter(dat, Sex ==<span class="string">"F"</span> &amp; Diet == <span class="string">"hf"</span>) %&gt;% dplyr::select(Bodyweight) %&gt;% unlist</div><div class="line">head(hfPopulation)</div><div class="line">length(hfPopulation)</div></pre></td></tr></table></figure>
<p>如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&gt; head(hfPopulation)</div><div class="line">Bodyweight1 Bodyweight2 Bodyweight3 Bodyweight4 Bodyweight5 Bodyweight6 </div><div class="line">      <span class="number">31.94</span>       <span class="number">32.48</span>       <span class="number">22.82</span>       <span class="number">19.92</span>       <span class="number">32.22</span>       <span class="number">27.50</span> </div><div class="line">&gt; length(hfPopulation)</div><div class="line">[<span class="number">1</span>] <span class="number">200</span></div></pre></td></tr></table></figure>
<p>现在我们使用y来表示hf组总体中的数目，即<span class="math inline">\(y_{1}, y_{2}, \dots,y_{y}\)</span>，现在我们定义这些总体的一些参数：</p>
<p>均值： <span class="math display">\[
\mu_{X}=\frac{1}{m} \sum_{i=1}^{m} x_{i} \text { and } \mu_{Y}=\frac{1}{n} \sum_{i=1}^{n} y_{i}
\]</span> 方差(variance)： <span class="math display">\[
\sigma_{X}^{2}=\frac{1}{m} \sum_{i=1}^{m}\left(x_{i}-\mu_{X}\right)^{2} \text { and } \sigma_{Y}^{2}=\frac{1}{n} \sum_{i=1}^{n}\left(y_{i}-\mu_{Y}\right)^{2}
\]</span> 我们从总体中获得的这两个参数，即均值和方差，称为总体参数(population parameters)。</p>
<p>我们一开始的问题就可以这么写：<span class="math inline">\(\mu_{Y}-\mu_{X}=0\)</span>?</p>
<p>虽然在我们的案例中我们获取了所有的值，并且验证这个问题是否为真，但是在实际中，我们并不能这么干。例如，在实际实验中，购买一个总体中的所有小鼠非常昂贵。此时，我们可以抽取一个样本(sample)来回答这个问题（也就是hf组和chow组中的小鼠体重的差异是否为0这个问题）。这就是统计推断(statistical inference)的本质。</p>
<h3 id="样本估计sample-estimates">样本估计(sample estimates)</h3>
<p>在前面部分中，我们从每个总体（hf总体和chow总体）中获取了样本，每个样本中有12只小鼠。在统计学中，我们经常使用大写字母来表示这些随机抽取的样本。因此这些样本就是<span class="math inline">\(X_{1}, \ldots, X_{M}\)</span>和<span class="math inline">\(Y_{1}, \ldots, Y_{N}\)</span>，在这个案例中，假设我们有12个样本，也就是说<span class="math inline">\(N=M=12\)</span>，当我们列出总体的值时（这个总体此时是设定的，不随机的），我们就使用小写字母来下标它们。</p>
<p>由于我们想知道总体的两个均值<span class="math inline">\(\mu_{Y}-\mu_{X}\)</span>是否为0，我们可以通过计算它们的样本之差是否为0，也即<span class="math inline">\(\bar{Y}-\bar{X}\)</span>是否为0来进行推断（在统计学中，常用希腊字母<span class="math inline">\(\mu\)</span>来表示总体均值，而用大写字母上加横的形式表示样本均值）： <span class="math display">\[
\overline{X}=\frac{1}{M} \sum_{i=1}^{M} X_{i} \text { and } \overline{Y}=\frac{1}{N} \sum_{i=1}^{N} Y_{i}
\]</span> 需要注意的是，2个均值的差值也是一个随机变量，这些内容我们在前面已经提及。</p>
<h2 id="练习">练习</h2>
<p>P39</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2019/08/02/DAL/DALS002_Inference01_Distribution/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/08/02/DAL/DALS002_Inference01_Distribution/" itemprop="url">DALS002-统计推断(Inference)01-概率分布</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-08-02T12:00:00+08:00">
                2019-08-02
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/生物统计/" itemprop="url" rel="index">
                    <span itemprop="name">生物统计</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  3,274
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  13
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="前言">前言</h2>
<p>这篇笔记是《Data Analysis for the Life Sciences》的第2章：统计推断(Inference)的第1部分。这一部分的主要内容涉及p值，置信区间(confidence intervals)。</p>
<h2 id="统计学基础">统计学基础</h2>
<p>先来看一篇文献，文献信息如下所示：</p>
<p>Winzell, M. S. and B. Ahren (2004). “The high-fat diet-fed mouse: a model for studying mechanisms and treatment of impaired glucose tolerance and type 2 diabetes.” Diabetes 53 Suppl 3: S215-219. 这篇文献的摘要部分有这么一句话：</p>
<blockquote>
<p>Body weight was higher in mice fed the high-fat diet already after the first week, due to higher dietary intake in combination with lower metabolic efficiency.</p>
</blockquote>
<p>上面摘要的这句话的意思是，饲喂高脂饮料的小鼠，在前一周内，体重上升，这是由能量摄入较高，外加代谢消耗低导致的。</p>
<p>为了支持这种结论，作者在结果部分提到了这些话：</p>
<blockquote>
<p>Already during the first week after introduction of high-fat diet, body weight increased significantly more in the high-fat diet-fed mice (+1.6± 0.1g) than in the normal diet- fed mice (+ 0.2±0.1 g; P &lt; 0.001)</p>
</blockquote>
<p>当小鼠在第1周内饲喂高脂饮料后，饮喂高脂饲料的小鼠体重的增加 (+1.6± 0.1g) 明显高于普通饲料饲喂的小鼠体重增加(+0.2±0.1g; P &lt; 0.001)。</p>
<p>这里面有几个地方需要注意，第一就是<code>P&lt;0.001</code>。第二就是<code>±</code>。</p>
<p>要了解这两个内容，第一步就需要理解随机变量(random variables)，这里使用作者在Github上提供的原始数据来计算，在第1篇笔记中已经提到，导入数据如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">filename &lt;- file.path(dir,<span class="string">"extdata/femaleMiceWeights.csv"</span>)</div><div class="line">dat &lt;- read.csv(filename)</div></pre></td></tr></table></figure>
<p>我们先要来研究一个问题：给小鼠特定的饲料，几周后小鼠的体重是否会增加？现在我们从Jackson实验室（Jackson实验室是全球最大的实验小鼠供应商）购买了24只小鼠，随机分布它们吃正常的饲料(chow)和高脂饲料(hf, high fat)，几周后，研究人员称量小鼠的体重，获取数据如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">&gt; head(dat)</div><div class="line">  Diet Bodyweight</div><div class="line"><span class="number">1</span> chow      <span class="number">21.51</span></div><div class="line"><span class="number">2</span> chow      <span class="number">28.14</span></div><div class="line"><span class="number">3</span> chow      <span class="number">24.04</span></div><div class="line"><span class="number">4</span> chow      <span class="number">23.45</span></div><div class="line"><span class="number">5</span> chow      <span class="number">23.68</span></div><div class="line"><span class="number">6</span> chow      <span class="number">19.79</span></div></pre></td></tr></table></figure>
<p>现在问题来了，饲喂高脂饲料(hf)的小鼠体重是否更重？从数据中我们可以知道，在hf组，编号24的小鼠体重是20.73g，它是最轻的小鼠，但是编号21的小鼠是34.02g，它是最重的小鼠，但是它们吃的都是高脂饲料，无法比较。此时，我们把这些小鼠体重的变化称为<code>变异(variability)</code>。</p>
<p>再回到那篇文献，那篇文献下结论的时候，指的变量就是小鼠体重的平均变化，现在我们计算每组小鼠的平均变化，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">library</span>(dplyr)</div><div class="line">control &lt;- filter(dat, Diet == <span class="string">"chow"</span>) %&gt;% select(Bodyweight) %&gt;% unlist</div><div class="line">treatment &lt;- filter(dat, Diet == <span class="string">"hf"</span>) %&gt;% select(Bodyweight) %&gt;% unlist</div><div class="line">print(mean(treatment))</div><div class="line">print(mean(control))</div><div class="line">obsdiff &lt;- mean(treatment) - mean(control)</div><div class="line">obsdiff</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">&gt; print(mean(treatment))</div><div class="line">[<span class="number">1</span>] <span class="number">26.83417</span></div><div class="line">&gt; print(mean(control))</div><div class="line">[<span class="number">1</span>] <span class="number">23.81333</span></div><div class="line">&gt; obsdiff &lt;- mean(treatment) - mean(control)</div><div class="line">&gt; obsdiff</div><div class="line">[<span class="number">1</span>] <span class="number">3.020833</span></div></pre></td></tr></table></figure>
<p>从结果中我们可以发现，hf组小鼠的平均体重大概高于chow组小鼠平均体重的10%。为什么在这个地方我们不能下确定的结论，还需要一个p值(p-value)与置信区间(confidence intervals)？</p>
<p>这是因为这些均数数是随机变量，如果我们再重复一次实验，也就是说，我们再从Jackson实验室购买24只小鼠，随机将它们分为2组，一组hf，一组chow，我们还会得到一个不同的平均值。每重复一次，都会得到一个平均值，我们称这样的数据为随机变量(random variable)。</p>
<h2 id="随机变量random-variable">随机变量(random variable)</h2>
<p>现在我们进一步研究随机变量。试想，我们能够获取所有对照组小鼠的体重，把它们都放在R中计算，从统计学角度来说，这个所有的对照组小鼠的体重就是总体(population)，我们可以从这个总体中随机抽取24只小鼠，事实上来说，我们不可能拿到总体，因为太大了，不过我们可以模拟这个思路，现在下载这个数据，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">dir &lt;- system.file(package = <span class="string">"dagdata"</span>)</div><div class="line">filename &lt;- file.path(dir,<span class="string">"extdata/femaleControlsPopulation.csv"</span>)</div><div class="line">population &lt;- read.csv(filename)</div><div class="line">population &lt;- unlist(population) <span class="comment"># turn it into a numeric</span></div></pre></td></tr></table></figure>
<p>现在我们随机从总体(population)中抽取12个样本，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">control &lt;- sample(population, <span class="number">12</span>)</div><div class="line">mean(control)</div><div class="line">control &lt;- sample(population, <span class="number">12</span>)</div><div class="line">mean(control)</div><div class="line">control &lt;- sample(population, <span class="number">12</span>)</div><div class="line">mean(control)</div></pre></td></tr></table></figure>
<p>运行结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">&gt; control &lt;- sample(population, <span class="number">12</span>)</div><div class="line">&gt; mean(control)</div><div class="line">[<span class="number">1</span>] <span class="number">23.33917</span></div><div class="line">&gt; control &lt;- sample(population, <span class="number">12</span>)</div><div class="line">&gt; mean(control)</div><div class="line">[<span class="number">1</span>] <span class="number">23.53917</span></div><div class="line">&gt; control &lt;- sample(population, <span class="number">12</span>)</div><div class="line">&gt; mean(control)</div><div class="line">[<span class="number">1</span>] <span class="number">24.18167</span></div></pre></td></tr></table></figure>
<p>现在我们可以发现，每次抽取的时候，平均都发生了变化，我们可以一直这么重复的抽样下去，然后就能了解随机变量的分布。</p>
<h2 id="零假设null-hypothesis">零假设(Null Hypothesis)</h2>
<p>现在我们再回到前面的那个hf组与chow组小鼠平均体重差值的变量<code>obsdiff</code>上来。众所周知，科学家都有怀疑精神，我们做了一次实验，我们如何知道<code>obsdiff</code>这个是由饮食造成的呢？如果我们给这2组小鼠都喂同样的饲料，结果会是什么呢？万一<code>obsdiff</code>这个值更大咋办？统计学家们就把这种情况称为零假设(Null Hypothesis)。这个零(null)指的就是怀疑的方向：我认为这2组小鼠的体重没有差异的可能性(possibility)有多大(credence)。（注：原话是：we give credence to the possibility that there is no difference)。</p>
<p>因为我们假设了我们能够获得总体，我们实际上可能尽可能多地观察到，当饲料没对体重没有影响时的差值。现在我们假设随机取了24只对照小鼠，把它们分为2组，也就是每组12只，现在我们观察一下它们平均体重值的差值，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">control &lt;- sample(population, <span class="number">12</span>) <span class="comment"># control mice</span></div><div class="line">treatment &lt;- sample(population, <span class="number">12</span>)</div><div class="line"><span class="comment"># We assume high diet have no effect on weight</span></div><div class="line">print(mean(treatment) - mean(control))</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; print(mean(treatment) - mean(control))</div><div class="line">[<span class="number">1</span>] <span class="number">0.2275</span></div></pre></td></tr></table></figure>
<p>现在我们重复这个过程1万次（最好不要使用for循环，这里可以使用<code>replicate()</code>函数），如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">n &lt;- <span class="number">10000</span></div><div class="line">null &lt;- vector(<span class="string">"numeric"</span>, n)</div><div class="line"><span class="keyword">for</span> (i <span class="keyword">in</span> <span class="number">1</span>:n)&#123;</div><div class="line">  control &lt;- sample(population, <span class="number">12</span>)</div><div class="line">  treatment &lt;- sample(population, <span class="number">12</span>)</div><div class="line">  null[i] &lt;- mean(treatment) - mean(control)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>其中变量<code>null</code>就是我们称的零分布(null distribution)，它里面有10000个差值，现在我们来计算一下，这里面的10000个差值与前面<code>obsdiff</code>的比较（原来过计算的obsdiff为3.020833），看一下大于原来的3.020833这个数字的比例有多大，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mean(null &gt;= <span class="number">3.020833</span>)</div></pre></td></tr></table></figure>
<p>如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; mean(null &gt;= <span class="number">3.020833</span>)</div><div class="line">[<span class="number">1</span>] <span class="number">0.013</span></div></pre></td></tr></table></figure>
<p>这个比例是0.013，也就是1.3%，也就是说，假设饲料对小鼠的体重没有影响，我们重复1万次实验，只有1.3%的比例，也就是说只有130次实验能说明“饲料对小鼠的体重没影响”这个结论，另外9870次我们都得不出这个结论，因此，即使作为怀疑性极强的科学们家，也只能说，当饲料对体重没有影响时，我们只能看到1.3%的的可能性。这就是p值。</p>
<p>下面是通过<code>replicate()</code>函数来实现上述过程，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">null_f &lt;- <span class="keyword">function</span>(x)&#123;</div><div class="line">  control &lt;- sample(x, <span class="number">12</span>)</div><div class="line">  treatment &lt;- sample(x, <span class="number">12</span>)</div><div class="line">  null &lt;- mean(treatment) - mean(control)</div><div class="line">  <span class="keyword">return</span>(null)</div><div class="line">&#125;</div><div class="line"></div><div class="line">null_result &lt;- replicate(n, null_f(population))</div><div class="line">mean(null_result&gt;=<span class="number">3.020833</span>)</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; mean(null_result&gt;=<span class="number">3.020833</span>)</div><div class="line">[<span class="number">1</span>] <span class="number">0.0123</span></div></pre></td></tr></table></figure>
<p>1.23%。</p>
<h2 id="分布distributions">分布(distributions)</h2>
<p>分布简单来说就是，对大量数据的精简描述，例如你测量了一个总体中的所有男性的身高，现在你需要把这些数据向一个外星人描述，而这个外星人从来没到过地球，数据如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">library</span>(UsingR)</div><div class="line">x &lt;- father.son$fheight</div></pre></td></tr></table></figure>
<p>注：这个包<code>UsingR</code>是《Using R for Introductory Statistics》 Second Edition的数据。其中<code>father.son</code>这个数据集含有的是父亲的身高与儿子的身高（单位是英寸），用于研究Pearson相关系数。</p>
<p>现在向外星人描述比较简单的方法就是把它们都列出来，现在我们随机选择10个数据，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">round(sample(x,<span class="number">10</span>),<span class="number">10</span>)</div></pre></td></tr></table></figure>
<p>如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&gt; round(sample(x,<span class="number">10</span>),<span class="number">10</span>)</div><div class="line"> [<span class="number">1</span>] <span class="number">65.25267</span> <span class="number">62.41134</span> <span class="number">68.83427</span> <span class="number">66.69404</span> <span class="number">65.98544</span> <span class="number">69.60692</span> <span class="number">71.96564</span> <span class="number">68.11283</span> <span class="number">67.93353</span></div><div class="line">[<span class="number">10</span>] <span class="number">67.41537</span></div></pre></td></tr></table></figure>
<h3 id="累积分布函数cumulative-distribution-function-cdf">累积分布函数(Cumulative Distribution Function, CDF)</h3>
<p>通过查看这些数字，我们了解一个大概，但是非常低效。但是我们可以通过一个分布曲线(distribution)来画一下这些数据，现在我们定义一下分布，先取一个值a，小于a值的数字的比例，就是分布，如下所示： <span class="math display">\[
F(a) \equiv \operatorname{Pr}(x \leq a)
\]</span></p>
<p>这个函数叫累积分布函数(CDF)，当CDF来源于一个数据集中，而不是理论值时，我们就称它为经验累积分布函数(empirical CDF, ECDF)，我们可以画出这个分布曲线，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">smallest &lt;- floor(min(x))</div><div class="line">largest &lt;- ceiling(max(x))</div><div class="line">values &lt;- seq(smallest, largest, len=<span class="number">300</span>)</div><div class="line">heightecdf &lt;- ecdf(x)</div><div class="line">plot(values, heightecdf(values), type=<span class="string">"l"</span>,</div><div class="line">     xlab=<span class="string">"a(Height in inches)"</span>, ylab=<span class="string">"Pr(x &lt;= a)"</span>)</div></pre></td></tr></table></figure>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190721111343.jpeg">

</div>
<h3 id="直方图histograms">直方图(Histograms)</h3>
<p><code>ecdf</code>这个函数在R中并不常用，现在我们使用区间的形式来给出间内的比例，如下所示：</p>
<p><span class="math display">\[
\begin{equation}
\operatorname{Pr}(a \leq x \leq b)=F(b)-F(a)
\end{equation}
\]</span></p>
<p>使用直方图更加直观，因为我们多数感兴趣的是某个区间的高度，例如70到71这个区间的比例，而很少会去看低于70这个比例，直方图如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">hist(x)</div></pre></td></tr></table></figure>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190721111829.jpeg">

</div>
<p>可以对这个直方图做进一步的修饰，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">bins &lt;- seq(smallest, largest)</div><div class="line">hist(x, breaks=bins, xlab=<span class="string">"Height(in inches)"</span>, main=<span class="string">"Adlt men heights"</span>)</div></pre></td></tr></table></figure>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190721112009.jpeg">

</div>
<p>这种图比纯列数字更加直观，从图上我们大致就能判断出高于72英寸的人大概有70个人。</p>
<h2 id="概率分布probability-distribution">概率分布(Probability Distribution)</h2>
<p>分布的一个更加重要的功能是用于描述一个随机变量的可能结果。与一组固定的数据不同，我们实际上无法观测到随机变量的所有可能结果，因此，我们在这种情况下，不描述比例(proportions)，而是用于描述概率(probabilities)。例如，当我们从上面的那组身高数据中取机挑一个数字，它落在a与b区间内的概率就可以用下面的公式表示： <span class="math display">\[
\operatorname{Pr}(a \leq X \leq b)=F(b)-F(a)
\]</span> 上面公式中的<code>X</code>表示随机变量，这个公式定义了随机变量的概率分布。例如，在这种情况下，如果我们知道了零假设下的小鼠体重均值的差值分布是真的，那么，我们就能在这个分布上找到与我们实验中计算出的值对应值的概率，也就是p值。</p>
<p>在前面的案例中，我们计算了10000个零假设下的随机变量概率分布（这种重复抽样的方法叫蒙特卡罗法,Monte Carlo），现在我们再重复一次，不过这次有所不同，在每重复做一次实验，我们就把这个点添加到图片上，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">library</span>(rafalib)</div><div class="line">n &lt;- <span class="number">100</span></div><div class="line">nullplot(-<span class="number">5</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">30</span>, xlab=<span class="string">"Observed differences(grams)"</span>, ylab=<span class="string">"Frequencey"</span>)</div><div class="line">totals &lt;- vector(<span class="string">"numeric"</span>,<span class="number">11</span>)</div><div class="line"><span class="keyword">for</span> (i <span class="keyword">in</span> <span class="number">1</span>:n)&#123;</div><div class="line">  control &lt;- sample(population, <span class="number">12</span>)</div><div class="line">  treatment &lt;- sample(population, <span class="number">12</span>)</div><div class="line">  nulldiff &lt;- mean(treatment) - mean(control)</div><div class="line">  j &lt;- pmax(pmin(round(nulldiff)+<span class="number">6</span>, <span class="number">11</span>),<span class="number">1</span>)</div><div class="line">  totals[j] &lt;- totals[j]+<span class="number">1</span></div><div class="line">  text(j-<span class="number">6</span>, totals[j], pch=<span class="number">15</span>, round(nulldiff,<span class="number">1</span>),cex=<span class="number">1</span>)</div><div class="line">  <span class="keyword">if</span>(i &lt;<span class="number">15</span>) Sys.sleep(<span class="number">1</span>) <span class="comment"># See values appear slowly</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190721114309.jpeg">

</div>
<p>上面的图其实就是一个直方图，obsdiff最初的值是3.020833，从上面的图我们可以知道，与这个值接近的数字很少。</p>
<p>从前面我们计算的null可以看出来，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">hist(null, freq=<span class="literal">TRUE</span>)</div><div class="line">abline(v=obsdiff, col=<span class="string">"red"</span>, lwd=<span class="number">2</span>)</div></pre></td></tr></table></figure>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190721114517.jpeg">

</div>
<p>上面是我们手动计算<code>Pr(a)</code>的过程，但多数情况下，一些分布的<code>Pr(a)</code>公式都是已知的，例如正态分布。</p>
<h2 id="正态分布normal-distribution">正态分布(Normal Distribution)</h2>
<p>正态分布是最常见的分布之一，normal就是正常，常见的意思，它的公式如下所示： <span class="math display">\[
\operatorname{Pr}(a&lt;x&lt;b)=\int_{a}^{b} \frac{1}{\sqrt{2 \pi \sigma^{2}}} \exp \left(\frac{-(x-\mu)^{2}}{2 \sigma^{2}}\right) d x
\]</span></p>
<p>在R的<code>pnorm()</code>函数中，a通常是负无穷，b则是你要计算的参数，另外，要计算区间的概率，还需要两个参数，分别是均值与标准差，即<code>pnomr(x, mu, sigma)</code>，这个公式计算的就是小于x的这值的概率，现在回到前面的<code>obsdiff(3.020833)</code>这个变量上来，我们计算一下：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="number">1</span> - pnorm(obsdiff, mean(null),sd(null))</div></pre></td></tr></table></figure>
<p>如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; <span class="number">1</span> - pnorm(obsdiff, mean(null),sd(null))</div><div class="line">[<span class="number">1</span>] <span class="number">0.01377017</span></div></pre></td></tr></table></figure>
<h2 id="小结">小结</h2>
<p>计算hf组与chow组小鼠的体重差异的p值是非常简单的。为了做这个计算，我们可以买来所有的小鼠，来重复的计算，找到零假设，但是不现实，因此我们要使用统计推断(Statistical Inference)的思想，这种思想可以允许我们使用少量的样本，例如24只小鼠就能得到一个相对靠谱的结论。</p>
<h2 id="练习">练习</h2>
<p>原书P37</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2019/08/01/DAL/DALS001_Getting_Start/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/08/01/DAL/DALS001_Getting_Start/" itemprop="url">DALS01-数据准备(Getting Started)</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-08-01T12:00:00+08:00">
                2019-08-01
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/生物统计/" itemprop="url" rel="index">
                    <span itemprop="name">生物统计</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  1,509
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  7
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="前言">前言</h2>
<p>本书是《Data Analysis for the Life Sciences》这本书的读书笔记。</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190721083503.png">

</div>
<p>此书一共分了10部分，分别为：</p>
<ul>
<li>第一章：数据准备(Getting Started)</li>
<li>第二章：统计推断(Inference)</li>
<li>第三章：数据挖掘(Exploratory Data Analysis)</li>
<li>第四章：矩阵代数(Matrix Algebra)</li>
<li>第五章：线性模型(Linear Models)</li>
<li>第六章：高维数据推断(Inference For high Dimensional Data)</li>
<li>第七章：统计模型(Statistical Models)</li>
<li>第八章：距离与降低(Distance and Dimension Reduction)</li>
<li>第九章：基础机器学习(Basic Machine Learning)</li>
<li>第十章：批次效应(Batch Effects)</li>
</ul>
<p>这篇笔记是《Data Analysis for the Life Sciences》第一章的内容，是关于书中原始数据的准备，相关知识主要是R语言的基础语法，文件路径操作，数学符号。</p>
<h2 id="r语言包与原始数据准备">R语言包与原始数据准备</h2>
<p>这本书中涉及到的统计学原理与案例分析都是通过R语言实现的，作者也把相应的脚本与数据放到了Github上。</p>
<p>这里先安装几个R包，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">library</span>(devtools)</div><div class="line">install_github(<span class="string">"genomicsclass/dagdata"</span>)</div><div class="line">dir &lt;- system.file(package = <span class="string">"dagdata"</span>)</div><div class="line">list.files(dir)</div></pre></td></tr></table></figure>
<p>加载原始数据 ，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&gt; dir &lt;- system.file(package = <span class="string">"dagdata"</span>)</div><div class="line">&gt; list.files(dir)</div><div class="line">[<span class="number">1</span>] <span class="string">"data"</span>        <span class="string">"DESCRIPTION"</span> <span class="string">"extdata"</span>     <span class="string">"help"</span>        <span class="string">"html"</span>        <span class="string">"Meta"</span>       </div><div class="line">[<span class="number">7</span>] <span class="string">"NAMESPACE"</span>   <span class="string">"script"</span></div></pre></td></tr></table></figure>
<p>上面的代码使用了到几个包与命令，其中<code>devtool</code>包中的<code>install_github()</code>函数用于直接从Github下载相应包，以前的笔记中已经说明了这个包的用法<a href="http://rvdsd.top/2017/04/07/R/R%E5%8C%85%E7%9A%84%E6%93%8D%E4%BD%9C%E4%B8%8E%E5%86%85%E7%BD%AE%E6%95%B0%E6%8D%AE%E9%9B%86/">《R语言笔记之包的操作与内置数据集》</a>。</p>
<p>另外还有两个函数，其中<code>system.file()</code>函数的功能是：发现包的完整路径名，例如上面的变量<code>dir</code>的输出就是如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; dir</div><div class="line">[<span class="number">1</span>] <span class="string">"C:/Users/20161111/Documents/R/win-library/3.5/dagdata"</span></div></pre></td></tr></table></figure>
<p><code>list.files()</code>函数的功能是列出相应路径下的文件，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&gt; list.files(dir)</div><div class="line">[<span class="number">1</span>] <span class="string">"data"</span>        <span class="string">"DESCRIPTION"</span> <span class="string">"extdata"</span>     <span class="string">"help"</span>        <span class="string">"html"</span>        <span class="string">"Meta"</span>       </div><div class="line">[<span class="number">7</span>] <span class="string">"NAMESPACE"</span>   <span class="string">"script"</span></div></pre></td></tr></table></figure>
<p>使用<code>list.files()</code>函数还能继续列举出目录下一层目录中的内容，例如现在我们列出<code>extdata</code>这个目录中的内容，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&gt; list.files(file.path(dir,<span class="string">"extdata"</span>))</div><div class="line">[<span class="number">1</span>] <span class="string">"admissions.csv"</span>               <span class="string">"astronomicalunit.csv"</span>        </div><div class="line">[<span class="number">3</span>] <span class="string">"babies.txt"</span>                   <span class="string">"femaleControlsPopulation.csv"</span></div><div class="line">[<span class="number">5</span>] <span class="string">"femaleMiceWeights.csv"</span>        <span class="string">"mice_pheno.csv"</span>              </div><div class="line">[<span class="number">7</span>] <span class="string">"msleep_ggplot2.csv"</span>           <span class="string">"README"</span>                      </div><div class="line">[<span class="number">9</span>] <span class="string">"spider_wolff_gorb_2013.csv"</span></div></pre></td></tr></table></figure>
<p>其中这里面用到<code>file.path()</code>函数，它的功能是将字符串连接起来，形成路径，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; file.path(dir,<span class="string">"extdata"</span>)</div><div class="line">[<span class="number">1</span>] <span class="string">"C:/Users/20161111/Documents/R/win-library/3.5/dagdata/extdata"</span></div></pre></td></tr></table></figure>
<p>现在加载原始数据，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">filename &lt;- file.path(dir,<span class="string">"extdata/femaleMiceWeights.csv"</span>)</div><div class="line">dat &lt;- read.csv(filename)</div><div class="line"><span class="comment"># input raw data</span></div><div class="line">head(dat)</div><div class="line">str(dat)</div></pre></td></tr></table></figure>
<p>数据如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">&gt; head(dat)</div><div class="line">  Diet Bodyweight</div><div class="line"><span class="number">1</span> chow      <span class="number">21.51</span></div><div class="line"><span class="number">2</span> chow      <span class="number">28.14</span></div><div class="line"><span class="number">3</span> chow      <span class="number">24.04</span></div><div class="line"><span class="number">4</span> chow      <span class="number">23.45</span></div><div class="line"><span class="number">5</span> chow      <span class="number">23.68</span></div><div class="line"><span class="number">6</span> chow      <span class="number">19.79</span></div><div class="line">&gt; str(dat)</div><div class="line"><span class="string">'data.frame'</span>:	<span class="number">24</span> obs. of  <span class="number">2</span> variables:</div><div class="line"> $ Diet      : Factor w/ <span class="number">2</span> levels <span class="string">"chow"</span>,<span class="string">"hf"</span>: <span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="keyword">...</span></div><div class="line"> $ Bodyweight: num  <span class="number">21.5</span> <span class="number">28.1</span> <span class="number">24</span> <span class="number">23.4</span> <span class="number">23.7</span> <span class="keyword">...</span></div></pre></td></tr></table></figure>
<p>从数据我们可以知道，这是一个数据框，有2列，第1列是小鼠的包含情况，分别是chow（正常组）,hf（高脂组，就是high fat的缩写），第2列的体重，从常识可以知道，单位是g（一只标准的小鼠体重是18-22g）。</p>
<p>以上是原始数据的下载过程，涉及到的知识点为：R包的下载与加载，另外，也可以通过<code>downloader</code>包来下载原始数据，整个操作如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">install.packages(<span class="string">"downloader"</span>)</div><div class="line">url &lt;- <span class="string">"https://raw.githubusercontent.com/genomicsclass/dagdata/master/inst/extd\</span></div><div class="line"><span class="string">ata/femaleMiceWeights.csv"</span></div><div class="line">filename &lt;- <span class="string">"femaleMiceWeights.csv"</span></div><div class="line">download(url, destfile=filename)</div></pre></td></tr></table></figure>
<p>这一过程不再演示，跟前面的目的是一样，都是下载原始数据。</p>
<p>有了原始数据后，现在过程一下数据，我们捏造chow组的小鼠数据，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">library</span>(dplyr)</div><div class="line">chow &lt;- filter(dat, Diet ==<span class="string">"chow"</span>)</div><div class="line"><span class="comment"># Extract chow gropu from raw data of dat </span></div><div class="line">head(chow)</div><div class="line">str(chow)</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&gt; chow &lt;- filter(dat, Diet ==<span class="string">"chow"</span>)</div><div class="line">&gt; str(chow)</div><div class="line"><span class="string">'data.frame'</span>:	<span class="number">12</span> obs. of  <span class="number">2</span> variables:</div><div class="line"> $ Diet      : Factor w/ <span class="number">2</span> levels <span class="string">"chow"</span>,<span class="string">"hf"</span>: <span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="keyword">...</span></div><div class="line"> $ Bodyweight: num  <span class="number">21.5</span> <span class="number">28.1</span> <span class="number">24</span> <span class="number">23.4</span> <span class="number">23.7</span> <span class="keyword">...</span></div></pre></td></tr></table></figure>
<p>仅提取chow组的体重，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">chowVals &lt;- select(chow, Bodyweight)</div><div class="line">head(chowVals)</div><div class="line">str(chowVals)</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">&gt; head(chowVals)</div><div class="line">  Bodyweight</div><div class="line"><span class="number">1</span>      <span class="number">21.51</span></div><div class="line"><span class="number">2</span>      <span class="number">28.14</span></div><div class="line"><span class="number">3</span>      <span class="number">24.04</span></div><div class="line"><span class="number">4</span>      <span class="number">23.45</span></div><div class="line"><span class="number">5</span>      <span class="number">23.68</span></div><div class="line"><span class="number">6</span>      <span class="number">19.79</span></div><div class="line">&gt; str(chowVals)</div><div class="line"><span class="string">'data.frame'</span>:	<span class="number">12</span> obs. of  <span class="number">1</span> variable:</div><div class="line"> $ Bodyweight: num  <span class="number">21.5</span> <span class="number">28.1</span> <span class="number">24</span> <span class="number">23.4</span> <span class="number">23.7</span> <span class="keyword">...</span></div><div class="line">&gt; class(chowVals)</div><div class="line">[<span class="number">1</span>] <span class="string">"data.frame"</span></div><div class="line">&gt; <span class="comment"># OR perform as following:</span></div><div class="line">&gt; <span class="comment"># chowVals &lt;- filter(dat, Diet=="chow") %&gt;% select(Bodyweight)</span></div></pre></td></tr></table></figure>
<p>从上面结果可以看出来，<code>chowVals</code>是一个数据框，现在我们将其转换为数字向量：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">chowVals &lt;- unlist(chowVals)</div><div class="line">str(chowVals)</div><div class="line">class(chowVals)</div></pre></td></tr></table></figure>
<p>如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&gt; str(chowVals)</div><div class="line"> Named num [<span class="number">1</span>:<span class="number">12</span>] <span class="number">21.5</span> <span class="number">28.1</span> <span class="number">24</span> <span class="number">23.4</span> <span class="number">23.7</span> <span class="keyword">...</span></div><div class="line"> - attr(*, <span class="string">"names"</span>)= chr [<span class="number">1</span>:<span class="number">12</span>] <span class="string">"Bodyweight1"</span> <span class="string">"Bodyweight2"</span> <span class="string">"Bodyweight3"</span> <span class="string">"Bodyweight4"</span> <span class="keyword">...</span></div><div class="line">&gt; class(chowVals)</div><div class="line">[<span class="number">1</span>] <span class="string">"numeric"</span></div></pre></td></tr></table></figure>
<h2 id="数学术语与符号">数学术语与符号</h2>
<p>作者在书中提到，他会尽量避免使用数学术语与数学符号，但是，有一些太常见的数据符号是大家常见的，需要知道。</p>
<h3 id="希腊字母">希腊字母</h3>
<p><span class="math inline">\(\sum\)</span>是希腊字母中的S的写法，表示相加，例如<span class="math inline">\(S=\sum_{i=1}^{n} x_{i}\)</span></p>
<p><span class="math inline">\(\mu\)</span>表示未知均数，相当于m，即mean；</p>
<p><span class="math inline">\(\sigma\)</span>表示标准差，相当于s，即standard difference；</p>
<p><span class="math inline">\(\epsilon\)</span>表示随机误差，相当于error；</p>
<p><span class="math inline">\(\beta\)</span>表示效应，即effect。</p>
<h3 id="无穷infinity">无穷(Infinity)</h3>
<p>书中指出，我们经常使用的统计学结果是一种渐进结果(asymptotic results)。这个渐进结果指的是一种近似(approximation)，也就是说随着数据点数目的增大，这个结果只能接近，无法完全相等，只有当数据点的数目是无穷(<span class="math inline">\(\infty\)</span>)时，数字最接近，看下面的一个案例：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">&gt; onethird &lt;- <span class="keyword">function</span>(n) sum(<span class="number">3</span>/<span class="number">10</span>^c(<span class="number">1</span>:n))</div><div class="line">&gt; <span class="number">1</span>/<span class="number">3</span> - onethird(<span class="number">4</span>)</div><div class="line">[<span class="number">1</span>] <span class="number">3.333333e-05</span></div><div class="line">&gt; <span class="number">1</span>/<span class="number">3</span> - onethird(<span class="number">10</span>)</div><div class="line">[<span class="number">1</span>] <span class="number">3.333334e-11</span></div><div class="line">&gt; <span class="number">1</span>/<span class="number">3</span> - onethird(<span class="number">16</span>)</div><div class="line">[<span class="number">1</span>] <span class="number">0</span></div></pre></td></tr></table></figure>
<p>在这个案例中，我们就看到了，0.3的1到n次方的和是接近1/3的。</p>
<h3 id="积分integrals">积分(Integrals)</h3>
<p>积分在统计学也是比较常用的一个手段，有的时候要计算某个统计学分布的概率分布例如下面的这个曲线：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190721091241.png">

</div>
<p>这个曲线是一个概率密度曲线，右下角的灰色面积占整个曲线下面积的比例，就是相应的概率（后面会讲），那么通过积分的手段来计算面积的分公式就是： <span class="math display">\[
\int_{2}^{4} f(x) d x
\]</span></p>
<h2 id="练习">练习</h2>
<p>原书P16页</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2019/07/23/BioItem/iTRAQ定量蛋白质组(下)/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/07/23/BioItem/iTRAQ定量蛋白质组(下)/" itemprop="url">iTRAQ定量蛋白质组(下)</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-07-23T12:00:00+08:00">
                2019-07-23
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/生信实战项目/" itemprop="url" rel="index">
                    <span itemprop="name">生信实战项目</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  75
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  1
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>TMT标签</p>
<p>https://www.thermofisher.com/cn/zh/home/life-science/protein-biology/protein-mass-spectrometry-analysis/protein-quantitation-mass-spectrometry/tandem-mass-tag-systems.html</p>
<p>http://www.mtoz-biolabs.com/itraq-tmt.html</p>
<p>http://www.bioinfor.com/quantification/</p>
<p>https://www.sciencedirect.com/topics/medicine-and-dentistry/isobaric-labeling</p>
<p>https://www.thermofisher.com/cn/zh/home/life-science/protein-biology/protein-biology-learning-center/protein-biology-resource-library/pierce-protein-methods/quantitative-proteomics.html</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2019/07/15/R/R语言中的颜色设置/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/07/15/R/R语言中的颜色设置/" itemprop="url">R语言中的颜色设置</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-07-15T12:00:00+08:00">
                2019-07-15
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/R/" itemprop="url" rel="index">
                    <span itemprop="name">R</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  860
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  4
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="rcolorbrewer包">RColorBrewer包</h2>
<p>此包的官方配色网站是：http://colorbrewer2.org</p>
<h3 id="brewer.pal"><code>brewer.pal()</code></h3>
<p>参数为：<code>brewer.pal(n ,name)</code>，其中n为不同颜色数，最小为3，最大取决于调色板中的颜色数。name指颜色的名称，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">mypalette&lt;-brewer.pal(<span class="number">7</span>,<span class="string">"Greens"</span>)</div><div class="line">mypalette</div></pre></td></tr></table></figure>
<p>运行结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&gt; mypalette&lt;-brewer.pal(<span class="number">7</span>,<span class="string">"Greens"</span>)</div><div class="line">&gt; mypalette</div><div class="line">[<span class="number">1</span>] <span class="string">"#EDF8E9"</span> <span class="string">"#C7E9C0"</span> <span class="string">"#A1D99B"</span> <span class="string">"#74C476"</span> <span class="string">"#41AB5D"</span> <span class="string">"#238B45"</span> <span class="string">"#005A32"</span></div></pre></td></tr></table></figure>
<h3 id="display.brewer.pal"><code>display.brewer.pal()</code></h3>
<p>在窗口中显示显示的颜色，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">display.brewer.pal(<span class="number">7</span>,<span class="string">"BrBG"</span>)</div></pre></td></tr></table></figure>
<p>运行结果如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190715095133.png">

</div>
<h3 id="brewer.pal.info可以查看颜色信息"><code>brewer.pal.info()</code>可以查看颜色信息</h3>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">brewer.pal.info[<span class="string">"Blues"</span>,]</div></pre></td></tr></table></figure>
<p>如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&gt; brewer.pal.info[<span class="string">"Blues"</span>,]</div><div class="line">      maxcolors category colorblind</div><div class="line">Blues         <span class="number">9</span>      seq       <span class="literal">TRUE</span></div></pre></td></tr></table></figure>
<h3 id="display.brewer.all"><code>display.brewer.all()</code></h3>
<p>参数为：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">display.brewer.all(n=<span class="number">10</span>, type=<span class="string">"all"</span>, select=<span class="literal">NULL</span>, exact.n=<span class="literal">TRUE</span>, </div><div class="line">colorblindFriendly=<span class="literal">FALSE</span>)</div></pre></td></tr></table></figure>
<p>同时显示几个调色板，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190715095827.png">

</div>
<h4 id="颜色类型">颜色类型</h4>
<p>其中参数<code>type</code>是显示颜色类型，一共有三种颜色类型，分别是seq连续型，div离散型，qual极端型，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">display.brewer.all(type = <span class="string">"seq"</span>)</div></pre></td></tr></table></figure>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190715095816.png">

</div>
<p>如果我们要使用YIOrRd组中的第1，3，4，6，8，9这6种颜色，可以使用下面的代码：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">barplot(rep(<span class="number">1</span>,<span class="number">6</span>),col = brewer.pal(<span class="number">9</span>,<span class="string">"YlOrRd"</span>)[c(<span class="number">1</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">6</span>,<span class="number">8</span>,<span class="number">9</span>)])</div></pre></td></tr></table></figure>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190715100025.png">

</div>
<p>div离散型颜色，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">display.brewer.all(type = <span class="string">"div"</span>)</div></pre></td></tr></table></figure>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190715100112.png">

</div>
<p>这种颜色两边亮，中间暗，比较适合进行高低对比。</p>
<p>现在我们使用BrBG组中的3到8种颜色，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">barplot(rep(<span class="number">1</span>,<span class="number">6</span>),col = brewer.pal(<span class="number">11</span>,<span class="string">"BrBG"</span>)[<span class="number">3</span>:<span class="number">8</span>])</div></pre></td></tr></table></figure>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190715100205.png">

</div>
<p>qual极端型颜色</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">display.brewer.all(type = <span class="string">"qual"</span>)</div></pre></td></tr></table></figure>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190715100235.png">

</div>
<p>这种颜色比较适合呈现分类变量。</p>
<p>现在使用Set3中的3到8种颜色，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">barplot(rep(<span class="number">1</span>,<span class="number">6</span>),col = brewer.pal(<span class="number">12</span>,<span class="string">"Set3"</span>)[<span class="number">3</span>:<span class="number">8</span>])</div></pre></td></tr></table></figure>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190715100306.png">

</div>
<h2 id="rcolorbrewer包使用案例">RColorBrewer包使用案例</h2>
<h3 id="第1案例从现在的颜色中挑选颜色">第1案例：从现在的颜色中挑选颜色</h3>
<p>代码如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">### Set the display a 1 by 1 grid</span></div><div class="line">par(mfrow=c(<span class="number">1</span>,<span class="number">1</span>))</div><div class="line"><span class="comment">### Generate random data matrix</span></div><div class="line">rand.data &lt;- replicate(<span class="number">8</span>,rnorm(<span class="number">100</span>,<span class="number">100</span>,sd=<span class="number">1.5</span>))</div><div class="line"><span class="comment">### Draw a box plot, with each box coloured by the 'Set3' palette</span></div><div class="line">boxplot(rand.data,col=brewer.pal(<span class="number">8</span>,<span class="string">"Set3"</span>))</div></pre></td></tr></table></figure>
<p>这里使用到了<code>replicate()</code>函数，这个函数在<code>rand.data &lt;- replicate(8,rnorm(100,100,sd=1.5))</code>这个语句中的意思是，将后面的<code>rnorm(100,100,sd=1.5)</code>这个语句运行100次，也就是生成800个均值为100，sd为1.5的，符合正态分布的数据，结果如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190715100823.png">

</div>
<h3 id="第2案例使用colorramppalette来扩展颜色">第2案例：使用<code>colorRampPalette()</code>来扩展颜色</h3>
<p>代码如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">### 使用colorRampPalette可以扩展颜色。</span></div><div class="line">newpalette&lt;-colorRampPalette(brewer.pal(<span class="number">9</span>,<span class="string">"Blues"</span>))(<span class="number">10</span>)</div><div class="line"><span class="comment">### Generate random data matrix</span></div><div class="line">rand.data &lt;- replicate(<span class="number">10</span>,rnorm(<span class="number">100</span>,<span class="number">100</span>,sd=<span class="number">1.5</span>))</div><div class="line"><span class="comment">### Draw a box plot, with each box coloured by the 'newpalette' palette</span></div><div class="line">boxplot(rand.data,col=newpalette)</div></pre></td></tr></table></figure>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190715101208.png">

</div>
<p>这里使用到了<code>colorRampPalette()</code>函数，此函数可以自定义一繁殖颜色梯度，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">colors &lt;- colorRampPalette(c(<span class="string">"green"</span>, <span class="string">"red"</span>))(<span class="number">5</span>)</div><div class="line">colors</div><div class="line">rand.data &lt;- replicate(<span class="number">10</span>,rnorm(<span class="number">100</span>,<span class="number">100</span>,sd=<span class="number">1.5</span>))</div><div class="line">boxplot(rand.data,col=colors)</div></pre></td></tr></table></figure>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190715101512.png">

</div>
<p>这种功能在绘制热图时很有用。</p>
<h2 id="wesanderson颜色包"><code>wesanderson</code>颜色包</h2>
<p>可用的颜色有好几个，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&gt; names(wes_palettes)</div><div class="line"> [<span class="number">1</span>] <span class="string">"BottleRocket1"</span>  <span class="string">"BottleRocket2"</span>  <span class="string">"Rushmore1"</span>      <span class="string">"Rushmore"</span>      </div><div class="line"> [<span class="number">5</span>] <span class="string">"Royal1"</span>         <span class="string">"Royal2"</span>         <span class="string">"Zissou1"</span>        <span class="string">"Darjeeling1"</span>   </div><div class="line"> [<span class="number">9</span>] <span class="string">"Darjeeling2"</span>    <span class="string">"Chevalier1"</span>     <span class="string">"FantasticFox1"</span>  <span class="string">"Moonrise1"</span>     </div><div class="line">[<span class="number">13</span>] <span class="string">"Moonrise2"</span>      <span class="string">"Moonrise3"</span>      <span class="string">"Cavalcanti1"</span>    <span class="string">"GrandBudapest1"</span></div><div class="line">[<span class="number">17</span>] <span class="string">"GrandBudapest2"</span> <span class="string">"IsleofDogs1"</span>    <span class="string">"IsleofDogs2"</span></div></pre></td></tr></table></figure>
<p>查看一下，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">wes_palette(<span class="string">"BottleRocket1"</span>)</div></pre></td></tr></table></figure>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190715102342.png">

</div>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">wes_palette(<span class="string">"BottleRocket2"</span>)</div></pre></td></tr></table></figure>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190715102408.png">

</div>
<p>看一下使用案例：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">library</span>(<span class="string">"ggplot2"</span>)</div><div class="line">ggplot(mtcars, aes(factor(cyl), fill=factor(vs))) +  geom_bar() +</div><div class="line">  scale_fill_manual(values = wes_palette(<span class="string">"Royal1"</span>))</div></pre></td></tr></table></figure>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190715102457.png">

</div>
<p>看一下热图案例：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">pal &lt;- wes_palette(<span class="string">"Zissou1"</span>, <span class="number">100</span>, type = <span class="string">"continuous"</span>)</div><div class="line"><span class="comment"># heatmap is a local dataset</span></div><div class="line">ggplot(heatmap, aes(x = X2, y = X1, fill = value)) +</div><div class="line">  geom_tile() + </div><div class="line">  scale_fill_gradientn(colours = pal) + </div><div class="line">  scale_x_discrete(expand = c(<span class="number">0</span>, <span class="number">0</span>)) +</div><div class="line">  scale_y_discrete(expand = c(<span class="number">0</span>, <span class="number">0</span>)) + </div><div class="line">  coord_equal()</div></pre></td></tr></table></figure>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190715102638.png">

</div>
<h2 id="参考资料">参考资料</h2>
<ol style="list-style-type: decimal">
<li><a href="https://www.cnblogs.com/homewch/archive/2016/07/25/5704153.html" target="_blank" rel="external">R语言配色方案 — RColorBrewer包</a></li>
<li><a href="https://www.cnblogs.com/huzs/p/3742000.html" target="_blank" rel="external">R语言编程入门–replicate()函数比较有意思!</a></li>
<li><a href="https://www.cnblogs.com/xudongliang/p/6932195.html" target="_blank" rel="external">R语言colorRampPalette函数-创建颜色梯度(渐变色)</a></li>
<li><a href="https://www.cnblogs.com/sanmenyi/p/7219574.html" target="_blank" rel="external">R语言可视化–颜色</a></li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2019/07/12/Literature/炎性小体/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/07/12/Literature/炎性小体/" itemprop="url">炎性小体</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-07-12T12:00:00+08:00">
                2019-07-12
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/文献笔记/" itemprop="url" rel="index">
                    <span itemprop="name">文献笔记</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  3,213
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  12
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="概念">概念</h2>
<p>胚系编码的一一些受体，例如NLR，ALR，TRIM在外界刺激（通常是病原体）下，会形成一个更大分子量的复合物，也就是炎性小体，炎性小体会通过ASC来招募促炎性的蛋白，即caspase-1。</p>
<p>炎性小体的大致结构如下所示<a href="#fn1" class="footnoteRef" id="fnref1"><sup>1</sup></a>:</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190712153128.png">

</div>
<p>炎性小体的核心结构进而会招募并寡聚化(oligomerize)半胱氨酸蛋白酶caspase-1，其中caspase-1是以丝状的形式存在的，如上图所示，这种丝状的结构会促进caspase-1自身的活化。</p>
<p>ASC蛋白位于中间，它的N端是PYD，C末端是CARD，其中CARD参与caspase-1的相互作用。caspase-1会切除炎症细胞因子IL-1beta与IL-18的前体，将它们释放到细胞外。</p>
<p>炎性小体的活化会诱导细胞的裂解死亡，这种形式称为<strong>焦亡(pyroptosis)</strong>，这是细胞对抗病原体的一种免疫机制。</p>
<p>在天然免疫中，炎性小体是一个重要的组成成分，书中对炎性小体的定义如下所示<a href="#fn2" class="footnoteRef" id="fnref2"><sup>2</sup></a>：</p>
<blockquote>
<p>By definition, inﬂammasomes are scaffolds for activation of the inﬂammatory cysteine-dependent aspartate-specific protease caspase-1.</p>
</blockquote>
<p>也就是说，炎性小体是一类脚手架蛋白(scaffold)，其功能是参与光胱氨酸依赖的天冬氨酸特异性蛋白酶caspase-1的活化，这种酶活化后参与炎性细胞因子，IL-1beta，IL-18的成熟与分泌， 以及参与焦亡，与焦亡相关的另外一个酶是caspase-11。</p>
<p>pyroptosis是宿主细胞的一种防御机制，它能裂解那些被病原体感染的细胞，从而将病原体暴露出来，与免疫细胞接触。pyroptosis相关的细胞裂解还会释放DAMP，例如IL-1瞢a和HMGB1。</p>
<h3 id="prrs作为炎性小体的脚手架蛋白">PRRs作为炎性小体的脚手架蛋白</h3>
<p>常见的炎性小体结构如下所示<a href="#fn3" class="footnoteRef" id="fnref3"><sup>3</sup></a>：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190712171054.png">

</div>
<p>NLRP1， NLRP2，NLRP3，NLRP6，NLRC4以及NLRP12它们都含有一个NBD，NBD也被称为NACHT。还含有一个LRR，剩下的要么含有CARD，要么含有PYD。</p>
<p>AIM2与IFI16是PYHIN家族成员，它们都含有PYD与HIN200结构域，这两个结构域参与配体结合<a href="#fn4" class="footnoteRef" id="fnref4"><sup>4</sup></a>。</p>
<p>其它文献关于它们的结构总结如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190715105613.png">

</div>
<p>其中的缩写如下所示：</p>
<ol style="list-style-type: decimal">
<li>PYD: Pyrin domain</li>
<li>NLR: nucleotide-binding domain and leucine-rich repeat containing receptors</li>
<li>NACHT：NAIP-CIITA-HET-E domain</li>
<li>NAIP: neuronal apoptosis inhibitor protein</li>
<li>LRR: leucine-rich repeat</li>
<li>NOD: nucleotide-binding oligomerization domain</li>
<li>FIND:‘Function to find’ domain</li>
<li>CARD: Caspase recruitment domain</li>
<li>BIR: Baculovirus inhibitor repeat(Baculovirus是杆状病毒)</li>
<li>NLRP: NLR family, pyrin domain containing</li>
<li>NLRC: containing a caspase recruitment domain</li>
<li>NLRB: containing a Baculovirus inhibitor repeat (BIR) domain</li>
<li>Hin200: Hematopoietic interferon-inducible nuclear protein family, 200 amino acid repeat</li>
<li>CC: coiled-coil</li>
</ol>
<p>NLRs（这个s指的是P，C，B，也就是NLRP，NLRB，NLRC这3种炎性小体）这种结构的炎性小体的结构前文已经提及，它含有NACHT/NBD，LRR，这两个组件(NACHT与LRR）通常位于中央。多数的NLRs型炎性小体在氨基端还有BIR，PYD,CARD这些结构。</p>
<p>NLR家族一共有22个人类炎性小体，有34个鼠源炎性小体。</p>
<h2 id="炎性小体功能">炎性小体功能</h2>
<p>哺乳动物的NLRs有几个阐明功能了，其余的功能还不清楚。其中研究比较透彻的是NOD1和NOD2(nucleotide-binding oligomerization domain containing proteins 1/2)，他们能促进RIPK2与CARD9依赖的NF-kappaB与AP1靶基因的活化。MHC II在抗原提呈中也需要NLR蛋白CIITA的参与。</p>
<p>另一个NLRs亚家族，也就是NLRP1，NLRP3，NLRC4和NAIP通过炎性小体信号转导参与免疫应答。</p>
<p>信号转导诱导PRR的聚集与招募，促进procaspase-1丝状物的成核，随后procaspase-1会经历邻近诱导的自我活化(proximity-induced autoactivation)。</p>
<h2 id="相关细胞因子">相关细胞因子</h2>
<p>IL-1beta与IL-18的分泌与其它的细胞因子不同，proIL-1beta和proIL-18最先是以非活性的形式（前体）分泌到细胞质中，然后再经caspase-1的切割，形成生物活性形式。</p>
<h2 id="nlrp3">NLRP3</h2>
<p>NLRP3能对大量的激活剂产生应答，它需要NF-kappaB信号的诱导才能活化。NF-kappaB信号是第一信号 （signal 1或priming）。例如NF-kappaB调控物A20/TNFAIP3缺陷的小鼠就无法出现 NLRP3的活化。</p>
<p>signla 2：细菌，真菌的一些成分会诱导NLRP3的活化，除了经典的刺激（细菌成分）诱导 NLRP3炎性小体外，还有一些其它的蛋白能诱导NLRP3的活化，这些属于NLRP3的非经典活化内容，例如人类的caspase-11或它的鼠源直系同源蛋白 caspase-4和caspase-5参与细胞质LPS诱导的NLRP3炎性小体的活化。在这些非经典信号通路中，caspase-11诱导的pyroptosis并不依赖于NLRP3炎性小体 ，但是proIL-1beta与por-IL-18的切割却要通过NLRP3来实现 。在观其NLRP3活化过程中，K+是一种重要的诱导物。</p>
<p>非经典NLRP3炎性小体信号转导通常在格兰氏阴性菌的识别过程中有着重要作用。</p>
<p>pyroptosis的一个关键事件就是Gasdermin D的切割，它的切割与LPS诱导的caspase-11和caspase-1有关。</p>
<p>线粒体膜的破坏，以及线粒体DNA的氧化是NLRP3活化的一个因素。</p>
<p>线粒体异常有时候伴随着离子流的异常，这种行为也会控制NLRP3的活化。心磷脂(cardiolipin)的释放，氧化的线粒体DNA与线粒体膜的破坏都是NLRP3活化的第二信使。最近发现的Nek7是NLRP3活化的一个关键蛋白，它控制K+的流入来影响NLRP3的组装。</p>
<h2 id="nlrp1">NLRP1</h2>
<p>NLRP1是第1个发现的炎性小体，它通常FIIND结构域进行自我切割，FIIND位于CARD与LRR中间。人类有1个NLRP1基因，小鼠有3个，分别是Nlrp1a，Nlrp1b与Nlrp1c。Nlrp1b在Bacillus anthracis的LeTx(lethal toxin)诱导下进行组装。ASC对于Nlrp1b依赖的IL-1beta和IL-18分泌来说并非是必不可少的，只是ASC能够增强这两种细胞因子的分泌。这表明，proaspase-1招募到Nlrp1b平台上后，会诱导caspase-1构象的改变，诱导其活化，而ASC依赖的caspase-1自我切割则会锁定这种活化构象。</p>
<p>炎性小体活化的经典与非经典通路：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190713103622.png">

</div>
<h2 id="nlrc4">NLRC4</h2>
<p>NLRC4与其它炎性小体的结构如下所示<a href="#fn5" class="footnoteRef" id="fnref5"><sup>5</sup></a>：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190713104104.png">

</div>
<p>上图列出了NLRC4活化的上游机制，NLRC4在氨基末端有一个CARD，在没有ASC的前提下，NLRC4通过CARD与procaspase-1相互作用。一些微生物能活化NLRC4的活化，例如Salmonella enterica serovar Typhimurium， Legionella pneumophila，Pseudomonas auruginosa，Shigella ﬂ exneri， Listeria monocytogenes），这些细菌的毒力因子都是依赖于鞭毛蛋白(flagellin)介导的运行，会向宿主细胞传递T3SS和T4SS。NLRC4不直接检测这些毒力因子，而是NAIP检测到这些成分后，再作用于NLRC4。人类的全长NAIP与小鼠的Naip5，Naip6是鞭毛蛋白的受体。人类短的NAIP与小鼠的Nip1能识别T3SS的针状蛋白(needle protein)，但Naip2则能与T3SS杆状蛋白(rod protein)结合。S. Typhimurium能诱导NLRC4在Ser533位点的磷酸化，进而活化NLRC4。</p>
<p>在Naip5缺陷的巨噬中，falgellin依赖的NLRC4磷酸化并不依赖地Naip5。这说明，Nlrc4的活化机制分两步，先是在Ser533位点磷酸化，随后，Naip5再诱导NLRC4的活化。NLRC4与天然免疫有关，也与自身免疫性疾病有关。</p>
<h2 id="aim2">AIM2</h2>
<p>AIM2全称是absent in melanoma2，这是一个HIN200家族/AIM2家族的一个成员(ALR)。当细菌或病毒来源的dsDNA与Hin200结构域结合时，就会诱发AIM2炎性小体的组装。AIM2会诱导髓系细胞(myeloid cells)产生IL-1beta和IL-18，诱导细胞的pyroptosis。AIM2在控制一些病原体感染方面有着重要作用，例如 Francisella tularensis,Listeria monocytogenes,mouse cytomegalovirus,vaccinia virus。</p>
<h2 id="pyrin">Pyrin</h2>
<p>人类MEFV基因编码Pyrin/TRIM20蛋白，这是一个TRIM家族的成员。Pyrin主要表达于髓系细胞(myeloid cell)，在单核细胞向巨噬分化过程中，Pyrin的表达会降低。RhoA-inactivating bacterial toxins会诱导Pyrin组装成炎性小体，激活caspase-1，参与IL-1beta的分泌。</p>
<h2 id="炎性小体的组装与信号转导">炎性小体的组装与信号转导</h2>
<p>ASC依赖的炎性小体的组装过程：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190713152009.png">

</div>
<p>上游的NLR或ALR识别其配体后，会通过PYD或CARD聚集，聚集的NLR或ALR会形成一个平台，通过PYD-PYD或CARD-CARD的相互作用来招募ASC，形成一个丝状的核心。其中ASC(CARD)位于外层，它形成另外一个平台，通过CARD-CARD的相互作用来招募caspase-1，高度聚合化折caspase-1会诱导自身的切割，产生活性炎性小体。</p>
<h2 id="listeria-monocytogenes与炎性小体">Listeria monocytogenes与炎性小体</h2>
<p>Lm能激活不同的炎性小体。</p>
<h3 id="nlrp3与lm">NLRP3与Lm</h3>
<p>Lm是第一个发现的能激活NLRP3的病原体。Mariathasan发现，细胞质中的Lm能激活NLRP3炎性小体，但是被囊泡包裹的Lm无法激活炎性小体，这说明被囊泡包裹这一过程对于炎性小体的活化非常重要。Kannengati观察到，Lm的总RNA能刺激NLRP3的活化，这进一步说明，LM能通过各种机制来刺激NLRP3。</p>
<p>胞外的LLO形成的孔洞会诱导K+外流，导入NLRP3炎性小体的活化。除此之外，Lm的RNA，iap基因编码的p60也能激活NLRP3。p60的N端LysM与SH3结构域刺激IL-1beta和IL-18的释放，这些活动独立于细胞的焦亡形式死亡。使用DPI抑制ROS能降低IL-1beta的分泌，但IL-18的分泌不受影响。这些实验是在小鼠细胞上做的。</p>
<p>在人类PBMC实验方面，使用Lm感染PBMC，细胞会经历LLO诱导的NLRP3依赖的炎性小体活化，这种炎性小体一的活化依赖于吞噬泡的西化与cathepsin B的释放，这些现象与小鼠的细胞有所不同。</p>
<p>Lm诱导的快速NRLP3的活化依赖于TLR信号转导，因为MyD88缺陷的细胞无法活化炎性小体。这些应答依赖于MyD88的下游信号分子IRAK1，因此IRAK1缺陷的细胞无法激活炎性小体，以及无法分泌IL-1beta和IL-18。但是，在致敏状态(priming)，IRAK1对于炎性小体的活化又不是必需的。另外，延长感染时间会出现Lm诱导的非NLRP3依赖的炎性小体活化。总之就是，LM在早期感染中激活NLRP3。</p>
<h3 id="nlrc4与lm">NLRC4与Lm</h3>
<p>NRLC4识别鞭毛蛋白(flagellin)与T3SS(Type III secretion system)。</p>
<p>Lm是格兰阳性菌，不含T3SS成分，它的鞭毛蛋白是激活NLRC4的成分。但Lm鞭毛蛋白似乎并非只激活NRLC4，因为使用鞭毛蛋白缺陷菌ΔflaA来感染，也能产生caspase-1的活化以及形成IL-1beta。</p>
<h3 id="aim2与lm">AIM2与Lm</h3>
<p>AIM2通常HIN200结构域来识别dsDNA。前面提到，在NLRP3缺失的情况下，鞭毛蛋白缺陷菌ΔflaA也能诱导caspase-1的活化。但在AIM2缺陷的细胞中，caspase-1的活化则会消失。</p>
<p>Lm的DNA激活AIM2。</p>
<h3 id="其它炎性小体">其它炎性小体</h3>
<p>NLRC5与NLRP3结合参与NLRP3的活化。NLRC5敲除的小鼠感染Lm后，载菌是不是更多，机制不明。NLRP6敲除的小鼠载菌量低，NLRPP6在LM感染方面的作用，不依赖于炎性小体的信号转导。Lm在刺激炎性小体方面的作用，体外数据很好，但是体内数据研究机制不明，其中AIM2有可能与体内相关炎性小体最密切的一个炎性小体。</p>
<p>在体外实验中，虽然LM能激活很多炎性小体，但是在体内感染方面，Lm会避免过度激活炎性小体，从而避免自身被清除，它已经进化出了逃避炎性小体监测的机制。</p>
<p>Lm会通过调控自身LLO，鞭毛蛋白(flagellin)来逃避宿主细胞的监测。</p>
<p>Lm的感染会诱导caspase-11的表达，但是敲除caspase-11后，caspase-1的功能不受影响，这说明caspase-11对于Lm的感染来说是可有可无的。</p>
<p>ASC敲除的异噬细胞无法激活caspase-1，不能分泌IL-1beta和IL-18.</p>
<p>Lm激活与逃避炎性小体监测的机制：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190713165831.png">

</div>
<p>Fig1：WT LM能最小程度地激活caspase-1，维持Lm在细胞内的存活，最终形成感染。相比之下，那些能激活炎性小体的Lm会诱导强烈的caspase-1以及pyroptosis，释放IL-1beta和IL-18，最终导致Lm的清除，增强活化巨噬细胞的招募，中性粒细胞的流入。</p>
<p>炎性小体的活化能清除Lm。</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190713170002.png">

</div>
<p>炎性小体相互关的炎症会损伤宿主针对Lm的细胞免疫。</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190713170251.png">

</div>
<h2 id="炎性小体研究思路">炎性小体研究思路</h2>
<h2 id="参考资料">参考资料</h2>
<div class="footnotes">
<hr>
<ol>
<li id="fn1"><p>Janeway immunobiology. 9th<a href="#fnref1">↩</a></p></li>
<li id="fn2"><p>Backert S . Inflammasome Signaling and Bacterial Infections[M]. Springer International Publishing, 2016.<a href="#fnref2">↩</a></p></li>
<li id="fn3"><p>Backert S . Inflammasome Signaling and Bacterial Infections[M]. Springer International Publishing, 2016.<a href="#fnref3">↩</a></p></li>
<li id="fn4"><p>Inflammasomes in health and disease.Nature. 2012 Jan 18;481(7381):278-86. doi: 10.1038/nature10759.<a href="#fnref4">↩</a></p></li>
<li id="fn5"><p>Lamkanfi, M. and Vishva M. Dixit (2014). “Mechanisms and Functions of Inflammasomes.” Cell 157(5): 1013-1022.<a href="#fnref5">↩</a></p></li>
</ol>
</div>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2019/07/11/Literature/支架蛋白与脚手架蛋白/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/07/11/Literature/支架蛋白与脚手架蛋白/" itemprop="url">支架蛋白与脚手架蛋白</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-07-11T12:00:00+08:00">
                2019-07-11
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/文献笔记/" itemprop="url" rel="index">
                    <span itemprop="name">文献笔记</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  812
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  3
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>信号转导通路（Signaling pathway）本身就是一种机制，或者说是一种过程，在这个过程中，一个信号到达细胞后（细胞表面，或者是细胞内部），这个信号就会触发一系列有序的事件（信号转导通路），最终导致细胞内出现一些变化。这些变化通常伴随着基因的表达或者是某些物质浓度的变化，这些事件能够使细胞对某种信号作出反应，并根据当前环境调整细胞自身的代谢活动。</p>
<p>信号转导通路始于某个信号本身，这个信号分子与细胞表面的信号分子受体结合，受体通过大量的不同的蛋白来将信号传递到细胞内部。从本质上来说，衔接蛋白（adaptor protein）与脚手架蛋白（Scaffold protein）都位于前述的这些蛋白集合中，它们负责将信号从受体进一步传递到细胞内部。</p>
<p>衔接蛋白与脚手架蛋白的区别就在于它们的功能和结构上的不同。脚手架蛋白的作用是通过“吸引”大量的，信号转导通路所需的不同蛋白来协调信号转导，这从一点我们可以知道，脚手架蛋白本身比较大。它们本质上是将信号通路中的执行者锭定到一个蛋白复合物中，并将它们定位到特定的位置，从而使信号转导更加有效，脚手架蛋白是发挥一个平台作用，将很多蛋白招募到一起，让它们之间发生相互作用。由于有这种作用，脚手架蛋白还能通过正反馈与负反馈信号来调控信号转导通路，脚手架蛋白还能将特定的蛋白（例如当前活跃的信号通路）从其它不需要的竞争性蛋白复合物中的分离出来。</p>
<p>衔接蛋白（有的译为接头蛋白），即adaptor protein，这种蛋白的分子量相对比较小，它们有助于形成蛋白复合物，但是衔接蛋白通常只与两类蛋白质结合。衔接蛋白通过特定的结构域（通常是SH2和SH3）来与其它蛋白结合，这两个结构域能识别靶蛋白的特定氨基酸序列。衔接蛋白本身可能没有酶活性，但它们会招募那些有功能的蛋白来发挥作用，例如MyD88，Grb2，SHC1等。</p>
<p>我们以脚手架蛋白MEKK1为例说明一下，此蛋白存在于MAPK通路中，此通路会将信号传递到细胞核，调控与细胞周期和细胞分化相关的特定转录因子的表达。而GRB2（生长因子受体结合蛋白2，Growthfactor receptor=bound protein 2）是一种衔接蛋白，它通过SH2结构域与EGF受体结合，并通过SH3结构域吸引此信号通路中下一个蛋白（Sos蛋白）。</p>
<p>MAPK信号通路图片如下所示：</p>
<p>[](https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190712163909.jpg</p>
<p>参考资料</p>
<ol style="list-style-type: decimal">
<li>https://www.biotechnologyforums.com/thread-3331.html</li>
<li>https://cshperspectives.cshlp.org/content/4/11/a011254.full%22</li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2019/07/08/BioItem/iTRAQ定量蛋白质组(上)/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/07/08/BioItem/iTRAQ定量蛋白质组(上)/" itemprop="url">iTRAQ定量蛋白质组(上)</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-07-08T12:00:00+08:00">
                2019-07-08
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/生信实战项目/" itemprop="url" rel="index">
                    <span itemprop="name">生信实战项目</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  6,685
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  24
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="前言">前言</h2>
<p>这篇笔记是腾讯课堂上的蛋白质组数据分析教程的笔记，教程的全称是<a href="https://ke.qq.com/course/400449" target="_blank" rel="external">《iTRAQ定量蛋白质组》</a>教程中涉及到的蛋白质谱使用的方法是iTRAQ，分析的物种是玉米，虽然与我的方向不一致，但是原理与数据分析的思路都是相通的，这一部分仅是背景知识。</p>
<p>这个视频教程笔记分2篇，上篇主要是蛋白质谱背景知识介绍，以及文献中的常规思路分析。</p>
<p>下篇主要是进行案例训练。</p>
<h2 id="蛋白质组知识背景">蛋白质组知识背景</h2>
<p>蛋白质组(proteome)：由一个细胞、一个组织或一个机体的基因组所表达的全部相应的蛋白质，是一个整体的概念。</p>
<p>蛋白质组学(proteomics)：以蛋白质组为研究对象，从蛋白质整体水平来认识重合活动规律的科学，是后基因组计划的重要组成部分。</p>
<p>蛋白质组学本质上指的是在大规模水平上研究蛋白质的特征，包括蛋白质的表达水平、翻译后的修饰、蛋白质与蛋白质相互作用等，由此获得蛋白质水平上的关于疾病机理、细胞代谢等过程的整体而全面的认识。</p>
<h3 id="蛋白质组学分类">蛋白质组学分类</h3>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190709172614.png">

</div>
<p>常用的是非标Label Free，以及标记的iTRAQ分板技术。</p>
<h3 id="定量蛋白组学">定量蛋白组学</h3>
<p>定量蛋白组学：研究不同条件下蛋白表达水平的变化（上下调情况）。</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190709172748.png">

</div>
<h2 id="itraq知识背景">iTRAQ知识背景</h2>
<p><strong>iTRAQ</strong>的全称是<strong>Isobaric tag for relative and absolute quantitation</strong>，翻译为中文就是<strong>同重元素标记的相对与绝对定量技术</strong>。这是由AB SCIEX公司研发的一种体外同重同位素标记的相对与绝对定量技术。该技术利用同位素试剂可同时标记8个多肽样品，标记的多肽样品等量混匀后，经液相色谱分离及串联质谱（MS/MS）分析，可得到各肽段的一、二级质谱信息。</p>
<p>在一级质谱中，不同样品来源的同一肽段表现出相同的质荷比；</p>
<p>在二级质谱中，化学键断裂释放出iTRAQ报告离子，在质谱低质量区产生了8个报告离子峰，其强度反应了该肽段在不同样品中的相对表达量信息，另外二级质谱中的肽段碎片离子峰质荷比反应了该肽段的序列信息；这些质谱原始数据经过数据库检索，可得到蛋白质的定性和相对定量信息。</p>
<p>iTRAQ技术在微生物抗协迫机制和动植物发育分化机理研究及医学生物标记物筛选领域都有广泛应用。</p>
<p><strong>iTRAQ</strong>：采用4种或8种同位素标签，通过特异性标记多肽的氨基基团，进行串联质谱分析从而比较不同样本中蛋白质的相对含量，其特点是：</p>
<ul>
<li><p>蛋白通量高，覆盖度高；</p></li>
<li><p>定量准确，可信度高；</p></li>
<li><p>分离能力强、分析范围广，定性结果可靠；</p></li>
<li><p>自动化程度高、分析时间快，分离效果好。</p></li>
</ul>
<h2 id="定量蛋白质组原理">定量蛋白质组原理</h2>
<h3 id="itraq试剂">iTRAQ试剂</h3>
<ul>
<li>iTRAQ试剂是可与氨基酸末端及赖氨酸侧链连接的胺标记的同位素元素；</li>
<li>iTRAQ试剂由三部分组成：报告基团、质量平衡基团和肽反应标记试剂基团；</li>
<li>报告基因：常见4标或8标，可同时标记4组或8组样品，报告基团有8种分子量，范围从113到121（无120）；</li>
<li>平衡基因：保证iTRAQ标记的同一肽段的质荷比相同，平衡基团也8有种不同的分子量，与不同的报告基团搭配，能保证被标记的不同来源的同一肽段在一级质谱中具有相同的质荷比，就是下图中右侧的部分，在上图，也就是a图中，它们的荷质比都是145.10，在下图，也就是b图中，荷质比都是305.10；</li>
<li>肽反应标记基团：可与肽段N端及辣氨酸侧链发生共价连接，从而标记上肽段。</li>
</ul>
<p>这几个试剂的结构如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190709185729.png">

</div>
<p>（图片来源于：Aggarwal S., Yadav A.K. (2016) Dissecting the iTRAQ Data Analysis. In: Jung K. (eds) Statistical Analysis in Proteomics. Methods in Molecular Biology, vol 1362. Humana Press, New York, NY,277）</p>
<h3 id="itraq的实验流程原理">iTRAQ的实验流程原理</h3>
<p>在质谱峰图中，虽然不同样本带有不同的同位素标签，但是经过质量平衡基因的平衡，任何一种试剂标记不同样本中的同一蛋白多肽表现为相同的质荷比，从而形成单一的峰。</p>
<p>在串联质谱结果中，经过激光通量轰击肽段，iTRAQ试剂的三部分之间的键断裂，平衡基因断裂，平衡基团丢失，不同同位素标签的同一多肽的离子信号表现为不同质荷比的峰，因此可根据波峰的高度和面积比较同一蛋白不同处理的定量信息，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190709190427.png">

</div>
<p>（图片出处为：Aggarwal S., Yadav A.K. (2016) Dissecting the iTRAQ Data Analysis. In: Jung K. (eds) Statistical Analysis in Proteomics. Methods in Molecular Biology, vol 1362. Humana Press, New York, NY，P278）</p>
<p>一级质谱：</p>
<p>二级质谱：</p>
<h4 id="常规实验流程">常规实验流程</h4>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190709184551.jpg">

</div>
<h4 id="实验流程如下所示">实验流程如下所示：</h4>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190709185226.png">

</div>
<p>第一步：蛋白酶解样本，也就是将蛋白样本酶解为肽段；</p>
<p>第二步：使用iTRAQ同位素标记，也就是使用不同的iTRAQ标签来标记不同的肽段样本；</p>
<p>第三步：SCX预分级，使用强阳离子交换SCX（HPLC）将肽段分为多个组分；</p>
<p>第四步：使用LC-MS对每个组分进行质谱检测。</p>
<h4 id="质谱仪的组成部分">质谱仪的组成部分</h4>
<p>蛋白质谱的核心就质谱，原理就是样本在特定条件下转变为高速运动的离子，根据离子质荷比的不同在静电场和磁场作用下进行分离，再用特定检测器记录不同质荷比的各离子的相对强度并形成质谱图。</p>
<h5 id="质谱仪">质谱仪</h5>
<p><strong>质谱仪</strong>：在真空状态下分析离子的质荷比m/z，质谱仪主要是由离子源、质量分析器和离子检测器组成，iTRAQ技术中常用LC-MS/MS，液相色谱串联质谱。</p>
<ul>
<li><p>离子源：将蛋白或多肽变成气态的带电离子，常用的有2类：①电喷雾电泳ESI；②基质辅助激光解吸电离MALDI（脉冲方式使用样本离子化0；</p></li>
<li><p>质量分析器：将离子源形成的离子按质荷比大小分开：常见有的5类：①四级杆(Quadrupole)；②离子阱(Ion trap)；③飞行时间(TOF)；④傅里叶(FTICR)；⑤轨道阱(Qrbitrap)。</p></li>
</ul>
<p>质量分析器的参数</p>
<p>质量分析器的质量范围是指测定质荷比范围，它决定了能检测到的离子范围，例如ESI离子源可产生许多质荷比大于3000的离子，但是如果质量分析器的上限达不到3000，则就无法检测大于3000的离子。</p>
<p>分辨率：观测到的质谱峰的质荷比/半峰高处的峰宽(FWHM)。</p>
<h4 id="不同类型质量分析器的比较">不同类型质量分析器的比较</h4>
<p>不同质量分析器有不同的分辨率，其中傅里叶&gt;轨道阱&gt;时间飞行&gt;离子阱&gt;四级杆，具体的参数如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190717184549.png">

</div>
<p>市场上不同型号质谱仪的比较：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190717184735.png">

</div>
<p>其中在使用iTRAQ分析时，比较常用的是Thermo的Q-Exactive与Q-Exactive HF。</p>
<ul>
<li><p>离子检测器：①直接检测器；②电子倍增器；③闪烁检测器。</p></li>
<li><p>液相色谱LC：利用物质在流动相和固定相中的分配系数差异，进行分离检测。</p></li>
<li><p>质谱MS：把不同质荷比的离子分开排列成谱。</p></li>
</ul>
<h2 id="实验方案设计">实验方案设计</h2>
<p>教学视频中的案例是植物方向，其实原理跟动物方向一样的，以下的都是植物蛋白质谱的实验设计。</p>
<h3 id="方案设计-生物学重复">方案设计-生物学重复</h3>
<ol style="list-style-type: decimal">
<li>至少设置3个以上的生物学重复；</li>
<li>为了增加实验结果的可靠性，可通过增加质谱的技术重复上机次数；</li>
<li>严谨的实验通常进行3次生物学重复和3次技术重复，也就是一共9批MS数据；</li>
<li>出于经费考虑，有的文献也只进行2-3次技术重复（在动物实验方面，技术重复就是同一个样本上3针质谱即可）。</li>
</ol>
<h3 id="方案设计-不同组样本的标记选择和上机组合">方案设计-不同组样本的标记选择和上机组合</h3>
<h4 id="两组样品">两组样品</h4>
<p>常见的组合包括2组，3组，4组，5组，6组样本，现在以植物干旱无罪推定研究为例说明一下。</p>
<p>假设我们有2组样本，对照组这里用CK表示，它表示正常浇水；实验组使用Treatment不胜感激，它表示不浇水3天，现在有2个方案：</p>
<p>第一个方案：每组2个生物学重复，1个3标；</p>
<p>第二个方案：第组3个生物学重复，1个6标，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190717185946.png">

</div>
<h4 id="三组样本">三组样本</h4>
<p>现在将实验扩展一下，我们使用3组：</p>
<p>对照组：CK，正常浇水；</p>
<p>干预组不浇水，包括2组：</p>
<p>不浇水3天：T1</p>
<p>不浇水6天：T2</p>
<p>第一个方案：每组两个生物学重复，1个6标；</p>
<p>第二个方案：每组3个生物学重复，3个4标或1个9标，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190717190254.png">

</div>
<h4 id="四组样本">四组样本</h4>
<p>对照组：CK，正常浇水</p>
<p>处理组：Treatment</p>
<p>不浇水3天：T1</p>
<p>不浇水6天：T2</p>
<p>不浇水9天：T3</p>
<p>方案一：每组2个生物学重复，1个8标；</p>
<p>方案二：每组3个生物学重复，3个4组，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190717190615.png">

</div>
<h4 id="五组样本">五组样本</h4>
<p>对照组：CK，正常浇水</p>
<p>处理组：Treatment</p>
<p>不浇水1天：T1</p>
<p>不浇水2天：T2</p>
<p>不浇水3天：T3</p>
<p>不浇水4天：T4</p>
<p>方案一：每组3个生物学重复，3个5标；</p>
<p>方案二：每组3个生物学重复，3个6标，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190717190812.png">

</div>
<h4 id="六组样本">六组样本</h4>
<p>对照组：CK，正常浇水</p>
<p>处理组：</p>
<p>不浇水1天：T1</p>
<p>不浇水2天：T2</p>
<p>不浇水3天：T3</p>
<p>不浇水4天：T4</p>
<p>不浇水5天：T5，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190717190946.png">

</div>
<h3 id="实验方案小结">实验方案小结</h3>
<ul>
<li>需要比较的差异分组放在同一组标记中；</li>
<li>不同组织部位不要放在一组标记中检测；</li>
<li>生物学重复可分批上机，此时可不需要内参；</li>
<li>可将所有样本混合作为内参，分析时可通过内参间接找到有无变化的蛋白质。</li>
</ul>
<h1 id="蛋白数据分析流程">蛋白数据分析流程</h1>
<p>iTRAQ定量蛋白组数据分析流程如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190717191336.png">

</div>
<p>从质谱仪上拿到的数据是原始质谱数据，然后要将原始数据进行一个数据格式转换，数据转换后，要进行搜库来鉴定蛋白质，这一步是要看找到了多少个蛋白质，随后对找到的蛋白进行蛋白定量。</p>
<p>定量后就是各种分析，包括GO，KEGG，蛋白相互作用等。</p>
<h3 id="一搜库">[一]搜库</h3>
<p><code>搜库</code>是指通过实验得到的谱图与数据库中的理论谱图进行匹配，得到可能的肽段序列，从而鉴定蛋白质，进行搜库的操作就是将质谱仪得到的谱图输入到搜库软件，常用的搜库软件包括：</p>
<ul>
<li>ProteinPilot(AB SCIEX)</li>
<li>Proteome Discoverer(Thermo scientific)</li>
<li>Mascot（这个软件是上述2个软件的核心）</li>
</ul>
<p>数据的产生其实就是：<code>蛋白-&gt;肽段-&gt;谱图</code>；而数据分析就是这个过程的逆过程，即<code>谱图-&gt;肽段-&gt;蛋白</code>。</p>
<p>整个流程如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190717191954.png">

</div>
<h4 id="搜库的原理">搜库的原理</h4>
<p>搜库软件运行的主要步骤包括：</p>
<ol style="list-style-type: decimal">
<li>从数据库中选择分子量与输入值相等的肽段；</li>
<li>形成理论碎片，并进一步生成理论谱图；</li>
<li>将实验谱图与理论谱图进行匹配；</li>
<li>对匹配进行打分；</li>
<li>按打分进行排序，通过统计学分析，确定最佳的匹配结果并导出。</li>
</ol>
<p>流程示意图如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190717192309.png">

</div>
<h4 id="搜库数据库的选择">搜库数据库的选择</h4>
<p>数据库的选择是基于质谱数据的蛋白质鉴定策略中的重要一步，最终鉴定到的蛋白序列都来源于被选择的数据库。</p>
<ul>
<li>如果是已经测序的生物，直接选用该物种蛋白数据库(NCBI)，或同批样本转录组数据构建的蛋白库。</li>
<li>如果是非测序生物，则选择与被测样本最为相关的大类蛋白质组数据库；</li>
<li>NCBInr分类库，包括动物全库、植物全库、微生物全库、细菌全部库等。</li>
<li>SwissProt/UniProt分类库，动物全库、植物全库、微生物全库、细菌库等。</li>
</ul>
<h4 id="蛋白质谱鉴定的结果">蛋白质谱鉴定的结果</h4>
<p>定量蛋白质鉴定数目一般在几千左右，远少于转录组检测的表达的基因数目和参考基因组的基因数目，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190717192758.png">

</div>
<p>右上图是根据分析量来确定的蛋白数据，右下图是根据肽段来确定的鉴定的蛋白数目。蛋白鉴定的数目跟转录鉴定的基因不在一个数量级上，这是因为蛋白质谱在实验的通量，数据库，实验技术方面都有一定的局限。</p>
<h3 id="二蛋白质功能注释">[二]蛋白质功能注释</h3>
<p>通过搜库对蛋白质进行鉴定后，接着就是对这些搜到的蛋白进行功能注释，这有助于了解蛋白的功能，从而解析样本相关表型，常用于功能注释的数据库有：GO、COG、KEGG、NR、Pfam、Swiss-Prot，下图是一个玉米的项目，玉米的蛋白在各个数据库中的注释结果：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190717193450.png">

</div>
<h4 id="数据库介绍">数据库介绍</h4>
<h5 id="nr">NR</h5>
<p>全称是Non-redundant protein sequences，包含GenBank所有编码序列，以及PDB，swissprot，PIR，PRF数据库的所有编码序列的一个非冗余数据库，其数据库完整度高；这是一个氨基酸序列数据库。</p>
<h5 id="pfam">Pfam</h5>
<p>全称是Protein families database，通过蛋白序列的比对建立了每个家族的氨基酸序列的HMM统计模型，是最全面的蛋白结构域注释的分类系统；通过识别蛋白质的结构域序列，可以预测蛋白质的功能。</p>
<h5 id="swiss-prot">Swiss-Prot</h5>
<p>这是上EBI维护的数据库，主要收录人工注释的序列及其相关文献信息和经过计算机辅助分析的序列；注释结果包括对蛋白质功能、酶学特性、剪接异构体、相关疾病信息的注释等待，注释结果无冗余。</p>
<h5 id="cog">COG</h5>
<p>全称是Clusters of Orthologous Groups of proteins，这是一个蛋白质直系同源数据库。通过对菌类，藻类和真核生物等66个完整基因组的编码蛋白，根据系统进化关系构建而成。这对于预测单个蛋白的功能和整个基因组中蛋白质的功能具有重要的作用。</p>
<h5 id="go与kegg">GO与KEGG</h5>
<p>常见，不介绍。</p>
<h3 id="三定量">[三]定量</h3>
<h4 id="蛋白定量原理回顾">蛋白定量原理回顾</h4>
<p>先来了解一下iTRAQ蛋白质定量的原理，如下所示：</p>
<ul>
<li>iTRAQ试剂是等量的，因此不同同位素在标记同一多肽后在一级质谱检测中，分子量完全相同。</li>
<li>在一级质谱检测到前体离子后进行碰撞诱导解离，产物离子通过二级质谱进行分析。</li>
<li>在二级质谱中，报告基团、质量平衡基团和多肽反应基团之间的键断裂，质量平衡基团丢失，产生低质荷比(m/z)的报告离子。</li>
<li>由于二级质谱可分析相对分子质量相差为1的报告基团，不同报告基团离子强度的差异就代表了它所标记的多肽相对丰度。</li>
<li>多肽内的酰胺键断裂，形成一系列b离子和y离子，得到离子片段的质量数，通过搜库就可以鉴别出相应蛋白质。</li>
</ul>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190717195201.png">

</div>
<h4 id="蛋白定量分析工具">蛋白定量分析工具</h4>
<ul>
<li>常用的软件前面已经提了，包括：IQuant(BGI), ProteinPilot(AB SCIEX)、Proteome Discoverer(Thermo scientific)</li>
<li><a href="https://onlinelibrary.wiley.com/doi/full/10.1002/pmic.201300361" target="_blank" rel="external">IQuant</a>：整合了Mascot算法，采用机器学习算法自动对搜索结果进行重新打分，提高结果的鉴定率。</li>
</ul>
<p>核心的值有3个：</p>
<ol style="list-style-type: decimal">
<li>在谱图/肽段水平进行1%FDR的过滤(PSM-level PDF&lt;=0.01)，获得显性性鉴定的谱图和肽段列表。</li>
<li>基于<strong>简约原则</strong>(the parsimony principle)， 利用肽段进行蛋白组装，并生产一系列的蛋白组。</li>
<li>在蛋白质水平以FDR 1%再次进行过滤(Protein-level FDR&lt;=0.01)，以控制蛋白的假阳性。</li>
</ol>
<p>IQuant的工作流程为：</p>
<p><code>蛋白质过滤 --&gt; 报告基团标签纯度校正 --&gt; 定量值归一化 --&gt; 缺失值补全 --&gt; 蛋白定量值计算 --&gt; 统计检验</code>。</p>
<h3 id="四差异蛋白筛选">[四]差异蛋白筛选</h3>
<p>对蛋白进行定量后，需要对蛋白的差异进行筛选，筛选的内容包括3个，如下所示：</p>
<ul>
<li>根据实验设计来设置差异分析，例如<code>A_VS_B</code>；</li>
<li>显示差异蛋白选择的阈值，Fold Change &gt; 1.2或1.5和Q-value &lt; 0.05；</li>
<li>统计学方法：t-test或ANOVA。</li>
</ul>
<p>现在来看一个差异计算后的结果：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190717200544.png">

</div>
<p>第1列是蛋白名称；</p>
<p>第2列到第4列是3个生物学重复；</p>
<p>第5列与第6列是FC与pvalue。</p>
<h3 id="五富集分析">[五]富集分析</h3>
<p>富集分析常见的就是GO分析与KEGG分析，不介绍。</p>
<h3 id="六表达聚类和蛋白互作">[六]表达聚类和蛋白互作</h3>
<p>表达聚类分析的核心就是热图与聚类图，不介绍。</p>
<p>蛋白相互作用通常使用的数据库是STRING数据库，它能分析预测差异蛋白质之间的互作关系，这个数据库的主要信息如下</p>
<ul>
<li>STRING是一个搜索已知蛋白之间和预测蛋白之间相互作用系统的数据库，包括蛋白质直接物理的相互作用，也包括蛋白质之间间接功能相关性；</li>
<li>数据包括：实验数据、从PubMed摘要中挖掘结果，利用生物信息学方法预测的结果；</li>
<li>通过打分对不同方法得来的结果给予一定权重，得到综合打分，且可根据打分结果绘制蛋白相互作用网络图，它的网络图如下所示：</li>
</ul>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190717201930.png">

</div>
<h2 id="案例解析">案例解析</h2>
<p>先来看一篇文献，文献内容如下所示：</p>
<p>Liancheng Wu, Shunxi Wang, Lei Tian, Liuji Wu, Mingna Li, Jun Zhang, Pei Li, Weiqiang Zhang, Yanhui Chen Comparative proteomic analysis of the maize responses to early leaf senescence induced by preventing pollination,Journal of Proteomics,Volume 177,2018,Pages 75-87,ISSN 1874-3919.</p>
<h3 id="研究背景">研究背景</h3>
<p>玉米是一种一年生作物，叶片衰老的过早或过晚都可能会影响产量，在成熟后期，营养物质的再活化受到负面影响，导致幼叶的光合作用受损和系列能力下降，相反，过早的叶片衰老则阻碍了植物生长并降低其CO2的同化能力。叶片衰老是一个高度调控的过程，由几个称为衰老相关基因(SAGs)的基因介导，然后在蛋白质水平上仅鉴定了少数SAG。目前，使用蛋白质组学分析全体蛋白质波动比功能分析的转录组学更有效，因为蛋白质与功能更直接相关。本研究的目的是，研究玉米阻断授粉诱导叶片衰老过程中蛋白质的全局差异积累和代谢物质的变化。</p>
<h4 id="叶片衰老的生理特征">叶片衰老的生理特征</h4>
<p>叶片衰老通常与植物衰老以及开花和种子形成有关。叶色也与叶片衰老有关，是植物重合周期阶段的可见指标。叶片衰老时会出现一系列的生理过程，包括叶绿素分解、光合作用停止、蛋白质和核酸降解、分解代谢和营养物质的运输，以及细胞死亡反应，从而导致营养物质再循环到新发育的营养器官和生殖器官。</p>
<h4 id="分子机制研究进展">分子机制研究进展</h4>
<p>叶片衰老可以通过许多环境和内源信号来调节，包括年龄、发育信号和植物生长调节剂。植物激素与植物中的各种生物过程（包括叶片衰老）相关，如外源施用脱落酸(ABA)可促进叶片衰老，内源ABA水平在几种植物叶片衰老后增加。</p>
<p>水杨酸(SA)是另一种对叶片衰老正调控的植物激素，而生长素、细胞分裂素和赤霉素对叶片衰老有负调控作用。</p>
<p>糖代谢是与叶片衰老相关的另一因素，如糖类直接应用于拟南芥的叶细胞会导致早衰。</p>
<h4 id="表型分析糖">表型分析－糖</h4>
<p>实验材料：授粉(POL)和不授粉(NPNPOL)的玉米自交系Yu816。</p>
<p>发育时间：吐丝扣6天到21天(DAS)。</p>
<p>参数检测：叶片的可溶性糖含量和淀粉含量。</p>
<p>分析结果：</p>
<p>可溶性糖，6-18 DAS两种材料中均增加；21 DAS和POL中稍微下降，而NONPL的大量下降。</p>
<p>淀粉：趋势与可溶性糖类似，数据如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190717203730.png">

</div>
<h4 id="表型分析-叶片形态和叶绿素分析">表型分析-叶片形态和叶绿素分析</h4>
<ul>
<li><p>穗叶和上部的叶片；</p></li>
<li><p>两组材料在6-14 DAS时一样保持绿色。</p></li>
<li><p>NONPOL组，18 DAS时叶脉积累红色色素，尖端变黄且干燥；21 DAS时穗叶的三分之二变黄；27 DAS时叶片完全干燥。</p></li>
<li><p>POL组，仅在27 DAS时表现出轻微黄色。</p></li>
<li><p>叶绿素含量：</p></li>
<li><p>NONPOL组，穗叶尖端在6-27 DAS显著下降（相对中部和基部），而同时POL组只是稍微一些辞职。</p></li>
<li><p>相同的趋势也发生在穗叶的中部和基部。</p></li>
<li><p>在两组中Chl含量随着发育而下降，但是NONPOL组比POL组下降得更快，数据如下所示：</p></li>
</ul>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190717204222.png">

</div>
<h3 id="itaaq蛋白组实验设计">iTAAQ蛋白组实验设计</h3>
<p>样本数目：7组样本，8标，每个3个生物学重复</p>
<p>实验材料：玉米自交系Yu816</p>
<p>实验处理：授粉(POL)、不授粉(NONPOL)</p>
<p>取样部位：叶片</p>
<p>取样时间点：吐丝后6天(DAS)、14天、18天和21天</p>
<p>生物学重复：3个</p>
<p>方法与仪器：iTRAQ、LC-MS/MS(Thermo Fisher Scientific, Q-exactive)</p>
<p>流程如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190717204548.png">

</div>
<h3 id="蛋白质组整体分析">蛋白质组整体分析</h3>
<p>文章的附件中列出了蛋白质谱的一些数据，得到了959464个广谱，其中150650匹配上肽段谱图，通过Mascot软件匹配上已知多肽，且28605个匹配上唯一多肽。</p>
<p>鉴定了6941个蛋白，其中4371个唯一蛋白时至少有两个以上肽段匹配的，数据如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190717205151.png">

</div>
<h3 id="筛选差异蛋白分析">筛选差异蛋白分析</h3>
<ul>
<li>文献中使用了ANOVA来筛选差异蛋白(DAP)，其中阈值为：FC大于1.2或小于0.83(0.83其实就是1.2的倒数)，p值小于0.05。</li>
<li>POL组有700个显著差异积累的蛋白，NONPOL组有1832个；</li>
<li>其中261中仅在POL中显著积累，1393个只在NONPOL组中显著积累，而439个在两组均显著积累；</li>
<li>分析不同时间诱导的衰老：A1 VS B1， A2 vs B2， A3 VS B3；1443个显著差异积累，其中809个仅在NONPOL中显著差异积累，然后进一步分析在14 DAS、18 DAS和21 DAS的做好心理情况下，以及上下调情况；</li>
<li>通过比较本研究和之前文献报告的玉米自交系B73阻断授粉诱导衰老的转录组研究，发现两个数据集仅有154个重叠的基因，这说明在Yu816中有着相对不同的调控机制：</li>
</ul>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190717205707.png">

</div>
<h3 id="差异蛋白功能分析go和kegg分析">差异蛋白功能分析—GO和KEGG分析</h3>
<ul>
<li>对NONPOL组809个DAP进分别进行GO和KEGG分析，使用cytoscape、Cluego和Cluepedia软件绘制GO注释和KEGG网络图；</li>
<li>通过评分得到65条边连接的36个Term， 表明在鉴定的蛋白质相互作用组中相当多的富集(P&lt;0.05)；</li>
<li>显著富集的Term：光合作用、光合作用光系统II、生长素生物合成过程、JA代谢过程、器官衰老、络氨酸代谢、脯氨酸生物合成过程；</li>
<li>从亚细胞定位角度来看，显著宝座的蛋白主要定位于叶绿体、光合体系、过氧化酶体和核糖体，如下所示：</li>
</ul>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190717210255.png">

</div>
<h3 id="差异蛋白表达分析">差异蛋白表达分析</h3>
<p>表达分析的核心就是热图与聚类。</p>
<ul>
<li>在诱导叶片衰老过程中，大多数核糖体蛋白质丰度下降，包括50S核糖体蛋白L5-1(B6SST7)， 其在14 DAS时稍微下降了0.98倍，在18 DAS时下降了0.8倍，但在21 DAS下降到了0.6。</li>
<li>NONPOL组蛋白酶丰度增加，如光胱氨酸蛋白酶1(B6TGM9)在14 DAS增加1.09倍，在18 DAS时增加1.43位，21 DAS时增加到了2.89倍。</li>
<li>在差异积累的蛋白质中，29种与光合作用有关，并且大部分光合作用相关蛋白丰度减少，例如PSII反应中心蛋白H(P24993)在14 DAS时减少了1.00倍，在18 DAS时为0.72倍，在21 DAS时为0.46倍，如下所示：</li>
</ul>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190717210704.png">

</div>
<ul>
<li>糖代谢相关的蛋白质在NONPOL组中丰度增加，如淀粉合酶，和叶绿体/淀粉体蛋白（B6U167)在14 DAS时半圆了0.98倍，在18 DAS时增加了1.18倍，21 DAS的1.65倍；</li>
<li>参与ROS过程的蛋白质，抗氧化蛋白质在诱导叶片衰老过程中丰度降低了，例如铁氧还原蛋白(Q6JAD2)在14 DAs时减少了0.84位，在18 DAS时减少了0.76倍，在21 DAS时减少了0.55倍；</li>
<li>但是氧化蛋白质各类如脂氧合酶(Q8W0V2)在14 DAS时增加了0.87倍，在18 DAS时增加了1.78倍，在21 DAS时增加了2.26倍；</li>
<li>ABA响应蛋白(B6U8P6)在14 DAS时增加了0.88倍，在18 DAS时增加了1.32倍，在21 DAS时增加了1.5倍；但与生长素和赤霉素相关的蛋白质丰度降低，数据如下所示：</li>
</ul>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190717211150.png">

</div>
<p>文章最后使用WB进行验证，测序类文章中基本上都要有验证，这一部分略去不表。</p>
<p>文章到此就结束了，整个文献的数据分析思路如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190717211539.png">

</div>
<p>简化一下就是下图：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190717211604.png">

</div>
<h2 id="参考资料">参考资料</h2>
<ol style="list-style-type: decimal">
<li><a href="http://www.fitgene.com/fuwu/danbaizhizuxue/iTRAQ.html" target="_blank" rel="external">iTRAQ标记定量蛋白质组学.辉骏生物</a></li>
<li><a href="https://zhuanlan.zhihu.com/p/28203867" target="_blank" rel="external">iTRAQ(稳定同位素标记蛋白质组学技术)</a></li>
<li><a href="https://sciex.com/products/consumables/itraq-reagent" target="_blank" rel="external">iTRAQ® Reagents</a></li>
<li><a href="iTRAQ/TMT.MtoZ%20Biolabs%20Experit%20in%20Mass%20Spectrometry%20Analysis">iTRAQ/TMT.MtoZ Biolabs Experit in Mass Spectrometry Analysis</a></li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2019/07/02/Python/Python数据处理笔记02-Excel文件处理/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/07/02/Python/Python数据处理笔记02-Excel文件处理/" itemprop="url">Python数据分析02-Excel文件处理</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-07-02T12:00:00+08:00">
                2019-07-02
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Python/" itemprop="url" rel="index">
                    <span itemprop="name">Python</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  1,929
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  9
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="python处理excel的包">Python处理Excel的包</h2>
<p>在PYthon中处理Excel文件（扩展名为<code>.xls</code>和<code>.xlsx</code>的文件）的扩展包为<code>xlrd</code>和<code>xlwt</code>，这两个包对Excel中的日期型数据支持非常好。而在Anaconda Python中，已经含有了这两个包，不用额外安装。如果是最原始版本的Python，则需要下载这两个包。</p>
<p>书中关于这两个包的介绍并不多，因此一些参数只是告诉你了要么用，至于这个参数具体是做什么的，这个包的某些函数还有没有其它的参数，作者并没有多讲，因此可以检索一下<code>xlrd</code>和<code>xlwt</code>这两个包的文档。</p>
<p><a href="https://xlrd.readthedocs.io/en/latest/index.html" target="_blank" rel="external">xlrd文档</a></p>
<p><a href="https://xlwt.readthedocs.io/en/latest/" target="_blank" rel="external">xlwt文档</a></p>
<h2 id="练习数据下载">练习数据下载</h2>
<p>《Python数据分析基础》这本书中的<a href="https://github.com/cbrownley/foundations-for-analytics-with-python" target="_blank" rel="external">源数据和源代码</a>已经上传至Github上，自己可以下载下来。</p>
<p>下载后的Excel练习数据一共是3个，名称分别为：<code>sales_2013</code>，<code>sales_2014</code>和<code>sales_2015</code>。其中以<code>sales_2013</code>为例说明一下，这个文件中一共有3个Excel表格，名称分别为<code>january_2013</code>，<code>february_2013</code>和<code>march_2013</code>。</p>
<p>Excel与csv文件的不同之处在于，一个Excel文件（后文称为一个Exce工作薄）含有多个工作表（sheet）。通过工作簿的内省可以获取工作表的信息：</p>
<blockquote>
<p>Python的内省（Introspection）是一种自我检查行为。在编程过程中，自省能够获取对象的类型与属性。</p>
</blockquote>
<p>注：在这篇笔记中，工作簿是指一个Excel文件，而一个工作簿中则中含有多个工作表。</p>
<h2 id="获取工作表的信息">获取工作表的信息</h2>
<p>下面的代码命名为<code>1excel_introspect_workbook.py</code>，它的功能在于获取一个Excel文件中工作表的数量、名称和每个工作表中行与列的数量，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env python3</span></div><div class="line"><span class="keyword">import</span> sys</div><div class="line"><span class="keyword">from</span> xlrd <span class="keyword">import</span> open_workbook</div><div class="line"></div><div class="line">input_file = sys.argv[<span class="number">1</span>]</div><div class="line">workbook = open_workbook(input_file)</div><div class="line">print(<span class="string">'Number of worksheets:'</span>, workbook.nsheets)</div><div class="line"><span class="keyword">for</span> worksheet <span class="keyword">in</span> workbook.sheets():</div><div class="line">    print(<span class="string">"Worksheet name:"</span>, worksheet.name, <span class="string">'\tRows:'</span>, \</div><div class="line">          worksheet.nrows, <span class="string">'\tColumns:'</span>, worksheet.ncols)</div></pre></td></tr></table></figure>
<p>运行如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">C:\Users\<span class="number">20161111</span>\Desktop&gt;python <span class="number">1</span>excel_introspect_workbook.py sales_2013.xlsx</div><div class="line">Number of worksheets: <span class="number">3</span></div><div class="line">Worksheet name: january_2013    Rows: <span class="number">7</span>         Columns: <span class="number">5</span></div><div class="line">Worksheet name: february_2013   Rows: <span class="number">7</span>         Columns: <span class="number">5</span></div><div class="line">Worksheet name: march_2013      Rows: <span class="number">7</span>         Columns: <span class="number">5</span></div></pre></td></tr></table></figure>
<p>解释代码：</p>
<ol style="list-style-type: decimal">
<li>使用<code>open_workbook</code>函数打开了一个Excel主文件，并赋给了一个名为<code>workbook</code>的对象，这个对象中包含了工作簿中的所有可用的信息，可以查看一下，如下所示：</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>dir(workbook)</div><div class="line">[<span class="string">'__class__'</span>, <span class="string">'__delattr__'</span>, <span class="string">'__dict__'</span>, <span class="string">'__dir__'</span>, <span class="string">'__doc__'</span>, <span class="string">'__enter__'</span>, <span class="string">'__eq__'</span>, <span class="string">'__exit__'</span>, <span class="string">'__format__'</span>, <span class="string">'__ge__'</span>, <span class="string">'__getattribute__'</span>, <span class="string">'__gt__'</span>, <span class="string">'__hash__'</span>, <span class="string">'__init__'</span>, <span class="string">'__init_subclass__'</span>, <span class="string">'__le__'</span>, <span class="string">'__lt__'</span>, <span class="string">'__module__'</span>, <span class="string">'__ne__'</span>, <span class="string">'__new__'</span>, <span class="string">'__reduce__'</span>, <span class="string">'__reduce_ex__'</span>, <span class="string">'__repr__'</span>, <span class="string">'__setattr__'</span>, <span class="string">'__sizeof__'</span>, <span class="string">'__str__'</span>, <span class="string">'__subclasshook__'</span>, <span class="string">'__weakref__'</span>, <span class="string">'_all_sheets_count'</span>, <span class="string">'_all_sheets_map'</span>, <span class="string">'_externsheet_info'</span>, <span class="string">'_externsheet_type_b57'</span>, <span class="string">'_extnsht_count'</span>, <span class="string">'_extnsht_name_from_num'</span>, <span class="string">'_repr_these'</span>, <span class="string">'_resources_released'</span>, <span class="string">'_rich_text_runlist_map'</span>, <span class="string">'_sh_abs_posn'</span>, <span class="string">'_sharedstrings'</span>, <span class="string">'_sheet_list'</span>, <span class="string">'_sheet_names'</span>, <span class="string">'_sheet_num_from_name'</span>, <span class="string">'_sheet_visibility'</span>, <span class="string">'_sheethdr_count'</span>, <span class="string">'_supbook_addins_inx'</span>, <span class="string">'_supbook_count'</span>, <span class="string">'_supbook_locals_inx'</span>, <span class="string">'_supbook_types'</span>, <span class="string">'_xf_epilogue_done'</span>, <span class="string">'_xf_index_to_xl_type_map'</span>, <span class="string">'actualfmtcount'</span>, <span class="string">'addin_func_names'</span>, <span class="string">'biff2_8_load'</span>, <span class="string">'biff_version'</span>, <span class="string">'builtinfmtcount'</span>, <span class="string">'codepage'</span>, <span class="string">'colour_map'</span>, <span class="string">'countries'</span>, <span class="string">'datemode'</span>, <span class="string">'derive_encoding'</span>, <span class="string">'dump'</span>, <span class="string">'encoding'</span>, <span class="string">'fake_globals_get_sheet'</span>, <span class="string">'filestr'</span>, <span class="string">'font_list'</span>, <span class="string">'format_list'</span>, <span class="string">'format_map'</span>, <span class="string">'formatting_info'</span>, <span class="string">'get2bytes'</span>, <span class="string">'get_record_parts'</span>, <span class="string">'get_record_parts_conditional'</span>, <span class="string">'get_sheet'</span>, <span class="string">'get_sheets'</span>, <span class="string">'getbof'</span>, <span class="string">'handle_boundsheet'</span>, <span class="string">'handle_builtinfmtcount'</span>, <span class="string">'handle_codepage'</span>, <span class="string">'handle_country'</span>, <span class="string">'handle_datemode'</span>, <span class="string">'handle_externname'</span>, <span class="string">'handle_externsheet'</span>, <span class="string">'handle_filepass'</span>, <span class="string">'handle_name'</span>, <span class="string">'handle_obj'</span>, <span class="string">'handle_sheethdr'</span>, <span class="string">'handle_sheetsoffset'</span>, <span class="string">'handle_sst'</span>, <span class="string">'handle_supbook'</span>, <span class="string">'handle_writeaccess'</span>, <span class="string">'initialise_format_info'</span>, <span class="string">'load_time_stage_1'</span>, <span class="string">'load_time_stage_2'</span>, <span class="string">'logfile'</span>, <span class="string">'mem'</span>, <span class="string">'name_and_scope_map'</span>, <span class="string">'name_map'</span>, <span class="string">'name_obj_list'</span>, <span class="string">'names_epilogue'</span>, <span class="string">'nsheets'</span>, <span class="string">'on_demand'</span>, <span class="string">'palette_record'</span>, <span class="string">'parse_globals'</span>, <span class="string">'props'</span>, <span class="string">'ragged_rows'</span>, <span class="string">'raw_user_name'</span>, <span class="string">'read'</span>, <span class="string">'release_resources'</span>, <span class="string">'sheet_by_index'</span>, <span class="string">'sheet_by_name'</span>, <span class="string">'sheet_loaded'</span>, <span class="string">'sheet_names'</span>, <span class="string">'sheets'</span>, <span class="string">'style_name_map'</span>, <span class="string">'unload_sheet'</span>, <span class="string">'use_mmap'</span>, <span class="string">'user_name'</span>, <span class="string">'verbosity'</span>, <span class="string">'xf_list'</span>, <span class="string">'xfcount'</span>]</div></pre></td></tr></table></figure>
<ol start="2" style="list-style-type: decimal">
<li><code>name</code>属性则是获取每个sheet的名称，<code>nrow</code>与<code>ncol</code>则是获取每个sheet的行与列的数目</li>
</ol>
<h2 id="处理单个sheet">处理单个sheet</h2>
<h3 id="读写excel文件">读写Excel文件</h3>
<p>下面的代码功能在于读取一个excel文件，名称为<code>2excel_parsing_and_write.py</code>，代码如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env python3</span></div><div class="line"><span class="keyword">import</span> sys</div><div class="line"><span class="keyword">from</span> xlrd <span class="keyword">import</span> open_workbook</div><div class="line"><span class="keyword">from</span> xlwt <span class="keyword">import</span> Workbook</div><div class="line"></div><div class="line">input_file = sys.argv[<span class="number">1</span>]</div><div class="line">output_file = sys.argv[<span class="number">2</span>]</div><div class="line">output_workbook = Workbook()</div><div class="line"><span class="comment"># Create an Workbook object</span></div><div class="line"><span class="comment"># Workbook object is intended for output</span></div><div class="line"></div><div class="line">output_worksheet = output_workbook.add_sheet(<span class="string">'jan_2013_output'</span>)</div><div class="line"><span class="comment"># add_sheet function is adding an sheet</span></div><div class="line"><span class="keyword">with</span> open_workbook(input_file) <span class="keyword">as</span> workbook:</div><div class="line">    worksheet = workbook.sheet_by_name(<span class="string">'january_2013'</span>)</div><div class="line">    <span class="keyword">for</span> row_index <span class="keyword">in</span> range(worksheet.nrows):</div><div class="line">        <span class="keyword">for</span> column_index <span class="keyword">in</span> range(worksheet.ncols):</div><div class="line">            output_worksheet.write(row_index, column_index, \</div><div class="line">                                   worksheet.cell_value(row_index, column_index))</div><div class="line">            <span class="comment"># write function is use for writing data into output files</span></div><div class="line">output_workbook.save(output_file)</div></pre></td></tr></table></figure>
<p>运行结果如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">C:\Users\<span class="number">20161111</span>\Desktop&gt;python <span class="number">2</span>excel_parsing_and_write.py sales_2013.xlsx <span class="number">2</span>output.xls</div></pre></td></tr></table></figure>
<p>打开<code>2output.xls</code>后如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190630141416.png">

</div>
<p>其中第5列，也就是<code>Purchase Date</code>这一列是数字，而不是日期。Excel会将日期和时间保存为浮点数，这个浮点数代表从1900年1月0日起经过的日期数，加上一个24小时的小数部分。例如数值1表示1900年1月1日，因为从1900年1月0日是过去了1天，因此这一列中的数值代表日期，只是这是没有经过格式化的日期数据。</p>
<p><code>xlrd</code>能够格式化这种日期。</p>
<h2 id="格式化日期">格式化日期</h2>
<h3 id="常规方法">常规方法</h3>
<p>格式化日期的Python代码保存为<code>3excel_parsing_and_write_keep_dates.py</code>，代码内容如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env python3</span></div><div class="line"><span class="keyword">import</span> sys</div><div class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> date</div><div class="line"><span class="comment"># date function is used to format date data</span></div><div class="line"><span class="keyword">from</span> xlrd <span class="keyword">import</span> open_workbook, xldate_as_tuple</div><div class="line"><span class="comment"># xldate_as_tuple is to transform data representing date, time into tuple</span></div><div class="line"><span class="keyword">from</span> xlwt <span class="keyword">import</span> Workbook</div><div class="line"></div><div class="line">input_file = sys.argv[<span class="number">1</span>]</div><div class="line">output_file = sys.argv[<span class="number">2</span>]</div><div class="line">output_workbook = Workbook()</div><div class="line">output_worksheet = output_workbook.add_sheet(<span class="string">'jan_2013_output'</span>)</div><div class="line"></div><div class="line"><span class="keyword">with</span> open_workbook(input_file) <span class="keyword">as</span> workbook:</div><div class="line">    worksheet = workbook.sheet_by_name(<span class="string">'january_2013'</span>)</div><div class="line">    <span class="keyword">for</span> row_index <span class="keyword">in</span> range(worksheet.nrows):</div><div class="line">        row_list_output = []</div><div class="line">        <span class="keyword">for</span> col_index <span class="keyword">in</span> range(worksheet.ncols):</div><div class="line">            <span class="keyword">if</span> worksheet.cell_type(row_index, col_index) == <span class="number">3</span>:</div><div class="line">                <span class="comment"># value 3 represents cell that include date data</span></div><div class="line">                date_cell = xldate_as_tuple(worksheet.cell_value\</div><div class="line">                                                (row_index, col_index), workbook.datemode)</div><div class="line">                <span class="comment"># datemode determine date is based on 1900 or 1904 </span></div><div class="line">                date_cell = date(*date_cell[<span class="number">0</span>:<span class="number">3</span>]).strftime\</div><div class="line">                    (<span class="string">'%m/%d/%Y'</span>)</div><div class="line">                row_list_output.append(date_cell)</div><div class="line">                output_worksheet.write(row_index, col_index, date_cell)</div><div class="line">            <span class="keyword">else</span>:</div><div class="line">                non_date_cell = worksheet.cell_value\</div><div class="line">                    (row_index, col_index)</div><div class="line">                row_list_output.append(non_date_cell)</div><div class="line">                output_worksheet.write(row_index, col_index, \</div><div class="line">                                       non_date_cell)</div><div class="line">output_workbook.save(output_file)</div></pre></td></tr></table></figure>
<p>运行结果如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">C:\Users\<span class="number">20161111</span>\Desktop&gt;python <span class="number">3</span>excel_parsing_and_write_keep_dates.py sales_2013.xlsx date_output.xls</div></pre></td></tr></table></figure>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190630150632.png">

</div>
<h2 id="使用pandas读取excel文件">使用<code>pandas</code>读取Excel文件</h2>
<p>使用<code>pandas</code>也可以读取Excel文件，将下面的代码保存为<code>pandas_read_and_write_excel.py</code>，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env python3</span></div><div class="line"><span class="keyword">import</span> sys</div><div class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</div><div class="line"></div><div class="line">input_file = sys.argv[<span class="number">1</span>]</div><div class="line">output_file = sys.argv[<span class="number">2</span>]</div><div class="line"></div><div class="line">data_frame = pd.read_excel(input_file, sheetname = <span class="string">'january_2013'</span>)</div><div class="line">writer = pd.ExcelWriter(output_file)</div><div class="line">data_frame.to_excel(writer, sheet_name = <span class="string">'jan_13_output'</span>, index = <span class="keyword">False</span>)</div><div class="line">writer.save()</div></pre></td></tr></table></figure>
<p>运行结果如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">PS D:\netdisk\python_data&gt; python .\pandas_read_and_write_excel.py .\sales_2013.xlsx pandas_output.xls</div></pre></td></tr></table></figure>
<h2 id="选取特定的行">选取特定的行</h2>
<p>现在挑出那些<code>Sale Amount</code>超过1400的行。</p>
<h3 id="常规python选择某一行">常规Python选择某一行</h3>
<p>保存下面代码，命名为<code>4excel_value_meets_condition.py</code>，代码如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env python3</span></div><div class="line"><span class="keyword">import</span> sys</div><div class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> date</div><div class="line"><span class="keyword">from</span> xlrd <span class="keyword">import</span> open_workbook,xldate_as_tuple</div><div class="line"><span class="keyword">from</span> xlwt <span class="keyword">import</span> Workbook</div><div class="line"></div><div class="line">input_file = sys.argv[<span class="number">1</span>]</div><div class="line">output_file = sys.argv[<span class="number">2</span>]</div><div class="line">output_workbook = Workbook()</div><div class="line">output_worksheet = output_workbook.add_sheet(<span class="string">'jan_2013_output'</span>)</div><div class="line">sale_amount_column_index = <span class="number">3</span></div><div class="line"><span class="keyword">with</span> open_workbook(input_file) <span class="keyword">as</span> workbook:</div><div class="line">    worksheet = workbook.sheet_by_name(<span class="string">'january_2013'</span>)</div><div class="line">    data = []</div><div class="line">    header = worksheet.row_values(<span class="number">0</span>)</div><div class="line">    data.append(header)</div><div class="line">    <span class="keyword">for</span> row_index <span class="keyword">in</span> range(<span class="number">1</span>, worksheet.nrows):</div><div class="line">        row_list = []</div><div class="line">        sale_amount = worksheet.cell_value\</div><div class="line">            (row_index, sale_amount_column_index)</div><div class="line">        <span class="keyword">if</span> sale_amount &gt; <span class="number">1400</span>:</div><div class="line">            <span class="keyword">for</span> column_index <span class="keyword">in</span> range(worksheet.ncols):</div><div class="line">                cell_value = worksheet.cell_value\</div><div class="line">                    (row_index, column_index)</div><div class="line">                cell_type = worksheet.cell_type\</div><div class="line">                    (row_index, column_index)</div><div class="line">                <span class="keyword">if</span> cell_type == <span class="number">3</span>:</div><div class="line">                    date_cell = xldate_as_tuple\</div><div class="line">                        (cell_value, workbook.datemode)</div><div class="line">                    date_cell = date(*date_cell[<span class="number">0</span>:<span class="number">3</span>])\</div><div class="line">                    .strftime(<span class="string">'%m/%d/%Y'</span>)</div><div class="line">                    row_list.append(date_cell)</div><div class="line">                <span class="keyword">else</span>:</div><div class="line">                    row_list.append(cell_value)</div><div class="line">        <span class="keyword">if</span> row_list:</div><div class="line">            data.append(row_list)</div><div class="line">    <span class="keyword">for</span> list_index, output_list <span class="keyword">in</span> enumerate(data):</div><div class="line">        <span class="keyword">for</span> element_index, element <span class="keyword">in</span> enumerate(output_list):</div><div class="line">            output_worksheet.write(list_index, element_index, element)</div><div class="line">output_workbook.save(output_file)</div></pre></td></tr></table></figure>
<p>运行结果如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">PS D:\netdisk\python_data&gt; python .\<span class="number">4</span>excel_value_meets_condition.py .\sales_2013.xlsx <span class="number">4</span>output.xls</div></pre></td></tr></table></figure>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190701153503.png">

</div>
<h3 id="pandas包选取某一行"><code>pandas</code>包选取某一行</h3>
<p>在下面的案例中，使用<code>pandas</code>挑出那些<code>Sale Amount</code>列大于1400的行。如果需要多个条件，则需要添加<code>&amp;</code>与<code>|</code>符号，代码文件保存为<code>pandas_value_meets_condition.py</code>。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env python3</span></div><div class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</div><div class="line"><span class="keyword">import</span> sys</div><div class="line"></div><div class="line">input_file = sys.argv[<span class="number">1</span>]</div><div class="line">output_file = sys.argv[<span class="number">2</span>]</div><div class="line">data_frame = pd.read_excel(input_file, <span class="string">'january_2013'</span>, index_col = <span class="keyword">None</span>)</div><div class="line">data_frame_value_meets_condition = \</div><div class="line">    data_frame[data_frame[<span class="string">'Sale Amount'</span>].astype(float) &gt; <span class="number">1400</span>]</div><div class="line">writer = pd.ExcelWriter(output_file)</div><div class="line">data_frame_value_meets_condition.to_excel(writer, sheet_name = <span class="string">'jan_13_output'</span>,\</div><div class="line">                                          index = <span class="keyword">False</span>)</div><div class="line">writer.save()</div></pre></td></tr></table></figure>
<p>运行代码如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">PS D:\netdisk\python_data&gt; python .\pandas_value_meets_condition.py .\sales_2013.xlsx pandas_output.xlsx</div></pre></td></tr></table></figure>
<p>打开<code>pandas_output.xlsx</code>，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190702100612.png">

</div>
<h2 id="挑选满足多个条件的行">挑选满足多个条件的行</h2>
<p>例如在前面的数据中，我们要挑选<code>01/24/2013</code>与<code>01/31/2013</code>这两个购买日期的行，代码保存为<code>5excel_value_in_set.py</code>，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env python3</span></div><div class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</div><div class="line"><span class="keyword">import</span> sys</div><div class="line"></div><div class="line">input_file = sys.argv[<span class="number">1</span>]</div><div class="line">output_file = sys.argv[<span class="number">2</span>]</div><div class="line"></div><div class="line">data_frame = pd.read_excel(input_file, <span class="string">'january_2013'</span>, index_col=<span class="keyword">None</span>)</div><div class="line">important_dates = [<span class="string">'01/24/2013'</span>,<span class="string">'01/31/2013'</span>]</div><div class="line">data_frame_value_in_set = data_frame[data_frame[<span class="string">'Purchase Date'</span>].isin(important_dates)]</div><div class="line">writer = pd.ExcelWriter(output_file)</div><div class="line">data_frame_value_in_set.to_excel(writer, sheet_name=<span class="string">'jan_13_output'</span>, index=<span class="keyword">False</span>)</div><div class="line">writer.save()</div></pre></td></tr></table></figure>
<p>运行以下代码即可：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">D:\netdisk\python_data&gt;python <span class="number">5</span>excel_value_in_set.py sales_2013.xlsx pandas_output.xls</div></pre></td></tr></table></figure>
<h3 id="挑选满足某一特定模式的行">挑选满足某一特定模式的行</h3>
<p>任务：选择那些顾客的名字里，首字母是<code>J</code>的行，使用pandas来实现，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env python3</span></div><div class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</div><div class="line"><span class="keyword">import</span> sys</div><div class="line"></div><div class="line">input_file = sys.argv[<span class="number">1</span>]</div><div class="line">output_file = sys.argv[<span class="number">2</span>]</div><div class="line">data_frame = pd.read_excel(input_file, <span class="string">'january_2013'</span>, index_col=<span class="keyword">None</span>)</div><div class="line">data_frame_value_matches_pattern = data_frame[data_frame[<span class="string">'Customer Name'</span>]\</div><div class="line">    .str.startswith(<span class="string">"J"</span>)]</div><div class="line">writer = pd.ExcelWriter(output_file)</div><div class="line">data_frame_value_matches_pattern.to_excel(writer, sheet_name=<span class="string">'jan_13_output'</span>,\</div><div class="line">                                          index=<span class="keyword">False</span>)</div><div class="line">writer.save()</div></pre></td></tr></table></figure>
<p>按如下方式运行代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">λ python pandas_value_matches_pattern.py sales_2013.xlsx output_files\pandsa_output.xls</div></pre></td></tr></table></figure>
<h3 id="选取特定列">选取特定列</h3>
<p>使用Python选取特定的列的时，可以采用列索引值，也可以采用列标题来实现。</p>
<p>按索引值来提取列。****</p>
<p>现在假设我们想保留Customer Name和Purchase Date这两列，使用Pandas来实现，保存代码为<code>pandas_column_by_index.py</code>，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env python3</span></div><div class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</div><div class="line"><span class="keyword">import</span> sys</div><div class="line"></div><div class="line">input_file = sys.argv[<span class="number">1</span>]</div><div class="line">output_file = sys.argv[<span class="number">2</span>]</div><div class="line">data_frame = pd.read_excel(input_file, <span class="string">'january_2013'</span>, index_col = <span class="keyword">None</span>)</div><div class="line">data_frame_column_by_index = data_frame.iloc[:, [<span class="number">1</span>,<span class="number">4</span>]]</div><div class="line">writer  = pd.ExcelWriter(output_file)</div><div class="line">data_frame_column_by_index.to_excel(writer, sheet_name = <span class="string">'jan_13_output'</span>,index=<span class="keyword">False</span>)</div><div class="line">writer.save()</div></pre></td></tr></table></figure>
<h2 id="参考资料">参考资料</h2>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/21/">21</a><a class="extend next" rel="next" href="/page/3/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">RVDSD</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">206</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">11</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">93</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          <div class="links-of-author motion-element">
            
          </div>

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

<div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">RVDSD</span>

  
</div>



<div class="powered-by">
<i class="fa fa-user-md"></i><span id="busuanzi_container_site_pv">
  本站访客数:<span id="busuanzi_value_site_uv"></span>
</span>
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>


<div class="BbeiAn-info">
	<a target="_blank" href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=41018102000118" style="color:#909090;text-decoration:none;padding-left:0px;no-repeat left center" rel="nofollow">豫公网安备 41018102000118</a>	  <!--这里将图标作为了背景，以使得能和后面的文字在同一行-->
</div>

  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.3</div>




<div class="theme-info">
  <div class="powered-by"></div>
  <span class="post-count">博客全站共812.7k字</span>
</div>

        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.3"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.3"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.3"></script>



  


  




	





  





  












  





  

  

  
  

  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config("");
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="custom_mathjax_source">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->
  


  

  

</body>
</html>
