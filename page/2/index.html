<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.3" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.3">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.3" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta property="og:type" content="website">
<meta property="og:title" content="RVDSD的个人笔记本">
<meta property="og:url" content="http://rvdsd.top/page/2/index.html">
<meta property="og:site_name" content="RVDSD的个人笔记本">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="RVDSD的个人笔记本">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.3',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://rvdsd.top/page/2/"/>





  <title>RVDSD的个人笔记本</title><!-- hexo-inject:begin --><!-- hexo-inject:end -->
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">RVDSD的个人笔记本</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">学习过程中的输出</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2018/06/24/BioInformation/各种基因名笔记/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/06/24/BioInformation/各种基因名笔记/" itemprop="url">各种基因名笔记</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-06-24T12:00:00+08:00">
                2018-06-24
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/生物信息学/" itemprop="url" rel="index">
                    <span itemprop="name">生物信息学</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  890
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  3
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="基因名">基因名</h2>
<p>不同的数据据中的对于一个基因的描述不同，例如p53，它又叫P53，又叫TP53，或BCC7，或ENSG00000141510或OTTHUMG00000162125。通常来说，对p53的描述使用的是Official Gene Symbol（例如TP53）。</p>
<p>另外，在NCBI数据库中我们查找TP53，会出现下面这些信息：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180624/bCd0JaAJcB.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>现在我们从第一行开始解释：</p>
<ol style="list-style-type: decimal">
<li><code>TP53 tumor protein p53 [ Homo sapiens (human) ]</code>：它表示这个基因是TP53肿瘤蛋白53，TP表示的是tumor protein，p表示的是protein，53的意思是这个蛋白的分子量是53kDa（其实当初在跑SDS-PAGE胶时，这个蛋白位于53kDa附近，就命名为p53，其实后来发现，这个蛋白中富含脯氨酸，在SDS-PAGE胶中迁移速度偏慢，它表示出来的分子量要比实际的分子量大，此蛋白的实际分子量是43.7kDa，不过由于命名太久了，也就将错就错了），后面的<code>Homo sapiens (human)</code>是人类的意思，它表示这个基因是人源的。</li>
<li><code>Gene ID</code>：7157，表示的是基因的entrez的系统代号，Entrez 是美国国家生物技术信息中心所提供的在线资源检索器。该资源将GenBank序列与其原始文献出处链接在一起。如果我们在Entrez中直接检索7157，也能直接搜索到TP53。Entrez ID实际上是指的Entrez gene ID，是对应于染色体上一个gene location的。每一个发现的基因都会被编制一个统一的编号，而Entrez ID是指的来自于NCBI旗下的Entrez gene数据库所使用的编号。每个基因的编号具有唯一性，包括不同种属生物间的同源基因编号也不相同，例如同样是TP53基因，人源TP53的Entrez ID为7157，zebrafish源的Entrez ID为30590，chichen源的Entrez ID为396200。</li>
<li><code>Official Symbol</code>，这个是我们常用的这个基因的名称，即TP53，这个命名是由HGNC批准的，HGNC的全称是HUGO Gene Nomenclature Committee，其中HUGO的全称是Human Genome Organisation，即国际人类基因组组织，而HGNC则是HUGO基因命名委员会。</li>
<li><code>Official Full Name</code>，官方的全称。</li>
<li><code>Ensembl:ENSG00000141510</code>：ENSEMBL是一个由由英国Sanger研究所Wellcome基金会及欧洲分子生物学实验室所属分部欧洲生物信息学研究所共同协作运营的一个数据库。Ensembl数据库的基因名称后面有的还有个小数点，这个表示基因的版本号，没多少用处，在进行生信分析的时候，可以去掉。</li>
<li>MIM:191170。OMIM 为“0nline Mendelian Inheritance in Man”的简称，即在线《人类孟德尔遗传》，是一个关于人类基因和遗传紊乱的数据库（持续更新）。主要着眼于遗传性的基因疾病，包括文本信息和相关参考信息、序列纪录、图谱和相关其他数据库。其中MIM号就是在OMIM数据库中的基因编号。</li>
<li><code>Vega:OTTHUMG00000162125</code>。脊椎动物基因组注释（Vertebrate Genome Annotation，Vega）数据库已经被设计为浏览来自各种脊椎动物基因组的完结序列的人工注释的一个社区资源。它的核心数据库是基于Ensembl样式的模式，扩展到包含精选-特异的元数据。</li>
</ol>
<p>常用的基因名转换工具：</p>
<p>DAVID：https://david.ncifcrf.gov/</p>
<p>Absolute Gene ID Conversion Tools：http://bioinformatics.louisville.edu/abid/</p>
<p>bioDBnet：（https://biodbnet-abcc.ncifcrf.gov/db/db2db.php）</p>
<p>ENSEMBL biomart：（http://asia.ensembl.org/biomart/martview/bbd9fa2dd0eac95aa098be3514472b0e）</p>
<h2 id="参考资料">参考资料</h2>
<p><a href="https://blog.csdn.net/liufeichendi/article/details/78819884" target="_blank" rel="external">各类基因ID转换</a></p>
<p>简述几种Gene ID的转换方法</p>
<p><a href="https://www.douban.com/note/544090098/" target="_blank" rel="external">OMIM数据库</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2018/06/23/BioStatistics/生物统计-StatQuest学习笔记14-PCA/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/06/23/BioStatistics/生物统计-StatQuest学习笔记14-PCA/" itemprop="url">StatQuest学习笔记14——PCA</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-06-23T12:10:54+08:00">
                2018-06-23
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/生物统计/" itemprop="url" rel="index">
                    <span itemprop="name">生物统计</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  8,340
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  32
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="前言">前言</h2>
<p>这篇笔记是StatQuest系列视频教程的第39-43小节，其中39小节的内容是PCA；第40小节的内容是PCA的基本思想；第41小节的内容还是PCA，此处与第39小节的内容重复，不记笔记；第42小节的内容是R语言与PCA；第43小节的内容是Python与PCA。为了使笔记更清楚，笔记的顺序是40，39，42，43。</p>
<h2 id="pca的基本思想">PCA的基本思想</h2>
<p>我们先从最简单的案例入手。先看下面的一堆东西，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/mCGjjEiDid.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>我们可以把它们理解一群正常的细胞，当然了，如果你不是学生物的，你也可以把它们理解成一群人，一群卡车，一群城市等。虽然它们看上去是一样的（表面一样），但是，它们本质上也有可能不一样，例如像下面的这个样子：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/7I3AhkDEij.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>这群细胞分成了三群，不过从直观上来看，你太不容易看出这一群细胞划分成了三群，为了能够详细地划分这些细胞，我们可以对这些细胞进行测序，确认这些细胞中有哪些基因处于活跃状态，我们就能知道这些细胞的功能，这样就知道了这些细胞的种类，当然了，如果这是一群人，我们可以测量他们的身高，血压等，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/i9lDC77hHF.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>现在我们测了这些细胞的基因，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/KEgBiH86A6.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>假设我们此时只有2个细胞，那么我们可以把这两个细胞的所有基因画在一个坐标上，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/bj09g4b0dJ.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>就像上图显示的这样，基因1在细胞1中的高表达，而在细胞2中低表达，而基因9正好相反，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/ej4hlkcIgC.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>从我们所列出的数据来看，细胞1和细胞2的基因表达水平很多呈相反的水平，那么我们很容易就知道，这两个细胞必定不是同一种类的细胞，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/Ek8LmbBmck.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时，我们把问题升级一下，我们有3个细胞，现在分别绘制出这三个细胞相互之间的基因表达水平，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/Fa92jjgc8a.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>这种两两之间的比较太麻烦了，我们可以直接把它们放到一个三维坐标系中进行比较，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/91L0Hl5Hm5.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>三个坐标分别是细胞1，2，3，我们通过旋转坐标轴就可以发现不同细胞两两的关系。</p>
<p>现在把问题再进一步，如果我们有4个细胞，比较直观的手段就是分别画出这4个细胞两两的平面坐标系，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/LmBCGaA1Bj.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>或者是画出一个四维的坐标系，像下面的这个样子：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/G8FbIEBD64.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>前面的方法就不太适用于这种情况，此时我们可以使用主成分分析（PCA）的方法，PCA可以将不同细胞之间的关系转换到一个平面坐标系中，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/J5k20AKcHj.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时我们可以发现，通过PCA这种方法，可以把一群细胞中高度相关的细胞聚集起来，像下面的这个样子：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/0CDh0j5clF.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>为了能够更直观地说明这种分析方法，我们可以把不同的细胞换成不同的颜色，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/i2DIkm3Cei.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时，我们再回到最初的问题上来，通过PCA方法可以把一群细胞中高度相关的细胞给区分开来，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/Chaf62gGdH.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h2 id="pca的结果查看">PCA的结果查看</h2>
<p>此时我们来看一下，怎么看PCA的结果，PCA图中的坐标轴是按重要性进行排序的。其中PC1是第一主成分轴，它的重要性要强于PC2，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/3Hh8beb4m7.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>假如一个PCA长得是下面的这个样子，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/9800044dAE.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时，如果左上角的绿点与左下角的红点的距离是d1，右下角的黄点与左下角红点的距离是d2，此时d1=d2的话，那么我们就可以认为，黄色点与绿色点的差异要大于绿色点与红色点的差异，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/HbffALgfcF.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>在我们了解了PCA之后，我们应该知道，PCA仅仅是一种划分不同数据类型的方法之一，此外，还有其他基于降维的统计学方法（dimension reduction），例如热图，t-SNE图，多维缩放（multi-dimensional scaling，MDS）等，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/6AfcGdaC8G.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h2 id="pca的计算原理">PCA的计算原理</h2>
<h3 id="简单案例">简单案例</h3>
<p>在这篇笔记中，使用SVD（singular value decomposition）的方法来计算PCA。我们先看一个简单的案例，在这个案例中，我们检测了6只不同小鼠的2个基因，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/JJk9FI2bHl.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>其实我们可以把它再抽象化一下，把小鼠看成样本，基因看成2个变量，就像下面的这个样子：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/Em4HC50mh4.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>我们还以小鼠的基因为例说明，如果我们只检测1个基因的话（Gene 1），那么我们根据基因1表达的情况，把小鼠的绘制到数轴上，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/g7cj9J5fDj.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>其中小鼠1，2，3的Gene 1表达水平比较高，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/I21b9F0EIi.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>而小鼠4，5，6的gene 1水平则较低，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/a7dch4dbi7.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>虽然这个图形比较简单，但是，我们从中还是能得到一些信息的，例如小鼠1，2和3比较接近，小鼠4，5和6比较接近，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/461AK884aI.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>如果我们检测了2基因，那么我们可以绘制2维的坐标系，横轴是gene 1，纵轴是基因2，那么小鼠1，2和3会聚在一起，小鼠4，5和6会聚在一起，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/KLDhhiH4D0.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>再进一步，如果我们检测了3个基因，那么我们可以绘制三维的坐标系，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/gaIeE8mgg9.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>在上图的这个3维坐系中，圆点越大，表达离你越近。再进一步，如果我们检测了4个基因，此时我们很难绘制出四维的坐标系，那么我们就需要进行PCA分析了，PCA可以把超过4个的基因值降维成二维的坐标系，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/KdBIKLiAm6.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>在这个PCA的二维坐标系中，我们可以发现，小鼠4、5和6是一类，小鼠1，2和3是一类，它们的各自的基因表达模式也类似，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/cCAGj8dhBg.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>PCA在对数据进行聚合（clustering）时有很大的价值，例如，经过PCA分析，在它的二维坐标轴上我们可以发现，gene 3在x轴上对样本的区分有贡献最大（这里不太理解为什么直接就看出了Gene 3，我猜测可能是基因3在这两群小鼠中的分布比较明显，一组高，一组低），如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/CcC8D2kgm5.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h3 id="计算原理">计算原理</h3>
<p>为了理解PCA是如何进行计算的，我们还回最初2个基因的案例上来，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/jKI4b7mE10.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>接着是计算过程。</p>
<p>第一，我们根据所有的样本的这两个基因的表达情况绘制出它们的平面坐标系，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/aJB9gBA8Ff.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>第二，计算Gene 1表达水平的均值，就是下图中x轴上红叉的所在位置，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/jj12lll3ij.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>第三，计算Gene 2表达水平的均值，就是下图中y轴上红叉的所在位置，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/ekE6CFh24a.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>第四，有了Gene 1和Gene 2的这两个数值，我们就得到了整体数值的中心，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/KecAlDC79I.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时，我们有了这个点（蓝叉所在位置）后，我们此时就不需要再看原始数据了，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/4f87ji9bKc.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>第五，我们把所有的数据点各左下角移动，将数据的中心与<code>(0,0)</code>重合，就像下面的这个样子，从左图移成右图的样子：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/6kHGL23a7A.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时，虽然所有的数据点都移动了，但是每个点之间的相对距离是不变的，整体数据的中心就变成了原点，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/ag77labI60.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>第六，我们找一条通过原点的直线，就像下面的这个样子，具体这条直线做什么的，先不用管：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/BI71C0ch8G.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>第七，旋转这条直线（红色虚线），使这条直线尽量匹配这些数据，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/cbbhJHa3Kf.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>第八，最终，最匹配数据的直线就是下面的这个样子：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/dLL4fd0f49.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h4 id="第1主成分的计算原理">第1主成分的计算原理</h4>
<p>此时，我们可能有疑问，为什么这条直线是最匹配数据的，它的计算原理是什么，那么接着看。我们先回到最初的直线，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/9ejiJk7I8m.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>为了准确地找出最佳匹配所有数据的直线，PCA会将所有数据点都役射到这条直线上来，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/BLHHg6GeK6.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时，可以计算这些数据点到投射到这条直线上的距离，并且使这些距离最小，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/bGFCed6Lcg.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>除了可以计算数据点到直线的距离最小外，还要计算所有数据点投射到这条直线上的点（图中绿叉位置所在点）到原点的距离，使这个距离最大，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/LE8530JK45.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>如果你不理解上述的这种描述，那么还可以这么理解，当这条直线（红色虚线）尽量匹配这些数据点时，这些数据点到这条直线的距离是在缩小的，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/g58GiLDD5G.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>同样的，这些数据点投射到直线上的点到原点的距离是加大的，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/21LfC4fiLJ.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>为了更好地以数学思维来理解这个过程，此时我们先看一个点的情况，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/58CghaiFl6.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>这个点是固定的，它到原点的距离也是固定的，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/9J29llA58d.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>换句话讲，当直线（红色虚线）在旋转的过程中，这个点到原点的距离是不会变的，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/h54L4bimBG.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>当直线旋转到某一位置时，我们将这个点投射到直线上，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/2k64FD0BLi.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时，我们会得到一个直角，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/f37m2clChK.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>有了直角，我们就能得到如下的直角三角形，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/L9LhLA8b86.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时，我们把这个直角三角形的三条边命名为<code>a</code>，<code>b</code>,<code>c</code>，那么根据勾股定理，我们就会得到这个公式，即<span class="math inline">\({a}^2={b}^2+{c}^2\)</span>，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/J19amgjaK8.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>三角形的斜边<code>a</code>是不会变的，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/618DCbfk5D.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>如果直角边<code>b</code>变大的话，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/9bEFi4hJkJ.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>那么直角边<code>c</code>就会变小，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/9IefLHJf78.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>反之，也成立。而PCA计算的则是降低直角边<code>b</code>，也就是降低数据点投射到直线上的距离，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/kGe9fh0KGF.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>同时，PCA还要保证投到到直线上的点到原点的距离最大，也就是说要求<code>c</code>边最大，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/63kmmkaa3d.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>通过上面利用直角三角形的解释，就比较容易理解PCA计算最佳匹配直线的思路了。此时，再回到起点，将所有的数据点投射到直线上，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/6kLA5Jm1Fg.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>然后计算某个点到原点为的距离，我们把它命名为<span class="math inline">\({d}_1\)</span>，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/CEEEEmDCJj.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>同理，计算第2点投射到直线上的点到原点的距离，命名为<span class="math inline">\({d}_2\)</span>，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/B9iHf7dmeg.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>计算剩余的点投射到直线上的点到原点的距离，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/J72EbeiL1e.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>然后把这些值的平方加起来，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/d8E9CdcgBF.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时，我们旋转直线，直到最终这个<code>SS</code>的距离最大（这个距离最大，也就是说数据点到直线的距离最小）为止，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/HBmD9FF7cK.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>最终，得到了我们想要的直线，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/l25cIEkClC.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时，这条直线就叫第一主成分（Principal Component 1，简称PC1），如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/C1gG9C1ImD.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>有了这个直线，它的斜率就很容易计算出来了，经计算，PC1的斜率为0.25，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/Cg0JJ7m42I.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>这个斜率0.25如何理解呢？它表示的意思就是，每当我们在Gene 1（x轴坐标）前进4个单位时，在这个直线上的数据点在Gene 2上就增加1个单位，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/beAGf9aLCH.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>如果按照生物学意义来理解就是，这几个样本在Gene 1坐标轴上更加分散，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/Bk5819h2aC.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>而在Gene 2上的分散程度则较小，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/hlG7I56mfh.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>我们可以根据鸡尾酒配方（cocktail recipe）来思考这个PC1（注：鸡尾酒是一种混合酒品，掺杂有不同的酒），例如为了生成PC1，我们可以加入4份的Gene 1，再加入1份的Gene 2，另外，我们可以发现，Gene 1与Gene 2的比值是4，它就说明在描述数据的分散程度方面，Gene 1这个基因更加重要，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/Be8833JmCL.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>但在数学上，把这种鸡尾酒配方（cocktail recipe）称为是Gene 1和Gene 2的线性组合（linear combination），在统计学上，描述PC1也可以这样“PC1是变量的一个线性组合”，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/4Cg0eje74K.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h4 id="第1主成分的特征值">第1主成分的特征值</h4>
<p>紧接上面的案例，继续进行，还要计算一些东西。对于PC1来说，它的斜率是0.25，那么我们在Gene 1增加4个单位，在Gene 2上就会增加1个单位，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/56H8B19Fi6.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>那么根据勾股定理，我们就可以计算出红色箭头的长度，长度为4.12，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/DaK5B1Gd76.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>当我们使用SVD（全称是Singular-value decomposition，中文是奇异值分解）进行PCA计算时，我们需要把这个红色箭头定义为1个单位，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/FE9cJC0kHI.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>为了将这个红色箭头定义为1个单位，那么我们就要把这个三角形的各个连长都除以4.12，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/H77gcC99FH.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>那么，除以4.12后，各个三角形的连长就成了这个样子：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/B44HjeFhlL.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>也就是说三角形的三个边长分别变成了1，0.242，0.97，不过构成PC1的线性组合，即Gene 1和Gene 2的比值还是不变的，仍旧为4，那么此时我们就可以说取0.97份的Gene 1和0.242份的Gene 2，就构成了PC1，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/316AcC8B5B.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时，我们再回想一下我们计算PC1的整个过程：</p>
<ol style="list-style-type: decimal">
<li>原始数据；</li>
<li>最佳匹配直线；</li>
<li>单位向量计算，如下所示：</li>
</ol>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/jHBaDhB1jL.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>图中的红色箭头是1个长度单位，它由0.97个Gene 1和0.242个Gene 2构成，它称为PC1的奇异向量（Singular vector），或者是特征向量（Eigenvector），而每个基因的比例则被称为加载分数（Loading Scores），如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/cDmE8fmFl2.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此外，在PCA中，将SS（也就是各个点投射到最佳匹配的直线上的点到原点的距离的平方和）称为PC1的特征值（Eigenvalue），如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/bGaiIK15di.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>PC1特征向量的值（Eigenvalue for PC1）的平方根被称为PC1的奇异值（Singular Value for PC1），如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/098ACkB7Dc.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h4 id="第2主成分的计算原理">第2主成分的计算原理</h4>
<p>前面是第1主成分（PC1）的计算，此时进行第2主成分的计算（PC2）。由于我们使用的二维坐标，PC2仅仅是一条通过了原点，并且与PC1垂直的直线，PC2并没有像PC1那样复杂的优化，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/b1Ch0Ij6je.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>由于PC2与PC1垂直，那么很容易地就能计算出PC2的斜率为-4，这也就是说，PC2是由-1个Gene 1和4个Gene 2构成的，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/JeDhbL5174.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>当我们在PC2所在直线上定义一个单位长度的向量时，那么PC2就是由-0.242个Gene 1和0.97个Gene 2构成了，此时这个单位向量（蓝色箭头）就被称为PC2的奇异向量（Singular Vector）或特征向量（Eigenvector），如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/m7Kb745lA2.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>而-0.242和0.97就是PC2的加载得分，它表示的就是，基因2相当于4位的基因1，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/3kGJlL1m6F.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>PC2的特征值则是数据点投到到PC2上的点到原点的距离，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/1I74hCFjC2.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时，PC1和PC2的计算结束，绘制最终的PCA图，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/092J48ddKi.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>然后旋转这个坐标，让PC1水平，PC2垂直，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/IcC32F9KL2.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>在这个新的坐标系中，图中黑色的叉就表示原始的样本6（Sample 6），如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/DH5ad6fH06.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>而Sample 6位于这个点上：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/jJ82IE9iD7.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>同理，Sample 2在这里：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/0DGaCBm4bk.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h3 id="各主成分的变异">各主成分的变异</h3>
<p>此时，再讲一些术语，先回忆一下前面的PC1的特征值和PC2的特征值，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/AmFaa3li31.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>我们把原始的数据点投射到主成分上，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/eGdLahED5m.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>计算投射到PC1上的点到原点的距离，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/09DIfJ8JJJ.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>所有的这些数值的平方和就是PC1的特征值，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/fba5imkDhe.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>我们也可以将特征值转为PC1到原点的变异，方法就是SS除以样本数减1，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/1lLLkmLILc.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>以这个案例为例说明，假如PC1的变异（Variation）为15，PC2的变异为3，这就表明主成分的总变异为18，那么也就是说PC1在总变异中所占的比值为83%（15/18=0.83），如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/3KCh270B3h.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>而PC2占的总变异为17%（3/18=0.17），如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/GhKHC6FG2a.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时，我们把这两个主成分所占的比例画出来，这种图与条形图很像，不过在PCA中，这叫碎石图（scree plot），每个矩形表示每个PC所占总变异的比值，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/05DdaJEiBB.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h2 id="一个复杂案例">一个复杂案例</h2>
<p>我们看一个比较复杂的案例，在这个案例中，6只小鼠，检测了3个基因，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/8c0bF29BCk.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>按照前面的思路，找到数据的中心，并将其移到原点，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/aHJfHBm0gh.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>找到最佳的匹配数据的直线，也就是PC1，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/Lh7L1cfL7G.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>不过这个PC1有3个成分，分别是0.62个Gene 1，0.15个Gene 2和0.77个Gene 3，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/0EL1h006kJ.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>其中，Gene3 是最主要的组成部分，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/abLgJG8IAf.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>然后寻找PC2，PC2通过原点，并与PC1垂直，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/34da1hfI95.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>最终，PC2的成分为0.77个Gene 1，0.62个Gene 2和0.15个Gene 3，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/3FJb3cEb8j.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>在PC2中，Gene 1是最主要的组成部分，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/7KFeHcDk1F.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>最后，我们寻找PC3，PC3通过原点，同时与PC1和PC2垂直，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/cble1hcJfD.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>如果我们有更多的基因，那么我们就会不断地寻找更多的主成分，也就是说不断地往这个坐标中加入与前一个主成分垂直的直线，从理论上讲，一个基因就有一个主成分（例如这个案例中，3个基因，最终找到了3个主成分），因此，主成分的数目要么跟变量相等，要么跟样本的数目相等（这个数目还是比较小的），如下所示：</p>
<div class="figure">
<img src="C:\Users\20161111\AppData\Local\Temp\1529938792438.png" alt="1529938792438">
<p class="caption">1529938792438</p>
</div>
<p>不过，真正在进行PCA的时候，最终的主成分数目是有限的，这个马上就要讲到。一旦计算出来了所有的主成分，那么我们就可以使用特征值来计算每个主成分的变异占总变异的比例，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/F9ifHAj37K.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>在这个案例中，PC1的变异占总变异的79%，PC2占15%，PC3占6%，把这些主成分绘制成碎石图，就是下图左图的样子，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/jij1ldCbaI.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>从碎石图中我们可以看到，PC1和PC2占了变异的绝大比例，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/9Elb5ed2KF.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>这就表明了，在二维图中，我们基本上只使用PC1和PC2就能解释三维图中的数据，因为二维图中的PC1和PC2占据了整体的变异的94%，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/g9kID1h7KF.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>我们将三维图转换为二维图，画出PC1和PC2，以及原始数据点，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/4Cc520fGLH.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>将数据投射到这个新坐标的PC1上，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/G86kJfLLck.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>再投射到PC2上，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/BLeLkdebhB.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>然后，我们把这个坐标旋转一下，方便查看，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/15kaBDkIi2.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>下面的这个点就是Sample 4对应的点，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/1iDbi4dBJ4.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>我们再来回顾一下这个案例，首先我们把所有的数据点绘制到三维坐标中，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/mjj5Fj7CLI.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>再计算主成分，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/IAHF0J93l5.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>再计算主成分的特征值与变异比例，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/2chhIL90dL.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>最后，我们使用PC1和PC2这个二维坐标来描述原始数据，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/J8e3b25ke2.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>如果我们检测了6个样本的4个基因，那么我们并不需要绘制出4维坐标图，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/eCjh8JIILD.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>我们可以计算出它们的主成分，画出碎石图，其中我们可以发现，PC1和PC2占据了变异的90%，那么我们仅使用PC1和PC2构成的二维PCA图就可以表示原始数据，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/Kella78eI2.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>将原始数据分别投射到PC1和PC2上，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/m137IB8C16.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>下面的这两个点就对应了Sample 2，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/GAJJ6k3h53.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>也就是这个点：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/fcImd6eh6I.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>那么，所有的点就是这个样子：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/LDcAchEdi7.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>如果我们遇到下面的这种碎石图，在这种碎石图中，PC3和PC4也占据了相当比例的总变异，那么我们仅使用2个主成分（也就是PC1和PC2）就无法精确地代表原始数据，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/1808d217JG.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>不过，即使是有瑕玼的PCA二维图，也可以用于数据的分类，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/E00bf5HFJD.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>在这个图中，黑色的点仍然可以被视为比较接近的类似，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/L9k065Dcl1.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h2 id="r语言与pca">R语言与PCA</h2>
<p>我们可以使用R来计算PCA，在R中，计算PCA的函数是<code>prcomp()</code>，绘图包是<code>ggplot2</code>，使用R，我们可以知道每个主成分的变异占总变异的比值，以及计算加载得分（loading scores），发现哪个变量对图形的影响最大，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180625/meEml78Ihc.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h3 id="生成数据集">生成数据集</h3>
<p>我们先生成一个数据集，代码如下：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">data.matrix &lt;- matrix(nrow=<span class="number">100</span>, ncol=<span class="number">10</span>)</div><div class="line">colnames(data.matrix) &lt;- c(</div><div class="line">  paste(<span class="string">"wt"</span>,<span class="number">1</span>:<span class="number">5</span>,sep=<span class="string">""</span>),</div><div class="line">  paste(<span class="string">"ko"</span>,<span class="number">1</span>:<span class="number">5</span>,sep=<span class="string">""</span>))</div><div class="line">rownames(data.matrix) &lt;- paste(<span class="string">"gene"</span>, <span class="number">1</span>:<span class="number">100</span>, sep=<span class="string">""</span>)</div><div class="line"><span class="keyword">for</span> (i <span class="keyword">in</span> <span class="number">1</span>:<span class="number">100</span>)&#123;</div><div class="line">  wt.values &lt;- rpois(<span class="number">5</span>, lambda = sample(x=<span class="number">10</span>:<span class="number">1000</span>, size=<span class="number">1</span>))</div><div class="line">  ko.values &lt;- rpois(<span class="number">5</span>, lambda = sample(x=<span class="number">10</span>:<span class="number">1000</span>, size=<span class="number">1</span>))</div><div class="line"></div><div class="line">  data.matrix[i,] &lt;- c(wt.values, ko.values)</div><div class="line">&#125;</div><div class="line"></div><div class="line">head(data.matrix)</div></pre></td></tr></table></figure>
<p>查看一下生成的数据，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">&gt; head(data.matrix)</div><div class="line">      wt1 wt2 wt3  wt4 wt5 ko1 ko2 ko3 ko4 ko5</div><div class="line">gene1 <span class="number">423</span> <span class="number">423</span> <span class="number">419</span>  <span class="number">423</span> <span class="number">372</span> <span class="number">582</span> <span class="number">589</span> <span class="number">563</span> <span class="number">534</span> <span class="number">566</span></div><div class="line">gene2 <span class="number">905</span> <span class="number">971</span> <span class="number">967</span> <span class="number">1031</span> <span class="number">910</span>  <span class="number">95</span>  <span class="number">96</span>  <span class="number">96</span>  <span class="number">89</span>  <span class="number">96</span></div><div class="line">gene3 <span class="number">139</span> <span class="number">177</span> <span class="number">147</span>  <span class="number">176</span> <span class="number">152</span> <span class="number">408</span> <span class="number">422</span> <span class="number">419</span> <span class="number">426</span> <span class="number">456</span></div><div class="line">gene4 <span class="number">702</span> <span class="number">712</span> <span class="number">717</span>  <span class="number">691</span> <span class="number">678</span> <span class="number">534</span> <span class="number">546</span> <span class="number">594</span> <span class="number">562</span> <span class="number">515</span></div><div class="line">gene5 <span class="number">582</span> <span class="number">572</span> <span class="number">616</span>  <span class="number">569</span> <span class="number">631</span> <span class="number">315</span> <span class="number">321</span> <span class="number">314</span> <span class="number">345</span> <span class="number">330</span></div><div class="line">gene6 <span class="number">765</span> <span class="number">853</span> <span class="number">781</span>  <span class="number">792</span> <span class="number">768</span> <span class="number">316</span> <span class="number">339</span> <span class="number">317</span> <span class="number">317</span> <span class="number">294</span></div></pre></td></tr></table></figure>
<h3 id="计算pca">计算PCA</h3>
<p>使用<code>prcomp</code>函数来对数据集进行PCA运算，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pca &lt;- prcomp(t(data.matrix),scale=<span class="literal">TRUE</span>)</div></pre></td></tr></table></figure>
<p>代码解释：由于<code>prcomp</code>函数在默认情况下，会把行识别为样本，列识别为基因，而我们生成的数据集<code>data.matrix</code>正好相反，因此用到了<code>t</code>函数，它表示把原来的数据集转置一下，将其行与列交换。</p>
<p><code>prcomp</code>计算的结果含有主成分分析的各种信息，通过<code>str()</code>函数我们可以看一下有哪些东西，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">&gt; str(pca)</div><div class="line">List of <span class="number">5</span></div><div class="line"> $ sdev    : num [<span class="number">1</span>:<span class="number">10</span>] <span class="number">9.34</span> <span class="number">1.85</span> <span class="number">1.6</span> <span class="number">1.45</span> <span class="number">1.24</span> <span class="keyword">...</span></div><div class="line"> $ rotation: num [<span class="number">1</span>:<span class="number">100</span>, <span class="number">1</span>:<span class="number">10</span>] <span class="number">0.104</span> -<span class="number">0.107</span> <span class="number">0.106</span> -<span class="number">0.103</span> -<span class="number">0.106</span> <span class="keyword">...</span></div><div class="line">  ..- attr(*, <span class="string">"dimnames"</span>)=List of <span class="number">2</span></div><div class="line">  .. ..$ : chr [<span class="number">1</span>:<span class="number">100</span>] <span class="string">"gene1"</span> <span class="string">"gene2"</span> <span class="string">"gene3"</span> <span class="string">"gene4"</span> <span class="keyword">...</span></div><div class="line">  .. ..$ : chr [<span class="number">1</span>:<span class="number">10</span>] <span class="string">"PC1"</span> <span class="string">"PC2"</span> <span class="string">"PC3"</span> <span class="string">"PC4"</span> <span class="keyword">...</span></div><div class="line"> $ center  : Named num [<span class="number">1</span>:<span class="number">100</span>] <span class="number">489</span> <span class="number">526</span> <span class="number">292</span> <span class="number">625</span> <span class="number">460</span> <span class="keyword">...</span></div><div class="line">  ..- attr(*, <span class="string">"names"</span>)= chr [<span class="number">1</span>:<span class="number">100</span>] <span class="string">"gene1"</span> <span class="string">"gene2"</span> <span class="string">"gene3"</span> <span class="string">"gene4"</span> <span class="keyword">...</span></div><div class="line"> $ scale   : Named num [<span class="number">1</span>:<span class="number">100</span>] <span class="number">84.2</span> <span class="number">455.8</span> <span class="number">142.2</span> <span class="number">82.1</span> <span class="number">143.2</span> <span class="keyword">...</span></div><div class="line">  ..- attr(*, <span class="string">"names"</span>)= chr [<span class="number">1</span>:<span class="number">100</span>] <span class="string">"gene1"</span> <span class="string">"gene2"</span> <span class="string">"gene3"</span> <span class="string">"gene4"</span> <span class="keyword">...</span></div><div class="line"> $ x       : num [<span class="number">1</span>:<span class="number">10</span>, <span class="number">1</span>:<span class="number">10</span>] -<span class="number">8.92</span> -<span class="number">9.15</span> -<span class="number">8.71</span> -<span class="number">8.75</span> -<span class="number">8.77</span> <span class="keyword">...</span></div><div class="line">  ..- attr(*, <span class="string">"dimnames"</span>)=List of <span class="number">2</span></div><div class="line">  .. ..$ : chr [<span class="number">1</span>:<span class="number">10</span>] <span class="string">"wt1"</span> <span class="string">"wt2"</span> <span class="string">"wt3"</span> <span class="string">"wt4"</span> <span class="keyword">...</span></div><div class="line">  .. ..$ : chr [<span class="number">1</span>:<span class="number">10</span>] <span class="string">"PC1"</span> <span class="string">"PC2"</span> <span class="string">"PC3"</span> <span class="string">"PC4"</span> <span class="keyword">...</span></div><div class="line"> - attr(*, <span class="string">"class"</span>)= chr <span class="string">"prcomp"</span></div></pre></td></tr></table></figure>
<p>从这个结果中我们可以发现，有<code>sdev</code>，<code>rotation</code>，<code>center</code>，<code>scale</code>，<code>x</code>。其中<code>x</code>含有主成分，我们查看一下，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180626/L7fDK35jkd.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>我们可以发现，<code>x</code>中有10个主成分（这是因为有10个样本），第1主成分占据了原始数据总变异的大部分，第2主成分占据了总变异的次大部分等。为了绘制二维图，我们通常使用PC1和PC2（个别情况下也会使用PC2和PC3），如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180626/f6GDFED252.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>我们此时，使用<code>x</code>的前2列（即PC1和PC2）绘制一个二维图，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">plot(pca)</div></pre></td></tr></table></figure>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180626/3dHmCJ7lCd.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>其中，<code>pca$x[,1]</code>是PC1，pca$x[,2]`是PC2，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180626/dBGf7LeJ71.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>10个样本，分别位于图形的左右两侧，此时我们再看一下PC1占的总变异的比例，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">pca.var &lt;- pca$sdev^<span class="number">2</span></div><div class="line">pca.var.per &lt;- round(pca.var/sum(pca.var)*<span class="number">100</span>,<span class="number">1</span>)</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&gt; pca.var</div><div class="line"> [<span class="number">1</span>] <span class="number">8.727308e+01</span> <span class="number">3.432450e+00</span> <span class="number">2.546956e+00</span> <span class="number">2.094293e+00</span> <span class="number">1.534746e+00</span> <span class="number">1.230408e+00</span></div><div class="line"> [<span class="number">7</span>] <span class="number">8.259253e-01</span> <span class="number">6.435822e-01</span> <span class="number">4.185583e-01</span> <span class="number">1.134741e-29</span></div><div class="line">&gt; pca.var.per</div><div class="line"> [<span class="number">1</span>] <span class="number">87.3</span>  <span class="number">3.4</span>  <span class="number">2.5</span>  <span class="number">2.1</span>  <span class="number">1.5</span>  <span class="number">1.2</span>  <span class="number">0.8</span>  <span class="number">0.6</span>  <span class="number">0.4</span>  <span class="number">0.0</span></div></pre></td></tr></table></figure>
<p>绘制出各个主成分对应的碎石图，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">barplot(pca.var.per, </div><div class="line">        main=<span class="string">"Scree Plot"</span>, </div><div class="line">        xlab=<span class="string">"Principal Component"</span>, </div><div class="line">        ylab=<span class="string">"Percent Variation"</span>)</div></pre></td></tr></table></figure>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180626/LBijfCgLmk.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>上图中最长的那个就是PC1所占的总变异的比例，也就是说PC1就能在很大程度上解释两组数据的区分，我们在PC1和PC2的二维图上也能看出来，这两组数据之间主要是由PC1分开的，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180626/c7CKCCaHK8.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h3 id="ggplot2">ggplot2</h3>
<p>ggplot2也能绘制类似的图形，先把数据转换为ggplot2能识别的格式，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">pca.data &lt;- data.frame(Sample=rownames(pca$x),</div><div class="line">                       X=pca$x[,<span class="number">1</span>],</div><div class="line">                       Y=pca$x[,<span class="number">2</span>])</div><div class="line"><span class="comment"># one column with the sample ids</span></div><div class="line"><span class="comment"># Tow columns for the X and Y coordinates for each sample</span></div><div class="line">pca.data</div></pre></td></tr></table></figure>
<p>生成的数据如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">&gt; pca.data</div><div class="line">    Sample         X          Y</div><div class="line">wt1    wt1 -<span class="number">8.920074</span>  <span class="number">0.9049750</span></div><div class="line">wt2    wt2 -<span class="number">9.154298</span> -<span class="number">0.8467998</span></div><div class="line">wt3    wt3 -<span class="number">8.712942</span> -<span class="number">1.0756417</span></div><div class="line">wt4    wt4 -<span class="number">8.746978</span>  <span class="number">2.6207842</span></div><div class="line">wt5    wt5 -<span class="number">8.771551</span> -<span class="number">1.5756187</span></div><div class="line">ko1    ko1  <span class="number">8.854899</span>  <span class="number">2.7689355</span></div><div class="line">ko2    ko2  <span class="number">8.976103</span> -<span class="number">1.7855946</span></div><div class="line">ko3    ko3  <span class="number">9.077341</span>  <span class="number">0.2534441</span></div><div class="line">ko4    ko4  <span class="number">8.767547</span>  <span class="number">1.2557291</span></div><div class="line">ko5    ko5  <span class="number">8.629953</span> -<span class="number">2.5202131</span></div></pre></td></tr></table></figure>
<p>接着使用<code>ggplot</code>绘图，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">ggplot(data=pca.data, aes(x=X, y=Y, label=Sample))+</div><div class="line">  geom_text() +</div><div class="line">  xlab(paste(<span class="string">"PC1 - "</span>, pca.var.per[<span class="number">1</span>], <span class="string">"%"</span>, sep=<span class="string">""</span>))+</div><div class="line">  ylab(paste(<span class="string">"PC2 - "</span>, pca.var.per[<span class="number">2</span>], <span class="string">"%"</span>, sep=<span class="string">""</span>))+</div><div class="line">  theme_bw()+</div><div class="line">  ggtitle(<span class="string">"My PCA Graph"</span>)</div></pre></td></tr></table></figure>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180626/l54JJhBI7L.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>从这个图形中，我们可以发现，X轴上标记了PC1所占总变异的比例为87.3%。Y轴上标记了PC2所占总变异的比例为3.4%。</p>
<h3 id="loading-scores计算">loading scores计算</h3>
<p><code>prcomp()</code>函数计算的结果中含有loading score，即<code>rotation</code>这一部分的内容，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">loading_score &lt;- pca$rotation[,<span class="number">1</span>]</div></pre></td></tr></table></figure>
<p>由于PC1占所了总变异的大部分，因此我们只需要看PC1中的loading score，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180626/7faBK23CJ5.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>由于loading_score有负数，因此我们需要用<code>abs()</code>函数取它们的绝对值，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180626/Gf8BL3GKkK.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>取完绝对值，对所有的loading score进行排序，从高到低，代码如下：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">gene_scores &lt;- abs(loading_score)</div><div class="line">gene_score_ranked &lt;- sort(gene_scores, decreasing = <span class="literal">TRUE</span>)</div></pre></td></tr></table></figure>
<p>此时，还要获排名前10的loading score基因的名称，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">top_10_genes &lt;- names(gene_score_ranked[<span class="number">1</span>:<span class="number">10</span>])</div><div class="line">top_10_genes</div></pre></td></tr></table></figure>
<p>结果如下：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&gt; top_10_genes &lt;- names(gene_score_ranked[<span class="number">1</span>:<span class="number">10</span>])</div><div class="line">&gt; top_10_genes</div><div class="line"> [<span class="number">1</span>] <span class="string">"gene10"</span> <span class="string">"gene98"</span> <span class="string">"gene34"</span> <span class="string">"gene94"</span> <span class="string">"gene95"</span> <span class="string">"gene99"</span> <span class="string">"gene76"</span> <span class="string">"gene47"</span> <span class="string">"gene49"</span></div><div class="line">[<span class="number">10</span>] <span class="string">"gene72"</span></div></pre></td></tr></table></figure>
<p>最后，我们看一下这些基因的loading score的数值，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pca$rotation[top_10_genes,<span class="number">1</span>]</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&gt; pca$rotation[top_10_genes,<span class="number">1</span>]</div><div class="line">    gene10     gene98     gene34     gene94     gene95     gene99     gene76     gene47 </div><div class="line"> <span class="number">0.1069736</span>  <span class="number">0.1069637</span>  <span class="number">0.1069535</span>  <span class="number">0.1069478</span> -<span class="number">0.1069281</span>  <span class="number">0.1069267</span>  <span class="number">0.1069243</span> -<span class="number">0.1069209</span> </div><div class="line">    gene49     gene72 </div><div class="line"> <span class="number">0.1069161</span>  <span class="number">0.1069037</span></div></pre></td></tr></table></figure>
<h2 id="python与pca">Python与PCA</h2>
<p>利用Python也可以进行PCA分析，在这一部分中，我们会介绍如何这些内容：</p>
<ol style="list-style-type: decimal">
<li>利用Python生成一些我们要分析的数据；</li>
<li>利用sklearn模块中的<code>PCA()</code>来进行分析，其中sklearn是scikit-learn的简称，它是一个机器学习的模块，支持包括分类、回归、降维和聚类四大机器学习算法。还包含了特征提取、数据处理和模型评估三大模块；</li>
<li>计算每个主成分占总变异的比例；</li>
<li>利用<code>matplotlib</code>来绘制PCA图；</li>
<li>计算变量的loading scores。</li>
</ol>
<p>如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180626/8elA2eKKg4.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h3 id="第一步导入各种函数与包">第一步，导入各种函数与包</h3>
<p>在进行PCA分析之前，Python需要导入各种包与函数，如果没有这些包，可以查一下如何下载，我使用的是Anaconda发行版，里面已经内置了各种有关数据分析的包，不用再下载各种包，直接导入即可，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd </div><div class="line"><span class="comment"># import pandas package,</span></div><div class="line"><span class="comment"># pandas is short for "panel data"</span></div><div class="line"></div><div class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</div><div class="line"><span class="comment"># numpy package will generate random numbers </span></div><div class="line"></div><div class="line"><span class="keyword">import</span> random <span class="keyword">as</span> rd</div><div class="line"><span class="comment"># random package will generate an example dataset</span></div><div class="line"></div><div class="line"><span class="keyword">from</span> sklearn.decomposition <span class="keyword">import</span> PCA</div><div class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> preprocessing</div><div class="line"><span class="comment"># usr a function PCA() from sklearn.decomposition </span></div><div class="line"><span class="comment"># PCA() use to perform PCA</span></div><div class="line"><span class="comment"># preprocessing uses to scaling the data before perform PCA</span></div><div class="line"></div><div class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</div><div class="line"><span class="comment"># draw PCA graphd</span></div></pre></td></tr></table></figure>
<h3 id="第二步生成模拟的数据">第二步：生成模拟的数据</h3>
<p>这一步与R中生成模拟数据集的目的一样，就是生成一个数据集，用于PCA分析，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">genes = [<span class="string">'gene'</span> + str(i) <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, <span class="number">101</span>)]</div><div class="line">wt = [<span class="string">'wt'</span> + str(i) <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">6</span>)]</div><div class="line">ko = [<span class="string">'ko'</span> + str(i) <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">6</span>)]</div><div class="line">data = pd.DataFrame(columns=[*wt, *ko], index=genes)</div><div class="line"><span class="keyword">for</span> gene <span class="keyword">in</span> data.index:</div><div class="line">    data.loc[gene, <span class="string">'wt1'</span>:<span class="string">'wt5'</span>] = np.random.poisson(lam=rd.randrange(<span class="number">10</span>,<span class="number">1000</span>),size=<span class="number">5</span>)</div><div class="line">    data.loc[gene, <span class="string">'ko1'</span>:<span class="string">'ko5'</span>] = np.random.poisson(lam=rd.randrange(<span class="number">10</span>,<span class="number">1000</span>),size=<span class="number">5</span>)</div><div class="line"></div><div class="line">print(data.head())</div><div class="line">print(data.shape)</div><div class="line"></div><div class="line"><span class="comment"># generate simulation dataset</span></div></pre></td></tr></table></figure>
<h3 id="第三进行pca分析">第三，进行PCA分析</h3>
<p>在进行PCA分析之前，先对数据进行中心化（我的理解是Z转换，转换后的数据均值是0，标准差是1），如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">scaled_data = preprocessing.scale(data.T)</div></pre></td></tr></table></figure>
<p>需要注意的是，上述代码中使用了<code>data.T</code>，这是对表达的数据集进行转换，将其行与列交换，跟R中类似。此处我们使用的<code>sklearn</code>包中的preprocessing函数，我们还可以使用另外的函数进行转换，就是<code>StandardScaler().fit_transform(data.T)</code>。第二个函数在机器学习使用更加广泛，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180626/j7GjkFFElH.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此外，我们需要注意的是，<code>sklearn</code>中利用<code>preprocessing.scale</code>计算变异与R中利用<code>scale()</code>和<code>prcomp()</code>计算变异的公式略有不同，区别就在于前者的分子是测量值的数目，后者是这个数目减1，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180626/BEImJbbGiD.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>后者的分子是测量值的数目减1，这会导致最终的结果变大，这是一种无偏含估计，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180626/5k7mi1iFc9.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>不过这两种方法都不影响PCA的分析，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180626/Jh9c6iL7DL.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>它的局限就在于，它们会对最终的绘图造成一定的影响，因为最终绘图中的坐标来源于scaled后的数值乘以loading scores，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180626/i7bjjhK2c7.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>继续Python计算PCA，此时我们要创建一个PCA对象，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pca = PCA()</div></pre></td></tr></table></figure>
<p>这里要提一下，PCA不仅是一个函数，能够返回计算结果，在sklearn中，它还用于创建一个对象，使用一个数据集进行训练，进行对另外一个数据集进行计算。不过在这里，我们只用PCA计算这个数据集（我们不涉及机器学习的环境设置），其他的步骤非常繁琐，但也由此，我们也能了解一下机器学习的内容，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180626/04e4bHIjgG.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>计算PCA的所有结果，例如loading scores和每个主成分的变量占总变异的比例，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pca.fit(scaled_data)</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&gt;&gt;&gt; pca.fit(scaled_data)</div><div class="line">PCA(copy=True, iterated_power=<span class="string">'auto'</span>, n_components=None, random_state=None,</div><div class="line">  svd_solver=<span class="string">'auto'</span>, tol=<span class="number">0.0</span>, whiten=False)</div></pre></td></tr></table></figure>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180626/806emi7L3i.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>接着，基于loading scores和scaled data来生成PCA图形中的坐标系，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pca_data = pca.transform(scaled_data)</div></pre></td></tr></table></figure>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180626/aJ2f7IF18C.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h3 id="第四绘图">第四，绘图</h3>
<p>首先，绘制一个碎石图（Scree plot），看一下应该使用多少个主成分比较合适，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">per_var = np.round(pca.explained_variance_ratio_*<span class="number">100</span>,decimals=<span class="number">1</span>)</div></pre></td></tr></table></figure>
<p>这段代码主要是用于计算每个主成分所占总变量的比例，接着添加坐标轴的标签，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">labels = [<span class="string">'PC'</span> + str(x) <span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">1</span>, len(per_var)+<span class="number">1</span>)]</div></pre></td></tr></table></figure>
<p>其次，使用<code>matplotlib</code>来绘制相应的图形，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"></div></pre></td></tr></table></figure>
<p>图形如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180626/2fH8g2cmaB.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>最后，我们绘制PCA图，我们使用<code>pd.DataFrame</code>函数把新的坐标系放到一个矩阵中来，它的行表示样本名称，列表示PC的标签，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pca_df = pd.DataFrame(pca_data, index=[*wt, *ko], columns=labels)</div></pre></td></tr></table></figure>
<p>继续绘制含有标题名与坐标标签的散点图，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">plt.scatter(pca_df.PC1,pca_df.PC2)</div><div class="line">plt.title(<span class="string">'My PCA Graph'</span>)</div><div class="line">plt.xlabel(<span class="string">'PC1 - &#123;0&#125;%'</span>.format(per_var[<span class="number">0</span>]))</div><div class="line">plt.ylabel(<span class="string">'PC2 - &#123;0&#125;%'</span>.format(per_var[<span class="number">1</span>]))</div></pre></td></tr></table></figure>
<p>最后，把样本名也添加上去，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">for</span> sample <span class="keyword">in</span> pca_df.index:</div><div class="line">    plt.annotate(sample, (pca_df.PC1.loc[sample],pca_df.PC2.loc[sample]))</div><div class="line"></div><div class="line">plt.show()</div></pre></td></tr></table></figure>
<p>最终的结果图如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180626/8iBd6gfDkL.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>从这张图中我们可以看到，wt组的数据集中在右侧，ko组都集中在了左侧。</p>
<h3 id="计算loading-score">计算loading score</h3>
<p>我们还可以计算一下PC1的loading scores，从而达珍哪些基因在不同的分类方面发挥了主要作用，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180626/5eJJh6DH56.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>首先，我们要创建一个pandas的series对象，这个对象用于计算loading scores，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">loading_scores = pd.Series(pca.components_[<span class="number">0</span>], index=genes)</div><div class="line"><span class="comment"># in python, first  number in index is 0, not 1</span></div><div class="line">sorted_loading_scores = loading_scores.abs().sort_values(ascending=<span class="keyword">False</span>)</div><div class="line"><span class="comment"># achieve absolute value using abs() function and sort them</span></div><div class="line">top_10_genes = sorted_loading_scores[<span class="number">0</span>:<span class="number">10</span>].index.values</div><div class="line">print(loading_scores[top_10_genes])</div></pre></td></tr></table></figure>
<p>最终结果如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(loading_scores[top_10_genes])</div><div class="line">gene31   <span class="number">-0.107133</span></div><div class="line">gene32    <span class="number">0.107131</span></div><div class="line">gene34    <span class="number">0.107070</span></div><div class="line">gene10   <span class="number">-0.107065</span></div><div class="line">gene45    <span class="number">0.107065</span></div><div class="line">gene28   <span class="number">-0.107064</span></div><div class="line">gene30   <span class="number">-0.107062</span></div><div class="line">gene39    <span class="number">0.107053</span></div><div class="line">gene93   <span class="number">-0.107041</span></div><div class="line">gene79    <span class="number">0.107036</span></div><div class="line">dtype: float64s</div></pre></td></tr></table></figure>
<p>计算结束。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2018/06/22/BioStatistics/生物统计-StatQuest学习笔记13-LDA/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/06/22/BioStatistics/生物统计-StatQuest学习笔记13-LDA/" itemprop="url">StatQuest学习笔记13——LDA</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-06-22T12:10:54+08:00">
                2018-06-22
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/生物统计/" itemprop="url" rel="index">
                    <span itemprop="name">生物统计</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  2,606
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  9
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="前言主要内容">前言——主要内容</h2>
<p>这篇笔记是StatQuest系列视频教程的第38小节，在此备注一下，在StatQuest系列视频中，从38小节到57小节是机器学习方面的内容。第38小节的内容是LDA，全称是Linear Discriminant Analysis，中文翻译为线性判别分析，这种方法能够对一些数据进行分类，对数据分类的其它方法还是PCA，t-SNE，SVM。</p>
<h2 id="lda简介">LDA简介</h2>
<p>我们先来看一个场景。</p>
<p>例如，我们开发了一种抗肿瘤药物，这个药物对于某些患者的治疗效果很好，但是对某些患者则有很大的副作用。此时，我们就面临了一个问题，这些药物如何给患者吃？</p>
<p>对于这样的问题，一个简单的解决思路就是，我们把这两类患者（一类药物有效的患者，一类药物有副作用的患者）的基因检测一下，或许他们的基因表达能够为我们合理用药提供决策依据，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180622/IlcGJJBC87.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>由于患者表达的基因很多，我们先从最简单的一个基因X谈起。我们以基因X的转录水平为依据，观察基因X在这两类患者体内的转录情况，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180622/LDLGC2iim0.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>其中，绿色的点表示患者的基因X转录水平比较低，药物疗效好；红点表示患者的基因X转录水平高，药物疗效差。对于左侧的大部分患者来说，确实如此，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180622/egfJe4JiKk.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>但是，让人比较纠结的是，中间这些患者，他们的基因X转录水平处于中间水平，药物效果也不明，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180622/JFi4EA5E8K.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>如果不考虑患者的基因X转录的中间水平，也不考虑药物对这些患者的治疗情况，总体上来说，仅基因X还是能够为我们提供一定的决策依据的，虽然它也不是特别完美。</p>
<p>但是，如果我们想要更好地区分哪些患者服用药物，哪些患者不服用药物，怎么办？</p>
<p>其实这个里，可以再加入一个基因，看一下两个基因能否更好地为选择患者使用药物提供依据，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180622/JB2I1DiiJ5.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>我们再找的这个基因暂且把它称为基因Y，把这两个基因放到坐标轴上，我们可以发现，用一条虚线可以比较好地把这两类患者划分开，如下所示：<img src="http://ortxpw68f.bkt.clouddn.com/professional/180622/c399GFIG2A.png?imageslim" alt="mark"></p>
<p>此时，我们还可以再进一步，用3个基因看一下，效果会不会更好，此时我们把这第3个基因暂且叫做基因Z，此时就变成了三维的坐标系，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180622/KfJA6ja8KL.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>上面的这个坐标系是三维的，其中我们发现有的点大，有的点小，这个好理解，比较小的点离我们比较远，大的点离我们比较近，此时我们可以通过一个平面把这两类患者分开，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180622/H0cbfmHf5e.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>那我们再进一步，能否用4个基因把这两类患者区分开来？如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180622/lFCCF5e3Gi.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>不过问题是，我们无法直观地绘制出四维坐标，只能靠想了。如果我们学过PCA，那我们就会想到，此时我们面临的问题与PCA分析的问题比较类似（下一篇笔记会讲PCA）。</p>
<p>PCA主要是通过找出哪些变异最大的基因来实现降维的，当我们有多维数据时，使用PCA能够很方便地将多维数据降为三维或二维数据（例如绘制成XY散点图）。但是，我们在这个案例中，我们对哪些变异大的基因没兴趣，相反我们使用LDA时，所关注的是怎么能够最大程度地把这两类患者分开，为我们的给药提供决策依据。LDA虽然与PCA有点类似，但是LDA是对已知分类进行最大程度的区分，而PCA则是对未知分类进行降维，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180622/680bE634eH.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>再来看一下最后一段话，它讲的是LDA与PCA的区别，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180622/g0GkdJEHcK.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>为了更深入地理解LDA与PCA，可以搜索一些有关有监督学习和无监督学习的资料看一下。</p>
<h2 id="一个简单的案例">一个简单的案例</h2>
<p>在这个案例中，我们还是以前面的案例为基础，将2维的坐标（X基因与Y基因构成的坐标）降为1维的坐标，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180622/59BaCbF8HK.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>那么此时问题来了，我们怎么去降维？</p>
<p>首先，看一个简单粗暴的降维方法，我们不要基因Y，只要基因X，直接把它们投射到X轴上，这就像有一个压力，从上到下，直接把Y轴拍扁一样，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180622/Jb728cH961.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>这种方法非常粗糙，它无法区分出这两类患者，因为它忽略了基因Y提供的有用信息，如果我们忽略基因X，把所有的点投射到Y轴，也是如此，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180622/iGld1997cL.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时，我们就可以使用LDA这种方法，把二维坐标降为一维坐标的同时，还能同时保留基因Y与基因X的信息，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180622/8KCCGE2C44.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>LDA会计算出一个新的坐标轴，然后将所有的点都投射到这个新的坐标轴上去，并能够很好地把这两类患者进行区分，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180622/gGiedI0EG8.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>结果就是像这样：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180622/cc8hh7kfkj.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时又有问题了，LDA是如何做到的？</p>
<h2 id="lda的原理">LDA的原理</h2>
<p>LDA生成的这个新坐标轴要同时满足两个标准：</p>
<p>第一，两类患者的均值要足够远（也就是下图中分子要尽量大）；</p>
<p>第二，两类患者的变异要小（下图中分母尽量小），如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180622/hGCeBbllG1.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>通常，我们会将两个分类的均值差的平方称为<code>d</code>，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180622/7cmFm0h1hD.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>再看一个案例，这个案例主要用于说明两个分类的均值距离与散点（就是标准差）的重要性，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180622/H8EI5kmeBL.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>在上面的这个案例中，我们发现，从x轴的角度来看，这两类数据有部分重合，如果我们只考虑这两类数据均值之间的距离的话，当这个距离最大时，那么新生成的坐标轴就像下图中右上的角的样子，它的区分度不太好，中间有两个数据是重叠的，如果我们即考虑均值距离又考虑数据点的离散程度，那么我们新生成的坐标轴，让这两类数据投射到上去，就会得到很好的区分，如下图右图下的样子：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180622/LEmd6efAf2.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>如果我们有超过2个基因（也就是超过2维的数据）时，处理这些数据的方法还是相同的，创建的新坐标轴要使得这两类数据的均值距离最大，同时使数据点的离散程度最小，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180622/74aeLaGji2.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>我们看一下LDA处理3个基因的情况，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180622/kCf730fam2.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>上图中的新坐标轴就是通过LDA方法创建的，此时，将所有的数据都投射到这个坐标轴上，它们的区分度就很好了，即保证了两类数据均值的间距最大，又最大程度地降低了数据的变异程度，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180622/e8L0FlcDJ3.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h2 id="复杂情况">复杂情况</h2>
<p>如果我们有3个分类，就像下面的这个样子，我们有3个分类，只有2个基因，如何做？</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180622/KAJAjjBKd0.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>首选，我们要计算第一差分（first difference），它是一个点，这个点是所有点的中心，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180622/5F5d2H4aII.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>然后计算这个点与3个分类的中心的点（不太理解这个中心点是均值，还是中位数）的距离，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180622/G83hI1LjjC.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时，再保证这三个距离最大，同时保证这三个分类投射到新的坐标轴上的点的离散程度最小，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180622/dl1GAKKH4D.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>换成公式就是下面的样子：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180622/h8FH9alcGj.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>这个公式与前面的基本上一样，唯一的区别就是多了一个新的分类。接着，我们要找第二差分（second difference），这是LDA要创建的用于区分数据的2个坐标轴，这是因为三个分类的3个中心点能够定义一个平面，此时，我们绘制出两条线（也就是新的坐标系）来优化对这三个分类的分类，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180622/cHlGbGcC13.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>由于我们只使用了2个基因，因此绘制这个新坐标系很容易，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180622/6IBf8Bcal7.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>但是，如果我们有10000个基因的话，就意味着我们需要把这10000维降为两组，由于我们前面提到过，用2维坐标就能区分出3个分类，那么，我们如果有10000个基因，也能把它们降为2维的话，就很不错了，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180622/C2mgJCbB56.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>下图是用LDA实现的降维结果，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180622/GIEdcdD2HA.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>虽然这种降维还不是太完美，很容易发现有一些分类还存在重叠，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180622/d4c63bFdKc.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>但是，我们比较一下LDA和PCA的降维效果，显然LDA已经做得更好一些了，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180622/2JiAGh7061.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时，我们再来看一下PCA与LDA的相似性。</p>
<p>第一，在新的坐标轴上，它们都是按重要性进行排序的。其中PC1（PCA创建的第1个新坐标轴）能解释数据的最大变异，PC2（第2个新坐标轴）能解释数据次大的变异。而在LDA中，LD1（LDA创建的第1个坐标轴）能解释分类之间的最大变异，而LD2其次解释次大的变异。</p>
<p>第二，这两种方法都能够让你更观察哪些基因参与了分类，并形成了新的坐标，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180622/AAG6JDGLd6.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h2 id="总结">总结</h2>
<p>LDA类似PCA，它们都是降维方法。PCA研究的是某个变量（这里指的是基因）的最大变异。LDA则是用这些变量（这里指的是基因）能够更大程度地区分已知分类。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2018/06/18/BioStatistics/生物统计-StatQuest学习笔记12-FDR及实现/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/06/18/BioStatistics/生物统计-StatQuest学习笔记12-FDR及实现/" itemprop="url">StatQuest学习笔记12——FDR及实现</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-06-18T12:10:54+08:00">
                2018-06-18
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/生物统计/" itemprop="url" rel="index">
                    <span itemprop="name">生物统计</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  3,340
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  12
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>这些笔记有十几篇，都在我的公众号里，公众号一天只能发一篇，我会陆续地把笔记分享出来。</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180628/KBCl415g2k.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h2 id="前言">前言</h2>
<p>这篇笔记是StatQuest系列视频教程的第36节，主要内容是有关FDR的。</p>
<h2 id="什么是fdr">什么是FDR</h2>
<p>FDR的全称是false discovery rates。我们在做高通量测序的时候，或许听说过这个术语，但是FDR是如何来的呢，它是如何计算的呢，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180622/LF6i8CcGAJ.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>在讨论FDR的原理之前，我们就以大白话的形式来说一下FDR，FDR就是一种工具，它用来发现那些看起来貌似比较好的数据，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180622/fLjBDc2iBl.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>现在我们看一个案例，在下面的图形中，x轴是样本分组，y轴是基因x的Reads数，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180622/BFK27glKih.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>同理，RNA-seq并非完美无缺，每次测序，总会出现一定的偏差，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180622/Ehelh7gJ0f.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>当我们测序了许多次后，把它们放到一个坐标中，我们可以发现，它们都比较接近于平均水平，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180622/aCkBamI4Ie.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>但是，在个别情况下，样本的数据会高于均值很多，或者是低于均值很多，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180622/BCC4g8hmHd.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>我们可以把这些数据放到正态分布曲线中，其中大多数都位于中间区域，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180622/I0gakEe91L.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>而那些数据比较大的值可能位于曲线的右侧，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180622/c6lg9AEJfh.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>数据量比较低的可能位于最左侧，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180622/ebEdlKFAg0.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>假如我们做了3只小鼠的测序，把这3只小鼠当作是样本1（Sample #1），如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180622/aFK5iAcmj8.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>那么样本1在多数情况下，都位于正态分布的中间区域，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180622/2jg7ccE40a.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时，我们将样本1与来源于另外3只正常的“野生型”小鼠进行比较，就是下面红线表示的3只小鼠（称为样本2），如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180622/e33laBHAF0.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>样本2的小鼠也基本上位于正态分布曲线的中间区域，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180622/1H5Fa2iIGL.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>如果我们对样本1和样本2做个t检验，那么有很大的可能是它们的p值很大，因为样本1和样本2有部分重合，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180622/C19kdbB5D2.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>但是，在个别情况下，这两个样本做2个t检验，p值有可能很小，小于0.05，此时这种现象就被称为“假阳性”，因为一个小的p值预示着这两个样本来源于2种不同品系的小鼠（也就是说来源于两个不同的分布），但实际上这两个样本是来源一个相同的分布，因此得到的结论是假的，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180622/Jml31c2a1a.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>通常来讲，假阳性这种情况很少，除非你被p值挟持（后文会提到）了，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180622/fk2cBdiLID.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>95%的情况下，源于同一个分布的不同的样本会出现重合，但在5%的情况下，样本并不重合，但是，人和小鼠细胞有至少10000个转录的基因，如果是来源于相同小鼠的2个样本，然后我们比较这所有的10000个基因的话，可能有500个假阳性结果，这就比较尴尬了，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180622/JmD4ahmJF0.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>500个假阳性结果不是一个小数字，如何解决这个问题？如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180622/1lhIgH2bC5.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h2 id="fdr的基本思想">FDR的基本思想</h2>
<p>FDR就能控制假阳性结果的数目，从技术层面来讲，FDR并不是一种具体的限制假阳性结果的方法，很多种算法都可以计算FDR，常用的就是Benjamini-Hochberg法。在我们讲这个方法之前，我们来看一下这个方法的基本思想是什么，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180622/8c6i3kd6GG.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h3 id="同一分布的p值计算">同一分布的p值计算</h3>
<p>此时我们先从同一个分布中，随机生成10000对样本（样本1和样本2），然后计算这10000个p值，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180622/12l5EKIh0g.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>然后将这些p值绘制成直方图，其中横坐标是p值的大小，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180622/0HkAgKlbbB.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>纵坐标是p值的数目，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180622/6h5LdiBCAg.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>我们看直方图的第1列，也就是下图红色的部分，有510个p值（5.1%）小于0.05，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180622/c7AAaDkDC9.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>再看第2列，有差不多数目的p值大于0.05，小于0.1，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180622/aHeaaf4fbe.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>事实上，每1列的数目基本上都接近于500（也就是5%的总体数目），如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180622/3kglIH43E7.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>由于p值的分布都比较均匀，因此在这10000个样本对（样本1和样本2）中，检验结果得到的p值落到每个区间的可能性基本上都是一样的，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180622/g1E0B9JghA.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h3 id="不同分布样本的p值">不同分布样本的p值</h3>
<p>前面讲的是，10000个来源于相同分布的样本对（样本1和样本2），此时我们研究一下，如果这两个样本来源于不同的分布是什么情况，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180622/3gHikF827F.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>然后我们将这10000个p值绘制成直方图，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180622/lcIlJ4F3j9.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>其中大部分的p值都是小于0.05的，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180622/0kfFgfi8hG.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>其中p值大于0.05的是假阳性的数目，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180622/3D1h45EJ6m.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>现在总结一下这两个案例：</p>
<p>第一，如果样本来源于同一个分布，那么p值分布比较均值；</p>
<p>第二，如果样本是来源于不同的分布，那么p值的分布就不太均值，它们主要偏向于0，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180622/hJ5mB6kFde.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h3 id="生物学案例">生物学案例</h3>
<p>此时，我们来看一个生物学方面的案例，在这个案例中，我们用某个药物处理神经细胞，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180622/i5a225ikBi.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>这个药物或许能够影响1000个基因，然后我们可以认为对照组与实验组各自的1000个基因来源于两个不同的分布，其中黑色的表示对照组，红色表示实验组，由于这两个分布不同，那么来源于这两个样本的统计结果的p值直方图会偏向于0，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180622/gmFE0fAAlk.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>而剩余的9000个基因（前面我们提到过动物细胞转录的基因至少有10000个）可许并不受这个药物的影响，这就意味着，对照组与实验中的各自的9000个基因来源于相同的分布，那么它们的p值分布就比较均匀了，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180622/0G3BlFbGgj.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>那么，最终我们检测的实验组与对照组的这所有的10000个基因就是来源于不同分布的1000个基因与来源于相同分布的9000个基因的总和，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180622/J688h9aELB.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>来源于相同分布的基因的p值并不受药物影响，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180622/kDcljG70kG.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>而左侧直方图的区间则是混合了那些药物影响的基因和不影响的基因，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180622/40JBebi597.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>仅凭肉眼观察，我们就可以大概看到哪些p值是均匀分布的，以前它们所做的检验数目，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180622/e057icfh98.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>我们把这条红线延伸，把它作为一个阈值，从而找到“真阳性”，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180622/67L9bcbJ0h.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>我们使用的p值的阈值通常是0.05，此时我们主要看这些p值（蓝色部分），如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180622/c3HfKDd9Kh.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>其中我们可以发现，红色虚线以上的p值小于0.05的数目大概是450个，以下的数目上大概也是450个，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180622/BkGDCJ7JJG.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>一种从假阳性中分离真阳性的途径就是只考虑最小的450个p值（我的理解就是只考虑最左侧的那个区间），如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180622/IED429dkK6.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>这种方法计算的结果通常不错，因为大多数都位于这个区间p值都是那些基因受到药物影响的基因，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180622/mBjChbbcIG.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>那些不受药物影响的基因p值通常都是均值分布的，将它们接近的均值（就是前面的红色虚线）平稳地延伸，就可以计算出真阳性，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180622/aajamIiChF.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h2 id="bh法">BH法</h2>
<h3 id="bh法简介">BH法简介</h3>
<p>如果你理解了上述的一些基本思想，那么此时我们来看一下FDR更多的细节与Benjamini-Hochberg法（简称BH法），如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180622/E23FKh6J52.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>BH法是基于“肉眼法”（eyeball）（也就是我们用肉眼来观察），这种方法能够校正ｐ值，从而限制那些所谓的有显著差异的p值的假阳性数目，校正的p值会让p值变得更大，例如在进行FDR校正之前，你的p值是0.05（有显著性），经过FDR校正，p值有可能变成0.06了（不再有显著性），如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180622/0EiJj4kkmH.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>如果你选择的阈值是FDR&lt;0.05，然后在那些“显著性”结果中，有大概不到5%的结果会成为假阳性，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180622/DJf90Ce3ag.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>在下图中，这些基因的统计结果p值是小于0.05的，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180622/6jJ8kBjDIA.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>下面是那些经过FDR校正后的p值小于0.05的数目，我们需要注意的是，并非所有的“真阳性”基因都位于这个方框中，并且，在这个方框中，只有5%的经过校正的p值是假性，剩余的95%是真阳性，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180622/mF56bH0gaE.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时有一个疑问，为什么并非所有的真阳性基因的校正p值都小于0.05？因此并非所有的真阳性基因都有一个非常小的p值，在下图的左下角是p值小于0.05的真阳性基因的直方图，在直方图的右侧，有一部分基因经过校正后，它们的p值不再有显著性，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180622/m12licJ39e.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h3 id="bh法的数学原理">BH法的数学原理</h3>
<p>BH法背后的数学原理比较简单，我们先看一个简单的案例。</p>
<p>假如有10对样本（样本1和样本2）来源于同一个分布（例如前面不受药物影响的10个基因），我计算一下它们的p值，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180622/Llh4Ljk1A7.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时，我们把p值从小到大排列，最小的p值是0.01，它明显是一个假阳性，此时我们看一下BH法是如何处理这种情况，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180622/702dCmE3A9.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时我们对这10个p值进行编号，分别编号为1到10，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180622/14chIHDgEK.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>现在给这些p值校正的结果留下相应的位置，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180622/kAe7He86Kh.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>经校正后，我们把校正后的最大的p值放到第10个新位置，通常还是原来最大的p值，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180622/JfAkbA34lI.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>接着，我们在第9个位置放校正后的次大的p值（也就是第二大的p值），关于这个p值如何校正呢，它需要2个参数，第1个参数就是总的p值数目，在这个案例中，总的p值数目是10，第二个参数是要校正的p值的秩（也就是这个p值在这10个p值中按从小到大排列，它排第几），在这个案例中，0.81这个p值的秩是9，那么校正的公式就是总的p值数目除以要校正的p值的秩，然后再乘以这个p值的大小，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180622/Jd2gjCljI3.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>经计算，p值为0.81，校正后的结果为0.9，计算过程如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180622/hKJiA6iLgl.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时再看第8个位置的校正p值，还按上面的公式进行计算，p值为0.71，经校正后就是0.89，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180622/l9g9J0Cj74.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>所有的p值都按此方法进行校正，结果如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180622/jDI6h17B7l.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>从上面的结果来看，原来是0.01的这个p值经校正后，它的p值是0.中，原来是阳性，现在就不是阳性了，不再具备显著性。</p>
<h3 id="一个复杂案例">一个复杂案例</h3>
<p>此时，我们再看一个比较复杂的案例，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180622/j4G9Hj2Eg7.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>其中蓝色部分有可能来源于不同的分布（因为它们的p值小于0.05），也就是说，来源于那些能够被药物影响的基因，而红色的部分有可能是来源于相同的分布（因为它们的p值多数都大于0.05），也就是说，红色的来源于那些无法被药物影响的基因，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180622/EeejFmjGeH.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时绘制蓝色样本的正方图，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180622/6ld74b3fKi.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>红色是来源于相同的分布，但我们从中可以发现，它里面有几个假阳性，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180622/hiCAd6jdae.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>通过肉眼法（eyeball method），我们绘制一条这些分布的虚线，并把这些虚线延伸到最左侧，找到真阳性的结果，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180622/Efje0j1fI1.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>红色虚线以上的部分就是我们利用“肉眼”法找到的真阳性结果，此时我们看一下如何通过BH来找真阳性，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180622/3D8GfHIAAj.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>通过前面我们提到的方法对这些p值进行校正，校正后的结果如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180622/I2g8H143fJ.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>我们可以发现，那些假阳性的p值经校正后，它们都大于0.05了，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180622/g9k8H116EJ.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>但真阳性的p值还在0.05以下，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180622/ALBAhm2b8b.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2018/06/12/BioStatistics/生物统计-StatQuest学习笔记11-p值详解/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/06/12/BioStatistics/生物统计-StatQuest学习笔记11-p值详解/" itemprop="url">StatQuest学习笔记11——p值详解</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-06-12T12:10:54+08:00">
                2018-06-12
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/生物统计/" itemprop="url" rel="index">
                    <span itemprop="name">生物统计</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  8,157
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  29
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="前言">前言</h2>
<p>这篇笔记主要是讲p值的，它是StatQuest视频教程的第33节，第34节，第35节，第37节的内容（跳过36是因为36讲的是FDR，专门写一篇笔记）。其中第33节的内容为什么是p值，p值的计算；第34节的内容是单尾检测与双尾检验，第35节的内容是作者直接以视频形式进行的讲解，内容是关于p值的阈值，无课件，略去；第37节的内容是p值挟持（p-hacking）与功效检验（power）。</p>
<h2 id="什么是概率">什么是概率</h2>
<p>人们通常认为，p值的意思就是概率（probability），p值与概率确实有关，但是它们并不相同，我们先看一个简单的例子。</p>
<p>我们抛两次硬币，第1次，正面朝上的概率是50%，反面朝上的概率是50%。第2次，正面朝上的概率还是50%，反面朝上的概率还是50%，此时我们提出两个问题；</p>
<ol style="list-style-type: decimal">
<li>连续抛2次硬币，出现2次正面朝上的概率是多少？</li>
<li>连续抛2次硬币，出现2次正面朝上的这个事件的p值是多少？如下所示：</li>
</ol>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180615/kaaGfac4EH.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>先看第1个问题，出现2次正面朝上的概率是多少，为了方便讲解，我们用H（head）表示正面，用T表示反面（Tails），抛2次硬币，会出现4个结果，分别为：</p>
<p>结果1：第1次正面，第2次正面；</p>
<p>结果2：第1次正面，第2次反面；</p>
<p>结果3：第1次反面，第2次正面；</p>
<p>结果4：第1次反面，第2次反面，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180615/c0lBGmg8eC.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>这4结果出现的概率上是相等的，我们的计算过程如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180615/c38i8bEChE.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时，我们就知道了，出现2次正面朝上的概率是0.25。此时我们再看一下出现2次反面朝上的概率，计算过程如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180622/3dg6l6DlgE.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时的结果也是0.25，它与2次正面朝上的概率是一样的。此时我们再计算一下，抛2次硬币，1次正面朝上，一次反面朝上的概率，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180618/9bb673aGcf.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>一面朝上，一面朝下的概率是0.5。在这个案例中，我们并没有考虑正面与反面的顺序，为什么不考虑呢？因为通常来说，我们所说的，抛两次，一面朝上，一面朝下，就包括第1次正面朝上，第2次反面朝上和第1次反面朝上，第2次正面朝上这两种情况，并且它们之间互不影响。例如我们在研究小鼠的体重时，有2只小鼠，先测哪只小鼠的体重都可以，两只小鼠的体重互不影响，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180618/kil19mDLC3.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h2 id="一个生物学的案例">一个生物学的案例</h2>
<p>我们假设H（红色）是一个等位基因，T（蓝色）是另外一个等位基因。在下面的图片中，分别是一对夫妇的等基因情况，他们是杂合子，其中母亲的等位基因情况是HT，父亲的等位基因也是HT，那么他们后代中基因为HH的概率是0.25，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180618/ld7chjk05A.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>如果母亲是纯合子（homozygote），父亲是杂合子（heterozygote），那么他们后代中出现HH的概率则是0.5，计算过程如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180618/1eBHCji88L.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h2 id="什么是p值">什么是p值</h2>
<p>p值就是生成某数据的随机机率（random chance），或者说是跟这个随机机率相同或者是更小机率的值，原文如下所示：</p>
<blockquote>
<p>a p-value is the probability that random chance generated the data, or something else that is equal or rarer。</p>
</blockquote>
<p>现在把这段话拆成3个部分，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180618/ki1AK29jaD.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>第一部分：<code>a p-value is the probability that random chance generated the data</code>。</p>
<p>这句话是讲，p值是你所观察到的，能够随机生成这些数据的概率。在上面的这个案例中，就是0.25，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180618/K7b1k4JcJi.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>第二部分：<code>or something else that is equal</code>。这句话是讲，跟得到这个结果相同的概率的事件，在上面的这个案例中，就是说TT的概率与HH的概率是相同的，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180618/bk4CDLEI6g.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>计算一下，这个概率是0.25，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180618/I61LjImiKI.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>第三部分：<code>or rarer</code>，这个意思是说，出现某个更小概率的事件，由于在前面的案例中，没有其它的事件，因此这一部分就是0，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180618/7c04LHDGeI.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>综上可知， HH的p值为0.5，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180618/8Hmcj0feFF.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>现在总结一下这个案例：</p>
<p>HH的概率是0.25，而HH的p值为0.5，这两个值不相同，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180618/eI1cKEhbjb.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h2 id="一个稍微复杂的案例">一个稍微复杂的案例</h2>
<p>这里再介绍一个稍微复杂的案例，这个案例还是以硬币为例进行说明，在这个案例中，我们抛5次硬币，求一下每次都是正面朝上的概率，那么它的公式就是如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180618/FgaBgjd5gH.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>我们画出这5次的所有可能结果（话统计学术语叫样本空间），如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180618/j7Ji6eFHd6.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>其中连续5个H（就是5次正面朝上）就是我们感兴趣的事件，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180618/6GLeCJjIb9.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>如果是4次正面朝上，就是下面的这个样子：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180618/BjhDjF10m9.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>如果是3次正面，2次反面，就是这个样子：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180618/e1i4I9ekeb.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>如果是3次反面，2次正面，就是这个样子：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180618/mEBc6kIHkB.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>其余的就不列出了。最终的事件是32个，那么其中5次都是正面朝上的事件只有1个，它的概率就是1/32，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180618/26Lfdk256g.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>经计算可得<code>1/32=0.03125</code>，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180618/jEBFDhAC8k.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时我们计算一下5次正面朝上的p值，关于p值的定义，我们再回顾一下前面的定义：</p>
<blockquote>
<p>a p-value is the probability that random chance generated the data, or something else that is equal or rarer.</p>
</blockquote>
<p>而在这个案例中，没有比5次正面朝上更小的事件了，因此我们可以忽略<code>or rarer</code>事件，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180618/b6cAC5bGJB.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>那么，在这个案例中，p值是随机产生这些事件的概率或者是与同样产生该概率的事件，那么此时出现5次正面朝上的概率就是<code>1/32</code>，再加上同样产生该概率的其它事件，也就是5次反面朝上的概率，也是<code>1/32</code>，那么加起来就是<code>1/32</code>+<code>1/32</code>，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180618/FdBa4E0gAk.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>最终的结果是，p值为0.0625。</p>
<p>此时我们再计算一种情况，即得到4次正在朝上与1次反面朝上的概率，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180618/1FLLFcFKGK.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>经计算可得<code>5/32=0.15625</code>，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180618/EeL99Ch8Fa.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>那么我们此时计算一下它的概率（4次正面朝上，1次反面朝上），我们再回顾一下p值的定义：</p>
<blockquote>
<p>a p-value is the probability that random chance generated the data, or something else that is equal or rarer.</p>
</blockquote>
<p>根据定义，p值是由3部分构成的：</p>
<p>第1部分：随机产生这个事件的概率；</p>
<p>第2部分：产生与该事件相同概率的其他事件；</p>
<p>第3部分：产生比该事件的概率更小的事件。</p>
<p>由于比4次正面朝上，1次反面朝上更小的概率是5次都是正面，或5次都是反面朝上，那么4次正面朝上，1次反面朝上的p值需要加上5次都正面或5次都反面的概率，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180618/iHl3eJD6bK.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>因此最终的p值计算结果就是下面的这个公式：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180618/ekl5GBi81l.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>计算的结果为0.375，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180618/9lCcLbKHJg.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h2 id="连续型变量的p值">连续型变量的p值</h2>
<p>抛硬币数正面与反面的这种数据我们可以称它们为离散型数据（例如结果中只能是1，2，3，4，5，不可能是1.1，3.145），但还有一类数据，例如身高，可以是175.2，174.3，也可以是174.456，它们带有小数点，可以表示连续型的数据（连续型的数据我的理解是可以无限划分，例如身高可以说是176.5，也可以是176.666，但硬币抛5次，你不能说有1次是1.1次正面朝上，3.145次正面朝上），它们是连续型数据变量。对于抛硬币，我们可以列出所有的5次硬币抛后的结果，但是，对于身高这种概率，如何计算呢，先列出来吗？如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180618/FHGKcB0JeH.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>如果是这样的话，那么我们如何处理小数点后面的数字呢，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180618/kAbDcgkgm4.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>对于这类数据，我们可以用一种“密度”（density）来替代它们，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180618/06jm8f0AHI.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>例如，我们下面的这个数据，这批数据是1996年，巴西女性15岁到49岁之间的身高数据：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180618/c7BAG1gCIi.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>这个曲线下的面积，也就是说红色部分表示了一个人的身高在这个范围内的概率，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180618/lFgLE4hIa3.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>其中，142cm到169cm这个范围在曲线下的面积是95%，换句话讲，如果我们每次测量一个人的身高，它们有95%的可能性在142cm到169cm之间，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180618/9J1aGLiaG6.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>继续看看这个案例，大于169cm的范围与曲线所围成的面积是2.5%，这也就是说，如果我们测量一个巴西的女性，它有2.5%的概率身高高于169cm，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180618/98cAekmj9F.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>同时，小于142cm的范围与曲线围成的面积是2.5%，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180618/kfLJH4lALL.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>为了计算p值，我们需要把曲线下的面积加起来，还是按照前面p值的定义，再来回顾一下：</p>
<blockquote>
<p>a p-value is the probability that random chance generated the data, or something else that is equal or rarer.</p>
</blockquote>
<p>也就是说，p值是得到该事件的概率，以及与出现相同概率事件的概率，以及比该事件的概率还要小的事件的概率的之和，也就是说p值是由3部分构成的（前面已经说过了）。</p>
<p>例如我们要计算某些人身高是142cm的p值，那么它的p值就是低于142cm的概率加上大于169cm的概率，下图就是低于142cm的概率：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180618/kB173ALLkb.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>再加上身高大于169cm的概率（2.5%），最终的p值就是0.05，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180618/eeaAIea80m.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>再继续看这个案例，我们此时计算一下身高在155.4到156cm之间的人的概率，由于这两个数字之间只差0.04，那么代表这个范围的身高的人的概率，也就是说它们的曲线下面积基本就相当于一条红线了，非常窄，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180618/G493jjJal4.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>上图显示的红色只是大于155.4，小于156身高的人的概率（注意，这里是概率，是probability，不是p值）。</p>
<p>此时我们再计算一个身高范围是155.4到156之间的人的p值，根据定义，还是如下所示：</p>
<blockquote>
<p>a p-value is the probability that random chance generated the data, or something else that is equal or rarer</p>
</blockquote>
<p>p值是由3部分构成的（前面已经讲过），分别是①某事件的概率，加上②与该事件相同概率的事件的概率，再加上③比该事件概率更小的事件的概率。我们分两步来计算p值，如下所示（需要注意的是，155.4与156正好位于正态分布曲线均值的两侧，因此小于155.4身高的人的概率与大于156身高的人的概率是相同的）：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180618/J5kDijAiiI.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>第一步：计算小于155.4cm身高的人的概率，下图的红色面积就是身高小于155.4cm的人的概率，它的值是48%，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180618/E004FCLcg3.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>第二步：计算身高大于156cm的人的概率，就是下面右侧红色的面积，也是48%，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180618/GHkc39Em1j.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>那么，身高位于155.4和156之间的人的概率就是4%，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180618/hEl61cDLg5.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>根据p值的定义，那么p值就等于<code>48%+48%+4%=100%，</code>，也就是说p值是1，这是一个非常大的数字，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180618/GC3Ig1hhBl.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>在这个案例中，我们知道了，155.4到156身高之间的人的概率是4%，但它的p值很大，是1。</p>
<h2 id="单尾检验与双尾检验">单尾检验与双尾检验</h2>
<p>现在考虑一个场景，你是一名医生，你现在开发了一种新型的癌症治疗方案，你希望你的这种新型治疗方案比标准的治疗方案要好，你做了一个小型临床实验，样本是6个病人，以下是数据：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180618/Lmj7egAlGB.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>其中红点表示新型治疗方案，黑点表示标准治疗方案，数轴表示从好到差。我们可以发现新型的治疗方案貌似比标准的治疗方案要好，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180618/09CIFg7dLD.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>但是，中间貌似有一个黑点（也就是标准治疗方案）处于中间位置，不知道是好，还是差，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180618/g6gEgj4cFF.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>然后你进行了统计，选择了单尾检验，p值为0.03，这个p值是小于0.05的，也就是说这种新型治疗方案有统计学意义，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180618/CBi8Cl0IHh.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>但是，当你选择了双尾检验时，发现p值为0.06，它又是大于0.05的，没有统计学差异，此时，你选择使用哪个p值？如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180618/h43aJ344b9.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>这里要说一下，单尾检验（one-tailed）的假设是你的新型方案比标准方案要好，而双尾检验的假设是新型方案比标准方案要好，也有可能更差，或者是说没有统计学差异。而单尾检验的p值更小这是因为单尾检验并没有区分“更差”与“没有统计学差异”这两种结果，它的假设是新型方案比标准方案要好。由于我们想知道这个新型方案是否比标准方案更差（因为一个方案出来，你根本不清楚它比原来的是好，还是坏），此时我们就需要使用“双尾检验”，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180619/5Gm0I8fmeB.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>我们再来看一下这个临床试验的数据，由于这个新的方案更加偏向于好的治疗效果，这是不是意味着我们并不需要检验新型方案比标准方案更差？</p>
<p>其实不是的，优良的统计学习惯意味着在我们开始实验之前，我们需要了解我们要使用什么统计学方法，以及如何对p值进行取舍。否则的话，我们就会被p值挟持（p=hacking），这就会增加我们实验报告中假阳性的概率，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180619/4HllgJ2a9I.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时，我们来看一下为什么会增加假阳性，先看一个标准的正态分布，x轴表示我们测量的数据从小到大（从左到右），y轴表示我们获取某个测量值后的概率，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180619/baglD6fFCh.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>大多数情况下，我们测量得到的数据都位于正态分布的中央部分，但是偶尔情况下，我们的测量值确实会很小或很大，也就是说测量值位于正在分布曲线的两侧，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180619/4hiHbbLaD6.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>例如我从这个分布中得到了一个样本（有3个数值），这就表示，计算机获取的这3个数值有很大的可能性是位于正态分布曲线中央的，但是有时候，它们可能会很小，或很大，位于曲线的两侧，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180619/EBhBeDf53F.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>然后我们从同一个分布中再取一个样本（还是3个数据），如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180619/fi6JhIf91i.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>大多数情况下，如果对这2个样本（分别含有3个数据）进行双尾t检验，那么检验结果中的p值应该是大于0.05的，这是因为多数情况下，这两个样本的数据有重叠部分，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180619/9mFlAIhjgI.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>但是，有时候我们从同一个分布获取的两个样本，经过t检验，这个p值有可能小于0.05，我们就称这种情况为假阳性（false positive），这种情况可能发生的概率是5%，就像下面的这个样子：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180619/KG7bgCjkLi.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>再扩展一下，如果我从同一个分布中，进行了10000次双尾检验，就像下面的这个样子，它的假阳性率为5%的话，那么就有可能出现500次假阳性，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180619/m856KajC1h.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>下面的这张图表示的就是p值的直方图（针对此处的<code>sample #1</code>和<code>sample #2</code>，注意此处的两个样本与后面再次计算的样本是不同的，此处的样本中，<code>sample #1</code>与<code>sample #2</code>有重合），其中蓝色的线表示每个条形块含有约500次检验，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180619/ll7e4G47F5.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>而蓝色的线之下就是假阳性出现的次数，我们以其中的一个矩形为例，就是红色的部分：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180619/9B202981Bc.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时，我们再讨论一下单尾检验，如果样本1（<code>sample #1</code>）含有2个或更多个小于样本2（<code>sample #2</code>）的数值，那么我们就可以使用单尾t检验，在下图中我们可以看到，样本1中有2个数字的值都小于样本2中的所有的数字，那么我们就可以使用单尾t检验了，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180619/36J0G1LgJd.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时我们看一下这个新的p值的直方图（针对此处的<code>sample #1</code>和<code>sample #2</code>，注意此处的两个样本与前面计算的样本是不同的，此处的样本中，<code>sample #1</code>中有2个值是小于s<code>ample #2</code>中的所有值的，而前面的两个样本则有重合），如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180619/FbdbiLD8A2.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>蓝色线就是500位置，此图中的第1个矩形大概是800，也就是说它接近于8%的假阳性率，再结合前面的案例，我们知道，即使这个检验过程中采用的p值的阈值是0.05，但最终的报告中出现的假阳性的概率是5%到8%，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180619/mLAJDg7HGJ.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时，我们再到最初的案例，当我们对癌症进行治疗时，很显然，我们要知道这种治疗是能够改善癌症，还是加重癌症。事实上，对于所有的数据来说，我们可以选择单尾检验，也可以选择双尾检验。但是，在这个案例中，我们必须要弄清楚治疗的两个方面（是加重，还是改善），而不仅仅其中一个方面，因此，当我们在对p值进行取舍时，通常选择双尾检验的p值，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180619/jKC5ebjiHe.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h2 id="p值挟持与统计功效">p值挟持与统计功效</h2>
<p>我们试想这样的一个场景：你累死累活工作到深夜，你做了很多实验，然后对数据进行统计，发现p值是0.051，这就比较尴尬了。如果你还有时间再做几个重复，此时如何选择，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180621/IlcC3b5aGF.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>在回答这个问题是之前，我们先做一个小小的相思实验，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180621/gIa658K889.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>我们来看一个曲线，就是正态分布曲线，我们试想，这个曲线代表了某个实验室中近交系的小鼠的体重，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180621/0dBECEDm6I.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>如果我们对这个实验室的小鼠体重时行测量，那么大多数的体重都会落在正态分布曲线的中间部分，接近平均值，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180621/AdlI063ak1.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>不过，也有一小部分落在曲线的两侧，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180621/gcCIklaAl6.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>由于这些小鼠的体重来源是来源于一个近交系的小鼠品系，那么两个样本之间的体重差别不会太大，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180621/4iJ26BAch9.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时，我们先称3只小鼠，把它们的体重命名为样本1（<code>Sample #1</code>），如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180621/3j5JblCdF9.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>再称3只小鼠的体重，称为样本2（<code>Sample #2</code>），如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180621/m2JHfABAFG.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>然后对这两个样本进行t检验，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180621/c0h7d4724l.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>从理论上来讲，有95%的可能性，t检验的p值是大于0.05的，则那些p值小于0.05的统计结果则被称为“假阳性”（false positives），如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180621/i56i7aace0.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>换句话讲，大多数情况下，我们所期望的结果就是这两个样本比较接近，并且有部分数据有所重合，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180621/A0c113lCLK.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>不过，在极少的情况下我们会发现这两个样本分布在同一个分布的两侧，此时p值就会小于0.05，我们就会认为这两个样本来源于不同的两个分布，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180621/Cfi0GhfjhC.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>但是，我们想关注的事件只是这两个样本的p值大于0.05，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180621/D8aC052KEh.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>我们从同一个分布中生成1000个数据集，每个数据集含有两个样本（分别为<code>Sample #1</code>和<code>Sample #2</code>），分别对其进行t检验，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180621/KEaa73hLB5.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>以下是前20个样本的p值，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180621/BIDJJeB7hg.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>其中，会出现个别p值小于0.05的情况，只要这个事件不的发生率不超过5%（就是p值小于0.05这件事），那么就没有关系，我们的目的就是找到一种方法在95%的情况下都适用，对于大多数的科学来讲，并没有特殊严格的成本效益（cost/benefit），如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180621/6cCjkJfbaG.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>以下是这1000个数据中p值小于0.05的事件，其中以第1列为例，它有53个p值小于0.05的事件，那么53/1000=5.3%，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180621/i0HlgBjAbI.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>第2列的p值比较接近显示性水平，如果这是来源于真实的实验，那么我们就容易这会想，如果我再做一次重复实验，或许p值就小于0.05了，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180621/64IEgcc7cF.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>因此，当我们再向数据集中添加一个随机的值，好么p值就在0.05和0.1之间了，其中会导致30%的t检验的值的p值小于0.05，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180621/ckCJB0i77C.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>换句话讲，当全部的模拟数据给出一个“接近“的p值时，再加入更多的模拟数据，就会有30%的可能性导致p值出现显著性（即p值小于0.05），如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180621/dfi7BeKiEg.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>但我们需要注意的是，不要为了得到一个好的p值而增加样本，它会增加你的假阳性率。</p>
<p>反之，在你进行实验之前，需要进行检验效能计算 （power calculation），用于计算你需要多少样本。其次，如果你在实验之前没有进行功效检验，那么此时也可以进行检验效能计算，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180621/4HbgfF6FcJ.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h3 id="统计功效">统计功效</h3>
<p>统计功效研究的是，你在实验之前需要多少样本数才能得到一个较小的p值，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180621/Iklf5fJDgd.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>在我们讲解”功效“（power）的本质以及功效计算（power calculation）之前，我们先从直观上对这一概念理解一下，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180621/93a1394g4E.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>下面是两个正态分布曲线，假设左图的黑线表示喂食的小鼠体重，右侧的红线表示禁食的小鼠体重，很容易看到这两组小鼠的体重不一样，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180621/4g1cdh9mmj.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>假如分别从这两组小鼠挑选两个小样本（<code>N=3</code>），那么进行t检验时，有很大的可能性得到一个小的p值，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180621/j59CGl8cg7.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>但是，如果禁食的效果不理想，就会发现，这两组曲线有一部分会重叠，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180621/cHbfH2eaLA.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>如果此时从这两组小鼠体重中取两个小样本，那么我们就不太可能得到一个小的p值，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180621/HbGd14A752.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时，我们就可能定义一下功效（<code>Power</code>），功效指的是一个检验能够得到一个小p值的概率，第1个案例就是拥有高的功效，第2个案例就是低的功效，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180621/jeIFGij8L0.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h3 id="影响功能的因素">影响功能的因素</h3>
<p>有4个因素影响功效（power），分别为：</p>
<p>第一：效应量（<code>effect size</code>）；如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180621/8ihFb5H1gD.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>第二：数据的变异程度，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180621/45HcKilkbJ.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>在这个图中，效应量校对小一些，但数据的变异程度也小一些，因此，从这两个分布中得到的样本有很大的概率变异程度也比较小，这就意味着，我们有很大的概率会得到一个小p值，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180621/KDFJag9l8L.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>下面的数据就表现出很大程度的变异，由于变异程度大，那么样本的变异程度也有很高，这就意味着，得到一个小p值的概率比较低，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180621/J3Lhm84JbB.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>第三，样本的数量。</p>
<p>样本数量多会弥补样本效果与数据的变异程度，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180621/E0ddj7hHkK.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>为了简单地说明样本量对效能的影响，我们先用t检验来说明一下，t检验比较的是均值；均值是从样本中估计出来的。</p>
<p>然后我们再看一下样本量是如何影响均值的估计的，尤其是，样本的量如何影响这些估计值的置信度，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180621/CgDkA2egJ2.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>如果样本量是1，那么我们只用了1只小鼠的体重来估计全体小鼠的均值，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180621/GD2kjLiGA8.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>如果我们再衡量另外1只小鼠的体重，那么我们会得到对整体小鼠体重均值的另外一个估计，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180621/J7e8kA0hjb.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>大多数情况下，我们对均值的估计是位于一个区间内，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180621/Fkg7i3BlLb.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>但有时候，估计值也有可能远离中心区域，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180621/CC77c4ACbE.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>为了研究这些估计的变异程度，我们可以绘制出一个正态分布中随机挑选出来的1000个样本的直方图，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180621/43Ge4aFmlf.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>由于有一部分数据位于直方图的两侧，这些数据对于估计值有很低的置信度，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180621/4B86Heg78I.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时我们再看一下，样本数是2个的情况，那么对均值的估计就是这两个数的均值，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180621/5mhjc3bie0.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>第2个样本，也是2个小鼠的体重，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180621/92E1hKF2a1.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>第3个样本，同样如此：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180621/ke17hKlCED.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时我们绘制一下样本数是2的直方图，并且把它与样本数为1时的直方图做个比较，从中我们可以发现，当样本数为2时，直方图的中央区域㬲中接近于真实的均值，这就间顺着我们有可能高的概率得到一个好的均值，它的置信度也更高，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180621/E7B1aAljL1.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>我们再绘制一下样本数为5时候的直方图，并把它与样本数为1和2的直方图进行比较，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180621/9H8lI8lKD3.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>这就表示，当我们增加样本数时，我们估计的均值就越接近于真实的均值，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180621/H4CCgdL3BJ.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>当效应量（effect size）巨大时，我们并不需要对估计值的精确性做出要求。即使样本量很小也有很大的概率得到一个小p值，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180621/abHd7m51b0.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>但是当效应量比较小时，我们对于估计的均值就要求很高的置信度，从而得到差异，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180621/Bc7LecGE3f.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>例如，此时当样本数为3时，由于两个样本之间有很大程度的重叠，那么t检验的结果将是一个比较大的p值，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180621/2mBe7m4JiI.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时我们看一下样本数为8的情况，虽然此时两个样本还有部分重叠，但是相对于样本数为3的情况，我们此时（样本量为8）有更大的可能性得到一个小的p值，我们此时可以说，样本数为8（N=8）比样本数为3（N=3）拥有更强的功效（power），如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180621/fhAhjECl65.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>如果样本数为101，那么我们就有了更强的功效，也就是说我们有更高的概率得到一个小的p值，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180621/gK5aCDgm3F.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>最重要的一点就是，分布的变异程度才决定你通过增加样本数来提高检验功效，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180621/i8I6HDh3LJ.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>因为上图中的蓝线的变异程度较小，样本会相对接近于均值，在这个分布中，并不需要太多的样本就能得到一个相对可靠的估计的均值，相比之下，上图的红线的分布变异程度比较大，样本距离均值都较远，此时就需要更多的样本数来对均值进行估计，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180621/id8eABbG9A.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>第四，使用的检验方法。</p>
<p>在所有的检验方法中，A检验方法可能比B检验方法的功效更强，例如t检验就是一种功效比较强的检验方法，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180621/0bbk7JJ6hl.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h3 id="如何进行功效计算">如何进行功效计算</h3>
<p>此时，我们就知道了什么是功效，那么如何进行功效计算呢？</p>
<p>首选，你需要一些可用的数据，例如一些以前的数据，或者是网上数据库中的数据，或者是你实验中的一些数据。</p>
<p>如果你没有这些数据，也没事，照样能够进行计算，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180621/eG2jC6D87c.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时，我们假设你已经拥有了一批数据，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180621/b9ahHDegDb.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>我们利用这些数据对均值进行估计，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180621/9KFKiB02KB.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>也用它们计算标准差，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180621/Bk3cmclBce.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>有了均值与标准差，就能画出它们的分布曲线，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180621/HjI801e424.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时我们可以发现，它们的功效量比较小（因为有一部分重叠了），因此我们需要增加样本量来增加功效，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180621/1J51GiAKf9.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时，我们再回到前面我们讲的不同样本数目的直方图， 此时，我们再来看一下均值的变异，均值的变异称为标准差（<code>Standard Error</code>），它很容易计算，公式如下所示，其中在标准差公式的分母中的N表示样本量，从中我们可以发现，样本量越大，标准差就越小，也就是说变异程度越小，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180621/9G6H6J0AKd.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>那么功效计算的本质其实就是研究N值，N如果足够的大的话，那么得到一个小的p值的概率就越高，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180622/421f6519cK.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>由于我们没有手动计算过功效，此处也不介绍计算功效的详细过程，但是，我们要介绍一下计算的原理，理解原理的话，就会很方便地学以致用，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180622/HEKgcaaKDJ.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>功效计算的主要思想包括功效量，数据的变异，样本量，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180622/F2AE9jdlDa.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>如果手中已经有了数据，那么就能估算出功效量与变异，此时也能计算出N值，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180622/hAG81akGle.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>如果没有数据，那么我们可以假设你有3个重复，然后假设你在寻找2倍的差异（这里貌似研究的是基因表达方面的东西），然后我们就可以看到数据的变异，以及得到一个好的功效。如果变异程度非常小，那么就需要增加样本数或者是增加功效量，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180622/0dm4H34E2I.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>例如，我们做了一个RNA-seq，已经计算出了人类的生物学变异以某些近交系模式动物的生物学变异，那么此时我们就杺把这些已知的变异加入到公式中，然后有2个选择，第一：将功效量加入公式来计算样本数目，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180622/31GmHcIkbI.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>第二，把样本数目加入公式来计算功效量，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180622/J1C05F7mg6.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>计算功效通常是使用软件进行计算，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180622/cBFcCJFjDD.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时我们再回到开头的那个场景，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180622/a6502CD8Bj.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时，我们需要做就是2件事情：</p>
<p>第一，使用现在的结果进行功效计算；</p>
<p>第二，此时的p值有提示意义，你进行功效计算后，可以为你下一次实验设置多少样本数目提供决策依据，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180622/HJ838l68i5.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2018/06/12/BioInformation/生信-一个分析miRNA时空表达的聚类工具/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/06/12/BioInformation/生信-一个分析miRNA时空表达的聚类工具/" itemprop="url">生信-一个分析miRNA时空表达的聚类工具</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-06-12T12:00:00+08:00">
                2018-06-12
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/生物信息学/" itemprop="url" rel="index">
                    <span itemprop="name">生物信息学</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  1,205
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  4
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="文献信息">文献信息</h2>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Zhang B, Liu S Q, Li C, et al. MicroRNA-23a curbs necrosis during earlyT cell activation by enforcing intracellular reactive oxygen speciesequilibrium[J]. Immunity, 2016, 44(3):568-581.</div></pre></td></tr></table></figure>
<h2 id="文献内容">文献内容</h2>
<p>这篇文献是2016年发在《Immunity》的，文献的主要内容是，当宿主细胞与抗原接触时，细胞内就会产生活性氧基团（ROS），参与T细胞受体（TCR）的信号转导，但是如果ROS的生成不受控制的话，ROS就会对组织造成损伤。作者研究的则是某个miRNA参与了这个过程，在筛选过程中，作者找到了一个miRNA，即miR-23a，它参与细胞的保护。从机理上讲，miR-23a的靶基因是PPIF，PPIF的作用是控制线粒体通透性转换孔，因此miR-23a作用于PPIF，能够阻止ROS的流入，从而维持线粒体的完整性。我们所关注的重点就是作者有关miRNA的筛选工作。为了寻找miRNA介导的抗原诱导CD4 T细胞的应答。作者研究了不同时间点，CD4 T细胞的miRNA表达谱。具体操作是，从转基因LLO118 TCR（LLO118-Thy1.2+）小鼠体内取出20万个naive CD4 T细胞，转移到野生型小鼠（Thy1.1+）体内，接着给野生型小鼠注射亚致死剂量的Listeria菌（LLO是Listeria菌的一个蛋白），然后在不同的时间点，收集小鼠的抗原特异性CD4 T细胞，用高通量qPCR的手段检测miRNA的表达谱（一共是361个miRNA），时间点是6个（分别是第0天，第3天，第5天，第7天，第14天，第28天。</p>
<p>我们处理这些数据的常规方法就是做热图，热图虽然能够聚类，但是很难反应出miRNA不同的聚类随时间变化的趋势，作者在处理这些数据时，采用了一个工具，叫ExpressCluster，这个工具能将不同时间的表达谱进行聚类，并且将不同的聚类结果以时间的形式呈现出现，如文献中的fig.1a所示（文献中一共有9个聚类，作者选择了第3个聚类）的那样。因此，这个工具很适应用于研究不同时间点基因表达谱的变化。</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180612/jchJEKIHea.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>我们就介绍一下这个工具如何使用，首先去官网下载相应的工具，下载后解压即可，里面有3个文件，一个是ExpressCluster程序，一个是使用手册，另外一个不用管。如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180612/e2L5J9h0Ec.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>现在我们利用文献的原始数据重复一下文献中的图片生成过程。此过程包括：下载原始数据（文献的附件里中有原始文件，也有均一化后的数据），修改为GCT格式，导入ExpressCluster生成聚类图，前面均一化的过程比较简单，我们略去不讲，直接进入转换GCT文件这一步。</p>
<p>GCT文件格式是一类制表符分隔的文件，它描述的是基因的表达数据，它的数据格式如下图所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180612/i4E8g6BE3E.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>后文的网址中有GCT的参考数据，下载下来，用Excel就可以打开，打开时，文献类型选择“所有文件”，</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180612/E7jakc5AKg.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>将其中的数据替换为文献中的数据：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180612/LE0hBc783I.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>需要注意的一点是，黄色标注的地方需要修改，361表示检测的基因是361个，6表示数据有6组，Description不用管。保存后，就可以用ExpressCluster打开了，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180612/51kc5IDIcf.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>AVAILABLE（红色方框）中的是每组数据的名称，选中它们，单击绿色箭头，转移到SELECTED中，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180612/Ejc7DELCBc.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>接着，单击APPLY绿色按钮（上图），过滤数据，再在下面的Clusters（K）（绿色方框）中输入聚类的数目，文献中是9组，我们这里输入9，随后，最下面的GENERATE（红色方框）会变成蓝色，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180612/eldfCJlfcm.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>单击后，开始生成聚类图，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180612/KF7D8lgAE3.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>在右上角的查询框（红色方框）中输入miR-23a，查询miR-23a的位置，发现miR-23a在cluster3中，此时再单击右侧中的f(x)（红色方框），可以在相对值与实际值之间进行转换，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180612/hHEhfd48Fh.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>保存图片（绿色方框），生成的图片如下：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180612/EeaE8kgGEe.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此外，该工具还能生成热图，单击下图中的红色方框，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180612/JjL0I80De7.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>生成的热图如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180612/g9cFE8GmFD.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>ExpressCLuster中还有许多高级功能，此篇教程只是简单地入门，重复了一下文献中的图形，具体的其他操作可以参照操作手册。</p>
<p><strong>参考资料；</strong></p>
<ol style="list-style-type: decimal">
<li><p>GCT文件格式：http://software.broadinstitute.org/cancer/software/genepattern/file-formats-guide#GCT</p></li>
<li><p>ExpressCluster下载地址：http://cbdm.hms.harvard.edu/LabMembersPges/SD.html</p></li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2018/06/12/BioInformation/生信-GSEA学习笔记/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/06/12/BioInformation/生信-GSEA学习笔记/" itemprop="url">GSEA学习笔记</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-06-12T12:00:00+08:00">
                2018-06-12
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/生物信息学/" itemprop="url" rel="index">
                    <span itemprop="name">生物信息学</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  3,693
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  13
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>最近数据分析要用到GSEA，以前没有了解过，现在把自己学习的思路写下来，有些是直接复制别人博客的，我参考资料中会注明。</p>
<h2 id="什么是gsea">什么是GSEA？</h2>
<p>GSEA的全称是Gene Set Enrichment Analysis，中文翻译就是基因集富集分析。</p>
<p>基因集富集分析是分析基因表达信息的一种方法，富集是指将基因按照先验知识，也就是基因组注释信息进行分类（注：我个人理解先验知识就是先于经验的知识，例如我们从书本上知道地球是圆的，这就是先验知识，我自己没有亲自去测量，也无法观察到，就知道地球是圆的。基因组注释就是对碱基序列的注释，给出一段碱基序列，根据前人研究的结果，我知识它是什么基因，发挥了什么功能，以上就是对先验知识的理解）。最早提出GSEA的文章是下面的这篇文献：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Subramanian, A., et al. (2005). &quot;Gene set enrichment analysis: A knowledge-based approach for interpreting genome-wide expression profiles.&quot; Proceedings of the National Academy of Sciences 102(43): 15545-15550.</div></pre></td></tr></table></figure>
<h2 id="gsea与gokegg有什么不一样">GSEA与GO、KEGG有什么不一样？</h2>
<p>基因集合富集分析检测基因集合而不是单个基因的表达变化，因此可以包含这些细微的表达变化，预期得到更为理想的结果。GSEA分析有三个特点：①分析的基因集合而不是单个基因；②将基因与预定义的基因集进行比较；③富集分析。与GO（Gene Ontology）和KEGG pathway分析相比，GSEA分析的主要优势在于：</p>
<p>一般的差异分析（GO和Pathway）往往侧重于比较两组间的基因表达差异，集中关注少数几个显著上调或下调的基因，这容易遗漏部分差异表达不显著却有重要生物学意义的基因，忽略一些基因的生物特性、基因调控网络之间的关系及基因功能和意义等有价值的信息。而GSEA不需要指定明确的差异基因阈值，算法会根据实际数据的整体趋势， 为研究者们提供了一种合理地解决目前芯片分析瓶颈问题的方法,即使在没有先验经验存在的情况下也能在表达谱整体层次上对数条基因进行分析,从而从数理统计上把表达谱芯片数据与生物学意义很好地衔接起来,使得研究者们能够更轻松、更合理地解读芯片结果。</p>
<p>目前，市面上绝大多数公司在求得差异基因列表后，都会在此之上提供给客户Pathway 以及GO 富集分析，毕竟给予成百上千的差异表达基因以简洁、明晰的生物学功能的概括，才是进行高通量生物学表达谱实验的主要目的。然而，在实际应用于生物学高通量数据时，它们都有一个重大的缺陷：对于差异基因检出的阈值，异常的敏感，客户需要给出差异基因的一个明确的定义(阈值)，例如abs(FC) ≧2.0 &amp; p ≦ 0.05。这种一刀切的阈值，对于发现真正的生物学效应，许多时候是一种障碍，因为实际通过芯片观测到的RNA 表达变化，往往是层层的负反馈调控后的结果，并且不同组织对于表达差异的敏感度是不同的：在神经递质系统内，一个1.2 倍的表达差异即可能产生及其显著的效应。</p>
<h2 id="gsea的原理">GSEA的原理</h2>
<p>首先是对每个样本里面的基因表达值在样本内部进行排序，这里可以理解为，实验组与对照组的差异基因进行排序。但是，这个差异如何量化，有多种方法，可以是Signal2noise，或者是T检验的值，或者是fold change的值，或者是logFC等。而GSEA默认的就是signal-to-noise metric来对基因进行排序。如果要想计算Signal2Noise ，每个group必须要有3个及以上的samples。</p>
<p>现在我们定义一下各种参数。</p>
<p>其中我们把自己测出来的差异基因的排序列表称为<code>L</code>，把根据先验知识预先定义的基因集称为<code>S</code>（这个基因集可以是与免疫有关的，可以是与某个代谢通路有关的，也可以是与miRNA有关的，具体的看GSEA官网），把这个基因集中的成员称为<code>s</code>（前者是大写，后者是小写）。GSEA的运行原理就是判断预告定义的基因集<code>S</code>里面的成员<code>s</code>在<code>L</code>里面是随机分布的，还是主要聚集在<code>L</code>的顶部或底部。如果我们研究的基因集<code>S</code>的成员显著聚集在<code>L</code>的顶部或底部，那么就说明此基因集成员对实验干预造成的结果有作用，就是我们要关注的基因集。</p>
<p>以下是GSEA计算中的几个概念。</p>
<ol style="list-style-type: decimal">
<li>Enrichment Score，即ES，中文翻译为富集得分。它反应的是基因集成员<code>s</code>在排序列表<code>L</code>两端富集的程度，计算方法是，从基因集<code>L</code>的第一个基因开始，计算一个累计统计值。当遇到一个落在<code>S</code>里面的基因，则增加统计值。遇到一个不在<code>S</code>里面的基因，则降低统计值。每一步统计值增加或减少的幅度与基因的表达变化程度是相关的。富集得分ES是从没有遇到时候开始计算，直到最大值。正值ES表示基因集在列表的顶部富集，负值ES表示基因集在列表的底部富集。</li>
<li>评估富集得分(ES)的显著性。显著性是通过一种称为转换检验 (permutation test)的方法来进行检验的。具体过程是，我们转换不同分数下的数据，并且再一次计算ES值，使之形成一个新的ES分布（假分布），从经验上来讲，交换之后，ES的p值相对于新的ES值（统计分布）来说若是显著的变化，则有理由说明此基因集是有一定的生物学意义的。若样品量少，也可基于基因集做排列检验 (permutation test)，计算p-value（这段话不理解）。</li>
<li>多重假设检验校正。当评估了所有基因的数据之后，我们要使用多重假设检验来评估它们的显著性。首先把每一个基因的ES值根据基因集的大小进行标准化，得到Normalized Enrichment Score (NES)，之后针对NES计算假阳性发现率（FDR），并以此划出假阳性部分对应每一个NES值。FDR是评估一个NES表达值中所发现的假阳性可能性大小；它是由NES的观测值和零分布时比较得出的。</li>
<li>Leading-edge subset，对富集得分贡献最大的基因成员。</li>
</ol>
<h2 id="es-score算法">ES score算法</h2>
<p>ES score的算法如下图所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180612/07k6cigf11.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>其中<code>L</code>表示的就是差异基因已经排序后的序列，<code>S</code>指的是基因集，我们看左边的<code>Ranked List</code>这个部分，它右边是<code>FC</code>，即表达倍数（明显能看出来是从大小到排列的），红色表示的是Hit，也就是说这个基因在基因集<code>S</code>里面，如果在，就加分，也就是说在右边的表格里的<code>Contribution to running sum for ES</code>加上相应的分数。如果是蓝色，表示这个基因不在，就减去相应的分数。</p>
<h2 id="gsea的结果如何查看">GSEA的结果如何查看</h2>
<p>现在我们看一个案例，假设芯片或者其它测量方法（例如qPCR）测到N个基因，那么这N个基因在实验组与对照组之间的差异肯定不一样（这种差异有6种差异计算方法，GSEA官网中提到有这些：），那么根据它们的差异程度，就可以对它们进行排序，并且进行z-score标准化，下图显示的就是GSEA计算的结果：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180612/m1KCmI2aBI.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>现在解释一下这个图：</p>
<ol style="list-style-type: decimal">
<li>图片中长得像条形码的东西就是背景基因（也就是N个基因）所在的位置；</li>
<li>所有的富集分数（Enrichment Score）一开始都是0，就是绿色长蛇状的粗线，这个绿色的曲线就是ES的值计算过程，从左到右每遇到一个基因，就计算出一个ES值，连成线，最高峰为富集得分（ES），在最左侧或最右侧有一个特别明显的峰的基因集通常是感兴趣的基因集。</li>
<li>红色虚线是绿色曲线的顶点，它左侧的数据是Leading edge subset，也就是对富集得分贡献最大的基因成员，若富集得分为正值，则是峰左侧的基因，如果富集得分为负值，则是峰右侧的基因。</li>
<li>一旦gene set里面的基因集中在2万个基因的前面部分，那就是说，它们在实验组中富集，如果集中在后面的闪哪，那就是说在对照组里面的富集。</li>
<li>下面的灰色图形是所有基因在处理前后的变化量的z-score值。</li>
</ol>
<h2 id="gsea相关的文件格式">GSEA相关的文件格式</h2>
<h3 id="gct文件">GCT文件</h3>
<p>GCT格式是由分割符分开的一个数据文件，它记录的是基因表达的数据集，也就是我们要进行GSEA计算的原始数据，它的格式如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180624/097ii2H0j1.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>从左到右，顺时针看到下，GCT文件包含以下这些信息：</p>
<ol style="list-style-type: decimal">
<li><code>Always &quot;#1.2&quot;</code>：这个单元格里一直标注的是<code>#1.2</code>，不用管它。</li>
<li><code># of samples</code>：这个是样本的数目，在上面的表格中，这个数目是130。</li>
<li><code>Third column onwards are sample names. These must be UNIQUE</code>，它是样本的名称，样本的名称必须保证是唯一的，不能出现重复。</li>
<li><code>Data stars on line</code>：第4行，这是每个基因具体的数值。</li>
<li><code>Each column contains expression values from 1 sample. Missing values are allowed(leave empty)</code>：基因表达的数值可以是空。</li>
<li><code>Column 2:Row descriptions.</code>：第2列，对基因的描述，可以为空（填上na）。</li>
<li><code>Column 1:Rowidentifiers</code>：这一列是基因的标识，通常是探针集的id（probe set ids）或克隆号，此列数据必须唯一，不能出现重复。</li>
<li><code>A2单元格：The # of rows</code>：探针的数目。</li>
</ol>
<h3 id="cls文件">CLS文件</h3>
<p>CLS的全称是Categorical (e.g tumor vs normal) class file format，它表示的是分组的信息，下面是一个CLS文件的内容：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180624/87HLjaCEGJ.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>以上面的图片为例说明，第1行有3个数字，分别为38， 2， 1。其中38是样本的数目，2是分组的数目，1不用管。第2行，分别是ALL和AML，这表示的是分组的信息，即有2个组，分别为ALL和AML。第4行，分别是0和1，0表示ALL，1表示AML，它们的数目表示各自的样本有多少个。再看一个案例：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180624/H1JhhC5giK.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>在这个案例中，我们可以看到一共有9个样本，分了3组；这3组分别为KRAS_MUT，WT，MYC_MUT，第3行是具体的分组数目。</p>
<p>常用的定义基因集的文件主要有GMT与GMX。</p>
<h3 id="gmt文件">GMT文件</h3>
<p>GMT文件的全称是Gene Matrix Transposed file format，中文是“基因矩阵转换文件格式”，缩写为GMT。GMT文件是由制表符分割的文件，它用于描述基因集，可以理解为高通量测序的注释文件。下图是GMT文件的一个案例，每行代表一个基因集：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180624/2CELehIc0L.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>在上面的图片中，我们可以看到，第1行表示的一个是基因集，第1列表示的是是基因集的名称，这一列不能出现重复的基因集。第2列是对基因集的一个简单描述，可以选择不填（写上na），第1列的长度可以不等，如果要在Excel表格中编辑GMT文件，一定要注意Excel的自动纠正功能（例如，Excel有可能把SEP8基因自动纠正为8-Sep）。</p>
<h3 id="gmx文件">GMX文件</h3>
<p>GMX文件是另外一种描述基因集的文件格式，下图是GMX的一个案例，它与GMT格式正好相反，它的每列代表一个基因，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180624/ecJHKmbd8a.png?imsageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h3 id="rnk文件">RNK文件</h3>
<p>RNK文件的全称是Ranked list file format，这个文件是一个有序的基因列表，第1列是基因名称（A1单元格忽略），第2列是数值（可以是表达倍数差异，也可以使用类似于t检验进行的排序），如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180624/1c24eDgdiG.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h2 id="gsea使用案例">GSEA使用案例</h2>
<h3 id="官网的gsea工具进行分析">官网的GSEA工具进行分析</h3>
<p>第一步，去<a href="http://software.broadinstitute.org/gsea/downloads.jsp" target="_blank" rel="external">官网地址</a>下载GSEA软件，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180612/EKhiLF46Li.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>下载后，打开，界面如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180612/IcIIDIHHi6.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>GSEA的官网提供了一些数据的案例，我们可以拿来练习一下，地址<a href="http://software.broadinstitute.org/gsea/datasets.jsp" target="_blank" rel="external">点击这里</a>，这些数据如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180612/ah0dgeD2Bd.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>这里以第2行的<code>p53</code>为例说明一下，这一行中有三个数据文件，分别为<code>P53-hug95av2.gct</code>，<code>P53_collapsed.gct</code>和<code>P53.cls</code>，都把它们下载下来，使用Excel打开<code>P53-hug95av2.gct</code>这个数据文件（其实也可以使用Notepad++或PilotEdit Lite这类文本编辑器来打开gct文件），这个文件是分级以及表达量的数据，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180612/62H63F9cGg.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>现在用Excel打开P53.cls这个文件，这个文件是注释信息，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180612/c6BgK0Cl5d.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>从注释信息中我们可以得知，有50个样本，分为两组，分别为2和1表示这两组，2表示MUT组，1表示WT组。将上述的数据导入到GSEA中，如下所示：</p>
<h3 id="使用r包进行gsea">使用R包进行GSEA</h3>
<p>目前R包中有关GSEA分析的包有：PGSEA，</p>
<h2 id="mirna与gsea">miRNA与GSEA</h2>
<h2 id="自定义gene-set文件">自定义Gene set文件</h2>
<p>进行GSEA分析的时候，需要GCT，CLS和GMT文件，其中GMT文件就是Broad官网上的<a href="http://software.broadinstitute.org/gsea/msigdb/collections.jsp" target="_blank" rel="external">Molecular Signatures Database (MSigDB)</a> ，里面有大量的Gene Set，但有的时候，里面并没有我们需要的GMT，因此需要自己制作Gene Set，也就是自己制作GMT格式的文件。</p>
<h2 id="参考资料">参考资料</h2>
<p><a href="https://mp.weixin.qq.com/s?src=11&amp;timestamp=1528721179&amp;ver=932&amp;signature=BDn09HfM3akefGbPg09cA1FY6KvL8dKh8H9wdC8KpEIHyAcAxiFEfCy0JcYxY8WgCFRymGXCDJTL*jE5eh7-nAd3fnHOJnpOHxDda8JFNOPrkZYcSp1q2JCeDJ6amwdY&amp;new=1" target="_blank" rel="external">1. GSEA分析一文就够.Jimmy.生信技能树</a></p>
<p><a href="http://blog.genesino.com/2017/10/gsea/" target="_blank" rel="external">2.GSEA富集分析 - 界面操作</a></p>
<p><a href="https://www.jianshu.com/p/d4171f3eefb5" target="_blank" rel="external">3.基因集富集分析</a></p>
<p><a href="http://www.360doc.com/content/16/1026/18/19913717_601568937.shtml" target="_blank" rel="external">4.GSEA分析是个什么鬼（上）</a></p>
<p><a href="http://software.broadinstitute.org/gsea/doc/GSEAUserGuideFrame.html" target="_blank" rel="external">5.GSEA User Guide</a></p>
<p><a href="http://software.broadinstitute.org/gsea/doc/desktop_tutorial.jsp" target="_blank" rel="external">6.Quick Tour of the GSEA Java Desktop Application</a></p>
<p><a href="http://www.bio-info-trainee.com/1282.html" target="_blank" rel="external">7.用GSEA来做基因集富集分析</a></p>
<p><a href="http://www.bio-info-trainee.com/3330.html" target="_blank" rel="external">8.使用PGSEA包进行基因集分析</a></p>
<p><a href="http://www.bio-info-trainee.com/2144.html" target="_blank" rel="external">9.制作自己的gene set文件给gsea软件</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2018/06/11/BioStatistics/生物统计-StatQuest学习笔记10-t检验/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/06/11/BioStatistics/生物统计-StatQuest学习笔记10-t检验/" itemprop="url">StatQuest学习笔记10——t检验</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-06-11T12:10:54+08:00">
                2018-06-11
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/生物统计/" itemprop="url" rel="index">
                    <span itemprop="name">生物统计</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  110
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  1
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="笔记略">笔记（略）</h2>
<p>这篇笔记是是StatQuest视频教程的第32个，主要内容是讲t检验的，原视频只是作者的口头讲解，并没有相应的示意图，公式等，我以前也写有关t检验的一些笔记，可以参考这两篇笔记，它们分别是<a href="http://rvdsd.top/2017/06/20/%E7%94%9F%E7%89%A9%E7%BB%9F%E8%AE%A1-02%E6%AD%A3%E6%80%81%E5%88%86%E5%B8%83%E4%B8%8ET%E6%A3%80%E9%AA%8C/">《正态分布与t检验》</a>和<a href="http://rvdsd.top/2017/06/21/%E7%94%9F%E7%89%A9%E7%BB%9F%E8%AE%A1-02b%E6%AD%A3%E6%80%81%E5%88%86%E5%B8%83%E4%B8%8ET%E6%A3%80%E9%AA%8C%E7%9A%84%E8%AE%A1%E7%AE%97%E5%8E%9F%E7%90%86/">《正态分布与t检验的计算原理》</a>。</p>
<p>这篇笔记就不写了。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2018/06/11/Literature/文献笔记-非编码RNA/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/06/11/Literature/文献笔记-非编码RNA/" itemprop="url">非编码RNA</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-06-11T12:00:00+08:00">
                2018-06-11
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/文献笔记/" itemprop="url" rel="index">
                    <span itemprop="name">文献笔记</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  130
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  1
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="ncrna">ncRNA</h2>
<p>ncRNA的全称为noncoding RNA，即非编码RNA，非编码RNA是一个大类，它包括短链非编码microRNA和lncRNA。其中短链非编码RNA包括microRNA（miRNA），siRNA，snoRNA，rRNA，tRNA和Piwi相互作用RNA(piRNA)。而lncRNA又包括lincRNA，antisenseRNA，pseudogenes和circular RNA。很多研究都指出，这些ncRNA参与竞争性调节作用，即它们参与ceRNA网络，而lncRNA的作用则是作为microRNA的诱饵(decoy)，能够吸附microRNA，参与基因的调节。</p>
<h2 id="cerna">ceRNA</h2>
<p>ceRNA全称为<code>competing endogenous RNAs</code>中文译名为“内源竞争RNA”。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2018/06/10/BioStatistics/生物统计-StatQuest学习笔记09-Fisher精确检验/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/06/10/BioStatistics/生物统计-StatQuest学习笔记09-Fisher精确检验/" itemprop="url">StatQuest学习笔记09——Fisher精确检验</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-06-10T12:10:54+08:00">
                2018-06-10
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/生物统计/" itemprop="url" rel="index">
                    <span itemprop="name">生物统计</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  1,018
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  4
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="前言">前言</h2>
<p>以前我也写过有关统计学的笔记，本来是想结合StatQuest把原来的笔记整理一下，后来一想，还是算了，直接把StatQuest的系列教程做成笔记，这样比较系统，也会避免笔记冗余。这篇笔记是StatQuest视频教程的第31个，主要内容是Fisher精确检验与超几何分布，Fisher精确检验我以前的笔记中也有，就是<a href="http://rvdsd.top/2017/08/18/%E7%94%9F%E7%89%A9%E7%BB%9F%E8%AE%A1-07%E5%8D%A1%E6%96%B9%E5%88%86%E6%9E%90/">《卡方检验》这篇笔记</a>。</p>
<h2 id="fisher精确检验">Fisher精确检验</h2>
<p>我们还以MM豆（MM豆是M&amp;M巧克力豆的缩写，美国的一个品牌）为例进行说明。</p>
<p>此时我从MM豆的盒子里抓了一把MM豆，这批MM豆有8个，其中有7个蓝豆，1个红豆。此时问题来：</p>
<ol style="list-style-type: decimal">
<li>如何描述袋子中的MM豆颜色的分布？</li>
<li>我这个盒子里的蓝豆的比例是不是比正常的要高一些（正常MM豆中的蓝豆比例为21%）？</li>
<li>我能否计算这个MM豆样本的p值？</li>
</ol>
<p>如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180615/mmcdHDbkcm.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>MM豆的盒子里有40个MM豆，它的各种MM豆的颜色比例如下图所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180615/4a1CaGGi91.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时，我用直方图来研究一下我的这盒MM豆是否是一个特例（就是说跟平常所见的MM豆的颜色比例不同），下面我们就以我手中的这8个MM豆（7个蓝豆，1个红豆）为基础，来计算一下这个概率，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180615/ah8A1E6932.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>首先我事先说明一下，我们在计算这批MM豆的概率时，不用考虑它们的顺序，也就是说，当我拿出7个蓝豆与1个红豆的时候，不用在意这8个MM豆是如何排序的，就像是下面的这个样子：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180615/H5ifIHFhJb.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>现在让我们计算一下这7个蓝豆和1个红豆的概率，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180615/h0I5CA13gK.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>第1步：第1个MM豆是蓝色，此时它的概率为8/40，如何计算呢？就是因为一盒MM豆中按照正常的比例（这个比例是作者从MM豆的官网上查的），它有40个MM豆，有8个蓝豆，此时蓝豆的概率就是8/40，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180615/IkKb8c5IAm.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>第2步：还是1个蓝豆，它的概率是7/39，如何计算呢？因为此时已经拿出了一个蓝豆了，这盒MM豆剩下的就只有39个了，蓝豆还有7个，那么蓝豆的概率就是7/39，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180615/2IK9FLB0DJ.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>按照这种方法计算下去，第3个蓝豆的概率就是6/38，第4个蓝豆的概率就是5/37，最后，第8个MM豆是红色的概率就是5/33，计算结束。</p>
<p>现在把这8个概率相乘，就是我们手中有7个蓝豆和1个红豆的概率，最终的结果为0.000000065，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180615/e3glC7akke.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>这个概率是非常小的，不过我们需要记住的是，我们此时没有考虑MM豆的顺序，如果我们考虑了MM豆的顺序的话，我们还可以再计算一次，方法跟前面的是一样的，考虑了顺序之后，就是下面的这个样子：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180615/7BFH0B6G7D.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>最终的计算结果是0.00000053，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180615/D5Kd8344K9.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时我们计算出了出现这个事件的概率（也就是说7个蓝豆和1个红豆）了，那么，我们如何计算p值呢？首选我们要知道，p值是一系列小概率事件的总和，还包括下面的这些情况，例如8个蓝豆，还有7个橘黄豆和1个蓝豆，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180615/47ldmdfJ3l.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>后来经过计算，这个p值为0.01，那么我们就可以说，我的这盒MM豆是特例。</p>
<h2 id="fisher精确检验与超几何分布">Fisher精确检验与超几何分布</h2>
<p>另外在这个视频教程的题目中提到了超几何分布，Fisher精确检验可以视为超几何分布的一种变形，超几何分布在GO分析方面有着重要的作用，先留个坑，等视频学完了再填上。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/11/">11</a><a class="extend next" rel="next" href="/page/3/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">RVDSD</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">104</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">9</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">101</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          <div class="links-of-author motion-element">
            
          </div>

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

<div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">RVDSD</span>

  
</div>



<div class="powered-by">
<i class="fa fa-user-md"></i><span id="busuanzi_container_site_uv">
  本站访客数:<span id="busuanzi_value_site_uv"></span>
</span>
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.3</div>




<div class="theme-info">
  <div class="powered-by"></div>
  <span class="post-count">博客全站共357.4k字</span>
</div>

        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.3"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.3"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.3"></script>



  


  




	





  





  










  
  <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/valine@1.1.4/dist/Valine.min.js"></script>
  <script type="text/javascript">
    new Valine({
        av: AV,
        el: '#vcomments' ,
        verify: true,
        notify: true,
        app_id: '4ORLDMxXCFDLSHPJ4wSSDkkw-gzGzoHsz',
        app_key: 'HSWpCY7XlN0pGV5DCrKoC0ic',
        placeholder: 'Comment input placeholder'
    });
  </script>



  





  

  

  
  

  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config("");
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="custom_mathjax_source">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->
  


  

  

</body>
</html>
