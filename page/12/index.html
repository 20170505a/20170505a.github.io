<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.3" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.3">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.3" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta property="og:type" content="website">
<meta property="og:title" content="RVDSD的个人笔记本">
<meta property="og:url" content="http://rvdsd.top/page/12/index.html">
<meta property="og:site_name" content="RVDSD的个人笔记本">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="RVDSD的个人笔记本">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.3',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://rvdsd.top/page/12/"/>





  <title>RVDSD的个人笔记本</title><!-- hexo-inject:begin --><!-- hexo-inject:end -->
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">RVDSD的个人笔记本</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">学习过程中的输出</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2017/06/03/BioStatistics/生物统计-03假设检验笔记/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/06/03/BioStatistics/生物统计-03假设检验笔记/" itemprop="url">假设检验笔记</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-06-03T12:00:00+08:00">
                2017-06-03
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/生物统计/" itemprop="url" rel="index">
                    <span itemprop="name">生物统计</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  4,165
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  15
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="用小概率事件进行判断">用小概率事件进行判断</h2>
<p>我们有时候会听到“意外发生了”这样的说法，这句话意味着我们相信某个事件发生的概率很小，也就是说它预期不会发生，但是它发生了，例如，没有人会对一个大城市某一天发生交通事故感到意外，因为这要瓣城市每天都发生大量的交通事故，但如果某一天没有发生交通事故，就真是意外了，即小概率事件发生了，另外，人们会觉得一个从来没有出过事故的老司机出事故的概率很小，如果这个司机发生事故了，人们会由于小概率事件发生了而觉得意外。</p>
<p>在统计中，我们常用小概率事件对某项论述进行判断，假如我们对于某个说法表示怀疑，并且试图否定这个说法，那么，我们就要表示，这个说法成立的情况下，我们所观测的数据出现的概率很小。我们用下面的例子说明，人们如何计算用来否定某种说法的这种概率。比如，某大型百货商场说它的抽奖活动有10%的可能抽到奖，而有人注意到有70人抽奖，结果都未中奖，这样人们就会怀疑这个商场作假，在奖券很多的情况下，我们可以假定抽奖70次中成功的次数应该服从二项分布Bin(70,p)，按照商场的说法，每次中奖概率p=0.10，因此我们可以诈出70次抽奖没有人中奖的概率是0.0006265787</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; dbinom(<span class="number">0</span>,<span class="number">70</span>,<span class="number">0.1</span>)</div><div class="line">[<span class="number">1</span>] <span class="number">0.0006265787</span></div></pre></td></tr></table></figure>
<p>也就是说，按照商场的差距中奖概率的说法，70次抽奖都没有抽中的概率只有约万分之六，由此70交抽奖没有人中奖就是发生了小概率事件，这里的“小概率”事件是根据商场提供的参数p=0.1计算出来的，因此我们有理由怀疑商场中关于p=0.1说法的合理性。这里我们所做的就是按照某个假定（这里的商场的说法）来计算随机试验发生某结果的概率，如果小概率事件发生，那么我们有理由质疑那个假定。</p>
<p>假设检验的原理也是如此。</p>
<h2 id="假设检验的基本原理">假设检验的基本原理</h2>
<p>在实际中我们会遇到这样的问题：某一样本均数是否来自于某已知均数的总体？两个不同样本均数是否来自均数不相等的总体等？要回答这类问题，经常使用统计推断的一个方法，即假设检验（hypothesis test）来解决。 假设检验过去称为显著性检验（significance test），它是利用小概率反证法的思想，从问题的对立面（<span class="math inline">\(H_{0}\)</span>）出发，间接判断要解决的问题（<span class="math inline">\(H_{0}\)</span>）是否成立。即在假设<span class="math inline">\(H_{1}\)</span>成立的条件下计算检验统计是不是，然后根据获得的P值来判断。其原理和步骤用以下实例说明。</p>
<h3 id="案例">案例</h3>
<p>例3-5 某医生测量了36名人事铅作用男性工人的血红蛋白含量，算得其均数为130.83g/L，标准差为25.74g/L，问：人事铅作用男性工人的血红蛋白含量均数(<span class="math inline">\(\mu\)</span>)是否不等于正常成年男性的无数140g/L（<span class="math inline">\(\mu_{0}\)</span>）？（医学统计学第四版，孙振球） 本例题可用下图表示： <img src="http://ortxpw68f.bkt.clouddn.com/hypothesis%20test.png"></p>
<p>本题的目的是判断是否<span class="math inline">\(\mu \neq \mu_{0}\)</span>，从所给的条件来看，样本均数<span class="math inline">\(\bar{X}\)</span>与已知总体均数<span class="math inline">\(\mu_{0}\)</span>不等，造成两者不等的原因有二：①从事铅作用工人的血红蛋白含量确实高于正常成年男性，即非同一总体（<span class="math inline">\(\mu \neq \mu_{0}\)</span>）；②因抽样误差导致两者不等，即为同一总体（<span class="math inline">\(\mu = \mu_{0}\)</span>）。 要直接证明是否<span class="math inline">\(\mu \neq \mu_{0}\)</span>很难，但可以利用反证法的思想，从<span class="math inline">\(\mu \neq \mu_{0}\)</span>的对立面<span class="math inline">\(\mu = \mu_{0}\)</span>出发，间接判断是否<span class="math inline">\(\mu \neq \mu_{0}\)</span>。 假设：<span class="math inline">\(\mu = \mu_{0}\)</span>，判断由于抽样误差造成不相等的可能性有多大？</p>
<p>如果<span class="math inline">\(\bar{X}\)</span>与<span class="math inline">\(\mu_{0}\)</span>接近，其差别可用抽样误差解释，可认为<span class="math inline">\(\bar{X}\)</span>来自<span class="math inline">\(\mu_{0}\)</span>总体；如果<span class="math inline">\(\bar{X}\)</span>与<span class="math inline">\(\mu_{0}\)</span>相关甚远，不宜用抽样误差解释，则怀疑<span class="math inline">\(\bar{X}\)</span>不是来自<span class="math inline">\(\mu_{0}\)</span>总体，那么<span class="math inline">\(\bar{X}\)</span>与<span class="math inline">\(\mu_{0}\)</span>相关多大算是由抽样误差造成的呢？若假设<span class="math inline">\(\mu = \mu_{0}\)</span>成立，则可用公式<span class="math inline">\(\frac{\bar{X}-\mu}{S/\sqrt{n}} =t\)</span>或<span class="math inline">\(\frac{\bar{X}-\mu}{\delta/ \sqrt{n}} =\mu\)</span>计算t值或<span class="math inline">\(\mu\)</span>值，然后由t值或<span class="math inline">\(\mu\)</span>值求得P值来判断。如果<span class="math inline">\(\bar{X}\)</span>与<span class="math inline">\(\mu_{0}\)</span>相差较过错，t或<span class="math inline">\(\mu\)</span>值就大，P值就小，当P小于或等于预先规定的概率值<span class="math inline">\(\alpha\)</span>，如0.05时，则为小概率事件。小概率事件在一次抽样中发生的可能性很小，如果它发生了，则有理由怀疑原假设<span class="math inline">\(\mu = \mu_{0}\)</span>可能不成立，认为其对立面<span class="math inline">\(\mu \neq \mu_{0}\)</span>成立，该结婚的正确性冒着5%的错误风险。</p>
<p>从上面分析可以看出，假设检验可归纳为三大基本步骤。 1. 建立检验假设，确定检验水准，假设有两种： (1) <span class="math inline">\(\mu = \mu _{0}\)</span>，常称为无效假设或零假设，用<span class="math inline">\(H_{0}\)</span>表示。 (2) <span class="math inline">\(\mu \neq \mu _{0}\)</span>，常称为备选假设，用<span class="math inline">\(H_{1}\)</span>表示。</p>
<p>对于假设检验，需要注意的是：</p>
<ol style="list-style-type: decimal">
<li>检验假设针对的是总体，而不是样本；</li>
<li><span class="math inline">\(H_{0}\)</span>和<span class="math inline">\(H_{1}\)</span>是相互关系、对立的假设，后面统计推断的结论是根据<span class="math inline">\(H_{0}\)</span>和<span class="math inline">\(H_{1}\)</span>作出的，两者缺一不可；</li>
<li><span class="math inline">\(H_{0}\)</span>为无效假设，其假定通常是：某两个（或多个）总体参数相等，或某两个总体参数之差为0，或某资料服从某一特定分布；</li>
<li><span class="math inline">\(H_{1}\)</span>的内容直接反映了检验的单双侧，若<span class="math inline">\(H_{1}\)</span>为<span class="math inline">\(\mu &gt; \mu_{0}\)</span>或<span class="math inline">\(H_{1}\)</span>为<span class="math inline">\(\mu &lt; \mu_{0}\)</span>，则此检验为单侧检验，它不仅考虑是否有差异，而且还考虑差异的方向，假如上述例3-5中医生只关心铅作业男性工人的血红蛋白含量均数是否低于正常男性的均数；若<span class="math inline">\(H_{1}\)</span>为<span class="math inline">\(\mu \neq \mu_{0}\)</span>，则此检验为双侧检验，例如上述例题中的问题，从事铅作业男性工人的血红蛋白含量均数是否不等于男性的均数140g/L，此时高于和低于正常男性这两种可能性都存在。单侧检验的确定，首先要根据专业知识，其次是根据所要解决的问题来确定。若从专业上看一种方法的结果不可能低于或高于另一种方法，尽量提问为：两种方法的测定结果是否相同？此时仍用单侧检验。一般认为，双侧检验比较保守和稳妥，探索性研究多用双侧检验；而证实性研究多用单侧检验。现在以单样本和两样本均数比较的t检验为例，用下面两张表说明单双侧检验的确定。 <img src="http://ortxpw68f.bkt.clouddn.com/hypothesis%20test2.png"></li>
</ol>
<p>(3)<span class="math inline">\(\alpha\)</span>：即检验水准，也称显著性水准，它属于I型错误的范畴，<span class="math inline">\(\alpha\)</span>是预先规定的概率值，它确定了小概率事件的标准，在实际工作中，常取<span class="math inline">\(\alpha=0.05\)</span>。除了I型错误外，还有II型错误。后面会详细说明第1类错误和第2类错误。</p>
<h2 id="第一类错误和第二类错误">第一类错误和第二类错误</h2>
<h3 id="第一类错误">第一类错误</h3>
<p>第一类错误又称Ⅰ型错误、拒真错误，是指拒绝了实际上成立的、正确的假设，为“弃真”的错误，其概率通常用α表示。即“原假设是正确的，却拒绝了原假设”。我们平时遇到的文献里，基本上都是与第一类错误有关的假设检验，这就是我们常说的“假阳性”，即无中生有，本来实验结果是阳性，非常高兴，后来才发现这是假阳性，把本来不存在的事情，当作了存在。</p>
<h3 id="第二类错误">第二类错误</h3>
<p>第二类错误又称Ⅱ型错误，接受了实际上不成立的H0 ，也就是错误地判为无差别，这类取伪的错误称为第二类错误，其概率用β表示。即“原假设是错误的，却没有拒绝原假设”，这可以理解为“假阴性“，下面的一幅图可以很清楚地说明第一类错误与第二类错误： <img src="http://ortxpw68f.bkt.clouddn.com/professional/180426/6caFFkhAaG.jpg?imageslim" alt="mark"></p>
<h3 id="第一类错误和第二类错误的关系">第一类错误和第二类错误的关系</h3>
<p>当样本例数固定时，α愈小，β愈大；反之，α愈大，β愈小。因而可通过选定α控制β大小。要同时减小α和β，唯有增加样本例数。统计上将1-β称为检验效能或把握度(power of a test)，即两个总体确有差别存在，而以α为检验水准，假设检验能发现它们有差别的能力。实际工作中应权衡两类错误中哪一个重要以选择检验水准的大小。</p>
<h3 id="对第一类错误和第二类错误的简单理解">对第一类错误和第二类错误的简单理解</h3>
<p>我们常把假设检验比作法庭判案，我们想知道被告是好人还是坏人。原假设是“被告是好人”，备择假设是“被告是坏人”。法庭判案会犯两种错误：如果被告真是好人，而你判他有罪，这是第一类错误(错杀好人)；如果被告真是坏人，而你判他无罪，这是第二类错误(放走坏人)。</p>
<p>记忆方法：我们可以把第一类错误记为“以真为假”，把第二类错误记为“以假为真”。当然我们也可以将第一类错误记为“错杀好人”，把第二类错误记为“放走坏人”。</p>
<p>在其他条件不变的情况下，如果要求犯第一类错误概率越小，那么犯第二类错误的概率就会越大。这个结论比较容易理解，当我们要求“错杀好人”的概率降低时，那么往往就会“放走坏人”。</p>
<p>同样的，在其他条件不变的情况下，如果要求犯第二类错误概率越小，那么犯第一类错误的概率就会越大。当我们要求“放走坏人”的概率降低时，那么往往就会“错杀好人”。同样的，在其他条件不变的情况下，如果要求犯第二类错误概率越小，那么犯第一类错误的概率就会越大。当我们要求“放走坏人”的概率降低时，那么往往就会“错杀好人”。</p>
<h2 id="p值的理解">p值的理解</h2>
<p>在假设检验中，拒绝零假设时所允许的最大的犯第一类错误的概率称为显著性水平(level of significance或significance level)，通常用α表示。显著性水平通常是由进行检验的根据实际目标确定的。最常用的显著性水平为0.05，0.01，0.005，0.001等。</p>
<p>在假设检验中，我们通常使用样本的一个统计量作为证据来称量零假设的真伪，该统计量称为检验统计量(test statistic)，和检验统计量关联的一个概念是p值(p-value)，它是在零假设下，出现检验统计量的实现值以及（向备选假设方向）更极端的值的概率，有关p值的更好理解，可以参见这一篇文章<a href="https://mp.weixin.qq.com/s/4LmVdoQdxDlZ6xOgSfXRaA" target="_blank" rel="external">《p值详解》</a>。</p>
<p>p值度量从样本数据得到的信息对零假设的支持程度。因此，p值越小，越有理由说明样本数据不支持零假设。如果p值小于显著性水平α，那么能够拒绝零假设，否则就不能拒绝零假设。因此p值常常被称为该检验的<strong>观测显著性水平(observed level of significance)</strong>。在统计软件的输出中，通常只输出p值，而由用户自己决定p值是多少时拒绝零假设。p值是由数据决定的，而显著性水平是由用户决定的。计算软件仅仅给出p值，而不给出α，例如我们计算得到的p值是0.0005，这时如果以α=0.05为显著性水平，那么此时就拒绝零假设，如果以α=0.001为显著性水平，那么就无法拒绝零假设。α=0.05表明，拒绝零假设时犯错误的概率是百分之五，α=0.001表明，拒绝零假设时犯错误的概率是千分之一。在统计软件的输出结果中，有的使用“p-value”，有的使用significance的缩写，即“Sig”来标明。</p>
<p>根据数据产生的p值来减少α的值以展示结果的精确性总是没有害处的。这就好比一个身高180cm的男生，可能愿意被认为高于或等于180cm，而不愿意被说成高于或等于155cm，虽然第二种说法在数学上没有丝毫错误。</p>
<h3 id="在实际情况中如何把握α与β错误">在实际情况中，如何把握α与β错误</h3>
<p>举个例子，某研究者研究一个化合物A，原假设（H0）：化合物A对于改善糖尿病没有作用。而化合物A可能对改善糖尿病有作用，也可能没有作用。</p>
<p>如果化合物A真的没有作用，而研究的数据支持A有作用，则是犯了第一类错误（即无中生有）。</p>
<p>如果化合物A真的有作用，而数据支持A没有作用，则是犯了第二类错误（即有中生无）。 对于研究者来说，如何把握呢？如果把第一类错误标准定得过于宽松，很容易得到化合物A有作用的结论，把没有效果的东西当作是有效果的，他会把自己的研究结果报告，或者发布到学术界中。其他研究者便会去尝试重复实验，投入大量的人力和物力，去搞一个原本就不存在东西上，这就是极大的浪费，就像某医药公司看到了化合物A能够降改善糖尿病的论文，就投入大量资源去研究（事实上化合物A根本没有作用），这样就会造成浪费。因此宁可把第一类错误的标准定得高一些，这样即使犯了第二类错误，也不至于在本不存在的事情上浪费资源。</p>
<h2 id="假设检验中的一些注意事项">假设检验中的一些注意事项</h2>
<p>某些书中会提到，不能拒绝零假设就接受零假设的说法，而且没有给出犯第二类错误的概率，这是不恰当的。首选，你说“接受零假设”，那么就应该负责任地提供接受零假设时可能犯第二类错误的概率，这就要算出在备选假设正确的情况下，错误地接近零假设的概率。但是，这只有在备选假设仅仅是一个与零假设不同的确定值（而不是范围）时才有可能，多数初等统计教科书中的备选假设是一个范围，例如前面提到例题，在这个例题中，H0:μ=50，H1:μ&lt;50，在这种情况下，根本无法确定犯第二类错误的概率。</p>
<p>在很多应用回归分析的方法中，也有不少书中往往把一系列不能拒绝零假设的检验当成接受这些假设的通行证。比如不能拒绝某样本的正态性就变成了证明该样本是正态的等。其实，不能拒绝这些零假设，仅仅说明，根据当前所使用的检验方法和当前的数据，没有足够证据拒绝这些假设而已。因此，在不能拒绝零假设时，只能够说，按照目前的证据和检验方法，不足以拒绝零假设。</p>
<h2 id="参考资料">参考资料：</h2>
<p><a href="https://www.zhihu.com/question/20993864/answer/81244176" target="_blank" rel="external">第一类错误和第二类错误的关系是什么？马志阳的回答</a> <a href="https://zhuanlan.zhihu.com/p/25734905" target="_blank" rel="external">假设检验之五：α风险 vs. β风险</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2017/06/03/BioStatistics/生物统计-06T分布与检验/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/06/03/BioStatistics/生物统计-06T分布与检验/" itemprop="url">t分布与t检验笔记</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-06-03T12:00:00+08:00">
                2017-06-03
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/生物统计/" itemprop="url" rel="index">
                    <span itemprop="name">生物统计</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  2,091
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  9
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="t分布">t分布</h2>
<p>具有正态分布<span class="math inline">\(N(\mu,\sigma)\)</span>观测值的样本量为n的样本均值也是正态分布变量，在统计推断中往往希望利用它减去总体的均值再除以均值的总体标准差来得到标准正态变量，如下所示：</p>
<p><span class="math inline">\(Z=\frac{\bar{X}-\mu}{\sigma\sqrt{n}}\)</span></p>
<p>在这个变换中，如果用均值的样本标准差来代替其未知的总体标准差时（因为总体的标准差往往未知），即用<span class="math inline">\((\bar{x}-\mu)/(s/\sqrt{n})\)</span>代替<span class="math inline">\((\bar{x}-\mu)/(\delta/\sqrt{n})\)</span>，如下所示：</p>
<p><span class="math inline">\(t=\frac{\bar{X}-\mu}{s\sqrt{n}}\)</span></p>
<p>得到的分布就不再是标准正态分布了，它的密度曲线有点像正态分布，不过中间瘦，尾巴长，这种分布称为<strong>t分布</strong>（t-distribution，或称为学生分布，Student’s t），这个分布是戈塞特（Gosset）发现的，他当时用t来表示这个变量，当时戈塞特在发表论文中，他使用的笔名是Student，因此也叫学生分布，不同的样本量通过标准化所产生的t分布也不同，这样就形成了一族分布，t分布族中的成员是以自由度来区分的，这里的自由度等于样本量减去1，即n-1，t分布通常用于研究小样本的均值，如果自由度趋于无穷，那么t分布就是标准正态分布了，一个有k个自由度的t分布用t(k)表示，下图就展示了标准正态分布N(0,1)和自由度等于1的t(1)以及自由度等于2的t(2)分布的密度函数曲线，我们可以看出，t分布两边尾巴比较长，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">xt&lt;-seq(-<span class="number">4</span>,<span class="number">4</span>,length=<span class="number">300</span>)</div><div class="line">yt1&lt;-data.frame(x=xt,y=dnorm(xt),group=rep(<span class="string">"N(0,1)"</span>,<span class="number">300</span>))</div><div class="line">yt2&lt;-data.frame(x=xt,y=dt(xt,<span class="number">2</span>),group=rep(<span class="string">"t(2)"</span>,<span class="number">300</span>))</div><div class="line">yt3&lt;-data.frame(x=xt,y=dt(xt,<span class="number">1</span>),group=rep(<span class="string">"t(3)"</span>,<span class="number">300</span>))</div><div class="line">y_t &lt;- rbind(yt1,yt2,yt3)</div><div class="line">ggplot(y_t,aes(x=x,y=y,color=group))+geom_line()</div></pre></td></tr></table></figure>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180818/IjiL215LF9.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>通常使用<span class="math inline">\(t_{\alpha}\)</span>表示t分布相应于右侧尾概率<span class="math inline">\(\alpha\)</span>的t变量的<span class="math inline">\(\alpha\)</span>上侧分位数，即对t分布变量T，有<span class="math inline">\(P(T&gt;t_{\alpha})=\alpha\)</span>，下图就表示了自由度为2的t(2)分布右边的尾概率（<span class="math inline">\(\alpha=0.05\)</span>），如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180716/4CDKF3aHd4.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h3 id="t分布的密度分布图">t分布的密度分布图</h3>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">set.seed(<span class="number">1000</span>)</div><div class="line">x &lt;- seq(-<span class="number">5</span>,<span class="number">5</span>,length.out=<span class="number">1000</span>)</div><div class="line">y &lt;- dt(x,<span class="number">1</span>,<span class="number">0</span>)</div><div class="line">plot(x,y,col=<span class="string">"red"</span>,xlim=c(-<span class="number">5</span>,<span class="number">5</span>),ylim=c(<span class="number">0</span>,<span class="number">0.5</span>),type=<span class="string">"l"</span>,</div><div class="line">xaxs=<span class="string">"i"</span>,yaxs=<span class="string">"i"</span>,ylab=<span class="string">"density"</span>,xlab=<span class="string">""</span>,</div><div class="line">main=<span class="string">"The T density distribution"</span>)</div><div class="line">lines(x,dt(x,<span class="number">5</span>,<span class="number">0</span>),col=<span class="string">"green"</span>)</div><div class="line">lines(x,dt(x,<span class="number">5</span>,<span class="number">2</span>),col=<span class="string">"blue"</span>)</div><div class="line">lines(x,dt(x,<span class="number">50</span>,<span class="number">4</span>),col=<span class="string">"orange"</span>)</div><div class="line">legend(<span class="string">"topleft"</span>,legend=paste(<span class="string">"df="</span>,c(<span class="number">1</span>,<span class="number">5</span>,<span class="number">5</span>,<span class="number">50</span>),<span class="string">"ncp="</span>,c(<span class="number">0</span>,<span class="number">0</span>,<span class="number">2</span>,<span class="number">4</span>)),lwd=<span class="number">1</span>,col=c(<span class="string">"red"</span>,<span class="string">"green"</span>,<span class="string">"blue"</span>,<span class="string">"orange"</span>))</div></pre></td></tr></table></figure>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/t%20density%20distribution.png">

</div>
<h3 id="t分布的累积分布图">t分布的累积分布图</h3>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">set.seed(1)</div><div class="line">x&lt;-seq(-5,5,length.out=1000)</div><div class="line">y&lt;-pt(x,1,0)</div><div class="line">plot(x,y,col=&quot;red&quot;,xlim=c(-5,5),ylim=c(0,0.5),type=&apos;l&apos;,</div><div class="line">xaxs=&quot;i&quot;, yaxs=&quot;i&quot;,ylab=&apos;density&apos;,xlab=&apos;&apos;,</div><div class="line">main=&quot;The T Cumulative Distribution Function&quot;)</div><div class="line">lines(x,pt(x,5,0),col=&quot;green&quot;)</div><div class="line">lines(x,pt(x,5,2),col=&quot;blue&quot;)</div><div class="line">lines(x,pt(x,50,4),col=&quot;orange&quot;)</div><div class="line">legend(&quot;topleft&quot;,legend=paste(&quot;df=&quot;,c(1,5,5,50),&quot; ncp=&quot;, c(0,0,2,4)), lwd=1, col=c(&quot;red&quot;, &quot;green&quot;,&quot;blue&quot;,&quot;orange&quot;))</div></pre></td></tr></table></figure>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180716/gDJ786KC9E.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h2 id="某一数据是否符合t分布">某一数据是否符合t分布</h2>
<p>Kolmogorov-Smirnov连续分布检验: 检验单一样本是不是服从某一预先假设的特定分布的方法。以样本数据的累计频数分布与特定理论分布比较，若两者间的差距很小，则推论该样本取自某特定分布族。 该检验原假设为H0:数据集符合T分布，H1:样本所来自的总体分布不符合T分布。令F0(x)表示预先假设的理论分布，Fn(x)表示随机样本的累计概率(频率)函数. 统计量D为: D=max|F0(x) - Fn(x)| D值越小，越接近0，表示样本数据越接近T分布 p值，如果p-value小于显著性水平α(0.05)，则拒绝H0</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">set.seed(1)</div><div class="line">S&lt;-rt(1000, 1,2)</div><div class="line">ks.test(S, &quot;pt&quot;, 1, 2)</div></pre></td></tr></table></figure>
<p>其中p-value = 0.5461，说明数据集S符合df1=1, ncp=2的T分布</p>
<h2 id="方差齐性检验">方差齐性检验</h2>
<p>t检验过程，是对两样本均数(mean)差别的显著性进行检验。惟t检验须知道两个总体的方差(Variances)是否相等；t检验值的计算会因方差是否相等而有所不同。也就是说，t检验须视乎方差齐性(Equality of Variances)结果。但现在多数统计软件中已经有了方差不齐情况下的检验。另外，在ANOVA检验中，也要进行方差齐性检验。</p>
<h2 id="t检验">t检验</h2>
<p>T检验，亦称student t检验（Student’s t test），主要用于样本含量较小（例如n&lt;30），<strong>总体标准差σ未知</strong>的正态分布资料。</p>
<p>在此要提一下Z检验。 Z检验是一般用于<strong>大样本（即样本容量大于30）</strong>平均值差异性检验的方法。它是用<strong>标准正态分布</strong>的理论来推断差异发生的概率，从而比较两个平均数&gt;平均数的差异是否显著。当<strong>已知标准差</strong>时，验证一组数的均值是否与某一期望值相等时，用Z检验。</p>
<p>R中t检验的函数为t.test()，参数如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">t.test(x, <span class="keyword">...</span>)</div><div class="line"></div><div class="line">t.test(x, y = <span class="literal">NULL</span>,alternative = c(<span class="string">"two.sided"</span>, <span class="string">"less"</span>, <span class="string">"greater"</span>),mu = <span class="number">0</span>, paired = <span class="literal">FALSE</span>, var.equal = <span class="literal">FALSE</span>,      conf.level = <span class="number">0.95</span>, <span class="keyword">...</span>)</div></pre></td></tr></table></figure>
<p>参数说明 其中x, y是我们样本数据构成的向量，alternative表示备择假设的形式，“two.sided”表示双边检验（H1: 1不等于μ2）， “less”表示单边检验（H1:μ1小于μ2），“greater”表示单边检验（H1:μ1大于μ2），paired表示样本是否是配对的，var.equal表示两总体方差是否相等。</p>
<h3 id="案例运用">案例运用</h3>
<h4 id="配对t检验">配对t检验</h4>
<p>例3-6为比较两种方法对乳酸饮料中脂肪含量测定结果是否不同，随机抽取了10份乳酸饮料制品，分别用脂肪酸水解法和哥特里－罗紫法测定其结果如表3-5第(1)~(3)栏。问两法测定结果是否不同？（《医学统计学》（第四版，孙振球）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">raw_data &lt;- read.csv(&quot;https://raw.githubusercontent.com/20170505a/raw_data/master/data_szq_306.csv&quot;,sep=&quot;\t&quot;)</div><div class="line"># read raw data</div><div class="line"></div><div class="line">t.test(raw_data$result[1:10]-raw_data$result[11:20],mu=0)</div></pre></td></tr></table></figure>
<p>计算结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">&gt; t.test(raw_data$result[<span class="number">1</span>:<span class="number">10</span>]-raw_data$result[<span class="number">11</span>:<span class="number">20</span>],mu=<span class="number">0</span>)</div><div class="line"></div><div class="line">	One Sample t-test</div><div class="line"></div><div class="line">data:  raw_data$result[<span class="number">1</span>:<span class="number">10</span>] - raw_data$result[<span class="number">11</span>:<span class="number">20</span>]</div><div class="line">t = <span class="number">7.926</span>, df = <span class="number">9</span>, p-value = <span class="number">2.384e-05</span></div><div class="line">alternative hypothesis: true mean is not equal to <span class="number">0</span></div><div class="line"><span class="number">95</span> percent confidence interval:</div><div class="line"> <span class="number">0.1946542</span> <span class="number">0.3501458</span></div><div class="line">sample estimates:</div><div class="line">mean of x </div><div class="line">   <span class="number">0.2724</span></div></pre></td></tr></table></figure>
<p>结果与书中相同，p值小于0.01，但我觉得这个方法不一定要用配对t检验，普通的t检验也能胜任。</p>
<h4 id="双样本t检验">双样本t检验</h4>
<p>例3-7 为研究国产四类新药阿卡波糖胶囊的降血糖效果，某医院用40名II型糖尿病病人进行同期随机对照试验。研究者将这些病人随机等分到试验组(用阿卡波糖胶囊)和对照组(用拜唐苹胶囊)，分别测得试验开始前和8周时的空腹血糖，算得空腹血糖下降值见表3-6，能否认为该国产四类新药阿卡波糖胶囊与拜唐苹胶囊对空腹血糖的降糖效果不同？（《医学统计学》（第四版，孙振球）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">raw_data &lt;- read.csv(&quot;https://raw.githubusercontent.com/20170505a/raw_data/master/data_szq_307.csv&quot;,,header=T,sep=&quot;,&quot;)</div><div class="line"></div><div class="line">a &lt;- as.numeric(raw_data[,1])</div><div class="line">b &lt;- as.numeric(raw_data[,2])</div><div class="line">t.test(a,b)</div></pre></td></tr></table></figure>
<p>运算结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">	Welch Two Sample t-test</div><div class="line"></div><div class="line">data:  a and b</div><div class="line">t = -<span class="number">0.64187</span>, df = <span class="number">36.086</span>, p-value = <span class="number">0.525</span></div><div class="line">alternative hypothesis: true difference <span class="keyword">in</span> means is not equal to <span class="number">0</span></div><div class="line"><span class="number">95</span> percent confidence interval:</div><div class="line"> -<span class="number">2.32926</span>  <span class="number">1.20926</span></div><div class="line">sample estimates:</div><div class="line">mean of x mean of y </div><div class="line">    <span class="number">2.065</span>     <span class="number">2.625</span></div></pre></td></tr></table></figure>
<p>结果p值为0.525。因此尚不能认为阿卡波糖胶囊与拜唐苹胶囊对空腹血糖的降糖效果不同。</p>
<h2 id="t检验的局限">t检验的局限</h2>
<p>虽然t检验使用起来很方便，但是如果不加以注意，很容易误用，经常误用的情况包括：</p>
<ol style="list-style-type: decimal">
<li>不考虑数据的正态性，只要是两组比较就直接使用t检验（如果不符合正态性，就要采用Wilcoxon检验）。</li>
<li>将t检验用于多组实验设计中的两两比较，增加假阳性错误（此时应该使用ANOVA）；</li>
<li>不考虑资料是否独立，采用独立资料的t检验分析。</li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2017/06/02/BioStatistics/生物统计-02点估计与区间估计笔记/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/06/02/BioStatistics/生物统计-02点估计与区间估计笔记/" itemprop="url">点估计与区间估计笔记</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-06-02T12:00:00+08:00">
                2017-06-02
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/生物统计/" itemprop="url" rel="index">
                    <span itemprop="name">生物统计</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  6,055
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  24
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="点估计">点估计</h2>
<p>用于估计总体参数的统计量叫做估计量(estimator)。统计量是随机变量，估计量也是，对于不同的样本，估计量的聚会也不同，对于任意取定的一个样本，把样本数据代谢估计量的公式，就得到了估计量的一个值，称为估计值(estimate)或者估计量的一个实现(realization)。</p>
<p>衡量估计量的一个标准是相合性(consistency)，这个标准表明，样本量越大，相合估计量(consistent estimator)对总体参数的估计就越精确。另一个标准就是无偏性(unbiasedness)。这意味着，虽然从一个样本得到的估计量的实现并不一定等于总体参数的值，但无穷个估计量的平均观测值（期望值）等于相应的总体参数。满足这样条件的估计量称为无偏估计量(unbiased estimator)。第三个标准就是所有相合、无偏估计量中取方差最小的估计量，也称为最有效或者最好的估计量。</p>
<p>下面看一个简单的例子来介绍一下无偏性和最小方差性。假定<span class="math inline">\(X_{1},X_{2},X_{3},X_{4}\)</span>均服从某均值为<span class="math inline">\(\mu\)</span>的分布的独立观测值。如果我们需要从下面四个关于<span class="math inline">\(\mu\)</span>的估计量中选择一个，那么根据随机变量线性组合的总体均值和方差的性质，这四个估计量的均值都是<span class="math inline">\(\mu\)</span>，因此这个统计量都是<span class="math inline">\(\mu\)</span>的无偏估计量，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180806/AJG1HJEH2J.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>它们的方差分别为：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180806/Lb3A5FcH4D.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>因此，在这四个估计量中，第1个样本均值，即<span class="math inline">\(\bar{X}=\frac{1}{4} \sum\limits_{i=1}^4X_{i}\)</span>的方差最小，这个样本的估计量要优于其他三个。</p>
<p>最常用的估计量就是样本均值(<span class="math inline">\(\bar{x}\)</span>)、样本标准差(s)和(Bernoulli试验的)成功比例(x/n)，常用这几个统计量来分别估计总体均值(<span class="math inline">\(\mu\)</span>)、总体标准差(<span class="math inline">\(\delta\)</span>)和成功概率（或总体中具有某种特征元素的比值）p。</p>
<h2 id="区间估计">区间估计</h2>
<p>在讲区间估计之前，先看一个简单的例子。</p>
<p>当一个人谈论他高三时班上男生的平均身高时，他不太可能会说班长男生的平均身高是“171.25厘米”，而更可能会说“在170厘米左右”或者说“在1.65米到1.75米之间”。后者就是区间估计。</p>
<p>区间估计给出了估计者认为比较可能的一个范围，例如在民间调查中，如果调查是关于对某个看法的支持率时，也可能会说“对于该看法的支持率为45%加减3%的误差，其置信度为95%”，这种描述，既给出了点估计45%，这是样本中的支持率，也给出了一个区间，即45%±3%，或置信区间(confidence interval)(42%,48%).而这里的置信度(confidence level)则是对产生这样一个区间估计的一种信心，并不涉及从样本数据得到的某一个特定的区间。</p>
<p>一般来说，我们不知道总体参数（例如总体的均值或比例）是多少，需要通过样本来估计这个总体参数，其中点估计和区间估计都是从样本中得到的，而点估计中的估计量和区间估计的两个端都是统计量，因而也是随机变量。</p>
<p>“某总体参数ξ的置信度为100(1-α)%的置信区间”这句话表明：如果我们抽取（相同样本量）的大量样本，那么，从这些样本中得到的以同样方法（或公式）计算的大量区间中会有大约1-α比例的区间包含未知的总体参数ξ，而有约α比例的区间不包含该总体参数。例如从具体的一个样本中计算出来的一个数值区间，比如前面的(42%,48%)，这个区间可能包含真实的比例，也有可能不包含真实的比例。由于真实的比例和这个区间(42%,48%)都是确定的数，不包括随机性，也没有概率可言。因此如果用这样的话来描述“95%置信区间(42%,48%)以概率0.95包括真实比例”，这样的话是错误的。如果用概率语言来描述，应该说构造95%置信区间两个端的统计量以0.95的概率包含真实的参数（我觉得可以这么理解，我们在(42%,48%)这个区间内取机抽取一些样本，这些样本有0.95的概率包含真实值）。</p>
<p>通常来说，我们希望区间越窄越好，而另一方面，我们又希望置信度越大越好，对于一定的样本量，如果要增加置信度，通常要加宽区间，而如果要使区间变窄，就要牺牲置信度。但是，如果可以变化样本量，那么在固定了区间的宽度时，置信度会随着样本量的增加而增加，而在固定置信度时，区间宽度会随着样本量的增加而变窄。这主要是因为样本量大，对总体的信息也大，区间估计就会更理想。</p>
<h2 id="正态分布总体均值mu的区间估计">正态分布总体均值<span class="math inline">\(\mu\)</span>的区间估计</h2>
<p>假定X1,X2,..Xn是一个来自于正态分布的样本，我们可以根据这个样本求出关于这个正态总体均值的置信区间，我们知道，总体均值的一个点估计量为样本均值<span class="math inline">\(\bar{X}\)</span>，我们这里所要建立的对均值的区间估计就是以<span class="math inline">\(\bar{X}\)</span>为中心的一个区间，而区间的上下界是根据样本、事先选择的置信度以及正态分布的性质来确定的两个统计量。这样的置信度为1-α的随机区间由下式表示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180807/96ccl8HJeb.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>这里s为样本标准差，n为样本量，<span class="math inline">\(t_{\alpha/2}\)</span>为自由度为n-1的t分布的上侧<span class="math inline">\(\alpha/2\)</span>分位数，这里的上侧<span class="math inline">\(\alpha/2\)</span>分位数是指对于t(n-1)随机变量T，<span class="math inline">\(P(T&gt;t_{\alpha/2})=\alpha/2\)</span>。</p>
<p>这个区间的上下界是统计量，因此该区间是随机区间，置信度是是该随机区间覆盖真实均值的概率，如果根据一个样本的数据算出上下界的真实值，就不是随机区间了，而是一个固定的数值区间，这个区间的宽度为<span class="math inline">\(t\alpha/2s\ \sqrt{n}\)</span>。因此，可以看出，当其他因素固定时，区间宽度和样本量的平方根成反比，此外，由于当置信度1-α增加时，<span class="math inline">\(t_{\alpha/2}\)</span>也增加，因此当其他因素固定时，置信度增加会导致区间变宽，如果其他因素不变时，样本标准差s的减少也会导致置信区间变窄。</p>
<p>现在看一个案例。下面是某厂家标有“净重50克”的30包味精的实际重量，如下所示：</p>
<p>51.5,48.0,47.0,46.3,46.7,47.8,51.6,49.4,48.2,52.3,48.5,45.7,52.1,51.0,48.7,46.6,50.1,48.5,50.9,46.8,51.6,49.2,46.9,52.5,46.2,45.8,51.0,48.1,49.9,49.3</p>
<p>如果我们想要对这个厂家的这各味精重量的总体均值做出区间值估计，置信度取95%。</p>
<p>假定该总体服从正态分布，根据数据，计算出置信区间如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">&gt; data&lt;-c(<span class="number">51.5</span>,<span class="number">48.0</span>,<span class="number">47.0</span>,<span class="number">46.3</span>,<span class="number">46.7</span>,<span class="number">47.8</span>,<span class="number">51.6</span>,<span class="number">49.4</span>,<span class="number">48.2</span>,<span class="number">52.3</span>,<span class="number">48.5</span>,<span class="number">45.7</span>,<span class="number">52.1</span>,<span class="number">51.0</span>,<span class="number">48.7</span>,<span class="number">46.6</span>,<span class="number">50.1</span>,<span class="number">48.5</span>,<span class="number">50.9</span>,<span class="number">46.8</span>,<span class="number">51.6</span>,<span class="number">49.2</span>,<span class="number">46.9</span>,<span class="number">52.5</span>,<span class="number">46.2</span>,<span class="number">45.8</span>,<span class="number">51.0</span>,<span class="number">48.1</span>,<span class="number">49.9</span>,<span class="number">49.3</span>)</div><div class="line">&gt; data</div><div class="line"> [<span class="number">1</span>] <span class="number">51.5</span> <span class="number">48.0</span> <span class="number">47.0</span> <span class="number">46.3</span> <span class="number">46.7</span> <span class="number">47.8</span> <span class="number">51.6</span> <span class="number">49.4</span> <span class="number">48.2</span> <span class="number">52.3</span> <span class="number">48.5</span> <span class="number">45.7</span> <span class="number">52.1</span> <span class="number">51.0</span> <span class="number">48.7</span> <span class="number">46.6</span> <span class="number">50.1</span> <span class="number">48.5</span> <span class="number">50.9</span> <span class="number">46.8</span> <span class="number">51.6</span> <span class="number">49.2</span> <span class="number">46.9</span> <span class="number">52.5</span> <span class="number">46.2</span> <span class="number">45.8</span> <span class="number">51.0</span> <span class="number">48.1</span> <span class="number">49.9</span> <span class="number">49.3</span></div><div class="line">&gt; t.test(data,con=<span class="number">0.95</span>)</div><div class="line"></div><div class="line">        One Sample t-test</div><div class="line"></div><div class="line">data:  data</div><div class="line">t = <span class="number">125.94</span>, df = <span class="number">29</span>, p-value &lt; <span class="number">2.2e-16</span></div><div class="line">alternative hypothesis: true mean is not equal to <span class="number">0</span></div><div class="line"><span class="number">95</span> percent confidence interval:</div><div class="line"> <span class="number">48.14524</span> <span class="number">49.73476</span></div><div class="line">sample estimates:</div><div class="line">mean of x </div><div class="line">    <span class="number">48.94</span></div></pre></td></tr></table></figure>
<p>从上面结果可以看出来，这批数据的95%置信区间为(48.14524,49.73476)。</p>
<p>或者直接通过公式进行计算，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&gt; mean(data)+qt(<span class="number">0.025</span>,<span class="number">29</span>,low=<span class="literal">F</span>)*sd(data)/sqrt(<span class="number">30</span>)</div><div class="line">[<span class="number">1</span>] <span class="number">49.73476</span></div><div class="line">&gt; mean(data)-qt(<span class="number">0.025</span>,<span class="number">29</span>,low=<span class="literal">F</span>)*sd(data)/sqrt(<span class="number">30</span>)</div><div class="line">[<span class="number">1</span>] <span class="number">48.14524</span></div></pre></td></tr></table></figure>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180807/gA6FDi3lJ0.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>为了说明不同置信度和不同的样本量对置信区间的影响，下图显示了n=50和n=20，以及置信度为0.95和0.60的四种排列组合情况的各自基于80个正态样本的置信区间，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180809/BBHA0c4a6j.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>在下图中，置信区间为两边有短的竖直线段，线段中间的点为样本均值，图中水平虚线为真实的总体均值，从图中可以看到，对于固定的样本量，置信度越大，包含总体均值的区间就越多（上下图比较）。</p>
<p>而对于相同的置信度，样本量n越大，区间狭窄（左右图比较）。在每个图内部的各个置信区间的长短也不一样，这是因为样本标准差因样本而异，这也影响置信区间的长度，从图中可以看出，每个根据样本得到的置信区间，有的覆盖真实的总体均值，有的不覆盖真实的总体均值，但众多的置信区间中覆盖总体均值的区间数量的比例则反映了置信度的大小，这些区间都是随机区间的实现，而置信度只是随机区间覆盖总体均值的概率。</p>
<p>两个独立正态分布总体均值差<span class="math inline">\(\mu_{1}-\mu_{2}\)</span>的区间估计</p>
<p>假定样本量为m和n的独立样本<span class="math inline">\(X_{1},\cdots,X_{m}\)</span>和<span class="math inline">\(Y_{1},\cdots,Y_{n}\)</span>分别来自均值为<span class="math inline">\(\mu_{1}\)</span>和<span class="math inline">\(\mu_{2}\)</span>的两个独立正态总体，现在求出这两个正态总体均值之差<span class="math inline">\(\mu_{1}-\mu_{2}\)</span>的置信区间。总体均值差的一个点估计量为样本均值<span class="math inline">\(\bar{X}-\bar{Y}\)</span>，此时要求的均值差的区间估计就是以<span class="math inline">\(\bar{X}-\bar{Y}\)</span>为中心的一个区间，而区间的上下界为根据样本、选择的置信度以及正态分布的性质来确定的两个统计量。这个计算过程由统计软件完成，但在计算的时候，要注意两点，第一，当两个总体的方差一样时，统计软件会用一种方法来计算置信区间；第二，当两个总体的方差不同时，需要用另外一种方法来计算置信区间。</p>
<p>现在看一案例。</p>
<p>下面的这组数据描述了两个生产线生产每一个零件的耗时（单位：s）记录。其中第一个生产线记录了27个时间，第二个记录了25个时间，现在我们计算一下第一个和第二个生产线生产一个零件所花的时间均值差别为95%的置信区间。我们假定两个记录均来自独立正态分布的总体，下面是这两个记录，如下所示：</p>
<p>生产线1:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">25.8,30.1,26.8,33.3,26.9,33.7,34.5,24.6,31.7,39.1,29.5,25.6,28.2,29.5,32.4,23.7,</div><div class="line">26.2,28.0,30.1,31.0,29.5,37.7,28.6,27.0,29.8,27.6,29.0</div></pre></td></tr></table></figure>
<p>生产线2:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">28.7,31.1,27.9,28.7,30.2,30.5,23.3,27.5,29.5,28.6,26.6,26.8,26.6,29.6,30.4,24.8,</div><div class="line">24.4,25.3,30.6,27.3,27.2,32.0,27.6,29.6,25.8</div></pre></td></tr></table></figure>
<p>在比较这两组数据之前，需要比较两个正态总体相等或不相等时，关于均值差的置信区间计算有所不同，现在我们用x和y分别表示两个样本。</p>
<p>检验方差是不相等时，使用<code>var.test(x,y)$p.value</code>，此时会得到一个数值，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">&gt; x&lt;-c(<span class="number">25.8</span>,<span class="number">30.1</span>,<span class="number">26.8</span>,<span class="number">33.3</span>,<span class="number">26.9</span>,<span class="number">33.7</span>,<span class="number">34.5</span>,<span class="number">24.6</span>,<span class="number">31.7</span>,<span class="number">39.1</span>,<span class="number">29.5</span>,</div><div class="line">+      <span class="number">25.6</span>,<span class="number">28.2</span>,<span class="number">29.5</span>,<span class="number">32.4</span>,<span class="number">23.7</span>,<span class="number">26.2</span>,<span class="number">28.0</span>,<span class="number">30.1</span>,<span class="number">31.0</span>,<span class="number">29.5</span>,<span class="number">37.7</span>,</div><div class="line">+      <span class="number">28.6</span>,<span class="number">27.0</span>,<span class="number">29.8</span>,<span class="number">27.6</span>,<span class="number">29.0</span>)</div><div class="line">&gt; y&lt;-c(<span class="number">28.7</span>,<span class="number">31.1</span>,<span class="number">27.9</span>,<span class="number">28.7</span>,<span class="number">30.2</span>,<span class="number">30.5</span>,<span class="number">23.3</span>,<span class="number">27.5</span>,<span class="number">29.5</span>,<span class="number">28.6</span>,<span class="number">26.6</span>,</div><div class="line">+      <span class="number">26.8</span>,<span class="number">26.6</span>,<span class="number">29.6</span>,<span class="number">30.4</span>,<span class="number">24.8</span>,<span class="number">24.4</span>,<span class="number">25.3</span>,<span class="number">30.6</span>,<span class="number">27.3</span>,<span class="number">27.2</span>,<span class="number">32.0</span>,</div><div class="line">+      <span class="number">27.6</span>,<span class="number">29.6</span>,<span class="number">25.8</span>)</div><div class="line">&gt; var.test(x,y)</div><div class="line"></div><div class="line">	<span class="literal">F</span> test to compare two variances</div><div class="line"></div><div class="line">data:  x and y</div><div class="line"><span class="literal">F</span> = <span class="number">2.7086</span>, num df = <span class="number">26</span>, denom df = <span class="number">24</span>, p-value = <span class="number">0.01657</span></div><div class="line">alternative hypothesis: true ratio of variances is not equal to <span class="number">1</span></div><div class="line"><span class="number">95</span> percent confidence interval:</div><div class="line"> <span class="number">1.205780</span> <span class="number">6.006175</span></div><div class="line">sample estimates:</div><div class="line">ratio of variances </div><div class="line">          <span class="number">2.708634</span> </div><div class="line"></div><div class="line">&gt; var.test(x,y)$p.value</div><div class="line">[<span class="number">1</span>] <span class="number">0.01656675</span></div></pre></td></tr></table></figure>
<p>在这个案例中，此时的p值为0.01656675，这就说明，如果说方差不相等，那么出错的概率约为0.0166，它是小于0.05的（通常以这个显著性水平来判断），因此可认为方差不等。</p>
<p>此时我们使用<code>t.test(x,y,con=0.95)$con</code>就可以得到方差不等时的95%置信区间，因为在R中，<code>t.test()</code>这个函数默认的参数中，<code>var=F</code>，如果方差相等，那么就使用<code>t.test(x,y,con=0.95,var=T)$con</code>来计算置信区间，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&gt; t.test(x,y,con=<span class="number">0.95</span>)$con</div><div class="line">[<span class="number">1</span>] -<span class="number">0.1025709</span>  <span class="number">3.3064227</span></div><div class="line">attr(,<span class="string">"conf.level"</span>)</div><div class="line">[<span class="number">1</span>] <span class="number">0.95</span></div></pre></td></tr></table></figure>
<p>注：求两个样本差值的置信区间公式如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180809/H33EfhL97l.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h2 id="配对正态分布总体均值差mu_dmu_1-mu_2的区间估计">配对正态分布总体均值差<span class="math inline">\(\mu_{D}=\mu_{1}-\mu_{2}\)</span>的区间估计</h2>
<p>看完了独立正态总体的均值差的区间估计。再看一下两个总体是配对的情况(paired)，这种情况下，它们的样本称为配对样本，常见的情况有减肥前后的重量比较，治疗前后的症状比较，同样情况下对两种材料某种性能的比较，看下面一个案例。</p>
<p>一个有13人畚听减肥计算实话前后所称体重列在下表中，这里的X和Y分别是减肥前后的重量，而D为其差值，如下所示：</p>
<table>
<thead>
<tr class="header">
<th>X</th>
<th>88.9</th>
<th align="center">107.3</th>
<th>106.2</th>
<th>121.8</th>
<th>103.7</th>
<th>133.8</th>
<th>65.5</th>
<th>77.7</th>
<th>50.8</th>
<th>81.5</th>
<th>95.6</th>
<th>74.4</th>
<th>96.7</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Y</td>
<td>58.5</td>
<td align="center">119.6</td>
<td>80.8</td>
<td>97.5</td>
<td>106.3</td>
<td>106.5</td>
<td>43</td>
<td>66.4</td>
<td>55</td>
<td>61.1</td>
<td>95.2</td>
<td>59.1</td>
<td>103.8</td>
</tr>
<tr class="even">
<td>D</td>
<td>30.4</td>
<td align="center">-12.3</td>
<td>25.4</td>
<td>24.3</td>
<td>-2.6</td>
<td>27.3</td>
<td>22.5</td>
<td>11.3</td>
<td>-4.2</td>
<td>20.4</td>
<td>0.4</td>
<td>15.3</td>
<td>-7.1</td>
</tr>
</tbody>
</table>
<p>现在我们计算一下减肥前后体重差值的均值<span class="math inline">\(\mu_{D}(=\mu_{1}-\mu_{2})\)</span>的估计，这里假定重量区间为正态分布。</p>
<p>在这个案例中，减肥前后的体重并不是独立的，不是独立的是指，减肥前的体重与减肥后的体重只是与同一个人比较才有意义，因此这个问题不能用前面对待两个独立样本的方法来求估计值。不过，可以把每个人减肥前后的重量相减，用得到的差值来进行估计，我们用(X,Y)代表配对样本，样本量为n，均值分别为<span class="math inline">\(\mu_{1}\)</span>和<span class="math inline">\(\mu_{2}\)</span>，并令D=X-Y为这两个样本相应元素之间的差，即对于<span class="math inline">\(i=1,\cdots,n,D_{i}=X_{i}-Y_{i}\)</span>，假定D服从均值为<span class="math inline">\(\mu_{D}(=\mu_{1}-\mu_{2})\)</span>的正态分布，在这种情况下，问题就转化成了求单样本均值估计的问题了，现在过计算一下<span class="math inline">\(\mu_{D}\)</span>的95%置信区间就是(2.627,20.619)，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">&gt; x&lt;-c(<span class="number">88.9</span>,<span class="number">107.3</span>,<span class="number">106.2</span>,<span class="number">121.8</span>,<span class="number">103.7</span>,<span class="number">133.8</span>,<span class="number">65.5</span>,<span class="number">77.7</span>,<span class="number">50.8</span>,<span class="number">81.5</span>,<span class="number">95.6</span>,<span class="number">74.4</span>,<span class="number">96.7</span>)</div><div class="line">&gt; y&lt;-c(<span class="number">58.5</span>,<span class="number">119.6</span>,<span class="number">80.8</span>,<span class="number">97.5</span>,<span class="number">106.3</span>,<span class="number">106.5</span>,<span class="number">43</span>,<span class="number">66.4</span>,<span class="number">55</span>,<span class="number">61.1</span>,<span class="number">95.2</span>,<span class="number">59.1</span>,<span class="number">103.8</span>)</div><div class="line">&gt; t.test(x,y,paired=<span class="literal">T</span>)$conf</div><div class="line">[<span class="number">1</span>]  <span class="number">2.627241</span> <span class="number">20.618913</span></div><div class="line">attr(,<span class="string">"conf.level"</span>)</div><div class="line">[<span class="number">1</span>] <span class="number">0.95</span></div><div class="line">&gt; t.test(x-y)$conf</div><div class="line">[<span class="number">1</span>]  <span class="number">2.627241</span> <span class="number">20.618913</span></div><div class="line">attr(,<span class="string">"conf.level"</span>)</div><div class="line">[<span class="number">1</span>] <span class="number">0.95</span></div></pre></td></tr></table></figure>
<h2 id="总体比例bernoulli试验成功概率p的区间估计">总体比例(Bernoulli试验成功概率)p的区间估计</h2>
<p>在抽样调查中，计算某特征的总体比例是最基本的目的之一，任何一个调查报告，都应给出样本比例，以及所描述的总体比例的具有某置信度的置信区间，下面就是一个案例。</p>
<p>某地对1050人的随机调查结果显示，有1048人支持减少公车数量，另外，有人调查了政府机关中盺30人，有2人支持减少官员公车数量，我们希望分别找根据这两个调查数据找出总体中支持减少公车的人的比例的点估计以及其置信度为95%的置信区间，并且比较这两个调查。</p>
<p>我们知道，严格说来，抽样调查应该是不施加抽样，而样本中具有某种特征的元素数目应该属于超几何分布，但在大总体时，可以看成为放回抽样，因此可以看成近似于二项分布。如果总体量大，且样本量充分大时，那么根据中心极限定量，可以用视为近似正态分布。</p>
<p>假定样本量为n，样本中具有某种特征的元素数目(Bernoulli试验成功次数)为x，而样本比例为<span class="math inline">\(\hat{p}=x/n​\)</span>，在这种符号，用正态近似计算总体比例的置信度为<span class="math inline">\((1-\alpha)​\)</span>的置信区间的公式如下所示： <img src="http://ortxpw68f.bkt.clouddn.com/professional/180810/DGcgh6hD75.png?imageslim" alt="mark"></p>
<p>这里的<span class="math inline">\(z_{\alpha/2}\)</span>是标准正态分布的上<span class="math inline">\(\alpha/2\)</span>分位点。但是，一般来说，很难确定需要多大样本才能使用用正态分布。如果使用这个公式计算出来的区间包含了0或者1，则说明样本不够大，这是因为总体比例不可能小于0，也不可能大于1，是否为大样本，不仅依赖于n，而且依赖于<span class="math inline">\(\hat{p}\)</span>的大小，当<span class="math inline">\(\hat{p}\)</span>越接近于0或1时，为了正态近似所需要样本量就越大。</p>
<p>现在看前面的这个案例的计算结果。</p>
<p>第一个调查，n=1050，x=1048，那么<span class="math inline">\(\hat{p}=x/n=0.9980952\)</span> p的精确95%置信区间计算如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">&gt; n=<span class="number">1050</span></div><div class="line">&gt; x=<span class="number">1048</span></div><div class="line">&gt; binom.test(x,n,con=<span class="number">0.95</span>)</div><div class="line"></div><div class="line">	Exact binomial test</div><div class="line"></div><div class="line">data:  x and n</div><div class="line">number of successes = <span class="number">1048</span>, number of trials = <span class="number">1050</span>, p-value &lt; <span class="number">2.2e-16</span></div><div class="line">alternative hypothesis: true probability of success is not equal to <span class="number">0.5</span></div><div class="line"><span class="number">95</span> percent confidence interval:</div><div class="line"> <span class="number">0.9931364</span> <span class="number">0.9997692</span></div><div class="line">sample estimates:</div><div class="line">probability of success </div><div class="line">             <span class="number">0.9980952</span></div></pre></td></tr></table></figure>
<p>也就是( 0.9931364,0.9997692)，置信区间宽度为0.0066328。</p>
<p>也可以使用<code>Hmisc</code>包中的<code>binconf</code>函数来计算，binconf函数的用法为binconf(x,n,alpha=c,method=“all”)，它计算的是三种置信区间：</p>
<p>(1)精确置信区间；</p>
<p>(2)一种Wilson近似区间；</p>
<p>(3)正态近似区间，其中置信度为1-c（我们计算的是95%置信区间，因此这里的c就是0.05）。</p>
<p>如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&gt; binconf(x,n,alpha=<span class="number">0.95</span>,method=<span class="string">"all"</span>)</div><div class="line">            PointEst     Lower     Upper</div><div class="line">Exact      <span class="number">0.9980952</span> <span class="number">0.9973564</span> <span class="number">0.9984768</span></div><div class="line">Wilson     <span class="number">0.9980952</span> <span class="number">0.9980090</span> <span class="number">0.9981778</span></div><div class="line">Asymptotic <span class="number">0.9980952</span> <span class="number">0.9980109</span> <span class="number">0.9981796</span></div></pre></td></tr></table></figure>
<p>第三行就是近拟正态分布的95%置信区间。</p>
<p>再看第二个调查，n=30，x=2，那么<span class="math inline">\(\hat{p}=x/n=0.0666667\)</span> p的精确95%置信区间计算如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">&gt; n=<span class="number">30</span></div><div class="line">&gt; x=<span class="number">2</span></div><div class="line">&gt; binom.test(x,n,con=<span class="number">0.95</span>)</div><div class="line"></div><div class="line">	Exact binomial test</div><div class="line"></div><div class="line">data:  x and n</div><div class="line">number of successes = <span class="number">2</span>, number of trials = <span class="number">30</span>, p-value = <span class="number">8.68e-07</span></div><div class="line">alternative hypothesis: true probability of success is not equal to <span class="number">0.5</span></div><div class="line"><span class="number">95</span> percent confidence interval:</div><div class="line"> <span class="number">0.008178134</span> <span class="number">0.220735402</span></div><div class="line">sample estimates:</div><div class="line">probability of success </div><div class="line">            <span class="number">0.06666667</span></div></pre></td></tr></table></figure>
<p>也就是( 0.008178134,,0.220735402)，置信区间宽度为0.2125573。</p>
<p>也可以使用<code>Hmisc</code>包中的<code>binconf</code>函数来计算，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&gt; binconf(x,n,alpha=<span class="number">0.95</span>,method=<span class="string">"all"</span>)</div><div class="line">            PointEst     Lower     Upper</div><div class="line">Exact      <span class="number">0.9980952</span> <span class="number">0.9973564</span> <span class="number">0.9984768</span></div><div class="line">Wilson     <span class="number">0.9980952</span> <span class="number">0.9980090</span> <span class="number">0.9981778</span></div><div class="line">Asymptotic <span class="number">0.9980952</span> <span class="number">0.9980109</span> <span class="number">0.9981796</span></div></pre></td></tr></table></figure>
<p>从上面的两个计算结果可以看出，第一个正态近似所得到的区间包含了1，因此应该采用精确方法计算的区间，精确的区间宽度只有约0.0066328，非常精确，按照抽样调查通常的说法是“误差约为±0.332%”，因此可以说“该地公众中约有99.8%的人支持减少官员公车的数量，误差为0.332%”。对于第二个调查来说，正态近似公式区间和精确区间有些出入，第二个调查得到的精确区间宽度约为0.2125573，是第一个区间的32.05倍，很不精确，可以说“该地政府机关工作者中有约6.7%的人支持减少公车的数量，误差为±10.628%。</p>
<p>第一个调查代表了群众的观点，第二个调查只代表了政府机关工作人员的观点，从这个例子可以看出，只给出比例是不行的，必须给出样本量或者具有某置信度的置信区间，还应该告知抽样的对象和范围。很多调查报告只给出比例是不合适的 ，假定关于某药品疗效的调查的样本量是2，有效率是1/2，那么有效率的95%置信区间为(0.01257912,0.9874209)，区间宽度为0.9748418，几乎和所有可能取值范围(0,1)相同，这样结果没有任何意义，但如果不给出分母或给出具有某置信度的置信区间，而只说50%有效，必然会误导大众。</p>
<h2 id="如何概算调查所需的样本量">如何概算调查所需的样本量</h2>
<p>在美国总统选举的各种民意测序人中，关于支持率的一个常用标准是置信度为95%，而误差在3%以内（置信区间宽度为6%）。那么要达到这样的标准需要调查多少人，就需要概算一下样本量了，我们可以根据前面关于总体比例置信区间的正态近似公式，由<span class="math inline">\(\hat{p}\)</span>、<span class="math inline">\(z_{\alpha/2}\)</span>来推算样本量，通过查表或者统计软件，容易得出<span class="math inline">\(z_{0.025}\approx1.96\)</span>，如果取<span class="math inline">\(\hat{p}=0.5\)</span>，那么由下面的公式可以计算：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180811/54Dfh0cg4a.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>求得n=1067.11，取大于它的最小整数，得n=1068，这就是说，至少要问1068个人，人们可能会问，为什么取<span class="math inline">\(\hat{p}=0.5\)</span>呢，这是因为人们在抽样前并不知道<span class="math inline">\(\hat{p}\)</span>是多少，而在<span class="math inline">\(\hat{p}=0.5\)</span>时，需要的n最大，因此保险的作用是在计算样本量时取<span class="math inline">\(\hat{p}=0.5\)</span>，比方说，假如取了<span class="math inline">\(\hat{p}=0.1\)</span>，会得到n=385，这时，如果真实的<span class="math inline">\(\hat{p}=0.5\)</span>，那么误差就约等于0.0499，大于要求的0.03了。</p>
<h2 id="总体比例之差p_1-p_2的区间估计">总体比例之差<span class="math inline">\(p_{1}-p_{2}\)</span>的区间估计</h2>
<p>现在通过以下案例来说明两个比例之差的区间估计 两个商场某天对某品牌的洗衣粉的销售表明，在商场A的1217名顾客中，购买这种洗衣粉的有53名，而在商场B的1750个顾客中，购买这种洗衣粉的有20人，假定两个商场的交易分别代表两个总体，求这两个总体中购买该品牌洗衣粉的比例之间的区间估计。</p>
<p>这里有两个总体比例，分别是商场A和B所有交易中购买该品牌洗衣粉的比例，现在的数据表明<span class="math inline">\(n_{1}=1217,x_{1}=53,n_{2}=1750,x_{2}=20\)</span>，假定两个总体比例分别是<span class="math inline">\(p_{1}\)</span>和<span class="math inline">\(p_{2}\)</span>，我们希望求这两个总体比例之差<span class="math inline">\(p_{1}-p_{2}\)</span>的95%点估计和区间估计，令<span class="math inline">\(\hat{p_{1}}=x_{1}/n_{1}\)</span>，<span class="math inline">\(\hat{p_{2}}=x_{2}/n_{2}\)</span>。</p>
<p>点估计很好计算，<span class="math inline">\(\hat{p_{1}}-\hat{p_{2}}\)</span>即可，区间估计一般都使用正态分布近似或者<span class="math inline">\(\chi^2\)</span>分布近似区间。常用的正态近似公式有几种，常用的是下面的这一种：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180811/DmmH22ibgc.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>而且都可以为了适应连续分布而做连续性修正，在这个案例中，这两个总体比例之差<span class="math inline">\(p_{1}-p_{2}\)</span>的95%置信区间为(0.01892344,0.04531884)，计算过程如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&gt; prop.test(c(<span class="number">53</span>,<span class="number">20</span>),c(<span class="number">1217</span>,<span class="number">1750</span>),con=<span class="number">0.95</span>)$con</div><div class="line">[<span class="number">1</span>] <span class="number">0.01892344</span> <span class="number">0.04531884</span></div><div class="line">attr(,<span class="string">"conf.level"</span>)</div><div class="line">[<span class="number">1</span>] <span class="number">0.95</span></div></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2017/06/01/BioStatistics/生物统计-01统计学基础/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/06/01/BioStatistics/生物统计-01统计学基础/" itemprop="url">统计学基础汇总</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-06-01T12:00:00+08:00">
                2017-06-01
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/生物统计/" itemprop="url" rel="index">
                    <span itemprop="name">生物统计</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  9,833
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  38
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="统计学术语">统计学术语</h2>
<p>下面是一些常见的医学或生物学统计学术语。</p>
<h2 id="数据和变量">数据和变量</h2>
<p>在了解这两个术语之前，先看一组数据，从这组数据出发，说明这几个术语。</p>
<p>这组数据是R中自带的数据集，即<code>iris</code>这个数据集，iris数据集的中文名是安德森鸢尾花卉数据集，英文全称是Anderson’s Iris data set。iris包含150个样本，对应数据集的每行数据。每行数据包含每个样本的四个特征和样本的类别信息，所以iris数据集是一个150行5列的二维表，我们先看一下这个数据集的结构，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">&gt; str(iris)</div><div class="line"><span class="string">'data.frame'</span>:   <span class="number">150</span> obs. of  <span class="number">5</span> variables:</div><div class="line"> $ Sepal.Length: num  <span class="number">5.1</span> <span class="number">4.9</span> <span class="number">4.7</span> <span class="number">4.6</span> <span class="number">5</span> <span class="number">5.4</span> <span class="number">4.6</span> <span class="number">5</span> <span class="number">4.4</span> <span class="number">4.9</span> <span class="keyword">...</span></div><div class="line"> $ Sepal.Width : num  <span class="number">3.5</span> <span class="number">3</span> <span class="number">3.2</span> <span class="number">3.1</span> <span class="number">3.6</span> <span class="number">3.9</span> <span class="number">3.4</span> <span class="number">3.4</span> <span class="number">2.9</span> <span class="number">3.1</span> <span class="keyword">...</span></div><div class="line"> $ Petal.Length: num  <span class="number">1.4</span> <span class="number">1.4</span> <span class="number">1.3</span> <span class="number">1.5</span> <span class="number">1.4</span> <span class="number">1.7</span> <span class="number">1.4</span> <span class="number">1.5</span> <span class="number">1.4</span> <span class="number">1.5</span> <span class="keyword">...</span></div><div class="line"> $ Petal.Width : num  <span class="number">0.2</span> <span class="number">0.2</span> <span class="number">0.2</span> <span class="number">0.2</span> <span class="number">0.2</span> <span class="number">0.4</span> <span class="number">0.3</span> <span class="number">0.2</span> <span class="number">0.2</span> <span class="number">0.1</span> <span class="keyword">...</span></div><div class="line"> $ Species     : Factor w/ <span class="number">3</span> levels <span class="string">"setosa"</span>,<span class="string">"versicolor"</span>,..: <span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="keyword">...</span></div></pre></td></tr></table></figure>
<p>再看一下前几条信息，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">&gt; head(iris)</div><div class="line">  Sepal.Length Sepal.Width Petal.Length Petal.Width Species</div><div class="line"><span class="number">1</span>          <span class="number">5.1</span>         <span class="number">3.5</span>          <span class="number">1.4</span>         <span class="number">0.2</span>  setosa</div><div class="line"><span class="number">2</span>          <span class="number">4.9</span>         <span class="number">3.0</span>          <span class="number">1.4</span>         <span class="number">0.2</span>  setosa</div><div class="line"><span class="number">3</span>          <span class="number">4.7</span>         <span class="number">3.2</span>          <span class="number">1.3</span>         <span class="number">0.2</span>  setosa</div><div class="line"><span class="number">4</span>          <span class="number">4.6</span>         <span class="number">3.1</span>          <span class="number">1.5</span>         <span class="number">0.2</span>  setosa</div><div class="line"><span class="number">5</span>          <span class="number">5.0</span>         <span class="number">3.6</span>          <span class="number">1.4</span>         <span class="number">0.2</span>  setosa</div><div class="line"><span class="number">6</span>          <span class="number">5.4</span>         <span class="number">3.9</span>          <span class="number">1.7</span>         <span class="number">0.4</span>  setosa</div></pre></td></tr></table></figure>
<p>从上面的这两个结果，我们可以得到这些信息：</p>
<p>第一，这个数据集一共有150行，5列。</p>
<p>第二，每1列的名称分别为<code>Sepal.Length</code>、<code>Sepal.Width</code>、<code>Petal.Length</code>、<code>Petal.Width</code>和<code>Species</code>，它们分别表示鸢尾花的花萼长度，花萼宽度、花瓣长度，花瓣宽度，种属，也就是说第1行中一共有这5个信息，我们把这5个信息称为<code>变量(variable)</code>。这里需要说明一下的是，变量(variable)在计算机/数据库等领域也叫属性(attribute)、特征(feature)、特性(characteristic)、字段(field)等等。</p>
<p>再回到<code>iris</code>这个数据集中。</p>
<p>其中，我们把种属(Species)这个信息称为<code>定性变量（qualitative variable）</code>，定性变量取的值称为<code>水平(level)</code>或<code>类(class)</code>。定性变量有其它的教材中也会称为分类变量(categorical variable)、属性变量(attributives variable)、名义变量/标称变量(nominal variable)或维度(dimension)。</p>
<p>再看其它的4个变量，它们是用具体的数字表示，这些变量称为<code>定量变量(quantitative variable)</code>，有也领域也称为指标。</p>
<p>定性变量的例子除了种属外，还有其他的例子，例如我们常见的性别，颜色等，在有些情况下，定量变量也会按照定性变量去处理，例如，为了调查方便，我们在问卷中可以只问高收入、中收入还是低收入，而不是问具体多少钱，这种定性变量还能进行排序，它们也常常称为定序变量（ordinal variable）。</p>
<p>定量变量还能分为<code>连续型变量(continuous variable)</code>和<code>离散型变量(discrete variable)</code>。</p>
<p>连续型变量的例子有身高、体重、热量、速度、长度等，它们的取值 是实数轴的某一个区间或者是某些区间集合中的所有可能点的变量。</p>
<p>离散型变量的例子有，某种事件发生的次数，例如抛5次硬币，在描述有几次正面朝上的时候，只可能是0次，1次，2次，3次，4次，5次，而不可能是1.5次这种小数，离散型变量只能取正整数或0。</p>
<p>还看上面的案例，整个<code>iris</code>这个数据集中，除了第1行的变量名称外，剩下的内容则是与这些变量对应的数据(data)，可以把数据看成变量的观测值，或者是试验结果，例如，身高是一个变量，测量一个人的身高，就好比一次试验，可观测到一次试验结果，就是<code>观测值(observation)</code>。这里还要提一下，观测值(observation)在计算机/数据库领域也叫记录(record)、对象(object)、向量(vector)、模式(pattern)、事件(event)、例(case,instance)、样本(sample)、或项、实体(entity)等等。</p>
<p>我们一般所说的数据是一个集合名词，每一个数字包含很多观测值，每个观测值也称为一个数据点(data point, point)或例(case)。就以这个<code>iris</code>的数据集为例，它的每1列代表一个变量，而每1行则为一个对象关于各个变量的观测值，簇也把这种数据方阵的每一行叫做一个观测（值），就像下面的样子，它就是一个观测：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180801/eDahJjI3Bk.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>这也是一个观测值，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180801/7ehl460k0I.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h2 id="概率和随机变量">概率和随机变量</h2>
<p>在统计学研究中，有很多对象都被认为具有随机性(randomness)，随机的事情也有规律的，例如我们抛一个硬币，在硬币落在地面之前，硬币朝哪面我们是不知道的，它是随机的，事先无法准确地预测。但是，只要这个硬币是正常的，没问题的，那么我们就知道，硬币朝上与朝下的概率基本上是相等的。</p>
<p>在这里，硬币的朝上与朝下的这个变量，它就是随机变量(random variable)。而一个随机变量的性质则完全被与其相关的概率或概率分布决定。那什么是概率？</p>
<p>一个事件(event)的概率(probability)是该事件发生可能性的一个数量度量，它的聚会范围是0到1，也可能是0或1.当一个事件的概率接近1时，则说明这个事件很可能发生；如果概率接近0，则说明不太可能发生，如果概率为0.5，那么说明该事件发生和不发生的可能性一样。</p>
<p>简单来说，概率称量某个事件出现的机会，有些概率在某种假定条件下可以算出来，例如抛硬币，得到正面朝上与反面朝上的概率都是0.5，这种可能计算概率的事件称为等可能事件（equally likely event)，这种可能是假定的，对于硬币来说，就是假定正面与反面朝上的㜅一样，如果我们抛了一千次，其中得到正面与反面朝上的频率或相对频数(relative frequency)都接近0.5，那么就说明这个硬币是公平的，是正常的，这些事件理论上可能通过重复试验中出现的频率来计算其发生的概率。</p>
<p>不过有些概率是无法用重复计算来估计的，例如有人认为，最近3个月内中东地区发生大规模军事冲突的概率是80%，这显著无法用重复试剂来估计，这只是他们基于过去的经合和掌握的信息形成的信息，这种概率称为主观概率(subjective probability)。</p>
<h2 id="利用r产生随机数">利用R产生随机数</h2>
<p>在进行抽样时，或者是模拟某个分布时，我们常常要用到随机数，现在都是用软件来生成随机数，虽然这种随机数不晃真正的随机数，但是已经足够使用了，使用软件生成的这种随机数称为伪随机数(pseudo-random number)，现在介绍一下用R来如何生成随机数。</p>
<p>现在生成10个2到3之间的，服从均匀分布的伪随机数，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&gt; set.seed(<span class="number">1000</span>)</div><div class="line">&gt; runif(<span class="number">10</span>,<span class="number">2</span>,<span class="number">3</span>)</div><div class="line"> [<span class="number">1</span>] <span class="number">2.327879</span> <span class="number">2.758846</span> <span class="number">2.113936</span> <span class="number">2.690755</span> <span class="number">2.516402</span> <span class="number">2.067738</span> <span class="number">2.738715</span> <span class="number">2.583535</span></div><div class="line"> [<span class="number">9</span>] <span class="number">2.215771</span> <span class="number">2.256122</span></div></pre></td></tr></table></figure>
<p>现在解释一下，先看<code>runif()</code>这个函数，在R中，这个函数前面的<code>r</code>表示随机，<code>unif</code>表示服从均匀分布，类似的还有<code>rnorm()</code>，它的功能类似，只是它生成的是服从正态分布的随机数，其中<code>norm</code>就是正态分布的意思。</p>
<p>现在，再看<code>set.seed(1000)</code>的作用是保证你随机生成的数字前后一致，如果它的参数就是一个数字，这个数字可以随意指定，括号里的数字只要一致，那么每次生成的随机数就一致，如果不使用这个函数，那么我们每次运行<code>runif(10,2,3)</code>，它生成的随机数就不一样，现在看一下下面的代码：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">&gt; runif(<span class="number">10</span>,<span class="number">2</span>,<span class="number">3</span>) <span class="comment"># 不指定set.seed()</span></div><div class="line"> [<span class="number">1</span>] <span class="number">2.567518</span> <span class="number">2.049710</span> <span class="number">2.561620</span> <span class="number">2.966179</span> <span class="number">2.509945</span> <span class="number">2.700937</span> <span class="number">2.020349</span> <span class="number">2.783569</span></div><div class="line"> [<span class="number">9</span>] <span class="number">2.584397</span> <span class="number">2.317293</span></div><div class="line">&gt; runif(<span class="number">10</span>,<span class="number">2</span>,<span class="number">3</span>) <span class="comment"># 再次运行runif(10,2,3),生成的结果就不一样</span></div><div class="line"> [<span class="number">1</span>] <span class="number">2.996208</span> <span class="number">2.531047</span> <span class="number">2.109908</span> <span class="number">2.633212</span> <span class="number">2.797929</span> <span class="number">2.712990</span> <span class="number">2.702835</span> <span class="number">2.562833</span></div><div class="line"> [<span class="number">9</span>] <span class="number">2.258873</span> <span class="number">2.506937</span></div><div class="line">&gt; set.seed(<span class="number">1000</span>) <span class="comment"># 指定set.seed(1000)</span></div><div class="line">&gt; runif(<span class="number">10</span>,<span class="number">2</span>,<span class="number">3</span>) <span class="comment"># 生成的结果就与前面的一样</span></div><div class="line"> [<span class="number">1</span>] <span class="number">2.327879</span> <span class="number">2.758846</span> <span class="number">2.113936</span> <span class="number">2.690755</span> <span class="number">2.516402</span> <span class="number">2.067738</span> <span class="number">2.738715</span> <span class="number">2.583535</span></div><div class="line"> [<span class="number">9</span>] <span class="number">2.215771</span> <span class="number">2.256122</span></div></pre></td></tr></table></figure>
<h2 id="个体总体样本和抽样">个体、总体、样本和抽样</h2>
<p>为了说明这几个术语，我们还要看一个案例。</p>
<p>我们要调查一下外地游客在重庆认路的情况进行调查，那么我们可以这么设计问题，“请问，你在重庆旅游时，是否很容易找到目的地？”可能的回答有这些：“很容易”，“不容易“，”不知道“。调查的目的是希望知道在重庆的游客中，对这个问题的三种回答所占的比例，显然不可能调查所有的游客，但我们可以调查其中的一部分，进而估计出在重庆的所有游客的回答。</p>
<p>在这个例子中，单个游客称为调查的对象(object)，他们的回答称为个体(element,或individual, unit)，而所有在重庆的游客对这个问题的回答称为一个总体(population)，总体是包含所有要研究的个体的集合，而调查时，问到那些游客则称为该总体的一个样本(sample)，是总体中挑选出来的一部分。</p>
<p>在抽取样本时，如果总体中的每一个体都有同等机会被选到样本中，这种抽样称为简单随机抽样(sample random sampling)，这样得到的样本称为随机样本(random sample)。不过即使是随机抽样，也不可能保证样本与总体的对应特征完全一样，会出现与总体的误差，这种误差无法避免，这样的误差称为抽样误差(sampling error)。</p>
<h3 id="观察单位observed-unit">观察单位（observed unit）</h3>
<p>观察单位也叫个体（individual），是统计研究中的基本单位，它可以是一个人，一头动物，也可能是特指一群人（例如一个家庭、一个幼儿园，一个自然村）。</p>
<h3 id="总体population">总体（population）</h3>
<p>根据研究目的而确定的同质观察单位的全体，更确切地说，它是同质的所有观察单位某种观察值的集合，例如调查某地2008年7岁正常女童的身高，而其中的观察单位（个体）则是每个女童。由于这里的总体明确规定了空间、时间、人群范围内有限个观察单位，因此称为<strong>有限总体（finite populaton）</strong>。而在一些情况下，总体的概念则是设想的或抽象的，例如研究某治疗慢性前列腺增生的药物的疗效，这里的总体的同质基础是慢性前列腺增生患者，该总体应包括用该药治疗的所有前列腺增生症患者的治疗结果，没有时间和空间的限制，其观察单位的全体数只是理论上存在的，因此可以视为“无限”，称为<strong>无限总体（infinite populaton）</strong>。</p>
<p>为了降低成本，因此在医学研究中通常彩从总体中抽取样本（sample）的方法，根据样本信息来推断总体特征，这种方法叫<strong>抽样研究（sampling research）</strong>，从总体中抽取部分观察单位的过程称为<strong>抽样（sampling）</strong>。</p>
<p>为了保证样本的代表性，抽样必须遵循<strong>随机化（randomization）</strong>原则。从总体中随机抽得的部分观察单位，其实际测量的集合就是样本，该样本中包含的观察单位数称为该样本的<strong>样本含量（sample size）</strong>。例中从某地2008年7岁正常女童中，随机抽取了110名女童，测量身高，得到了110名女童的身高测量值，组成了样本；也可能从就诊的前列腺增生症患者中随机抽取了100名患者，并观察药物的治疗效果，就组成了治疗效果的样本。</p>
<h3 id="变量variable">变量（variable）</h3>
<p>确定总体后，研究者对每个观察单位的某项特征进行观察或测量，这种特征能表现观察单位的变量异，就是变量。例如某地7岁女童的身高，体重都可以视为变量。</p>
<h3 id="统计推断">统计推断</h3>
<p>在实际研究工作中，受条件所限，在研究中很难得到整个总体，往往堡垒有得到总体中的一个子集，即实际工作中往往按随机的方式从总体中抽取若干有代表性的同质个体所构成的一个样本（sample）进行研究，这就需要通过样本有限的、不确定的信息来歓有关总体的特征，这就是统计推断（statistical inference），简言之，统计推断是指由样本所提供的信息对总体数量规律做出推断。</p>
<h3 id="强度相对数">强度相对数</h3>
<p>说明某现象发生的频率或强度，称为率。常以百分率(%)、千分率(‰)、万分率(1/万)、十万分率（1/10万）等表示。 例5-1：2839名职工，发生高血压5人，高血压发病率为5/2839=1.76‰。</p>
<h3 id="结构相对数">结构相对数</h3>
<p>表示事物内部某一部分的个体数与该事物部分个体数的总和之比，用来说明各构成部分在总体中所占的比重或分布，称为构成比，通常以100%为比例基数。 例5-2 某医院1990年因五种疾病死亡的人数共190人，其中死于恶性肿瘤者58人，恶性肿瘤死亡人数占五种疾病死亡人数的构成比为58/190=30.53% 。</p>
<h3 id="相对比">相对比</h3>
<p>相对比简称比(ratio)，是两个有关指标之比，说明两指标间的比例关系，通常以倍数或百分数（%）表示。例如某年医院出生婴儿中，男性为370，女性为358，则婴儿性别比为370/358*100=103</p>
<h3 id="同比">同比</h3>
<p>发展速度主要是为了消除季节变动的影响，用以说明本期发展水平与去年同期发展水平对比而达到的相对发展速度。如，本期2月比去年2月，本期6月比去年6月等。其计算公式为：同比发展速度=本期发展水平/去年同期发展水平×100%。</p>
<h3 id="环比">环比</h3>
<p>当前水平与前一时期水平之比，表明现象逐期的发展速度。如计算一年内各月与前一个月对比，即2月比1月，3月比2月，4月比3月 ……12月比11月，说明逐月的发展程度。</p>
<h2 id="数据的描述">数据的描述</h2>
<p>我们拿到一批数据，可能会考虑这些问题，这些数据是什么，这些数据如何表示，如何从整体上来描述这批数据。</p>
<h3 id="如何查看数据">如何查看数据</h3>
<h2 id="计量资料measurement-data">计量资料（measurement data）</h2>
<p>计量资料又叫定量资料（quantitative data）或数值变量资料(numerical variable)，表现为数值大小，一般有计量单位，例如身高多少厘米，体重多少公斤。根据测量值是否连续，又可分为连续型（continuous）和离散型（discrete），连续理革可在褛范围内聚任意值，例如身高，体重，而离散型只能取整数值，例如死亡人数。</p>
<h3 id="离散型数据discrete-data">离散型数据(discrete data)</h3>
<p>离散型数据本质上是一种分类。最典型的例子，就是性别、种族、职业、教育程度等。在多数情况下，离散型数据并没有具体的数值（比如性别中的男和女），或者虽然形式上由数值表示，但数值本身并没有明确的意义（比如用邮政编码来记录受试者居住的地域）。有些离散变量是有某种顺序关系的，比如说教育程度可以从低到高排列，而有些离散变量并没有这种顺序，比如说某个基因的基因型。这两种情况分别称为有序变量(ordinal variable)和名义变量(nominal variable)。</p>
<h3 id="连续型数据continuous-data">连续型数据(continuous data)</h3>
<p>连续型数据的数值有具体的科学意义，并且可以在数轴上的某个范围连续取值比如身高、体重、血糖浓度、肾小球滤过率等。</p>
<h2 id="计数资料enumeration-data">计数资料（enumeration data）</h2>
<p>计数资料又称定性资料(qualitative data )或无序分类（unordered categorical variable）变量资料，亦称为名义变量资料，它的变量值是定性的，表现为互不相容的特性，例如结果的阴阳，家族史的有无等，分为两种：一种是二分类，例如治愈与未治愈，另一种是多分类，例如血型，A型，B型，AB型和O型。</p>
<h2 id="等级资料ranked-data">等级资料（ranked data）</h2>
<p>又称半定量资料（semi-quantitative data）或有序分类变量（ordinal categorical variable）资料：它将观察单位按某种程度分为等级，例如某药物治疗的效果为治愈、显效、好转、无效。</p>
<h2 id="数据整体的一般描述">数据整体的一般描述</h2>
<h3 id="极差">极差</h3>
<p>又叫全距(Range)，是用来表示统计资料中的变异量数(measures of variation)，其最大值与最小值之间的差距；即最大值减最小值后所得之数据。</p>
<h3 id="均值">均值</h3>
<p>通常情况下，我们所说的均值都是所有的数据之和除以数据的数目，但是，在一些特殊的情况下，会指明均值的类型，例如是算术均值，还是几何均值。</p>
<h3 id="算术均值arithmetic-mean">算术均值(arithmetic mean)</h3>
<p>算术平均数是对集中趋势的最常用的描述。我们对某个量进行了n次观测，把测量到的数值分别记为X1, X2,…, Xn，那么要得到算术平均数，只需把X1到Xn加起来，再除以数据的个数n。数学公式为： <span class="math display">\[ \bar{X}=\frac{\sum_{i=1}^nX{_i}}{n}  \]</span></p>
<h3 id="几何均值geometric-mean">几何均值（geometric mean）</h3>
<p>几何平均数是指n个观察值连乘积的n次方根。</p>
<h3 id="中位数median">中位数(median)</h3>
<p>中位数是把该变量所有取值从小到大（或从大到小）排序，取最中间的一个（例如总共有21个数，则取排行第11的）。如果样本量是偶数，则取中间两个数的平均。</p>
<h3 id="众数mode">众数(mode)</h3>
<p>一组数据中出现次数最多的数值，叫众数，有时众数在一组数中有好几个。用M表示。 理性理解：简单的说，就是一组数据中占比例最多的那个数。</p>
<p>例如：2，3，3，3，4，5的众数是3。 但是，如果有两个或两个以上个数出现次数都是最多的，那么这几个数都是这组数据的众数。 例如：2，2，3，3，4，5的众数是2和3。 其次，如果所有数据出现的次数都一样，那么这组数据没有众数。 例如：2，3，4，5没有众数。</p>
<h3 id="百分位数percentile">百分位数(percentile)</h3>
<p>如果将一组数据从小到大排序，并计算相应的累计百分位，则某一百分位所对应数据的值就称为这一百分位的百分位数。可表示为：一组n个观测值按数值大小排列。如，处于p%位置的值称第p百分位数。</p>
<h3 id="百分位数的计算">百分位数的计算</h3>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">w&lt;-c(75.0,64.0,47.4,66.9,62.2,62.2,58.7,63.5,66.6,64.0,57.0,69.0,56.9,50.0,72.0) # 建立向量w</div><div class="line">quantile(w) # 给出w的四分位数</div><div class="line">quantile(w,probs=seq(0,1,0.2),na.rm=FALSE) # 给出向量w的20%，40%分位数</div><div class="line">quantile(w,0.80) # 求w的80%分位数</div><div class="line">quantile(w,0.75)- quantile(w,0.25) #半极差计算</div></pre></td></tr></table></figure>
<p>结果如下： <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">&gt; quantile(w) # 给出w的四分位数</div><div class="line">   0%   25%   50%   75%  100% </div><div class="line">47.40 57.85 63.50 66.75 75.00 </div><div class="line">&gt; quantile(w,probs=seq(0,1,0.2),na.rm=FALSE) # 给出向量w的20%，40%分位数</div><div class="line">   0%   20%   40%   60%   80%  100% </div><div class="line">47.40 56.98 62.20 64.00 67.32 75.00 </div><div class="line">&gt; quantile(w,0.80) # 求w的80%分位数</div><div class="line">  80% </div><div class="line">67.32 </div><div class="line">&gt; quantile(w,0.75)- quantile(w,0.25) #半极差计算</div><div class="line">75% </div><div class="line">8.9</div></pre></td></tr></table></figure></p>
<p>另外一种方法是用<code>cumsum()</code>函数来计算：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">cumsum(round(table(w)/length(w)*100,2)) # cumsum表示的是累积之和</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&gt; cumsum(round(table(w)/length(w)*100,2)) # cumsum表示的是累积之和</div><div class="line">  47.4     50   56.9     57   58.7   62.2   63.5     64   66.6   66.9     69     72     75 </div><div class="line">  6.67  13.34  20.01  26.68  33.35  46.68  53.35  66.68  73.35  80.02  86.69  93.36 100.03</div></pre></td></tr></table></figure>
<h3 id="四分位数quartile">四分位数（Quartile)</h3>
<p>统计学中，把所有数值由小到大排列并分成四等份，处于三个分割点位置的数值就是四分位数。第一，四分位数 (Q1)，又称“较小四分位数”，等于该样本中所有数值由小到大排列后第25%的数字。第二，四分位数 (Q2)，又称“中位数”，等于该样本中所有数值由小到大排列后第50%的数字。第三，四分位数 (Q3)，又称“较大四分位数”，等于该样本中所有数值由小到大排列后第75%的数字。第三，四分位数与第一四分位数的差距又称四分位距（InterQuartile Range,IQR）。四分位距的优点在于，与全距（极差）相比，较少受异常值的影响。 R中用来显示四分位数的函数是quantile，另外用boxplot可以绘制出某个数据集的箱线图。</p>
<p>箱线图结果<code>boxplot(w)</code>如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/boxplot2.png">

</div>
<p>条睛线图的解读：最下面是下界，最上面的圆圈是上界，上界的圆圈是异常值，中间矩形的底边是下分位数，上边是上四分位数，中间的粗线是中位数，箱体的高是四分位距。</p>
<h2 id="数据离散程度的描述">数据离散程度的描述</h2>
<p>对于一批数据来说，我们有时候需要看一下这批数据的波动分散程度如何，这就需要一些指标。</p>
<h3 id="变异">变异</h3>
<p>医学研究的对象虽功能复杂的有机作整体。不同的个体在相同的条件下，对外因环境因素可以发生不同的反应，这种同质基础上个体特征值之间的差异，称为变异（variation）（医学统计学及SAS应用，王炳顺）。</p>
<h3 id="离均差">离均差</h3>
<p>每一个变量值X与均数<span class="math inline">\(\mu\)</span>的差值，即离均差(X-<span class="math inline">\(\mu\)</span>)。</p>
<h3 id="离均差平方和">离均差平方和</h3>
<p>由于离均差有正有负，最终所有离均差的和即<span class="math inline">\((X-\mu)\)</span>为0，因此离均差的和无法描述一组数据的变异大小。因此将离均差平方后相加得到平方和<span class="math inline">\(Var(X)=E(X-\mu)^2\)</span>，这就是离均差平方和（sum of squares of deviations from mean）。</p>
<h3 id="总体方差">总体方差</h3>
<p>虽然离均差平方和消除了正负的影响，但是如果变量值N越大，则离均差平方和也越大，为此，将离均离平方和除以N就得到了方差，方差用<span class="math inline">\(\delta^2\)</span>表示，计算公式为：</p>
<p><span class="math display">\[ \delta^2={\frac{\sum(X-\mu)^2}{N}}  \]</span></p>
<p>另外，方差（variance）也称均方差（mean square deviation）</p>
<h3 id="样本方差">样本方差</h3>
<p>上面的是总体方差，如果是样本方差，那么总体均值<span class="math inline">\(\mu\)</span>是未知的，因此，这个时候就要用样本的均值来替代总体的均值，这个时候也不能用<span class="math inline">\(\delta^2\)</span>来表示样本方差，需要用<span class="math inline">\(s^2\)</span>来表示方差，此外，N值也要减去1，公式就如下所示：</p>
<p>$s^2={} $</p>
<h3 id="标准差">标准差</h3>
<p>标准差（standard deviation）是方差的正平方根，其单位与原变量值的单位相同，总体标准差用<span class="math inline">\(\delta\)</span>表示，计算公式为： <span class="math display">\[ \delta=\sqrt{\frac{\sum(X-\mu)^2}{N}}  \]</span></p>
<h3 id="为什么是n-1">为什么是N-1？</h3>
<p>前面我们看到了总体方差与样本方差的分母不太一样，总体方差的分母是N，而样本方差则是N-1，为什么不一样呢？</p>
<p>在了解这个问题之前，我们先要了解一个统计学中的概念，自由度（degree of freedom）。</p>
<h3 id="自由度的理解">自由度的理解</h3>
<p>这里的N严格意义上来讲，就是自由度，在统计学中，几乎所有的方法、所有指标都会涉及自由度，因为自由度跟样本的数目有关，任何统计学方法都离不开样本数目这个变量。自由度的字面意思是，计算样本统计量时能够自由取值的个数，一般用df来表示，来看一个简单的例子，如果有一个方程为x+y+z=100，一旦y和z的值固定，那么x的值也就固定了，因此x=100-y-z，因此，x，y，z这三个变量是不可能同时自由取值的，能够自由取值的个数只有2个，而不是3个，这就是说，自由度为2。</p>
<p>现在再来看一下样本的自由度为什么是N-1，因为我们在用样本统计量来估计总体参数时，我们有一个暗含的假定，即假定统计量是参数的无偏估计，也就是说样本的参数与总体的参数是相等的，这就相当于我们默认了一个限定（就像x+y+z=100一样），因此，样本的自由度就不是N，而是n-1。在不同的统计方法中，自由度都不一样，但基本原则都是每估计1个参数，就要降低一个自由度，现在看一下其他的统计学方法。</p>
<ol style="list-style-type: decimal">
<li>在单样本t检验中，自由度是t-1，因为只需要估计1个参数（均数），所以只需要消耗1个自由度，所以自由度是t-1.</li>
<li>在两组比较的t检验中，自由度是n1+n2-2，这是因为需要估计的参数有2个，也就是两组的均值，对于每一组而言，一旦均值固定，能够自由取值的个数就只有n1-1个（n1是第一组的例数），即自由度为n1-1。同样的道理，对于第二组而言，其自由度为n2-2，所以，总体自由度就是n1+n2-2。</li>
<li>在多组比较的方差分析中，当有k个组的时候，需要估计k值组的均数，所以总的自由度是(n1+n2+…nk)-k。而对于组间变异所用到的自由度，因为总均数是固定的，所以需要减去1个自由度，即k-1。</li>
<li>在回归分析中，如果有m个自变量，就有m个参数需要估计，而且还需要估计截距项，因此待估计的参数有m+a个（m个自变量加1个截矩项），所以模型的F检验用到的自由度为n-(m+1)。它意味着只剩下n-(m+1)个可以自由取值的数值来估计模型误差，当自变量数m固定时，如果样本n比较小，就会导致有效估计例数不足，从而导致结果不可靠。</li>
</ol>
<p>因此，样本方差的分母使用n-1才更接近于总体的参数，这是无偏估计（unbiased estimator），如果直接使用n，那就是有偏估计（biased estimator ），不过当样本数量大到一定程度时，分母是n-1和n差别不大。</p>
<p>自由度这个角度是一种比较粗糙的理解方式，不过知乎上有人列出了证明过程，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180716/HLgh3ID45c.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180716/Ig5jmaIg76.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h3 id="样本标准差">样本标准差</h3>
<p>样本标准差的公式如下所示： <span class="math display">\[ s=\sqrt{\frac{\sum(X-\bar{X})^2}{n-1}}  \]</span></p>
<h3 id="标准差计算函数">标准差计算函数</h3>
<p>在Excel中计算方差的公式为<code>STDEV.P</code>和<code>STDEV.S</code>其中，STDEV.P计算时，认为你给出的数据是总体，因此它的分母为N，而STDEV.S计算时，认为你给出的数据是样本，因此它的分母为N-1。在R中，用到的函数为<code>sd</code>，默认的就是样本，因此分母为N-1。</p>
<h3 id="标准误与标准差的区别">标准误与标准差的区别</h3>
<p>在医学统计中，还经常遇到标准差与标准误。例如我们要调查地区A中10岁男孩的身高。如果全部都统计下来，直接测是最准确的数据。但是成本高，不现实。因此需要进行采样，一次测量100个男孩的身高，求这一次的均值M1与标准差S1，如果采样10次，每次都取100人，我们会得到10个均值，分别记为M1，M2，M3…M10，对这10个均值再求一个均值M以及标准差S，其中这个标准差S就是标准误(standard error)，即均值的标准误差(standard error of mean)。</p>
<h3 id="标准误与标准差的联系">标准误与标准差的联系</h3>
<p>SEM表示每次抽样获得的均数的标准差，因此如果要获取SEM，就必须做很多次抽样，这样也非常麻烦，但是标准误与标准差虽然不是一个概念，但在数学上有一定的联系，其公式如下所示： <span class="math display">\[ SEM=SD/\sqrt{N}  \]</span></p>
<h3 id="变异系数coefficient-of-variation">变异系数(coefficient of variation)</h3>
<p>简称为CV，标准差与均值的比值。公式为： <span class="math display">\[ CV=\frac{S}{\bar{X}}\times100\% \]</span></p>
<h2 id="数据整体的呈现方式">数据整体的呈现方式</h2>
<h3 id="箱线图和频率直方图">箱线图和频率直方图</h3>
<p>箱线图(boxplot)汇集了中位数、四分位差以及一些其他信息，能够使我们对样本的分布有一个直观的了解，也可以让我们快速发现数据中可能存在的错误（例如因为数据录入或单位错误导致的异常值）。它之所以被称为箱线图，是因为它用一个“箱子”来表示我们的数据中最靠中间的一半（即Q1和Q3之间的所有数据点），而用箱子上下的两根“胡须”来表示数据的上下限范围。箱线图的画法以及含义见下图。</p>
<h2 id="正态分布">正态分布</h2>
<p>若随机变量X服从一个数学期望为<span class="math inline">\(\mu\)</span>、方差为<span class="math inline">\({\sigma}^2\)</span>的正态分布，记为<span class="math inline">\(N(\mu,{\sigma}^2)\)</span>。其概率密度函数为正态分布的期望值<span class="math inline">\(\mu\)</span>决定了其位置，其标准差<span class="math inline">\(\sigma\)</span>决定了分布的幅度。因其曲线呈钟形，因此人们又经常称之为钟形曲线。我们通常所说的标准正态分布，即<span class="math inline">\(\mu\)</span> = 0,<span class="math inline">\(\sigma\)</span> = 1的正态分布，其公式为： <span class="math display">\[ p(x|\mu,\sigma)=\mathcal{N}(x|\mu,\sigma)=\frac{1}{\sigma\sqrt{2\pi}}\exp(-\frac{(x-\mu)^2}{2\sigma^2})\]</span></p>
<h2 id="医学参考值">医学参考值</h2>
<p>医学参考值（reference value）是指包括约大多数正常人的人体形态、功能和代谢产物等各种生理及生化指标常数，也称正常值。由于存在个体差异，生物医学数据并非常数而是在一定范围内波动，帮采用学参考值范围（medical reference range）作为判定正常和异常的参考标准。 医学参考值范围涉及采用单侧界值还是双侧界值的问题，这通常是依据医学专业知识而定，例如课本（医学统计学，孙振球，第四版）中的例2-1的红细胞数无论过低或过高均属异常，就采用双侧参考值范围制定下侧和上侧界值；血清转氨酶仅过高异常，应采用单侧参考值范围制定上侧界值；肺活量仅过低异常，就采用单侧参考值范围制定下侧界值。医学上常用的参考值范围有90%，95%，99%等，其中95%最常用。</p>
<p>其中确定参考值的方法通常有两种，分别为正态分布法和百分位数法。</p>
<h3 id="正态分布法">正态分布法</h3>
<p>对于服从正态分布的医学数据，可采用正态分布法计算参考值的范围，其计和公式为： 双侧1-<span class="math inline">\(1-\alpha\)</span>参考值范围为：<span class="math inline">\(\bar{X}\pm\mu_{\alpha/2}S\)</span> 单侧1-<span class="math inline">\(\alpha\)</span>的参考值范围为：<span class="math inline">\(&gt;\bar{X}-\mu_{\alpha/2}S\)</span>。 其中<span class="math inline">\(bar{X}\)</span>为无数，S为标准差，<span class="math inline">\(\mu\)</span>值可以查表得到。</p>
<p>案例：现在我们计算课本[^１]例2-1的资料估计正常成年女子的红细胞数的95%的参考值范围。计算结果如下所示： <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">raw_data &lt;- read.csv(&quot;https://raw.githubusercontent.com/20170505a/raw_data/master/data_szq_201.csv&quot;) #导入数据</div><div class="line">extract_data &lt;- raw_data[,1] # 提取第一列数据</div><div class="line">sd1 &lt;- sd(extract_data)</div><div class="line">mean1 &lt;- mean(extract_data)</div><div class="line">mean1 - 1.96*sd1 # 参考值的下限</div><div class="line">mean1 + 1.96*sd1 # 参考值的上限</div></pre></td></tr></table></figure></p>
<p>因此参考值的范围为3.353299，5.104657。</p>
<h3 id="百分位数法">百分位数法</h3>
<p>偏态分布资料医学参考值范围的制定通常采用百分位数法，所要求的样本含量比正态分布法要多（不低于100），其计算公式为： 双侧<span class="math inline">\(1-\alpha\)</span>参透值范围为：<span class="math inline">\(P_{100\alpha/2}{\sim}P_{100-100\alpha/2}\)</span></p>
<p>单侧<span class="math inline">\(1-\alpha\)</span>参透值范围为：<span class="math inline">\(&gt;P_{100\alpha}\)</span>或<span class="math inline">\(&gt;P_{100-100\alpha}\)</span> 案例：课本无原始数据，此题略过。</p>
<h2 id="数据描述的练习">数据描述的练习</h2>
<h3 id="例题2-1的描述性统计">例题2-1的描述性统计</h3>
<p>（医学统计学.第四版.孙振球）</p>
<p>某医院用随机抽样方法检查了138名正常成年女子的红细胞数 ，其测量结果如下，试编制频数分布表。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div></pre></td><td class="code"><pre><div class="line">raw_data &lt;- read.csv(&quot;https://raw.githubusercontent.com/20170505a/raw_data/master/data_szq_201.csv&quot;) </div><div class="line">#导入数据</div><div class="line"></div><div class="line">extract_data &lt;- raw_data[,1] </div><div class="line"># 提取第一列数据</div><div class="line"></div><div class="line">library(reshape2)</div><div class="line">breaks&lt;-seq(from = 3.07, to = 5.47, by = 0.2) </div><div class="line"># 产生各个组距</div><div class="line"></div><div class="line">data_table&lt;-cut(extract_data,breaks=breaks,right=FALSE) </div><div class="line">#分组,right=FALSE表示左闭右开</div><div class="line"></div><div class="line">library(reshape2) </div><div class="line">#载入reshape2包，使用其中的melt函数</div><div class="line"></div><div class="line">melt(table(data_table)) </div><div class="line">#查看频数分布</div><div class="line"></div><div class="line">middle_data&lt;-c() </div><div class="line">#求组中值，组中值从表中可以看出来就是区间两边的数的平均数</div><div class="line"></div><div class="line">for(i in seq(1,12))&#123;</div><div class="line">  middle &lt;- (breaks[i]+breaks[i+1])*0.5</div><div class="line">  middle_data&lt;-append(middle_data,middle)</div><div class="line">&#125;</div><div class="line"></div><div class="line"># 绘图表</div><div class="line">hist(extract_data,breaks,</div><div class="line">     right=FALSE,main=&quot;&quot;,</div><div class="line">     xlab=&quot;&quot;,ylab=&quot;频数&quot;,</div><div class="line">     axes=FALSE,</div><div class="line">     border=&quot;grey&quot;,</div><div class="line">     col=&quot;red&quot;,freq=F)</div><div class="line">#data为数据集，breaks则是分组依据，right=FALSE则是左开右闭,xlab，ylab控制坐标</div><div class="line"></div><div class="line">lines(density(extract_data)) </div><div class="line">#加入概率密度曲线</div><div class="line"></div><div class="line">title(xlab=&quot;红细胞数(×10e-12/L)&quot;,line=0.8)</div><div class="line">#加x轴的标题，往下超过x轴垂直距离为0.8个行距</div><div class="line"></div><div class="line">text(4.5,-2.8,&quot;-12&quot;,cex=0.5)</div><div class="line">mtext(&quot;138名正常成年女性红细胞数的频数分布&quot;,1,line=2.5,cex=1.2,font=2)</div><div class="line">#加主标题,1表示为下方</div><div class="line"># line=2.5表示超过x轴垂直距离为2.5个行距</div><div class="line"># cex为字体扩大倍数</div><div class="line"># font=2表示加粗</div><div class="line"></div><div class="line">abline(h=0)</div><div class="line">#绘制y=0的线段，用此线表示x轴</div><div class="line"></div><div class="line">axis(1,at=middle_data,tick=FALSE,pos=0.03)</div><div class="line"># 绘制x轴，坐标为middle_data</div><div class="line"># tick=FALSE表示坐标刻度不绘出,pos=1表示坐标轴在y=1处</div><div class="line"></div><div class="line">axis(2)</div><div class="line">#绘制y轴</div></pre></td></tr></table></figure>
<p>频数分布如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">&gt; melt(table(data_table)) #查看频数分布</div><div class="line">    data_table value</div><div class="line">1  [3.07,3.27)     2</div><div class="line">2  [3.27,3.47)     3</div><div class="line">3  [3.47,3.67)     9</div><div class="line">4  [3.67,3.87)    14</div><div class="line">5  [3.87,4.07)    22</div><div class="line">6  [4.07,4.27)    30</div><div class="line">7  [4.27,4.47)    21</div><div class="line">8  [4.47,4.67)    15</div><div class="line">9  [4.67,4.87)    10</div><div class="line">10 [4.87,5.07)     6</div><div class="line">11 [5.07,5.27)     4</div><div class="line">12 [5.27,5.47)     2</div></pre></td></tr></table></figure>
<p>图表如下所示<img src="http://ortxpw68f.bkt.clouddn.com/fig21.png">：</p>
<p>对例2-1，例2-2和例2-14已计算出某医院随机抽查的138名成年女子的红细胞数均数 ，标准差 。试估计该医院所抽查成年女子的红细胞数：①在4.0 以下者占成年女子总人数的百分比；②在4.00~5.00 之间者占成年女子总人数的百分比；③在5.00 以上者占成年女子总人数的百分比。 计算过程如下： <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">mean.data &lt;- mean(extract_data)</div><div class="line">sd.data &lt;- sd(extract_data)</div><div class="line">pnorm((4-mean.data)/sd.data) # 4.0以下的百分比</div><div class="line">pnorm((5-mean.data)/sd.data) #5.0以下的百分比</div><div class="line">1-pnorm((5-mean.data)/sd.data) #5.0以上的百分比</div><div class="line">pnorm((5-mean.data)/sd.data)-pnorm((4-mean.data)/sd.data) #在4.00~5.00 之间的百分比</div><div class="line"></div><div class="line">#或者是：</div><div class="line">pnorm(5,mean(data),sd(data))-pnorm(4,mean(data),sd(data))</div><div class="line"></div><div class="line"># 绘制数据集的正态分布图</div><div class="line">x &lt;- seq(min(extract_data)-0.52,max(extract_data)+0.52,length=1000)</div><div class="line">y &lt;- dnorm(x,mean(extract_data),sd(extract_data))</div><div class="line">r1 &lt;- 4</div><div class="line">r2 &lt;- 5</div><div class="line">x2 &lt;- c(r1,r1,x[x&lt;r2&amp;x&gt;r1],r2,r2)</div><div class="line">y2=c(0,dnorm(c(r1,x[x&lt;r2&amp;x&gt;r1],r2),mean(data),sd(data)),0)</div><div class="line">plot(x,y,type=&quot;l&quot;,xlab=&quot;&quot;,ylab=&quot;&quot;,lty=1)</div><div class="line">abline(0,0)</div><div class="line">polygon(x2,y2,col=&quot;grey&quot;)</div></pre></td></tr></table></figure></p>
<p><strong>结果如下所示：</strong> <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">[1] 0.3041459</div><div class="line">&gt; pnorm((5-mean.data)/sd.data) #5.0以下的百分比</div><div class="line">[1] 0.9578038</div><div class="line">&gt; 1-pnorm((5-mean.data)/sd.data) #5.0以上的百分比</div><div class="line">[1] 0.04219616</div><div class="line">&gt; pnorm((5-mean.data)/sd.data)-pnorm((4-mean.data)/sd.data) #在4.00~5.00 之间的百分比</div><div class="line">[1] 0.653658</div><div class="line">&gt; pnorm(5,mean(data),sd(data))-pnorm(4,mean(data),sd(data))</div><div class="line">[1] 0.6532998</div><div class="line">结果与书中的不太一样，但结果接近，我估计是因为书中是查表，用的是近似值，R中的比较精确</div></pre></td></tr></table></figure></p>
<p>数据的正态分布图如下所示：<img src="http://ortxpw68f.bkt.clouddn.com/fig22.png"></p>
<h3 id="例2-4几何均数">例2-4：几何均数</h3>
<p>某地5例微丝蚴血症患者治疗7年后用间接荧光抗体试验没得某抗体满意度例数分别为10，20，40，40，160，求几何均数。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">data24&lt;-c(10,20,40,40,160)</div><div class="line">exp(mean(log(data24)))</div></pre></td></tr></table></figure>
<p>结果如下： <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&gt; data24</div><div class="line">[1]  10  20  40  40 160</div><div class="line">&gt; exp(mean(log(data24)))</div><div class="line">[1] 34.82202</div></pre></td></tr></table></figure></p>
<h3 id="例2-5-平均抗体滴度">例2-5 平均抗体滴度</h3>
<p>69例风湿关节炎(RA)患者血清EBV-VCA-IgG抗体满意度的分布，求其平均抗体滴度。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">data25&lt;-c(10,40,80,160,160,320,640,640,10,40,80,160,160,320,640,640,</div><div class="line">10,40,80,160,320,320,640,640,10,40,80,160,320,320,640,640,20,40,80,</div><div class="line">160,320,320,640,1280,20,40,80,160,320,320,640,1280,20,40,80,160,320,</div><div class="line">320,640,40,40,80,160,320,320,640,40,80,80,160,320,640,640)</div><div class="line">x &lt;- table(data25)</div><div class="line">x &lt;- data.frame(x)</div><div class="line">x$countdown &lt;- as.numeric(levels(x$data25))</div><div class="line">x$lgX &lt;- round(log10(x$countdown),4)</div><div class="line">x$flgX &lt;- round(x$Freq*x$lgX,4)</div></pre></td></tr></table></figure>
<p>结果为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">&gt; x</div><div class="line">  data25 Freq countdown    lgX    flgX</div><div class="line">1     10    4        10 1.0000  4.0000</div><div class="line">2     20    3        20 1.3010  3.9030</div><div class="line">3     40   10        40 1.6021 16.0210</div><div class="line">4     80   10        80 1.9031 19.0310</div><div class="line">5    160   11       160 2.2041 24.2451</div><div class="line">6    320   15       320 2.5051 37.5765</div><div class="line">7    640   14       640 2.8062 39.2868</div><div class="line">8   1280    2      1280 3.1072  6.2144</div><div class="line"></div><div class="line">上述结果是书中的频数表，与R的计算关系不大，在R中可以直接计算，如下</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; exp(mean(log(data25)))</div><div class="line">[1] 150.6411</div></pre></td></tr></table></figure>
<h3 id="例2-6-中位数">例2-6 中位数</h3>
<p>7名病人患某病的潜伏期分别为2，3，4，5，6，9，16天，求其中位数。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&gt; data26&lt;-c(2,3,4,5,6,9,16)</div><div class="line">&gt; median(data26)</div><div class="line">[1] 5</div></pre></td></tr></table></figure>
<h3 id="例2-11均数和极差">例2-11：均数和极差</h3>
<p>试计算下面三组同龄男孩的身高 均数和极差。 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">range.f &lt;- function (x) (max(x)-min(x))</div><div class="line">甲组 &lt;- c(90,95,100,105,110)</div><div class="line">乙组 &lt;- c(96,98,100,102,104)</div><div class="line">丙组 &lt;- c(96,99,100,101,104)</div><div class="line">range.f(甲组)</div><div class="line">mean(甲组)</div><div class="line">range.f(乙组)</div><div class="line">mean(乙组)</div><div class="line">range.f(丙组)</div><div class="line">mean(丙组)</div></pre></td></tr></table></figure></p>
<p>结果如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">&gt; range.f(甲组)</div><div class="line">[1] 20</div><div class="line">&gt; mean(甲组)</div><div class="line">[1] 100</div><div class="line">&gt; range.f(乙组)</div><div class="line">[1] 8</div><div class="line">&gt; mean(乙组)</div><div class="line">[1] 100</div><div class="line">&gt; range.f(丙组)</div><div class="line">[1] 8</div><div class="line">&gt; mean(丙组)</div><div class="line">[1] 100</div></pre></td></tr></table></figure>
<h2 id="参考资料">参考资料</h2>
<p>医学统计学.第四版.孙振球</p>
<p>小白统计.冯国双</p>
<p><a href="https://www.zhihu.com/question/20099757?rf=21126585" target="_blank" rel="external">为什么样本方差（sample variance）的分母是 n-1？</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2017/04/06/R/R笔记（6）-数据的导入与导出/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/04/06/R/R笔记（6）-数据的导入与导出/" itemprop="url">R笔记（6）——数据的导入与导出</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-04-06T12:00:00+08:00">
                2017-04-06
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/R/" itemprop="url" rel="index">
                    <span itemprop="name">R</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  2,122
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  9
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="数据的导入">数据的导入</h2>
<p>所用到的函数与包如下： read.table() read.csv() head() xlsx包 read.xlsx() RODBC包 odbcConnect() sqlQuery() sqlSave() RMySQL包 dbConnect() dbSentQuery() fetch()</p>
<h2 id="从csv文件导入"> 从csv文件导入</h2>
<p>此方法可以用以导入Excel数据，将Excel数据转化为csv格式。 CSV是（逗号分隔值）的英文缩写，通常都是纯文本文件。其打开格式为：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">mydataframe&lt;-read.table(file,header=logical_value,ep=<span class="string">"delimiter"</span>,row.names=<span class="string">"name"</span>)</div><div class="line">fiel:csv文件</div><div class="line">header:逻辑值，首先是否包括变量名</div><div class="line">sep:分隔符</div><div class="line">row.names:指定一个或多个表示行标识符的变量</div><div class="line">grades&lt;-read.table(<span class="string">"studentgrades.csv"</span>,header=<span class="literal">TRUE</span>,sep=<span class="string">","</span>,row.names=<span class="string">"STUDENTID"</span>)</div></pre></td></tr></table></figure>
<p>表示从当前目录中读取一个名为studentgrades.csv的逗号分隔文件，从文件的第一行取得变量名字，将STUDENTID指定为行标识符，整个结果保存到grades的数据框中。</p>
<h2 id="从剪切板导入"> 从剪切板导入</h2>
<p>通常情况下就是在Excel中复制，接着输入以下命令就可以导入数据。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">data &lt;- read.table(<span class="string">"clipboard"</span>, header = <span class="literal">T</span>, sep=<span class="string">"\t"</span>)</div></pre></td></tr></table></figure>
<h2 id="导入文本文件"> 导入文本文件</h2>
<p>一般采用read.table()函数和read.csv()函数实现文本文件数据的读取，对于这两个函数有几个重要的参数：</p>
<ol style="list-style-type: decimal">
<li>file指定外部文件的路径和文件名；</li>
<li>header指定是否将原数据的第一行最为字段名，read.table()函数默认设置为FALSE，而read.csv()函数默认设置为TRUE；</li>
<li>sep指定字段之间的分割符，read.table()函数默认设置为空格“”，而read.csv()函数默认设置为逗号；</li>
<li>除此，read.table()函数还可以设置读入数据集的行名、列名、字符串是否转换为因子、缺失值的形式等，详细可查看read.table()函数的帮助文档。</li>
</ol>
<p>我的电脑桌面中有两个文本文件，即iris.csv和iris.txt。文件打开如下图： <img src="http://ortxpw68f.bkt.clouddn.com/professional/180821/i0ad21J31d.png?imageslim" alt="mark"></p>
<p>现在通过read.table()函数和read.csv()函数读取这两个文件：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">iris1 &lt;- read.table(file = <span class="string">'C:\\Users\\admin\\Desktop\\iris.txt'</span>, col.names = c(<span class="string">'x1'</span>,<span class="string">'x2'</span>,<span class="string">'x3'</span>,<span class="string">'x4'</span>,<span class="string">'y'</span>))</div><div class="line">head(iris1)</div></pre></td></tr></table></figure>
<h2 id="read.csv">read.csv()</h2>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">iris3 &lt;- read.csv(file = file.choose())</div><div class="line">head(iris3)</div></pre></td></tr></table></figure>
<h2 id="从scan导入数据"> 从scan导入数据</h2>
<p>主要用于键盘输入数据，详细使用方法：</p>
<h3 id="scan函数"> scan() 函数</h3>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">scan(file = <span class="string">""</span>, what = double(<span class="number">0</span>), nmax = -<span class="number">1</span>, n = -<span class="number">1</span>, sep = <span class="string">""</span>,</div><div class="line">     quote = <span class="keyword">if</span>(identical(sep, <span class="string">"\n"</span>)) <span class="string">""</span> <span class="keyword">else</span> <span class="string">"'\""</span>, dec = <span class="string">"."</span>,</div><div class="line">     skip = <span class="number">0</span>, nlines = <span class="number">0</span>, na.strings = <span class="string">"NA"</span>,</div><div class="line">     flush = <span class="literal">FALSE</span>, fill = <span class="literal">FALSE</span>, strip.white = <span class="literal">FALSE</span>,</div><div class="line">     quiet = <span class="literal">FALSE</span>, blank.lines.skip = <span class="literal">TRUE</span>, multi.line = <span class="literal">TRUE</span>,</div><div class="line">     comment.char = <span class="string">""</span>, allowEscapes = <span class="literal">FALSE</span>, encoding = <span class="string">"unknown"</span>)</div></pre></td></tr></table></figure>
<p><strong>参数使用如下所示：</strong> 1. what:声明读入为字符类型数据，可能指定读入的精度/类型，例如：what=integer(0)；what=numeric(0)；what=character(0)； 如果SCAN()读入有字符与数字，用what=“”来进行声明，则会把读入的数字隐式的都转变成字符； 2. sep：指定各个读入的数据之间的分隔符；默认情况下分隔符：空格、tab；如果不是其它分隔符，例如“：/”通过SEP来指定； 3. 可以通过list指定读入变量的变量名，同时生成的对象为列表，则可以同时读入字符与数字； 4. Skip 从第几行开始读入数据； 5. Nlines 指定最大读入行数； 6. 如果通过键盘输入的时候，不希望出现下标提示，则可以使用：quiet=TRUE； 7. encoding =””指定的编码格式，有时候读入的中文可能会出现乱码的时候，可能通过这个参数来指定：Latin-1 或者 UTF-8</p>
<h2 id="使用表格输入数据"> 使用表格输入数据</h2>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">mydata&lt;-data.frame(age=numeric(<span class="number">0</span>),</div><div class="line">                   gender=character(<span class="number">0</span>),</div><div class="line">                   weight=numeric(<span class="number">0</span>))</div><div class="line">mydata&lt;-edit(mydata)</div></pre></td></tr></table></figure>
<p>创建一个名为mydata的数据框，含三个变量，age为数据型，gender为字符型，weight为数值型。edit调用文本编辑器，键入数据。其中numeric(0)创建一个指定模型但不含实际数据的变量。如果再次调用mydata&lt;-edit(mydata)能够用来修改数据，或者使用fix(mydata)也行。</p>
<h2 id="利用xlsx包来读取excel"> 利用xlsx包来读取Excel</h2>
<p>读取xls或xlsx格式时，需要将数据转换为csv，用read.csv()函数读取；要么直接使用xlsx软件包中的read.xlsx()函数直接读取电子表格数据，用法如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">library</span>(xlsx)</div><div class="line">iris4 &lt;- read.xlsx(file = file.choose(), sheetIndex = <span class="number">1</span>)</div><div class="line">head(iris4)</div></pre></td></tr></table></figure>
<h3 id="利用rodbc包来读取excel"> 利用RODBC包来读取Excel</h3>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">&gt; install.packages(<span class="string">"RODBC"</span>) <span class="comment">#安装RODBC包</span></div><div class="line">&gt; channel&lt;-odbcConnectExcel(<span class="string">"excel2003.xls"</span>)<span class="comment">#excel2003为一个Excel文件</span></div><div class="line">&gt; mydataframe&lt;-sqlFetch(channel,<span class="string">"sheet1"</span>) <span class="comment">#sqlFetch从channel中读入数据到mydataframe中，将sheet1表格导入</span></div><div class="line">&gt; mydataframe</div><div class="line"> </div><div class="line">install.packages(<span class="string">"xlsx"</span>) <span class="comment">#安装xlsx包</span></div><div class="line"><span class="keyword">library</span>(xlsx)</div><div class="line">workbook&lt;-<span class="string">"d:/r/excel2007.xlsx"</span></div><div class="line">mydataframe2&lt;-read.xlsx(workbook,<span class="number">1</span>)<span class="comment">#1表示导入的第1张表</span></div></pre></td></tr></table></figure>
<h3 id="利用xlconnectjars包的xlconnect函数来读取excel"> 利用XLConnectJars包的XLConnect函数来读取Excel</h3>
<p>在利用XLConnect来读取Excel时，经常会出现错误，这是因为需要安装jdk环境（版本大于1.6），因此需要安装，安装后再安装XLConnectjars包与XLConnect包，安装完Jdk后，输入以下代码 <figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Sys.setenv(JAVA_HOME=<span class="string">'C:\\Program Files\\Java\\jdk1.7.0_75\\jre'</span>)</div></pre></td></tr></table></figure></p>
<p>直接读取excel文件，就是这个包依赖于XLConnectJars包，比较大(15.7M)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">&gt; install.packages(&quot;XLConnect&quot;)</div><div class="line">&gt; library(&quot;XLConnect&quot;)</div><div class="line">&gt; df = readWorksheetFromFile(&quot;c:/r-workspace/contacts.xls&quot;, sheet=1, header=TRUE)</div><div class="line">&gt; df</div><div class="line">  name gender address</div><div class="line">1 张三     男    北京</div><div class="line">2 李四     男    上海</div><div class="line">3 王五     女    广州</div><div class="line">4 赵六     女    深圳</div><div class="line">5 田七     男    南京</div></pre></td></tr></table></figure>
<h2 id="批量读取数据">批量读取数据</h2>
<p>读取N个Excel文件，并将这N个Excel文件进行合并，分为四种情况，代码如下所示，其中read_excel函数所在的包为readxl。</p>
<p>对于文件名有规律的情况，如下图所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180821/3IJki27BL8.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>解决方案如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">setwd(<span class="string">'D:\\data file\\data1'</span>) </div><div class="line"><span class="comment"># 设置R的工作空间</span></div><div class="line"><span class="comment">#res &lt;- NULL</span></div><div class="line"></div><div class="line">data1 &lt;- data.frame()</div><div class="line"><span class="comment"># 初始化数据框，用于后面的数据合并</span></div><div class="line"><span class="comment">#通过循环完成数据合并</span></div><div class="line"><span class="keyword">for</span> (i <span class="keyword">in</span> <span class="number">1</span>:<span class="number">4</span>)&#123;</div><div class="line">path &lt;- paste0(getwd(),<span class="string">'\\'</span>,<span class="string">'test'</span>,i,<span class="string">'.xlsx'</span>)   <span class="comment"># 构造数据路径</span></div><div class="line">res &lt;- c(res,path)</div><div class="line">data1 &lt;- rbind(data1,read_excel(path = path))   <span class="comment"># 读取并合并数据</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>对于文件没有规律的情况，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">setwd(<span class="string">'D:\\data file\\data2'</span>)  <span class="comment"># 设置工作空间</span></div><div class="line">filenames &lt;- dir()   <span class="comment"># 读取该工作空间下的所有文件名</span></div><div class="line">data2 &lt;- data.frame()   <span class="comment"># 初始化数据框，用于后面的数据合并</span></div><div class="line"></div><div class="line"><span class="comment">#通过循环完成数据合并</span></div><div class="line"><span class="keyword">for</span> (i <span class="keyword">in</span> filenames)&#123;</div><div class="line"><span class="comment"># 构造数据路径</span></div><div class="line">path &lt;- paste0(getwd(),<span class="string">'\\'</span>,i)</div><div class="line"><span class="comment">#res &lt;- c(res,path)</span></div><div class="line"><span class="comment"># 读取并合并数据</span></div><div class="line">data2 &lt;- rbind(data2,read_excel(path = path))</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>对于文件名没有规律的情况，并且只读取某做后缀的文件，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180821/bIFEDBjmC9.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>文件内容结构不一致,但变量名称一致，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180821/KImJBHK7hf.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 加载第三方扩展包，用于编写SQL语句</span></div><div class="line"> <span class="keyword">library</span>(sqldf)</div><div class="line"> <span class="comment"># 设置工作空间</span></div><div class="line"> setwd(<span class="string">'D:\\data file\\data4'</span>)</div><div class="line"> <span class="comment"># 读取该工作空间下的所有文件名</span></div><div class="line"> filenames &lt;- dir()</div><div class="line"> <span class="comment"># 通过正则，获取所有xlsx结尾的文件名</span></div><div class="line"> filenames2 &lt;- grep(<span class="string">'\\.xlsx'</span>, filenames, value = <span class="literal">TRUE</span>)</div><div class="line"> <span class="comment"># 初始化数据框，用于后面的数据合并</span></div><div class="line"> data4 &lt;- data.frame()</div><div class="line"> <span class="comment">#通过循环完成数据合并</span></div><div class="line"> <span class="keyword">for</span> (i <span class="keyword">in</span> filenames2)&#123;</div><div class="line"> <span class="comment"># 构造数据路径</span></div><div class="line"> path &lt;- paste0(getwd(),<span class="string">'\\'</span>,i)</div><div class="line"> <span class="comment">#res &lt;- c(res,path)</span></div><div class="line"> <span class="comment"># 使用read_excel函数读取xlsx文件</span></div><div class="line"> data &lt;- read_excel(path = path)</div><div class="line"> <span class="comment"># 使用sqldf函数编写SQL语句，并把结果合并起来</span></div><div class="line"> data4 &lt;- rbind(data4, sqldf(<span class="string">"select id,name,gender,age from data"</span>))</div><div class="line"> &#125;</div></pre></td></tr></table></figure>
<h2 id="导出数据"> 导出数据</h2>
<h3 id="导出的路径"> 导出的路径</h3>
<p>为了避免在导出路径中使用转义字符，可以使用file.path()函数来构建正确的路径，这个函数的工作原理类似于paste()，如下所示： <figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">file.path(<span class="string">"d:"</span>,<span class="string">"download"</span>)</div><div class="line">[<span class="number">1</span>] <span class="string">"d:/download"</span></div></pre></td></tr></table></figure></p>
<blockquote>
<p> file.path(“d:”,“download”) [1] “d:/download”</p>
</blockquote>
<h3 id="导出为txt格式"> 导出为txt格式</h3>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"> a</div><div class="line">[<span class="number">1</span>]  <span class="number">1</span>  <span class="number">2</span>  <span class="number">4</span> <span class="literal">NA</span>  <span class="number">5</span>  <span class="number">4</span></div><div class="line">&gt; b</div><div class="line">[<span class="number">1</span>] <span class="string">"a"</span> <span class="string">"b"</span> <span class="string">"c"</span> <span class="string">"d"</span> <span class="literal">NA</span>  <span class="string">"4"</span></div><div class="line"> c &lt;- data.frame(a,b)</div><div class="line"> c</div><div class="line">   a    b</div><div class="line"><span class="number">1</span>  <span class="number">1</span>    a</div><div class="line"><span class="number">2</span>  <span class="number">2</span>    b</div><div class="line"><span class="number">3</span>  <span class="number">4</span>    c</div><div class="line"><span class="number">4</span> <span class="literal">NA</span>    d</div><div class="line"><span class="number">5</span>  <span class="number">5</span> &lt;<span class="literal">NA</span>&gt;</div><div class="line"><span class="number">6</span>  <span class="number">4</span>    <span class="number">4</span></div><div class="line"> write.table(c,file = <span class="string">"c:\\data.txt"</span>,sep = <span class="string">","</span>,quote = <span class="literal">FALSE</span>, append = <span class="literal">FALSE</span>, na = <span class="string">"NA"</span>)</div></pre></td></tr></table></figure>
<p>c为导出的数据，file为导出的路径，sep = “,”表示用逗号隔开数据，quote = FALSE表示消除字符串的引号标志，append = FALSE打开一个新文件，如果为TRUE则表示将此数据追加到已经存在的文件中，na=”NA”表示用NA来代表na值。</p>
<h2 id="读取错误">读取错误</h2>
<p>R语言读取Excel文件有时会出错，如果要读取以下的Excel表格文件，</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180821/GJj9jHELEj.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>  操作如下所示：</p>
<ol style="list-style-type: decimal">
<li>用鼠标选中据，然后Ctrl+C复制；</li>
<li>在Rstudio中输入：read.table(“clipboard”,header=T)-&gt;x1，显示以下结果：</li>
</ol>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180821/Fd8204g0EC.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>Error in scan(file, what, nmax, sep, dec, quote, skip, nlines, na.strings,  :    line 2 did not have 8 elements</p>
<p>大概意思是，有两行数据的元素不满足8个（即第No.2不满足8个元素），无法读取，因此需要改变一下代码，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">x &lt;- read.table(<span class="string">"clipboard"</span>,sep=<span class="string">"\t"</span>,header=<span class="literal">T</span>)</div></pre></td></tr></table></figure>
<p>  如下所示： <img src="http://ortxpw68f.bkt.clouddn.com/professional/180821/7I89J18DJG.png?imageslim" alt="mark"></p>
<p>这样就能正常读取了，因为Excel的文件中，每个单元格就是以制表符将它们分开的，而sep=“”的意思就是，读取数据的时候，以制表符进行分割来读取。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2017/04/05/R/R笔记（5）-函数构建与for/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/04/05/R/R笔记（5）-函数构建与for/" itemprop="url">R笔记（5）——函数构建</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-04-05T12:00:00+08:00">
                2017-04-05
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/R/" itemprop="url" rel="index">
                    <span itemprop="name">R</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  490
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  2
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="函数的编写">函数的编写</h2>
<p>格式如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">函数名 &lt;- <span class="keyword">function</span>(数据,参数<span class="number">1</span>=默认值,<span class="keyword">...</span>)</div><div class="line">&#123;</div><div class="line">异常处理;</div><div class="line">表达式(循环/判别);</div><div class="line"><span class="keyword">return</span>(返回值);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="函数案例a">函数案例A</h3>
<p>输入直角三角形的两个边长，求斜边长</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">rcal &lt;- <span class="keyword">function</span>(x,y)&#123; </div><div class="line">z &lt;- x^<span class="number">2</span> + y^<span class="number">2</span> </div><div class="line">result &lt;- sqrt(z) </div><div class="line"><span class="keyword">return</span>(result) </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>运行结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">&gt; rcal &lt;- <span class="keyword">function</span>(x,y)&#123; </div><div class="line">+     z &lt;- x^<span class="number">2</span> + y^<span class="number">2</span> </div><div class="line">+     result &lt;- sqrt(z) </div><div class="line">+     <span class="keyword">return</span>(result) </div><div class="line">+ &#125; </div><div class="line">&gt; rcal(<span class="number">3</span>,<span class="number">4</span>)</div><div class="line">[<span class="number">1</span>] <span class="number">5</span></div></pre></td></tr></table></figure>
<h3 id="函数案例b">函数案例B</h3>
<p>给出两个数字后，直接给出这两个数的平方和</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">sqtest &lt;- <span class="keyword">function</span>(x,y)&#123;</div><div class="line">z1 = x^<span class="number">2</span>;z2=y^<span class="number">2</span>;z3=z1+z2;</div><div class="line"><span class="keyword">return</span>(z3);</div><div class="line">&#125;</div><div class="line">sqtest(<span class="number">3</span>,<span class="number">4</span>)</div></pre></td></tr></table></figure>
<p>运行结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&gt; sqtest &lt;- <span class="keyword">function</span>(x,y)&#123;</div><div class="line">+     z1 = x^<span class="number">2</span>;z2=y^<span class="number">2</span>;z3=z1+z2;</div><div class="line">+     <span class="keyword">return</span>(z3);</div><div class="line">+ &#125;</div><div class="line">&gt; sqtest(<span class="number">3</span>,<span class="number">4</span>)</div><div class="line">[<span class="number">1</span>] <span class="number">25</span></div></pre></td></tr></table></figure>
<h2 id="if语句">if语句</h2>
<p>用法如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span>(条件) 表达式</div><div class="line"><span class="keyword">if</span>(条件) 表达式<span class="number">1</span> <span class="keyword">else</span> 表达式<span class="number">2</span></div></pre></td></tr></table></figure>
<p>运行如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">p &lt;- <span class="number">0.03</span> ;&#123;</div><div class="line"><span class="keyword">if</span> (p &lt;= <span class="number">0.05</span>)</div><div class="line">print(<span class="string">"p&lt;=0.05!"</span>)</div><div class="line"><span class="keyword">else</span> print(<span class="string">"p &gt; 0.05!"</span>)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>运行如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&gt; p &lt;- <span class="number">0.03</span> ;&#123;</div><div class="line">+     <span class="keyword">if</span> (p &lt;= <span class="number">0.05</span>)</div><div class="line">+         print(<span class="string">"p&lt;=0.05!"</span>)</div><div class="line">+     <span class="keyword">else</span> print(<span class="string">"p &gt; 0.05!"</span>)</div><div class="line">+ &#125;</div><div class="line">[<span class="number">1</span>] <span class="string">"p&lt;=0.05!"</span></div></pre></td></tr></table></figure>
<h2 id="for-循环">for 循环</h2>
<p>用法如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">for</span>(i <span class="keyword">in</span> <span class="number">1</span>:<span class="number">20</span>)&#123;</div><div class="line">cat(i);</div><div class="line">cat(<span class="string">" "</span>);</div><div class="line">i=i+<span class="number">3</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>运行如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&gt; <span class="keyword">for</span>(i <span class="keyword">in</span> <span class="number">1</span>:<span class="number">20</span>)&#123;</div><div class="line">+     cat(i);</div><div class="line">+     cat(<span class="string">" "</span>);</div><div class="line">+     i=i+<span class="number">3</span>;</div><div class="line">+ &#125;</div><div class="line"><span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">4</span> <span class="number">5</span> <span class="number">6</span> <span class="number">7</span> <span class="number">8</span> <span class="number">9</span> <span class="number">10</span> <span class="number">11</span> <span class="number">12</span> <span class="number">13</span> <span class="number">14</span> <span class="number">15</span> <span class="number">16</span> <span class="number">17</span> <span class="number">18</span> <span class="number">19</span> <span class="number">20</span></div></pre></td></tr></table></figure>
<p>从上面结果，我们可以看出，循环中处理的对象是1:20这20个数，对每个数进行操作不管循环内部i如何变化。因此，循环体内的i=i+3就不会对循环条件中的变量造成改变，具体执行过程相当于：<code>i=1</code> <code>-&gt;</code> <code>i=i+3</code>，此时<code>i=4</code>；<code>-&gt;</code> 第一次循环结束，第二次循环开始，<code>i=2</code>。尤其注意，i变成4又变成2，所以打印出来的结果是，1,2,3,4….20的连续值。如果想要随意的改变条件中的变量，可以使用while循环，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">&gt; i=<span class="number">1</span> </div><div class="line">&gt; <span class="keyword">while</span>(i&lt;=<span class="number">20</span>)&#123; </div><div class="line">+     cat(i); </div><div class="line">+     cat(<span class="string">" "</span>); </div><div class="line">+     i=i+<span class="number">3</span> </div><div class="line">+ &#125;</div><div class="line"><span class="number">1</span> <span class="number">4</span> <span class="number">7</span> <span class="number">10</span> <span class="number">13</span> <span class="number">16</span> <span class="number">19</span></div></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2017/04/04/R/R笔记（4）-字符串与日期/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/04/04/R/R笔记（4）-字符串与日期/" itemprop="url">R笔记（4）——字符串与日期</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-04-04T12:00:00+08:00">
                2017-04-04
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/R/" itemprop="url" rel="index">
                    <span itemprop="name">R</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  1,920
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  9
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="字符串常用函数">字符串常用函数</h2>
<p>is.character()：判断是否是字符串； nchar()：有几个字符； length()：变量的长度 如下所示 <figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">&gt; x &lt;- <span class="string">"Hello, World!"</span>;x</div><div class="line">[<span class="number">1</span>] <span class="string">"Hello, World!"</span></div><div class="line">&gt; is.character(x)</div><div class="line">[<span class="number">1</span>] <span class="literal">TRUE</span></div><div class="line">&gt; length(x)</div><div class="line">[<span class="number">1</span>] <span class="number">1</span></div><div class="line">&gt; nchar(x)</div><div class="line">[<span class="number">1</span>] <span class="number">13</span></div><div class="line">&gt; x2 &lt;- c(<span class="string">"Hello"</span>,<span class="string">"World!"</span>)</div><div class="line">&gt; length(x2)</div><div class="line">[<span class="number">1</span>] <span class="number">2</span></div><div class="line">&gt; nchar(x2)</div><div class="line">[<span class="number">1</span>] <span class="number">5</span> <span class="number">6</span></div></pre></td></tr></table></figure></p>
<h2 id="内置数据集"> 内置数据集</h2>
<p>R中有两个内置数据集，分别为LETTERS和letters，分别为大写字母和小写字母，如下所示： <figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">&gt; letters</div><div class="line"> [<span class="number">1</span>] <span class="string">"a"</span> <span class="string">"b"</span> <span class="string">"c"</span> <span class="string">"d"</span> <span class="string">"e"</span> <span class="string">"f"</span> <span class="string">"g"</span> <span class="string">"h"</span> <span class="string">"i"</span> <span class="string">"j"</span> <span class="string">"k"</span> <span class="string">"l"</span> <span class="string">"m"</span> <span class="string">"n"</span> <span class="string">"o"</span> <span class="string">"p"</span> <span class="string">"q"</span> <span class="string">"r"</span> <span class="string">"s"</span> <span class="string">"t"</span></div><div class="line">[<span class="number">21</span>] <span class="string">"u"</span> <span class="string">"v"</span> <span class="string">"w"</span> <span class="string">"x"</span> <span class="string">"y"</span> <span class="string">"z"</span></div><div class="line">&gt; LETTERS</div><div class="line"> [<span class="number">1</span>] <span class="string">"A"</span> <span class="string">"B"</span> <span class="string">"C"</span> <span class="string">"D"</span> <span class="string">"E"</span> <span class="string">"F"</span> <span class="string">"G"</span> <span class="string">"H"</span> <span class="string">"I"</span> <span class="string">"J"</span> <span class="string">"K"</span> <span class="string">"L"</span> <span class="string">"M"</span> <span class="string">"N"</span> <span class="string">"O"</span> <span class="string">"P"</span> <span class="string">"Q"</span> <span class="string">"R"</span> <span class="string">"S"</span> <span class="string">"T"</span></div><div class="line">[<span class="number">21</span>] <span class="string">"U"</span> <span class="string">"V"</span> <span class="string">"W"</span> <span class="string">"X"</span> <span class="string">"Y"</span> <span class="string">"Z"</span></div><div class="line">&gt; letters[<span class="number">2</span>:<span class="number">5</span>]</div><div class="line">[<span class="number">1</span>] <span class="string">"b"</span> <span class="string">"c"</span> <span class="string">"d"</span> <span class="string">"e"</span></div><div class="line">&gt; LETTERS[<span class="number">4</span>:<span class="number">9</span>]</div><div class="line">[<span class="number">1</span>] <span class="string">"D"</span> <span class="string">"E"</span> <span class="string">"F"</span> <span class="string">"G"</span> <span class="string">"H"</span> <span class="string">"I"</span></div></pre></td></tr></table></figure></p>
<h2 id="字符串的连接和分离">字符串的连接和分离</h2>
<h3 id="字符串的分离"> 字符串的分离</h3>
<p>strsplit()函数用于分离字符串，如下所示： <figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">&gt; pangram &lt;- <span class="string">"The quick brown fox jumps over the lazy dog"</span></div><div class="line">&gt; pangram</div><div class="line">[<span class="number">1</span>] <span class="string">"The quick brown fox jumps over the lazy dog"</span></div><div class="line">&gt; result_split &lt;- strsplit(pangram,<span class="string">" "</span>)</div><div class="line">&gt; result_split</div><div class="line">[[<span class="number">1</span>]]</div><div class="line">[<span class="number">1</span>] <span class="string">"The"</span>   <span class="string">"quick"</span> <span class="string">"brown"</span> <span class="string">"fox"</span>   <span class="string">"jumps"</span> <span class="string">"over"</span>  <span class="string">"the"</span>   <span class="string">"lazy"</span>  <span class="string">"dog"</span></div></pre></td></tr></table></figure></p>
<h3 id="字符串的连接"> 字符串的连接</h3>
<p>字符串的连接用的是paste函数，如下所示： <figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; paste(c(<span class="string">"hello"</span>,<span class="string">"world"</span>))</div><div class="line">[<span class="number">1</span>] <span class="string">"hello"</span> <span class="string">"world"</span></div></pre></td></tr></table></figure></p>
<p>在为某些数据添加新的一列，进行分组时，很有用，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&gt; myvars&lt;-paste(<span class="string">"q"</span>,<span class="number">1</span>:<span class="number">5</span>,sep=<span class="string">""</span>) <span class="comment"># 将q分别与1到5这五个数字连接起来</span></div><div class="line">&gt; myvars</div><div class="line">[<span class="number">1</span>] <span class="string">"q1"</span> <span class="string">"q2"</span> <span class="string">"q3"</span> <span class="string">"q4"</span> <span class="string">"q5"</span></div></pre></td></tr></table></figure>
<h3 id="字符串连接的注意事项"> 字符串连接的注意事项</h3>
<p>以字符串的分离结果为数据进行连接，结果如下所示： <figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; paste(result_split,collapse=<span class="string">" "</span>)-&gt;x3;x3</div><div class="line">[<span class="number">1</span>] <span class="string">"c(\"The\", \"quick\", \"brown\", \"fox\", \"jumps\", \"over\", \"the\", \"lazy\", \"dog\")"</span></div></pre></td></tr></table></figure></p>
<p>会发现字符之间出现的斜杠，原理如下： <figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">List of <span class="number">1</span></div><div class="line"> $ : chr [<span class="number">1</span>:<span class="number">9</span>] <span class="string">"The"</span> <span class="string">"quick"</span> <span class="string">"brown"</span> <span class="string">"fox"</span> <span class="keyword">...</span></div><div class="line">&gt; result_split[[<span class="number">1</span>]]</div><div class="line">[<span class="number">1</span>] <span class="string">"The"</span>   <span class="string">"quick"</span> <span class="string">"brown"</span> <span class="string">"fox"</span>   <span class="string">"jumps"</span> <span class="string">"over"</span>  <span class="string">"the"</span>   <span class="string">"lazy"</span>  <span class="string">"dog"</span>  </div><div class="line">&gt; paste(result_split[[<span class="number">1</span>]],collapse = <span class="string">" "</span>)</div><div class="line">[<span class="number">1</span>] <span class="string">"The quick brown fox jumps over the lazy dog"</span></div><div class="line">&gt; str(result_split) </div><div class="line">List of <span class="number">1</span></div><div class="line"> $ : chr [<span class="number">1</span>:<span class="number">9</span>] <span class="string">"The"</span> <span class="string">"quick"</span> <span class="string">"brown"</span> <span class="string">"fox"</span> <span class="keyword">...</span></div><div class="line">&gt; paste(result_split[[<span class="number">1</span>]],collapse = <span class="string">" "</span>)</div><div class="line">[<span class="number">1</span>] <span class="string">"The quick brown fox jumps over the lazy dog"</span></div><div class="line">&gt; paste(result_split[[<span class="number">1</span>]],collapse = <span class="string">"*"</span>)</div><div class="line">[<span class="number">1</span>] <span class="string">"The*quick*brown*fox*jumps*over*the*lazy*dog"</span></div></pre></td></tr></table></figure></p>
<p>因为分离后的字符串结果为列表（list），对列表直接用paste进行连接时，容易出现这种情况，因此要对列表的第1个元素进行连接才能避免这种情况。另外，在进行连接时主，要用于collapase参数，即用什么连接，案例中使用了空格与星号进行连接。</p>
<h3 id="同时调用sep和collapse进行连接"> 同时调用sep和collapse进行连接</h3>
<p>以下面的这个例子中，先使用sep对不同向量进行连接，然后用collapse进行连接。 <figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; paste(LETTERS[<span class="number">1</span>:<span class="number">5</span>],<span class="number">1</span>:<span class="number">5</span>,sep=<span class="string">"_"</span>,collapse = <span class="string">"---"</span>)</div><div class="line">[<span class="number">1</span>] <span class="string">"A_1---B_2---C_3---D_4---E_5"</span></div></pre></td></tr></table></figure></p>
<h3 id="paste创建有规律的变量名"> paste创建有规律的变量名</h3>
<p>创造含有sample1-5的五个元素的向量： <figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; paste(<span class="string">"Sample"</span>,<span class="number">1</span>:<span class="number">5</span>)</div><div class="line">[<span class="number">1</span>] <span class="string">"Sample 1"</span> <span class="string">"Sample 2"</span> <span class="string">"Sample 3"</span> <span class="string">"Sample 4"</span> <span class="string">"Sample 5"</span></div></pre></td></tr></table></figure></p>
<h2 id="字符的排序"> 字符的排序</h2>
<p>排序用sort(),如果要倒序，则添加<code>decreasing = TRUE</code>，如下所示： <figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">&gt; sort(letters)</div><div class="line"> [<span class="number">1</span>] <span class="string">"a"</span> <span class="string">"b"</span> <span class="string">"c"</span> <span class="string">"d"</span> <span class="string">"e"</span> <span class="string">"f"</span> <span class="string">"g"</span> <span class="string">"h"</span> <span class="string">"i"</span> <span class="string">"j"</span> <span class="string">"k"</span> <span class="string">"l"</span> <span class="string">"m"</span> <span class="string">"n"</span> <span class="string">"o"</span> <span class="string">"p"</span> <span class="string">"q"</span> <span class="string">"r"</span> <span class="string">"s"</span> <span class="string">"t"</span></div><div class="line">[<span class="number">21</span>] <span class="string">"u"</span> <span class="string">"v"</span> <span class="string">"w"</span> <span class="string">"x"</span> <span class="string">"y"</span> <span class="string">"z"</span></div><div class="line">&gt; sort(letters,decreasing = <span class="literal">TRUE</span>)</div><div class="line"> [<span class="number">1</span>] <span class="string">"z"</span> <span class="string">"y"</span> <span class="string">"x"</span> <span class="string">"w"</span> <span class="string">"v"</span> <span class="string">"u"</span> <span class="string">"t"</span> <span class="string">"s"</span> <span class="string">"r"</span> <span class="string">"q"</span> <span class="string">"p"</span> <span class="string">"o"</span> <span class="string">"n"</span> <span class="string">"m"</span> <span class="string">"l"</span> <span class="string">"k"</span> <span class="string">"j"</span> <span class="string">"i"</span> <span class="string">"h"</span> <span class="string">"g"</span></div><div class="line">[<span class="number">21</span>] <span class="string">"f"</span> <span class="string">"e"</span> <span class="string">"d"</span> <span class="string">"c"</span> <span class="string">"b"</span> <span class="string">"a"</span></div><div class="line">&gt; sort(result_split[[<span class="number">1</span>]])</div><div class="line">[<span class="number">1</span>] <span class="string">"brown"</span> <span class="string">"dog"</span>   <span class="string">"fox"</span>   <span class="string">"jumps"</span> <span class="string">"lazy"</span>  <span class="string">"over"</span>  <span class="string">"quick"</span> <span class="string">"the"</span>   <span class="string">"The"</span></div></pre></td></tr></table></figure></p>
<h2 id="查找文本"> 查找文本</h2>
<p>所用的案例是美国州的名字，数据集为state.name，如果要获取字符串的子字符串，则有2种方法，分别为： 1. 通过位置：例如让R返回从第5个位置开始的紧接的第3个字母。 2. 通过模式，例如返回匹配某个模式的子集。</p>
<h3 id="通过位置查询"> 通过位置查询</h3>
<p>此函数为substr，现在返回state.name中各个元素的第3到第6的子字符串，如下所示： <figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&gt; head(state.name)</div><div class="line">[<span class="number">1</span>] <span class="string">"Alabama"</span>    <span class="string">"Alaska"</span>     <span class="string">"Arizona"</span>    <span class="string">"Arkansas"</span>   <span class="string">"California"</span> <span class="string">"Colorado"</span>  </div><div class="line">&gt; head(substr(state.name, start = <span class="number">3</span>,<span class="keyword">stop</span>=<span class="number">6</span>))</div><div class="line">[<span class="number">1</span>] <span class="string">"abam"</span> <span class="string">"aska"</span> <span class="string">"izon"</span> <span class="string">"kans"</span> <span class="string">"lifo"</span> <span class="string">"lora"</span></div></pre></td></tr></table></figure></p>
<h3 id="通过模式查找匹配字符串"> 通过模式查找匹配字符串</h3>
<p>grep()函数可提取子字符串，它需要2个参数： 1. pattern：想要查询的模式； 2. x：被查询的向量。</p>
<p><strong>需要注意的是grep()函数区分大小写</strong> 现在查找名称中含有“New”的州，如下所示： <figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&gt; grep(<span class="string">"New"</span>,state.name)</div><div class="line">[<span class="number">1</span>] <span class="number">29</span> <span class="number">30</span> <span class="number">31</span> <span class="number">32</span></div><div class="line">&gt; grep(<span class="string">"new"</span>,state.name)</div><div class="line">integer(<span class="number">0</span>)</div></pre></td></tr></table></figure></p>
<p>返回的是数值变量，它表示的是元素的位置，例如： <figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&gt; grep(<span class="string">"New"</span>,state.name)</div><div class="line">[<span class="number">1</span>] <span class="number">29</span> <span class="number">30</span> <span class="number">31</span> <span class="number">32</span></div><div class="line">&gt; state.name[c(<span class="number">29</span>,<span class="number">30</span>)]</div><div class="line">[<span class="number">1</span>] <span class="string">"New Hampshire"</span> <span class="string">"New Jersey"</span></div></pre></td></tr></table></figure></p>
<p>可以直接返回元素，如下所示： <figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; state.name[grep(<span class="string">"New"</span>,state.name)]</div><div class="line">[<span class="number">1</span>] <span class="string">"New Hampshire"</span> <span class="string">"New Jersey"</span>    <span class="string">"New Mexico"</span>    <span class="string">"New York"</span></div></pre></td></tr></table></figure></p>
<h3 id="文本替换"> 文本替换</h3>
<p>sub()函数可以用于检索文本中的特定模式，并将其替换为其它的文本； gsub()可以实现所有的替换功能，它的三个参数为：查找的字符串，替换的字符串与被修改的文本。 例如替换A real world is cute中的cute与ugly: <figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">x1 &lt;- <span class="string">"A real world is cute."</span></div><div class="line">x1</div><div class="line">gsub(<span class="string">"cute"</span>,<span class="string">"ugly"</span>,x1)</div></pre></td></tr></table></figure></p>
<h4 id="子字符串的提取案例之一"> 子字符串的提取案例之一：</h4>
<p>一个向量，包含3个文件名，分别为file_a.csv，file_b.csv，file_c.csv，现在要提取这3个文件名中的a、b和c，需要用两个步骤，分别为： 1. 将字符串“file_”替换为空格； 2. 将“.csv”去掉，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&gt; x &lt;- c(<span class="string">"file_a.csv"</span>,<span class="string">"file_b.csv"</span>,<span class="string">"file_c.csv"</span>)</div><div class="line">&gt; y &lt;- gsub(<span class="string">"file_"</span>,<span class="string">""</span>,x);y</div><div class="line">[<span class="number">1</span>] <span class="string">"a.csv"</span> <span class="string">"b.csv"</span> <span class="string">"c.csv"</span></div><div class="line">&gt; gsub(<span class="string">".csv"</span>,<span class="string">""</span>,y)</div><div class="line">[<span class="number">1</span>] <span class="string">"a"</span> <span class="string">"b"</span> <span class="string">"c"</span></div></pre></td></tr></table></figure>
<h2 id="日期格式的创建"> 日期格式的创建</h2>
<p>日期通常以字符串的形式输入到R中，然后转化为数值形式存储的日期变量，函数as.Date()用于执行这种转化，其语法为<code>as.Date(x, &quot;input_format&quot;)</code>，其中x是 字符型数据，input_format则是读入日期的适当格式。</p>
<p>其格式如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">%d 数字表示的日期（<span class="number">0</span>~<span class="number">31</span>） 例如<span class="number">01</span>~<span class="number">31</span></div><div class="line">%a 缩写的星期名 例如Mon</div><div class="line">%A 非缩写的星期名 例如Monday</div><div class="line">%m 月份（<span class="number">00</span>~<span class="number">12</span>） 例如<span class="number">00</span>~<span class="number">12</span></div><div class="line">%b 缩写的月份 例如Jan</div><div class="line">%B 非缩写的月份 例如January</div><div class="line">%y 两位数的年份 例如<span class="number">07</span></div><div class="line">%Y 四位数的年份  例如<span class="number">2007</span></div></pre></td></tr></table></figure>
<p>默认的日期格式为yyyy-mm-dd，语句为： <figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">mydates &lt;- as.Date(c(<span class="string">"2007-06-22"</span>,<span class="string">"2004-02-13"</span>))</div><div class="line">mydates</div><div class="line">str(mydates)</div></pre></td></tr></table></figure></p>
<p>结果如下： &gt; mydates &lt;- as.Date(c(“2007-06-22”,“2004-02-13”)) &gt; mydates &gt;[1] “2007-06-22” “2004-02-13” &gt; str(mydates) &gt; Date[1:2], format: “2007-06-22” “2004-02-13”</p>
<h3 id="weekdays函数"> weekdays()函数</h3>
<p>返回某个日期是星期几如下所示： <figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">## 格式转化</span></div><div class="line">​```r</div><div class="line">&gt; strDates &lt;- c("01/05/1965", "08/16/1975")</div><div class="line">&gt; dates &lt;- as.Date(strDates, "%m/%d/%Y")</div><div class="line">#输入的日期转化为对应日期，其中%m对应为月份，%d对应为日期，%Y对应为年</div><div class="line">&gt; dates</div><div class="line">[1] "1965-01-05" "1975-08-16"</div><div class="line">&gt; str(dates)</div><div class="line"> Date[1:2], format: "1965-01-05" "1975-08-16"</div></pre></td></tr></table></figure></p>
<h3 id="案例"> 案例：</h3>
<p>在leadership数据集中，日期是以mm/dd/yy的格式来表示的，现在将其转化为默认的yyyy-mm-dd格式，代码为： <figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">&gt; myformat &lt;- <span class="string">"%m/%d/%y"</span></div><div class="line">&gt; leadership$testDate &lt;- as.Date(leadership$testDate, myformat)</div><div class="line">&gt; leadership</div><div class="line">  managerID   testDate country gender age item1 item2 item3 item4 item5 stringsAsFactor</div><div class="line"><span class="number">1</span>         <span class="number">1</span> <span class="number">2008</span>-<span class="number">10</span>-<span class="number">24</span>      US      M  <span class="number">32</span>     <span class="number">5</span>     <span class="number">4</span>     <span class="number">5</span>     <span class="number">5</span>     <span class="number">5</span>           <span class="literal">FALSE</span></div><div class="line"><span class="number">2</span>         <span class="number">2</span> <span class="number">2008</span>-<span class="number">10</span>-<span class="number">28</span>      US      <span class="literal">F</span>  <span class="number">45</span>     <span class="number">3</span>     <span class="number">5</span>     <span class="number">2</span>     <span class="number">5</span>     <span class="number">5</span>           <span class="literal">FALSE</span></div><div class="line"><span class="number">3</span>         <span class="number">3</span> <span class="number">2008</span>-<span class="number">10</span>-<span class="number">01</span>      UK      <span class="literal">F</span>  <span class="number">25</span>     <span class="number">3</span>     <span class="number">5</span>     <span class="number">5</span>     <span class="number">5</span>     <span class="number">2</span>           <span class="literal">FALSE</span></div><div class="line"><span class="number">4</span>         <span class="number">4</span> <span class="number">2008</span>-<span class="number">10</span>-<span class="number">12</span>      UK      M  <span class="number">39</span>     <span class="number">3</span>     <span class="number">3</span>     <span class="number">4</span>    <span class="literal">NA</span>    <span class="literal">NA</span>           <span class="literal">FALSE</span></div><div class="line"><span class="number">5</span>         <span class="number">5</span> <span class="number">2009</span>-<span class="number">05</span>-<span class="number">01</span>      UK      <span class="literal">F</span>  <span class="literal">NA</span>     <span class="number">2</span>     <span class="number">2</span>     <span class="number">1</span>     <span class="number">2</span>     <span class="number">1</span>           <span class="literal">FALSE</span></div><div class="line">  agecat</div><div class="line"><span class="number">1</span>  Young</div><div class="line"><span class="number">2</span>  Young</div><div class="line"><span class="number">3</span>  Young</div><div class="line"><span class="number">4</span>  Young</div><div class="line"><span class="number">5</span>   &lt;<span class="literal">NA</span>&gt;</div></pre></td></tr></table></figure></p>
<h3 id="当前日期">当前日期</h3>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">&gt; Sys.Date() <span class="comment"># 给出当前日期</span></div><div class="line">[<span class="number">1</span>] <span class="string">"2014-01-18"</span></div><div class="line">&gt; date() <span class="comment">#返回当前的日期和时间</span></div><div class="line">[<span class="number">1</span>] <span class="string">"Sat Jan 18 14:22:07 2014"</span></div><div class="line">&gt; today&lt;-Sys.Date()</div><div class="line">&gt; format(today,format = <span class="string">"%B %d %Y"</span>) <span class="comment"># 格式化当前日期</span></div><div class="line">[<span class="number">1</span>] <span class="string">"一月 18 2014"</span></div><div class="line">&gt; format(today,fomat =<span class="string">"%A"</span>)</div><div class="line">[<span class="number">1</span>] <span class="string">"2014-01-18"</span></div></pre></td></tr></table></figure>
<h3 id="两个日期的相减">两个日期的相减</h3>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&gt; startdate &lt;- as.Date(<span class="string">"2004-02-12"</span>)</div><div class="line">&gt; enddate &lt;- as.Date(<span class="string">"2011-01-22"</span>)</div><div class="line">&gt; days &lt;-enddate - startdate;days <span class="comment"># 两个时间点之差</span></div><div class="line">Time difference of <span class="number">2536</span> days</div></pre></td></tr></table></figure>
<p>用difftime()来计算时间间隔，并以星期，天，时，分，秒来表示。 <figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&gt; today &lt;- Sys.Date()</div><div class="line">&gt; dob &lt;- as.Date(<span class="string">"1956-10-12"</span>)</div><div class="line">&gt; difftime(today, dob, units=<span class="string">"weeks"</span>)</div><div class="line">Time difference of <span class="number">2988.143</span> weeks</div></pre></td></tr></table></figure></p>
<p>as.character(dates)用于将日期转化为字符型变量，其它与日期有关的函数可以查看help(as.Date),help(strftime)，与日期有关的包为lubridate，复杂日期计算有关 的包为fCalendar。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2017/04/03/R/R笔记（3）-包的操作/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/04/03/R/R笔记（3）-包的操作/" itemprop="url">R笔记（3）——包的操作</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-04-03T12:00:00+08:00">
                2017-04-03
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/R/" itemprop="url" rel="index">
                    <span itemprop="name">R</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  3,809
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  15
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="安装包install.packages">安装包:install.packages()</h2>
<p>括号里面包的名称要加英文引号，在列出的CRAN镜像站点列表中选择一个进行下载，例如 <figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">install.packages(“ggplot2”)</div></pre></td></tr></table></figure></p>
<p>安装包的时候可以切换安装源，如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">install.packages(pkgs, lib, repos = getOption(&quot;repos&quot;),</div><div class="line">    contriburl = contrib.url(repos, type),</div><div class="line">    method, available = NULL, destdir = NULL,</div><div class="line">    dependencies = NA, type = getOption(&quot;pkgType&quot;),</div><div class="line">    configure.args = getOption(&quot;configure.args&quot;),</div><div class="line">    configure.vars = getOption(&quot;configure.vars&quot;),</div><div class="line">    clean = FALSE, Ncpus = getOption(&quot;Ncpus&quot;, 1L),</div><div class="line">    verbose = getOption(&quot;verbose&quot;),</div><div class="line">    libs_only = FALSE, INSTALL_opts, quiet = FALSE,</div><div class="line">    keep_outputs = FALSE, ...)</div></pre></td></tr></table></figure>
<p>使用格式为： <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">install.packages(&quot;ABC&quot;,repos=&quot;http://mirror.bjtu.edu.cn/ &quot;)</div></pre></td></tr></table></figure></p>
<p>如果是要从GitHub上安装包，需要先安装<code>devtools</code>，如下所示： <figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">install.packages(<span class="string">"devtools"</span>)</div><div class="line">install_github(<span class="string">"genomicsclass/dagdata"</span>)</div></pre></td></tr></table></figure></p>
<h2 id="批量下载并且加载r包">批量下载并且加载R包</h2>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">list.of.packages &lt;- c(<span class="string">"xx"</span>, <span class="string">"yy"</span>) <span class="comment"># replace xx and yy with package names</span></div><div class="line">new.packages &lt;- list.of.packages[!(list.of.packages %<span class="keyword">in</span>% installed.packages()[,<span class="string">"Package"</span>])]</div><div class="line"><span class="keyword">if</span>(length(new.packages)) install.packages(new.packages)</div><div class="line">lapply(new.packages, <span class="keyword">require</span>, character.only=<span class="literal">T</span>)</div></pre></td></tr></table></figure>
<h2 id="包的加载">包的加载</h2>
<p>包的载入library()或require()，安装完包后，需要加载才能使用其中的函数，此时括号中不使用引号。两者的不同之处在于library()载入之后不返回任何信息，而require()载入后则会返回TRUE，因此require()适合用于程序的书写。 <figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">library</span>(ggplot2)</div><div class="line"><span class="keyword">require</span>(foreign)</div><div class="line">Loading required package: foreign</div></pre></td></tr></table></figure></p>
<h2 id="查看一个包的帮助">查看一个包的帮助</h2>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">help(package=<span class="string">"base"</span>)</div></pre></td></tr></table></figure>
<h2 id="卸载包">卸载包</h2>
<p>detach()，这是library()的反向操作，此操作主要是为了避免某些包中的函数名称相同，造成冲突，注意与library()的参数不同，detach()参数为detach(package:包的名称),library(包的名称)，例如： <figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">library</span>(ggplot2) <span class="comment">#加载包</span></div><div class="line">(.packages()) <span class="comment">#列出当前已经加载的包</span></div><div class="line"> [<span class="number">1</span>] <span class="string">"foreign"</span>   <span class="string">"ggplot2"</span>   <span class="string">"stats"</span>     <span class="string">"graphics"</span>  <span class="string">"grDevices"</span> <span class="string">"utils"</span>    </div><div class="line"> [<span class="number">7</span>] <span class="string">"datasets"</span>  <span class="string">"methods"</span>   <span class="string">"base"</span></div><div class="line"><span class="keyword">detach</span>(package:ggplot2)  <span class="comment">#卸载ggplot2包</span></div><div class="line">(.packages()) <span class="comment">#列出当前已经加载的包</span></div><div class="line"> [<span class="number">1</span>] <span class="string">"foreign"</span>   <span class="string">"stats"</span>     <span class="string">"graphics"</span>  <span class="string">"grDevices"</span> <span class="string">"utils"</span>     <span class="string">"datasets"</span> </div><div class="line"> [<span class="number">7</span>] <span class="string">"methods"</span>   <span class="string">"base"</span></div></pre></td></tr></table></figure></p>
<h3 id="删除包">删除包</h3>
<p>remove.packages() 使用条件：R语言自带的install.packages函数来安装一个包时，都是默认安装最新版的。 但是有些R包的开发者他会引用其它的一些R包，但是它用的是旧版本的功能，自己来不及更新或者疏忽了。 而我们又不得不用他的包，这时候就不得不卸载最新版包，转而安装旧版本包。</p>
<h2 id="查询加载的包">查询加载的包</h2>
<p>search() <figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">search()</div><div class="line"> [<span class="number">1</span>] <span class="string">".GlobalEnv"</span>        <span class="string">"package:stats"</span>     <span class="string">"package:graphics"</span> </div><div class="line"> [<span class="number">4</span>] <span class="string">"package:grDevices"</span> <span class="string">"package:utils"</span>     <span class="string">"package:datasets"</span> </div><div class="line"> [<span class="number">7</span>] <span class="string">"package:methods"</span>   <span class="string">"Autoloads"</span>         <span class="string">"package:base"</span></div></pre></td></tr></table></figure></p>
<h2 id="libpaths能够显示库所在的位置">.libPaths()能够显示库所在的位置</h2>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">.libPaths()</div><div class="line"> [<span class="number">1</span>] <span class="string">"C:/Users/Cloud/Documents/R/win-library/3.1"</span></div><div class="line"> [<span class="number">2</span>] <span class="string">"C:/Program Files/R/R-3.1.3/library"</span></div></pre></td></tr></table></figure>
<h2 id="library显示库中有哪些包">library()显示库中有哪些包</h2>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">library</span>()</div><div class="line">backports               Reimplementations of Functions Introduced Since</div><div class="line">                        R-<span class="number">3.0</span><span class="number">.0</span></div><div class="line">base64enc               Tools <span class="keyword">for</span> base64 encoding</div><div class="line">bitops                  Bitwise Operations</div><div class="line">bookdown                Authoring Books and Technical Documents with R</div><div class="line">                        Markdown</div><div class="line">caTools                 Tools: moving window statistics, GIF, Base64,</div><div class="line">                        ROC AUC, etc.</div><div class="line">cellranger              Translate Spreadsheet Cell Ranges to Rows and</div><div class="line">                        Columns</div><div class="line">digest                  Create Compact Hash Digests of R Objects</div><div class="line">evaluate                Parsing and Evaluation Tools that Provide More</div><div class="line">                        Details than the Default</div><div class="line"><span class="keyword">...</span></div><div class="line"><span class="keyword">...</span></div></pre></td></tr></table></figure>
<h3 id="查看已经安装的包">查看已经安装的包</h3>
<p>函数installed.packages()</p>
<p>如下所示： <img src="http://ortxpw68f.bkt.clouddn.com/professional/180821/fid4l75ccL.png?imageslim" alt="mark"> ## 包的更新 <figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">update.packages()</div></pre></td></tr></table></figure></p>
<h2 id="查看本地的包">查看本地的包</h2>
<h3 id="查看默认加载的包忽略基本的包">查看默认加载的包，忽略基本的包</h3>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; getOption(<span class="string">"defaultPackages"</span>)</div><div class="line">[<span class="number">1</span>] <span class="string">"datasets"</span>  <span class="string">"utils"</span>     <span class="string">"grDevices"</span> <span class="string">"graphics"</span>  <span class="string">"stats"</span>     <span class="string">"methods"</span></div></pre></td></tr></table></figure>
<h3 id="查看当前已经加载过的包">查看当前已经加载过的包</h3>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&gt; (.packages())</div><div class="line">[<span class="number">1</span>] <span class="string">"stats"</span>     <span class="string">"graphics"</span>  <span class="string">"grDevices"</span> <span class="string">"utils"</span>     <span class="string">"datasets"</span>  <span class="string">"methods"</span></div><div class="line">[<span class="number">7</span>] <span class="string">"base"</span></div></pre></td></tr></table></figure>
<h2 id="显示所有可用的包">显示所有可用的包</h2>
<p>(.packages(all.available=TRUE)) <figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line">(.packages(all.available=<span class="literal">TRUE</span>))</div><div class="line">  [<span class="number">1</span>] <span class="string">"bitops"</span>       <span class="string">"car"</span>          <span class="string">"caTools"</span>      <span class="string">"coin"</span>        </div><div class="line">  [<span class="number">5</span>] <span class="string">"colorspace"</span>   <span class="string">"crayon"</span>       <span class="string">"curl"</span>         <span class="string">"dichromat"</span>   </div><div class="line">  [<span class="number">9</span>] <span class="string">"digest"</span>       <span class="string">"evaluate"</span>     <span class="string">"formatR"</span>      <span class="string">"fun"</span>         </div><div class="line"> [<span class="number">13</span>] <span class="string">"ggplot2"</span>      <span class="string">"gtable"</span>       <span class="string">"highr"</span>        <span class="string">"htmltools"</span>   </div><div class="line"> [<span class="number">17</span>] <span class="string">"httr"</span>         <span class="string">"ISwR"</span>         <span class="string">"jsonlite"</span>     <span class="string">"KMsurv"</span>      </div><div class="line"> [<span class="number">21</span>] <span class="string">"knitr"</span>        <span class="string">"labeling"</span>     <span class="string">"lme4"</span>         <span class="string">"magrittr"</span>    </div><div class="line"> [<span class="number">25</span>] <span class="string">"maps"</span>         <span class="string">"maptools"</span>     <span class="string">"markdown"</span>     <span class="string">"MatrixModels"</span></div><div class="line"> [<span class="number">29</span>] <span class="string">"memoise"</span>      <span class="string">"mime"</span>         <span class="string">"minqa"</span>        <span class="string">"mnormt"</span>      </div><div class="line"> [<span class="number">33</span>] <span class="string">"modeltools"</span>   <span class="string">"multcomp"</span>     <span class="string">"munsell"</span>      <span class="string">"mvtnorm"</span>     </div><div class="line"> [<span class="number">37</span>] <span class="string">"nloptr"</span>       <span class="string">"openssl"</span>      <span class="string">"pbkrtest"</span>     <span class="string">"plyr"</span>        </div><div class="line"> [<span class="number">41</span>] <span class="string">"praise"</span>       <span class="string">"psych"</span>        <span class="string">"quantreg"</span>     <span class="string">"R6"</span>          </div><div class="line"> [<span class="number">45</span>] <span class="string">"RColorBrewer"</span> <span class="string">"Rcpp"</span>         <span class="string">"RcppEigen"</span>    <span class="string">"RCurl"</span>       </div><div class="line"> [<span class="number">49</span>] <span class="string">"reshape2"</span>     <span class="string">"rmarkdown"</span>    <span class="string">"sandwich"</span>     <span class="string">"scales"</span>      </div><div class="line"> [<span class="number">53</span>] <span class="string">"sp"</span>           <span class="string">"SparseM"</span>      <span class="string">"stringi"</span>      <span class="string">"stringr"</span>     </div><div class="line"> [<span class="number">57</span>] <span class="string">"swirl"</span>        <span class="string">"testthat"</span>     <span class="string">"TH.data"</span>      <span class="string">"yaml"</span>        </div><div class="line"> [<span class="number">61</span>] <span class="string">"zoo"</span>          <span class="string">"base"</span>         <span class="string">"boot"</span>         <span class="string">"class"</span>       </div><div class="line"> [<span class="number">65</span>] <span class="string">"cluster"</span>      <span class="string">"codetools"</span>    <span class="string">"compiler"</span>     <span class="string">"datasets"</span>    </div><div class="line"> [<span class="number">69</span>] <span class="string">"foreign"</span>      <span class="string">"graphics"</span>     <span class="string">"grDevices"</span>    <span class="string">"grid"</span>        </div><div class="line"> [<span class="number">73</span>] <span class="string">"KernSmooth"</span>   <span class="string">"lattice"</span>      <span class="string">"MASS"</span>         <span class="string">"Matrix"</span>      </div><div class="line"> [<span class="number">77</span>] <span class="string">"methods"</span>      <span class="string">"mgcv"</span>         <span class="string">"nlme"</span>         <span class="string">"nnet"</span>        </div><div class="line"> [<span class="number">81</span>] <span class="string">"parallel"</span>     <span class="string">"rpart"</span>        <span class="string">"spatial"</span>      <span class="string">"splines"</span>     </div><div class="line"> [<span class="number">85</span>] <span class="string">"stats"</span>        <span class="string">"stats4"</span>       <span class="string">"survival"</span>     <span class="string">"tcltk"</span>       </div><div class="line"> [<span class="number">89</span>] <span class="string">"tools"</span>        <span class="string">"utils"</span></div></pre></td></tr></table></figure></p>
<h2 id="自定义启动时候的加载包">自定义启动时候的加载包</h2>
<p>如果需要长期使用某个包的话，每次开启都需要输入library()，比较麻烦，因此可以让R启动时自动加载某些包。在R的安装目录/etc/Rprofile.site加入下载语句：</p>
<p>例如让R启动时自动加载ggplot2包 <figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">local(&#123;old &lt;- getOption(“defaultPackages”)</div><div class="line">options(defaultPackages = c(old, “ggplot2”))&#125;)</div></pre></td></tr></table></figure></p>
<h2 id="安装包并加载包">安装包，并加载包</h2>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="keyword">if</span>(!<span class="keyword">require</span>(<span class="string">"multcomp"</span>))&#123;</div><div class="line"></div><div class="line">  install.packages(<span class="string">"multcomp"</span>)</div><div class="line"></div><div class="line">  <span class="keyword">library</span>(multcomp)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="常用r包的搜集">常用R包的搜集</h2>
<h3 id="数据导入">数据导入</h3>
<p>以下R包主要用于数据导入和保存数据</p>
<ul>
<li><p>feather：一种快速，轻量级的文件格式。在R和python上都可使用</p></li>
<li><p>readr：实现表格数据的快速导入。中文介绍可参考这里</p></li>
<li><p>readxl：读取Microsoft Excel电子表格数据</p></li>
<li><p>openxlsx：读取Microsoft Excel电子表格数据</p></li>
<li><p>googlesheets：读取google电子表格数据</p></li>
<li><p>haven：读取SAS，SPSS和Stata统计软件格式的数据</p></li>
<li><p>httr：从网站开放的API中读取数据</p></li>
<li><p>rvest：网页数据抓取包</p></li>
<li><p>xml2：读取HTML和XML格式数据</p></li>
<li><p>webreadr：读取常见的Web日志格式数据</p></li>
<li><p>DBI：数据库管理系统通用接口包</p></li>
<li><ul>
<li>RMySQL：用于连接MySQL数据库的R包</li>
</ul></li>
<li>RPostgres：用于连接PostgreSQL数据库的R包</li>
<li><p>bigrquery用于连接Google BigQuery的R包</p></li>
<li><p>PivotalR：用于读取Pivitol（Greenplum）和HAWQ数据库中的数据</p></li>
<li><p>dplyr：提供了一个访问常见数据库的接口</p></li>
<li><p>data.table：data.table包的<code>fread()</code>函数可以快速读取大数据集</p></li>
<li><p>git2r：用于访问git仓库</p></li>
</ul>
<h3 id="数据整理">数据整理</h3>
<p>以下R包主要用于数据整理，以便于你后续建模分析：</p>
<ul>
<li>tidyr：用于整理表格数据的布局</li>
<li>dplyr：用于将多个数据表连接成一个整齐的数据集</li>
<li>purrr：函数式编程工具，在做数据整理时非常有用。</li>
<li>broom：用于将统计模型的结果整理成数据框形式</li>
<li>zoo：定义了一个名zoo的S3类型对象，用于描述规则的和不规则的有序的时间序列数据。</li>
</ul>
<h3 id="数据可视化">数据可视化</h3>
<p>以下R包用于数据可视化：</p>
<ul>
<li><p>ggplot2及其扩展：ggplot2包提供了一个强大的绘图系统，并实现了以下扩展</p></li>
<li><ul>
<li>ggthemes：提供扩展的图形风格主题</li>
</ul></li>
<li>ggmap：提供Google Maps，Open Street Maps等流行的在线地图服务模块</li>
<li>ggiraph：绘制交互式的ggplot图形</li>
<li>ggstance：实现常见图形的横向版本</li>
<li>GGally：绘制散点图矩阵</li>
<li>ggalt：添加额外的坐标轴，geoms等</li>
<li>ggforce：添加额外geoms等</li>
<li>ggrepel：用于避免图形标签重叠</li>
<li>ggraph：用于绘制网络状、树状等特定形状的图形</li>
<li>ggpmisc：光生物学相关扩展</li>
<li>geomnet：绘制网络状图形</li>
<li>ggExtra：绘制图形的边界直方图</li>
<li>gganimate：绘制动画图</li>
<li>plotROC：绘制交互式ROC曲线图</li>
<li>ggspectra：绘制光谱图</li>
<li>ggnetwork：网络状图形的geoms</li>
<li>ggradar：绘制雷达图</li>
<li>ggTimeSeries：时间序列数据可视化</li>
<li>ggtree：树图可视化</li>
<li><p>ggseas：季节调整工具</p></li>
<li><p>lattice：生成栅栏图</p></li>
<li><p>rgl：交互式3D绘图</p></li>
<li><p>ggvis：交互式图表多功能系统</p></li>
<li><p>htmlwidgets：一个专为R语言打造的可视化JS库</p></li>
<li><ul>
<li>leaflet：绘制交互式地图</li>
</ul></li>
<li>dygraphs：绘制交互式时间序列图</li>
<li>plotly：交互式绘图包，中文介绍详见这里</li>
<li>rbokeh：用于创建交互式图表和地图，中文介绍</li>
<li>Highcharter：绘制交互式Highcharts图</li>
<li>visNetwork：绘制交互式网状图</li>
<li>networkD3：绘制交互式网状图</li>
<li>d3heatmap：绘制交互式热力图，中文介绍</li>
<li>DT：用于创建交互式表格</li>
<li>threejs：绘制交互式3d图形和地球仪 -rglwidget：绘制交互式3d图形</li>
<li>DiagrammeR：绘制交互式图表</li>
<li><p>MetricsGraphics：绘制交互式MetricsGraphics图</p></li>
<li><p>rCharts：提供了对多个javascript数据可视化库（highcharts/nvd3/polychart）的R封装。</p></li>
<li><p>coefplot：可视化统计模型结果</p></li>
<li><p>quantmod：可视化金融图表</p></li>
<li><p>colorspace：基于HSL的调色板</p></li>
<li><p>viridis：Matplotlib viridis调色板</p></li>
<li><p>munsell：Munsell调色板</p></li>
<li><p>RColorBrewer：图形调色板</p></li>
<li><p>igraph：用于网络分析和可视化</p></li>
<li><p>latticeExtra：lattice绘图系统扩展包</p></li>
<li><p>sp：空间数据工具</p></li>
</ul>
<h3 id="数据转换">数据转换</h3>
<p>以下R包用于将数据转换为新的数据类型</p>
<ul>
<li>dplyr：一个用于高效数据清理的R包。视频学习课程</li>
<li>magrittr：一个高效的管道操作工具包。</li>
<li>tibble：高效的显示表格数据的结构</li>
<li>stringr：一个字符串处理工具集</li>
<li>lubridate：用于处理日期时间数据</li>
<li>xts：xts是对时间序列数据(zoo)的一种扩展实现，提供了时间序列的操作接口。</li>
<li>data.table：用于快速处理大数据集</li>
<li>vtreat：一个对预测模型进行变量预处理的工具</li>
<li>stringi：一个快速字符串处理工具</li>
<li>Matrix：著名的稀疏矩阵包</li>
</ul>
<h3 id="统计建模与推断">统计建模与推断</h3>
<p>下述R包是统计建模最常用的几个R包，其中的一些R包适用于多个主题。</p>
<ul>
<li>car：提供了大量的增强版的拟合和评价回归模型的函数。</li>
<li>Hmisc：提供各种用于数据分析的函数</li>
<li>multcomp：参数模型中的常见线性假设的同时检验和置信区间计算，包括线性、广义线性、线性混合效应和生存模型。</li>
<li>pbkrtest用于线性混合效应模型的参数Bootstrap检验</li>
<li>MatrixModels：用于稠密矩阵和稀疏矩阵建模</li>
<li>mvtnorm：用于计算多元正态分布和t分布的概率，分位数，随机偏差等</li>
<li>SparseM：用于稀疏矩阵的基本线性代数运算</li>
<li>lme4：利用C++矩阵库 Eigen进行线性混合效应模型的计算。</li>
<li>broom：将统计模型结果整理成数据框形式</li>
<li>caret：一个用于解决分类和回归问题的数据训练综合工具包</li>
<li>glmnet：通过极大惩罚似然来拟合广义线性模型</li>
<li>gbm：用于实现随机梯度提升算法</li>
<li>xgboost：全称是eXtreme Gradient Boosting。是Gradient Boosting Machine的一个c++实现。目前已制作了xgboost工具的R语言接口。详见统计之都的一篇介绍</li>
<li>randomForest：提供了用随机森林做回归和分类的函数</li>
<li>ranger：用于随机森林算法的快速实现</li>
<li>h2o：H2O是0xdata的旗舰产品，是一款核心数据分析平台。它的一部分是由R语言编写的，另一部分是由Java和Python语言编写的。用户可以部署H2O的R程序安装包，之后就可以在R语言环境下运行了。</li>
<li>ROCR：通过绘图来可视化分类器的综合性能。</li>
<li>pROC：用于可视化，平滑和对比ROC曲线</li>
</ul>
<h3 id="沟通交流">沟通交流</h3>
<p>以下R包用于实现数据科学结果的自动化报告，以便于你跟人们进行沟通交流。</p>
<ul>
<li>rmarkdown ：用于创建可重复性报告和动态文档</li>
<li>knitr：用于在PDF和HTML文档中嵌入R代码块</li>
<li>flexdashboard：基于rmarkdown，可以轻松的创建仪表盘</li>
<li>bookdown：以R Markdown为基础，用于创作书籍和长篇文档</li>
<li>rticles：提供了一套R Markdown模板</li>
<li>tufte：用于实现Tufte讲义风格的R Markdown模板</li>
<li>DT：用于创建交互式的数据表</li>
<li>pixiedust：用于自定义数据表的输出</li>
<li>xtable：用于自定义数据表的输出</li>
<li>highr：用于实现R代码的LaTeX或HTML格式输出</li>
<li>formatR：通过<code>tidy_source</code>函数格式化R代码的输出</li>
<li>yaml：用于实现R数据与YAML格式数据之间的通信。</li>
</ul>
<h3 id="自动化分析">自动化分析</h3>
<p>以下R包用于创建自动化分析结果的数据科学产品：</p>
<ul>
<li><p>shiny：一个使用R语言开发交互式web应用程序的工具。中文教程</p></li>
<li><ul>
<li>shinydashboard：用于创建交互式仪表盘</li>
</ul></li>
<li>shinythemes：给出了Shiny应用程序的常用风格主题</li>
<li>shinyAce：为Shiny应用程序开发者提供Ace代码编辑器。</li>
<li>shinyjs：用于在Shiny应用程序中执行常见的JavaScript操作</li>
<li>miniUI：提供了一个UI小部件，用于在R命令行中集成交互式应用程序</li>
<li>shinyapps.io：为创建的Shiny应用程序提供托管服务</li>
<li>Shiny Server Open Source：为Shiny应用程序提供开源免费的服务器</li>
<li><p>Shiny Server Pro：为企业级用户提供一个Shiny应用程序服务器</p></li>
<li><p>rsconnect：用于将Shiny应用程序部署到shinyapps.io</p></li>
<li><p>plumber：用于将R代码转化为一个web API</p></li>
<li><p>rmarkdown：用于创建可重复性报告和动态文档</p></li>
<li><p>rstudioapi：用于安全地访问RStudio IDE的API</p></li>
</ul>
<h3 id="程序开发">程序开发</h3>
<p>以下这些包主要用于开发自定义的R包：</p>
<ul>
<li>RStudio Desktop IDE：R的IDE。大家都懂，不用解释。</li>
<li>RStudio Server Open Source：开源免费的RStudio服务器</li>
<li>RStudio Server Professional：商业版RStudio服务器</li>
<li>devtools：一个让开发R包变得简单的工具集</li>
<li>packrat：创建项目的特定库，用于处理包的版本问题，增强代码重现能力。</li>
<li>drat：一个用于创建和使用备选R包库的工具</li>
<li>testthat：单元测试，让R包稳定、健壮，减少升级的痛苦。</li>
<li>roxygen2：通过注释的方式，生成文档，远离Latex的烦恼。</li>
<li>purrr：一个用于 提供函数式编程方法的工具</li>
<li>profvis：用于可视化R代码的性能分析数据</li>
<li>Rcpp：用于实现R与C++的无缝整合。详见统计之都文章</li>
<li>R6：R6是R语言的一个面向对象的R包，可以更加高效的构建面向对象系统。</li>
<li>htmltools：用于生成HTML格式输出</li>
<li>nloptr：提供了一个NLopt非线性优化库的接口</li>
<li>minqa：一个二次近似的优化算法包</li>
<li>rngtools：一个用于处理随机数生成器的实用工具</li>
<li>NMF：提供了一个执行非负矩阵分解的算法和框架</li>
<li>crayon：用于在输出终端添加颜色</li>
<li>RJSONIO：rjson是一个R语言与json进行转的包，是一个非常简单的包，支持用 C类库转型和R语言本身转型两种方式。</li>
<li>jsonlite：用于实现R语言与json数据格式之间的转化</li>
<li>RcppArmadillo：提供了一个Armadillo C++ Library（一种C++的线性代数库）的接口</li>
</ul>
<hr>
<h3 id="实验数据">实验数据</h3>
<p>以下R包给出了案例实战过程中可用的训练数据集：</p>
<ul>
<li>babynames：包含由美国社会保障局提供的三个数据集</li>
<li>neiss：2009-2014年期间提供给美国急诊室的所有事故报告样本数据</li>
<li>yrbss：美国疾病控制中心2009-2013年期间青年危险行为监测系统数据</li>
<li>hflights：</li>
<li>USAboundaries：2011年全年休斯顿机场的所有航班数据</li>
<li>rworldmap：国家边界数据</li>
<li>usdanutrients：美国农业部营养数据库</li>
<li>fueleconomy：美国环保署1984-2015年期间的燃油经济数据</li>
<li>nasaweather：包含了一个覆盖中美洲的非常粗糙的24*24格地理位置和大气测量数据。</li>
<li>mexico-mortality：墨西哥死亡人数数据</li>
<li>data-movies和ggplotmovies：来自互联网电影数据库imdb.com的数据</li>
<li>pop-flows：2008年全美人口流动数据</li>
<li>data-housing-crisis：经过清洗后的2008美国房地产危机数据</li>
<li>gun-sales：纽约时报提供的有关枪支购买的每月背景调查统计分析数据</li>
<li>stationaRy：从成千上万个全球站点收集到的每小时气象数据</li>
<li>gapminder：摘自Gapminder的数据</li>
<li>janeaustenr：简·奥斯丁小说全集数据</li>
</ul>
<h2 id="查看r的版本">查看R的版本</h2>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sessionInfo() <span class="comment"># 要加括号</span></div></pre></td></tr></table></figure>
<p>如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">&gt; sessionInfo() <span class="comment"># 要加括号</span></div><div class="line">R version <span class="number">3.4</span><span class="number">.0</span> (<span class="number">2017</span>-<span class="number">04</span>-<span class="number">21</span>)</div><div class="line">Platform: x86_64-w64-mingw32/x64 (<span class="number">64</span>-bit)</div><div class="line">Running under: Windows &gt;= <span class="number">8</span> x64 (build <span class="number">9200</span>)</div><div class="line"></div><div class="line">Matrix products: default</div><div class="line"></div><div class="line">locale:</div><div class="line">[<span class="number">1</span>] LC_COLLATE=Chinese (Simplified)_China.936  LC_CTYPE=Chinese (Simplified)_China.936   </div><div class="line">[<span class="number">3</span>] LC_MONETARY=Chinese (Simplified)_China.936 LC_NUMERIC=C                              </div><div class="line">[<span class="number">5</span>] LC_TIME=Chinese (Simplified)_China.936    </div><div class="line"></div><div class="line">attached base packages:</div><div class="line">[<span class="number">1</span>] stats     graphics  grDevices utils     datasets  methods   base     </div><div class="line"></div><div class="line">other attached packages:</div><div class="line">[<span class="number">1</span>] downloader_0.4 rafalib_1.0.0 </div><div class="line"></div><div class="line">loaded via a namespace (and not attached):</div><div class="line">[<span class="number">1</span>] compiler_3.4.0     tools_3.4.0        RColorBrewer_1.1-<span class="number">2</span> digest_0.6.15</div></pre></td></tr></table></figure>
<h2 id="参考资料">参考资料</h2>
<ol style="list-style-type: decimal">
<li>http://www.xueqing.tv/cms/article/198</li>
<li>http://blog.fens.me/</li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2017/04/02/R/R笔记（X）-ggplot2练习/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/04/02/R/R笔记（X）-ggplot2练习/" itemprop="url">R笔记（X）——ggplot2练习</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-04-02T12:00:00+08:00">
                2017-04-02
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/R/" itemprop="url" rel="index">
                    <span itemprop="name">R</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  3,899
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  20
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="前言">前言</h2>
<p>这一篇笔记主要是翻译国外的一个网站的教程，它对<code>ggplot2</code>的绘图做了很好的汇总，原文地址：<a href="http://egret.psychol.cam.ac.uk/statistics/R/graphs2.html" target="_blank" rel="external">R: basic graphs 2 (with ggplot2)</a>，原始数据在原文上有。</p>
<h2 id="第一部分导入数据">第一部分：导入数据</h2>
<p>原始数据文件有7个，我已经下载到本地硬盘，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180820/0gHKJDKL6c.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>直接导入即可，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">library</span>(ggplot2)</div><div class="line"></div><div class="line">phdfig21a &lt;- read.table(<span class="string">"D:\\Personal\\R_code\\data\\ggplot2\\PhD_fig21A.csv"</span>,header=<span class="literal">TRUE</span>, sep=<span class="string">","</span>, na.strings=<span class="string">"NA"</span>, dec=<span class="string">"."</span>, strip.white=<span class="literal">TRUE</span>)</div><div class="line"><span class="comment"># header=TRUE表示要读取标题</span></div><div class="line"><span class="comment"># sep=","表示数据文件PhD_fig21A.csv中的数据是以逗号分割的，csv文件默认都是以逗号分割的，如果是以空格分割的，则用sep=" "（中间空一格）。</span></div><div class="line"><span class="comment"># na.strings="NA"是将空白的数据用NA替代</span></div><div class="line"><span class="comment"># dec="."用来表示小数点</span></div><div class="line"><span class="comment"># strip.white=TRUE 表示当指定了sep时，则将字符元素前后的空格去掉（而数值元素则默认是去掉前后的空格）</span></div><div class="line"></div><div class="line"></div><div class="line">phdfig37b &lt;- read.table(<span class="string">"D:\\Personal\\R_code\\data\\ggplot2\\PhD_fig37B.csv"</span>, header=<span class="literal">TRUE</span>, sep=<span class="string">","</span>, na.strings=<span class="string">"NA"</span>, dec=<span class="string">"."</span>, strip.white=<span class="literal">TRUE</span>)</div><div class="line"></div><div class="line">phdfig22d &lt;- read.table(<span class="string">"D:\\Personal\\R_code\\data\\ggplot2\\PhD_fig22D.csv"</span>, header=<span class="literal">TRUE</span>, sep=<span class="string">","</span>, na.strings=<span class="string">"NA"</span>, dec=<span class="string">"."</span>, strip.white=<span class="literal">TRUE</span>)</div><div class="line">phdfig23 &lt;- read.table(<span class="string">"D:\\Personal\\R_code\\data\\ggplot2\\PhD_fig23.csv"</span>, header=<span class="literal">TRUE</span>, sep=<span class="string">","</span>, na.strings=<span class="string">"NA"</span>, dec=<span class="string">"."</span>, strip.white=<span class="literal">TRUE</span>)</div><div class="line">phdfig28c &lt;- read.table(<span class="string">"D:\\Personal\\R_code\\data\\ggplot2\\PhD_fig28C.csv"</span>, header=<span class="literal">TRUE</span>, sep=<span class="string">","</span>, na.strings=<span class="string">"NA"</span>, dec=<span class="string">"."</span>, strip.white=<span class="literal">TRUE</span>)</div><div class="line">mdfig30a &lt;- read.table(<span class="string">"D:\\Personal\\R_code\\data\\ggplot2\\MD_fig30A.csv"</span>, header=<span class="literal">TRUE</span>, sep=<span class="string">","</span>, na.strings=<span class="string">"NA"</span>, dec=<span class="string">"."</span>, strip.white=<span class="literal">TRUE</span>)</div><div class="line">mdfig30b &lt;- read.table(<span class="string">"D:\\Personal\\R_code\\data\\ggplot2\\MD_fig30B.csv"</span>, header=<span class="literal">TRUE</span>, sep=<span class="string">","</span>, na.strings=<span class="string">"NA"</span>, dec=<span class="string">"."</span>, strip.white=<span class="literal">TRUE</span>)</div></pre></td></tr></table></figure>
<p>查看一下其中的某个数据，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">&gt; head(phdfig37b) <span class="comment"># 先查看一下phdfig37b的数据集</span></div><div class="line">  session       sham ACCX  SEM_sham  SEM_accx</div><div class="line"><span class="number">1</span>       <span class="number">1</span>  <span class="number">0.0000000</span> -<span class="number">0.2</span> <span class="number">0.7881701</span> <span class="number">0.4163332</span></div><div class="line"><span class="number">2</span>       <span class="number">2</span>  <span class="number">0.6666667</span> -<span class="number">0.3</span> <span class="number">0.4819992</span> <span class="number">0.3666667</span></div><div class="line"><span class="number">3</span>       <span class="number">3</span> -<span class="number">0.3333333</span> -<span class="number">0.2</span> <span class="number">0.7212503</span> <span class="number">0.5333333</span></div><div class="line"><span class="number">4</span>       <span class="number">4</span>  <span class="number">1.5833333</span>  <span class="number">1.0</span> <span class="number">0.5833333</span> <span class="number">0.4714045</span></div><div class="line"><span class="number">5</span>       <span class="number">5</span> -<span class="number">0.2500000</span> -<span class="number">0.3</span> <span class="number">0.7699370</span> <span class="number">0.5174725</span></div><div class="line"><span class="number">6</span>       <span class="number">6</span>  <span class="number">1.7500000</span> -<span class="number">0.8</span> <span class="number">0.6410810</span> <span class="number">0.4898979</span></div><div class="line">&gt; tail(phdfig37b)</div><div class="line">   session     sham ACCX  SEM_sham  SEM_accx</div><div class="line"><span class="number">7</span>        <span class="number">7</span> <span class="number">1.000000</span> -<span class="number">1.1</span> <span class="number">0.8438727</span> <span class="number">0.7951240</span></div><div class="line"><span class="number">8</span>        <span class="number">8</span> <span class="number">4.083333</span>  <span class="number">0.2</span> <span class="number">1.0405297</span> <span class="number">0.6463573</span></div><div class="line"><span class="number">9</span>        <span class="number">9</span> <span class="number">4.666667</span>  <span class="number">1.6</span> <span class="number">0.6999278</span> <span class="number">0.5617433</span></div><div class="line"><span class="number">10</span>      <span class="number">10</span> <span class="number">3.333333</span>  <span class="number">3.3</span> <span class="number">1.0249415</span> <span class="number">1.0005554</span></div><div class="line"><span class="number">11</span>      <span class="number">11</span> <span class="number">4.500000</span>  <span class="number">5.3</span> <span class="number">0.7229988</span> <span class="number">1.0857665</span></div><div class="line"><span class="number">12</span>      <span class="number">12</span> <span class="number">4.416667</span>  <span class="number">3.9</span> <span class="number">0.6331539</span> <span class="number">0.7063207</span></div></pre></td></tr></table></figure>
<p>现在构建ggplot2能够识别的数据框，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">phdfig37b_long = with(phdfig37b,</div><div class="line">                      rbind( data.frame( lesion = <span class="string">"sham"</span>, session = session, diffscore = sham, sem = SEM_sham ),</div><div class="line">                             data.frame( lesion = <span class="string">"ACCX"</span>, session = session, diffscore = ACCX, sem = SEM_accx ) )</div><div class="line">)</div><div class="line"><span class="comment"># 建立一个数据框，第1列为lesion，并且为"sham"</span></div><div class="line"><span class="comment"># 第2列为session，值等于phdfig37b中的session</span></div><div class="line"><span class="comment"># 第3列为diffscore，值等于sham,第4列为sem，值等于SEM_sham</span></div></pre></td></tr></table></figure>
<p>查看一下数据框，如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">&gt; head(phdfig37b_long)</div><div class="line">  lesion session  diffscore       sem</div><div class="line">1   sham       1  0.0000000 0.7881701</div><div class="line">2   sham       2  0.6666667 0.4819992</div><div class="line">3   sham       3 -0.3333333 0.7212503</div><div class="line">4   sham       4  1.5833333 0.5833333</div><div class="line">5   sham       5 -0.2500000 0.7699370</div><div class="line">6   sham       6  1.7500000 0.6410810</div></pre></td></tr></table></figure>
<h2 id="第二部分-qplot快速制图">第二部分 qplot快速制图</h2>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">p&lt;-qplot(session, diffscore, colour=lesion, data=phdfig37b_long) </div><div class="line">p&lt;-p+ geom_line() </div><div class="line">p&lt;-p+ geom_errorbar(aes(ymin = diffscore - sem, ymax = diffscore + sem))</div><div class="line">p</div><div class="line"><span class="comment"># 绘制数据集phdfig37b_long的图形，使x轴=session,y轴=diffscore,颜色属性=lesion</span></div><div class="line"><span class="comment"># geom_line() 添加折线图</span></div><div class="line"><span class="comment"># geom_errorbar 添加误差线</span></div></pre></td></tr></table></figure>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180820/JiFGiGi39i.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h2 id="第三部分ggplot制图">第三部分：ggplot制图</h2>
<p>目标：</p>
<ol style="list-style-type: decimal">
<li>绘制折线图；</li>
<li>添加误差线；</li>
<li>分类；</li>
<li>添加参考线。</li>
</ol>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">library</span>(grid) <span class="comment"># 后面要用到unit函数</span></div><div class="line"></div><div class="line">f1 &lt;- ggplot(data = phdfig37b_long, aes(x = session, y = diffscore, group = lesion) ) + <span class="comment"># 绘图phdfig37b_long数据集的图形，使x轴=session,y轴=diffscore,group在这里的意思是，desion中的数据不属于一组</span></div><div class="line">  geom_errorbar(aes(ymin = diffscore - sem, ymax = diffscore + sem), width=<span class="number">0.3</span>) +</div><div class="line">  <span class="comment"># 添加误差线，指定宽度为0.4</span></div><div class="line">  geom_line() + <span class="comment"># 添加折线</span></div><div class="line">  geom_point(aes(shape=lesion, fill=lesion), size=<span class="number">5</span>) + <span class="comment"># 添加数据点，将lesion映射到形状属性上，将将lesion映射到填充属性上（即数据点内部的颜色，非轮廓）</span></div><div class="line">  scale_x_continuous(<span class="string">"Session"</span>, breaks=<span class="number">1</span>:<span class="number">12</span>) + <span class="comment"># 对x轴上的sesssion指定刻度，从1到12</span></div><div class="line">  scale_y_continuous(<span class="string">"Difference score"</span>, limits = c(-<span class="number">4</span>, <span class="number">8</span>), breaks=seq(-<span class="number">4</span>, <span class="number">8</span>, by = <span class="number">2</span>)) + <span class="comment"># 指定y轴的刻度</span></div><div class="line">  scale_shape_manual(values=c(<span class="number">24</span>,<span class="number">21</span>)) + <span class="comment"># 设置数据点的形状，一个是24,一个是21,24表示正三角，21表示圆形</span></div><div class="line">  scale_fill_manual(values=c(<span class="string">"white"</span>,<span class="string">"black"</span>)) + <span class="comment"># 指定数据点的颜色，一个是白色，一个是黑色</span></div><div class="line">  geom_abline(intercept=<span class="number">0</span>, slope=<span class="number">0</span>, linetype=<span class="string">"dotted"</span>) + <span class="comment"># 添加参考线，截距是0，斜率是0，点的类型是点状</span></div><div class="line">  annotate(<span class="string">"text"</span>, x=<span class="number">11</span>, y=-<span class="number">0.25</span>, label=<span class="string">"chance"</span>) + <span class="comment"># 添加注释，坐标为(11,-0.25)，文字为"chance"</span></div><div class="line">  theme_bw() + <span class="comment"># 将绘图的主题改为白色</span></div><div class="line">  ggtitle(<span class="string">"Two-stimulus discriminated approach task"</span>)+ <span class="comment"># 添加图形的标题</span></div><div class="line">  theme(</div><div class="line">    plot.title = element_text(face=<span class="string">"bold"</span>, size=<span class="number">14</span>), <span class="comment"># 修改标题文本的属性</span></div><div class="line">    axis.title.x = element_text(face=<span class="string">"bold"</span>, size=<span class="number">12</span>), <span class="comment"># 修改x轴标签文本的属性</span></div><div class="line">    axis.title.y = element_text(face=<span class="string">"bold"</span>, size=<span class="number">12</span>, angle=<span class="number">90</span>),<span class="comment"># 修改y轴标签文本的属性</span></div><div class="line">    axis.text.x=element_text(size=<span class="number">15</span>), <span class="comment"># 修改x轴坐标轴刻度的大小</span></div><div class="line">    panel.grid.major = element_blank(), <span class="comment"># 移除绘图区域的主要网格线</span></div><div class="line">    panel.grid.minor = element_blank(), <span class="comment"># 移除绘图区域的次要网格线</span></div><div class="line">    legend.position = c(<span class="number">0.2</span>,<span class="number">0.8</span>), <span class="comment"># 图例的位置坐标</span></div><div class="line">    legend.title = element_blank(), <span class="comment"># 图例标题为空</span></div><div class="line">    legend.text = element_text(size=<span class="number">12</span>), <span class="comment"># 图例中项目文本的大小</span></div><div class="line">    legend.key.size = unit(<span class="number">1.5</span>, <span class="string">"lines"</span>), <span class="comment"># 图例中项目的间隔，需要grid包</span></div><div class="line">    legend.key = element_blank() <span class="comment"># 移除图例中项目的边框</span></div><div class="line">  )</div><div class="line">print(f1)</div></pre></td></tr></table></figure>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180820/GI0gJc50De.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h2 id="第四部分输出图形">第四部分：输出图形</h2>
<p>保存图形命令如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">ggsave(filename=<span class="string">"d:\\我的图形.pdf"</span>,plot=f1)形为f1</div><div class="line"><span class="comment">## Saving 5 x 4 in image</span></div><div class="line"><span class="comment"># 另外一些保存图形的方法，如下所示：</span></div><div class="line">ggsave(<span class="string">"d:\\f1.pdf"</span>)</div><div class="line"><span class="comment">## Saving 5 x 4 in image</span></div><div class="line">ggsave(<span class="string">"d:\\f1.png"</span>,dpi=<span class="number">300</span>) <span class="comment"># 保存f1，分辨率为300dpi</span></div><div class="line"><span class="comment">## Saving 5 x 4 in image</span></div></pre></td></tr></table></figure>
<h2 id="第五部分自由浮动的sed">第五部分：自由浮动的SED</h2>
<h3 id="a.构建数据框">A.构建数据框</h3>
<p>如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">phdfig21a_long &lt;- with(phdfig21a,</div><div class="line">                       rbind( data.frame( lesion = <span class="string">"sham"</span>, lever = <span class="string">"CRf"</span>, dose = dose, sqrtpresses = shamCR, sem = SEMshamCR, halfSED = halfSED[<span class="number">1</span>] ),</div><div class="line">                              data.frame( lesion = <span class="string">"sham"</span>, lever = <span class="string">"NCRf"</span>, dose = dose, sqrtpresses = shamNCR, sem = SEMshamNCR, halfSED = halfSED[<span class="number">1</span>] ),</div><div class="line">                              data.frame( lesion = <span class="string">"ACCX"</span>, lever = <span class="string">"CRf"</span>, dose = dose, sqrtpresses = ACCXCR, sem = SEMACCXCR, halfSED = halfSED[<span class="number">1</span>] ),</div><div class="line">                              data.frame( lesion = <span class="string">"ACCX"</span>, lever = <span class="string">"NCRf"</span>, dose = dose, sqrtpresses = ACCXNCR, sem = SEMACCXNCR, halfSED = halfSED[<span class="number">1</span>] ) )</div><div class="line">)</div><div class="line">head(phdfig21a_long)</div></pre></td></tr></table></figure>
<p>数据如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">&gt; head(phdfig21a_long)</div><div class="line">  lesion lever dose sqrtpresses       sem halfSED</div><div class="line">1   sham   CRf    0    5.112528 0.5539816  0.9396</div><div class="line">2   sham   CRf    3    6.829842 1.0673567  0.9396</div><div class="line">3   sham   CRf   10    9.230089 0.9947341  0.9396</div><div class="line">4   sham   CRf   20    8.563017 0.8215663  0.9396</div><div class="line">5   sham  NCRf    0    3.685772 0.4961057  0.9396</div><div class="line">6   sham  NCRf    3    4.024871 0.6831637  0.9396</div></pre></td></tr></table></figure>
<h3 id="b.-再添加一个新的变量并查看数据如下所示">B. 再添加一个新的变量，并查看数据，如下所示：</h3>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">phdfig21a_long &lt;- within(phdfig21a_long, &#123;</div><div class="line">  <span class="comment"># 加入一列新的变量 </span></div><div class="line">  lesion_lever &lt;- do.call(paste, c(phdfig21a_long[c(<span class="string">"lesion"</span>, <span class="string">"lever"</span>)], sep = <span class="string">" "</span>))</div><div class="line">  <span class="comment"># do.call表示，运行函数paste,将phdfig21a_long中的lession与lever用空格连接起来，并生成一列新的变量 </span></div><div class="line">  lesion_lever &lt;- factor(lesion_lever, levels=unique(lesion_lever))</div><div class="line">  <span class="comment"># unique(lesion_lever)返回phdfig21a_long数据集中的lesion_lever中的重复元素，即提取出互不相同的元素（如果有相同的几个则取一个，只有一个的，也取一个）</span></div><div class="line">  dose &lt;- factor(dose)</div><div class="line">&#125;)</div><div class="line">head(phdfig21a_long)</div></pre></td></tr></table></figure>
<p>修改后的数据框如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">&gt; head(phdfig21a_long)</div><div class="line">  lesion lever dose sqrtpresses       sem halfSED lesion_lever</div><div class="line"><span class="number">1</span>   sham   CRf    <span class="number">0</span>    <span class="number">5.112528</span> <span class="number">0.5539816</span>  <span class="number">0.9396</span>     sham CRf</div><div class="line"><span class="number">2</span>   sham   CRf    <span class="number">3</span>    <span class="number">6.829842</span> <span class="number">1.0673567</span>  <span class="number">0.9396</span>     sham CRf</div><div class="line"><span class="number">3</span>   sham   CRf   <span class="number">10</span>    <span class="number">9.230089</span> <span class="number">0.9947341</span>  <span class="number">0.9396</span>     sham CRf</div><div class="line"><span class="number">4</span>   sham   CRf   <span class="number">20</span>    <span class="number">8.563017</span> <span class="number">0.8215663</span>  <span class="number">0.9396</span>     sham CRf</div><div class="line"><span class="number">5</span>   sham  NCRf    <span class="number">0</span>    <span class="number">3.685772</span> <span class="number">0.4961057</span>  <span class="number">0.9396</span>    sham NCRf</div><div class="line"><span class="number">6</span>   sham  NCRf    <span class="number">3</span>    <span class="number">4.024871</span> <span class="number">0.6831637</span>  <span class="number">0.9396</span>    sham NCRf</div></pre></td></tr></table></figure>
<h3 id="c.绘图">C.绘图</h3>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line">f2 &lt;- ggplot(data = phdfig21a_long, aes(x = dose, y = sqrtpresses, group = lesion_lever ) ) +</div><div class="line">  geom_line() +</div><div class="line">  geom_point(aes(shape=lesion_lever, fill=lesion_lever), size=<span class="number">5</span>) + <span class="comment"># 将变量lesion_lever映射到shape上，将lesion_lever映射到填充色上</span></div><div class="line">  geom_errorbar(aes(x=<span class="number">1</span>, ymin=<span class="number">10</span> - phdfig21a$halfSED[<span class="number">1</span>], ymax=<span class="number">10</span> + phdfig21a$halfSED[<span class="number">1</span>], width = <span class="number">0.2</span>)) + <span class="comment"># 绘制一个误差棒，位置是x=1，宽度为0.2</span></div><div class="line">  scale_shape_manual(values=c(<span class="number">21</span>,<span class="number">24</span>,<span class="number">21</span>,<span class="number">24</span>)) + <span class="comment"># 指定shamCR, shamNCR, ACCXCR, ACCXNCR这四种类型的形状，分别为圆、三角、圆、三角</span></div><div class="line">  scale_fill_manual(values=c(<span class="string">"white"</span>,<span class="string">"white"</span>,<span class="string">"black"</span>,<span class="string">"black"</span>)) + <span class="comment"># 指定shamCR, shamNCR, ACCXCR, ACCXNCR这四种类型的颜色，分别为白、白、黑、黑</span></div><div class="line">  xlab(substitute(paste(<span class="string">"Intra-Acb amphetamine ("</span>,mu,<span class="string">"g)"</span>))) + <span class="comment">#添加x轴标签，substitute用来显示公式，</span></div><div class="line">  scale_y_continuous(expression(sqrt(<span class="string">"lever presses"</span>)), expand=c(<span class="number">0</span>,<span class="number">0</span>), limits = c(<span class="number">0</span>, <span class="number">14</span>), breaks=seq(<span class="number">0</span>, <span class="number">14</span>, by = <span class="number">2</span>)) + <span class="comment"># the "expand" bit prevents ggplot2 from expanding the axis a little beyond what you specify</span></div><div class="line">  annotate(<span class="string">"text"</span>, x=<span class="number">1.4</span>, y=<span class="number">10</span>, label=<span class="string">"SED"</span>) +</div><div class="line">  theme_bw() +</div><div class="line">  ggtitle(<span class="string">"Conditioned reinforcement"</span>)+ <span class="comment"># 添加图形的标题</span></div><div class="line">  theme(plot.title = element_text(face=<span class="string">"bold"</span>, size=<span class="number">14</span>),</div><div class="line">        axis.title.x = element_text(face=<span class="string">"bold"</span>, size=<span class="number">12</span>),</div><div class="line">        axis.title.y = element_text(face=<span class="string">"bold"</span>, size=<span class="number">12</span>, angle=<span class="number">90</span>),</div><div class="line">        panel.grid.major = element_blank(),</div><div class="line">        panel.grid.minor = element_blank(),</div><div class="line">        panel.border=element_blank(), <span class="comment"># 取消绘图区域四周的边框</span></div><div class="line">        axis.line=element_line(colour=<span class="string">"black"</span>), <span class="comment"># 添加坐标轴（即x轴与y轴）的直线</span></div><div class="line">        legend.position = c(<span class="number">0.8</span>,<span class="number">0.2</span>),</div><div class="line">        legend.title = element_blank(),</div><div class="line">        legend.text = element_text(size=<span class="number">10</span>),</div><div class="line">        legend.key.size = unit(<span class="number">1</span>, <span class="string">"lines"</span>),</div><div class="line">        legend.key = element_blank()</div><div class="line">  )</div><div class="line">print(f2)</div></pre></td></tr></table></figure>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180820/55FLjcD9LL.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h2 id="第六部分-绘制双变量的条形图及误差棒">第六部分 绘制双变量的条形图及误差棒</h2>
<h3 id="a.整理数据">A.整理数据</h3>
<p>查看数据，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&gt; phdfig22d</div><div class="line">  group CSpluslatency CSminuslatency CSplusSEM CSminusSEM</div><div class="line"><span class="number">1</span>  sham      <span class="number">3.884335</span>       <span class="number">4.212531</span> <span class="number">0.2248404</span>  <span class="number">0.2593122</span></div><div class="line"><span class="number">2</span>  ACCX      <span class="number">4.672486</span>       <span class="number">3.619434</span> <span class="number">0.3476289</span>  <span class="number">0.4902273</span></div></pre></td></tr></table></figure>
<p>整理数据，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">phdfig22d_long = with(phdfig22d,</div><div class="line">                      rbind( data.frame( lesion=group, stimulus=<span class="string">"CS+"</span>, latency=CSpluslatency, sem=CSplusSEM ),</div><div class="line">                             data.frame( lesion=group, stimulus=<span class="string">"CS-"</span>, latency=CSminuslatency, sem=CSminusSEM ) )</div><div class="line">)</div><div class="line">phdfig22d_long$lesion = factor(phdfig22d_long$lesion, levels=unique(phdfig22d_long$lesion))</div></pre></td></tr></table></figure>
<p>上述代码是生成phdfig22d_long数据框，这个数据框有四列变量，分别为lesion,stimulus,lantency，sem，查看数据，如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&gt; phdfig22d_long</div><div class="line">  lesion stimulus  latency       sem</div><div class="line">1   sham      CS+ 3.884335 0.2248404</div><div class="line">2   ACCX      CS+ 4.672486 0.3476289</div><div class="line">3   sham      CS- 4.212531 0.2593122</div><div class="line">4   ACCX      CS- 3.619434 0.4902273</div></pre></td></tr></table></figure>
<h3 id="b.绘图">B.绘图</h3>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">f3 &lt;- ggplot(data = phdfig22d_long, aes(x=lesion, y=latency, fill=stimulus) ) +</div><div class="line">  geom_errorbar(aes(ymin=latency, ymax=latency+sem, width = <span class="number">0.2</span>),position=position_dodge(width=<span class="number">0.90</span>)) + <span class="comment"># 误差棒只添加上部分，因此误差棒的最低部是latency，最上部是lantency + sem，宽度是0.2，最低部与最上部进行堆叠(position_dodge)</span></div><div class="line">  geom_bar(stat=<span class="string">"identity"</span>, position=<span class="string">"dodge"</span>) +</div><div class="line">  geom_bar(stat=<span class="string">"identity"</span>, position=<span class="string">"dodge"</span>, colour=<span class="string">"black"</span>) +</div><div class="line">  scale_fill_manual(values=c(<span class="string">"grey80"</span>, <span class="string">"white"</span>)) + <span class="comment"># 对两个变量进行颜色填充，分别为灰度80与白色</span></div><div class="line">  xlab(<span class="string">""</span>) + <span class="comment"># x轴不添加标签</span></div><div class="line">  scale_y_continuous(<span class="string">"Latency to approach (s)"</span>, expand=c(<span class="number">0</span>,<span class="number">0</span>), limits = c(<span class="number">0</span>, <span class="number">5.5</span>)) + <span class="comment"># expand=c(0,0) 表示将y轴从0开始</span></div><div class="line">  theme_bw() +</div><div class="line">  ggtitle(<span class="string">"Autoshaping approach latencies"</span>)+</div><div class="line">  theme(</div><div class="line">    panel.grid.major = element_blank(),</div><div class="line">    panel.grid.minor = element_blank(),</div><div class="line">    panel.border = element_blank(),</div><div class="line">    axis.line=element_line(colour=<span class="string">"black"</span>),</div><div class="line">    axis.text.y=element_text(angle=<span class="number">90</span>, hjust=<span class="number">0.5</span>),</div><div class="line">    legend.position = c(<span class="number">0.25</span>,<span class="number">0.85</span>),</div><div class="line">    legend.key = element_rect()</div><div class="line">  )</div><div class="line">print(f3)</div></pre></td></tr></table></figure>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180820/2ak0mja935.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h2 id="第七部分带有注释线的误差棒">第七部分：带有注释线的误差棒</h2>
<h3 id="a.查看数据">A.查看数据</h3>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"></div></pre></td></tr></table></figure>
<h3 id="b.整理数据">B.整理数据</h3>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">phdfig23_long = with(phdfig23,</div><div class="line">rbind( data.frame( lesion=group, stimulus=<span class="string">"CS+"</span>, approaches=CSplus, sem=SEMCSplus ),</div><div class="line">data.frame( lesion=group, stimulus=<span class="string">"CS-"</span>, approaches=CSminus, sem=SEMCSminus ) )</div><div class="line">)</div></pre></td></tr></table></figure>
<p>查看数据，如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&gt; phdfig23_long</div><div class="line">  lesion stimulus approaches       sem</div><div class="line">1   sham      CS+  14.000000 0.9309493</div><div class="line">2   ACCX      CS+   9.857143 1.0785478</div><div class="line">3   sham      CS-   4.500000 0.8595865</div><div class="line">4   ACCX      CS-   6.428571 1.0658585</div></pre></td></tr></table></figure>
<h3 id="c.绘图-1">C.绘图</h3>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line">f4 &lt;- ggplot(data = phdfig23_long, aes(x=lesion, y=approaches, fill=stimulus, width=<span class="number">0.5</span>) ) +</div><div class="line">geom_errorbar(aes(ymin=approaches, ymax=approaches+sem, width = <span class="number">0.2</span>), position=position_dodge(width=<span class="number">0.8</span>)) +</div><div class="line">geom_bar(stat=<span class="string">"identity"</span>, position=position_dodge(width=<span class="number">0.8</span>)) +</div><div class="line">geom_bar(stat=<span class="string">"identity"</span>, position=position_dodge(width=<span class="number">0.8</span>), colour=<span class="string">"black"</span>) +</div><div class="line">scale_fill_manual(values=c(<span class="string">"grey80"</span>, <span class="string">"white"</span>)) +</div><div class="line">scale_x_discrete(<span class="string">"Group"</span>, limits=c(<span class="string">"sham"</span>, <span class="string">"ACCX"</span>)) + <span class="comment"># 设置x轴上的分类变量，顺序为sham,ACCX</span></div><div class="line">scale_y_continuous(<span class="string">"Number of approaches"</span>, expand=c(<span class="number">0</span>,<span class="number">0</span>), limits = c(<span class="number">0</span>, <span class="number">17</span>), breaks=seq(<span class="number">0</span>, <span class="number">16</span>, by=<span class="number">2</span>)) +</div><div class="line">geom_segment(aes(x=<span class="number">0.8</span>, y=<span class="number">15.3</span>, xend=<span class="number">0.8</span>, yend=<span class="number">16</span>)) +</div><div class="line">geom_segment(aes(x=<span class="number">0.8</span>, y=<span class="number">16</span>, xend=<span class="number">1.2</span>, yend=<span class="number">16</span>)) +</div><div class="line">geom_segment(aes(x=<span class="number">1.2</span>, y=<span class="number">6</span>, xend=<span class="number">1.2</span>, yend=<span class="number">16</span>)) + <span class="comment"># 添加注释线，注意坐标</span></div><div class="line">annotate(<span class="string">"text"</span>, x=<span class="number">1</span>, y=<span class="number">15.5</span>, label=<span class="string">"***"</span>) +</div><div class="line">theme_bw() +</div><div class="line">ggtitle(<span class="string">"Autoshaping probe test"</span>)+</div><div class="line">theme( plot.title = element_text(face=<span class="string">"bold"</span>, size=<span class="number">14</span>),</div><div class="line">axis.title.x = element_text(face=<span class="string">"bold"</span>, size=<span class="number">12</span>),</div><div class="line">axis.title.y = element_text(face=<span class="string">"bold"</span>, size=<span class="number">12</span>, angle=<span class="number">90</span>),</div><div class="line">panel.grid.major = element_blank(),</div><div class="line">panel.grid.minor = element_blank(),</div><div class="line">panel.border = element_blank(),</div><div class="line">axis.line=element_line(colour=<span class="string">"black"</span>),</div><div class="line">axis.text.y=element_text(angle=<span class="number">90</span>, hjust=<span class="number">0.5</span>),</div><div class="line">legend.title = element_blank(),</div><div class="line">legend.position = c(<span class="number">0.85</span>,<span class="number">0.85</span>),</div><div class="line">legend.key.size = unit(<span class="number">1.5</span>, <span class="string">"lines"</span>),</div><div class="line">legend.key = element_rect()</div><div class="line">)</div><div class="line">print(f4)</div></pre></td></tr></table></figure>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180820/2i7D593k3E.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>代码解释：</p>
<p>上述代码中有一部分是添加注释线的，就是与三个星号在一起的一段线。代码为：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">geom_segment(aes(x=<span class="number">0.8</span>, y=<span class="number">15.3</span>, xend=<span class="number">0.8</span>, yend=<span class="number">16</span>)) +</div><div class="line">geom_segment(aes(x=<span class="number">0.8</span>, y=<span class="number">16</span>, xend=<span class="number">1.2</span>, yend=<span class="number">16</span>)) +</div><div class="line">geom_segment(aes(x=<span class="number">1.2</span>, y=<span class="number">6</span>, xend=<span class="number">1.2</span>, yend=<span class="number">16</span>)) + <span class="comment"># 添加注释线，注意坐标</span></div><div class="line">annotate(<span class="string">"text"</span>, x=<span class="number">1</span>, y=<span class="number">15.5</span>, label=<span class="string">"***"</span>) +</div></pre></td></tr></table></figure>
<p>在添加注释线的时候，如果要精确地绘制，需要知道x轴上条形图中心的坐标，可以用str(print(f4))查看，str(print(f4))，前5行的数字为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">List of 3</div><div class="line">$ data :List of 7</div><div class="line">..$ :&apos;data.frame&apos;: 4 obs. of 9 variables:</div><div class="line">.. ..$ fill : chr [1:4] &quot;grey80&quot; &quot;white&quot; &quot;grey80&quot; &quot;white&quot;</div><div class="line">.. ..$ x : num [1:4] 0.8 1.2 1.8 2.2</div></pre></td></tr></table></figure>
<p>其中第5行是：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">.. ..$ x : num [1:4] 0.8 1.2 1.8 2.2</div></pre></td></tr></table></figure>
<p>可以发现，条形图第一个条带的中心处，对应的x轴坐标为0.8，因此在绘制注释线的时候，x的起点为是0.8。</p>
<h2 id="第八部分含有双向x轴的绘图">第八部分：含有双向x轴的绘图</h2>
<h3 id="a.查看原始数据">A.查看原始数据</h3>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">&gt; phdfig28c</div><div class="line">  block      sham      ACCX    SEMsham    SEMACCX</div><div class="line">1    -3 0.8905724 0.8648725 0.04328269 0.05561053</div><div class="line">2    -2 0.9212121 0.8789751 0.03030303 0.03002131</div><div class="line">3    -1 0.9237374 0.9204775 0.02654952 0.02897810</div><div class="line">4     0        NA        NA         NA         NA</div><div class="line">5     1 0.7755162 0.6273393 0.04621826 0.05090232</div><div class="line">6     2 0.8674289 0.6453398 0.05521676 0.05800651</div><div class="line">7     3 0.8327228 0.6989440 0.07589090 0.06084011</div><div class="line">8     4 0.9145688 0.8424770 0.03463735 0.03901640</div><div class="line">9     5 0.8874644 0.8592287 0.03880296 0.04260364</div></pre></td></tr></table></figure>
<h3 id="b.整理数据-1">B.整理数据</h3>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">phdfig28c_long &lt;- with(phdfig28c,</div><div class="line">rbind( data.frame( block=block, lesion=<span class="string">"sham"</span>, diffscore=sham, sem=SEMsham ),</div><div class="line">data.frame( block=block, lesion=<span class="string">"ACCX"</span>, diffscore=ACCX, sem=SEMACCX ) ) )</div><div class="line">phdfig28c_long <span class="comment"># 查看整理后的数据</span></div></pre></td></tr></table></figure>
<p>整理后的数据如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">&gt; phdfig28c_long # 查看整理后的数据</div><div class="line">   block lesion diffscore        sem</div><div class="line">1     -3   sham 0.8905724 0.04328269</div><div class="line">2     -2   sham 0.9212121 0.03030303</div><div class="line">3     -1   sham 0.9237374 0.02654952</div><div class="line">4      0   sham        NA         NA</div><div class="line">5      1   sham 0.7755162 0.04621826</div><div class="line">6      2   sham 0.8674289 0.05521676</div><div class="line">7      3   sham 0.8327228 0.07589090</div><div class="line">8      4   sham 0.9145688 0.03463735</div><div class="line">9      5   sham 0.8874644 0.03880296</div><div class="line">10    -3   ACCX 0.8648725 0.05561053</div><div class="line">11    -2   ACCX 0.8789751 0.03002131</div><div class="line">12    -1   ACCX 0.9204775 0.02897810</div><div class="line">13     0   ACCX        NA         NA</div><div class="line">14     1   ACCX 0.6273393 0.05090232</div><div class="line">15     2   ACCX 0.6453398 0.05800651</div><div class="line">16     3   ACCX 0.6989440 0.06084011</div><div class="line">17     4   ACCX 0.8424770 0.03901640</div><div class="line">18     5   ACCX 0.8592287 0.04260364</div></pre></td></tr></table></figure>
<h3 id="c.绘图-2">C.绘图</h3>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line">f5 &lt;- ggplot(data = phdfig28c_long, aes(x = block, y = diffscore, group = lesion) ) +</div><div class="line">geom_errorbar(aes(ymin = diffscore - sem, ymax = diffscore + sem), width=<span class="number">0.3</span>) +</div><div class="line">geom_line() +</div><div class="line">geom_point(aes(shape=lesion, fill=lesion), size=<span class="number">5</span>) +</div><div class="line">scale_x_continuous(<span class="string">"Trial block"</span>, expand=c(<span class="number">0</span>,<span class="number">0</span>), limits=c(-<span class="number">3.5</span>,<span class="number">5.5</span>), breaks=-<span class="number">3</span>:<span class="number">5</span>, labels=c(<span class="string">"-3"</span>,<span class="string">"-2"</span>,<span class="string">"-1"</span>,<span class="string">"surgery"</span>,<span class="string">"1"</span>,<span class="string">"2"</span>,<span class="string">"3"</span>,<span class="string">"4"</span>,<span class="string">"5"</span>)) +</div><div class="line">scale_y_continuous(<span class="string">"Difference score"</span>, expand=c(<span class="number">0</span>,<span class="number">0</span>), limits = c(<span class="number">0.4</span>, <span class="number">1</span>), breaks=seq(<span class="number">0.4</span>, <span class="number">1</span>, by = <span class="number">0.1</span>)) +</div><div class="line">scale_shape_manual(values=c(<span class="number">24</span>,<span class="number">21</span>)) +</div><div class="line">scale_fill_manual(values=c(<span class="string">"white"</span>,<span class="string">"black"</span>)) +</div><div class="line">geom_abline(intercept=<span class="number">0.5</span>, slope=<span class="number">0</span>, linetype=<span class="string">"dotted"</span>) + <span class="comment"># 截距为0.5，斜率为0的虚线</span></div><div class="line">annotate(<span class="string">"text"</span>, x=-<span class="number">2</span>, y=<span class="number">0.48</span>, label=<span class="string">"chance"</span>) +</div><div class="line">theme_bw() +</div><div class="line">theme(plot.margin=unit(c(<span class="number">1</span>,<span class="number">1</span>,<span class="number">1.5</span>,<span class="number">1.5</span>), <span class="string">"lines"</span>), <span class="comment"># 分别指的是整个绘图区域（包括x轴与y轴的标签）距离顶边，右边，底边，左边的距离（默认是1，1，0.5，0.5）</span></div><div class="line">axis.ticks.margin=unit(<span class="number">0.25</span>,<span class="string">"lines"</span>), <span class="comment"># 坐标轴刻度的值距离刻度线的距离</span></div><div class="line">axis.title.x = element_text(face=<span class="string">"bold"</span>, size=<span class="number">12</span>, vjust=-<span class="number">1</span>), <span class="comment"># use vjust to move text away from the axis</span></div><div class="line">axis.title.y = element_text(face=<span class="string">"bold"</span>, size=<span class="number">12</span>, angle=<span class="number">90</span>, vjust=<span class="number">0</span>), <span class="comment"># likewise</span></div><div class="line">panel.grid.major = element_blank(),</div><div class="line">panel.grid.minor = element_blank(),</div><div class="line">legend.position = c(<span class="number">0.2</span>,<span class="number">0.4</span>),</div><div class="line">legend.title = element_blank(),</div><div class="line">legend.text = element_text(size=<span class="number">12</span>),</div><div class="line">legend.key.size = unit(<span class="number">1.5</span>, <span class="string">"lines"</span>),</div><div class="line">legend.key = element_blank() <span class="comment"># switch off the rectangle around symbols in the legend</span></div><div class="line">)</div><div class="line">print(f5)</div></pre></td></tr></table></figure>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180820/H5I1Ckim3m.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h2 id="第九部分分面折线星号">第九部分：分面、折线、星号</h2>
<h3 id="a.查看原始数据-1">A.查看原始数据</h3>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&gt; mdfig30a</div><div class="line">  delay     sham    SEMsham     AcbC    SEMAcbC</div><div class="line"><span class="number">1</span>     <span class="number">0</span> <span class="number">2.640708</span> <span class="number">0.09574035</span> <span class="number">3.015727</span> <span class="number">0.07431359</span></div><div class="line"><span class="number">2</span>    <span class="number">10</span> <span class="number">2.276907</span> <span class="number">0.07223806</span> <span class="number">1.977225</span> <span class="number">0.12287066</span></div><div class="line"><span class="number">3</span>    <span class="number">20</span> <span class="number">1.956931</span> <span class="number">0.07676898</span> <span class="number">1.400463</span> <span class="number">0.11313513</span></div></pre></td></tr></table></figure>
<h3 id="b.整理数据-2">B.整理数据</h3>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">mdfig30_long &lt;- rbind( data.frame( type=<span class="string">"programmed"</span>, delay=mdfig30a$delay, lesion=<span class="string">"sham"</span>, sqrtpresses = mdfig30a$sham, ysem = mdfig30a$SEMsham, xsem = <span class="number">0</span> ),</div><div class="line">data.frame( type=<span class="string">"programmed"</span>, delay=mdfig30a$delay, lesion=<span class="string">"AcbC"</span>, sqrtpresses = mdfig30a$AcbC, ysem = mdfig30a$SEMAcbC, xsem = <span class="number">0</span> ),</div><div class="line">data.frame( type=<span class="string">"experienced"</span>, delay=mdfig30b$shamdelay, lesion=<span class="string">"sham"</span>, sqrtpresses = mdfig30b$shamresponses, ysem = mdfig30b$SEMshamresponses, xsem = mdfig30b$SEMshamdelay ),</div><div class="line">data.frame( type=<span class="string">"experienced"</span>, delay=mdfig30b$AcbCdelay, lesion=<span class="string">"AcbC"</span>, sqrtpresses = mdfig30b$AcbCresponses, ysem = mdfig30b$SEMAcbCresponses, xsem = mdfig30b$SEMAcbCdelay ) )</div><div class="line"></div><div class="line">mdfig30_annotations &lt;- data.frame(</div><div class="line">x = c(<span class="number">0</span>,<span class="number">10</span>,<span class="number">20</span>,<span class="number">10</span>),</div><div class="line">y = c(<span class="number">3.2</span>,<span class="number">1.7</span>,<span class="number">1.2</span>,<span class="number">1.4</span>),</div><div class="line">type = c(<span class="string">"programmed"</span>, <span class="string">"programmed"</span>, <span class="string">"programmed"</span>, <span class="string">"experienced"</span>),</div><div class="line">label = c(<span class="string">"*"</span>, <span class="string">"*"</span>, <span class="string">"***"</span>, <span class="string">"###"</span>),</div><div class="line">lesion = c(<span class="string">"sham"</span>, <span class="string">"sham"</span>, <span class="string">"sham"</span>, <span class="string">"sham"</span>) )</div></pre></td></tr></table></figure>
<p>查看整整后的数据，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">&gt; mdfig30_long</div><div class="line">          type     delay lesion sqrtpresses       ysem      xsem</div><div class="line"><span class="number">1</span>   programmed  <span class="number">0.000000</span>   sham    <span class="number">2.640708</span> <span class="number">0.09574035</span> <span class="number">0.0000000</span></div><div class="line"><span class="number">2</span>   programmed <span class="number">10.000000</span>   sham    <span class="number">2.276907</span> <span class="number">0.07223806</span> <span class="number">0.0000000</span></div><div class="line"><span class="number">3</span>   programmed <span class="number">20.000000</span>   sham    <span class="number">1.956931</span> <span class="number">0.07676898</span> <span class="number">0.0000000</span></div><div class="line"><span class="number">4</span>   programmed  <span class="number">0.000000</span>   AcbC    <span class="number">3.015727</span> <span class="number">0.07431359</span> <span class="number">0.0000000</span></div><div class="line"><span class="number">5</span>   programmed <span class="number">10.000000</span>   AcbC    <span class="number">1.977225</span> <span class="number">0.12287066</span> <span class="number">0.0000000</span></div><div class="line"><span class="number">6</span>   programmed <span class="number">20.000000</span>   AcbC    <span class="number">1.400463</span> <span class="number">0.11313513</span> <span class="number">0.0000000</span></div><div class="line"><span class="number">7</span>  experienced  <span class="number">2.127342</span>   sham    <span class="number">2.640708</span> <span class="number">0.09574035</span> <span class="number">0.3954407</span></div><div class="line"><span class="number">8</span>  experienced  <span class="number">9.483373</span>   sham    <span class="number">2.276907</span> <span class="number">0.07223806</span> <span class="number">0.4826215</span></div><div class="line"><span class="number">9</span>  experienced <span class="number">15.812267</span>   sham    <span class="number">1.956931</span> <span class="number">0.07676898</span> <span class="number">1.0514280</span></div><div class="line"><span class="number">10</span> experienced  <span class="number">2.307076</span>   AcbC    <span class="number">3.015727</span> <span class="number">0.07431359</span> <span class="number">0.3887686</span></div><div class="line"><span class="number">11</span> experienced <span class="number">11.680260</span>   AcbC    <span class="number">1.977225</span> <span class="number">0.12287066</span> <span class="number">0.5989249</span></div><div class="line"><span class="number">12</span> experienced <span class="number">20.936766</span>   AcbC    <span class="number">1.400463</span> <span class="number">0.11313513</span> <span class="number">1.8152600</span></div><div class="line"></div><div class="line">&gt; mdfig30_annotations</div><div class="line">   x   y        type label lesion</div><div class="line"><span class="number">1</span>  <span class="number">0</span> <span class="number">3.2</span>  programmed     *   sham</div><div class="line"><span class="number">2</span> <span class="number">10</span> <span class="number">1.7</span>  programmed     *   sham</div><div class="line"><span class="number">3</span> <span class="number">20</span> <span class="number">1.2</span>  programmed   ***   sham</div><div class="line"><span class="number">4</span> <span class="number">10</span> <span class="number">1.4</span> experienced   <span class="comment">###   sham</span></div></pre></td></tr></table></figure>
<h3 id="c.绘图-3">C.绘图</h3>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">f6 &lt;- ggplot(data = mdfig30_long, aes(x = delay, y = sqrtpresses, fill = lesion) ) +</div><div class="line">facet_grid(. ~ type) +</div><div class="line">geom_line() +</div><div class="line">geom_errorbar(aes(ymin=sqrtpresses - ysem, ymax=sqrtpresses + ysem), width=<span class="number">0.8</span>) +</div><div class="line">geom_errorbarh(aes(xmin=delay - xsem, xmax=delay + xsem), height=<span class="number">0.05</span>) +</div><div class="line">geom_point(shape=<span class="number">21</span>, colour=<span class="string">"black"</span>, size=<span class="number">5</span>) +</div><div class="line">scale_fill_manual(values=c(<span class="string">"white"</span>,<span class="string">"black"</span>)) +</div><div class="line">scale_x_continuous(<span class="string">"Delay from response to reinforcer (s)"</span>) +</div><div class="line">scale_y_continuous(expression(sqrt(<span class="string">"active lever presses per minute in session 10"</span>)), expand=c(<span class="number">0</span>,<span class="number">0</span>), limits = c(<span class="number">0</span>, <span class="number">3.5</span>), breaks=<span class="number">0</span>:<span class="number">3</span>) +</div><div class="line">geom_text(data = mdfig30_annotations, aes(x = x, y = y, label = label) ) +</div><div class="line">theme_bw() +</div><div class="line">theme(plot.margin=unit(c(<span class="number">1</span>,<span class="number">1</span>,<span class="number">1.5</span>,<span class="number">2</span>), <span class="string">"lines"</span>),</div><div class="line">axis.title.x = element_text(size=<span class="number">12</span>, vjust=-<span class="number">1</span>),</div><div class="line">axis.title.y = element_text(size=<span class="number">12</span>, angle=<span class="number">90</span>, vjust=<span class="number">0</span>), <span class="comment"># likewise</span></div><div class="line">legend.title = element_blank(),</div><div class="line">legend.key.size = unit(<span class="number">1.5</span>, <span class="string">"lines"</span>),</div><div class="line">legend.key = element_blank()</div><div class="line">)</div><div class="line">print(f6)</div></pre></td></tr></table></figure>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180820/b8dBaFd5lh.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h2 id="参考资料">参考资料</h2>
<p>http://egret.psychol.cam.ac.uk/statistics/R/graphs2.html</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2017/04/02/R/R笔记（2）-数据类型/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/04/02/R/R笔记（2）-数据类型/" itemprop="url">R笔记（2）——数据类型</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-04-02T12:00:00+08:00">
                2017-04-02
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/R/" itemprop="url" rel="index">
                    <span itemprop="name">R</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  11,932
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  60
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="常见数据类型">常见数据类型</h1>
<p>R拥有许多用于存储数据的对象类型，包括标量、向量、矩阵、数组、数据框和列表。它们在存储数据的类型、创建方式、结构复杂度，以及用于定位和访问其中个别元素的标记等方面均有所不同。下图给出了这些数据结构的一个示意图：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180821/K1f9i05mDc.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h1 id="向量">向量</h1>
<h2 id="常见向量类型">常见向量类型</h2>
<p>向量可以是数值，字符，逻辑等，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">&gt; a&lt;-c(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,-<span class="number">3</span>,-<span class="number">4</span>);a <span class="comment">#数值型向量</span></div><div class="line">[<span class="number">1</span>]  <span class="number">1</span>  <span class="number">2</span>  <span class="number">3</span>  <span class="number">4</span>  <span class="number">5</span> -<span class="number">3</span> -<span class="number">4</span></div><div class="line">&gt; b&lt;-c(<span class="string">"one"</span>,<span class="string">"two"</span>,<span class="string">"three"</span>);b <span class="comment">#字符型向量</span></div><div class="line">[<span class="number">1</span>] <span class="string">"one"</span>   <span class="string">"two"</span>   <span class="string">"three"</span></div><div class="line">&gt; c&lt;-c(<span class="literal">TRUE</span>,<span class="literal">TRUE</span>,<span class="literal">TRUE</span>,<span class="literal">FALSE</span>);c <span class="comment">#逻辑型向量</span></div><div class="line">[<span class="number">1</span>]  <span class="literal">TRUE</span>  <span class="literal">TRUE</span>  <span class="literal">TRUE</span> <span class="literal">FALSE</span></div><div class="line">&gt; x&lt;-c(<span class="number">5</span>,<span class="number">4</span>,<span class="number">2</span>);x</div><div class="line">[<span class="number">1</span>] <span class="number">5</span> <span class="number">4</span> <span class="number">2</span></div><div class="line">&gt; x[<span class="number">9</span>]&lt;-<span class="number">9</span>;x <span class="comment"># 当向量x不够长时，指定第9个元素为9,#自动将中间的元素补为NA</span></div><div class="line">[<span class="number">1</span>]  <span class="number">5</span>  <span class="number">4</span>  <span class="number">2</span> <span class="literal">NA</span> <span class="literal">NA</span> <span class="literal">NA</span> <span class="literal">NA</span> <span class="literal">NA</span>  <span class="number">9</span></div></pre></td></tr></table></figure>
<h2 id="向量的下标">向量的下标</h2>
<p>向量的元素下标取值是以1开始，例如：要前例中取x向量中值为1,则为x[2]，如果一个向量中有一个字符，则该向量的类型会变成字符，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&gt; demo_1&lt;-c(<span class="number">1</span>,<span class="number">2</span>,<span class="string">'a'</span>)</div><div class="line">&gt; demo_1</div><div class="line">[<span class="number">1</span>] <span class="string">"1"</span> <span class="string">"2"</span> <span class="string">"a"</span></div><div class="line">&gt; mode(demo_1)</div><div class="line">[<span class="number">1</span>] <span class="string">"character"</span></div></pre></td></tr></table></figure>
<h2 id="向量的名称">向量的名称</h2>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&gt; years &lt;- c(<span class="number">1960</span>,<span class="number">1964</span>,<span class="number">1976</span>,<span class="number">1994</span>)</div><div class="line">&gt; years</div><div class="line">[<span class="number">1</span>] <span class="number">1960</span> <span class="number">1964</span> <span class="number">1976</span> <span class="number">1994</span></div><div class="line">&gt; names(years)&lt;-c(<span class="string">"Kennedy"</span>, <span class="string">"Johnson"</span>, <span class="string">"Carter"</span>,<span class="string">"Clinton"</span>);years</div><div class="line">Kennedy Johnson  Carter Clinton </div><div class="line">   <span class="number">1960</span>    <span class="number">1964</span>    <span class="number">1976</span>    <span class="number">1994</span></div></pre></td></tr></table></figure>
<h2 id="向量元素的添加及合并">向量元素的添加及合并</h2>
<p>常用函数为<code>c()</code>，<code>append()</code>，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">v1&lt;-c(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>);v1</div><div class="line"><span class="comment">## [1] 1 2 3</span></div><div class="line">v2&lt;-c(v1,<span class="number">55</span>);v2 </div><div class="line"><span class="comment">#格式为新向量&lt;-(原向量，新元素)</span></div><div class="line"><span class="comment">## [1]  12  3 55</span></div><div class="line">c(v2,v1) <span class="comment"># 向量的合并</span></div><div class="line"><span class="comment">## [1]  12  3 55  12  3</span></div><div class="line">append(v1,<span class="number">10</span>,after=<span class="number">3</span>) <span class="comment">#在第3个向量后面加入10</span></div><div class="line"><span class="comment">## [1]  12  3 10</span></div></pre></td></tr></table></figure>
<p>如果逻辑变量与数值在一起，则为转换成数值。TRUE转变成1 and FALSE 转变成 0，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&gt; demo_2&lt;-c(<span class="number">1</span>,<span class="number">2</span>,<span class="literal">TRUE</span>);demo_2</div><div class="line">[<span class="number">1</span>] <span class="number">1</span> <span class="number">2</span> <span class="number">1</span></div><div class="line">&gt; mode(demo_2)</div><div class="line">[<span class="number">1</span>] <span class="string">"numeric"</span></div></pre></td></tr></table></figure>
<p>在R语言中没有单一的整数、单一字符的概念，例如：<code>X&lt;-2</code>；<code>X&lt;-'a'</code>；R都是当作向量来处理，只是这个向量只包括单一值。</p>
<h2 id="向量批量序列的生成">向量批量序列的生成</h2>
<h3 id="seq">seq()</h3>
<p>用法：<code>seq(length=, from=, to=)</code></p>
<p>length:指定生成个数；from:是指开始生成的点；to:截止点。如果不指定，则默认条件下：seq(N1,N2,BY=)，其中，n1：开始位置；n2：截止位置；by=指定间隔，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">seq(length=<span class="number">10</span>,from=<span class="number">10</span>,to=<span class="number">100</span>) <span class="comment"># 生成从10到100的向量，一共10个</span></div><div class="line"><span class="comment">##  [1]10  20  3040  50  6070  80  90 100</span></div><div class="line"></div><div class="line"><span class="comment"># 此命令等价于：</span></div><div class="line">seq(<span class="number">10</span>,<span class="number">100</span>,<span class="number">10</span>)</div><div class="line"><span class="comment">##  [1]10  20  3040  50  6070  80  90 100</span></div><div class="line">seq(<span class="number">1</span>,<span class="number">10</span>,by=<span class="number">2</span>)</div><div class="line"><span class="comment">## [1] 1 3 5 7 9</span></div><div class="line">seq(<span class="number">1</span>,<span class="number">10</span>,length=<span class="number">6</span>)</div><div class="line"><span class="comment">## [1]  1.02.8  4.6  6.48.2 10.0</span></div><div class="line">sequence(<span class="number">2</span>:<span class="number">3</span>) <span class="comment">#产生以 2 和 3 结尾的序列数据</span></div><div class="line"><span class="comment">## [1] 1 2 1 2 3</span></div></pre></td></tr></table></figure>
<h3 id="rep">rep()</h3>
<p>用法：1. rep(P，N) 重复生成P值N次；2.rep(a1:a2,a1:a2) #重复a1到a2，按a1产生a1次，按a2产生a2次，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">rep(<span class="number">1</span>,<span class="number">10</span>)</div><div class="line"><span class="comment">##  [1] 1 1 1 1 1 1 1 1 1 1</span></div><div class="line">rep(<span class="number">1</span>:<span class="number">5</span>,each=<span class="number">2</span>, times=<span class="number">2</span>) <span class="comment">#重复1到5，每个元素重复二次，整个数列重复两次</span></div><div class="line"><span class="comment">##  [1] 1 1 2 2 3 3 4 4 5 5 1 1 2 2 3 3 4 4 5 5</span></div><div class="line">rep(<span class="number">1</span>:<span class="number">3</span>,<span class="number">1</span>:<span class="number">3</span>) <span class="comment"># 1重复1次，2重复2次，3重复3次</span></div><div class="line"><span class="comment">## [1] 1 2 2 3 3 3</span></div></pre></td></tr></table></figure>
<h2 id="向量索引">向量索引</h2>
<p>取子向量：通过下标实现</p>
<p>取某个元素：x[2];(如果X包括名称，注意:x[2]与x[[2]]的区别；</p>
<p>取某中几个：x[c(1,2,0)]</p>
<p>取某个/几个元素，利用-：x[-n]</p>
<h2 id="向量排序">向量排序</h2>
<p>sort(); 输出排序后的结果；order()；输出排序后的各个向量位置，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">a&lt;-c(<span class="number">3</span>,<span class="number">9</span>,<span class="number">0</span>,<span class="number">12</span>,<span class="number">19</span>)</div><div class="line">sort(a)</div><div class="line"><span class="comment">## [1]  03  9 12 19</span></div><div class="line">order(a)</div><div class="line"><span class="comment">## [1] 3 1 2 4 5</span></div><div class="line">a&lt;-c(<span class="number">3</span>,<span class="number">9</span>,<span class="number">0</span>,<span class="number">12</span>,<span class="number">19</span>)</div></pre></td></tr></table></figure>
<h2 id="向量运算">向量运算</h2>
<h3 id="相加">相加</h3>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">&gt; Demo_5 &lt;- <span class="number">1</span>:<span class="number">3</span>;Demo_5</div><div class="line">[<span class="number">1</span>] <span class="number">1</span> <span class="number">2</span> <span class="number">3</span></div><div class="line">&gt; Demo_6 &lt;- <span class="number">2</span>:<span class="number">5</span>;Demo_6</div><div class="line">[<span class="number">1</span>] <span class="number">2</span> <span class="number">3</span> <span class="number">4</span> <span class="number">5</span></div><div class="line">&gt; Demo_7 &lt;- Demo_6+ Demo_5;Demo_7</div><div class="line">Warning message:</div><div class="line">In Demo_6 + Demo_5 :</div><div class="line">  longer object length is not a multiple of shorter object length</div><div class="line">[<span class="number">1</span>] <span class="number">3</span> <span class="number">5</span> <span class="number">7</span> <span class="number">6</span></div></pre></td></tr></table></figure>
<h2 id="向量提取满足某一条件的向量">向量：提取满足某一条件的向量</h2>
<p>常见用法如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">x[n] 第n个元素</div><div class="line">x[-n] 除了第n个元素的x</div><div class="line">x[<span class="number">1</span>:n] 前n个元素</div><div class="line">x[-(<span class="number">1</span>:n)] 第n+<span class="number">1</span>至最后的元素</div><div class="line">x[c(<span class="number">1</span>,<span class="number">4</span>,<span class="number">2</span>) ] 指定元素</div><div class="line">x[<span class="string">"name"</span>] 名为<span class="string">"name"</span>的元素</div><div class="line">x[x &gt; <span class="number">3</span>] 所有大于<span class="number">3</span>的元素</div><div class="line">x[x &gt; <span class="number">3</span> &amp; x &lt; <span class="number">5</span>] 区间(<span class="number">3</span>,<span class="number">5</span>)的元素</div><div class="line">x[x %<span class="keyword">in</span>% c (<span class="string">"a"</span>,<span class="string">"and"</span>,<span class="string">"the"</span>)] 给定组中的元素</div></pre></td></tr></table></figure>
<p>具体案例使用如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line">x&lt;-c(<span class="number">10</span>:<span class="number">1</span>);x</div><div class="line"><span class="comment">##  [1] 109  8  76  5  43  2  1</span></div><div class="line">x[x==<span class="number">3</span>]&lt;-<span class="number">25</span>;x <span class="comment">#将x中等于3的元素变为25</span></div><div class="line"><span class="comment">##  [1] 109  8  76  5  4 252  1</span></div><div class="line">x[x=<span class="number">1</span>]&lt;-<span class="number">12</span>;x <span class="comment">#将x的第1个元素数值变为12</span></div><div class="line"><span class="comment">##  [1] 129  8  76  5  4 252  1</span></div><div class="line">letters[<span class="number">1</span>:<span class="number">30</span>] <span class="comment"># 产生字母序列</span></div><div class="line"><span class="comment">##  [1] "a" "b" "c" "d" "e" "f" "g" "h" "i" "j" "k" "l" "m" "n" "o" "p" "q"</span></div><div class="line"><span class="comment">## [18] "r" "s" "t" "u" "v" "w" "x" "y" "z" NA  NA  NA  NA</span></div><div class="line">a &lt;- c(<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">2</span>,<span class="number">5</span>,<span class="number">1</span>,<span class="number">6</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">5</span>,<span class="number">8</span>,<span class="number">5</span>,<span class="number">7</span>,<span class="number">3</span>);a</div><div class="line"><span class="comment">##  [1] 2 3 4 2 5 1 6 3 2 5 8 5 7 3</span></div><div class="line">which.max(a) <span class="comment"># 找出最大元素的下标</span></div><div class="line"><span class="comment">## [1] 11</span></div><div class="line">which.min(a) <span class="comment"># 找出大小的元素下标</span></div><div class="line"><span class="comment">## [1] 6</span></div><div class="line">a[which.max(a)] <span class="comment"># 找出最大的元素</span></div><div class="line"><span class="comment">## [1] 8</span></div><div class="line">which(a==<span class="number">2</span>) <span class="comment"># 等于2的元素的下标</span></div><div class="line"><span class="comment">## [1] 1 4 9</span></div><div class="line">a[which(a==<span class="number">2</span>)] <span class="comment"># 等于2的元素</span></div><div class="line"><span class="comment">## [1] 2 2 2</span></div><div class="line">which(a&gt;<span class="number">5</span>) <span class="comment"># 大于5的元素的下标</span></div><div class="line"><span class="comment">## [1]  7 11 13</span></div><div class="line">a[which(a&gt;<span class="number">5</span>)] <span class="comment"># 大于5的元素</span></div><div class="line"><span class="comment">## [1] 6 8 7</span></div></pre></td></tr></table></figure>
<p>再看一案例</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">&gt; data &lt;- <span class="number">1</span>:<span class="number">100</span></div><div class="line">&gt; data[data &gt; <span class="number">20</span>]</div><div class="line"><span class="comment"># 取data 中大于20 的对象出来</span></div><div class="line"> [<span class="number">1</span>]  <span class="number">21</span>  <span class="number">22</span>  <span class="number">23</span>  <span class="number">24</span>  <span class="number">25</span>  <span class="number">26</span>  <span class="number">27</span>  <span class="number">28</span>  <span class="number">29</span>  <span class="number">30</span>  <span class="number">31</span>  <span class="number">32</span>  <span class="number">33</span>  <span class="number">34</span>  <span class="number">35</span>  <span class="number">36</span>  <span class="number">37</span>  <span class="number">38</span>  <span class="number">39</span>  <span class="number">40</span>  <span class="number">41</span>  <span class="number">42</span>  <span class="number">43</span>  <span class="number">44</span></div><div class="line">[<span class="number">25</span>]  <span class="number">45</span>  <span class="number">46</span>  <span class="number">47</span>  <span class="number">48</span>  <span class="number">49</span>  <span class="number">50</span>  <span class="number">51</span>  <span class="number">52</span>  <span class="number">53</span>  <span class="number">54</span>  <span class="number">55</span>  <span class="number">56</span>  <span class="number">57</span>  <span class="number">58</span>  <span class="number">59</span>  <span class="number">60</span>  <span class="number">61</span>  <span class="number">62</span>  <span class="number">63</span>  <span class="number">64</span>  <span class="number">65</span>  <span class="number">66</span>  <span class="number">67</span>  <span class="number">68</span></div><div class="line">[<span class="number">49</span>]  <span class="number">69</span>  <span class="number">70</span>  <span class="number">71</span>  <span class="number">72</span>  <span class="number">73</span>  <span class="number">74</span>  <span class="number">75</span>  <span class="number">76</span>  <span class="number">77</span>  <span class="number">78</span>  <span class="number">79</span>  <span class="number">80</span>  <span class="number">81</span>  <span class="number">82</span>  <span class="number">83</span>  <span class="number">84</span>  <span class="number">85</span>  <span class="number">86</span>  <span class="number">87</span>  <span class="number">88</span>  <span class="number">89</span>  <span class="number">90</span>  <span class="number">91</span>  <span class="number">92</span></div><div class="line">[<span class="number">73</span>]  <span class="number">93</span>  <span class="number">94</span>  <span class="number">95</span>  <span class="number">96</span>  <span class="number">97</span>  <span class="number">98</span>  <span class="number">99</span> <span class="number">100</span></div></pre></td></tr></table></figure>
<p>通过方括号中的data &gt; 20 ，实现了我们想要的效果，具体是如何实现的呢？</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">&gt; data &gt; <span class="number">20</span></div><div class="line">  [<span class="number">1</span>] <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span></div><div class="line"> [<span class="number">17</span>] <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span> <span class="literal">FALSE</span>  <span class="literal">TRUE</span>  <span class="literal">TRUE</span>  <span class="literal">TRUE</span>  <span class="literal">TRUE</span>  <span class="literal">TRUE</span>  <span class="literal">TRUE</span>  <span class="literal">TRUE</span>  <span class="literal">TRUE</span>  <span class="literal">TRUE</span>  <span class="literal">TRUE</span>  <span class="literal">TRUE</span>  <span class="literal">TRUE</span></div><div class="line"> [<span class="number">33</span>]  <span class="literal">TRUE</span>  <span class="literal">TRUE</span>  <span class="literal">TRUE</span>  <span class="literal">TRUE</span>  <span class="literal">TRUE</span>  <span class="literal">TRUE</span>  <span class="literal">TRUE</span>  <span class="literal">TRUE</span>  <span class="literal">TRUE</span>  <span class="literal">TRUE</span>  <span class="literal">TRUE</span>  <span class="literal">TRUE</span>  <span class="literal">TRUE</span>  <span class="literal">TRUE</span>  <span class="literal">TRUE</span>  <span class="literal">TRUE</span></div><div class="line"> [<span class="number">49</span>]  <span class="literal">TRUE</span>  <span class="literal">TRUE</span>  <span class="literal">TRUE</span>  <span class="literal">TRUE</span>  <span class="literal">TRUE</span>  <span class="literal">TRUE</span>  <span class="literal">TRUE</span>  <span class="literal">TRUE</span>  <span class="literal">TRUE</span>  <span class="literal">TRUE</span>  <span class="literal">TRUE</span>  <span class="literal">TRUE</span>  <span class="literal">TRUE</span>  <span class="literal">TRUE</span>  <span class="literal">TRUE</span>  <span class="literal">TRUE</span></div><div class="line"> [<span class="number">65</span>]  <span class="literal">TRUE</span>  <span class="literal">TRUE</span>  <span class="literal">TRUE</span>  <span class="literal">TRUE</span>  <span class="literal">TRUE</span>  <span class="literal">TRUE</span>  <span class="literal">TRUE</span>  <span class="literal">TRUE</span>  <span class="literal">TRUE</span>  <span class="literal">TRUE</span>  <span class="literal">TRUE</span>  <span class="literal">TRUE</span>  <span class="literal">TRUE</span>  <span class="literal">TRUE</span>  <span class="literal">TRUE</span>  <span class="literal">TRUE</span></div><div class="line"> [<span class="number">81</span>]  <span class="literal">TRUE</span>  <span class="literal">TRUE</span>  <span class="literal">TRUE</span>  <span class="literal">TRUE</span>  <span class="literal">TRUE</span>  <span class="literal">TRUE</span>  <span class="literal">TRUE</span>  <span class="literal">TRUE</span>  <span class="literal">TRUE</span>  <span class="literal">TRUE</span>  <span class="literal">TRUE</span>  <span class="literal">TRUE</span>  <span class="literal">TRUE</span>  <span class="literal">TRUE</span>  <span class="literal">TRUE</span>  <span class="literal">TRUE</span></div><div class="line"> [<span class="number">97</span>]  <span class="literal">TRUE</span>  <span class="literal">TRUE</span>  <span class="literal">TRUE</span>  <span class="literal">TRUE</span></div></pre></td></tr></table></figure>
<p>data &gt; 20 是一个表示式，它的返回值是一个有TRUE和FALSE 构成的逻辑向量，最终只选取了TRUE对应的元素，所以data 中大于20的元素被选了出来。通过下标和逻辑值两种方式，可以满足我们绝大部分的需求，但是有时候，我们只是想知道符合条件的值对应的下标，这个时候which 函数就派上了用场，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; which(letters == <span class="string">"a"</span>)</div><div class="line">[<span class="number">1</span>] <span class="number">1</span></div></pre></td></tr></table></figure>
<p><code>==</code>操作符用来判断字符串相等，which 函数返回对应的下标，letters 这个向量中，第一个元素就是字母a, 所以返回值为1，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&gt; letters</div><div class="line"> [<span class="number">1</span>] <span class="string">"a"</span> <span class="string">"b"</span> <span class="string">"c"</span> <span class="string">"d"</span> <span class="string">"e"</span> <span class="string">"f"</span> <span class="string">"g"</span> <span class="string">"h"</span> <span class="string">"i"</span> <span class="string">"j"</span> <span class="string">"k"</span> <span class="string">"l"</span> <span class="string">"m"</span> <span class="string">"n"</span> <span class="string">"o"</span> <span class="string">"p"</span> <span class="string">"q"</span> <span class="string">"r"</span> <span class="string">"s"</span> <span class="string">"t"</span> <span class="string">"u"</span> <span class="string">"v"</span> <span class="string">"w"</span> <span class="string">"x"</span></div><div class="line">[<span class="number">25</span>] <span class="string">"y"</span> <span class="string">"z"</span></div><div class="line">&gt; which(letters %<span class="keyword">in</span>% c(<span class="string">"a"</span>, <span class="string">"d"</span>, <span class="string">"e"</span>))</div><div class="line">[<span class="number">1</span>] <span class="number">1</span> <span class="number">4</span> <span class="number">5</span></div></pre></td></tr></table></figure>
<p><code>%in%</code>操作符用来判断操作符左边的向量中的元素是否位于操作符右边的向量中，通过这种集合操作，可以方便的一次返回多个下标，使用subset函数也可以提取满足某一条件的向量元素，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&gt; x &lt;- c(<span class="number">1</span>,<span class="number">3</span>,<span class="number">8</span>,<span class="number">2</span>,<span class="number">20</span>)</div><div class="line">&gt; x</div><div class="line">[<span class="number">1</span>] <span class="number">1</span> <span class="number">3</span> <span class="number">8</span> <span class="number">2</span> <span class="number">20</span></div><div class="line">&gt; subset(x,x&gt;<span class="number">5</span>)</div><div class="line">[<span class="number">1</span>] <span class="number">8</span> <span class="number">20</span></div></pre></td></tr></table></figure>
<h3 id="ifelse">ifelse</h3>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&gt; x &lt;- c(<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>);x</div><div class="line">[<span class="number">1</span>] <span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> <span class="number">1</span></div><div class="line">&gt; ifelse(x != <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>) <span class="comment">#若果x的值不等于1，输出1，否则输出0</span></div><div class="line">[<span class="number">1</span>] <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span></div></pre></td></tr></table></figure>
<p>ifelse和<code>%in%</code>的联合使用，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">&gt; ifelse(x %<span class="keyword">in</span>% <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>) <span class="comment">#若x的值包含在1里面，输出1，否者输出0</span></div><div class="line">[<span class="number">1</span>] <span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> <span class="number">1</span></div><div class="line">&gt; ifelse(x %<span class="keyword">in</span>% <span class="number">1</span>, <span class="string">'yes'</span>, <span class="string">'no'</span>) <span class="comment">#若x的值包含在1里面，输出yes，否者输出no</span></div><div class="line">[<span class="number">1</span>] <span class="string">"yes"</span> <span class="string">"yes"</span> <span class="string">"yes"</span> <span class="string">"no"</span>  <span class="string">"no"</span>  <span class="string">"yes"</span> <span class="string">"yes"</span></div><div class="line">&gt; which(x %<span class="keyword">in</span>% <span class="number">1</span>) <span class="comment"># 输出x包含在1中值的位置</span></div><div class="line">[<span class="number">1</span>] <span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">6</span> <span class="number">7</span></div><div class="line">&gt; y &lt;- c(<span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">4</span>)</div><div class="line">&gt; z &lt;- c(<span class="number">1</span>, <span class="number">4</span>)</div><div class="line">&gt; ifelse(y %<span class="keyword">in</span>% z, which(y==z), <span class="number">0</span> ) <span class="comment">##若y的值包含在z里面，输出y==z的位置，否者输出0</span></div><div class="line">[<span class="number">1</span>] <span class="number">0</span> <span class="number">4</span> <span class="number">0</span> <span class="number">4</span></div><div class="line">&gt; ifelse(y %<span class="keyword">in</span>% z, which(y==z), <span class="number">0</span> ) <span class="comment">##若y的值包含在z里面，输出y==z的位置，否者输出0，</span></div><div class="line">[<span class="number">1</span>] <span class="number">0</span> <span class="number">4</span> <span class="number">0</span> <span class="number">4</span></div><div class="line">&gt; <span class="comment">#此例中没有找到y==z的值， 输出为NA。</span></div><div class="line">&gt; ifelse(y %<span class="keyword">in</span>% z, <span class="number">1</span>, <span class="number">0</span> )</div><div class="line">[<span class="number">1</span>] <span class="number">0</span> <span class="number">1</span> <span class="number">0</span> <span class="number">1</span></div></pre></td></tr></table></figure>
<h2 id="向量的比较">向量的比较</h2>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">x&lt;-c(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>)</div><div class="line">y&lt;-c(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>)</div><div class="line">z&lt;-c(<span class="number">1</span>,<span class="number">2</span>,<span class="number">4</span>);</div><div class="line">x;y;z</div><div class="line"><span class="comment">## [1] 1 2 3</span></div><div class="line"><span class="comment">## [1] 1 2 3</span></div><div class="line"><span class="comment">## [1] 1 2 4</span></div><div class="line">x==y;x==z;y==z <span class="comment">#分别比较x,y,z的各个元素</span></div><div class="line"><span class="comment">## [1] TRUE TRUE TRUE</span></div><div class="line"><span class="comment">## [1]  TRUETRUE FALSE</span></div><div class="line"><span class="comment">## [1]  TRUETRUE FALSE</span></div><div class="line">identical(x,y);identical(x,z);identical(z,y) <span class="comment">#比较x,y,z的整体</span></div><div class="line"><span class="comment">## [1] TRUE</span></div><div class="line"><span class="comment">## [1] FALSE</span></div><div class="line"><span class="comment">## [1] FALSE</span></div><div class="line">all.equal(x,y) <span class="comment">#比较数值型变量是否“近似相等”</span></div><div class="line"><span class="comment">## [1] TRUE</span></div></pre></td></tr></table></figure>
<h2 id="两组数据的集合运算">两组数据的集合运算</h2>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">&gt; <span class="comment">#首先对集合A,B,C赋值</span></div><div class="line">&gt; A&lt;-<span class="number">1</span>:<span class="number">10</span></div><div class="line">&gt; B&lt;-seq(<span class="number">5</span>,<span class="number">15</span>,<span class="number">2</span>)</div><div class="line">&gt; C&lt;-<span class="number">1</span>:<span class="number">5</span></div><div class="line">&gt; union(A,B)<span class="comment">#求A和B的并集</span></div><div class="line"> [<span class="number">1</span>]  <span class="number">1</span>  <span class="number">2</span>  <span class="number">3</span>  <span class="number">4</span>  <span class="number">5</span>  <span class="number">6</span>  <span class="number">7</span>  <span class="number">8</span>  <span class="number">9</span> <span class="number">10</span> <span class="number">11</span> <span class="number">13</span> <span class="number">15</span></div><div class="line">&gt; intersect(A,B)  <span class="comment">#求A和B的交集</span></div><div class="line">[<span class="number">1</span>] <span class="number">5</span> <span class="number">7</span> <span class="number">9</span></div><div class="line">&gt; setdiff(A,B) <span class="comment">#求A-B</span></div><div class="line">[<span class="number">1</span>]  <span class="number">1</span>  <span class="number">2</span>  <span class="number">3</span>  <span class="number">4</span>  <span class="number">6</span>  <span class="number">8</span> <span class="number">10</span></div><div class="line">&gt; setdiff(B,A) <span class="comment">#求B-A</span></div><div class="line">[<span class="number">1</span>] <span class="number">11</span> <span class="number">13</span> <span class="number">15</span></div><div class="line">&gt; setequal(A,B) <span class="comment"># 检验集合A,B是否相同</span></div><div class="line">[<span class="number">1</span>] <span class="literal">FALSE</span></div><div class="line">&gt; is.element(<span class="number">12</span>,C) <span class="comment">#检验元素12是否属于集合C</span></div><div class="line">[<span class="number">1</span>] <span class="literal">FALSE</span></div><div class="line">&gt; all(C%<span class="keyword">in</span>%A) <span class="comment">#检验集合A是否包含C</span></div><div class="line">[<span class="number">1</span>] <span class="literal">TRUE</span></div><div class="line">&gt; all(C%<span class="keyword">in</span>%B)</div><div class="line">[<span class="number">1</span>] <span class="literal">FALSE</span></div><div class="line">&gt; match(C,B)</div><div class="line">[<span class="number">1</span>] <span class="literal">NA</span> <span class="literal">NA</span> <span class="literal">NA</span> <span class="literal">NA</span>  <span class="number">1</span></div></pre></td></tr></table></figure>
<p>从上面可以看到<code>%in%</code>这个操作符只返回逻辑向量TRUE 或者FALSE，而且返回值应该与<code>%in%</code>这个操作符前面的向量程度相等。也就是说它相当于遍历了C里面的一个个元素，判断它们是否在B中出现过，然后返回是或者否即可。而<code>match(C,B)</code>的结果就很不一样了，它的返回结果同样与前面的向量等长，但是它并非返回逻辑向量，而是遍历了C里面的一个个元素，判断它们是否在B中出现过，如果出现就返回在B中的索引号，如果没有出现，就返回NA。</p>
<h1 id="数据框">数据框</h1>
<h2 id="数据框定义">数据框定义</h2>
<p>一种矩阵形式的数据，但数据框中各列可以是不同类型的数据。数据框每列是一个变量，每行是一个观测。数据框可以看成是矩阵的推广，也可看作一种特殊的列表对象。</p>
<h2 id="数据框的创建">数据框的创建</h2>
<h3 id="data.frame">data.frame()</h3>
<p>通过data.frame函数来创建数据框，该函数包含的主要参数为: data.frame(…, row.names = NULL, check.rows = FALSE, check.names = TRUE, stringsAsFactors = default.stringsAsFactors()) 如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">rats &lt;- c(<span class="number">1</span>:<span class="number">6</span>)</div><div class="line">group &lt;- c(<span class="string">"postive"</span>,<span class="string">"postive"</span>,<span class="string">"model"</span>,<span class="string">"model"</span>,<span class="string">"control"</span>,<span class="string">"control"</span>)</div><div class="line">sex &lt;- c(<span class="string">"F"</span>,<span class="string">"M"</span>,<span class="string">"F"</span>,<span class="string">"M"</span>,<span class="string">"F"</span>,<span class="string">"M"</span>)</div><div class="line">glu.d1 &lt;- c(<span class="number">11.97</span>,<span class="number">12.97</span>,<span class="number">27.34</span>,<span class="number">23.97</span>,<span class="number">6.79</span>,<span class="number">5.19</span>)</div><div class="line">glu.d7 &lt;- c(<span class="number">12.97</span>,<span class="number">13.97</span>,<span class="number">25.56</span>,<span class="number">23.97</span>,<span class="number">5.79</span>,<span class="number">6.19</span>)</div><div class="line">rat.data &lt;- data.frame(rats,group,sex,glu.d1,glu.d7)</div><div class="line">rat.data</div></pre></td></tr></table></figure>
<blockquote>
<p> rat.data   rats   group sex glu.d1 glu.d7 1    1 postive   F  11.97  12.97 2    2 postive   M  12.97  13.97 3    3   model   F  27.34  25.56 4    4   model   M  23.97  23.97 5    5 control   F   6.79   5.79 6    6 control   M   5.19   6.19</p>
</blockquote>
<h3 id="expand.grid">expand.grid()</h3>
<p>通过expand.grid()创建一个数据框，此函数可以创建元素所有可能的组合：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">x&lt;-expand.grid(h=c(<span class="number">60</span>,<span class="number">80</span>),w=c(<span class="number">100</span>,<span class="number">300</span>),sex=c(<span class="string">"M"</span>,<span class="string">"F"</span>))</div><div class="line">x</div></pre></td></tr></table></figure>
<blockquote>
<p> x    h   w sex 1 60 100   M 2 80 100   M 3 60 300   M 4 80 300   M 5 60 100   F 6 80 100   F 7 60 300   F 8 80 300   F</p>
</blockquote>
<h3 id="查看数据框信息">查看数据框信息</h3>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">class(rat.data) <span class="comment"># 查看类型</span></div></pre></td></tr></table></figure>
<blockquote>
<p> class(rat.data) # 查看类型 [1] “data.frame”</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">class(rat.data$sex) # 查看某列的类型</div></pre></td></tr></table></figure>
<blockquote>
<p> class(rat.data$sex) # 查看某列的类型 [1] “factor”</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">length(rat.data) # 查看数据框长度</div></pre></td></tr></table></figure>
<blockquote>
<p> length(rat.data) # 查看数据框长度 [1] 5</p>
</blockquote>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">names(rat.data) <span class="comment"># 数据框各项名称</span></div></pre></td></tr></table></figure>
<blockquote>
<p> names(rat.data) # 数据框各项名称 [1] “rats”   “group”  “sex”    “glu.d1” “glu.d7”</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">summary(rat.data) </div><div class="line"># 数据框信息总结,对字符类/因子类数据，给出相应的频数统计；给数值型数据给出5个主要的指标</div></pre></td></tr></table></figure>
<blockquote>
<p> summary(rat.data)        rats          group   sex       glu.d1           glu.d7    <br>
 Min.   :1.00   control:2   F:3   Min.   : 5.190   Min.   : 5.790<br>
 1st Qu.:2.25   model  :2   M:3   1st Qu.: 8.085   1st Qu.: 7.885<br>
 Median :3.50   postive:2         Median :12.470   Median :13.470<br>
 Mean   :3.50                     Mean   :14.705   Mean   :14.742<br>
 3rd Qu.:4.75                     3rd Qu.:21.220   3rd Qu.:21.470<br>
 Max.   :6.00                     Max.   :27.340   Max.   :25.560 </p>
</blockquote>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">table(rat.data$group,rat.data$sex) </div><div class="line"><span class="comment"># 将数据框中的group与sex关联为一个表</span></div></pre></td></tr></table></figure>
<blockquote>
<p> table(rat.data<span class="math inline">\(group,rat.data\)</span>sex)  <br>
   F M   control 1 1   model   1 1   postive 1 1</p>
</blockquote>
<h2 id="数据框的去重">数据框的去重</h2>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">rat.data2 &lt;- rbind(rat.data,rat.data) <span class="comment"># 创建一个新数据框rat.data2，内容是rat.data的2倍</span></div><div class="line">unique(rat.data2) <span class="comment"># 对数据框进行去重，即提取不重复的元素</span></div></pre></td></tr></table></figure>
<blockquote>
<p> unique(rat.data2) # 对数据框进行去重，即提取不重复的元素   rats   group sex glu.d1 glu.d7 1    1 postive   F  11.97  12.97 2    2 postive   M  12.97  13.97 3    3   model   F  27.34  25.56 4    4   model   M  23.97  23.97 5    5 control   F   6.79   5.79 6    6 control   M   5.19   6.19</p>
</blockquote>
<h3 id="去重函数unique">去重函数unique()</h3>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">unique(c(<span class="number">1</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>)) <span class="comment"># 对向量c(1,1,2,2,3,4)提取不重复的元素</span></div></pre></td></tr></table></figure>
<blockquote>
<p> unique(c(1,1,2,2,3,4)) # 对向量c(1,1,2,2,3,4)提取不重复的元素 [1] 1 2 3 4</p>
</blockquote>
<h3 id="取重复的行">取重复的行</h3>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">rat.data2[duplicated(rat.data2),]<span class="comment"># 取数据框中重复的行</span></div></pre></td></tr></table></figure>
<blockquote>
<p> rat.data2[duplicated(rat.data2),]# 取数据框中重复的行    rats   group sex glu.d1 glu.d7 7     1 postive   F  11.97  12.97 8     2 postive   M  12.97  13.97 9     3   model   F  27.34  25.56 10    4   model   M  23.97  23.97 11    5 control   F   6.79   5.79 12    6 control   M   5.19   6.19</p>
</blockquote>
<h2 id="提取取数据框元素">提取取数据框元素</h2>
<h3 id="提取某个元素">提取某个元素</h3>
<p>rat.data[i,j]指第i行第j列的数据</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">rat.data[<span class="number">1</span>,<span class="number">2</span>] <span class="comment">#取第1行第2列</span></div></pre></td></tr></table></figure>
<blockquote>
<p> rat.data[1,2] #取第1行第2列 [1] postive Levels: control model postive</p>
</blockquote>
<h3 id="提取某行">提取某行</h3>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">rat.data[<span class="number">2</span>,] <span class="comment">#取第2行</span></div><div class="line">rat.data[c(<span class="number">1</span>,<span class="number">4</span>),] <span class="comment">#取1，4行</span></div></pre></td></tr></table></figure>
<blockquote>
<p> rat.data[2,] #取第2行   rats   group sex glu.d1 glu.d7 2    2 postive   M  12.97  13.97</p>
</blockquote>
<blockquote>
<p> rat.data[c(1,4),] #取1，4行   rats   group sex glu.d1 glu.d7 1    1 postive   F  11.97  12.97 4    4   model   M  23.97  23.97</p>
</blockquote>
<h3 id="提取某列用列号提取">提取某列——用列号提取</h3>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">rat.data[,3] #取第3列</div></pre></td></tr></table></figure>
<blockquote>
<p> rat.data[,3] #取第3列 [1] F M F M F M Levels: F M</p>
</blockquote>
<h3 id="提取某列用列名称提取">提取某列——用列名称提取</h3>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">rat.data$rats #取rat.data数据框中的rats列</div></pre></td></tr></table></figure>
<blockquote>
<p> rat.data$rats #取rat.data数据框中的rats列 [1] 1 2 3 4 5 6</p>
</blockquote>
<h3 id="提取除掉某列的其余列">提取除掉某列的其余列</h3>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">rat.data[,-3] #取除了第3列外的其余列</div></pre></td></tr></table></figure>
<blockquote>
<p> rat.data[,-3] #取除了第3列外的其余列   rats   group glu.d1 glu.d7 1    1 postive  11.97  12.97 2    2 postive  12.97  13.97 3    3   model  27.34  25.56 4    4   model  23.97  23.97 5    5 control   6.79   5.79 6    6 control   5.19   6.19</p>
</blockquote>
<h3 id="取1到4行中的第4列">取1到4行中的第4列</h3>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">rat.data[1:4,4]</div></pre></td></tr></table></figure>
<blockquote>
<p> rat.data[1:4,4][1] 11.97 12.97 27.34 23.97</p>
</blockquote>
<h3 id="取1到4行中的第3列">取1到4行中的第3列</h3>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">rat.data[1:4,3]</div></pre></td></tr></table></figure>
<blockquote>
<p> rat.data[1:4,3][1] F M F M Levels: F M</p>
</blockquote>
<h3 id="取第1行2到4列">取第1行，2到4列</h3>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">rat.data[1,2:4] #取第1行，2到4列</div></pre></td></tr></table></figure>
<blockquote>
<p> rat.data[1,2:4] #取第1行，2到4列     group sex glu.d1 1 postive   F  11.97</p>
</blockquote>
<h3 id="提取满足某一条件的列">提取满足某一条件的列</h3>
<p>提取rat.data中所有control级别的观察值</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">Sel &lt;- rat.data$group == &quot;control&quot;</div><div class="line">rat.data.control &lt;- rat.data[Sel,]</div><div class="line">rat.data.control</div></pre></td></tr></table></figure>
<blockquote>
<p> rat.data.control   rats   group sex glu.d1 glu.d7 5    5 control   F   6.79   5.79 6    6 control   M   5.19   6.19</p>
</blockquote>
<h3 id="提取子集案例二">提取子集案例二</h3>
<p>如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line">&gt; manager&lt;-c(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>)</div><div class="line">&gt; date&lt;-c(<span class="string">"10/24/08"</span>,<span class="string">"10/28/08"</span>,<span class="string">"10/01/08"</span>,<span class="string">"10/12/08"</span>,<span class="string">"05/01/09"</span>)</div><div class="line">&gt; country&lt;-c(<span class="string">"US"</span>,<span class="string">"US"</span>,<span class="string">"UK"</span>,<span class="string">"China"</span>,<span class="string">"UK"</span>)</div><div class="line">&gt; gender&lt;-c(<span class="string">"M"</span>,<span class="string">"F"</span>,<span class="string">"F"</span>,<span class="string">"M"</span>,<span class="string">"F"</span>)</div><div class="line">&gt; age&lt;-c(<span class="number">32</span>,<span class="number">45</span>,<span class="number">25</span>,<span class="number">23</span>,<span class="number">99</span>)</div><div class="line">&gt; q1&lt;-c(<span class="number">5</span>,<span class="number">3</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">1</span>)</div><div class="line">&gt; q2&lt;-c(<span class="number">4</span>,<span class="number">5</span>,<span class="number">4</span>,<span class="number">4</span>,<span class="number">5</span>)</div><div class="line">&gt; q3&lt;-c(<span class="number">2</span>,<span class="number">4</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">3</span>)</div><div class="line">&gt; q4&lt;-c(<span class="number">5</span>,<span class="number">3</span>,<span class="number">3</span>,<span class="literal">NA</span>,<span class="number">2</span>)</div><div class="line">&gt; q5&lt;-c(<span class="number">5</span>,<span class="number">5</span>,<span class="number">3</span>,<span class="number">3</span>,<span class="literal">NA</span>)</div><div class="line">&gt; leadership&lt;-data.frame(manager,date,country,gender,age,q1,q2,q3,q4,q5,stringsAsFactors=<span class="literal">FALSE</span>)</div><div class="line">&gt; leadership</div><div class="line">  manager     date country gender age q1 q2 q3 q4 q5</div><div class="line"><span class="number">1</span>       <span class="number">1</span> <span class="number">10</span>/<span class="number">24</span>/<span class="number">08</span>      US      M  <span class="number">32</span>  <span class="number">5</span>  <span class="number">4</span>  <span class="number">2</span>  <span class="number">5</span>  <span class="number">5</span></div><div class="line"><span class="number">2</span>       <span class="number">2</span> <span class="number">10</span>/<span class="number">28</span>/<span class="number">08</span>      US      <span class="literal">F</span>  <span class="number">45</span>  <span class="number">3</span>  <span class="number">5</span>  <span class="number">4</span>  <span class="number">3</span>  <span class="number">5</span></div><div class="line"><span class="number">3</span>       <span class="number">3</span> <span class="number">10</span>/<span class="number">01</span>/<span class="number">08</span>      UK      <span class="literal">F</span>  <span class="number">25</span>  <span class="number">3</span>  <span class="number">4</span>  <span class="number">3</span>  <span class="number">3</span>  <span class="number">3</span></div><div class="line"><span class="number">4</span>       <span class="number">4</span> <span class="number">10</span>/<span class="number">12</span>/<span class="number">08</span>   China      M  <span class="number">23</span>  <span class="number">2</span>  <span class="number">4</span>  <span class="number">4</span> <span class="literal">NA</span>  <span class="number">3</span></div><div class="line"><span class="number">5</span>       <span class="number">5</span> <span class="number">05</span>/<span class="number">01</span>/<span class="number">09</span>      UK      <span class="literal">F</span>  <span class="number">99</span>  <span class="number">1</span>  <span class="number">5</span>  <span class="number">3</span>  <span class="number">2</span> <span class="literal">NA</span></div><div class="line">&gt; newdata &lt;- leadership[, c(<span class="number">6</span>:<span class="number">10</span>)] <span class="comment">#从leadership数据框中取第6行到第10行的变量，并且将其保存在newdata中，将行下标留空(,），表示取所有行</span></div><div class="line">&gt; newdata</div><div class="line">  q1 q2 q3 q4 q5</div><div class="line"><span class="number">1</span>  <span class="number">5</span>  <span class="number">4</span>  <span class="number">2</span>  <span class="number">5</span>  <span class="number">5</span></div><div class="line"><span class="number">2</span>  <span class="number">3</span>  <span class="number">5</span>  <span class="number">4</span>  <span class="number">3</span>  <span class="number">5</span></div><div class="line"><span class="number">3</span>  <span class="number">3</span>  <span class="number">4</span>  <span class="number">3</span>  <span class="number">3</span>  <span class="number">3</span></div><div class="line"><span class="number">4</span>  <span class="number">2</span>  <span class="number">4</span>  <span class="number">4</span> <span class="literal">NA</span>  <span class="number">3</span></div><div class="line"><span class="number">5</span>  <span class="number">1</span>  <span class="number">5</span>  <span class="number">3</span>  <span class="number">2</span> <span class="literal">NA</span></div></pre></td></tr></table></figure>
<p>再看一案例，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">&gt; leadership</div><div class="line">  manager     date country gender age q1 q2 q3 q4 q5</div><div class="line"><span class="number">1</span>       <span class="number">1</span> <span class="number">10</span>/<span class="number">24</span>/<span class="number">08</span>      US      M  <span class="number">32</span>  <span class="number">5</span>  <span class="number">4</span>  <span class="number">2</span>  <span class="number">5</span>  <span class="number">5</span></div><div class="line"><span class="number">2</span>       <span class="number">2</span> <span class="number">10</span>/<span class="number">28</span>/<span class="number">08</span>      US      <span class="literal">F</span>  <span class="number">45</span>  <span class="number">3</span>  <span class="number">5</span>  <span class="number">4</span>  <span class="number">3</span>  <span class="number">5</span></div><div class="line"><span class="number">3</span>       <span class="number">3</span> <span class="number">10</span>/<span class="number">01</span>/<span class="number">08</span>      UK      <span class="literal">F</span>  <span class="number">25</span>  <span class="number">3</span>  <span class="number">4</span>  <span class="number">3</span>  <span class="number">3</span>  <span class="number">3</span></div><div class="line"><span class="number">4</span>       <span class="number">4</span> <span class="number">10</span>/<span class="number">12</span>/<span class="number">08</span>   China      M  <span class="number">23</span>  <span class="number">2</span>  <span class="number">4</span>  <span class="number">4</span> <span class="literal">NA</span>  <span class="number">3</span></div><div class="line"><span class="number">5</span>       <span class="number">5</span> <span class="number">05</span>/<span class="number">01</span>/<span class="number">09</span>      UK      <span class="literal">F</span>  <span class="number">99</span>  <span class="number">1</span>  <span class="number">5</span>  <span class="number">3</span>  <span class="number">2</span> <span class="literal">NA</span></div><div class="line">&gt; newdata&lt;- leadership[which(leadership$gender == <span class="string">"M"</span> &amp; leadership$age&gt;<span class="number">30</span>),] <span class="comment"># 将leaderhip中30岁以上的男性选入newdata中</span></div><div class="line">&gt; newdata</div><div class="line">  manager     date country gender age q1 q2 q3 q4 q5</div><div class="line"><span class="number">1</span>       <span class="number">1</span> <span class="number">10</span>/<span class="number">24</span>/<span class="number">08</span>      US      M  <span class="number">32</span>  <span class="number">5</span>  <span class="number">4</span>  <span class="number">2</span>  <span class="number">5</span>  <span class="number">5</span></div></pre></td></tr></table></figure>
<h3 id="将某一数值转换为某一类别变量">将某一数值转换为某一类别变量</h3>
<h4 id="创建数据框">创建数据框</h4>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">manager&lt;-c(1,2,3,4,5)</div><div class="line">date&lt;-c(&quot;10/24/08&quot;,&quot;10/28/08&quot;,&quot;10/1/08&quot;,&quot;10/12/08&quot;,&quot;5/1/09&quot;)</div><div class="line">country&lt;-c(&quot;US&quot;,&quot;US&quot;,&quot;UK&quot;,&quot;UK&quot;,&quot;UK&quot;)</div><div class="line">gender&lt;-c(&quot;M&quot;,&quot;F&quot;,&quot;F&quot;,&quot;M&quot;,&quot;F&quot;)</div><div class="line">age&lt;-c(32,45,25,39,99)</div><div class="line">q1&lt;-c(5,3,3,3,2)</div><div class="line">q2&lt;-c(4,5,5,3,2)</div><div class="line">q3&lt;-c(5,2,5,4,1)</div><div class="line">q4&lt;-c(5,5,5,NA,2)</div><div class="line">q5&lt;-c(5,5,2,NA,1)</div><div class="line">leadership&lt;-data.frame(manager,date,country,gender,age,q1,q2,q3,q4,q5,stringsAsFactor=FALSE)</div><div class="line">#把字符转化为因子</div><div class="line">leadership</div></pre></td></tr></table></figure>
<blockquote>
<p> leadership   manager     date country gender age q1 q2 q3 q4 q5 stringsAsFactor 1       1 10/24/08      US      M  32  5  4  5  5  5           FALSE 2       2 10/28/08      US      F  45  3  5  2  5  5           FALSE 3       3  10/1/08      UK      F  25  3  5  5  5  2           FALSE 4       4 10/12/08      UK      M  39  3  3  4 NA NA           FALSE 5       5   5/1/09      UK      F  99  2  2  1  2  1           FALSE</p>
</blockquote>
<h4 id="转变变量">转变变量</h4>
<p>要求：将大于99的转换为缺失，age大于75的为Elder，55到75之间的为Middle，55以下的为Young：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">leadership$age[leadership$age == <span class="number">99</span>] &lt;-<span class="literal">NA</span> <span class="comment"># 年龄为99时，表示缺失</span></div><div class="line">leadership$agecat[leadership$age &gt;<span class="number">75</span>] &lt;- <span class="string">"Elder"</span> <span class="comment"># 当age大于75时，agecat为Elder</span></div><div class="line">leadership$agecat[leadership$age &gt;= <span class="number">55</span> &amp; leadership$age&lt;= <span class="number">75</span>] &lt;- <span class="string">"Middle"</span> <span class="comment"># 当55&lt;= age &lt;=75时，agecat为Middle</span></div><div class="line">leadership$agecat[leadership$age &lt; <span class="number">55</span>] &lt;-<span class="string">"Young"</span> <span class="comment">#age&lt;55时，agecat为Young</span></div><div class="line">leadership</div></pre></td></tr></table></figure>
<blockquote>
<p> leadership   manager     date country gender age q1 q2 q3 q4 q5 stringsAsFactor agecat 1       1 10/24/08      US      M  32  5  4  5  5  5           FALSE  Young 2       2 10/28/08      US      F  45  3  5  2  5  5           FALSE  Young 3       3  10/1/08      UK      F  25  3  5  5  5  2           FALSE  Young 4       4 10/12/08      UK      M  39  3  3  4 NA NA           FALSE  Young 5       5   5/1/09      UK      F  NA  2  2  1  2  1           FALSE   <na></na></p>
</blockquote>
<h2 id="判断数据框各行是否完整">判断数据框各行是否完整</h2>
<p>所用函数为complete.cases</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">rat.data1&lt;-rat.data</div><div class="line">rat.data1$group[<span class="number">2</span>]&lt;-<span class="literal">NA</span></div><div class="line">complete.cases(rat.data1) <span class="comment">#判断数据框是否完整</span></div></pre></td></tr></table></figure>
<blockquote>
<p> complete.cases(rat.data1) #判断数据框是否完整 [1]  TRUE FALSE  TRUE  TRUE  TRUE  TRUE</p>
</blockquote>
<h2 id="提取非缺失值">提取非缺失值</h2>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">rat.data1[complete.cases(rat.data1),] #选择非缺失值的数据</div></pre></td></tr></table></figure>
<blockquote>
<p> rat.data1[complete.cases(rat.data1),] #选择非缺失值的数据   rats   group sex glu.d1 glu.d7 1    1 postive   F  11.97  12.97 3    3   model   F  27.34  25.56 4    4   model   M  23.97  23.97 5    5 control   F   6.79   5.79 6    6 control   M   5.19   6.19</p>
</blockquote>
<h2 id="增加列">增加列</h2>
<h3 id="直接添加">直接添加</h3>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">rat.data$result&lt;-c(rat.data$glu.d1-rat.data$glu.d7)</div><div class="line">rat.data</div></pre></td></tr></table></figure>
<blockquote>
<p> rat.data   rats   group sex glu.d1 glu.d7 result 1    1 postive   F  11.97  12.97  -1.00 2    2 postive   M  12.97  13.97  -1.00 3    3   model   F  27.34  25.56   1.78 4    4   model   M  23.97  23.97   0.00 5    5 control   F   6.79   5.79   1.00 6    6 control   M   5.19   6.19  -1.00</p>
</blockquote>
<h3 id="cbind添加">cbind添加</h3>
<p>格式为data.frame1 &lt;- cbind(data.fram1,新的变量（可以由公式得到）)，例如下面的例子就是在rat.data1添加一个result变量，result的变量是由rat.data1中的glu.d1减去glu.d7得到的。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">rat.data1&lt;-cbind(rat.data1, result=c(rat.data1$glu.d1-rat.data1$glu.d7))</div><div class="line">rat.data1</div></pre></td></tr></table></figure>
<blockquote>
<p> rat.data1&lt;-cbind(rat.data1, result=c(rat.data1<span class="math inline">\(glu.d1-rat.data1\)</span>glu.d7))  rat.data1   rats   group sex glu.d1 glu.d7 result 1    1 postive   F  11.97  12.97  -1.00 2    2    <na>   M  12.97  13.97  -1.00 3    3   model   F  27.34  25.56   1.78 4    4   model   M  23.97  23.97   0.00 5    5 control   F   6.79   5.79   1.00 6    6 control   M   5.19   6.19  -1.00</na></p>
</blockquote>
<p>另外的方法为：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">rat.data1$result &lt;- rat.data1$glu.d1-rat.data1$glu.d7</div><div class="line"><span class="comment"># 或</span></div><div class="line">rat.data1 &lt;- transform(rat.data1,result=glu.d1-glu.d7)</div></pre></td></tr></table></figure>
<h3 id="merge添加">merge()添加</h3>
<p>用法为<code>total &lt;- merge(dataframeA, dataframeB, by = &quot;ID&quot;)</code>，它表示，将dataframeA与dataframeB按照ID进行合并，这种联结通常是横向的，即向数据框中添加变量。</p>
<h2 id="删除列">删除列</h2>
<h3 id="使用null">使用NULL</h3>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">rat.data1</div><div class="line">rat.data1$result&lt;-<span class="literal">NULL</span> <span class="comment"># 删除result这一列，原数列有2列result</span></div><div class="line">rat.data1</div></pre></td></tr></table></figure>
<blockquote>
<p> rat.data1   rats   group sex glu.d1 glu.d7 result 1    1 postive   F  11.97  12.97  -1.00 2    2    <na>   M  12.97  13.97  -1.00 3    3   model   F  27.34  25.56   1.78 4    4   model   M  23.97  23.97   0.00 5    5 control   F   6.79   5.79   1.00 6    6 control   M   5.19   6.19  -1.00</na></p>
</blockquote>
<blockquote>
<p> rat.data1$result&lt;-NULL # 删除result这一列</p>
</blockquote>
<blockquote>
<p> rat.data1   rats   group sex glu.d1 glu.d7 1    1 postive   F  11.97  12.97 2    2    <na>   M  12.97  13.97 3    3   model   F  27.34  25.56 4    4   model   M  23.97  23.97 5    5 control   F   6.79   5.79 6    6 control   M   5.19   6.19</na></p>
</blockquote>
<h3 id="用subset">用subset()</h3>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">rat.data1&lt;-subset(rat.data1,select=c(-sex,-group)) <span class="comment">#删除sex,group列</span></div><div class="line">rat.data1</div></pre></td></tr></table></figure>
<blockquote>
<p> rat.data1&lt;-subset(rat.data1,select=c(-sex,-group)) #删除sex,group列  rat.data1   rats glu.d1 glu.d7 1    1  11.97  12.97 2    2  12.97  13.97 3    3  27.34  25.56 4    4  23.97  23.97 5    5   6.79   5.79 6    6   5.19   6.19</p>
</blockquote>
<p>使用<code>%in%</code>，如下所示：</p>
<p>先生成一个数据框，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">&gt; manager&lt;-c(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>)</div><div class="line">&gt; date&lt;-c(<span class="string">"10/24/08"</span>,<span class="string">"10/28/08"</span>,<span class="string">"10/01/08"</span>,<span class="string">"10/12/08"</span>,<span class="string">"05/01/09"</span>)</div><div class="line">&gt; country&lt;-c(<span class="string">"US"</span>,<span class="string">"US"</span>,<span class="string">"UK"</span>,<span class="string">"China"</span>,<span class="string">"UK"</span>)</div><div class="line">&gt; gender&lt;-c(<span class="string">"M"</span>,<span class="string">"F"</span>,<span class="string">"F"</span>,<span class="string">"M"</span>,<span class="string">"F"</span>)</div><div class="line">&gt; age&lt;-c(<span class="number">32</span>,<span class="number">45</span>,<span class="number">25</span>,<span class="number">23</span>,<span class="number">99</span>)</div><div class="line">&gt; q1&lt;-c(<span class="number">5</span>,<span class="number">3</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">1</span>)</div><div class="line">&gt; q2&lt;-c(<span class="number">4</span>,<span class="number">5</span>,<span class="number">4</span>,<span class="number">4</span>,<span class="number">5</span>)</div><div class="line">&gt; q3&lt;-c(<span class="number">2</span>,<span class="number">4</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">3</span>)</div><div class="line">&gt; q4&lt;-c(<span class="number">5</span>,<span class="number">3</span>,<span class="number">3</span>,<span class="literal">NA</span>,<span class="number">2</span>)</div><div class="line">&gt; q5&lt;-c(<span class="number">5</span>,<span class="number">5</span>,<span class="number">3</span>,<span class="number">3</span>,<span class="literal">NA</span>)</div><div class="line">&gt; leadership&lt;-data.frame(manager,date,country,gender,age,q1,q2,q3,q4,q5,stringsAsFactors=<span class="literal">FALSE</span>)</div><div class="line">&gt; leadership</div><div class="line">  manager     date country gender age q1 q2 q3 q4 q5</div><div class="line"><span class="number">1</span>       <span class="number">1</span> <span class="number">10</span>/<span class="number">24</span>/<span class="number">08</span>      US      M  <span class="number">32</span>  <span class="number">5</span>  <span class="number">4</span>  <span class="number">2</span>  <span class="number">5</span>  <span class="number">5</span></div><div class="line"><span class="number">2</span>       <span class="number">2</span> <span class="number">10</span>/<span class="number">28</span>/<span class="number">08</span>      US      <span class="literal">F</span>  <span class="number">45</span>  <span class="number">3</span>  <span class="number">5</span>  <span class="number">4</span>  <span class="number">3</span>  <span class="number">5</span></div><div class="line"><span class="number">3</span>       <span class="number">3</span> <span class="number">10</span>/<span class="number">01</span>/<span class="number">08</span>      UK      <span class="literal">F</span>  <span class="number">25</span>  <span class="number">3</span>  <span class="number">4</span>  <span class="number">3</span>  <span class="number">3</span>  <span class="number">3</span></div><div class="line"><span class="number">4</span>       <span class="number">4</span> <span class="number">10</span>/<span class="number">12</span>/<span class="number">08</span>   China      M  <span class="number">23</span>  <span class="number">2</span>  <span class="number">4</span>  <span class="number">4</span> <span class="literal">NA</span>  <span class="number">3</span></div><div class="line"><span class="number">5</span>       <span class="number">5</span> <span class="number">05</span>/<span class="number">01</span>/<span class="number">09</span>      UK      <span class="literal">F</span>  <span class="number">99</span>  <span class="number">1</span>  <span class="number">5</span>  <span class="number">3</span>  <span class="number">2</span> <span class="literal">NA</span></div></pre></td></tr></table></figure>
<p>现在删除q3与q4，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">&gt; myvars &lt;-names(leadership)%<span class="keyword">in</span>%c(<span class="string">"q3"</span>,<span class="string">"q4"</span>)</div><div class="line">&gt; newdata&lt;-leadership[!myvars]</div><div class="line">&gt; newdata</div><div class="line">  manager     date country gender age q1 q2 q5</div><div class="line"><span class="number">1</span>       <span class="number">1</span> <span class="number">10</span>/<span class="number">24</span>/<span class="number">08</span>      US      M  <span class="number">32</span>  <span class="number">5</span>  <span class="number">4</span>  <span class="number">5</span></div><div class="line"><span class="number">2</span>       <span class="number">2</span> <span class="number">10</span>/<span class="number">28</span>/<span class="number">08</span>      US      <span class="literal">F</span>  <span class="number">45</span>  <span class="number">3</span>  <span class="number">5</span>  <span class="number">5</span></div><div class="line"><span class="number">3</span>       <span class="number">3</span> <span class="number">10</span>/<span class="number">01</span>/<span class="number">08</span>      UK      <span class="literal">F</span>  <span class="number">25</span>  <span class="number">3</span>  <span class="number">4</span>  <span class="number">3</span></div><div class="line"><span class="number">4</span>       <span class="number">4</span> <span class="number">10</span>/<span class="number">12</span>/<span class="number">08</span>   China      M  <span class="number">23</span>  <span class="number">2</span>  <span class="number">4</span>  <span class="number">3</span></div><div class="line"><span class="number">5</span>       <span class="number">5</span> <span class="number">05</span>/<span class="number">01</span>/<span class="number">09</span>      UK      <span class="literal">F</span>  <span class="number">99</span>  <span class="number">1</span>  <span class="number">5</span> <span class="literal">NA</span></div></pre></td></tr></table></figure>
<p>names(leadership)生成了一个包含所有变量名的字符型微量，即<code>c(&quot;manager&quot;,&quot;date&quot;,&quot;country&quot;，&quot;gender&quot;，&quot;age&quot;，&quot;q1&quot;，&quot;q2&quot;，&quot;q3&quot;,&quot;q4&quot;,&quot;q5&quot;,&quot;stringsAsFactor&quot;)</code>，<code>names(leadership)%in%c(&quot;item3&quot;,&quot;item4&quot;)</code>返回了一个逻辑型向量，<code>names(leadership)``中每个匹配item3或item4的元素值为TRUE，反之为</code>FALSE，c(FALSE, FALSE, FALSE, FALSE,FALSE, FALSE, FALSE, TRUE, TRUE, FALSE)<code>，运算符非（!）将逻辑值反转：</code>c(TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, FALSE,FALSE, TRUE)<code>,</code>leadership[c(TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, FALSE, FALSE,TRUE)]`选择了逻辑值为TRUE的列，于是q3和q4被剔除了。</p>
<p>或者直接使用<code>-</code>号，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">&gt; newdata &lt;- leadership[c(-<span class="number">8</span>,-<span class="number">9</span>) ] <span class="comment">#直接在变量前加减号</span></div><div class="line">&gt; newdata</div><div class="line">  manager     date country gender age q1 q2 q5</div><div class="line"><span class="number">1</span>       <span class="number">1</span> <span class="number">10</span>/<span class="number">24</span>/<span class="number">08</span>      US      M  <span class="number">32</span>  <span class="number">5</span>  <span class="number">4</span>  <span class="number">5</span></div><div class="line"><span class="number">2</span>       <span class="number">2</span> <span class="number">10</span>/<span class="number">28</span>/<span class="number">08</span>      US      <span class="literal">F</span>  <span class="number">45</span>  <span class="number">3</span>  <span class="number">5</span>  <span class="number">5</span></div><div class="line"><span class="number">3</span>       <span class="number">3</span> <span class="number">10</span>/<span class="number">01</span>/<span class="number">08</span>      UK      <span class="literal">F</span>  <span class="number">25</span>  <span class="number">3</span>  <span class="number">4</span>  <span class="number">3</span></div><div class="line"><span class="number">4</span>       <span class="number">4</span> <span class="number">10</span>/<span class="number">12</span>/<span class="number">08</span>   China      M  <span class="number">23</span>  <span class="number">2</span>  <span class="number">4</span>  <span class="number">3</span></div><div class="line"><span class="number">5</span>       <span class="number">5</span> <span class="number">05</span>/<span class="number">01</span>/<span class="number">09</span>      UK      <span class="literal">F</span>  <span class="number">99</span>  <span class="number">1</span>  <span class="number">5</span> <span class="literal">NA</span></div></pre></td></tr></table></figure>
<h2 id="增加行">增加行</h2>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">rat.data1&lt;-rbind(rat.data1,rat.data1)</div><div class="line">rat.data1</div></pre></td></tr></table></figure>
<blockquote>
<p> rat.data1&lt;-rbind(rat.data1,rat.data1)  rat.data1    rats glu.d1 glu.d7 1     1  11.97  12.97 2     2  12.97  13.97 3     3  27.34  25.56 4     4  23.97  23.97 5     5   6.79   5.79 6     6   5.19   6.19 7     1  11.97  12.97 8     2  12.97  13.97 9     3  27.34  25.56 10    4  23.97  23.97 11    5   6.79   5.79 12    6   5.19   6.19</p>
</blockquote>
<h2 id="删除行">删除行</h2>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">rat.data1&lt;-rat.data1[-<span class="number">8</span>,] <span class="comment">#删除第8行</span></div><div class="line">rat.data1[-c(<span class="number">1</span>,<span class="number">2</span>),] <span class="comment">#删除1，2行</span></div></pre></td></tr></table></figure>
<blockquote>
<p> rat.data1&lt;-rat.data1[-8,] #删除第8行  rat.data1[-c(1,2),] #删除1，2行    rats glu.d1 glu.d7 3     3  27.34  25.56 4     4  23.97  23.97 5     5   6.79   5.79 6     6   5.19   6.19 7     1  11.97  12.97 9     3  27.34  25.56 10    4  23.97  23.97 11    5   6.79   5.79 12    6   5.19   6.19</p>
</blockquote>
<h2 id="数据框的排序">数据框的排序</h2>
<h3 id="基于单列进行排序">基于单列进行排序</h3>
<p>排序所用的函数为sort()和order(),sort()是对元素直接进行排序，而order()则是反回排序后的元素在原来列中的位置，现在以内置的CO2数据为例说明，只取CO2的前10行：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">raw_data &lt;- CO2[<span class="number">1</span>:<span class="number">10</span>,]</div><div class="line">raw_data</div><div class="line">sort(raw_data$uptake) <span class="comment">#对uptake进行排序，默认为升序</span></div><div class="line">sort(raw_data$uptake,decreasing = <span class="literal">TRUE</span>) <span class="comment"># decreasing为T时，为降序</span></div><div class="line">order.raw_data &lt;- order(raw_data$uptake);order.raw_data</div><div class="line"><span class="comment"># order的结果是说，在排序后的数据中，第1个元素位于原来的第8个位置</span></div><div class="line"><span class="comment"># 排序后的第1个数据是13.6，而13.6在原来uptake中位于第8</span></div><div class="line">raw_data$uptake[order.raw_data] <span class="comment">#这个结果与sort(raw_data$uptake)是一样的</span></div><div class="line">raw_data[order.raw_data,] <span class="comment">#按照uptake的升序对数据框进行排序</span></div></pre></td></tr></table></figure>
<blockquote>
<p> raw_data &lt;- CO2[1:10,]  raw_data    Plant   Type  Treatment conc uptake 1    Qn1 Quebec nonchilled   95   16.0 2    Qn1 Quebec nonchilled  175   30.4 3    Qn1 Quebec nonchilled  250   34.8 4    Qn1 Quebec nonchilled  350   37.2 5    Qn1 Quebec nonchilled  500   35.3 6    Qn1 Quebec nonchilled  675   39.2 7    Qn1 Quebec nonchilled 1000   39.7 8    Qn2 Quebec nonchilled   95   13.6 9    Qn2 Quebec nonchilled  175   27.3 10   Qn2 Quebec nonchilled  250   37.1  sort(raw_data<span class="math inline">\(uptake) #对uptake进行排序，默认为升序  [1] 13.6 16.0 27.3 30.4 34.8 35.3 37.1 37.2 39.2 39.7  sort(raw_data\)</span>uptake,decreasing = TRUE) # decreasing为T时，为降序  [1] 39.7 39.2 37.2 37.1 35.3 34.8 30.4 27.3 16.0 13.6  order.raw_data &lt;- order(raw_data$uptake);order.raw_data  [1]  8  1  9  2  3  5 10  4  6  7</p>
</blockquote>
<blockquote>
<p>   order的结果是说，在排序后的数据中，第1个元素位于原来的第8个位置</p>
</blockquote>
<blockquote>
<p>   排序后的第1个数据是13.6，而13.6在原来uptake中位于第8</p>
</blockquote>
<blockquote>
<p> raw_data$uptake[order.raw_data] #这个结果与sort(raw_data$uptake)是一样的  [1] 13.6 16.0 27.3 30.4 34.8 35.3 37.1 37.2 39.2 39.7  raw_data[order.raw_data,] #按照uptake的升序对数据框进行排序    Plant   Type  Treatment conc uptake 8    Qn2 Quebec nonchilled   95   13.6 1    Qn1 Quebec nonchilled   95   16.0 9    Qn2 Quebec nonchilled  175   27.3 2    Qn1 Quebec nonchilled  175   30.4 3    Qn1 Quebec nonchilled  250   34.8 5    Qn1 Quebec nonchilled  500   35.3 10   Qn2 Quebec nonchilled  250   37.1 4    Qn1 Quebec nonchilled  350   37.2 6    Qn1 Quebec nonchilled  675   39.2 7    Qn1 Quebec nonchilled 1000   39.7</p>
</blockquote>
<h3 id="基于多列的排序">基于多列的排序</h3>
<p>还以前述的数据为例说明：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">order.raw_data2 &lt;- with(raw_data,order(conc,uptake))</div><div class="line">raw_data[order.raw_data2,]</div><div class="line"></div><div class="line">order.raw_data3 &lt;- with(raw_data,order(uptake,conc))</div><div class="line">raw_data[order.raw_data3,]</div></pre></td></tr></table></figure>
<blockquote>
<p> order.raw_data2 &lt;- with(raw_data,order(conc,uptake))  raw_data[order.raw_data2,]    Plant   Type  Treatment conc uptake 8    Qn2 Quebec nonchilled   95   13.6 1    Qn1 Quebec nonchilled   95   16.0 9    Qn2 Quebec nonchilled  175   27.3 2    Qn1 Quebec nonchilled  175   30.4 3    Qn1 Quebec nonchilled  250   34.8 10   Qn2 Quebec nonchilled  250   37.1 4    Qn1 Quebec nonchilled  350   37.2 5    Qn1 Quebec nonchilled  500   35.3 6    Qn1 Quebec nonchilled  675   39.2 7    Qn1 Quebec nonchilled 1000   39.7</p>
<p> order.raw_data3 &lt;- with(raw_data,order(uptake,conc))  raw_data[order.raw_data3,]    Plant   Type  Treatment conc uptake 8    Qn2 Quebec nonchilled   95   13.6 1    Qn1 Quebec nonchilled   95   16.0 9    Qn2 Quebec nonchilled  175   27.3 2    Qn1 Quebec nonchilled  175   30.4 3    Qn1 Quebec nonchilled  250   34.8 5    Qn1 Quebec nonchilled  500   35.3 10   Qn2 Quebec nonchilled  250   37.1 4    Qn1 Quebec nonchilled  350   37.2 6    Qn1 Quebec nonchilled  675   39.2 7    Qn1 Quebec nonchilled 1000   39.7</p>
</blockquote>
<p>可以看出来，在第1种排序中， with(raw_data,order(conc,uptake))，先以order进行排序，如果order相同，则按照uptake进行排序；在第2种排序中，with(raw_data,order(uptake,conc))，先以uptake进行排序，如果uptake相同，则按conc进行排序。</p>
<h3 id="混合排序">混合排序</h3>
<p>混合排序是指某一列是升序，某一列为降序，所用到的函数是xtfrm()，其中在需要降序的列前加上铅，在升序的列前加正号，现在以raw_data数据为例说明，以conc的降序，uptake的升序进行排序，用法如下：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">order.raw_data4 &lt;- order(-xtfrm(raw_data$conc),+raw_data$uptake)</div><div class="line">raw_data[order.raw_data4,]</div></pre></td></tr></table></figure>
<blockquote>
<p> order.raw_data4 &lt;- order(-xtfrm(raw_data<span class="math inline">\(conc),+raw_data\)</span>uptake)  raw_data[order.raw_data4,]    Plant   Type  Treatment conc uptake 7    Qn1 Quebec nonchilled 1000   39.7 6    Qn1 Quebec nonchilled  675   39.2 5    Qn1 Quebec nonchilled  500   35.3 4    Qn1 Quebec nonchilled  350   37.2 3    Qn1 Quebec nonchilled  250   34.8 10   Qn2 Quebec nonchilled  250   37.1 9    Qn2 Quebec nonchilled  175   27.3 2    Qn1 Quebec nonchilled  175   30.4 8    Qn2 Quebec nonchilled   95   13.6 1    Qn1 Quebec nonchilled   95   16.0</p>
</blockquote>
<h1 id="因子">因子</h1>
<h2 id="因子定义">因子定义</h2>
<p>因子(factor)：是名义型变量或有序型变量，比较特殊。一个因子不仅包括分类变量本身还包括变量不同的可能水平（即使它们在数据中不出现）。</p>
<h2 id="factor用法">factor()用法</h2>
<p><code>factor (x,levels=sort(unique(x),na.last=TRUE), labels=lebels, exclude=NA, ordered=is.order (x))</code></p>
<p>其中，levels用于指定因子的可能水平，labels用于定义水平的名字；exclude指从向量x中剔除的水平值，ordered指因子的水平是否要排序，例如:</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">a &lt;- factor(<span class="number">1</span>:<span class="number">3</span>)</div><div class="line">a</div><div class="line"><span class="comment">## [1] 1 2 3</span></div><div class="line"><span class="comment">## Levels: 1 2 3</span></div></pre></td></tr></table></figure>
<p>从上面的结果可以看出，这组数据中有3个数据，3个水平，分别为1，2，3。还有一种情况是，水平数大于实际的数据数，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">b&lt;-factor(<span class="number">1</span>:<span class="number">3</span>,levels=<span class="number">1</span>:<span class="number">5</span>);b</div><div class="line"><span class="comment">## [1] 1 2 3</span></div><div class="line"><span class="comment">## Levels: 1 2 3 4 5</span></div></pre></td></tr></table></figure>
<p>这组数据中有3个数据，有5个水平（其中两个水平没出现）。</p>
<h2 id="factor数据的名称">factor数据的名称</h2>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">c&lt;-factor(<span class="number">1</span>:<span class="number">3</span>,labels=c(<span class="string">"a"</span>,<span class="string">"b"</span>,<span class="string">"c"</span>))</div><div class="line">c</div><div class="line"><span class="comment">## [1] a b c</span></div><div class="line"><span class="comment">## Levels: a b </span></div><div class="line">&gt; str(c)</div><div class="line"> Factor w/ <span class="number">3</span> levels <span class="string">"a"</span>,<span class="string">"b"</span>,<span class="string">"c"</span>: <span class="number">1</span> <span class="number">2</span> <span class="number">3</span></div></pre></td></tr></table></figure>
<p>c有三个水平，名字分别为a,b,c</p>
<h2 id="将factor转化为其它类型">将factor转化为其它类型</h2>
<h3 id="数值型">数值型</h3>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">d&lt;-c(<span class="number">1</span>,<span class="number">10</span>) <span class="comment">#建立向量a,值为1,10</span></div><div class="line">d</div><div class="line"><span class="comment">## [1]  1 10</span></div><div class="line">fac&lt;-factor(d)</div><div class="line">fac <span class="comment">#提取向量a的因子数，并赋给fac</span></div><div class="line"><span class="comment">## [1] 1  10</span></div><div class="line"><span class="comment">## Levels: 1 10</span></div><div class="line">fac_value&lt;-as.numeric(fac) <span class="comment">#将fac转化为数值</span></div><div class="line">fac</div><div class="line"><span class="comment">## [1] 1  10</span></div><div class="line"><span class="comment">## Levels: 1 10</span></div></pre></td></tr></table></figure>
<h3 id="字符型">字符型</h3>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">e&lt;-c(<span class="string">"Male"</span>,<span class="string">"Female"</span>)</div><div class="line">e  <span class="comment">#建立向量e，为字符型</span></div><div class="line"><span class="comment">## [1] "Male"   "Female"</span></div><div class="line">fac_e&lt;-factor(e);fac_e <span class="comment">#提取向量b的因子，并且赋给fac2</span></div><div class="line"><span class="comment">## [1] Male   Female</span></div><div class="line"><span class="comment">## Levels: Female Male</span></div><div class="line">fac_e_value&lt;-as.numeric(fac_e)<span class="comment">#将fac_e转化为数值型</span></div><div class="line">fac_e_value</div><div class="line"><span class="comment">## [1] 2 1</span></div></pre></td></tr></table></figure>
<h3 id="将factor转换为数值">将factor转换为数值</h3>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">as.numeric(as.character(fac))</div><div class="line"><span class="comment">## [1]  1 10</span></div></pre></td></tr></table></figure>
<p>上述命令将fac(1,10)先转化为字符型，接着将字符型转化为数值型，如果直接将factor转换为numeric，容易出错，一般情况下就是先看factor转换为character，再转换为numeric。</p>
<h2 id="将其它数据转换为factor">将其它数据转换为factor</h2>
<h3 id="将字符转换为因子">将字符转换为因子</h3>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">a &lt;- c(<span class="string">"green"</span>,<span class="string">"blue"</span>,<span class="string">"green"</span>,<span class="string">"yellow"</span>)</div><div class="line">a &lt;- factor(a)</div><div class="line">levels(a) &lt;- c(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>)</div><div class="line">ff &lt;- factor(c(<span class="string">"A"</span>,<span class="string">"B"</span>,<span class="string">"C"</span>,labels=c(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>)))</div><div class="line">ff</div><div class="line"></div><div class="line"><span class="comment">##                         labels1 labels2 labels3 </span></div><div class="line"><span class="comment">##       A       BC       1       23 </span></div><div class="line"><span class="comment">## Levels: 1 2 3 A B C</span></div></pre></td></tr></table></figure>
<h3 id="将数值转换为因子">将数值转换为因子</h3>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">b &lt;- c(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">1</span>)</div><div class="line">b &lt;- factor(b)</div><div class="line">b</div><div class="line"></div><div class="line"><span class="comment">## [1] 1 2 3 1</span></div><div class="line"><span class="comment">## Levels: 1 2 3</span></div></pre></td></tr></table></figure>
<h3 id="提取可能的factor">提取可能的factor</h3>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">ff &lt;- factor(c(<span class="number">2</span>,<span class="number">4</span>),levels=<span class="number">2</span>:<span class="number">5</span>)</div><div class="line">ff</div><div class="line"></div><div class="line"><span class="comment">## [1] 2 4</span></div><div class="line"><span class="comment">## Levels: 2 3 4 5</span></div><div class="line"></div><div class="line">levels(ff)</div><div class="line"></div><div class="line"><span class="comment">## [1] "2" "3" "4" "5"</span></div></pre></td></tr></table></figure>
<h3 id="生成指定的factor">生成指定的factor</h3>
<h4 id="seq-1">seq()</h4>
<p>在R的向量笔记中，提到了seq()函数用来生成某一条件的向量，这个函数在生成特定因子方面也有很重要的作用，用法为<code>seq(length=, from=, to=)</code>，其中，length:指定生成个数，from:是指开始生成的点，to:截止点。如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">seq(length=<span class="number">10</span>,from=<span class="number">10</span>,to=<span class="number">100</span>) <span class="comment"># 生成从10到100的向量，一共10个</span></div><div class="line"><span class="comment">##  [1]10  20  3040  50  6070  80  90 100</span></div><div class="line"><span class="comment"># 上述命令等价于</span></div><div class="line"></div><div class="line">seq(<span class="number">10</span>,<span class="number">100</span>,<span class="number">10</span>)</div><div class="line"><span class="comment">##  [1]10  20  3040  50  6070  80  90 100</span></div><div class="line"></div><div class="line">seq(<span class="number">1</span>,<span class="number">10</span>,by=<span class="number">2</span>)</div><div class="line"><span class="comment">## [1] 1 3 5 7 9</span></div><div class="line"></div><div class="line">seq(<span class="number">1</span>,<span class="number">10</span>,length=<span class="number">6</span>)</div><div class="line"><span class="comment">## [1]  1.02.8  4.6  6.48.2 10.0</span></div><div class="line"></div><div class="line">sequence(<span class="number">2</span>:<span class="number">3</span>) <span class="comment">#产生以 2 和 3 结尾的序列数据</span></div><div class="line"><span class="comment">## [1] 1 2 1 2 3</span></div></pre></td></tr></table></figure>
<h4 id="rep-1">rep()</h4>
<p>用法：<code>rep(P，N)</code>，表示重复生成P值N次，例如rep(a1:a2,a1:a2) #重复a1到a2，按a1产生a1次，按a2产生a2次，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">rep(<span class="number">1</span>,<span class="number">10</span>)</div><div class="line"><span class="comment">##  [1] 1 1 1 1 1 1 1 1 1 1</span></div><div class="line"></div><div class="line">rep(<span class="number">1</span>:<span class="number">5</span>,each=<span class="number">2</span>, times=<span class="number">2</span>) <span class="comment">#重复1到5，每个元素重复二次，整个数列重复两次</span></div><div class="line"><span class="comment">##  [1] 1 1 2 2 3 3 4 4 5 5 1 1 2 2 3 3 4 4 5 5</span></div><div class="line"></div><div class="line">rep(<span class="number">1</span>:<span class="number">3</span>,<span class="number">1</span>:<span class="number">3</span>) <span class="comment"># 1重复1次，2重复2次，3重复3次</span></div><div class="line"><span class="comment">## [1] 1 2 2 3 3 3</span></div></pre></td></tr></table></figure>
<h4 id="gl函数">gl函数</h4>
<p>生成规则的因子序列，gl(k,n)：k为水平数据，n是每个水平重复的次数。如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">gl(<span class="number">3</span>,<span class="number">5</span>) <span class="comment">#生成5个1，5个2，5个3，</span></div><div class="line"></div><div class="line"><span class="comment">##  [1] 1 1 1 1 1 2 2 2 2 2 3 3 3 3 3</span></div><div class="line"><span class="comment">## Levels: 1 2 3</span></div><div class="line"></div><div class="line">gl(<span class="number">3</span>,<span class="number">5</span>,length=<span class="number">30</span>) <span class="comment">#生成5个1，5个2，5个3，循环到30个，即：</span></div><div class="line"></div><div class="line"><span class="comment">##  [1] 1 1 1 1 1 2 2 2 2 2 3 3 3 3 3 1 1 1 1 1 2 2 2 2 2 3 3 3 3 3</span></div><div class="line"><span class="comment">## Levels: 1 2 3</span></div><div class="line"></div><div class="line">gl(<span class="number">2</span>,<span class="number">6</span>,label=c(<span class="string">"Male"</span>,<span class="string">"Female"</span>)) <span class="comment">#生成Male与Female两个因子，各6个，共12个数据：</span></div><div class="line"></div><div class="line"><span class="comment">##  [1] MaleMale   Male   MaleMale   Male   Female Female Female Female</span></div><div class="line"><span class="comment">## [11] Female Female</span></div><div class="line"><span class="comment">## Levels: Male Female</span></div></pre></td></tr></table></figure>
<h2 id="有序因子">有序因子</h2>
<p>因子没有顺序，但也可以人为指定顺序。例如糖尿病类型Diabetes(Type1,Type2)，就是2种类型没有顺序，但病人状态status(Poor,Imporved,Excellent)是有顺序的。案例如下：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">patientID&lt;-c(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>)</div><div class="line">age&lt;-c(<span class="number">25</span>,<span class="number">34</span>,<span class="number">28</span>,<span class="number">52</span>)</div><div class="line">diabetes&lt;-c(<span class="string">"Type1"</span>,<span class="string">"Type2"</span>,<span class="string">"Type1"</span>,<span class="string">"Type1"</span>)</div><div class="line">status&lt;-c(<span class="string">"Poor"</span>,<span class="string">"Improved"</span>,<span class="string">"Excellent"</span>,<span class="string">"Poor"</span>)</div><div class="line">diabetes&lt;-factor(diabetes) <span class="comment">#提取不同糖尿病类型的因子</span></div><div class="line">status&lt;-factor(status,order=<span class="literal">TRUE</span>) <span class="comment"># 提取因子，并且有序</span></div><div class="line">patientdata&lt;-data.frame(patientID,age,diabetes,status)</div><div class="line">patientdata</div><div class="line"></div><div class="line"><span class="comment">##   patientID age diabetes    status</span></div><div class="line"><span class="comment">## 11  25    Type1Poor</span></div><div class="line"><span class="comment">## 22  34    Type2Improved</span></div><div class="line"><span class="comment">## 33  28    Type1 Excellent</span></div><div class="line"><span class="comment">## 44  52    Type1Poor</span></div></pre></td></tr></table></figure>
<p>注：字符型向量的因子水平默认依字母顺序创建。但在实际情况中并不常用，而是通过levels选项来指定因子顺序，使用factor(status, order = TRUE, levels = c(“Poor”, “Improved”, “Excellent”))，各个水平的赋值就为1 = Poor, 2 = Improved, 3 = Excellent。或者是通过下面代码实现：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">factor(status, ordered = <span class="literal">TRUE</span>, levels = c(<span class="string">"Poor"</span>, <span class="string">"Improved"</span>, <span class="string">"Excellent"</span>))</div><div class="line"></div><div class="line"><span class="comment">## [1] Poor      ImprovedExcellent Poor     </span></div><div class="line"><span class="comment">## Levels: Poor &lt; Improved &lt; Excellent</span></div><div class="line"></div><div class="line">str(patientdata)<span class="comment">#显示数据框的结构</span></div><div class="line"></div><div class="line"><span class="comment">## 'data.frame':    4 obs. of  4 variables:</span></div><div class="line"><span class="comment">##  $ patientID: num  1 2 3 4</span></div><div class="line"><span class="comment">##  $ age      : num25 34 28 52</span></div><div class="line"><span class="comment">##  $ diabetes : Factor w/ 2 levels "Type1","Type2": 1 2 1 1</span></div><div class="line"><span class="comment">##  $ status   : Ord.factor w/ 3 levels "Excellent"&lt;"Improved"&lt;..: 3 2 1 3</span></div><div class="line"></div><div class="line">summary(patientdata)</div><div class="line"></div><div class="line"><span class="comment">##    patientID         age         diabetes       status </span></div><div class="line"><span class="comment">##  Min.   :1.00Min.   :25.00   Type1:3Excellent:1  </span></div><div class="line"><span class="comment">##  1st Qu.:1.75   1st Qu.:27.25   Type2:1Improved :1  </span></div><div class="line"><span class="comment">##  Median :2.50   Median :31.00             Poor     :2  </span></div><div class="line"><span class="comment">##  Mean   :2.50Mean   :34.75                          </span></div><div class="line"><span class="comment">##  3rd Qu.:3.25   3rd Qu.:38.50                          </span></div><div class="line"><span class="comment">##  Max.   :4.00Max.   :52.00</span></div></pre></td></tr></table></figure>
<h2 id="factor的统计">factor的统计</h2>
<p>如果一组数据有多个重复值，例如美国的每一个州都位于4个区域的中某一个，分别为东北，南、中北和西，则我们看一下内置的state数据集：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">head(state.region)</div><div class="line"></div><div class="line"><span class="comment">## [1] South West  West  South WestWest </span></div><div class="line"><span class="comment">## Levels: Northeast South North Central West</span></div><div class="line"></div><div class="line">table(state.region)</div><div class="line"></div><div class="line"><span class="comment">## state.region</span></div><div class="line"><span class="comment">##Northeast         South North Central          West </span></div><div class="line"><span class="comment">##9            16            12            13</span></div></pre></td></tr></table></figure>
<h1 id="列表">列表</h1>
<h2 id="什么是列表">什么是列表</h2>
<p>列表(list)为最复杂的数据类型，是一些对象或成分的有序集合，例如可以是向量，矩阵，数据框，或其他列表的组合。用<code>list()</code>创建：<code>mylist&lt;-list(object1,object2,...)</code>， 或命名列表：<code>mylist&lt;-list(name1=object1,name2=object2,...)</code>。</p>
<h2 id="创建列表">创建列表</h2>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"> g&lt;-<span class="string">"My First List"</span></div><div class="line">h&lt;-c(<span class="number">25</span>,<span class="number">26</span>,<span class="number">18</span>,<span class="number">39</span>)</div><div class="line">j&lt;-matrix(<span class="number">1</span>:<span class="number">10</span>,nrow=<span class="number">5</span>)</div><div class="line">k&lt;-c(<span class="string">"one"</span>,<span class="string">"two"</span>,<span class="string">"three"</span>)</div><div class="line">mylist&lt;-list(title=g,ages=h,j,k)</div><div class="line">mylist <span class="comment">#输出列表</span></div><div class="line"></div><div class="line"><span class="comment">## $title</span></div><div class="line"><span class="comment">## [1] "My First List"</span></div><div class="line"><span class="comment">## </span></div><div class="line"><span class="comment">## $ages</span></div><div class="line"><span class="comment">## [1] 25 26 18 39</span></div><div class="line"><span class="comment">## </span></div><div class="line"><span class="comment">## [[3]]</span></div><div class="line"><span class="comment">##      [,1] [,2]</span></div><div class="line"><span class="comment">## [1,]1    6</span></div><div class="line"><span class="comment">## [2,]2    7</span></div><div class="line"><span class="comment">## [3,]3    8</span></div><div class="line"><span class="comment">## [4,]4    9</span></div><div class="line"><span class="comment">## [5,]5   10</span></div><div class="line"><span class="comment">## </span></div><div class="line"><span class="comment">## [[4]]</span></div><div class="line"><span class="comment">## [1] "one"   "two"   "three"</span></div></pre></td></tr></table></figure>
<h3 id="显示列表数据">显示列表数据</h3>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">mylist[<span class="number">1</span>]</div><div class="line"><span class="comment">## $title</span></div><div class="line"><span class="comment">## [1] "My First List"</span></div><div class="line"></div><div class="line">mylist[<span class="number">2</span>]</div><div class="line"><span class="comment">## $ages</span></div><div class="line"><span class="comment">## [1] 25 26 18 39</span></div><div class="line"></div><div class="line">mylist[[<span class="number">2</span>]]</div><div class="line"><span class="comment">## [1] 25 26 18 39</span></div><div class="line"></div><div class="line">mylist[<span class="string">"ages"</span>]</div><div class="line"><span class="comment">## $ages</span></div><div class="line"><span class="comment">## [1] 25 26 18 39</span></div></pre></td></tr></table></figure>
<h1 id="矩阵">矩阵</h1>
<h2 id="矩阵定义">矩阵定义</h2>
<p>矩阵是一个二维数组，只是每个元素都拥有相同的模式（数值型、字符型或逻辑型）。可通过函数<code>matrix()</code>创建矩阵。一般使用格式为：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">myymatrix &lt;- matrix(vector, nrow=number_of_rows, ncol=number_of_columns, </div><div class="line">                    byrow=logical_value, dimnames=list(  </div><div class="line">                      char_vector_rownames, char_vector_colnames))</div></pre></td></tr></table></figure>
<p>其中vector包含了矩阵的元素，nrow和ncol用以指定行和列的维数，dimnames包含了可选的、以字符型向量表示的行名和列名。选项 byrow 则表明矩阵应当按行填充（ byrow=TRUE ）还是按列填充（ byrow=FALSE ），默认情况下按列填充。</p>
<h2 id="创建矩阵">创建矩阵</h2>
<h3 id="matrix">matrix()</h3>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&gt; a&lt;-matrix(c(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>),nrow=<span class="number">2</span>,byrow=<span class="literal">T</span>)</div><div class="line">&gt; a</div><div class="line">     [,<span class="number">1</span>] [,<span class="number">2</span>] [,<span class="number">3</span>]</div><div class="line">[<span class="number">1</span>,]    <span class="number">1</span>    <span class="number">2</span>    <span class="number">3</span></div><div class="line">[<span class="number">2</span>,]    <span class="number">4</span>    <span class="number">5</span>    <span class="number">6</span></div></pre></td></tr></table></figure>
<h3 id="dim">dim()</h3>
<p>通过dim来创建，先生成向量x，接着给向量x适当的维数，此例子中给向量的维数为5行，3列：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">&gt; x &lt;- <span class="number">1</span>:<span class="number">15</span></div><div class="line">&gt; x <span class="comment"># 建立x</span></div><div class="line"> [<span class="number">1</span>]  <span class="number">1</span>  <span class="number">2</span>  <span class="number">3</span>  <span class="number">4</span>  <span class="number">5</span>  <span class="number">6</span>  <span class="number">7</span>  <span class="number">8</span>  <span class="number">9</span> <span class="number">10</span> <span class="number">11</span> <span class="number">12</span> <span class="number">13</span> <span class="number">14</span> <span class="number">15</span></div><div class="line">&gt; x &lt;- <span class="number">1</span>:<span class="number">15</span></div><div class="line">&gt; x <span class="comment"># 建立x</span></div><div class="line"> [<span class="number">1</span>]  <span class="number">1</span>  <span class="number">2</span>  <span class="number">3</span>  <span class="number">4</span>  <span class="number">5</span>  <span class="number">6</span>  <span class="number">7</span>  <span class="number">8</span>  <span class="number">9</span> <span class="number">10</span> <span class="number">11</span> <span class="number">12</span> <span class="number">13</span> <span class="number">14</span> <span class="number">15</span></div><div class="line">&gt; dim(x) <span class="comment">#查看x的维度</span></div><div class="line"><span class="literal">NULL</span></div><div class="line">&gt; dim(x) &lt;- c(<span class="number">5</span>,<span class="number">3</span>) <span class="comment"># 将向量x转化为5行3列的矩阵</span></div><div class="line">&gt; x</div><div class="line">     [,<span class="number">1</span>] [,<span class="number">2</span>] [,<span class="number">3</span>]</div><div class="line">[<span class="number">1</span>,]    <span class="number">1</span>    <span class="number">6</span>   <span class="number">11</span></div><div class="line">[<span class="number">2</span>,]    <span class="number">2</span>    <span class="number">7</span>   <span class="number">12</span></div><div class="line">[<span class="number">3</span>,]    <span class="number">3</span>    <span class="number">8</span>   <span class="number">13</span></div><div class="line">[<span class="number">4</span>,]    <span class="number">4</span>    <span class="number">9</span>   <span class="number">14</span></div><div class="line">[<span class="number">5</span>,]    <span class="number">5</span>   <span class="number">10</span>   <span class="number">15</span></div></pre></td></tr></table></figure>
<h3 id="矩阵命名">矩阵命名</h3>
<p>用法：Dimnames(Row_name,Col_name)，给定行和列的名称,如果不需要给行或者列命名，则以NULL代替。例如：给下面的矩阵列命令：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">a&lt;-c(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>);a</div><div class="line"><span class="comment">## [1] 1 2 3 4 5 6</span></div><div class="line"></div><div class="line">a&lt;-matrix(a,nrow=<span class="number">2</span>,byrow=<span class="literal">T</span>,dimnames=list(c(<span class="string">'a'</span>,<span class="string">'b'</span>),c(<span class="string">'A'</span>,<span class="string">'B'</span>,<span class="string">'C'</span>)));a</div><div class="line"><span class="comment">##   A B C</span></div><div class="line"><span class="comment">## a 1 2 3</span></div><div class="line"><span class="comment">## b 4 5 6</span></div></pre></td></tr></table></figure>
<p>用rownames与colnames实现</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">b&lt;-c(<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>) <span class="comment"># 建立向量b</span></div><div class="line">b</div><div class="line"><span class="comment">## [1] 2 3 4 5 6 7</span></div><div class="line"></div><div class="line">b&lt;-matrix(b,nrow=<span class="number">2</span>) <span class="comment"># 将向量b转化为矩阵</span></div><div class="line">b</div><div class="line"><span class="comment">##      [,1] [,2] [,3]</span></div><div class="line"><span class="comment">## [1,]2    4    6</span></div><div class="line"><span class="comment">## [2,]3    5    7</span></div><div class="line"></div><div class="line">rownames(b)&lt;-c(<span class="string">"row_1"</span>,<span class="string">"row_2"</span>) <span class="comment"># 将矩阵行命名</span></div><div class="line">colnames(b)&lt;-c(<span class="string">"col_1"</span>,<span class="string">"col_2"</span>,<span class="string">"col_3"</span>) <span class="comment"># 将矩阵的列命名</span></div><div class="line">b</div><div class="line"><span class="comment">##       col_1 col_2 col_3</span></div><div class="line"><span class="comment">## row_12     4     6</span></div><div class="line"><span class="comment">## row_23     5     7</span></div></pre></td></tr></table></figure>
<h2 id="查看矩阵">查看矩阵</h2>
<h3 id="查看矩阵的列行相关信息">查看矩阵的列/行相关信息</h3>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">colnames(a) <span class="comment"># 查看矩阵列名</span></div><div class="line"><span class="comment">## [1] "A" "B" "C"</span></div><div class="line"></div><div class="line">rownames(a) <span class="comment"># 查看矩阵行名</span></div><div class="line"><span class="comment">## [1] "a" "b"</span></div></pre></td></tr></table></figure>
<h3 id="查看矩阵的维度">查看矩阵的维度</h3>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">dim(a) <span class="comment"># 返回行与列数</span></div><div class="line"><span class="comment">## [1] 2 3</span></div><div class="line"></div><div class="line">nrow(a) <span class="comment"># 返回行数</span></div><div class="line"><span class="comment">## [1] 2</span></div><div class="line"></div><div class="line">ncol(a) <span class="comment"># 返回列数</span></div><div class="line"><span class="comment">## [1] 3</span></div></pre></td></tr></table></figure>
<h2 id="条件提取子矩阵">条件提取子矩阵</h2>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div></pre></td><td class="code"><pre><div class="line">a <span class="comment"># 查看矩阵a</span></div><div class="line"></div><div class="line"><span class="comment">##   A B C</span></div><div class="line"><span class="comment">## a 1 2 3</span></div><div class="line"><span class="comment">## b 4 5 6</span></div><div class="line"></div><div class="line">a[<span class="number">2</span>,<span class="number">3</span>] <span class="comment">#取矩阵a的第2列，第3个元素</span></div><div class="line"></div><div class="line"><span class="comment">## [1] 6</span></div><div class="line"></div><div class="line"> a[,<span class="number">1</span>] <span class="comment">#取矩阵a的第1列</span></div><div class="line"></div><div class="line"><span class="comment">## a b </span></div><div class="line"><span class="comment">## 1 4</span></div><div class="line"></div><div class="line">a[<span class="number">1</span>,] <span class="comment"># 取矩阵a的第1行</span></div><div class="line"></div><div class="line"><span class="comment">## A B C </span></div><div class="line"><span class="comment">## 1 2 3</span></div><div class="line"></div><div class="line">c&lt;-a[a[,<span class="number">2</span>]&gt;<span class="number">4</span>] <span class="comment"># 取矩阵a第2行并且大于4的元素，并将其赋值给c</span></div><div class="line">c</div><div class="line"></div><div class="line"><span class="comment">## [1] 4 5 6</span></div><div class="line"></div><div class="line">x&lt;-c(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">8</span>)</div><div class="line">x&lt;-matrix(x,nrow=<span class="number">3</span>)</div><div class="line">x</div><div class="line"></div><div class="line"><span class="comment">##      [,1] [,2] [,3]</span></div><div class="line"><span class="comment">## [1,]1    4    7</span></div><div class="line"><span class="comment">## [2,]2    5    8</span></div><div class="line"><span class="comment">## [3,]3    6    8</span></div><div class="line"></div><div class="line">x[,<span class="number">3</span>] <span class="comment"># 选取矩阵的第3列</span></div><div class="line"></div><div class="line"><span class="comment">## [1] 7 8 8</span></div><div class="line"></div><div class="line">x[<span class="number">3</span>,] <span class="comment"># 选取矩阵的第3行</span></div><div class="line"></div><div class="line"><span class="comment">## [1] 3 6 8</span></div><div class="line"></div><div class="line">y&lt;-x[,<span class="number">3</span>,drop=<span class="literal">FALSE</span>] <span class="comment"># 选取x矩阵的第3列，并返回一个矩阵给y</span></div><div class="line">y</div><div class="line"></div><div class="line"><span class="comment">##      [,1]</span></div><div class="line"><span class="comment">## [1,]    7</span></div><div class="line"><span class="comment">## [2,]    8</span></div><div class="line"><span class="comment">## [3,]    8</span></div><div class="line"></div><div class="line">x[,-<span class="number">1</span>] <span class="comment"># 不显示矩阵的第1列</span></div><div class="line"></div><div class="line"><span class="comment">##      [,1] [,2]</span></div><div class="line"><span class="comment">## [1,]4    7</span></div><div class="line"><span class="comment">## [2,]5    8</span></div><div class="line"><span class="comment">## [3,]6    8</span></div><div class="line"></div><div class="line">x[-<span class="number">1</span>,] <span class="comment"># 不显示矩阵的第1行</span></div><div class="line"></div><div class="line"><span class="comment">##      [,1] [,2] [,3]</span></div><div class="line"><span class="comment">## [1,]2    5    8</span></div><div class="line"><span class="comment">## [2,]3    6    8</span></div><div class="line"></div><div class="line">x[,-(<span class="number">1</span>:<span class="number">2</span>)] <span class="comment"># 不显示矩阵的第1，2列</span></div><div class="line"></div><div class="line"><span class="comment">## [1] 7 8 8</span></div><div class="line"></div><div class="line">z&lt;-x[,-(<span class="number">1</span>:<span class="number">2</span>),drop=<span class="literal">FALSE</span>] <span class="comment">#不显示矩阵x的第1，2列，并且返回为一矩阵y</span></div><div class="line">z</div><div class="line"></div><div class="line"><span class="comment">##      [,1]</span></div><div class="line"><span class="comment">## [1,]    7</span></div><div class="line"><span class="comment">## [2,]    8</span></div><div class="line"><span class="comment">## [3,]    8</span></div></pre></td></tr></table></figure>
<h2 id="提取矩阵的行或列">提取矩阵的行或列</h2>
<p><code>nrow</code>与<code>ncol</code>函数： nrow与ncol函数返回行或列的某一个数字。NCOL与NROW用于向量，即把向量作为单行的矩阵处理。 用法： nrow(x) ncol(x) NCOL(x) NROW(x) 参数： x：向量，或数据框； 值：长度为1或无的整数： 类似的有dim函数，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div></pre></td><td class="code"><pre><div class="line">ma &lt;- matrix(<span class="number">1</span>:<span class="number">12</span>, <span class="number">3</span>, <span class="number">4</span>);ma <span class="comment"># 建矩阵3行4列的矩阵</span></div><div class="line"></div><div class="line"><span class="comment">##      [,1] [,2] [,3] [,4]</span></div><div class="line"><span class="comment">## [1,]1    4    710</span></div><div class="line"><span class="comment">## [2,]2    5    811</span></div><div class="line"><span class="comment">## [3,]3    6    912</span></div><div class="line"></div><div class="line">nrow(ma)   <span class="comment"># 行数为3</span></div><div class="line"></div><div class="line"><span class="comment">## [1] 3</span></div><div class="line"></div><div class="line">ncol(ma)   <span class="comment"># 列数为4</span></div><div class="line"></div><div class="line"><span class="comment">## [1] 4</span></div><div class="line"></div><div class="line">y &lt;-array(<span class="number">1</span>:<span class="number">24</span>, dim = <span class="number">2</span>:<span class="number">4</span>);y <span class="comment"># 建2行4列的数组</span></div><div class="line"></div><div class="line"><span class="comment">## , , 1</span></div><div class="line"><span class="comment">## </span></div><div class="line"><span class="comment">##      [,1] [,2] [,3]</span></div><div class="line"><span class="comment">## [1,]1    3    5</span></div><div class="line"><span class="comment">## [2,]2    4    6</span></div><div class="line"><span class="comment">## </span></div><div class="line"><span class="comment">## , , 2</span></div><div class="line"><span class="comment">## </span></div><div class="line"><span class="comment">##      [,1] [,2] [,3]</span></div><div class="line"><span class="comment">## [1,]7    9   11</span></div><div class="line"><span class="comment">## [2,]8   10   12</span></div><div class="line"><span class="comment">## </span></div><div class="line"><span class="comment">## , , 3</span></div><div class="line"><span class="comment">## </span></div><div class="line"><span class="comment">##      [,1] [,2] [,3]</span></div><div class="line"><span class="comment">## [1,]13   15   17</span></div><div class="line"><span class="comment">## [2,]14   16   18</span></div><div class="line"><span class="comment">## </span></div><div class="line"><span class="comment">## , , 4</span></div><div class="line"><span class="comment">## </span></div><div class="line"><span class="comment">##      [,1] [,2] [,3]</span></div><div class="line"><span class="comment">## [1,]19   21   23</span></div><div class="line"><span class="comment">## [2,]20   22   24</span></div><div class="line"></div><div class="line">ncol(y)</div><div class="line"></div><div class="line"><span class="comment">## [1] 3</span></div><div class="line"></div><div class="line">NCOL(<span class="number">1</span>:<span class="number">12</span>) <span class="comment"># NCOL把数组作为单行的矩阵处理</span></div><div class="line"></div><div class="line"><span class="comment">## [1] 1</span></div><div class="line"></div><div class="line">NROW(<span class="number">1</span>:<span class="number">12</span>) <span class="comment"># 12</span></div><div class="line"></div><div class="line"><span class="comment">## [1] 12</span></div></pre></td></tr></table></figure>
<h2 id="矩阵的运算">矩阵的运算</h2>
<h3 id="矩阵相乘">矩阵相乘%*%</h3>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">a</div><div class="line"></div><div class="line"><span class="comment">##   A B C</span></div><div class="line"><span class="comment">## a 1 2 3</span></div><div class="line"><span class="comment">## b 4 5 6</span></div><div class="line"></div><div class="line">d &lt;- c(<span class="number">1</span>:<span class="number">6</span>)</div><div class="line">d &lt;- matrix(d,nrow=<span class="number">3</span>)</div><div class="line">d</div><div class="line"></div><div class="line"><span class="comment">##      [,1] [,2]</span></div><div class="line"><span class="comment">## [1,]1    4</span></div><div class="line"><span class="comment">## [2,]2    5</span></div><div class="line"><span class="comment">## [3,]3    6</span></div><div class="line"></div><div class="line">e&lt;-a%*%d</div><div class="line">e</div><div class="line"></div><div class="line"><span class="comment">##   [,1] [,2]</span></div><div class="line"><span class="comment">## a   14   32</span></div><div class="line"><span class="comment">## b   32   77</span></div></pre></td></tr></table></figure>
<p>只有当矩阵a的列数与矩阵b的行数相等时a×b才有意义。一个m×n的矩阵a（m,n)左乘一个n×p的矩阵b（n,p)，会得到一个m×p的矩阵c（m,p)，满足矩阵乘法满足结合律，但不满足交换律。 运算的法则： 矩阵a的第1行的3个元素(1,2,3)分别与矩阵b第1列的3个元素(1,2,3)相乘，其和为结果为e[1,1]，即e[1,1]=1×1+2×2+3×3=14； 矩阵a的第1行的3个元素(1,2,3)分别与矩阵b第2列的3个元素(4,5,6)相乘1×4+2×5+3×6=32，得到e[1,2]； 矩阵a的第2行的3个元素(4,5,6)分别与矩阵b第1列的3个元素(1,2,3)相乘4×1+5×2+6×3=32，得到e[2,1]； 矩阵a的第2行的3个元素(4,5,6)分别与矩阵b第2列的3个元素(4,5,6)相乘4×4+5×5+6×6=77，得到e[2,2].</p>
<h3 id="矩阵合并">矩阵合并</h3>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line">m1&lt;-matrix(<span class="number">1</span>,nrow=<span class="number">2</span>,ncol=<span class="number">2</span>)</div><div class="line">m1 <span class="comment"># 建立矩阵m1,2行2列，值为1</span></div><div class="line"></div><div class="line"><span class="comment">##      [,1] [,2]</span></div><div class="line"><span class="comment">## [1,]1    1</span></div><div class="line"><span class="comment">## [2,]1    1</span></div><div class="line"></div><div class="line">m2&lt;-matrix(<span class="number">2</span>,nrow=<span class="number">2</span>,ncol=<span class="number">2</span>)</div><div class="line">m2 <span class="comment"># 建立矩阵m2,2行2列，值为2</span></div><div class="line"></div><div class="line"><span class="comment">##      [,1] [,2]</span></div><div class="line"><span class="comment">## [1,]2    2</span></div><div class="line"><span class="comment">## [2,]2    2</span></div><div class="line"></div><div class="line">m_rbind&lt;-rbind(m1,m2);m_rbind <span class="comment"># 对两个矩阵m1,m2进行行合并，即上下合并</span></div><div class="line"></div><div class="line"><span class="comment">##      [,1] [,2]</span></div><div class="line"><span class="comment">## [1,]1    1</span></div><div class="line"><span class="comment">## [2,]1    1</span></div><div class="line"><span class="comment">## [3,]2    2</span></div><div class="line"><span class="comment">## [4,]2    2</span></div><div class="line"></div><div class="line">m_cbind&lt;-cbind(m1,m2);m_cbind <span class="comment">#对两个矩阵m1,m2进行列合并，即左右合并</span></div><div class="line"></div><div class="line"><span class="comment">##      [,1] [,2] [,3] [,4]</span></div><div class="line"><span class="comment">## [1,]1    1    22</span></div><div class="line"><span class="comment">## [2,]1    1    22</span></div></pre></td></tr></table></figure>
<h3 id="星号">星号</h3>
<p>把两个矩阵中每个对应的元素相乘，例子中a与b拥有相同的维度</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">a</div><div class="line"></div><div class="line"><span class="comment">##   A B C</span></div><div class="line"><span class="comment">## a 1 2 3</span></div><div class="line"><span class="comment">## b 4 5 6</span></div><div class="line"></div><div class="line">b</div><div class="line"></div><div class="line"><span class="comment">##       col_1 col_2 col_3</span></div><div class="line"><span class="comment">## row_12     4     6</span></div><div class="line"><span class="comment">## row_23     5     7</span></div><div class="line"></div><div class="line">result&lt;-a*b <span class="comment">#将矩阵a与矩阵b相乘，并将其结果给result</span></div><div class="line">result</div><div class="line"></div><div class="line"><span class="comment">##    AB  C</span></div><div class="line"><span class="comment">## a  2  8 18</span></div><div class="line"><span class="comment">## b 12 25 42</span></div></pre></td></tr></table></figure>
<p>如果维度不同，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">a</div><div class="line"><span class="comment">##   A B C</span></div><div class="line"><span class="comment">## a 1 2 3</span></div><div class="line"><span class="comment">## b 4 5 6</span></div><div class="line">c</div><div class="line"><span class="comment">## [1] 4 5 6</span></div><div class="line">a*c <span class="comment"># a矩阵中的每一列与c的每一行相乘，循环c</span></div><div class="line"><span class="comment">##    AB  C</span></div><div class="line"><span class="comment">## a  4 12 15</span></div><div class="line"><span class="comment">## b 20 20 36</span></div></pre></td></tr></table></figure>
<h3 id="增加行与列">增加行与列</h3>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line">f&lt;-matrix(,<span class="number">4</span>,<span class="number">2</span>) <span class="comment"># 建立4行2列的空矩阵f</span></div><div class="line">f</div><div class="line"></div><div class="line"><span class="comment">##      [,1] [,2]</span></div><div class="line"><span class="comment">## [1,]NA   NA</span></div><div class="line"><span class="comment">## [2,]NA   NA</span></div><div class="line"><span class="comment">## [3,]NA   NA</span></div><div class="line"><span class="comment">## [4,]NA   NA</span></div><div class="line"></div><div class="line">f[c(<span class="number">1</span>,<span class="number">3</span>),]&lt;-matrix(c(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>)) <span class="comment">#取f的1行与3行，将向量(1,2,3,4)填充进去，默认按列填充</span></div><div class="line">f</div><div class="line"></div><div class="line"><span class="comment">##      [,1] [,2]</span></div><div class="line"><span class="comment">## [1,]1    3</span></div><div class="line"><span class="comment">## [2,]NA   NA</span></div><div class="line"><span class="comment">## [3,]2    4</span></div><div class="line"><span class="comment">## [4,]NA   NA</span></div><div class="line"></div><div class="line">g&lt;-matrix(,<span class="number">4</span>,<span class="number">2</span>)</div><div class="line">g</div><div class="line"></div><div class="line"><span class="comment">##      [,1] [,2]</span></div><div class="line"><span class="comment">## [1,]NA   NA</span></div><div class="line"><span class="comment">## [2,]NA   NA</span></div><div class="line"><span class="comment">## [3,]NA   NA</span></div><div class="line"><span class="comment">## [4,]NA   NA</span></div><div class="line"></div><div class="line">g[c(<span class="number">1</span>,<span class="number">3</span>),]&lt;-matrix(c(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>),byrow=<span class="literal">FALSE</span>) <span class="comment"># byrow=FALSE则按行填充</span></div><div class="line">g</div><div class="line"></div><div class="line"><span class="comment">##      [,1] [,2]</span></div><div class="line"><span class="comment">## [1,]1    3</span></div><div class="line"><span class="comment">## [2,]NA   NA</span></div><div class="line"><span class="comment">## [3,]2    4</span></div><div class="line"><span class="comment">## [4,]NA   NA</span></div></pre></td></tr></table></figure>
<h3 id="矩阵转置">矩阵转置</h3>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">f</div><div class="line"></div><div class="line"><span class="comment">##      [,1] [,2]</span></div><div class="line"><span class="comment">## [1,]1    3</span></div><div class="line"><span class="comment">## [2,]NA   NA</span></div><div class="line"><span class="comment">## [3,]2    4</span></div><div class="line"><span class="comment">## [4,]NA   NA</span></div><div class="line"></div><div class="line">h&lt;-t(f)</div><div class="line">h</div><div class="line"></div><div class="line"><span class="comment">##      [,1] [,2] [,3] [,4]</span></div><div class="line"><span class="comment">## [1,]1   NA    2NA</span></div><div class="line"><span class="comment">## [2,]3   NA    4NA</span></div></pre></td></tr></table></figure>
<h3 id="取对角元素">取对角元素</h3>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">j&lt;-c(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>)</div><div class="line">j <span class="comment"># 建立向量j</span></div><div class="line"></div><div class="line"><span class="comment">## [1] 1 2 3 4 5 6 7 8 9</span></div><div class="line"></div><div class="line">j&lt;-matrix(j,nrow=<span class="number">3</span>)</div><div class="line">j <span class="comment">#建立3行3列矩阵</span></div><div class="line"></div><div class="line"><span class="comment">##      [,1] [,2] [,3]</span></div><div class="line"><span class="comment">## [1,]1    4    7</span></div><div class="line"><span class="comment">## [2,]2    5    8</span></div><div class="line"><span class="comment">## [3,]3    6    9</span></div><div class="line"></div><div class="line">j_diag&lt;-diag(j) <span class="comment">#取对角</span></div><div class="line">j_diag</div><div class="line"></div><div class="line"><span class="comment">## [1] 1 5 9</span></div></pre></td></tr></table></figure>
<h3 id="求各行与列的总和与均值">求各行与列的总和与均值</h3>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">j</div><div class="line"></div><div class="line"><span class="comment">##      [,1] [,2] [,3]</span></div><div class="line"><span class="comment">## [1,]1    4    7</span></div><div class="line"><span class="comment">## [2,]2    5    8</span></div><div class="line"><span class="comment">## [3,]3    6    9</span></div><div class="line"></div><div class="line">rowSums(j) <span class="comment"># 求各行的总和</span></div><div class="line"></div><div class="line"><span class="comment">## [1] 12 15 18</span></div><div class="line"></div><div class="line">rowMeans(j) <span class="comment"># 求行的均值</span></div><div class="line"></div><div class="line"><span class="comment">## [1] 4 5 6</span></div><div class="line"></div><div class="line">colSums(j) <span class="comment">#求各列的总和</span></div><div class="line"></div><div class="line"><span class="comment">## [1]  6 15 24</span></div><div class="line"></div><div class="line">colMeans(j) <span class="comment">#求各列的均值</span></div><div class="line"></div><div class="line"><span class="comment">## [1] 2 5 8</span></div></pre></td></tr></table></figure>
<h3 id="矩阵的特征值与特征向量">矩阵的特征值与特征向量</h3>
<p>矩阵A的谱分解为<code>A=UΛU</code>，其中Λ是由A的特征值组成的对角矩阵，U的列为A的特征值对应的特征向量，在R中可以使用eigen()得到U和A，<code>eigen(x,symmertic, only.values=FALSE,EISPACK=FALSE)</code>，其中参数symmetric项是逻辑值，是F或T，它用于指定矩阵x是否为对称矩阵，如果不指定，系统将自动检验x是否为对称矩阵，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">&gt; eigen(j)</div><div class="line">eigen() decomposition</div><div class="line">$values</div><div class="line">[<span class="number">1</span>]  <span class="number">1.611684e+01</span> -<span class="number">1.116844e+00</span> -<span class="number">5.700691e-16</span></div><div class="line"></div><div class="line">$vectors</div><div class="line">           [,<span class="number">1</span>]       [,<span class="number">2</span>]       [,<span class="number">3</span>]</div><div class="line">[<span class="number">1</span>,] -<span class="number">0.4645473</span> -<span class="number">0.8829060</span>  <span class="number">0.4082483</span></div><div class="line">[<span class="number">2</span>,] -<span class="number">0.5707955</span> -<span class="number">0.2395204</span> -<span class="number">0.8164966</span></div><div class="line">[<span class="number">3</span>,] -<span class="number">0.6770438</span>  <span class="number">0.4038651</span>  <span class="number">0.4082483</span></div></pre></td></tr></table></figure>
<h3 id="矩阵的求逆">矩阵的求逆</h3>
<p>矩阵求逆可用函数solve()，应用sovle(A,b)运算结果可以解线性方程组Ax=b，缺b缺少，则系统默认为单位矩阵，因此可以用其进行矩阵求逆，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">&gt; e</div><div class="line">  [,<span class="number">1</span>] [,<span class="number">2</span>]</div><div class="line">a   <span class="number">15</span>   <span class="number">36</span></div><div class="line">b   <span class="number">29</span>   <span class="number">71</span></div><div class="line">&gt; solve(e)</div><div class="line">             a          b</div><div class="line">[<span class="number">1</span>,]  <span class="number">3.380952</span> -<span class="number">1.7142857</span></div><div class="line">[<span class="number">2</span>,] -<span class="number">1.380952</span>  <span class="number">0.7142857</span></div></pre></td></tr></table></figure>
<h3 id="矩阵的choleskey分解">矩阵的Choleskey分解</h3>
<p>对于正定矩阵A，可对其进行Choleskey分解，即A=P’P，其中P为上三角矩阵，在R中可以用函数chol()进行Choleskey分解，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180821/kjC1c7m9Be.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h3 id="矩阵奇异值分解">矩阵奇异值分解</h3>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180821/4hdBIkGai3.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180821/DcEdkH03aH.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h3 id="矩阵qr分解">矩阵QR分解</h3>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180821/9AhgfEi19J.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h3 id="矩阵kronecker积">矩阵kronecker积</h3>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180821/Klf85Am6cE.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h1 id="数组">数组</h1>
<h2 id="什么是数组">什么是数组</h2>
<p>数组：一维数据是向量，二维数据是矩阵，数组是向量和矩阵的直接推广，是由三维或三维以上的数据构成的。</p>
<h2 id="构建数组">构建数组</h2>
<p>数组函数是<code>array(),</code>语法是：<code>array(dadta, dim)</code>，其中<code>data</code>必须是同一类型的数据，<code>dim</code>是各维的长度组成的向量。函数<code>rowSums</code>, <code>colSums</code>, <code>rowMeans</code>, <code>colMeans</code>分别可以计算行总和，行均值，列总和，列均值，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">a&lt;-array(rep(<span class="number">1</span>:<span class="number">3</span>,each=<span class="number">3</span>),dim=c(<span class="number">3</span>,<span class="number">3</span>))</div><div class="line">a</div><div class="line"><span class="comment">##      [,1] [,2] [,3]</span></div><div class="line"><span class="comment">## [1,]1    2    3</span></div><div class="line"><span class="comment">## [2,]1    2    3</span></div><div class="line"><span class="comment">## [3,]1    2    3</span></div><div class="line"></div><div class="line">rowSums(a)</div><div class="line"><span class="comment">## [1] 6 6 6</span></div><div class="line"></div><div class="line">colSums(a)</div><div class="line"><span class="comment">## [1] 3 6 9</span></div><div class="line"></div><div class="line">table(a)</div><div class="line"><span class="comment">## a</span></div><div class="line"><span class="comment">## 1 2 3 </span></div><div class="line"><span class="comment">## 3 3 3</span></div></pre></td></tr></table></figure>
<h2 id="多维数组">多维数组</h2>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">colSums (x, na.rm = <span class="literal">FALSE</span>, dims = <span class="number">1</span>) rowSums (x, na.rm = <span class="literal">FALSE</span>, dims = <span class="number">1</span>) colMeans(x, na.rm = <span class="literal">FALSE</span>, dims = <span class="number">1</span>) rowMeans(x, na.rm = <span class="literal">FALSE</span>, dims = <span class="number">1</span>)</div></pre></td></tr></table></figure>
<p>其中dims为整数，表示哪个或哪些维数被看做行或列，对于row统计函数，dims+1及以后的维度被看做行，对于col函数，dims及以前的维度（1:dims）被看做列：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div></pre></td><td class="code"><pre><div class="line">b &lt;- array(rep(<span class="number">1</span>:<span class="number">3</span>, each=<span class="number">9</span>), dim=c(<span class="number">3</span>,<span class="number">3</span>,<span class="number">3</span>));b</div><div class="line"></div><div class="line"><span class="comment">## , , 1</span></div><div class="line"><span class="comment">## </span></div><div class="line"><span class="comment">##      [,1] [,2] [,3]</span></div><div class="line"><span class="comment">## [1,]1    1    1</span></div><div class="line"><span class="comment">## [2,]1    1    1</span></div><div class="line"><span class="comment">## [3,]1    1    1</span></div><div class="line"><span class="comment">## </span></div><div class="line"><span class="comment">## , , 2</span></div><div class="line"><span class="comment">## </span></div><div class="line"><span class="comment">##      [,1] [,2] [,3]</span></div><div class="line"><span class="comment">## [1,]2    2    2</span></div><div class="line"><span class="comment">## [2,]2    2    2</span></div><div class="line"><span class="comment">## [3,]2    2    2</span></div><div class="line"><span class="comment">## </span></div><div class="line"><span class="comment">## , , 3</span></div><div class="line"><span class="comment">## </span></div><div class="line"><span class="comment">##      [,1] [,2] [,3]</span></div><div class="line"><span class="comment">## [1,]3    3    3</span></div><div class="line"><span class="comment">## [2,]3    3    3</span></div><div class="line"><span class="comment">## [3,]3    3    3</span></div><div class="line"></div><div class="line">rowSums(b)</div><div class="line"><span class="comment">## [1] 18 18 18</span></div><div class="line"></div><div class="line">rowSums(b,dims=<span class="number">1</span>)</div><div class="line"><span class="comment">## [1] 18 18 18</span></div><div class="line"></div><div class="line">rowSums(b,dims=<span class="number">2</span>)</div><div class="line"><span class="comment">##      [,1] [,2] [,3]</span></div><div class="line"><span class="comment">## [1,]6    6    6</span></div><div class="line"><span class="comment">## [2,]6    6    6</span></div><div class="line"><span class="comment">## [3,]6    6    6</span></div><div class="line"></div><div class="line">colSums(b)</div><div class="line"><span class="comment">##      [,1] [,2] [,3]</span></div><div class="line"><span class="comment">## [1,]3    6    9</span></div><div class="line"><span class="comment">## [2,]3    6    9</span></div><div class="line"><span class="comment">## [3,]3    6    9</span></div><div class="line"></div><div class="line">colSums(b,dims=<span class="number">2</span>)</div><div class="line"><span class="comment">## [1]  9 18 27</span></div><div class="line"></div><div class="line">table(b)</div><div class="line"><span class="comment">## b</span></div><div class="line"><span class="comment">## 1 2 3 </span></div><div class="line"><span class="comment">## 9 9 9</span></div></pre></td></tr></table></figure>
<h2 id="数组命名">数组命名</h2>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div></pre></td><td class="code"><pre><div class="line">x&lt;-<span class="number">1</span>:<span class="number">3</span> <span class="comment">#建立向量x</span></div><div class="line">names(x) <span class="comment">#提取向量x的名称</span></div><div class="line"><span class="comment">## NULL</span></div><div class="line"></div><div class="line">names(x)&lt;-c(<span class="string">"a"</span>,<span class="string">"b"</span>,<span class="string">"c"</span>);x<span class="comment">#将a,b,c作为x的名称</span></div><div class="line"><span class="comment">## a b c </span></div><div class="line"><span class="comment">## 1 2 3</span></div><div class="line"></div><div class="line">names(x)<span class="comment">#显示向量x的名称</span></div><div class="line"><span class="comment">## [1] "a" "b" "c"</span></div><div class="line"></div><div class="line">names(x)&lt;-<span class="literal">NULL</span>;x <span class="comment">#删除向量x的名称</span></div><div class="line"><span class="comment">## [1] 1 2 3</span></div><div class="line"></div><div class="line">x&lt;-matrix(<span class="number">1</span>:<span class="number">4</span>,<span class="number">2</span>)</div><div class="line">rownames(x)&lt;-c(<span class="string">"a"</span>,<span class="string">"b"</span>) <span class="comment"># 将行命名为a,b</span></div><div class="line">colnames(x)&lt;-c(<span class="string">"c"</span>,<span class="string">"d"</span>);x <span class="comment"># 将列命名为c,d</span></div><div class="line"><span class="comment">##   c d</span></div><div class="line"><span class="comment">## a 1 3</span></div><div class="line"><span class="comment">## b 2 4</span></div><div class="line"></div><div class="line">dimnames(x)<span class="comment">#返回包含两个向量的列表</span></div><div class="line"><span class="comment">## [[1]]</span></div><div class="line"><span class="comment">## [1] "a" "b"</span></div><div class="line"><span class="comment">## </span></div><div class="line"><span class="comment">## [[2]]</span></div><div class="line"><span class="comment">## [1] "c" "d"</span></div><div class="line"></div><div class="line">a&lt;-array(<span class="number">1</span>:<span class="number">8</span>,dim=c(<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>));a<span class="comment">#建立数组a,维度为2，2，2</span></div><div class="line"><span class="comment">## , , 1</span></div><div class="line"><span class="comment">## </span></div><div class="line"><span class="comment">##      [,1] [,2]</span></div><div class="line"><span class="comment">## [1,]1    3</span></div><div class="line"><span class="comment">## [2,]2    4</span></div><div class="line"><span class="comment">## </span></div><div class="line"><span class="comment">## , , 2</span></div><div class="line"><span class="comment">## </span></div><div class="line"><span class="comment">##      [,1] [,2]</span></div><div class="line"><span class="comment">## [1,]5    7</span></div><div class="line"><span class="comment">## [2,]6    8</span></div><div class="line"></div><div class="line">dimnames(a)&lt;-list(c(<span class="string">"a"</span>,<span class="string">"b"</span>),c(<span class="string">"c"</span>,<span class="string">"d"</span>),c(<span class="string">"e"</span>,<span class="string">"f"</span>));a <span class="comment"># 将数组a的各组命名</span></div><div class="line"><span class="comment">## , , e</span></div><div class="line"><span class="comment">## </span></div><div class="line"><span class="comment">##   c d</span></div><div class="line"><span class="comment">## a 1 3</span></div><div class="line"><span class="comment">## b 2 4</span></div><div class="line"><span class="comment">## </span></div><div class="line"><span class="comment">## , , f</span></div><div class="line"><span class="comment">## </span></div><div class="line"><span class="comment">##   c d</span></div><div class="line"><span class="comment">## a 5 7</span></div><div class="line"><span class="comment">## b 6 8</span></div></pre></td></tr></table></figure>
<h2 id="行列求和平均值和频数">行列求和，平均值和频数</h2>
<h3 id="简单数组">简单数组</h3>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">a &lt;- array(rep(<span class="number">1</span>:<span class="number">3</span>, each=<span class="number">3</span>), dim=c(<span class="number">3</span>,<span class="number">3</span>));a</div><div class="line"><span class="comment">##      [,1] [,2] [,3]</span></div><div class="line"><span class="comment">## [1,]1    2    3</span></div><div class="line"><span class="comment">## [2,]1    2    3</span></div><div class="line"><span class="comment">## [3,]1    2    3</span></div><div class="line"></div><div class="line">rowSums(a) <span class="comment"># 求行的和</span></div><div class="line"><span class="comment">## [1] 6 6 6</span></div><div class="line"></div><div class="line">colSums(a) <span class="comment"># 求列的和　</span></div><div class="line"><span class="comment">## [1] 3 6 9</span></div><div class="line"></div><div class="line">table(a) <span class="comment"># 频数表</span></div><div class="line"><span class="comment">## a</span></div><div class="line"><span class="comment">## 1 2 3 </span></div><div class="line"><span class="comment">## 3 3 3</span></div></pre></td></tr></table></figure>
<h3 id="多维数组-1">多维数组</h3>
<p>对于多维数组，rowSums, colSums, rowMeans, colMeans的使用稍为复杂点。它们的参数为:</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div></pre></td><td class="code"><pre><div class="line">b &lt;- array(rep(<span class="number">1</span>:<span class="number">3</span>, each=<span class="number">9</span>), dim=c(<span class="number">3</span>,<span class="number">3</span>,<span class="number">3</span>));b</div><div class="line"><span class="comment">## , , 1</span></div><div class="line"><span class="comment">## </span></div><div class="line"><span class="comment">##      [,1] [,2] [,3]</span></div><div class="line"><span class="comment">## [1,]1    1    1</span></div><div class="line"><span class="comment">## [2,]1    1    1</span></div><div class="line"><span class="comment">## [3,]1    1    1</span></div><div class="line"><span class="comment">## </span></div><div class="line"><span class="comment">## , , 2</span></div><div class="line"><span class="comment">## </span></div><div class="line"><span class="comment">##      [,1] [,2] [,3]</span></div><div class="line"><span class="comment">## [1,]2    2    2</span></div><div class="line"><span class="comment">## [2,]2    2    2</span></div><div class="line"><span class="comment">## [3,]2    2    2</span></div><div class="line"><span class="comment">## </span></div><div class="line"><span class="comment">## , , 3</span></div><div class="line"><span class="comment">## </span></div><div class="line"><span class="comment">##      [,1] [,2] [,3]</span></div><div class="line"><span class="comment">## [1,]3    3    3</span></div><div class="line"><span class="comment">## [2,]3    3    3</span></div><div class="line"><span class="comment">## [3,]3    3    3</span></div><div class="line"></div><div class="line">rowSums(b)</div><div class="line"><span class="comment">## [1] 18 18 18</span></div><div class="line"></div><div class="line">rowSums(b,dims=<span class="number">1</span>)</div><div class="line"><span class="comment">## [1] 18 18 18</span></div><div class="line"></div><div class="line">rowSums(b,dims=<span class="number">2</span>)</div><div class="line"><span class="comment">##      [,1] [,2] [,3]</span></div><div class="line"><span class="comment">## [1,]6    6    6</span></div><div class="line"><span class="comment">## [2,]6    6    6</span></div><div class="line"><span class="comment">## [3,]6    6    6</span></div><div class="line"></div><div class="line">colSums(b)</div><div class="line"><span class="comment">##      [,1] [,2] [,3]</span></div><div class="line"><span class="comment">## [1,]3    6    9</span></div><div class="line"><span class="comment">## [2,]3    6    9</span></div><div class="line"><span class="comment">## [3,]3    6    9</span></div><div class="line"></div><div class="line">colSums(b,dims=<span class="number">2</span>)</div><div class="line"><span class="comment">## [1]  9 18 27</span></div><div class="line"></div><div class="line">table(b)</div><div class="line"><span class="comment">## b</span></div><div class="line"><span class="comment">## 1 2 3 </span></div><div class="line"><span class="comment">## 9 9 9</span></div><div class="line"></div><div class="line">c &lt;- sample(letters[<span class="number">1</span>:<span class="number">5</span>], <span class="number">10</span>, replace=<span class="literal">TRUE</span>)</div><div class="line">table(c)</div><div class="line"><span class="comment">## c</span></div><div class="line"><span class="comment">## a b d e </span></div><div class="line"><span class="comment">## 1 3 2 4</span></div></pre></td></tr></table></figure>
<h1 id="查看数据类型">查看数据类型</h1>
<h2 id="class">class()</h2>
<p>使用class函数可以查看数据的类型，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&gt; x=c(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>)</div><div class="line">&gt; class(x)</div><div class="line">[<span class="number">1</span>] <span class="string">"numeric"</span></div><div class="line">&gt; x1&lt;-as.character(x)</div><div class="line">&gt; class(x1)</div><div class="line">[<span class="number">1</span>] <span class="string">"character"</span></div></pre></td></tr></table></figure>
<h1 id="数据类型转换">数据类型转换</h1>
<p>常用函数如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">判断转换 类型转换函数 </div><div class="line">is.numeric() as.numeric() </div><div class="line">is.character() as.character() </div><div class="line">is.vector() as.vector() </div><div class="line">is.matrix() as.matrix() </div><div class="line">is.data.frame() as.data.frame() </div><div class="line">is.factor() as.factor() </div><div class="line">is.logical() as.logical()</div></pre></td></tr></table></figure>
<p>使用如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">&gt; a &lt;- c(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>);a</div><div class="line">[<span class="number">1</span>] <span class="number">1</span> <span class="number">2</span> <span class="number">3</span></div><div class="line">&gt; is.numeric(a)</div><div class="line">[<span class="number">1</span>] <span class="literal">TRUE</span></div><div class="line">&gt; is.vector(a)</div><div class="line">[<span class="number">1</span>] <span class="literal">TRUE</span></div><div class="line">&gt; a &lt;- as.character(a)</div><div class="line">&gt; a <span class="comment">#将a转化为字符串类型</span></div><div class="line">[<span class="number">1</span>] <span class="string">"1"</span> <span class="string">"2"</span> <span class="string">"3"</span></div><div class="line">&gt; is.numeric(a)</div><div class="line">[<span class="number">1</span>] <span class="literal">FALSE</span></div><div class="line">&gt; is.vector(a)</div><div class="line">[<span class="number">1</span>] <span class="literal">TRUE</span></div><div class="line">&gt; is.character(a)</div><div class="line">[<span class="number">1</span>] <span class="literal">TRUE</span></div><div class="line">&gt; as.numeric(<span class="literal">FALSE</span>) <span class="comment">#逻辑型数据转化为0与1</span></div><div class="line">[<span class="number">1</span>] <span class="number">0</span></div><div class="line">&gt; as.numeric(<span class="literal">TRUE</span>)</div><div class="line">[<span class="number">1</span>] <span class="number">1</span></div></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/11/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/11/">11</a><span class="page-number current">12</span><a class="page-number" href="/page/13/">13</a><a class="extend next" rel="next" href="/page/13/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">RVDSD</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">121</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">10</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">63</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          <div class="links-of-author motion-element">
            
          </div>

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

<div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">RVDSD</span>

  
</div>



<div class="powered-by">
<i class="fa fa-user-md"></i><span id="busuanzi_container_site_uv">
  本站访客数:<span id="busuanzi_value_site_uv"></span>
</span>
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.3</div>




<div class="theme-info">
  <div class="powered-by"></div>
  <span class="post-count">博客全站共477.4k字</span>
</div>

        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.3"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.3"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.3"></script>



  


  




	





  





  










  
  <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/valine@1.1.4/dist/Valine.min.js"></script>
  <script type="text/javascript">
    new Valine({
        av: AV,
        el: '#vcomments' ,
        verify: true,
        notify: true,
        app_id: '4ORLDMxXCFDLSHPJ4wSSDkkw-gzGzoHsz',
        app_key: 'HSWpCY7XlN0pGV5DCrKoC0ic',
        placeholder: 'Comment input placeholder'
    });
  </script>



  





  

  

  
  

  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config("");
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="custom_mathjax_source">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->
  


  

  

</body>
</html>
