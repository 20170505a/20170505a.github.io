<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.3" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.3">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.3" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta property="og:type" content="website">
<meta property="og:title" content="RVDSD的个人笔记本">
<meta property="og:url" content="http://rvdsd.top/page/10/index.html">
<meta property="og:site_name" content="RVDSD的个人笔记本">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="RVDSD的个人笔记本">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.3',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://rvdsd.top/page/10/"/>





  <title>RVDSD的个人笔记本</title><!-- hexo-inject:begin --><!-- hexo-inject:end -->
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">RVDSD的个人笔记本</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">学习过程中的输出</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2017/06/21/生物统计-02b正态分布与T检验的计算原理/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/06/21/生物统计-02b正态分布与T检验的计算原理/" itemprop="url">生物统计-02a正态分布与T检验的计算原理</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-06-21T12:00:00+08:00">
                2017-06-21
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/生物统计/" itemprop="url" rel="index">
                    <span itemprop="name">生物统计</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  3,830
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  15
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="前言">前言</h2>
<p>我一直不太清楚正态分布以及t分布计算的原理，这一篇笔记主要就是总结一下自己对正态分布以及t分布，包括t检验原理的一些理解。</p>
<h2 id="正态分布介绍">正态分布介绍</h2>
<h3 id="正态分布定义">正态分布定义</h3>
<p>先看一下正态分布的定义，如下所示：</p>
<p>若随机变量X服从一个数学期望为<span class="math inline">\(\mu\)</span>、方差为<span class="math inline">\((\sigma)^2\)</span>的正态分布，记为N(<span class="math inline">\(\mu\)</span>，<span class="math inline">\((\sigma)^2\)</span>)。其概率密度函数为正态分布的期望值<span class="math inline">\(\mu\)</span>决定了其位置，其标准差<span class="math inline">\(\sigma\)</span>决定了分布的幅度。因其曲线呈钟形，因此人们又经常称之为钟形曲线。我们通常所说的标准正态分布是<span class="math inline">\(\mu\)</span> = 0,<span class="math inline">\(\sigma\)</span> = 1的正态分布。</p>
<p>标准正态分布的图形如下所示： <img src="http://ortxpw68f.bkt.clouddn.com/professional/180602/aAhk9cjChD.jpg?imageslim" alt="mark"></p>
<p>从定义中，我认为要弄清这几个问题： 1. 什么是概率密度函数？ 2. 它的图形表示什么意义？</p>
<p>在弄清这几个问题之前，需要补充几点知识。</p>
<h3 id="离散数据">离散数据</h3>
<p>在介绍概率密度函数之前，需要了解的一个概念就是离散数据。离散数据是由一个个单独的数值组成的，其中的每一个数值都有相应的概率。例如，在分析老虎机（一种赌博的机器）的收益概率分布时，每一局赌局可能出现的收益数额是确定的，我们很清楚各种情况的赔率，也知道自己有机会赢到其中的一种。如果是离散数据，则为数值型数据，只能取确切值。离散数据往往能以某种方式进行计数，例如糖果机中的糖果数目，智力游戏中答对问题的数目，或者是机器在一个特定时段内的故障次数，如下所示： <img src="http://ortxpw68f.bkt.clouddn.com/professional/180602/Cm9eaA4F3m.png?imageslim" alt="mark"></p>
<h3 id="连续数据">连续数据</h3>
<p>但一一列举一个数据集中的所有数值并不总是能够实现，有时候数据涵盖的是一个范围，这个范围内的任何一个数值都有可能成为事件的结果。例如，假定有人让你精确地测量几段丝线的长度，并且已知这些丝线的长度在10厘米到11厘米之间，你的测量结果可能会是10厘米，10.1厘米，10.01厘米等待，总之，长度可以是10厘米到11厘米产这个范围内的任意值，这种数据就是连续数据，如下所示。连续数据往往是通过测量得到的，而不是通过计数得到的，测量结果在很大程度上取决于测量精度要求。 <img src="http://ortxpw68f.bkt.clouddn.com/professional/180602/1iHm246A10.png?imageslim" alt="mark"></p>
<h3 id="离散数据的概率">离散数据的概率</h3>
<p>离散数据的概率很好计算，因为它的数据可以一一列举出来。看一个案例： 有20%的盒子装有免费玩具，每盒一个，打开不到4只盒子就能得到第一个免费玩具的概率有多大？ 计算过程：打开不到4只盒子就能得到第一个免费玩具的意思就是：打开1个或2个，或3个盒子得到第一个免费玩具。那么，打开1个玩具盒子得到免费玩具的概率就是0.2，如果是打开2个盒子得到玩具的概率则是（1-0.2）X0.2=0.16；打开3个盒子得到玩具的概率就是（1-0.2)X(1-0.2)X0.2=0.128，那么打开不到4只盒子就能得到第一个免费玩具的概率就是：0.2+0.16+0.128=0.488。 从这个案例就可以知道，离散数据我们可以把反它可能的情况一一列举出来，然后计算其概率。但是数据如果是连续的，那就无法这么计算，需要另外一种方法，此时需要了解一下概率密度函数。</p>
<h3 id="概率密度函数">概率密度函数</h3>
<p>概率密度函数用于描述连续随机变量的概率分布。概率密度函数f(x)是这样的一种函数：通过它可以求出一个数据范围内的某个连续变量的概率，它向我们指出该概率分布的形状。 看下面的一个案例（此案例出自《深入浅出统计学》）：女生朱莉与男生约会的案例。女生朱莉在约定的地点等待男生，朱莉给自己规定，如果20分钟内男生不来，朱莉就离开，下图就显示了朱莉为了见到男生而等待的时间：<img src="http://ortxpw68f.bkt.clouddn.com/professional/180602/4CCajdci1j.png?imageslim" alt="mark"> 从这个图形可以看出，这个图形相当于一个大的频数图形（也就是说它在0到20之间只有一个频数），在最初的20分钟内，朱莉等待的时间的频数为常数，这意味着概率密度函数也是常数。</p>
<h4 id="概率面积">概率=面积</h4>
<p>连续随机变量的概率通过面积表示，为了求出一个特定数值范围的概率，首选可以画出概率密度函数，位于函数图形下方且介于这个特定数值范围之间的面积就是这个特定数值范围的概率。例如我们要求出朱莉为了见到约会对象而等待5到20分钟的概率，可以画出概率密度函数，再求出位于这个概率密度函数下方且x值介于5到20之间的面积，如下所示： <img src="http://ortxpw68f.bkt.clouddn.com/professional/180602/E9IclKIbBC.png?imageslim" alt="mark"> 线下总面积必须等于1，因为总面积代表总概率，对于任何概率分布来说，总概率必须等于1，因此面积也必须等于1。 <img src="http://ortxpw68f.bkt.clouddn.com/professional/180602/a2Cll0iGhe.png?imageslim" alt="mark"> 此时，我们利用这张图求出朱莉等待5分钟以上的概率，由于矩型面积为1，底是20，因此高度为：1/20=0.05，也就是说f(x)=0.05,此时再求出P（x&gt;5）的概率。其实就是求下面这个矩形的面积： <img src="http://ortxpw68f.bkt.clouddn.com/professional/180602/JJ2JIChLDa.png?imageslim" alt="mark"></p>
<p>那么P(x&gt;5)=(20-5)X0.05=0.75，因此朱莉等待5分钟以上的概率是0.75（其实也好理解，她只能等20分钟，20分钟之内的概率总和为1，等待5分钟以上，也就是最多15分钟，概率是75%）。</p>
<p>写这个案例，就是说，概率就是曲线下面积，这个不仅适用于直接，还适用于曲线，具体的推导过程比较复杂，我没弄懂。</p>
<h3 id="正态分布的曲线">正态分布的曲线</h3>
<p>再看一个案例，这个案例来源于《漫画统计学》。 案例描述：假设A县的全体高三学生英语测验的结果如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180603/9f1H1AmC46.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>将这些成绩做成直方图就成了下面的这个样子：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180603/l2cGedAAIe.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>这个直方图的组距是10，如果将组织缩小，再缩小，就成了下面的这个样子：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180603/JekDDk7mil.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>我们把这个将距离缩小至极限后，得到的曲线称为概率密度函数（原漫画书上写的是“机率密度函数”，其实是一样的）。概率密度函数不一定是对称的，也有可能长得像下面的这个样子：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180603/ElBm5L1E9D.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时我们只讲一下正态分布的密度曲线，正态分布的密度曲线的公式为：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180603/jCDbhc2jCJ.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>这个公式是怎么推导的，也不需要了解（背后是中心极限理论），其中<code>e</code>是自然对数的底，其值大概是2.7182。如果我们绘制平均值为53，标准差为15的正态分布曲线，则就是下面的这个样子：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180603/E6ga6dGF89.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>如果绘制平均值为53，标准差为5的正态分布曲线，则是另外的样子：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180603/3BJhmaeJEA.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>如果平均值为30，标准差为5，则又是另外的样子：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180603/KGlIfCGkLm.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>从上面的例子我们知道了正态分布的概率密度函数图形的特点是：第一，以平均值为中心呈左右对称；第二，受到平均值和标准差的影响。在统计学上，通常描述某个正态分布曲线的语言就是“x服从平均值为某某，标准差为某某的正态分布”，如果是“x服从平均值为0，标准差为1的正态分布”则这种正态分布就是标准正态分布。它的公式就是下面的这个样子：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180603/47mJkjc3bK.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>它的图形如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180603/L8LIm2dCDI.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h3 id="正态分布的推导">正态分布的推导</h3>
<p>在理解正态分布的时候，如果知道它的推导过程，以及曲线下面积是如何求的，就会对正态分布的理解更深入，但是这涉及到一定的数学知识，包括大数定量，微积分等，目前我没有能力理解这些，具体的可以看陈希孺的《概率论与数理统计》等资料。</p>
<h3 id="正态分布的概率">正态分布的概率</h3>
<p>在计算机未广泛应用之前，为了方便计算，数学家们就编制了标准正态分布表，而在计算机广泛使用之后，则很容易计算出服从正态分布的数据的某个范围的概率，但为了理解正态分布的原理，还是先看一下这个标准正态分布表，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180603/kg82e8HaEe.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h3 id="如何查标准正态分布表">如何查标准正态分布表</h3>
<p>如果我们计算出了一个z值，例如是1.96，它在标准正态分布概率密度曲线上大概就是下面的这个样子：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180604/BL46igLjLa.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>查表步骤：把z=1.96看作为z=1.9+0.06，然后对照着着标准正态分布表查询，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180604/dBkbdGJLbj.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>1.9与0.06交叉处的数值就是0.4750，那么我们所求的面积就是0.4750，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180604/hhIDjd594K.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h2 id="正态分布案例之一">正态分布案例之一</h2>
<p>再看一个案例：</p>
<p>B县的全体高一学生参加某补习班的数学测验，计算分数后得知“数学测验结果”可视为平均值为45，标准差为10的正态分布，那么这些数据就可以表示为这个样子：</p>
<p>绘制出平均值为45，标准差为10的正态分布表示，下图斜线部分的面积是0.5，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180604/cGaHI75934.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>还可以得到出这些信息：</p>
<p>第一：得分在45分以上的考生比例，占全体考生总数的0.5（50%）；</p>
<p>第二：从全体考生中，随机抽出一个人，其得分在45分以上的概率为0.5（50%）；</p>
<p>第三，将这些数学成绩标准化后（也就是常说的Z转换），0以上的考比例，占全体考生总数的0.5（50%），如下所示（看红线，不要看0.29）：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180604/hd4Fc52cIA.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>再继续这个案例，由于它是符合平均数为45，标准差为10的正态分布，那么，如果我要求某一个分数以上的考生比例，例如63分以上的考生比例，它的计算过程就是先把这个数字转换到标准正态分布上，过程如下所示（这就是Z转换）：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180604/kFdbi5EiEg.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>然后从标准正态分布表查1.8，它对应的数字是0.4641，这个数字表示的是小于63这个数字的概率，那么大于63的概率就是：0.5-0.4641=0.0359（3.59%）。它对应的面积就是下面的这个样子：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180604/ibjJ1Dlk2c.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>将它转换为标准正态分布，则是这个样子：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180604/1iCjJefj5l.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h2 id="r语言正态分布函数">R语言正态分布函数</h2>
<p>R语言中与正态分布有关的函数如下所示：</p>
<ol style="list-style-type: decimal">
<li>密度函数： dnorm(x, mean = 0, sd = 1, log = FALSE)</li>
<li>分布函数： pnorm(q, mean = 0, sd = 1, lower.tail = TRUE, log.p = FALSE)</li>
<li>分位数函数：qnorm(p, mean = 0, sd = 1, lower.tail = TRUE, log.p = FALSE)</li>
<li>随机函数： rnorm(n, mean = 0, sd = 1) 其余的分布函数与正态分布的前缀相同。</li>
</ol>
<h3 id="正态分布相应的概率计算">正态分布相应的概率计算</h3>
<p>求正态N(3.1.5)变量X在区间(2,4)中的概率p，如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pnorm(4,3,1.5)-pnorm(2,3,1.5)</div></pre></td></tr></table></figure>
<blockquote>
<p>pnorm(4,3,1.5)-pnorm(2,3,1.5) [1] 0.4950149</p>
</blockquote>
<h2 id="正态分布密度曲线">正态分布密度曲线</h2>
<p>下面分别绘制均值（以下用m表示）为0，标准差（以下用sd表示）为1，m=0，sd=0.5，m=0，sd=2，m=-2，sd=1的正态分布密度曲线（密度曲线下面的积分面积对应的就是相应范围内的概率）。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">set.seed(1000)</div><div class="line">x &lt;- seq(-5,5,length.out=100)</div><div class="line">y &lt;- dnorm(x,0,1)</div><div class="line">plot(x,y,col=&quot;red&quot;,xlim=c(-5,5),ylim=c(0,1),type=&quot;l&quot;,</div><div class="line">xaxs=&quot;i&quot;,yaxs=&quot;i&quot;,ylab=&quot;density&quot;,xlab=&quot;&quot;,</div><div class="line">main=&quot;The Normal Density Distribution&quot;)</div><div class="line">lines(x,dnorm(x,0,0.5),col=&quot;green&quot;)</div><div class="line">lines(x,dnorm(x,0,2),col=&quot;blue&quot;)</div><div class="line">lines(x,dnorm(x,-2,1),col=&quot;orange&quot;)</div><div class="line">legend(&quot;topright&quot;,legend=paste(&quot;m=&quot;,c(0,0,0,-2),&quot;sd=&quot;,c(1,0.5,2,1)),lwd=1,col=c(&quot;red&quot;,&quot;green&quot;,&quot;blue&quot;,&quot;orange&quot;))</div></pre></td></tr></table></figure>
<p>结果如下所示：<img src="http://ortxpw68f.bkt.clouddn.com/normaldistribution.png"></p>
<h2 id="正态分布累积曲线">正态分布累积曲线</h2>
<p>代码如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">set.seed(1000)</div><div class="line">x &lt;- seq(-5,5,length.out=100)</div><div class="line">y &lt;- pnorm(x,0,1)</div><div class="line">plot(x,y,col=&quot;red&quot;,xlim=c(-5,5),ylim=c(0,1),type=&quot;l&quot;,</div><div class="line">xaxs=&quot;i&quot;,yaxs=&quot;i&quot;,ylab=&quot;density&quot;,xlab=&quot;&quot;,</div><div class="line">main=&quot;The Normal Cumulative Distribution&quot;)</div><div class="line">lines(x,pnorm(x,0,0.5),col=&quot;green&quot;)</div><div class="line">lines(x,pnorm(x,0,2),col=&quot;blue&quot;)</div><div class="line">lines(x,pnorm(x,-2,1),col=&quot;orange&quot;)</div><div class="line">legend(&quot;bottomright&quot;,legend=paste(&quot;m=&quot;,c(0,0,0,-2),&quot;sd=&quot;,c(1,0.5,2,1)),lwd=1,col=c(&quot;red&quot;,&quot;green&quot;,&quot;blue&quot;,&quot;orange&quot;))</div></pre></td></tr></table></figure>
<p>结果如下所示：<img src="http://ortxpw68f.bkt.clouddn.com/normalcumulative.png"></p>
<h3 id="正态分布检验补充案例">正态分布检验补充案例</h3>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">words1 = rnorm(100)</div><div class="line">words2 = rt(100, df=3)</div><div class="line"></div><div class="line">plot(density(words1))</div><div class="line">lines(density(words2))</div><div class="line">shapiro.test(words1)</div><div class="line">shapiro.test(words2)</div><div class="line"></div><div class="line">par(mfrow=c(2,1))</div><div class="line">qqnorm(words1);qqline(words1, col = 2)</div><div class="line">qqnorm(words2);qqline(words2, col = 2)</div></pre></td></tr></table></figure>
<p>words1与words2密度图如下所示： <img src="http://ortxpw68f.bkt.clouddn.com/test%20normalDistribution.png"></p>
<p>从图上大致可以看出来words1与标准正态图比较接近。</p>
<p>用shapiro检验后的结果如下所示： <img src="http://ortxpw68f.bkt.clouddn.com/test%20normalDistribution2.png"></p>
<p>从计算结果来看，words1是p值为0.09861，大于0.05，不能否定原假定，因此words1符合正态分布。同理,words2不符合正态分布。</p>
<p>QQ图的结果如下所示： <img src="http://ortxpw68f.bkt.clouddn.com/test%20normalDistribution3.png"></p>
<p>从QQ图中可以看出，words1符合正态分布，而words2不符合正态分布。</p>
<h2 id="t分布">t分布</h2>
<p>学生t-分布（Student’s t-distribution），可简称为t分布。应用在估计呈正态分布的总体之平均数。</p>
<h3 id="t分布的密度分布图">t分布的密度分布图</h3>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">set.seed(<span class="number">1000</span>)</div><div class="line">x &lt;- seq(-<span class="number">5</span>,<span class="number">5</span>,length.out=<span class="number">1000</span>)</div><div class="line">y &lt;- dt(x,<span class="number">1</span>,<span class="number">0</span>)</div><div class="line">plot(x,y,col=<span class="string">"red"</span>,xlim=c(-<span class="number">5</span>,<span class="number">5</span>),ylim=c(<span class="number">0</span>,<span class="number">0.5</span>),type=<span class="string">"l"</span>,</div><div class="line">xaxs=<span class="string">"i"</span>,yaxs=<span class="string">"i"</span>,ylab=<span class="string">"density"</span>,xlab=<span class="string">""</span>,</div><div class="line">main=<span class="string">"The T density distribution"</span>)</div><div class="line">lines(x,dt(x,<span class="number">5</span>,<span class="number">0</span>),col=<span class="string">"green"</span>)</div><div class="line">lines(x,dt(x,<span class="number">5</span>,<span class="number">2</span>),col=<span class="string">"blue"</span>)</div><div class="line">lines(x,dt(x,<span class="number">50</span>,<span class="number">4</span>),col=<span class="string">"orange"</span>)</div><div class="line">legend(<span class="string">"topleft"</span>,legend=paste(<span class="string">"df="</span>,c(<span class="number">1</span>,<span class="number">5</span>,<span class="number">5</span>,<span class="number">50</span>),<span class="string">"ncp="</span>,c(<span class="number">0</span>,<span class="number">0</span>,<span class="number">2</span>,<span class="number">4</span>)),lwd=<span class="number">1</span>,col=c(<span class="string">"red"</span>,<span class="string">"green"</span>,<span class="string">"blue"</span>,<span class="string">"orange"</span>))</div></pre></td></tr></table></figure>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/t%20density%20distribution.png">

</div>
<h2 id="t分布的累积分布图">t分布的累积分布图</h2>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">set.seed(1)</div><div class="line">x&lt;-seq(-5,5,length.out=1000)</div><div class="line">y&lt;-pt(x,1,0)</div><div class="line">plot(x,y,col=&quot;red&quot;,xlim=c(-5,5),ylim=c(0,0.5),type=&apos;l&apos;,</div><div class="line">xaxs=&quot;i&quot;, yaxs=&quot;i&quot;,ylab=&apos;density&apos;,xlab=&apos;&apos;,</div><div class="line">main=&quot;The T Cumulative Distribution Function&quot;)</div><div class="line">lines(x,pt(x,5,0),col=&quot;green&quot;)</div><div class="line">lines(x,pt(x,5,2),col=&quot;blue&quot;)</div><div class="line">lines(x,pt(x,50,4),col=&quot;orange&quot;)</div><div class="line">legend(&quot;topleft&quot;,legend=paste(&quot;df=&quot;,c(1,5,5,50),&quot; ncp=&quot;, c(0,0,2,4)), lwd=1, col=c(&quot;red&quot;, &quot;green&quot;,&quot;blue&quot;,&quot;orange&quot;))</div></pre></td></tr></table></figure>
<h2 id="参考资料">参考资料</h2>
<ol style="list-style-type: decimal">
<li>DawnGriffiths. 深入浅出统计学[M]. 电子工业出版社, 2012.</li>
<li>高桥信陈刚. 漫画统计学[M]. 科学出版社, 2009.</li>
<li>拉里·戈尼克, 沃尔科特·史密斯. 漫画统计学入门[M]. 辽宁教育出版社, 2002.</li>
<li>陈希孺.概率论与数理统计[M].中国科学技术大学出版社,1992.</li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2017/06/20/生物统计-02正态分布与T检验/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/06/20/生物统计-02正态分布与T检验/" itemprop="url">正态分布与t检验</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-06-20T12:00:00+08:00">
                2017-06-20
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/生物统计/" itemprop="url" rel="index">
                    <span itemprop="name">生物统计</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  4,182
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  17
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="标准误与标准差的区别">标准误与标准差的区别</h2>
<p>这一内容<a href="http://rvdsd.top/2017/06/19/%E5%8C%BB%E5%AD%A6%E7%BB%9F%E8%AE%A1%E5%AD%A6-%E7%AC%AC02%E7%AB%A0%E6%95%B0%E6%8D%AE%E6%8F%8F%E8%BF%B0/">前文</a>已经提到。</p>
<h2 id="正态分布介绍">正态分布介绍</h2>
<h3 id="正态分布定义">正态分布定义</h3>
<p>若随机变量X服从一个数学期望为<span class="math inline">\(\mu\)</span>、方差为<span class="math inline">\((\sigma)^2\)</span>的正态分布，记为N(<span class="math inline">\(\mu\)</span>，<span class="math inline">\((\sigma)^2\)</span>)。其概率密度函数为正态分布的期望值<span class="math inline">\(\mu\)</span>决定了其位置，其标准差<span class="math inline">\(\sigma\)</span>决定了分布的幅度。因其曲线呈钟形，因此人们又经常称之为钟形曲线。我们通常所说的标准正态分布是<span class="math inline">\(\mu\)</span> = 0,<span class="math inline">\(\sigma\)</span> = 1的正态分布。</p>
<h2 id="r语言正态分布函数">R语言正态分布函数</h2>
<p>R语言中与正态分布有关的函数如下所示：</p>
<ol style="list-style-type: decimal">
<li>密度函数： dnorm(x, mean = 0, sd = 1, log = FALSE)</li>
<li>分布函数： pnorm(q, mean = 0, sd = 1, lower.tail = TRUE, log.p = FALSE)</li>
<li>分位数函数：qnorm(p, mean = 0, sd = 1, lower.tail = TRUE, log.p = FALSE)</li>
<li>随机函数： rnorm(n, mean = 0, sd = 1) 其余的分布函数与正态分布的前缀相同。</li>
</ol>
<h3 id="正态分布相应的概率计算">正态分布相应的概率计算</h3>
<p>求正态N(3.1.5)变量X在区间(2,4)中的概率p，如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pnorm(4,3,1.5)-pnorm(2,3,1.5)</div></pre></td></tr></table></figure>
<blockquote>
<p>pnorm(4,3,1.5)-pnorm(2,3,1.5) [1] 0.4950149</p>
</blockquote>
<h2 id="正态分布密度曲线">正态分布密度曲线</h2>
<p>下面分别绘制均值（以下用m表示）为0，标准差（以下用sd表示）为1，m=0，sd=0.5，m=0，sd=2，m=-2，sd=1的正态分布密度曲线（密度曲线下面的积分面积对应的就是相应范围内的概率）。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">set.seed(1000)</div><div class="line">x &lt;- seq(-5,5,length.out=100)</div><div class="line">y &lt;- dnorm(x,0,1)</div><div class="line">plot(x,y,col=&quot;red&quot;,xlim=c(-5,5),ylim=c(0,1),type=&quot;l&quot;,</div><div class="line">xaxs=&quot;i&quot;,yaxs=&quot;i&quot;,ylab=&quot;density&quot;,xlab=&quot;&quot;,</div><div class="line">main=&quot;The Normal Density Distribution&quot;)</div><div class="line">lines(x,dnorm(x,0,0.5),col=&quot;green&quot;)</div><div class="line">lines(x,dnorm(x,0,2),col=&quot;blue&quot;)</div><div class="line">lines(x,dnorm(x,-2,1),col=&quot;orange&quot;)</div><div class="line">legend(&quot;topright&quot;,legend=paste(&quot;m=&quot;,c(0,0,0,-2),&quot;sd=&quot;,c(1,0.5,2,1)),lwd=1,col=c(&quot;red&quot;,&quot;green&quot;,&quot;blue&quot;,&quot;orange&quot;))</div></pre></td></tr></table></figure>
<p>结果如下所示：<img src="http://ortxpw68f.bkt.clouddn.com/normaldistribution.png"></p>
<h2 id="正态分布累积曲线">正态分布累积曲线</h2>
<p>代码如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">set.seed(1000)</div><div class="line">x &lt;- seq(-5,5,length.out=100)</div><div class="line">y &lt;- pnorm(x,0,1)</div><div class="line">plot(x,y,col=&quot;red&quot;,xlim=c(-5,5),ylim=c(0,1),type=&quot;l&quot;,</div><div class="line">xaxs=&quot;i&quot;,yaxs=&quot;i&quot;,ylab=&quot;density&quot;,xlab=&quot;&quot;,</div><div class="line">main=&quot;The Normal Cumulative Distribution&quot;)</div><div class="line">lines(x,pnorm(x,0,0.5),col=&quot;green&quot;)</div><div class="line">lines(x,pnorm(x,0,2),col=&quot;blue&quot;)</div><div class="line">lines(x,pnorm(x,-2,1),col=&quot;orange&quot;)</div><div class="line">legend(&quot;bottomright&quot;,legend=paste(&quot;m=&quot;,c(0,0,0,-2),&quot;sd=&quot;,c(1,0.5,2,1)),lwd=1,col=c(&quot;red&quot;,&quot;green&quot;,&quot;blue&quot;,&quot;orange&quot;))</div></pre></td></tr></table></figure>
<p>结果如下所示：<img src="http://ortxpw68f.bkt.clouddn.com/normalcumulative.png"></p>
<h2 id="正态分布的检验">正态分布的检验</h2>
<p>判断数据是否符合正态分布通常用的是非参数检验方法（因为总体分布未知）</p>
<h3 id="shapiro.test函数">shapiro.test()函数</h3>
<p>Shapiro-Wilk正态分布检验: 用来检验是否数据符合正态分布，类似于线性回归的方法一样，是检验其于回归曲线的残差。该方法推荐在样本量很小的时候使用，样本在3到5000之间。该检验原假设为H0:数据集符合正态分布，统计量W 最大值是1，越接近1，表示样本与正态分布匹配。如果p-value小于显著性水平α(0.05)，则拒绝H0，表示样本不符合正态分布，如果p-value在大于显著性水平，则接受H0，表示样本符合正态分布。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">set.seed(1)</div><div class="line">s &lt;- rnorm(1000)</div><div class="line">shapiro.test(s)</div></pre></td></tr></table></figure>
<p>其结果为： Shapiro-Wilk normality test</p>
<p>data: s W = 0.9988, p-value = 0.7256</p>
<p>结论: W接近1，p-value&gt;0.05，不能拒绝原假设，所以数据集s符合正态分布。</p>
<h3 id="kolmogorov-smirnov连续分布检验">Kolmogorov-Smirnov连续分布检验</h3>
<p>Kolmogorov-Smirnov连续分布检验:检验单一样本是不是服从某一预先假设的特定分布的方法。以样本数据的累计频数分布与特定理论分布比较，若两者间的差距很小，则推论该样本取自某特定分布族。 该检验原假设为H0:数据集符合正态分布，H1:样本所来自的总体分布不符合正态分布。令F0(x)表示预先假设的理论分布，Fn(x)表示随机样本的累计概率(频率)函数. 统计量D为: D=max|F0(x) - Fn(x)|，D值越小，越接近0，表示样本数据越接近正态分布，如果p-value小于显著性水平α(0.05)，则拒绝H0。</p>
<p>Kolmogorov-Smirnov 检验,用法如下： ks.test(x, y, …, alternative = c(“two.sided”, “less”, “greater”), exact = NULL) R语言中ks.test有四个参数，第一个参数x为观测值向量，第二个参数y为第二观测值向量或者累计分布函数或者一个真正的累积分布函数如pnorm，只对连续CDF有效。第三个参数为指明是单侧检验还是双侧检验，exact参数为NULL或者一个逻辑值，表明是否需要计算精确的P值。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">set.seed(1)</div><div class="line">s &lt;- rnorm(1000)</div><div class="line">ks.test(s,&quot;pnorm&quot;)</div></pre></td></tr></table></figure>
<p>结果如下： One-sample Kolmogorov-Smirnov test</p>
<p>data: s D = 0.0211, p-value = 0.7673 alternative hypothesis: two-sided</p>
<p>D值很小, p-value&gt;0.05，不能拒绝原假设，所以数据集s符合正态分布。</p>
<h3 id="ks的第二案例应用">KS的第二案例应用</h3>
<h4 id="比较两组数据的分布是否相同">比较两组数据的分布是否相同</h4>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ks.test(rnorm(100),rnorm(50))</div></pre></td></tr></table></figure>
<blockquote>
<p>Two-sample Kolmogorov-Smirnov test</p>
</blockquote>
<blockquote>
<p>data: rnorm(100) and rnorm(50) D = 0.14, p-value = 0.5185 alternative hypothesis: two-sided</p>
</blockquote>
<p>在这一案例中，我们比较了两个均值和方差一样的观测值，他们D值很小，p值大于0.05，所以我们不能拒绝两个观测值分布相同的假设。</p>
<h4 id="ks比较某一数据符合某一分布">KS比较某一数据符合某一分布</h4>
<p>检验一组数据是否符合均匀分布（生成均匀分布的函数为runif))，如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ks.test(rnorm(100),&quot;punif&quot;)</div></pre></td></tr></table></figure>
<p>结果中p-value为2.2e-16，我们用rnorm(100)生成的是正态分布的数据，因此它不符合均匀分布（参数为punif）。如果参数设为pnorm，再看一下。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ks.test(rnorm(100),&quot;pnorm&quot;)</div></pre></td></tr></table></figure>
<p>结果的p值为0.6722，符合正态分布。</p>
<h3 id="pearson-拟合优度chi-square检验">Pearson 拟合优度chi-square检验</h3>
<p>（略）</p>
<h3 id="qq图">QQ图</h3>
<p>正态概率图用于检查一组数据是否服从正态分布。是实数与正态分布数据之间函数关系的散点图。如果这组实数服从正态分布，正态概率图将是一条直线。通常，概率图也可以用于确定一组数据是否服从任一已知分布，如二项分布或泊松分布。</p>
<p>QQ图是quantile—quantile的简写，一个根据正态分布的分位数，一个是样本分位数；如果两者在一条直线上，说明样本符合状态分布的分位数，即服从正态分布。QQ图是一种散点图,对应于正态分布的QQ图,就是由标准正态分布的分位数为横坐标,样本值为纵坐标的散点图. 要利用QQ图鉴别样本数据是否近似于正态分布,只需看QQ图上的点是否近似地在一条直线附近,而且该直线的斜率为标准差,截距为均值. 用QQ图还可获得样本偏度和峰度的粗略信息。</p>
<p>另外，还有一种PP图。P-P图是根据变量的累积比例与指定分布的累积比例之间的关系所绘制的图形。通过P-P图可以检验数据是否符合指定的分布。当数据符合指定分布时，P-P图中各点近似呈一条直线。如果P-P图中各点不呈直线，但有一定规律，可以对变量数据进行转换，使转换后的数据更接近指定分布。 Q-Q图同样可以用于检验数据的分布，所不同的是，Q-Q图是用变量数据分布的分位数与所指定分布的分位数之间的关系曲线来进行检验的。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">set.seed(1)</div><div class="line">s &lt;- rnorm(1000)</div><div class="line">qqnorm(s)</div><div class="line">qqline(s,col=&quot;red&quot;)</div></pre></td></tr></table></figure>
<p>结果如下所示：<img src="http://ortxpw68f.bkt.clouddn.com/qqpic.png"></p>
<p>解释：纵轴是数据的实际分位数，横轴是正态分布的理论分位数，红线是45度的参考线，如果数据是正态分布，则散点应该落在直线上。即实际分位数与理论分位数偏差不大。说明来自正态总体。</p>
<h3 id="峰度与偏度">峰度与偏度</h3>
<h4 id="峰度kurtosis">峰度（Kurtosis）</h4>
<p>峰度是描述某变量所有取值分布形态陡缓程度的统计量，它是和正态分布相比较的。 公式如下所示： <span class="math display">\[Kurtosis=\frac{\sum(X-\mu)^{4}}{\delta^{4}} -3\]</span> 正态分布的Kurtosis为K=3,为了描述方便，有时候需要减3（上述公式就减了3），有的公式没有，但原理是相同的。 <img src="http://ortxpw68f.bkt.clouddn.com/Kurtosis.png"> Kurtosis=0 与正态分布的陡缓程度相同。 Kurtosis&gt;0 比正态分布的高峰更加陡峭——尖顶峰 Kurtosis&lt;0 比正态分布的高峰来得平台——平顶峰</p>
<h4 id="偏度skewness">偏度（Skewness）</h4>
<p>偏度是描述某变量取值分布对称性的统计量。公式如下 <span class="math display">\[Skewness=\sum[(\frac{X-\mu}{\delta})^3]\]</span> <img src="http://ortxpw68f.bkt.clouddn.com/Skewness.png"> Skewness=0 分布形态与正态分布偏度相同 Skewness&gt;0 正偏差数值较大，为正偏或右偏。长尾巴拖在右边。 Skewness&lt;0 负偏差数值较大，为负偏或左偏。长尾巴拖在左边。</p>
<h3 id="正态分布检验补充案例">正态分布检验补充案例</h3>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">words1 = rnorm(100)</div><div class="line">words2 = rt(100, df=3)</div><div class="line"></div><div class="line">plot(density(words1))</div><div class="line">lines(density(words2))</div><div class="line">shapiro.test(words1)</div><div class="line">shapiro.test(words2)</div><div class="line"></div><div class="line">par(mfrow=c(2,1))</div><div class="line">qqnorm(words1);qqline(words1, col = 2)</div><div class="line">qqnorm(words2);qqline(words2, col = 2)</div></pre></td></tr></table></figure>
<p>words1与words2密度图如下所示： <img src="http://ortxpw68f.bkt.clouddn.com/test%20normalDistribution.png"></p>
<p>从图上大致可以看出来words1与标准正态图比较接近。</p>
<p>用shapiro检验后的结果如下所示： <img src="http://ortxpw68f.bkt.clouddn.com/test%20normalDistribution2.png"></p>
<p>从计算结果来看，words1是p值为0.09861，大于0.05，不能否定原假定，因此words1符合正态分布。同理,words2不符合正态分布。</p>
<p>QQ图的结果如下所示： <img src="http://ortxpw68f.bkt.clouddn.com/test%20normalDistribution3.png"></p>
<p>从QQ图中可以看出，words1符合正态分布，而words2不符合正态分布。</p>
<h2 id="r语言中进行正态分布检验的其它包">R语言中进行正态分布检验的其它包</h2>
<h3 id="nortest包">nortest包</h3>
<p>lillie.test()可以实行更精确的Kolmogorov-Smirnov检验。</p>
<p>ad.test()进行Anderson-Darling正态性检验。</p>
<p>cvm.test()进行Cramer-von Mises正态性检验。</p>
<p>pearson.test()进行Pearson卡方正态性检验。</p>
<p>sf.test()进行Shapiro-Francia正态性检验。</p>
<h3 id="fbasics包">fBasics包</h3>
<p>ksnormTest() 进行Kolmogorov-Smirnov正态性检验。</p>
<p>shapiroTest() 进行Shapiro-Wilk正态性检验。</p>
<p>jarqueberaTest() 进行jarque-Bera正态性检验。</p>
<p>dagoTest() 进行D’Agostino正态性检验。</p>
<p>adTest() 进行Anderson-Darling正态性检验。</p>
<p>cvmTest() 进行Cramer-von Mises正态性检验。</p>
<p>lillieTest() 进行Lilliefors(KS)正态性检验。</p>
<p>pchiTest() 进行Pearson chi-square正态性检验。</p>
<p>sfTest() 进行Shapiro-Francia正态性检验。</p>
<p>jbTest() Finite sample adjusted JB LM and ALM test。</p>
<p>normalTest() 进行Kolmogorov-Smirnov正态性检验。</p>
<h3 id="jarque-bera-test检验正态分布">Jarque-Bera Test检验正态分布</h3>
<p>Jarque-Bera检验是用于总体分布的正态性检验的一种方式。该检验基于数据样本的偏度和峰度，评价给定数据服从未知均值和方差正态分布的假设是否成立，正态分布的偏度（三阶矩）S=0，峰度（四阶矩）K=3，若样本来自正态总体，则他们分别在0，3附近。基于此构造一个包含x2(卡方)统计量：n为样本容量,k为自由度。代码如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">install.packages(<span class="string">"tseries"</span>)</div><div class="line"><span class="keyword">library</span>(tseries)</div><div class="line">set.seed(<span class="number">1</span>)</div><div class="line">x &lt;- rnorm(<span class="number">150</span>)</div><div class="line">res &lt;- jarque.bera.test(x)</div><div class="line">names(res)</div><div class="line">res$p.value</div></pre></td></tr></table></figure>
<p>运行结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">&gt; set.seed(<span class="number">1</span>)</div><div class="line">&gt; x &lt;- rnorm(<span class="number">150</span>)</div><div class="line">&gt; res &lt;- jarque.bera.test(x)</div><div class="line">&gt; names(res)</div><div class="line">[<span class="number">1</span>] <span class="string">"statistic"</span> <span class="string">"parameter"</span> <span class="string">"p.value"</span>   <span class="string">"method"</span>    <span class="string">"data.name"</span></div><div class="line">&gt; res$p.value</div><div class="line">[<span class="number">1</span>] <span class="number">0.8601533</span></div></pre></td></tr></table></figure>
<p>p值大于0.05，可以视为符合正态分布。</p>
<h2 id="案例第二用jarque-bera-test检验正态分布">案例第二：用Jarque-Bera Test检验正态分布</h2>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">install.packages(<span class="string">"Ecdat"</span>)</div><div class="line"><span class="keyword">library</span>(Ecdat)</div><div class="line">data(SP500)</div><div class="line">class(SP500)</div><div class="line">SPreturn &lt;- SP500$r500</div><div class="line">res &lt;- jarque.bera.test(SPreturn)</div><div class="line">names(res)</div><div class="line">res$p.value</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">&gt; class(SP500)</div><div class="line">[<span class="number">1</span>] <span class="string">"data.frame"</span></div><div class="line">&gt; <span class="keyword">library</span>(Ecdat)</div><div class="line">&gt; data(SP500)</div><div class="line">&gt; class(SP500)</div><div class="line">[<span class="number">1</span>] <span class="string">"data.frame"</span></div><div class="line">&gt; SPreturn &lt;- SP500$r500</div><div class="line">&gt; res &lt;- jarque.bera.test(SPreturn)</div><div class="line">&gt; names(res)</div><div class="line">[<span class="number">1</span>] <span class="string">"statistic"</span> <span class="string">"parameter"</span> <span class="string">"p.value"</span>   <span class="string">"method"</span>    <span class="string">"data.name"</span></div><div class="line">&gt; res$p.value</div><div class="line">[<span class="number">1</span>] <span class="number">0</span></div></pre></td></tr></table></figure>
<h2 id="t分布">t分布</h2>
<p>学生t-分布（Student’s t-distribution），可简称为t分布。应用在估计呈正态分布的总体之平均数。</p>
<h3 id="t分布的密度分布图">t分布的密度分布图</h3>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">set.seed(<span class="number">1000</span>)</div><div class="line">x &lt;- seq(-<span class="number">5</span>,<span class="number">5</span>,length.out=<span class="number">1000</span>)</div><div class="line">y &lt;- dt(x,<span class="number">1</span>,<span class="number">0</span>)</div><div class="line">plot(x,y,col=<span class="string">"red"</span>,xlim=c(-<span class="number">5</span>,<span class="number">5</span>),ylim=c(<span class="number">0</span>,<span class="number">0.5</span>),type=<span class="string">"l"</span>,</div><div class="line">xaxs=<span class="string">"i"</span>,yaxs=<span class="string">"i"</span>,ylab=<span class="string">"density"</span>,xlab=<span class="string">""</span>,</div><div class="line">main=<span class="string">"The T density distribution"</span>)</div><div class="line">lines(x,dt(x,<span class="number">5</span>,<span class="number">0</span>),col=<span class="string">"green"</span>)</div><div class="line">lines(x,dt(x,<span class="number">5</span>,<span class="number">2</span>),col=<span class="string">"blue"</span>)</div><div class="line">lines(x,dt(x,<span class="number">50</span>,<span class="number">4</span>),col=<span class="string">"orange"</span>)</div><div class="line">legend(<span class="string">"topleft"</span>,legend=paste(<span class="string">"df="</span>,c(<span class="number">1</span>,<span class="number">5</span>,<span class="number">5</span>,<span class="number">50</span>),<span class="string">"ncp="</span>,c(<span class="number">0</span>,<span class="number">0</span>,<span class="number">2</span>,<span class="number">4</span>)),lwd=<span class="number">1</span>,col=c(<span class="string">"red"</span>,<span class="string">"green"</span>,<span class="string">"blue"</span>,<span class="string">"orange"</span>))</div></pre></td></tr></table></figure>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/t%20density%20distribution.png">

</div>
<h2 id="t分布的累积分布图">t分布的累积分布图</h2>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">set.seed(1)</div><div class="line">x&lt;-seq(-5,5,length.out=1000)</div><div class="line">y&lt;-pt(x,1,0)</div><div class="line">plot(x,y,col=&quot;red&quot;,xlim=c(-5,5),ylim=c(0,0.5),type=&apos;l&apos;,</div><div class="line">xaxs=&quot;i&quot;, yaxs=&quot;i&quot;,ylab=&apos;density&apos;,xlab=&apos;&apos;,</div><div class="line">main=&quot;The T Cumulative Distribution Function&quot;)</div><div class="line">lines(x,pt(x,5,0),col=&quot;green&quot;)</div><div class="line">lines(x,pt(x,5,2),col=&quot;blue&quot;)</div><div class="line">lines(x,pt(x,50,4),col=&quot;orange&quot;)</div><div class="line">legend(&quot;topleft&quot;,legend=paste(&quot;df=&quot;,c(1,5,5,50),&quot; ncp=&quot;, c(0,0,2,4)), lwd=1, col=c(&quot;red&quot;, &quot;green&quot;,&quot;blue&quot;,&quot;orange&quot;))</div></pre></td></tr></table></figure>
<h2 id="某一数据是否符合t分布">某一数据是否符合t分布</h2>
<p>Kolmogorov-Smirnov连续分布检验: 检验单一样本是不是服从某一预先假设的特定分布的方法。以样本数据的累计频数分布与特定理论分布比较，若两者间的差距很小，则推论该样本取自某特定分布族。 该检验原假设为H0:数据集符合T分布，H1:样本所来自的总体分布不符合T分布。令F0(x)表示预先假设的理论分布，Fn(x)表示随机样本的累计概率(频率)函数. 统计量D为: D=max|F0(x) - Fn(x)| D值越小，越接近0，表示样本数据越接近T分布 p值，如果p-value小于显著性水平α(0.05)，则拒绝H0</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">set.seed(1)</div><div class="line">S&lt;-rt(1000, 1,2)</div><div class="line">ks.test(S, &quot;pt&quot;, 1, 2)</div></pre></td></tr></table></figure>
<p>其中p-value = 0.5461，说明数据集S符合df1=1, ncp=2的T分布</p>
<h2 id="方差齐性检验">方差齐性检验</h2>
<p>t检验过程，是对两样本均数(mean)差别的显著性进行检验。惟t检验须知道两个总体的方差(Variances)是否相等；t检验值的计算会因方差是否相等而有所不同。也就是说，t检验须视乎方差齐性(Equality of Variances)结果。但现在多数统计软件中已经有了方差不齐情况下的检验。另外，在ANOVA检验中，也要进行方差齐性检验。</p>
<h2 id="t检验">t检验</h2>
<p>T检验，亦称student t检验（Student’s t test），主要用于样本含量较小（例如n&lt;30），<strong>总体标准差σ未知</strong>的正态分布资料。</p>
<p>在此要提一下Z检验。 Z检验是一般用于<strong>大样本（即样本容量大于30）</strong>平均值差异性检验的方法。它是用<strong>标准正态分布</strong>的理论来推断差异发生的概率，从而比较两个平均数&gt;平均数的差异是否显著。当<strong>已知标准差</strong>时，验证一组数的均值是否与某一期望值相等时，用Z检验。</p>
<p>R中t检验的函数为t.test()，参数如下所示： t.test(x, …)</p>
<p>t.test(x, y = NULL,alternative = c(“two.sided”, “less”, “greater”),mu = 0, paired = FALSE, var.equal = FALSE, conf.level = 0.95, …)</p>
<p>参数说明： 其中x, y是我们样本数据构成的向量，alternative表示备择假设的形式，“two.sided”表示双边检验（H1: 1≠μ2）， “less”表示单边检验（H1:μ1<μ2），“greater”表示单边检验（h1:μ1>μ2），paired表示样本是否是配对的，var.equal表示两总体方差是否相等。</μ2），“greater”表示单边检验（h1:μ1></p>
<h3 id="案例运用">案例运用</h3>
<h4 id="配对t检验">配对t检验</h4>
<p>例3-6为比较两种方法对乳酸饮料中脂肪含量测定结果是否不同，随机抽取了10份乳酸饮料制品，分别用脂肪酸水解法和哥特里－罗紫法测定其结果如表3-5第(1)~(3)栏。问两法测定结果是否不同？</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">raw_data &lt;- read.csv(&quot;https://raw.githubusercontent.com/20170505a/raw_data/master/data_szq_306.csv&quot;,sep=&quot;\t&quot;)</div><div class="line"># read raw data</div><div class="line"></div><div class="line">t.test(raw_data$result[1:10]-raw_data$result[11:20],mu=0)</div></pre></td></tr></table></figure>
<p>结果与书中相同，但我觉得这个方法不一定要用配对t检验，普通的t检验也能胜任。</p>
<h4 id="双样本t检验">双样本t检验</h4>
<p>例3-7 为研究国产四类新药阿卡波糖胶囊的降血糖效果，某医院用40名II型糖尿病病人进行同期随机对照试验。研究者将这些病人随机等分到试验组(用阿卡波糖胶囊)和对照组(用拜唐苹胶囊)，分别测得试验开始前和8周时的空腹血糖，算得空腹血糖下降值见表3-6，能否认为该国产四类新药阿卡波糖胶囊与拜唐苹胶囊对空腹血糖的降糖效果不同？</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">raw_data &lt;- read.csv(&quot;https://raw.githubusercontent.com/20170505a/raw_data/master/data_szq_307.csv&quot;,,header=T,sep=&quot;,&quot;)</div><div class="line"></div><div class="line">a &lt;- as.numeric(raw_data[,1])</div><div class="line">b &lt;- as.numeric(raw_data[,2])</div><div class="line">t.test(a,b)</div></pre></td></tr></table></figure>
<p>结果p值为0.525。因此尚不能认为阿卡波糖胶囊与拜唐苹胶囊对空腹血糖的降糖效果不同。</p>
<p>​</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2017/06/18/生物统计-01统计学术语/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/06/18/生物统计-01统计学术语/" itemprop="url">医学统计学术语笔记（1）</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-06-18T12:00:00+08:00">
                2017-06-18
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/生物统计/" itemprop="url" rel="index">
                    <span itemprop="name">生物统计</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  5,912
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  24
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="观察单位observed-unit">观察单位（observed unit）</h2>
<p>也叫个体（individual），是统计研究中的基本单位，它可以是一个人，一头动物，也可能是特指一群人（例如一个家庭、一个幼儿园，一个自然村）。</p>
<h2 id="总体population">总体（population）</h2>
<p>根据研究目的而确定的同质观察单位的全体，更确切地说，它是同质的所有观察单位某种观察值的集合，例如调查某地2008年7岁正常女童的身高，而其中的观察单位（个体）则是每个女童。由于这里的总体明确规定了空间、时间、人群范围内有限个观察单位，因此称为<strong>有限总体（finite populaton）</strong>。而在一些情况下，总体的概念则是设想的或抽象的，例如研究某治疗慢性前列腺增生的药物的疗效，这里的总体的同质基础是慢性前列腺增生患者，该总体应包括用该药治疗的所有前列腺增生症患者的治疗结果，没有时间和空间的限制，其观察单位的全体数只是理论上存在的，因此可以视为“无限”，称为<strong>无限总体（infinite populaton）</strong>。</p>
<p>为了降低成本，因此在医学研究中通常彩从总体中抽取样本（sample）的方法，根据样本信息来推断总体特征，这种方法叫<strong>抽样研究（sampling research）</strong>，从总体中抽取部分观察单位的过程称为<strong>抽样（sampling）</strong>。</p>
<p>为了保证样本的代表性，抽样必须遵循<strong>随机化（randomizatoin）</strong>原则。从总体中随机抽得的部分观察单位，其实际测量的集合就是样本，该样本中包含的观察单位数称为该样本的<strong>样本含量（sample size）</strong>。例中从某地2008年7岁正常女童中，随机抽取了110名女童，测量身高，得到了110名女童的身高测量值，组成了样本；也可能从就诊的前列腺增生症患者中随机抽取了100名患者，并观察药物的治疗效果，就组成了治疗效果的样本。</p>
<h2 id="变量variable">变量（variable）：</h2>
<p>确定总体后，研究者对每个观察单位的某项特征进行观察或测量，这种特征能表现观察单位的变量异，就是变量。例如某地7岁女童的身高，体重都可以视为变量。</p>
<h2 id="计量资料measurement-data">计量资料（measurement data）</h2>
<p>又叫定量资料（quantitative data）或数值变量资料(numerical variable)，表现为数值大小，一般有试题衡单位，例如身高多少厘米，体重多少公斤。根据测量值是否连续，又可分为连续型（continuous）和离散型（discrete），连续理革可在褛范围内聚任意值，例如身高，体重，而离散型只能取整数值，例如死亡人数。</p>
<h2 id="计数资料enumeration-data">计数资料（enumeration data）</h2>
<p>又称定性资料(qualitative data )或无序分类（unordered categorical varibale）变量资料，亦称为名义变量资料，它的变量值是定性的，表现为互不相容的特性，例如结果的阴阳，家族史的有无等，分为两种：一种是二分类，例如治愈与未治愈，另一种是多分类，例如血型，A型，B型，AB型和O型。</p>
<h2 id="等级资料ranked-data">等级资料（ranked data）</h2>
<p>又称半定量资料（semi-quantitative data）或有序分类变量（ordinal categorical variable）资料：它将观察单位按某种程度分为等级，例如某药物治疗的效果为治愈、显效、好转、无效。</p>
<h2 id="其它补充">其它补充</h2>
<h3 id="强度相对数">强度相对数</h3>
<p>说明某现象发生的频率或强度，称为率。常以百分率(%)、千分率(‰)、万分率(1/万)、十万分率（1/10万）等表示。 例5-1：2839名职工，发生高血压5人，高血压发病率为5/2839=1.76‰。</p>
<h3 id="结构相对数">结构相对数</h3>
<p>表示事物内部某一部分的个体数与该事物部分个体数的总和之比，用来说明各构成部分在总体中所占的比重或分布，称为构成比，通常以100%为比例基数。 例5-2 某医院1990年因五种疾病死亡的人数共190人，其中死于恶性肿瘤者58人，恶性肿瘤死亡人数占五种疾病死亡人数的构成比为58/190=30.53% 。</p>
<h3 id="相对比">相对比</h3>
<p>相对比简称比(ratio)，是两个有关指标之比，说明两指标间的比例关系，通常以倍数或百分数（%）表示。例如某年医院出生婴儿中，男性为370，女性为358，则婴儿性别比为370/358*100=103</p>
<h3 id="同比">同比</h3>
<p>发展速度主要是为了消除季节变动的影响，用以说明本期发展水平与去年同期发展水平对比而达到的相对发展速度。如，本期2月比去年2月，本期6月比去年6月等。其计算公式为：同比发展速度=本期发展水平/去年同期发展水平×100%。</p>
<h3 id="环比">环比</h3>
<p>当前水平与前一时期水平之比，表明现象逐期的发展速度。如计算一年内各月与前一个月对比，即2月比1月，3月比2月，4月比3月 ……12月比11月，说明逐月的发展程度。</p>
<h2 id="常见数据的类型">常见数据的类型</h2>
<h3 id="离散型数据discrete-data">离散型数据(discrete data)</h3>
<p>离散型数据本质上是一种分类。最典型的例子，就是性别、种族、职业、教育程度等。在多数情况下，离散型数据并没有具体的数值（比如性别中的男和女），或者虽然形式上由数值表示，但数值本身并没有明确的意义（比如用邮政编码来记录受试者居住的地域）。有些离散变量是有某种顺序关系的，比如说教育程度可以从低到高排列，而有些离散变量并没有这种顺序，比如说某个基因的基因型。这两种情况分别称为有序变量(ordinal variable)和名义变量(nominal variable)。</p>
<h3 id="连续型数据continuous-data">连续型数据(continuous data)</h3>
<p>连续型数据的数值有具体的科学意义，并且可以在数轴上的某个范围连续取值比如身高、体重、血糖浓度、肾小球滤过率等。</p>
<h2 id="极差">极差</h2>
<p>一组变量值中最大值与最小值的差值。</p>
<h2 id="均值">均值</h2>
<p>太简单，略。</p>
<h3 id="算术均值arithmatic-mean">算术均值(arithmatic mean)</h3>
<p>算术平均数是对集中趋势的最常用的描述。我们对某个量进行了n次观测，把测量到的数值分别记为X1, X2,…, Xn，那么要得到算术平均数，只需把X1到Xn加起来，再除以数据的个数n。数学公式为： <span class="math display">\[ \bar{X}=\frac{\sum_{i=1}^nX{_i}}{n}  \]</span></p>
<h3 id="几何均值geometric-mean">几何均值（geometric mean）</h3>
<p>几何平均数是指n个观察值连乘积的n次方根。</p>
<h2 id="中位数median">中位数(median)</h2>
<p>中位数是把该变量所有取值从小到大（或从大到小）排序，取最中间的一个（例如总共有21个数，则取排行第11的）。如果样本量是偶数，则取中间两个数的平均。</p>
<h2 id="众数">众数</h2>
<p>一组数据中出现次数最多的数值，叫众数，有时众数在一组数中有好几个。用M表示。 理性理解：简单的说，就是一组数据中占比例最多的那个数。</p>
<p>例如：2，3，3，3，4，5的众数是3。 但是，如果有两个或两个以上个数出现次数都是最多的，那么这几个数都是这组数据的众数。 例如：2，2，3，3，4，5的众数是2和3。 其次，如果所有数据出现的次数都一样，那么这组数据没有众数。 例如：2，3，4，5没有众数。</p>
<h2 id="百分位数percentile">百分位数(percentile)</h2>
<p>如果将一组数据从小到大排序，并计算相应的累计百分位，则某一百分位所对应数据的值就称为这一百分位的百分位数。可表示为：一组n个观测值按数值大小排列。如，处于p%位置的值称第p百分位数。</p>
<h3 id="百分位数的计算">百分位数的计算</h3>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">w&lt;-c(75.0,64.0,47.4,66.9,62.2,62.2,58.7,63.5,66.6,64.0,57.0,69.0,56.9,50.0,72.0) # 建立向量w</div><div class="line">quantile(w) # 给出w的四分位数</div><div class="line">quantile(w,probs=seq(0,1,0.2),na.rm=FALSE) # 给出向量w的20%，40%分位数</div><div class="line">quantile(w,0.80) # 求w的80%分位数</div><div class="line">quantile(w,0.75)- quantile(w,0.25) #半极差计算</div></pre></td></tr></table></figure>
<p>结果如下： <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">&gt; quantile(w) # 给出w的四分位数</div><div class="line">   0%   25%   50%   75%  100% </div><div class="line">47.40 57.85 63.50 66.75 75.00 </div><div class="line">&gt; quantile(w,probs=seq(0,1,0.2),na.rm=FALSE) # 给出向量w的20%，40%分位数</div><div class="line">   0%   20%   40%   60%   80%  100% </div><div class="line">47.40 56.98 62.20 64.00 67.32 75.00 </div><div class="line">&gt; quantile(w,0.80) # 求w的80%分位数</div><div class="line">  80% </div><div class="line">67.32 </div><div class="line">&gt; quantile(w,0.75)- quantile(w,0.25) #半极差计算</div><div class="line">75% </div><div class="line">8.9</div></pre></td></tr></table></figure></p>
<p>另外一种方法是用<code>cumsum()</code>函数来计算：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">cumsum(round(table(w)/length(w)*100,2)) # cumsum表示的是累积之和</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&gt; cumsum(round(table(w)/length(w)*100,2)) # cumsum表示的是累积之和</div><div class="line">  47.4     50   56.9     57   58.7   62.2   63.5     64   66.6   66.9     69     72     75 </div><div class="line">  6.67  13.34  20.01  26.68  33.35  46.68  53.35  66.68  73.35  80.02  86.69  93.36 100.03</div></pre></td></tr></table></figure>
<h2 id="四分位数quartile">四分位数（Quartile)</h2>
<p>统计学中，把所有数值由小到大排列并分成四等份，处于三个分割点位置的数值就是四分位数。第一，四分位数 (Q1)，又称“较小四分位数”，等于该样本中所有数值由小到大排列后第25%的数字。第二，四分位数 (Q2)，又称“中位数”，等于该样本中所有数值由小到大排列后第50%的数字。第三，四分位数 (Q3)，又称“较大四分位数”，等于该样本中所有数值由小到大排列后第75%的数字。第三，四分位数与第一四分位数的差距又称四分位距（InterQuartile Range,IQR）。四分位距的优点在于，与全距（极差）相比，较少受异常值的影响。 R中用来显示四分位数的函数是quantile，另外用boxplot可以绘制出某个数据集的箱线图。</p>
<p>箱线图结果<code>boxplot(w)</code>如下所示<img src="http://ortxpw68f.bkt.clouddn.com/boxplot2.png"></p>
<p>条睛线图的解读：最下面是下界，最上面的圆圈是上界，上界的圆圈是异常值，中间矩形的底边是下分位数，上边是上四分位数，中间的粗线是中位数，箱体的高是四分位距 。</p>
<h2 id="极差-1">极差</h2>
<p>又叫全距(Range)，是用来表示统计资料中的变异量数(measures of variation)，其最大值与最小值之间的差距；即最大值减最小值后所得之数据。</p>
<h2 id="四分位数">四分位数</h2>
<p>把所有数据点从小到大排列，并且分成样本量相等的四块。那么，这四块之间就会产生三个分界点（称为四分位点，quartile)，从小到大分别用Q1, Q2, Q3表示。如果我们取Q3和Q1之差，那么这就是四分位差(interquartile range)，也称为内距。由于四分位差不考虑首尾两端的数据点。</p>
<h2 id="变异系数coefficient-of-variation">变异系数(coefficient of variation)</h2>
<p>简称为CV，标准差与均值的比值。公式为： <span class="math display">\[ CV=\frac{S}{\bar{X}}\times100\% \]</span></p>
<h2 id="箱线图和频率直方图">箱线图和频率直方图</h2>
<p>箱线图(boxplot)汇集了中位数、四分位差以及一些其他信息，能够使我们对样本的分布有一个直观的了解，也可以让我们快速发现数据中可能存在的错误（例如因为数据录入或单位错误导致的异常值）。它之所以被称为箱线图，是因为它用一个“箱子”来表示我们的数据中最靠中间的一半（即Q1和Q3之间的所有数据点），而用箱子上下的两根“胡须”来表示数据的上下限范围。箱线图的画法以及含义见下图。</p>
<h2 id="方差与离均差平方和">方差与离均差平方和</h2>
<p>方差（variance）也称均方差（mean square deviation），它反映的是一组数据的平均离散水平，就总体而言，应该考虑每一个变量值X与均数u的差值，即离均差(X-<span class="math inline">\(\mu\)</span>)，由于离均差(X-<span class="math inline">\(\mu\)</span>)有正有负，最终所有离均差的和<span class="math inline">\((X-\mu)\)</span>为0，因此离均差的和无法描述一组数据的变异大小。因此将离均差平方后相加得到平方和<span class="math inline">\(Var(X)=E(X-\mu)^2\)</span>，这就是离均差平方和（sum of squares of deviations from mean），这就消除了正负的影响。虽然离均差平方和消除了正负的影响，但是如果变量值N越大，则离均差平方和也越大，为此，将离均离平方和除以N就得到了方差，方差用<span class="math inline">\(\delta^2\)</span>表示，计算公式为： <span class="math display">\[ \delta^2={\frac{\sum(X-\mu)^2}{N}}  \]</span></p>
<h2 id="标准差">标准差</h2>
<p>标准差（standard deviation）是方差的正平方根，其单位与原变量值的单位相同，总体标准差用表示，计算公式为： <span class="math display">\[ \delta=\sqrt{\frac{\sum(X-\mu)^2}{N}}  \]</span></p>
<h3 id="标准差计算函数">标准差计算函数</h3>
<p>在Excel中计算方差的公式为<code>STDEV.P</code>和<code>STDEV.S</code>其中，STDEV.P计算时，认为你给出的数据是总体，因此它的分母为N，而STDEV.S计算时，认为你给出的数据是样本，因此它的分母为N-1。</p>
<p>而在R中，用到的函数为<code>sd</code>，默认的就是样本，因此分母为N-1。</p>
<h3 id="样本标准差">样本标准差</h3>
<p>一般情况下，总体均数<span class="math inline">\(\mu\)</span>未知，需要用样本无数估计，数理统计证明：若用样本个数n来代替N，计算出的样本方差对的估计偏小，需要将n用n-1来替代，样本方差 <span class="math display">\[ S=\sqrt{\frac{\sum(X-\bar{X})^2}{n-1}}  \]</span></p>
<h2 id="标准误与标准差的区别">标准误与标准差的区别</h2>
<p>在医学统计中，还经常遇到标准差与标准误。例如我们要调查地区A中10岁男孩的身高。如果全部都统计下来，直接测是最准确的数据。但是成本高，不现实。因此需要进行采样，一次测量100个男孩的身高，求这一次的均值M1与标准差S1，如果采样10次，每次都取100人，我们会得到10个均值，分别记为M1，M2，M3…M10，对这10个均值再求一个均值M以及标准差S，其中这个标准差S就是标准误，即均值的标准差。</p>
<h3 id="标准误与标准差的联系">标准误与标准差的联系</h3>
<p>SEM表示每次抽样获得的均数的标准差，因此如果要获取SEM，就必须做很多次抽样，这样也非常麻烦，但是标准误与标准差虽然不是一个概念，但在数学上有一定的联系，其公式如下所示： <span class="math display">\[ SEM=SD/\sqrt{N}  \]</span></p>
<h2 id="正态分布">正态分布</h2>
<p>若随机变量X服从一个数学期望为<span class="math inline">\(\mu\)</span>、方差为<span class="math inline">\({\sigma}^2\)</span>的正态分布，记为<span class="math inline">\(N(\mu,{\sigma}^2)\)</span>。其概率密度函数为正态分布的期望值<span class="math inline">\(\mu\)</span>决定了其位置，其标准差<span class="math inline">\(\sigma\)</span>决定了分布的幅度。因其曲线呈钟形，因此人们又经常称之为钟形曲线。我们通常所说的标准正态分布，即<span class="math inline">\(\mu\)</span> = 0,<span class="math inline">\(\sigma\)</span> = 1的正态分布，其公式为： <span class="math display">\[ p(x|\mu,\sigma)=\mathcal{N}(x|\mu,\sigma)=\frac{1}{\sigma\sqrt{2\pi}}\exp(-\frac{(x-\mu)^2}{2\sigma^2})\]</span></p>
<h2 id="医学参考值">医学参考值</h2>
<p>医学参考值（reference value）是指包括约大多数正常人的人体形态、功能和代谢产物等各种生理及生化指标常数，也称正常值。由于存在个体差异，生物医学数据并非常数而是在一定范围内波动，帮采用学参考值范围（medical reference range）作为判定正常和异常的参考标准。 医学参考值范围涉及采用单侧界值还是双侧界值的问题，这通常是依据医学专业知识而定，例如课本（医学统计学，孙振球，第四版）中的例2-1的红细胞数无论过低或过高均属异常，就采用双侧参考值范围制定下侧和上侧界值；血清转氨酶仅过高异常，应采用单侧参考值范围制定上侧界值；肺活量仅过低异常，就采用单侧参考值范围制定下侧界值。医学上常用的参考值范围有90%，95%，99%等，其中95%最常用。</p>
<p>其中确定参考值的方法通常有两种，分别为正态分布法和百分位数法。</p>
<h3 id="正态分布法">正态分布法</h3>
<p>对于服从正态分布的医学数据，可采用正态分布法计算参考值的范围，其计和公式为： 双侧1-<span class="math inline">\(1-\alpha\)</span>参考值范围为：<span class="math inline">\(\bar{X}\pm\mu_{\alpha/2}S\)</span> 单侧1-<span class="math inline">\(\alpha\)</span>的参考值范围为：<span class="math inline">\(&gt;\bar{X}-\mu_{\alpha/2}S\)</span>。 其中<span class="math inline">\(bar{X}\)</span>为无数，S为标准差，<span class="math inline">\(\mu\)</span>值可以查表得到。</p>
<p>案例：现在我们计算课本<a href="#fn1" class="footnoteRef" id="fnref1"><sup>1</sup></a>例2-1的资料估计正常成年女子的红细胞数的95%的参考值范围。计算结果如下所示： <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">raw_data &lt;- read.csv(&quot;https://raw.githubusercontent.com/20170505a/raw_data/master/data_szq_201.csv&quot;) #导入数据</div><div class="line">extract_data &lt;- raw_data[,1] # 提取第一列数据</div><div class="line">sd1 &lt;- sd(extract_data)</div><div class="line">mean1 &lt;- mean(extract_data)</div><div class="line">mean1 - 1.96*sd1 # 参考值的下限</div><div class="line">mean1 + 1.96*sd1 # 参考值的上限</div></pre></td></tr></table></figure></p>
<p>因此参考值的范围为3.353299，5.104657。</p>
<h3 id="百分位数法">百分位数法</h3>
<p>偏态分布资料医学参考值范围的制定通常采用百分位数法，所要求的样本含量比正态分布法要多（不低于100），其计算公式为： 双侧<span class="math inline">\(1-\alpha\)</span>参透值范围为：<span class="math inline">\(P_{100\alpha/2}{\sim}P_{100-100\alpha/2}\)</span></p>
<p>单侧<span class="math inline">\(1-\alpha\)</span>参透值范围为：<span class="math inline">\(&gt;P_{100\alpha}\)</span>或<span class="math inline">\(&gt;P_{100-100\alpha}\)</span> 案例：课本无原始数据，此题略过。</p>
<h2 id="补充部分例题的计算">补充：部分例题的计算</h2>
<h3 id="例题2-1的描述性统计">例题2-1的描述性统计</h3>
<p>某医院用随机抽样方法检查了138名正常成年女子的红细胞数 ，其测量结果如下，试编制频数分布表。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div></pre></td><td class="code"><pre><div class="line">raw_data &lt;- read.csv(&quot;https://raw.githubusercontent.com/20170505a/raw_data/master/data_szq_201.csv&quot;) </div><div class="line">#导入数据</div><div class="line"></div><div class="line">extract_data &lt;- raw_data[,1] </div><div class="line"># 提取第一列数据</div><div class="line"></div><div class="line">library(reshape2)</div><div class="line">breaks&lt;-seq(from = 3.07, to = 5.47, by = 0.2) </div><div class="line"># 产生各个组距</div><div class="line"></div><div class="line">data_table&lt;-cut(extract_data,breaks=breaks,right=FALSE) </div><div class="line">#分组,right=FALSE表示左闭右开</div><div class="line"></div><div class="line">library(reshape2) </div><div class="line">#载入reshape2包，使用其中的melt函数</div><div class="line"></div><div class="line">melt(table(data_table)) </div><div class="line">#查看频数分布</div><div class="line"></div><div class="line">middle_data&lt;-c() </div><div class="line">#求组中值，组中值从表中可以看出来就是区间两边的数的平均数</div><div class="line"></div><div class="line">for(i in seq(1,12))&#123;</div><div class="line">  middle &lt;- (breaks[i]+breaks[i+1])*0.5</div><div class="line">  middle_data&lt;-append(middle_data,middle)</div><div class="line">&#125;</div><div class="line"></div><div class="line"># 绘图表</div><div class="line">hist(extract_data,breaks,</div><div class="line">     right=FALSE,main=&quot;&quot;,</div><div class="line">     xlab=&quot;&quot;,ylab=&quot;频数&quot;,</div><div class="line">     axes=FALSE,</div><div class="line">     border=&quot;grey&quot;,</div><div class="line">     col=&quot;red&quot;,freq=F)</div><div class="line">#data为数据集，breaks则是分组依据，right=FALSE则是左开右闭,xlab，ylab控制坐标</div><div class="line"></div><div class="line">lines(density(extract_data)) </div><div class="line">#加入概率密度曲线</div><div class="line"></div><div class="line">title(xlab=&quot;红细胞数(×10e-12/L)&quot;,line=0.8)</div><div class="line">#加x轴的标题，往下超过x轴垂直距离为0.8个行距</div><div class="line"></div><div class="line">text(4.5,-2.8,&quot;-12&quot;,cex=0.5)</div><div class="line">mtext(&quot;138名正常成年女性红细胞数的频数分布&quot;,1,line=2.5,cex=1.2,font=2)</div><div class="line">#加主标题,1表示为下方</div><div class="line"># line=2.5表示超过x轴垂直距离为2.5个行距</div><div class="line"># cex为字体扩大倍数</div><div class="line"># font=2表示加粗</div><div class="line"></div><div class="line">abline(h=0)</div><div class="line">#绘制y=0的线段，用此线表示x轴</div><div class="line"></div><div class="line">axis(1,at=middle_data,tick=FALSE,pos=0.03)</div><div class="line"># 绘制x轴，坐标为middle_data</div><div class="line"># tick=FALSE表示坐标刻度不绘出,pos=1表示坐标轴在y=1处</div><div class="line"></div><div class="line">axis(2)</div><div class="line">#绘制y轴</div></pre></td></tr></table></figure>
<p>频数分布如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">&gt; melt(table(data_table)) #查看频数分布</div><div class="line">    data_table value</div><div class="line">1  [3.07,3.27)     2</div><div class="line">2  [3.27,3.47)     3</div><div class="line">3  [3.47,3.67)     9</div><div class="line">4  [3.67,3.87)    14</div><div class="line">5  [3.87,4.07)    22</div><div class="line">6  [4.07,4.27)    30</div><div class="line">7  [4.27,4.47)    21</div><div class="line">8  [4.47,4.67)    15</div><div class="line">9  [4.67,4.87)    10</div><div class="line">10 [4.87,5.07)     6</div><div class="line">11 [5.07,5.27)     4</div><div class="line">12 [5.27,5.47)     2</div></pre></td></tr></table></figure>
<p>图表如下所示<img src="http://ortxpw68f.bkt.clouddn.com/fig21.png">：</p>
<p>对例2-1，例2-2和例2-14已计算出某医院随机抽查的138名成年女子的红细胞数均数 ，标准差 。试估计该医院所抽查成年女子的红细胞数：①在4.0 以下者占成年女子总人数的百分比；②在4.00~5.00 之间者占成年女子总人数的百分比；③在5.00 以上者占成年女子总人数的百分比。 计算过程如下： <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">mean.data &lt;- mean(extract_data)</div><div class="line">sd.data &lt;- sd(extract_data)</div><div class="line">pnorm((4-mean.data)/sd.data) # 4.0以下的百分比</div><div class="line">pnorm((5-mean.data)/sd.data) #5.0以下的百分比</div><div class="line">1-pnorm((5-mean.data)/sd.data) #5.0以上的百分比</div><div class="line">pnorm((5-mean.data)/sd.data)-pnorm((4-mean.data)/sd.data) #在4.00~5.00 之间的百分比</div><div class="line"></div><div class="line">#或者是：</div><div class="line">pnorm(5,mean(data),sd(data))-pnorm(4,mean(data),sd(data))</div><div class="line"></div><div class="line"># 绘制数据集的正态分布图</div><div class="line">x &lt;- seq(min(extract_data)-0.52,max(extract_data)+0.52,length=1000)</div><div class="line">y &lt;- dnorm(x,mean(extract_data),sd(extract_data))</div><div class="line">r1 &lt;- 4</div><div class="line">r2 &lt;- 5</div><div class="line">x2 &lt;- c(r1,r1,x[x&lt;r2&amp;x&gt;r1],r2,r2)</div><div class="line">y2=c(0,dnorm(c(r1,x[x&lt;r2&amp;x&gt;r1],r2),mean(data),sd(data)),0)</div><div class="line">plot(x,y,type=&quot;l&quot;,xlab=&quot;&quot;,ylab=&quot;&quot;,lty=1)</div><div class="line">abline(0,0)</div><div class="line">polygon(x2,y2,col=&quot;grey&quot;)</div></pre></td></tr></table></figure></p>
<p><strong>结果如下所示：</strong> <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">[1] 0.3041459</div><div class="line">&gt; pnorm((5-mean.data)/sd.data) #5.0以下的百分比</div><div class="line">[1] 0.9578038</div><div class="line">&gt; 1-pnorm((5-mean.data)/sd.data) #5.0以上的百分比</div><div class="line">[1] 0.04219616</div><div class="line">&gt; pnorm((5-mean.data)/sd.data)-pnorm((4-mean.data)/sd.data) #在4.00~5.00 之间的百分比</div><div class="line">[1] 0.653658</div><div class="line">&gt; pnorm(5,mean(data),sd(data))-pnorm(4,mean(data),sd(data))</div><div class="line">[1] 0.6532998</div><div class="line">结果与书中的不太一样，但结果接近，我估计是因为书中是查表，用的是近似值，R中的比较精确</div></pre></td></tr></table></figure></p>
<p>数据的正态分布图如下所示<img src="http://ortxpw68f.bkt.clouddn.com/fig22.png">：</p>
<h3 id="例2-4几何均数">例2-4：几何均数</h3>
<p>某地5例微丝蚴血症患者治疗7年后用间接荧光抗体试验没得某抗体满意度例数分别为10，20，40，40，160，求几何均数。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">data24&lt;-c(10,20,40,40,160)</div><div class="line">exp(mean(log(data24)))</div></pre></td></tr></table></figure>
<p>结果如下： <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&gt; data24</div><div class="line">[1]  10  20  40  40 160</div><div class="line">&gt; exp(mean(log(data24)))</div><div class="line">[1] 34.82202</div></pre></td></tr></table></figure></p>
<h3 id="例2-5-平均抗体滴度">例2-5 平均抗体滴度</h3>
<p>69例风湿关节炎(RA)患者血清EBV-VCA-IgG抗体满意度的分布，求其平均抗体滴度。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">data25&lt;-c(10,40,80,160,160,320,640,640,10,40,80,160,160,320,640,640,</div><div class="line">10,40,80,160,320,320,640,640,10,40,80,160,320,320,640,640,20,40,80,</div><div class="line">160,320,320,640,1280,20,40,80,160,320,320,640,1280,20,40,80,160,320,</div><div class="line">320,640,40,40,80,160,320,320,640,40,80,80,160,320,640,640)</div><div class="line">x &lt;- table(data25)</div><div class="line">x &lt;- data.frame(x)</div><div class="line">x$countdown &lt;- as.numeric(levels(x$data25))</div><div class="line">x$lgX &lt;- round(log10(x$countdown),4)</div><div class="line">x$flgX &lt;- round(x$Freq*x$lgX,4)</div></pre></td></tr></table></figure>
<p>结果为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">&gt; x</div><div class="line">  data25 Freq countdown    lgX    flgX</div><div class="line">1     10    4        10 1.0000  4.0000</div><div class="line">2     20    3        20 1.3010  3.9030</div><div class="line">3     40   10        40 1.6021 16.0210</div><div class="line">4     80   10        80 1.9031 19.0310</div><div class="line">5    160   11       160 2.2041 24.2451</div><div class="line">6    320   15       320 2.5051 37.5765</div><div class="line">7    640   14       640 2.8062 39.2868</div><div class="line">8   1280    2      1280 3.1072  6.2144</div><div class="line"></div><div class="line">上述结果是书中的频数表，与R的计算关系不大，在R中可以直接计算，如下</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; exp(mean(log(data25)))</div><div class="line">[1] 150.6411</div></pre></td></tr></table></figure>
<h3 id="例2-6-中位数">例2-6 中位数</h3>
<p>7名病人患某病的潜伏期分别为2，3，4，5，6，9，16天，求其中位数。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&gt; data26&lt;-c(2,3,4,5,6,9,16)</div><div class="line">&gt; median(data26)</div><div class="line">[1] 5</div></pre></td></tr></table></figure>
<h3 id="例2-11均数和极差">例2-11：均数和极差</h3>
<p>试计算下面三组同龄男孩的身高 均数和极差。 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">range.f &lt;- function (x) (max(x)-min(x))</div><div class="line">甲组 &lt;- c(90,95,100,105,110)</div><div class="line">乙组 &lt;- c(96,98,100,102,104)</div><div class="line">丙组 &lt;- c(96,99,100,101,104)</div><div class="line">range.f(甲组)</div><div class="line">mean(甲组)</div><div class="line">range.f(乙组)</div><div class="line">mean(乙组)</div><div class="line">range.f(丙组)</div><div class="line">mean(丙组)</div></pre></td></tr></table></figure></p>
<p>结果如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">&gt; range.f(甲组)</div><div class="line">[1] 20</div><div class="line">&gt; mean(甲组)</div><div class="line">[1] 100</div><div class="line">&gt; range.f(乙组)</div><div class="line">[1] 8</div><div class="line">&gt; mean(乙组)</div><div class="line">[1] 100</div><div class="line">&gt; range.f(丙组)</div><div class="line">[1] 8</div><div class="line">&gt; mean(丙组)</div><div class="line">[1] 100</div></pre></td></tr></table></figure>
<div class="footnotes">
<hr>
<ol>
<li id="fn1"><p>如无特殊注明，课本均指的是：孙振球 and 徐勇勇 (2014). 医学统计学.第4版, 人民卫生出版社.<a href="#fnref1">↩</a></p></li>
</ol>
</div>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/9/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/9/">9</a><span class="page-number current">10</span>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">RVDSD</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">93</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">9</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">83</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          <div class="links-of-author motion-element">
            
          </div>

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

<div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">RVDSD</span>

  
</div>



<div class="powered-by">
<i class="fa fa-user-md"></i><span id="busuanzi_container_site_uv">
  本站访客数:<span id="busuanzi_value_site_uv"></span>
</span>
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.3</div>




<div class="theme-info">
  <div class="powered-by"></div>
  <span class="post-count">博客全站共309.2k字</span>
</div>

        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.3"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.3"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.3"></script>



  


  




	





  





  










  
  <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/valine@1.1.4/dist/Valine.min.js"></script>
  <script type="text/javascript">
    new Valine({
        av: AV,
        el: '#vcomments' ,
        verify: true,
        notify: true,
        app_id: '4ORLDMxXCFDLSHPJ4wSSDkkw-gzGzoHsz',
        app_key: 'HSWpCY7XlN0pGV5DCrKoC0ic',
        placeholder: 'Comment input placeholder'
    });
  </script>



  





  

  

  
  

  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config("");
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="custom_mathjax_source">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->
  


  

  

</body>
</html>
