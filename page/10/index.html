<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.3" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.3">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.3" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta property="og:type" content="website">
<meta property="og:title" content="RVDSD的个人笔记本">
<meta property="og:url" content="http://rvdsd.top/page/10/index.html">
<meta property="og:site_name" content="RVDSD的个人笔记本">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="RVDSD的个人笔记本">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.3',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://rvdsd.top/page/10/"/>





  <title>RVDSD的个人笔记本</title><!-- hexo-inject:begin --><!-- hexo-inject:end -->
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">RVDSD的个人笔记本</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">学习过程中的输出</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2018/04/02/Python/Python学习笔记（2）-数据类型之数字与字符串与格式化输出/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/04/02/Python/Python学习笔记（2）-数据类型之数字与字符串与格式化输出/" itemprop="url">Python学习笔记（2）——数据类型之数字与字符串</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-04-02T12:00:00+08:00">
                2018-04-02
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Python/" itemprop="url" rel="index">
                    <span itemprop="name">Python</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  6,381
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  27
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="数据结构简介">数据结构简介</h2>
<p><code>数据结构</code>是以某种方式（例如通过编号）组合起来的数据元素（例如数字，字符）的集合。在Python中，最基本的数据结构就是<code>序列</code>(<code>sequence</code>)。序列中每个元素都有编号，这个编号就是元素的位置或索引，其中第一个元素的索引是0，第二个是1，第三个是2，依此类推。</p>
<h2 id="容器container">容器(container)</h2>
<p>Python支持一种数据结构的基本概念，名为<code>容器</code>。容器基本上就是可包含其它对象的对象，两种主要的容器是序列（例如列表和元组）和映射（如字典），在序列中，每个元素都有编号，而在映射中，每个元素都有名称（也叫<code>键(key)</code>）。有一种既不是序列，也不是映射的容器，叫<code>集合(set)</code>。</p>
<h2 id="python数据类型概览">Python数据类型概览</h2>
<p>python3中有六个标准的数据类型，分别为：①Number（数字）；②String（字符串）；③List（列表）；④Tuple（元组）；⑤Sets（集合）；⑥Dictionary（字典）。</p>
<p>根据能否更改这些类型变量的值，可以把这六个标准类型划分为两类：</p>
<p>第一类：不可变数据（四个）：Number（数字）、String（字符串）、Tuple（元组）、Sets（集合）；</p>
<p>第二类：可变数据（两个）：List（列表）、Dictionary（字典）。</p>
<p>根据不同类型的数据内的元素是否有顺序，还可以划分两类：</p>
<p>第一类：有序序列：列表，元组，字符串；</p>
<p>第二类：无序序列：字典，集合。</p>
<h2 id="变量的赋值">变量的赋值</h2>
<p>Python中变量要遵循一定的规则，例如不得以数字开头，不得以Python关键字作为变量。此外，Python还提供了一个函数用于判断一个字符串能否作为变量的名称，即<code>isidentifier()</code>，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">'abc'</span>.isidentifier()</div><div class="line"><span class="keyword">True</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">'3abc'</span>.isidentifier()</div><div class="line"><span class="keyword">False</span></div></pre></td></tr></table></figure>
<h3 id="常规赋值操作">常规赋值操作</h3>
<p>Python使用等号（=）给变量赋值，等号（=）运算符左边是一个变量名,等号（=）运算符右边是存储在变量中的值，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">biotest@biotest-VirtualBox:~/python3/<span class="number">01</span>basic$ cat variable.py </div><div class="line"><span class="comment">#!/usr/bin/python3</span></div><div class="line"></div><div class="line">counter = <span class="number">100</span></div><div class="line">miles = <span class="number">1000.00</span></div><div class="line">name = <span class="string">"runoob"</span></div><div class="line"></div><div class="line">print(counter)</div><div class="line">print(miles)</div><div class="line">print(name)</div><div class="line">biotest@biotest-VirtualBox:~/python3/<span class="number">01</span>basic$ python3 variable.py </div><div class="line"><span class="number">100</span></div><div class="line"><span class="number">1000.0</span></div><div class="line">runoob</div></pre></td></tr></table></figure>
<h3 id="多变量赋值">多变量赋值</h3>
<p>Python可以同时对多个变量进行赋值，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">a = b = c =<span class="number">1</span></div></pre></td></tr></table></figure>
<p>或者像这样：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">a, b, c = <span class="number">1</span>, <span class="number">2</span>, <span class="string">"runoob"</span></div></pre></td></tr></table></figure>
<p>这种赋值试方式，就是相当于<code>a = 1, b = 2, c = &quot;runoob&quot;</code>。</p>
<h3 id="判断是否是同一个对象is">判断是否是同一个对象——is</h3>
<p>两个变量是否指向的是同一个对象，可以用is 运算符，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>a = <span class="string">'banana'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>b = <span class="string">'banana'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>a <span class="keyword">is</span> b</div><div class="line"><span class="keyword">True</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>b <span class="keyword">is</span> a</div><div class="line"><span class="keyword">True</span></div></pre></td></tr></table></figure>
<h2 id="number数字">Number（数字）</h2>
<h3 id="类型判断函数type">类型判断函数type()</h3>
<p>Python3中的数字类型具体包括<code>int（整型）</code>，<code>float（浮点型）</code>，<code>bool（布尔型）</code>和<code>complex（复数型）</code>这四种。使用内置的<code>type()</code>函数可以查看对象的类型，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>a, b, c, d = <span class="number">20</span>, <span class="number">5.5</span>, <span class="keyword">True</span>, <span class="number">4</span>+<span class="number">4j</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(type(a), type(b), type(c), type(d))</div><div class="line">&lt;<span class="class"><span class="keyword">class</span> '<span class="title">int</span>'&gt; &lt;<span class="title">class</span> '<span class="title">float</span>'&gt; &lt;<span class="title">class</span> '<span class="title">bool</span>'&gt; &lt;<span class="title">class</span> '<span class="title">complex</span>'&gt;</span></div><div class="line"><span class="class">&gt;&gt;&gt;</span></div></pre></td></tr></table></figure>
<h3 id="类型判断函数instance">类型判断函数instance()</h3>
<p>还可以通过<code>instance</code>函数来判断，这个函数的使用格式为<code>instance(a,b)</code>，即判断a是否是b的一个实例，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>a = <span class="number">111</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>isinstance(a, int)</div><div class="line"><span class="keyword">True</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>isinstance(a, float)</div><div class="line"><span class="keyword">False</span></div></pre></td></tr></table></figure>
<p><code>isinstance</code>和<code>type()</code>的区别可以通过一些代码来看：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">biotest@biotest-VirtualBox:~/python3/<span class="number">01</span>basic$ cat type_instance_diff.py </div><div class="line"><span class="comment">#!usr/bin/python3</span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span>:</span></div><div class="line">    <span class="keyword">pass</span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span><span class="params">(A)</span>:</span></div><div class="line">    <span class="keyword">pass</span></div><div class="line"></div><div class="line">print(isinstance(A(),A))</div><div class="line">print(type(A()) == A)</div><div class="line">print(isinstance(B(),A))</div><div class="line">print(type(B()) == A)</div><div class="line"></div><div class="line">biotest@biotest-VirtualBox:~/python3/<span class="number">01</span>basic$ python3 type_instance_diff.py </div><div class="line"><span class="keyword">True</span></div><div class="line"><span class="keyword">True</span></div><div class="line"><span class="keyword">True</span></div><div class="line"><span class="keyword">False</span></div></pre></td></tr></table></figure>
<p>区别就是，<code>type()</code>认为子类与父类不是一个类型，<code>isinstance()</code>认为子类与父类是一个类型。</p>
<h3 id="字符串转换为整型">字符串转换为整型</h3>
<p>不同类型的变量有时候会出现错误，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>num = <span class="number">1</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>string = <span class="string">'1'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(num + string)</div><div class="line">Traceback (most recent call last):</div><div class="line">  File <span class="string">"&lt;stdin&gt;"</span>, line <span class="number">1</span>, <span class="keyword">in</span> &lt;module&gt;</div><div class="line">TypeError: unsupported operand type(s) <span class="keyword">for</span> +: <span class="string">'int'</span> <span class="keyword">and</span> <span class="string">'str'</span></div></pre></td></tr></table></figure>
<p>因此，只要在一段代码中要涉及不同类型的变量，最好使用<code>type()</code>函数来查看一下数据类型。如果不同，有时候需要进行类型转换，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>num = <span class="number">1</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>string = <span class="string">'1'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>num2 = int(string)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(num +num2)</div><div class="line"><span class="number">2</span></div></pre></td></tr></table></figure>
<h2 id="变量的删除">变量的删除</h2>
<p>变量的删除使用<code>del</code>函数。</p>
<h2 id="字符串">字符串</h2>
<h3 id="字符串的访问">字符串的访问</h3>
<p>字符串就是一串有序的字符。你可以通过方括号操作符，每次去访问字符串中的一个字符，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>fruit = <span class="string">'banana'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>letter = fruit[<span class="number">1</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>letter</div><div class="line"><span class="string">'a'</span></div></pre></td></tr></table></figure>
<p>其中[1]是索引，用于指示字符串中字符的位置，python中第1个位置是[0]，而非[1]。</p>
<h3 id="字符串的长度">字符串的长度</h3>
<p><code>len</code>是一个内置函数，会返回一个字符串中字符的长度：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>len(fruit)</div><div class="line"><span class="number">6</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>len(letter)</div><div class="line"><span class="number">1</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>fruit[len(fruit)<span class="number">-1</span>] <span class="comment">#返回fruit的最后一个字母</span></div><div class="line"><span class="string">'a'</span></div></pre></td></tr></table></figure>
<h3 id="长字符串加三引号">长字符串加三引号<code>'''</code></h3>
<p>如果要在Python中输入比较长的字符串，例如要跨越多行的字符串，可以使用三引号<code>'''</code>，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">print(<span class="string">'''This is a very long string. It continues here.</span></div><div class="line"><span class="string">And it's not over yet. "Hello, world!</span></div><div class="line"><span class="string">Still here.'''</span>)print(<span class="string">'''This is a very long string. It continues here.</span></div><div class="line"><span class="string">And it's not over yet. "Hello, world!</span></div><div class="line"><span class="string">Still here.'''</span>)</div></pre></td></tr></table></figure>
<p>运行结果如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">This <span class="keyword">is</span> a very long string. It continues here.</div><div class="line">And it<span class="string">'s not over yet. "Hello, world!</span></div><div class="line"><span class="string">Still here.</span></div></pre></td></tr></table></figure>
<h3 id="换行加左斜杠">换行加左斜杠<code>\</code></h3>
<p>常规字符串如果要换行，需要加左斜杠<code>\</code>，左斜杠和换行符将被转义，即被忽略，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">print</span> \</div><div class="line">(<span class="string">"Hello, python"</span>)</div></pre></td></tr></table></figure>
<p>运行结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Hello, python</div></pre></td></tr></table></figure>
<h3 id="字符串的加法">字符串的加法<code>+</code></h3>
<p>字符串的加法就是将字符串连接起来，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>what_he_does = <span class="string">' plays '</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>his_instrument = <span class="string">'guitar'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>his_name = <span class="string">'Robert Johnson'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>artist_intro = his_name + what_he_does + his_instrument</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(artist_intro)</div><div class="line">Robert Johnson plays guitar</div></pre></td></tr></table></figure>
<h3 id="字符串无法修改">字符串无法修改</h3>
<p>字符串属于不可变序列，无法进行修改，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>greeting = <span class="string">'Hello, world!'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>greeting[<span class="number">0</span>] = <span class="string">'J'</span></div><div class="line">Traceback (most recent call last):</div><div class="line">  File <span class="string">"&lt;stdin&gt;"</span>, line <span class="number">1</span>, <span class="keyword">in</span> &lt;module&gt;</div><div class="line">TypeError: <span class="string">'str'</span> object does <span class="keyword">not</span> support item assignment</div></pre></td></tr></table></figure>
<p>但是可以新建一个字符串，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>greeting = <span class="string">'Hello, world!'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>new_greeting = <span class="string">'J'</span> + greeting[<span class="number">1</span>:]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(new_greeting)</div><div class="line">Jello, world!</div></pre></td></tr></table></figure>
<p>在Python中处理这类无法修改的数据类型时，通常的做法就是提取相应的字符串，然后再新建一个。</p>
<h3 id="字符串的切片与索引">字符串的切片与索引</h3>
<p>先看一个案例，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>name = <span class="string">'My name is Mike'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(name[<span class="number">0</span>]) <span class="comment"># 切下第0个元素</span></div><div class="line">M</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(name[<span class="number">-4</span>]) <span class="comment"># 切下倒数第4个元素</span></div><div class="line">M</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(name[<span class="number">11</span>:<span class="number">14</span>]) <span class="comment"># 切下第11到第14个元素，左闭右开区间</span></div><div class="line">Mik</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(name[<span class="number">11</span>:<span class="number">15</span>]) <span class="comment"># 切下第11到第15个元素，左闭右开区间</span></div><div class="line">Mike</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(name[<span class="number">5</span>:]) <span class="comment"># 从第5个元素开始切，一直到结尾</span></div><div class="line">me <span class="keyword">is</span> Mike</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(name[:<span class="number">5</span>]) <span class="comment"># 从第0个元素开始切，不包括第5个元素，左闭右开区间</span></div><div class="line">My na</div></pre></td></tr></table></figure>
<p>再看另外一个案例，下面的这个案例中使用了几个参数，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>b = <span class="string">'ACTGCATCATC'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>b[<span class="number">0</span>:<span class="number">3</span>] <span class="comment"># 截取0到3元素</span></div><div class="line"><span class="string">'ACT'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>b[<span class="number">2</span>:<span class="number">4</span>] <span class="comment"># 截取2到4元素</span></div><div class="line"><span class="string">'TG'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>b[<span class="number">2</span>:<span class="number">-1</span>] <span class="comment"># 截取第2到最后一个元素</span></div><div class="line"><span class="string">'TGCATCAT'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>b[<span class="number">2</span>:] <span class="comment"># 截取第2到最后一个元素</span></div><div class="line"><span class="string">'TGCATCATC'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>b[::<span class="number">-1</span>] <span class="comment"># #创造一个与原字符串顺序相反的字符串</span></div><div class="line"><span class="string">'CTACTACGTCA'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>b[<span class="number">-3</span>:<span class="number">-1</span>] <span class="comment">#截取倒数第三位与倒数第一位之前的字符</span></div><div class="line"><span class="string">'AT'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>b[<span class="number">-3</span>:] <span class="comment">#截取倒数第三位到结尾</span></div><div class="line"><span class="string">'ATC'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>b[:<span class="number">-5</span>:<span class="number">-3</span>] <span class="comment">#逆序截取</span></div><div class="line"><span class="string">'CC'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>b[::<span class="number">2</span>]   <span class="comment"># 隔一个取一个元素的操作</span></div><div class="line"><span class="string">'ATCTAC'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>b[<span class="number">0</span>:<span class="number">6</span>:<span class="number">2</span>] <span class="comment"># 截取第0到第6个元素，然后再间隔1个取元素</span></div><div class="line"><span class="string">'ATC'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>b[<span class="number">9</span>:<span class="number">0</span>:<span class="number">-3</span>] <span class="comment"># 截取第0到第9个元素，然后倒序间隔取3个元素</span></div><div class="line"><span class="string">'TTG'</span></div><div class="line">&gt;&gt;&gt;</div></pre></td></tr></table></figure>
<h3 id="步长">步长</h3>
<p>看一个案例，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">test = <span class="string">"0123456789"</span></div><div class="line">test</div><div class="line">test[<span class="number">0</span>:<span class="number">7</span>:<span class="number">2</span>]</div></pre></td></tr></table></figure>
<p>运行结果如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="number">0246</span></div></pre></td></tr></table></figure>
<p>这里面涉及到一个步长的概念，上面代码表示的是意思是，取0到7之间的元素，第0个元素是<code>0</code>，第7个元素是<code>7</code>（但末尾元素不取），并间隔取，其中<code>[0:7:2]</code>这个<code>2</code>就表示间隔取。如果是3，则是间隔3个取，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">test[<span class="number">0</span>:<span class="number">7</span>:<span class="number">3</span>]</div><div class="line"><span class="number">036</span></div></pre></td></tr></table></figure>
<h3 id="字符串的分割split">字符串的分割<code>split()</code></h3>
<p>这里要与字符串的切片区分，字符串的分割使用的是<code>split()</code>，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>s = <span class="string">'pining for the fjords'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>t = s.split()</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>t</div><div class="line">[<span class="string">'pining'</span>, <span class="string">'for'</span>, <span class="string">'the'</span>, <span class="string">'fjords'</span>]</div></pre></td></tr></table></figure>
<p>可选的参数是定界符，是用来确定单词边界的。下面这个例子中就是把连接号<code>-</code>作为定界符：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>s = <span class="string">'spam-spam-spam'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>delimiter = <span class="string">'-'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>t = s.split(delimiter)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>t</div><div class="line">[<span class="string">'spam'</span>, <span class="string">'spam'</span>, <span class="string">'spam'</span>]</div></pre></td></tr></table></figure>
<h3 id="字符串的拼接join">字符串的拼接<code>join()</code></h3>
<p>join是与split功能相反的一个方法。它接收一个字符串列表，然后把所有元素拼接到一起。join是一个字符串方法，所以必须把 join放到定界符后面来调用，并且传递一个列表作为参数：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>t = [<span class="string">'pining'</span>,<span class="string">'for'</span>,<span class="string">'the'</span>,<span class="string">'fjords'</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>delimiter = <span class="string">' '</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>s = delimiter.join(t)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>s</div><div class="line"><span class="string">'pining for the fjords'</span></div></pre></td></tr></table></figure>
<h3 id="替换某字符串replace">替换某字符串<code>replace()</code></h3>
<p>这里用到了字符串的replace()方法，这个方法是用某个字符替换某个字符，虽然是替换，但是原字符是不变的，只是将替换后的字符赋值给了一个新的变量，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>phone_number = <span class="string">'1386-666-0006'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>hiding_number = phone_number.replace(phone_number[:<span class="number">9</span>],<span class="string">'*'</span>*<span class="number">9</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(hiding_number)</div><div class="line">*********<span class="number">0006</span></div></pre></td></tr></table></figure>
<h3 id="替换某字符串translate">替换某字符串<code>translate()</code></h3>
<p>方法<code>translate</code>与<code>replace</code>一样能替换字符串的特定部分，但不同的是，translte只能进行单字符替换，它的优势在能够同时替换多个字符，效率比replace高。</p>
<p>现在看一个案例，将某段字符中的<code>c</code>和<code>s</code>分别替换为<code>k</code>和<code>z</code>。</p>
<p>在转换之前，<code>translate</code>需要创建一个<code>转换表</code>，这个转换表指出了不同Unicode码点之间的转换关系，要创建转换表，可以对字符串类型<code>str</code>调用方法<code>maketrans</code>，这个方法接收2个参数：两个长度相同的字符串，它们指定要将第一个字符串中的每个字符都替换为第二个字符串中相应的字符，类似于以下的东西：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">table = str.maketrans(<span class="string">'cs'</span>, <span class="string">'kz'</span>)</div></pre></td></tr></table></figure>
<p>完整代码为：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">table = str.maketrans(<span class="string">'cs'</span>, <span class="string">'kz'</span>)</div><div class="line">table</div><div class="line">test_string = <span class="string">'this is an incredibel test'</span></div><div class="line">test_string.translate(table)</div><div class="line">test_string</div></pre></td></tr></table></figure>
<p>运行结果如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>table = str.maketrans(<span class="string">'cs'</span>, <span class="string">'kz'</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>table</div><div class="line">&#123;<span class="number">99</span>: <span class="number">107</span>, <span class="number">115</span>: <span class="number">122</span>&#125;</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>test_string = <span class="string">'this is an incredibel test'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>test_string.translate(table)</div><div class="line"><span class="string">'thiz iz an inkredibel tezt'</span></div></pre></td></tr></table></figure>
<p>其中<code>&gt;&gt;&gt; table {99: 107, 115: 122}</code>这一部分表示Unicode码点之间的映射。</p>
<p>在调用<code>maketrans</code>时，还可以添加第3个参数，它是指定哪些字符删除，例如下面的代码会将空格删除，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">table = str.maketrans(<span class="string">'cs'</span>, <span class="string">'kz'</span>,<span class="string">' '</span>) <span class="comment">#第三个参数是一个空格</span></div><div class="line">test_string = <span class="string">'this is an incredibel test'</span></div><div class="line">test_string.translate(table)</div></pre></td></tr></table></figure>
<p>运行结果如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>table = str.maketrans(<span class="string">'cs'</span>, <span class="string">'kz'</span>,<span class="string">' '</span>) <span class="comment">#第三个参数是一个空格</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>test_string = <span class="string">'this is an incredibel test'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>test_string.translate(table)</div><div class="line"><span class="string">'thizizaninkredibeltezt'</span></div></pre></td></tr></table></figure>
<h3 id="字符串计数">字符串计数</h3>
<p>下面的这段代码是统计在<code>banana</code>这个单词有多少个a，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>word = <span class="string">"banana"</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>count = <span class="number">0</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">for</span> letter <span class="keyword">in</span> word:</div><div class="line"><span class="meta">... </span><span class="keyword">if</span> letter == <span class="string">'a'</span>:</div><div class="line"><span class="meta">... </span>count = count + <span class="number">1</span></div><div class="line">...</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(count)</div><div class="line"><span class="number">3</span></div></pre></td></tr></table></figure>
<p>除了函数形式外，还可以使用<code>count()</code>方法，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>word = <span class="string">"banana"</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>word.count(<span class="string">'a'</span>)</div><div class="line"><span class="number">3</span></div></pre></td></tr></table></figure>
<h3 id="查询字符串findrfind和index">查询字符串<code>find()</code>、<code>rfind()</code>和<code>index()</code></h3>
<p>查询字符常用的方法是<code>find()</code>，<code>rfind()</code>，<code>index()</code>。其中，<code>find()</code>与<code>rfind(</code>)的区别在于，一个是在左边开始查找，一个在右边开始查找（r就是right的意思），<code>index()</code>法检测字符串中是否包含子字符串<code>str</code>，如果指定<code>beg</code>（开始） 和<code>end</code>（结束） 范围，则检查是否包含在指定范围内，该方法与 python find()方法一样，只不过如果str不在 string中会报一个异常。<code>find()</code>与<code>rfind()</code>查找一个字符串在另一个字符串指定范围（默认是整个字符串）中首次出现的位置，如果不存在，返回-1，存在返回1，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>s = <span class="string">'apple, peach, banana, peach, pear'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>s.find(<span class="string">"peach"</span>)</div><div class="line"><span class="number">7</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>s = <span class="string">'apple, peach, banana, peach, pear'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>s.find(<span class="string">"peach"</span>) <span class="comment"># 返回第一次出现的位置</span></div><div class="line"><span class="number">7</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>s.find(<span class="string">"peach"</span>,<span class="number">7</span>) <span class="comment"># 在指定位置开始查找</span></div><div class="line"><span class="number">7</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>s.find(<span class="string">"peach"</span>,<span class="number">7</span>,<span class="number">20</span>) <span class="comment"># 在指定范围内进行查找</span></div><div class="line"><span class="number">7</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>s.rfind(<span class="string">'p'</span>) <span class="comment"># 从字符串尾部向前查找</span></div><div class="line"><span class="number">29</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>s.index(<span class="string">'p'</span>) <span class="comment"># 返回首次出现的位置</span></div><div class="line"><span class="number">1</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>s.index(<span class="string">'pe'</span>)</div><div class="line"><span class="number">7</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>s.index(<span class="string">'pear'</span>)</div><div class="line"><span class="number">29</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>s.index(<span class="string">'ppp'</span>) <span class="comment"># 指定子字符串不存在时抛出异常</span></div><div class="line">Traceback (most recent call last):</div><div class="line">  File <span class="string">"&lt;stdin&gt;"</span>, line <span class="number">1</span>, <span class="keyword">in</span> &lt;module&gt;</div><div class="line">ValueError: substring <span class="keyword">not</span> found</div></pre></td></tr></table></figure>
<p>再看一个查询电话号码的案例：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>search = <span class="string">'168'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>num_a = <span class="string">'1386-168-0006'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>num_b = <span class="string">'1681-222-0006'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(search + <span class="string">' is at '</span> + str(num_a.find(search)) + <span class="string">' to '</span>+str(num_a.find(search) + len(search)) + <span class="string">' of num_a'</span>)</div><div class="line"><span class="number">168</span> <span class="keyword">is</span> at <span class="number">5</span> to <span class="number">8</span> of num_a</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(search + <span class="string">' is at '</span> + str(num_b.find(search)) + <span class="string">' to '</span>+str(num_b.find(search) + len(search)) + <span class="string">' of num_b'</span>)</div><div class="line"><span class="number">168</span> <span class="keyword">is</span> at <span class="number">0</span> to <span class="number">3</span> of num_b</div></pre></td></tr></table></figure>
<h3 id="查询某字母">查询某字母</h3>
<p>方法与前面的类似，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>word = <span class="string">'banana'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>index = word.find(<span class="string">'a'</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(index)</div><div class="line"><span class="number">1</span></div></pre></td></tr></table></figure>
<h3 id="in运算">in运算</h3>
<p>in 这个词在字符串操作中是一个布尔操作符，它读取两个字符串，如果前者的字符串为后者所包含，就返回真，否则为假：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">'a'</span> <span class="keyword">in</span> <span class="string">'banana'</span></div><div class="line"><span class="keyword">True</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">'seed'</span> <span class="keyword">in</span> <span class="string">'banana'</span></div><div class="line"><span class="keyword">False</span></div></pre></td></tr></table></figure>
<h3 id="删除字符串中的空格strip">删除字符串中的空格<code>strip()</code></h3>
<p>使用的<code>strip()</code>方法，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>mybag = [<span class="string">' glass'</span>,<span class="string">' apple'</span>,<span class="string">'green leaf '</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="comment">#有的前面有空格，有的后面有空格</span></div><div class="line"><span class="meta">... </span>print([one.strip() <span class="keyword">for</span> one <span class="keyword">in</span> mybag])</div><div class="line">[<span class="string">'glass'</span>, <span class="string">'apple'</span>, <span class="string">'green leaf'</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="comment">#去掉元素前后的空格</span></div><div class="line"><span class="meta">... </span>[<span class="string">'glass'</span>, <span class="string">'apple'</span>, <span class="string">'green leaf'</span>]</div><div class="line">[<span class="string">'glass'</span>, <span class="string">'apple'</span>, <span class="string">'green leaf'</span>]</div></pre></td></tr></table></figure>
<h3 id="遍历所有字符串">遍历所有字符串</h3>
<p>使用的是for循环，第一种方法，使用索引，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>index = <span class="number">0</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>fruit = <span class="string">"banana"</span></div><div class="line">&gt;&gt;&gt;</div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">while</span> index &lt; len(fruit):</div><div class="line"><span class="meta">... </span>letter = fruit[index]</div><div class="line"><span class="meta">... </span>print(letter)</div><div class="line"><span class="meta">... </span>index = index +<span class="number">1</span></div><div class="line">...</div><div class="line">b</div><div class="line">a</div><div class="line">n</div><div class="line">a</div><div class="line">n</div><div class="line">a</div></pre></td></tr></table></figure>
<p>第二种方法，直接使用字符串，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>fruit = <span class="string">"banana"</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">for</span> letter <span class="keyword">in</span> fruit:</div><div class="line"><span class="meta">... </span>print(letter)</div><div class="line">...</div><div class="line">b</div><div class="line">a</div><div class="line">n</div><div class="line">a</div><div class="line">n</div><div class="line">a</div></pre></td></tr></table></figure>
<h3 id="字符串的复制">字符串的复制</h3>
<p>直接使用乘法就行，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>words = <span class="string">'word'</span>*<span class="number">4</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(words)</div><div class="line">wordwordwordword</div><div class="line">wordwordwordword</div></pre></td></tr></table></figure>
<h3 id="字符串的-大小转换upper和lower首字母大写capitalizetitle和capwords">字符串的 大小转换<code>upper()</code>和<code>lower()</code>，首字母大写<code>capitalize()</code>、<code>title()</code>和<code>capwords()</code></h3>
<p>符串提供了一些方法，这些方法能够进行很多有用的操作。方法和函数有些类似，也接收参数然后返回一个值，但语法稍微不同。比如，<code>upper</code>这个方法就读取一个字符串，返回一个全部为大写字母的新字符串。与函数的<code>upper(word)</code>语法不同，方法的语法是<code>word.upper()</code>。后面括号里面是空白的，表示这个方法不接收参数，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>word = <span class="string">'banana'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>new_word = word.upper()</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(new_word)</div><div class="line">BANANA</div></pre></td></tr></table></figure>
<p>upper()方法是大写，lower()是小写，capitalize()首字母大写、title()将每个字母变为大写，swapcase()大小写互换，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>s = <span class="string">"What is Your Name?"</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>s.lower()</div><div class="line"><span class="string">'what is your name?'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>s.upper()</div><div class="line"><span class="string">'WHAT IS YOUR NAME?'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>s.capitalize()</div><div class="line"><span class="string">'What is your name?'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>s.swapcase()</div><div class="line"><span class="string">'wHAT IS yOUR nAME?'</span></div></pre></td></tr></table></figure>
<p>另外两个词首大写的方法是<code>tilte()</code>与<code>string</code>模块中的<code>capwords()</code>函数，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">test_1 = <span class="string">"that's all folks"</span></div><div class="line">test_1.title()</div><div class="line"></div><div class="line"><span class="keyword">import</span> string</div><div class="line">string.capwords(test_1)</div></pre></td></tr></table></figure>
<p>运行结果如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>test_1 = <span class="string">"that's all folks"</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>test_1.title()</div><div class="line"><span class="string">"That'S All Folks"</span></div><div class="line">&gt;&gt;&gt;</div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> string</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>string.capwords(test_1)</div><div class="line"><span class="string">"That's All Folks"</span></div></pre></td></tr></table></figure>
<h3 id="ascii值的转换">ASCII值的转换</h3>
<p>ord()是一个内建函数，能够返回某个字符（注意，是一个字符，而不是多个字符组成的串），所对应的ASCII值（是十进制的），字符ａ在ASCII中的值是97，空格在ASCII中也有值，是32，反过来，根据整数值得到的相应字符，可以使用chr()，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(ord(<span class="string">'a'</span>))</div><div class="line"><span class="number">97</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(chr(<span class="number">97</span>))</div><div class="line">a</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(chr(<span class="number">98</span>))</div><div class="line">b</div></pre></td></tr></table></figure>
<h3 id="转义字符"><strong>转义字符</strong></h3>
<p>转义字符是指，在字符串中某些特定的符号前加一个斜线之后该字符将被解释为另外一种含义，不再表示本来的字符，常见的转义字符如下所示：</p>
<table>
<thead>
<tr class="header">
<th>转义字符</th>
<th>含义</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>\b</code></td>
<td>退格，把光标移动到前一列位置</td>
</tr>
<tr class="even">
<td><code>\f</code></td>
<td>换页符</td>
</tr>
<tr class="odd">
<td><code>\n</code></td>
<td>换行符</td>
</tr>
<tr class="even">
<td><code>\r</code></td>
<td>回车</td>
</tr>
<tr class="odd">
<td><code>\t</code></td>
<td>水平制表符</td>
</tr>
<tr class="even">
<td><code>\v</code></td>
<td>垂直制表符</td>
</tr>
<tr class="odd">
<td><code>\\</code></td>
<td>一个</td>
</tr>
<tr class="even">
<td><code>\'</code></td>
<td>单引号</td>
</tr>
<tr class="odd">
<td><code>\&quot;</code></td>
<td>双引号</td>
</tr>
<tr class="even">
<td><code>\ooo</code></td>
<td>3位八制对应的字符</td>
</tr>
<tr class="odd">
<td><code>\xhh</code></td>
<td>2位十六进制对应的字符</td>
</tr>
<tr class="even">
<td><code>\uhhhh</code></td>
<td>4位十六进制数表示的Unicode字符</td>
</tr>
</tbody>
</table>
<p>使用案例如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"> &gt;&gt;&gt; print(<span class="string">'Hello\nWorld'</span>)</div><div class="line">Hello</div><div class="line">World</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>oct(<span class="number">65</span>)</div><div class="line"><span class="string">'0o101'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(<span class="string">'\101'</span>) <span class="comment"># 3位八进制数对应的字符</span></div><div class="line">A</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>hex(<span class="number">65</span>)</div><div class="line"><span class="string">'0x41'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(<span class="string">'\x41'</span>) <span class="comment"># 2位十六进制数对应的字符</span></div><div class="line">A</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>ord(<span class="string">'张'</span>)</div><div class="line"><span class="number">24352</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>hex(_)</div><div class="line"><span class="string">'0x5f20'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(<span class="string">'\u8463'</span>) <span class="comment"># 4位十六进制数表示的Unicode字符</span></div><div class="line">董</div></pre></td></tr></table></figure>
<h3 id="eval函数"><strong>eval函数</strong></h3>
<p>eval()是一具内置变数，它可以将任意字符串转化为Python表达式，并进行求值。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>eval(<span class="string">"3+4"</span>) <span class="comment"># 计算表达式的值 </span></div><div class="line"><span class="number">7</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>a = <span class="number">3</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>b = <span class="number">5</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>eval(<span class="string">'a+b'</span>) <span class="comment"># 这时候要求变量a和b都已经存在</span></div><div class="line"><span class="number">8</span></div><div class="line">&gt;&gt;&gt;</div></pre></td></tr></table></figure>
<h3 id="判断某字符串的开头或结尾">判断某字符串的开头或结尾</h3>
<p>startswith()，endswith()用于判断字符串是否以指定字符串开始或结束，可以接收两个整数参数来限定字符串的检测范围，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>s = <span class="string">'Beautiful is better than ugly'</span> </div><div class="line"><span class="meta">&gt;&gt;&gt; </span>s.startswith(<span class="string">'Be'</span>) <span class="comment"># 检测整个字符串</span></div><div class="line"><span class="keyword">True</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>s.startswith(<span class="string">'Be'</span>,<span class="number">5</span>) <span class="comment"># 指定检测范围的起始位置</span></div><div class="line"><span class="keyword">False</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>s.startswith(<span class="string">'Be'</span>,<span class="number">0</span>,<span class="number">5</span>) <span class="comment"># 指定检测范围的起始和结束位置</span></div><div class="line"><span class="keyword">True</span></div><div class="line">&gt;&gt;&gt;</div></pre></td></tr></table></figure>
<h3 id="判断字符串的首个字符内容">判断字符串的首个字符内容</h3>
<p>isalnum()，isalpha()，isdigit()，isdecimal()，isnumeric()，isspace()，isupper()，islower()用于检测字符串是否为数字或字母，是否为字母，是否为数字字符，是否为空白字符，是否为大写字母以及是否为小写字母，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">'1234abcd'</span>.isalnum()</div><div class="line"><span class="keyword">True</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">'1234abcd'</span>.isalpha() <span class="comment"># 全部为英文字母时返回True</span></div><div class="line"><span class="keyword">False</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">'1234abcd'</span>.isdigit() <span class="comment"># 全部为数字时返回True</span></div><div class="line"><span class="keyword">False</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">'abcd'</span>.isalpha()</div><div class="line"><span class="keyword">True</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">'1234.0'</span>.isdigit()</div><div class="line"><span class="keyword">False</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">'1234'</span>.isdigit()</div><div class="line"><span class="keyword">True</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">'九'</span>.isnumeric() <span class="comment"># isnumeric()方法支持汉字数字</span></div><div class="line"><span class="keyword">True</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">'99'</span>.isnumeric()</div><div class="line"><span class="keyword">True</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">'九'</span>.isdigit()</div><div class="line"><span class="keyword">False</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">'九'</span>.isdecimal()</div><div class="line"><span class="keyword">False</span></div></pre></td></tr></table></figure>
<h3 id="添加填充字符center">添加填充字符<code>center</code></h3>
<p>字符串的方法<code>center</code>的功能在于向字符串两边填充字符，默认是空格，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">string_test = <span class="string">"The Middley by Jimmy Eat world"</span></div><div class="line">string_test</div><div class="line">string_test.center(<span class="number">39</span>)</div><div class="line">string_test.center(<span class="number">39</span>,<span class="string">"*"</span>)</div></pre></td></tr></table></figure>
<p>运行结果如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>string_test = <span class="string">"The Middley by Jimmy Eat world"</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>string_test</div><div class="line"><span class="string">'The Middley by Jimmy Eat world'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>string_test.center(<span class="number">39</span>)</div><div class="line"><span class="string">'     The Middley by Jimmy Eat world    '</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>string_test.center(<span class="number">39</span>,<span class="string">"*"</span>)</div><div class="line"><span class="string">'*****The Middley by Jimmy Eat world****'</span></div></pre></td></tr></table></figure>
<p>其中数字39表示，填充后的字符串一共39个字符。</p>
<h2 id="输出格式美化format">输出格式美化<code>format()</code></h2>
<p>Python两种输出值的方式:表达式语句和<code>print()</code>函数。 第三种方式是使用文件对象的<code>write()</code>方法，标准输出文件可以用<code>sys.stdout</code>引用，<code>write()</code>方法在处理文本文件的时候经常使用，如果你希望输出的形式更加多样，可以使用<code>str.format()</code>函数来格式化输出值，如果希望将输出的值转成字符串，可以使用<code>repr()</code>或<code>str()</code>函数来实现。 这两个函数区别如下所示：</p>
<ol style="list-style-type: decimal">
<li><code>str()</code>：函数返回一个用户易读的表达形式。</li>
<li><code>repr()</code>：产生一个解释器易读的表达形式。</li>
</ol>
<h3 id="输出格式案例1-字符串">输出格式案例1-字符串</h3>
<p>如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>str(s)</div><div class="line"><span class="string">'Hello Runoob'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(type(str(s)))</div><div class="line">&lt;<span class="class"><span class="keyword">class</span> '<span class="title">str</span>'&gt;</span></div><div class="line"><span class="class">&gt;&gt;&gt; <span class="title">print</span><span class="params">(type<span class="params">(s)</span>)</span></span></div><div class="line"><span class="class">&lt;<span class="title">class</span> '<span class="title">str</span>'&gt;</span></div><div class="line"><span class="class">&gt;&gt;&gt; <span class="title">repr</span><span class="params">(s)</span></span></div><div class="line"><span class="class">"'<span class="title">Hello</span> <span class="title">Runoob</span>'"</span></div><div class="line"><span class="class">&gt;&gt;&gt; <span class="title">print</span><span class="params">(type<span class="params">(repr<span class="params">(s)</span>)</span>)</span></span></div><div class="line"><span class="class">&lt;<span class="title">class</span> '<span class="title">str</span>'&gt;</span></div><div class="line"><span class="class">&gt;&gt;&gt; <span class="title">str</span><span class="params">(<span class="number">1</span>/<span class="number">7</span>)</span></span></div><div class="line"><span class="class">'0.14285714285714285'</span></div><div class="line">&gt;&gt;&gt; x = 10*3.25</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>y=<span class="number">200</span>*<span class="number">200</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>s = <span class="string">'The value of x is:  '</span> + repr(x) + <span class="string">',the value of y is: '</span> + repr(y) + <span class="string">'...'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(s)</div><div class="line">The value of x <span class="keyword">is</span>:  <span class="number">32.5</span>,the value of y <span class="keyword">is</span>: <span class="number">40000.</span>..</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>hello = <span class="string">'hello, runoob\n'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>hellos = repr(hello)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(hellos)</div><div class="line"><span class="string">'hello, runoob\n'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>repr((x,y,(<span class="string">'Google'</span>, <span class="string">'Runoob'</span>)))</div><div class="line"><span class="string">"(32.5, 40000, ('Google', 'Runoob'))"</span></div></pre></td></tr></table></figure>
<h3 id="输出格式案例2-整数输出">输出格式案例2-整数输出</h3>
<p>下面的代码输出一个平方与立方根，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">5</span>):</div><div class="line"><span class="meta">... </span>    print(repr(x).rjust(<span class="number">2</span>),repr(x*x).rjust(<span class="number">3</span>),end=<span class="string">' '</span>) </div><div class="line"><span class="comment"># 使用print添加空格，即end=' '</span></div><div class="line"><span class="comment"># rjust()表示字符串靠右，并在左边填充空格</span></div><div class="line"></div><div class="line"><span class="meta">... </span>    print(repr(x*x*x).rjust(<span class="number">4</span>))</div><div class="line">...</div><div class="line"> <span class="number">1</span>   <span class="number">1</span>    <span class="number">1</span></div><div class="line"> <span class="number">2</span>   <span class="number">4</span>    <span class="number">8</span></div><div class="line"> <span class="number">3</span>   <span class="number">9</span>   <span class="number">27</span></div><div class="line"> <span class="number">4</span>  <span class="number">16</span>   <span class="number">64</span></div><div class="line"></div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">5</span>):</div><div class="line"><span class="meta">... </span>    print(<span class="string">'&#123;0:2d&#125; &#123;1:3d&#125;&#123;2:4d&#125;'</span>.format(x,x*x,x*x*x))</div><div class="line">...</div><div class="line"> <span class="number">1</span>   <span class="number">1</span>   <span class="number">1</span></div><div class="line"> <span class="number">2</span>   <span class="number">4</span>   <span class="number">8</span></div><div class="line"> <span class="number">3</span>   <span class="number">9</span>  <span class="number">27</span></div><div class="line"> <span class="number">4</span>  <span class="number">16</span>  <span class="number">64</span></div></pre></td></tr></table></figure>
<h3 id="输出格式案例3zfill">输出格式案例3<code>zfill()</code></h3>
<p>zfill方法表示在数字的左边填充0，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">'12'</span>.zfill(<span class="number">5</span>)</div><div class="line"><span class="string">'00012'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">'-3.14'</span>.zfill(<span class="number">7</span>)</div><div class="line"><span class="string">'-003.14'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">'3.14159265359'</span>.zfill(<span class="number">5</span>)</div><div class="line"><span class="string">'3.14159265359'</span></div></pre></td></tr></table></figure>
<h2 id="数值输出的格式化">数值输出的格式化</h2>
<p>字符串的格式化输出有两种方式，一种是使用<code>%</code>符号，这个符号为称<code>转换说明符</code>，它可以指出要将值插入什么地方，例如<code>%s</code>的意思表示对字符串进行格式设置，如果指定的值不是字符串，那么就转换为字符串，再例如<code>%.3f</code>则是将格式设计为包含3位小数点的浮点数。</p>
<p>另外一种是使用<code>str.format()</code>，下面是使用的一些案例：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(<span class="string">"&#123;:,&#125;"</span>.format(<span class="number">123456</span>))</div><div class="line"><span class="comment">#输出1234,56</span></div><div class="line"><span class="number">123</span>,<span class="number">456</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(<span class="string">"&#123;a:w^8&#125;"</span>.format(a=<span class="string">"8"</span>))</div><div class="line"><span class="comment">#输出www8wwww</span></div><div class="line">www8wwww</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(<span class="string">"%.5f"</span> %<span class="number">5</span>)</div><div class="line"><span class="comment">#输出5.000000</span></div><div class="line"><span class="number">5.00000</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(<span class="string">"%-7s3"</span> %(<span class="string">"python"</span>))</div><div class="line"><span class="comment">#输出python 3</span></div><div class="line">python <span class="number">3</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(<span class="string">"%.3e"</span> %<span class="number">2016</span>)</div><div class="line"><span class="comment">#输出2.016e+03,也可以写大E</span></div><div class="line"><span class="number">2.016e+03</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(<span class="string">"%d %s"</span> %(<span class="number">123456</span>,<span class="string">"myblog"</span>))</div><div class="line"><span class="comment">#输出123456 myblog</span></div><div class="line"><span class="number">123456</span> myblog</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(<span class="string">"%(what)s is %(year)d"</span> % &#123;<span class="string">"what"</span>:<span class="string">"this year"</span>,<span class="string">"year"</span>:<span class="number">2016</span>&#125;)</div><div class="line"><span class="comment">#输出this year is 2016</span></div><div class="line">this year <span class="keyword">is</span> <span class="number">2016</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(<span class="string">"&#123;0&#125;&#123;1&#125;"</span>.format(<span class="string">"hello"</span>,<span class="string">"fun"</span>))</div><div class="line"><span class="comment">#输出hellofun,这与CSharp的格式化字符(占位符)相似</span></div><div class="line">hellofun</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(<span class="string">"&#123;&#125;&#123;&#125;&#123;&#125;"</span>.format(<span class="string">"spkk"</span>,<span class="string">"."</span>,<span class="string">"cn"</span>))</div><div class="line"><span class="comment">#输出spkk.cn</span></div><div class="line">spkk.cn</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(<span class="string">"&#123;a[0]&#125;&#123;a[1]&#125;&#123;a[2]&#125;"</span>.format(a=[<span class="string">"spkk"</span>,<span class="string">"."</span>,<span class="string">"cn"</span>]))</div><div class="line"><span class="comment">#输出spkk.cn</span></div><div class="line">spkk.cn</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(<span class="string">"&#123;dict[host]&#125;&#123;dict[dot]&#125;&#123;dict[domain]&#125;"</span>.format(dict=&#123;<span class="string">"host"</span>:<span class="string">"www"</span>,<span class="string">"domain"</span>:<span class="string">"spkk.cn"</span>,<span class="string">"dot"</span>:<span class="string">"."</span>&#125;))</div><div class="line"><span class="comment">#输出www.spkk.cn</span></div><div class="line">www.spkk.cn</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(<span class="string">"&#123;a&#125;&#123;b&#125;"</span>.format(a=<span class="string">"python"</span>,b=<span class="string">"3"</span>))</div><div class="line"><span class="comment">#输出python3</span></div><div class="line">python3</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(<span class="string">"&#123;who&#125; &#123;doing&#125; &#123;0&#125;"</span>.format(<span class="string">"python"</span>,doing=<span class="string">"like"</span>,who=<span class="string">"I"</span>))</div><div class="line"><span class="comment">#输出I like python</span></div><div class="line">I like python</div><div class="line"></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x = <span class="number">4</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>y = <span class="number">5</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>z = x +y</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(<span class="string">"计算结果是 &#123;0:d&#125;."</span>.format(z))</div><div class="line">计算结果是 <span class="number">9.</span></div><div class="line"><span class="comment"># 这里的&#123;0:d&#125;表示：0是指format()方法中变量的第一个参数，这里是z，也就是说0指向z，d表示，将z这个变量输出为整数格式。</span></div></pre></td></tr></table></figure>
<h3 id="format的多参输出"><code>format()</code>的多参输出</h3>
<p><code>format()</code>也可以用于多参数输出，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">print(<span class="string">"Output #1: I'm excited ot learn Python"</span>)</div><div class="line">x = <span class="number">4</span></div><div class="line">y = <span class="number">5</span></div><div class="line">z = x + y </div><div class="line">print(<span class="string">"Output #2: Four plus five equels&#123;0:d&#125;"</span>.format(z))</div><div class="line">      </div><div class="line">a = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>]</div><div class="line">b = [<span class="string">"first"</span>, <span class="string">"second"</span>, <span class="string">"third"</span>, <span class="string">"fourth"</span>]</div><div class="line">c = a + b </div><div class="line">print(<span class="string">"Output #3: &#123;0&#125;, &#123;1&#125;, &#123;2&#125;"</span>.format(a, b, c))</div></pre></td></tr></table></figure>
<p>计算结果如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(<span class="string">"Output #1: I'm excited ot learn Python"</span>)</div><div class="line">Output <span class="comment">#1: I'm excited ot learn Python</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>x = <span class="number">4</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>y = <span class="number">5</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>z = x + y</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(<span class="string">"Output #2: Four plus five equels&#123;0:d&#125;"</span>.format(z))</div><div class="line">Output <span class="comment">#2: Four plus five equels9</span></div><div class="line">&gt;&gt;&gt;</div><div class="line"><span class="meta">... </span>a = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>b = [<span class="string">"first"</span>, <span class="string">"second"</span>, <span class="string">"third"</span>, <span class="string">"fourth"</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>c = a + b</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(<span class="string">"Output #3: &#123;0&#125;, &#123;1&#125;, &#123;2&#125;"</span>.format(a, b, c))</div><div class="line">Output <span class="comment">#3: [1, 2, 3, 4], ['first', 'second', 'third', 'fourth'], [1, 2, 3, 4, 'first', 'second', 'third', 'fourth']</span></div></pre></td></tr></table></figure>
<h3 id="str.format"><code>str.format</code></h3>
<p><code>str.format</code>的基本使用如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(<span class="string">'&#123;&#125; website: "&#123;&#125;!"'</span>.format(<span class="string">'Runobb tuorial'</span>,<span class="string">'www.runoob.com'</span>))</div><div class="line">Runobb tuorial website: <span class="string">"www.runoob.com!"</span></div></pre></td></tr></table></figure>
<p>括号及其里面的字符（称作格式化字段）将会被<code>format()</code>中的参数替换。在括号中的数字用于指向传入对象在<code>format()</code>中的位置，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(<span class="string">'&#123;0&#125; and &#123;1&#125;'</span>.format(<span class="string">'Google'</span>,<span class="string">'Runoob'</span>))</div><div class="line">Google <span class="keyword">and</span> Runoob</div><div class="line">&gt;&gt;&gt;</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(<span class="string">'&#123;1&#125; and &#123;0&#125;'</span>.format(<span class="string">'Google'</span>,<span class="string">'Runoob'</span>))</div><div class="line">Runoob <span class="keyword">and</span> Google</div></pre></td></tr></table></figure>
<p>如果在 format() 中使用了关键字参数, 那么它们的值会指向使用该名字的参数，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(<span class="string">'&#123;name&#125;website:&#123;site&#125;'</span>.format(name=<span class="string">'Runoob tutorial '</span>,site=<span class="string">'www.runoob.com'</span>))</div><div class="line">Runoob tutorial website:www.runoob.com</div></pre></td></tr></table></figure>
<p>位置及关键字参数可以任意的结合:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(<span class="string">'Website list &#123;0&#125;,&#123;1&#125;, and &#123;other&#125;. '</span>.format(<span class="string">'Google'</span>,<span class="string">'Runoob'</span>,other=<span class="string">'Taobao'</span>))</div><div class="line">Website list Google,Runoob, <span class="keyword">and</span> Taobao.</div></pre></td></tr></table></figure>
<p><code>'!a'</code>(使用<code>ascii()</code>),<code>'!s'</code>(使用<code>str()</code>)和<code>'!r'</code>(使用<code>repr()</code>)可以用于在格式化某个值之前对其进行转化，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> math</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(<span class="string">'Constant of PI is around:&#123;&#125;.'</span>.format(math.pi))</div><div class="line">Constant of PI <span class="keyword">is</span> around:<span class="number">3.141592653589793</span>.</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(<span class="string">'Constant of PI is around:&#123;!r&#125;.'</span>.format(math.pi))</div><div class="line">Constant of PI <span class="keyword">is</span> around:<span class="number">3.141592653589793</span>.</div></pre></td></tr></table></figure>
<p>可选项<code>':'</code>和格式标识符可以跟着字段名。这就允许对值进行更好的格式化。下面的例子将Pi保留到小数点后三位，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> math</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(<span class="string">'Constant PI is about: &#123;0:.3f&#125;.'</span>.format(math.pi))</div><div class="line">Constant PI <span class="keyword">is</span> about: <span class="number">3.142</span>.</div></pre></td></tr></table></figure>
<p>在<code>':'</code>后传入一个整数,可以保证该域至少有这么多的宽度。用于美化表格时很有用，如下所示：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>table = &#123;<span class="string">'Google'</span>:<span class="number">1</span>,<span class="string">'Runoob'</span>:<span class="number">2</span>,<span class="string">'Taobao'</span>:<span class="number">3</span>&#125;</div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">for</span> name, number <span class="keyword">in</span> table.items():</div><div class="line"><span class="meta">... </span>    print(<span class="string">'&#123;0:10&#125; ==&gt; &#123;1:10d&#125;'</span>.format(name,number))</div><div class="line">...</div><div class="line">Google     ==&gt;          1</div><div class="line">Runoob     ==&gt;          2</div><div class="line">Taobao     ==&gt;          3</div></pre></td></tr></table></figure>
<p>如果你有一个很长的格式化字符串, 而你不想将它们分开, 那么在格式化时通过变量名而非位置会是很好的事情。 最简单的就是传入一个字典, 然后使用方括号<code>[]</code>来访问键值 :</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>table = &#123;<span class="string">'Google'</span>:<span class="number">1</span>,<span class="string">'Runoob'</span>:<span class="number">2</span>,<span class="string">'Taobao'</span>:<span class="number">3</span>&#125;</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(<span class="string">'Runoob:&#123;0[Runoob]:d&#125;; Google:&#123;0[Google]:d&#125;; Taobao:&#123;0[Taobao]:d&#125;'</span>.format(table))</div><div class="line">Runoob:<span class="number">2</span>; Google:<span class="number">1</span>; Taobao:<span class="number">3</span></div></pre></td></tr></table></figure>
<p>也可以通过在 table 变量前使用<code>**</code>来实现相同的功能：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>table = &#123;<span class="string">'Google'</span>:<span class="number">1</span>,<span class="string">'Runoob'</span>:<span class="number">2</span>,<span class="string">'Taobao'</span>:<span class="number">3</span>&#125;</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(<span class="string">'Runoob:&#123;Runoob:d&#125;;Google:&#123;Google:d&#125;;Taobao:&#123;Taobao:d&#125;'</span>.format(**table))</div><div class="line">Runoob:<span class="number">2</span>;Google:<span class="number">1</span>;Taobao:<span class="number">3</span></div></pre></td></tr></table></figure>
<h3 id="用于格式化输出"><code>%</code>用于格式化输出</h3>
<p>格式化字符串时，Python使用一个字符串作为模板。模板中有格式符，这些格式符为真实值预留位置，并说明真实数值应该呈现的格式。Python用一个tuple将多个值传递给模板，每个值对应一个格式符。<code>%</code>的格式化输出如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(<span class="string">"I'm %s. I'm %d year old"</span> % (<span class="string">'Vamei'</span>, <span class="number">99</span>)) </div><div class="line">I<span class="string">'m Vamei. I'</span>m <span class="number">99</span> year old</div></pre></td></tr></table></figure>
<h3 id="格式符汇总">格式符汇总</h3>
<p>格式符为真实值预留位置，并控制显示的格式。格式符可以包含有一个类型码，用以控制显示的类型，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">%s 字符串 (采用str()的显示)</div><div class="line">%r 字符串 (采用repr()的显示) </div><div class="line">%c 单个字符 </div><div class="line">%b 二进制整数 </div><div class="line">%d 十进制整数 </div><div class="line">%i 十进制整数 </div><div class="line">%o 八进制整数 </div><div class="line">%x 十六进制整数 </div><div class="line">%e 指数 (基底写为e) </div><div class="line">%E 指数 (基底写为E) </div><div class="line">%f 浮点数 </div><div class="line">%F 浮点数，与上相同 </div><div class="line">%g 指数(e)或浮点数 (根据显示长度) </div><div class="line">%G 指数(E)或浮点数 (根据显示长度)</div></pre></td></tr></table></figure>
<h3 id="格式符号进阶">格式符号进阶</h3>
<p>格式符号还可以按如下方式进行使用：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="number">1.</span> %[(name)][flags][width].[precision]typecode </div><div class="line"><span class="number">2.</span> (name)为命名 </div><div class="line"><span class="number">3.</span> flags可以有+,-,<span class="string">' '</span>或<span class="number">0</span>。+表示右对齐。-表示左对齐。<span class="string">' '</span>为一个空格，表示在正数的左侧填充一个空格，从而与负数对齐。<span class="number">0</span>表示使用<span class="number">0</span>填充。 </div><div class="line"><span class="number">4.</span> width表示显示宽度 </div><div class="line"><span class="number">5.</span> precision表示小数点后精度</div></pre></td></tr></table></figure>
<p>使用案例如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(<span class="string">"%+10x"</span> % <span class="number">10</span>)</div><div class="line">        +a</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(<span class="string">"%04d"</span> % <span class="number">5</span>)</div><div class="line"><span class="number">0005</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(<span class="string">"%6.3f"</span> % <span class="number">2.3</span>)</div><div class="line"> <span class="number">2.300</span></div></pre></td></tr></table></figure>
<p>上面的width, precision为两个整数。我们可以利用<code>*</code>，来动态代入这两个量。比如：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(<span class="string">"%.*f"</span> % (<span class="number">4</span>, <span class="number">1.2</span>))</div><div class="line"><span class="number">1.2000</span></div></pre></td></tr></table></figure>
<p>Python实际上用4来替换<code>*</code>。所以实际的模板为<code>%.4f</code>:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(<span class="string">"%.4f"</span> % (<span class="number">1.2</span>))</div><div class="line"><span class="number">1.2000</span></div></pre></td></tr></table></figure>
<h2 id="参考资料">参考资料</h2>
<ol style="list-style-type: decimal">
<li>编程小白的第一本Python入门书</li>
<li><a href="https://item.jd.com/12040511.html" target="_blank" rel="external">Python可以这样学.董付国</a></li>
<li><a href="http://www.runoob.com/python3/python3-tutorial.html" target="_blank" rel="external">Python教程|菜鸟教程</a></li>
<li>MagnusLieHetland. Python基础教程.第3版[M]. 人民邮电出版社, 2018.</li>
<li>Python数据分析基础。ClintonW.Brownley.</li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2018/04/02/BIoTools/GO分析笔记/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/04/02/BIoTools/GO分析笔记/" itemprop="url">GO分析学习笔记</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-04-02T12:00:00+08:00">
                2018-04-02
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/生信工具/" itemprop="url" rel="index">
                    <span itemprop="name">生信工具</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  10,623
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  41
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="什么是富集分析">什么是富集分析？</h2>
<p>当我们获得了一批生物数据时，例如转录组的数据，蛋白质组的数据，其中必然要做不同样本之间的差异基因分析这一步，例如空白对照组与实验组的差异基因或蛋白分析。在得到差异的基因或蛋白列表后，这个时候可能还会遇到一个问题，差异基因可能有很多，有几十个到上百个不等，如何对它们进行比较呢？这几十甚至上百差异基因或蛋白如何去呈现，这是一个问题，如果直接列张表，把所有的差异基因都放进去这样不合适，因为不直观，不方便分析。</p>
<p>此时我们就需要把这些差异基因进行注释，把这些基因或蛋白分成几大类（一个类别就相当于一个GO term），此时看这几大类的区别，肯定比看几十甚至上百个基因或蛋白的差异要更加直观，分析的难度也会降低，这个过程就是富集分析，富集分析属于差异基因的下游分析，常用的富集分析方法有GO分析，KEGG分析，GSEA分析等。</p>
<p>富集分析涉及到两个概念，前景基因和背景基因（不同的教程使用的术语不一样，总之看具体的含义）。前景基因就是你关注的要重点研究的基因集，背景基因就是所有的基因集。比如做两个样本对照组和处理组的转录组测序，前景基因就是对照组vs处理组的差异基因，背景基因就是这两组样本的所有表达基因。</p>
<h3 id="富集分析的例子">富集分析的例子</h3>
<p>再打个比方，我想知道与整个广东省相比，深圳市的大学生是不是显著更多（“大学生”就相当于深圳市民的其中一个GO term）。那么前景就是深圳市的人口，背景就是广东省的人口，每个个体都会有一个标签（如大学生、中学生、小学生等）。 富集的意思就是，某个GO term在所关注的前景基因集中占的比例要显著高于在所有背景基因集中所占的比例。比如上面的例子，深圳市大学生显著富集，意思就是深圳市本科毕业的人口所占深圳市总人口的比例显著高于广东省本科毕业人口在广东省总人口中所占的比例，例如我们要计算的就是10%与2%相比是否有显著性，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180721/m3BL96D59j.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>这个显著性是如何计算的呢，就是利用<a href="http://rvdsd.top/2018/07/23/BioStatistics/%E7%94%9F%E7%89%A9%E7%BB%9F%E8%AE%A1-02-%E8%B6%85%E5%87%A0%E4%BD%95%E5%88%86%E5%B8%83/">超几何分布</a>来计算出来的。</p>
<h2 id="什么是go什么又是go分析">什么是GO，什么又是GO分析</h2>
<p>GO的全称是Gene Ontology，中文意思是<code>基因本体论</code> 。GO的出现主要是源于生物研究的复杂性以及生物研究规模的日益扩大，为了对基因的产物进行统一的描述，就需要使用当前储备的知识，以计算机为工具对这些生物研究进行描述，这就是GO项同出现的背景，GO提供了对基因功能与基因产物最为全面的描述。GO知识库主要由两个内容构成：</p>
<ol style="list-style-type: decimal">
<li>GO terms，它提供生物过程的逻辑结构与相关关系，不同GO terms之间的关系可以通过一个有向无环图来表示。这是由基因本体联合会(Gene Ontology Consortium，GOC) 负责的，GO是一个国际标准化的基因功能分类体系，提供了一套动态并可控的词汇表（controlled vocabulary）来全面描述生物体中基因和基因产物的属性，它由一组预先定义好的GO术语（GO term）组成，这组术语对基因产物的功能进行限定和描述。此处需要注意的是，GO terms是对基因的产物，而不是基因本身进行描述，因为基因本身的产物有时候不止一种。GO数据库中的GO分类相关信息会得到不断地更新与增加，这个特点要记住，因为不同的GO分析工具使用的数据库版本有可能不一样，造成GO分析结果出现不同，例如以前Y叔就写过这样的文章<a href="https://mp.weixin.qq.com/s/ITyD4fyAQeUzg-yCbIJnpg" target="_blank" rel="external">《SCIENCE文章用了DAVID被吐槽》</a>。</li>
<li>GO注释（GO annotations）库，它主要是为GO terms提供注释，也就是描述这个GO terms有什么功能（例如某些基因的产物是什么，是蛋白质，还是非编码RNA，还是大分子等）。</li>
</ol>
<p>总之，通过ontology和注释能够对生物系统提供一个广泛的描述。目前，GO知识库（GO knowledgebase）包含源于14万篇论文中的实验验证，它代表了60万个有实验支持的GO注释。这些核心知识库中还含有另外600万个推断而来的GO注释。除了核心知识库外，GOC还提供了能够编辑并推断ontology之间逻辑关系的软件，分析工具等，GO中的注释来源，通用不同的代码进行了区分，如下所示。</p>
<h2 id="go中的基因注释证据代码">GO中的基因注释证据代码</h2>
<p>一个GO注释由一个与GO term相关的特定参考和基因产物构成，GO注释的来源各异，下表就说明了GO注释的各种来源代码，其中<code>*</code>部分表示证据来源可靠性比较高</p>
<table>
<colgroup>
<col width="37%">
<col width="20%">
<col width="42%">
</colgroup>
<thead>
<tr class="header">
<th>缩写</th>
<th>证据代码</th>
<th>例子</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>IC,Inferred by curator</td>
<td>由专家推测得到</td>
<td>推测它定位在细胞核中一个蛋白质如果有“转录因子”的功能注释，专家就可以</td>
</tr>
<tr class="even">
<td>*IDA,Inferred from direct assay</td>
<td>有直接实验证据</td>
<td>如酶活化实验（针对“分子功能”），免疫荧光显微镜（针对“细胞组分”）</td>
</tr>
<tr class="odd">
<td>IEA,Inferred from electronic annotation</td>
<td>有电子注释</td>
<td>基于像BLAST这些搜索软件搜索结果的电子注释（与ISS比较，IEA没有被专家证实）</td>
</tr>
<tr class="even">
<td>*IEP,Inferred from expression pattern</td>
<td>有表达模式方面的证据</td>
<td>转录水平（如Nothern Bloting或微阵列实验结果）或蛋白质表达水平（Western blots实验结果）</td>
</tr>
<tr class="odd">
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>*IGI,Inferred from genetic interaction</td>
<td>有遗传相互作用方面的证据</td>
<td>抑制基因；遗传致死基因；互补试验；还有其他一些可以提供某一基因功能信息的实验</td>
</tr>
<tr class="odd">
<td>*IMP,Inferred from mutant phenotype</td>
<td>由突变表型推测得到</td>
<td>基因突变；基因敲出；过量表达；反义RNA实验</td>
</tr>
<tr class="even">
<td>*IPI,Inferred from physical interaction</td>
<td>由物理相互作用推测得到</td>
<td>酵母双杂交实验；共纯化实验；免疫共沉淀实验；结合实验</td>
</tr>
<tr class="odd">
<td>ISS,Inferred from sequence or structural similarity</td>
<td>由序列或结构的相似性得到</td>
<td>序列的相似性；结构域；被专家确认的BLAST软件的搜索结果</td>
</tr>
<tr class="even">
<td>NAS,Non-traceable author statement</td>
<td>有报道，但报道信息来源不可知</td>
<td>数据库（如SwissPort数据库）登录条目的记录中没有引用已发表的文献</td>
</tr>
<tr class="odd">
<td>ND,No biological data</td>
<td>没有相关的生物数据</td>
<td>对应于“unknown”的分子功能、细胞过程或细胞组分</td>
</tr>
<tr class="even">
<td>TAS,Traceable author statement</td>
<td>有报道，且可知报道信息来源</td>
<td>有一些综述文章或字典中可以找到相关信息</td>
</tr>
</tbody>
</table>
<h3 id="为什么要做go分析">为什么要做GO分析</h3>
<p>GO主要用于解决一些组学实验（omics）中大量分子变化的研究问题。一个典型的组学实验会检测数以千计的分子，因此对于这些变化的分子进行解释非常困难（例如一个肿瘤细胞与一个正常细胞之间的差异）。而GO富集分析（GO Enrichment Analysis）就能把这些数以千计的分子（例如蛋白质或一些非编码RNA）根据其功能的相似性放到不同的类别中，然后对它们进行分析，这样就在很大的程度上降低了分析的难度。GO分析比较的就是两组差异基因，例如实验组与对照组的差异基因，存在在某个通路中的比例是否有差异，其统计学基因就是超几何分布。</p>
<h3 id="go分析的统计学基础">GO分析的统计学基础</h3>
<p>GO分析的统计学基础就是<a href="http://rvdsd.top/2018/07/23/BioStatistics/%E7%94%9F%E7%89%A9%E7%BB%9F%E8%AE%A1-02-%E8%B6%85%E5%87%A0%E4%BD%95%E5%88%86%E5%B8%83/">超几何分布</a>，超几何的相关知识在笔记的最后，就是对每个GO term计算一个P值，公式如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180721/AI391eeChk.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>N表示总基因数；</p>
<p>n表示N中差异表达基因的总数；</p>
<p>M表示N中属于某个GO term的基因个数；</p>
<p>k表示n中属于某个GO term的基因个数。</p>
<p>这个公式表示的意思是，从总的N个基因中挑出n个基因，作为分母（这是背景基因），分子则是M个基因（我们的差异基因，这是前景基因），有k个落在了某通路里，有n-k个不落在了某通路里，然后使用超几何分布来对它们进行计算，即前景基因落在某通路的比例是否高于背景基因在这一通路的比例，实际计算时，是算的odds ratio的差异。</p>
<p>现在举个例子，在GO分析的结果表格中，会出现以下信息：</p>
<p>Background Frequency，背景基因频数，指的是在整个背景基因集中，注释到一个GO term中的基因数目。 Sample Frequency，样本基因频数（有的也叫前景基因频数，总之，就是你要研究的一批基因）指的是，在你研究的基因列表中，注释到这个GO term（与Background Frequency的GO term相同的这个GO term）的基因数目。例如，我们在研究酿酒酵母（S. cerevisiae）的生物过程（biological process）时，这个物种的背景基因是6442个基因，例如我们要研究的目的基因有10个，其中有5个基因被注释到了一个这样的GO term上，这个GO term是：DNA修复（DNA repair），然后样本中的DNA修复的基因频率就是5/10，如果在酿酒酵母（S. cerevisiae）的整个基因组中，只有100个基因注释到了DNA修复的这个GO term上，那么背景基因的频率就是100/6442。GO分析就是利用超几何分布（或Fisher精确检验）来比较一下5/10和100/6442有没有统计学差异，GO分析结果的表格中会列出这个计算结果的P值。 P-value，</p>
<h2 id="go-term的查询">GO term的查询</h2>
<p>浏览GO term经常有使用到两个工具，分别是AmiGO（GO Central ）和QuickGO（EBI-GOA ）。</p>
<p>AmiGO的GO注释文件（GAF，GO Annotation File）与基因是1对1的关系。QuickGO中的GO注释文件是GOA（Gene Ontology Annotation），它主要用于注释蛋白质，而一个基因有时候会产生有几个蛋白质（因为有异构体的情况，isoform）。</p>
<h2 id="go对基因的描述">GO对基因的描述</h2>
<p>一个GO term的编号是由两部分构成，第一个部分相同，都是<code>GO</code>，第二部分是一个唯一的数字标记，它是以0开头的7位数字，例如<code>GO:0005125</code>，其中数字部分并没有任何任何生物学方面的意义，它仅起到一个标记的作用。除了这个名称外，GO term还有一些文本，来作用GO term的名称，比如 <code>&quot;cell&quot;</code>, <code>&quot;fibroblast growth factor receptor binding&quot;</code>，或者<code>&quot;signal transduction&quot;</code>，如下所示（由AmiGO 2查询而来）：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180721/G2kkliF27b.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>GO term按照分类，一共三个ontology（本体），分别描述基因的分子功能（molecular function，MF）、细胞组分（cellular component，CC）、参与的生物过程（biological process，BP）。G这三个本体的含义如下所示：</p>
<ol style="list-style-type: decimal">
<li>细胞组成（cellular component，CC）：一般用来描述基因产物的发挥作用的位置，比如一个蛋白可能定位在细胞核中，也可能定位在核糖体中；</li>
<li>生物过程（biological process，BP）：描述的是指基因产物所联系的一个大的生物功能，或者说是它们要完成的一个大的生物目标，例如有丝分裂或嘌呤代谢；</li>
<li>分子功能（Molecular Function，MF）：主要是指基因产物分子所执行的任务，例如一个蛋白质可能一个转录因子或是一个载体蛋白。</li>
</ol>
<p>蛋白质或者基因可以通过<code>ID对应</code>或者<code>序列注释</code>的方法找到与之对应的GO号，而GO号可应用到到相应的GO Term，即功能类别或者细胞定位，<code>ID对应</code>我的理解就是根据基因的EntrezID或SYMBOL等，将这个基因与相应的GO term对应起来，<code>序列注释</code>则是通过将某段序列与数据库中的序列进行比对，然后将这段序列与GO term对应起来，这个过程也就是将基因的产物与相应的GO term对应起来，也就是注释过程。</p>
<p>在一个GO注释中，例如，一个基因的产物是细胞色素c（cytochrome c），那么这个基因的产物就会被一个分子功能术语（Molecular Function）描述为氧化还原酶活性（oxidoreductase activity ），被生物过程（Biological Process）描述为氧化磷酸化（oxidative phosphorylation ），被细胞成分（Cellular Component ）描述为线性体基质（mitochondrial matrix ）和线粒体内膜（mitochondrial inner membrane ）。</p>
<p>再举个例子，对于一个基因或蛋白来说，最终一个基因的产物会被多个GO术语进行注释（反之亦然，一个GO术语中也可以注释多个基因的产物），形成的GO分析描述就是这个样子的：HOTAIR出没于胞核（CC），参与了组蛋白甲基化调控引发癌基因沉默（BP），具体是结合PRC2复合物以及LSD1（MF）。这样GO分析就从某个基因或蛋白在细胞中的定位，功能，参与的生物途径等方面对这个基因或蛋白进行了标准化的描述，即对基因产物进行了简单的注释，通过GO富集分析可以了解差异基因富集在哪些生物学功能、途径或细胞定位。</p>
<h2 id="go-term的结构">GO term的结构</h2>
<p>所有的GO terms之间都存在着相互关系，它们的关系可以用有向无环图（DAG，Directed Acyclic Graph）来说明，DAG图就能够明确地表示出不同GO term之间的关系，它们之间的关系有很多种，例如<code>is_a</code>，<code>part_of</code>,<code>regulates</code>,<code>has part</code>, <code>negatively regulates</code>和<code>positively regulates</code>。除了根节点（例如CC，BP，MF这些节点）外，其余的GO terms都与其它的GO terms都有一定的亚类关系，例如<code>GO:0015758</code> （葡萄糖运输，glucose transport）is a <code>GO:0015749</code>单糖转运（monosaccharide transport）的一个亚类。其他的关系还有<code>GO:0031966</code>: mitochondrial membrane <code>part of</code> <code>GO:0005740</code> : mitochondrial envelope， <code>GO:0006916</code> : anti-apoptosis <code>regulates</code> <code>GO:0012501</code> : programmed cell death。</p>
<p>一个典型的GO term内容如下所示（通过QuickGO查询）：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line">Accession</div><div class="line">GO:0005515</div><div class="line">Name</div><div class="line">protein binding</div><div class="line">Ontology</div><div class="line">molecular_function</div><div class="line">Synonyms</div><div class="line">protein amino acid binding, glycoprotein binding</div><div class="line">Alternate IDs</div><div class="line">GO:0045308, GO:0001948</div><div class="line">Definition</div><div class="line">Interacting selectively and non-covalently with any protein or protein complex (a complex of two or more proteins that may include other nonprotein molecules). Source: GOC:go_curators</div><div class="line">Comment</div><div class="line">None</div><div class="line">History</div><div class="line">See term history for GO:0005515 at QuickGO</div><div class="line">Subset</div><div class="line">goslim_metagenomics</div><div class="line">goslim_aspergillus</div><div class="line">goslim_chembl</div><div class="line">goslim_plant</div><div class="line">gosubset_prok</div><div class="line">goslim_candida</div><div class="line">goslim_pir</div></pre></td></tr></table></figure>
<p>这些就是一个GO term的内容，GO就是为了对基因以及基因的产物进行统一注释说明而形成的一套标准，这些注释说明来自称为ontology的一套词汇。此外，GO terms中还存在着一些次要IDs（secondary IDs），这些次要IDs也叫替代ID，即Alternate ID，它指的是一个GO term，当有两个或更多的GO terms是同样的含义时，就需要使用到二级IDs，此时可以把它们合并为一个GO term。</p>
<h3 id="有向无环图说明">有向无环图说明</h3>
<p>GO terms的结构是一个有向无环图，每个GO term是一个节点，它们之间的关系用这些节点之间的箭头来表示。GO分析是一个松散的层次结构，其子GO term比父GO term更具体，不过与严格的层次结构不同，一个GO term也许有不止一个父GO term，比如biological process term “hexose biosynthesis” 有两个parents，它们分别是 “hexose metabolism”和“monosaccharide biosynthesis”，这是因为生物合成是代谢的一种，而己糖又是单糖的一种。</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180720/H3l3illBH0.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>上图是色素沉着的一系列GO term，在这张图形里，不同GO terms之间的关系用标了颜色的箭头来表示，每个箭头中间的字母就是关系类型。箭头指向的方向，是分类更加精细的方向，图表项部的节点就是细胞成分（CC），生物学过程（BP）与分子功能（MF），这三个节点没有共同的父节点，每个都是一个根节点，因此GO是三本原系统，不过在一些GO分析工具中会做出一个虚拟的根节点，把这三个节点都指向这个虚拟根节点。这三个节点之间不存在<code>is_a</code>关系，但是，这三个本体之间可能存在着其它的关系，例如<code>part_of</code>和<code>regulates</code>，例如，分子功能（MF）的GO term“细胞周期蛋白依赖性蛋白激酶活性”（cyclin-dependent protein kinase activity）与生物学过程（BP）term的“细胞周期（cell cycle）”之间的关系是<code>part_of</code>。</p>
<h2 id="不同的term之间的关系">不同的term之间的关系</h2>
<p>不同的GO term之间的关系有很多种，例如<code>is</code>，<code>part of</code>等，并且不同的关系还能组合，衍生出不同GO terms之间的关系，这里只列举几个说明一下。</p>
<h3 id="is关系">is关系</h3>
<p>不同GO terms之间的关系使用箭头来表示，实心箭头表示了它们的直接关系，虚线表示了对于它们的关系的推测，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180721/FKaIiHBCdI.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>A，B，C是上述关系，那么我们就能推测出A是C的一部分。</p>
<p>在GO的关系图中，一个节点有可能有不止一个子节点（child node），也有可能不止有一个父节点（parent node），例如一个节点A与节点B的关系是<code>a part of</code>的关系，它与节点C的关系就有可能是<code>is a</code>的关系，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180721/F2EmA41iLe.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>在上面的这张图中我们可以发现，线粒体（mitochondrion）有两个父节点，分别为细胞质（cytoplasm）和细胞器（organelle），它是细胞质的一部分（关系为<code>part of</code>），它是一个细胞器（关系为<code>is</code>）。而细胞器（organelle）这个节点有2个子节点（children nodes），分别为线粒体（mitochondrion）和细胞器膜（organelle membrane），与它们的关系分别为<code>is</code>和<code>part of</code>。</p>
<p>GO关系的基础是<code>is</code>关系，如果我们说A<code>is</code>a B，那么我们所表示的含义就是A节点是B节点的一个亚类（subtype）。例如，有丝细胞分裂周期（mitotic cell cycle）<code>is</code>a 细胞周期（cell cycle）或者裂解酶活性（lyase activity）<code>is</code>a 催化活性（catalytic activity），它所表示的意思是就是<code>有丝分裂周期</code>是<code>细胞周期</code>的一个亚类，<code>裂解酶活性</code>是<code>催化活性</code>的一个亚类。</p>
<p>这里的<code>is</code>不是指一个“实例（instance）”，从本体论的角度来看，一个“实例”专门指的是某个抽象分类的一个具体事物，例如，猫是一种动物，这里猫与动物的关系，就是GO中的<code>is</code>关系，而加菲猫（这里专门指的动画片中的那只猫）是猫的一个具体事物，不是猫的一个亚类，这里加菲猫与猫的关系就不等于GO中的<code>is</code>这个关系。GO中并不使用具体的实例，GO terms指的是一类现象或一类事物，是一种抽象的概念，例如我们知道了猫是（<code>is</code>）一类动物，那么我们就可以说猫的每个实例都是动物。</p>
<p>is关系的推理</p>
<p>is这种关系是可以传递（transitive），如果我们说A<code>is</code>a B，B<code>is</code>a C，那么我们就能推断出A<code>is</code>a C，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180721/l54e4DE9Ig.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>举个例子，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180721/HAia8E4ik5.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>在这张图中，线粒体（mitochondrion）<code>is</code>a 细胞内细胞器（ intracellular organelle ），细胞内细胞器（ intracellular organelle ）<code>is</code>a细胞器（organelle  0，因此我们可以推断出，线粒体是一个细胞器，用逻辑符号表示就是<em>is a∘ </em>is a* → is a `。</p>
<p>用<code>is</code>可以对注释进行分组，例如。如果一个基因的产物是X，那它被注释为有酪氨酸激酶活性，这个GO就可以记录它为酪氨酸激酶活性<code>is</code>a（type of）激酶活性，然后我们就可以下结论，认为基因产物X有激酶活性。</p>
<h3 id="part-of关系">part of关系</h3>
<p><code>part of</code>在GO中用于表示整体与部分的关系，如果B是A的必要组成部分，那么B存在的地方，A必定存在。但是，如果A存在，我们不能说B也存在。它们的关系如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180721/7j7AlbA2CH.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>上图：整个B是A的组成部分，而A的一部分则含有B。</p>
<p>下图：复制叉（Replication fork）是染色体的必要组成（necessarily part of），所有（all）的复制叉是一些染色体的部分（part of），但是（some）染色体只有一有部分（have part）含有复制叉。</p>
<p><code>part of</code>的推断：<code>part of∘ part of → part of</code></p>
<p>与<code>is</code>这种关系一样，<code>part of</code>这种关系也能传递，如果A<code>part of</code>B<code>part C</code>，那么<code>A part C</code>，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180721/8aI0C0m72A.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>举个例子，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180721/49kAlkI6BG.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>线粒体（mitochondrion）是细胞质（cytoplasm  ）的<code>part of</code>，而细胞质（cytoplasm  ）是细胞（cell）的<code>part of</code>，那么我们就可以说，线粒体是细胞的<code>part of</code>。GO中还有很多关系，由于篇幅问题，就略去了，具体的可以查看官网（http://geneontology.org/page/ontology-relations）。</p>
<h2 id="go分析流程">GO分析流程</h2>
<h3 id="go分析的思路">GO分析的思路</h3>
<p>现在了解了GO分析的一些原理之后，我们自己就大概就明白了需要做哪些事情。</p>
<p>第一件事情就是我们要把差异基因与相应的GO terms对应起来；</p>
<p>第二件事情就是需要找到前景基因（也就是差异基因）与背景基因；</p>
<p>第三件事情就是，将对应起来的GO terms进行比较，也就是利用超几何检验，这些差异基因在某个通路中的比例是否要高于背景基因；</p>
<p>第四件事情就是绘图，也就是文献中经常出现的GO条形图。</p>
<h3 id="go分析所需的文件">GO分析所需的文件</h3>
<p>进行GO分析需要下载以下数据文件。</p>
<p>第一个文件就是注释文件，这个文件的主要用于将不同的基因与其相应的GO terms对应起来。GO中的术语如何和相对应的基因产物相联系的呢？</p>
<p>这是由参与合作的数据库来完成的，它们使用GO的定义方法，对它们所包含的基因产物进行注解，并且提供支持这种注解的参考和证据。每个基因或基因产物都会有一个列表，列出与之相关的GO术语。每个数据库都会给出这些基因产物和GO术语的联系数据库，并且也可以在GO的ftp站点上和WEB方式查询到。而且，GO联合会提供了简化的本体论术语（GO slim），这样，可以在更高级的层面上研究基因组的功能。比如，粗略地估计哪一部分的基因组与信号传导、代谢合成或复制有关。GO对基因和蛋白的注释阐明了基因产物和用于定义他们的GO术语之间的关系。</p>
<p>基因产物指一个基因编码的RNA或蛋白产物。因为一个基因可能编码多个具有很不相同性质的产物，所以GO推荐的注释是针对基因产物的而不是基因的。一个基因是和所有适用于它的术语联系在一起的。一个基因产物可以被一种本体论定义的多种分支或多种水平注释。注释需要反映在正常情况下此基因产物的功能，生物途径，定位等，而并不包括其在突变或病理状态下的情况。GO联合会的各个数据库成员采用手动或自动的方式生成注释，这两种方式共有的原理是：一.所有的注释都需要有来源,可以是文字、另一个数据库 或是计算机分析结果；二.注释必须提供支持这种基因产物和GO术语之间联系的证据，</p>
<p>注释文件通常是以后缀<code>db</code>结尾的文件，例如<code>org.Hs.eg.db</code>文件，<code>org.Hs.eg.db</code>文件里面含有很多主流数据库的数据，例如entrez ID和Ensembl数据库的ID，在R中，可以使用一些命令提取这个文件中相应的信息，这个文件是一个AnnotationDb-objects对象，使用方法如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">columns(x)</div><div class="line">keytypes(x)</div><div class="line">keys(x, keytype, ...)</div><div class="line">select(x, keys, columns, keytype, ...)</div><div class="line">mapIds(x, keys, column, keytype, ..., multiVals)</div><div class="line">saveDb(x, file)</div><div class="line">loadDb(file, packageName=NA)</div></pre></td></tr></table></figure>
<p>命令解释如下所示：</p>
<p><code>columns</code>：从数据库中检索的列或种类，例如基因名（GENENAME）或者是基因标记（SYMBOL），如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&gt; columns(org.Hs.eg.db)</div><div class="line"> [1] &quot;ACCNUM&quot;       &quot;ALIAS&quot;        &quot;ENSEMBL&quot;      &quot;ENSEMBLPROT&quot;  &quot;ENSEMBLTRANS&quot; &quot;ENTREZID&quot;     &quot;ENZYME&quot;      </div><div class="line"> [8] &quot;EVIDENCE&quot;     &quot;EVIDENCEALL&quot;  &quot;GENENAME&quot;     &quot;GO&quot;           &quot;GOALL&quot;        &quot;IPI&quot;          &quot;MAP&quot;         </div><div class="line">[15] &quot;OMIM&quot;         &quot;ONTOLOGY&quot;     &quot;ONTOLOGYALL&quot;  &quot;PATH&quot;         &quot;PFAM&quot;         &quot;PMID&quot;         &quot;PROSITE&quot;     </div><div class="line">[22] &quot;REFSEQ&quot;       &quot;SYMBOL&quot;       &quot;UCSCKG&quot;       &quot;UNIGENE&quot;      &quot;UNIPROT&quot;</div></pre></td></tr></table></figure>
<p><code>keytypes</code> ：哪些类型可以使用函数<code>select</code>或<code>keys</code>以及<code>keytype</code>参数，如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">keytypes(org.Hs.eg.db)</div><div class="line"> [1] &quot;ACCNUM&quot;       &quot;ALIAS&quot;        &quot;ENSEMBL&quot;      &quot;ENSEMBLPROT&quot;  &quot;ENSEMBLTRANS&quot; &quot;ENTREZID&quot;     &quot;ENZYME&quot;      </div><div class="line"> [8] &quot;EVIDENCE&quot;     &quot;EVIDENCEALL&quot;  &quot;GENENAME&quot;     &quot;GO&quot;           &quot;GOALL&quot;        &quot;IPI&quot;          &quot;MAP&quot;         </div><div class="line">[15] &quot;OMIM&quot;         &quot;ONTOLOGY&quot;     &quot;ONTOLOGYALL&quot;  &quot;PATH&quot;         &quot;PFAM&quot;         &quot;PMID&quot;         &quot;PROSITE&quot;     </div><div class="line">[22] &quot;REFSEQ&quot;       &quot;SYMBOL&quot;       &quot;UCSCKG&quot;       &quot;UNIGENE&quot;      &quot;UNIPROT&quot;</div></pre></td></tr></table></figure>
<p><code>keys</code>：返回AnnotationDb 中数据库的keys，通常是某个基因的ENSEMBL的编号，ENTREZID 的编号等，经常与select配合使用，通常情况下会返回数据库的关键词，如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; head(keys(org.Hs.eg.db))</div><div class="line">[1] &quot;1&quot;  &quot;2&quot;  &quot;3&quot;  &quot;9&quot;  &quot;10&quot; &quot;11&quot;</div></pre></td></tr></table></figure>
<p><code>select</code>：(x, keys, columns, keytype, …)，基于keys, columns和keytypes以data.frame数据类型返回数据，可以是一对多的关系，使用select函数可以把任意公共数据库的数据进行一一对应，例如我们有几个ENSEMBL的基因ID号，然后我想找到它们所对应的gene名和缩略词简称，就可以按以下进行的操作：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">ensids &lt;-c(<span class="string">"ENSG00000130720"</span>,<span class="string">"ENSG00000103257"</span>,<span class="string">"ENSG00000156414"</span>,<span class="string">"ENSG00000144644"</span>,<span class="string">"ENSG00000159307"</span>, <span class="string">"ENSG00000144485"</span>)</div><div class="line"><span class="comment"># 基因的ENSEMBL编号</span></div><div class="line"></div><div class="line">cols &lt;- c(<span class="string">"SYMBOL"</span>, <span class="string">"GENENAME"</span>)</div><div class="line"><span class="comment"># 基因的SYMBOL和GENENAME</span></div><div class="line"></div><div class="line">select(org.Hs.eg.db, keys=ensids, columns=cols, keytype=<span class="string">"ENSEMBL"</span>)</div><div class="line"><span class="comment"># 使用select函数从org.Hs.eg.db数据库中提取这些基因的信息</span></div><div class="line"></div><div class="line">select(org.Hs.eg.db, keys=ensids, columns=cols, keytype=<span class="string">"ENTREZID"</span>)</div><div class="line"><span class="comment"># 使用select函数从org.Hs.eg.db数据库中提取这些基因的信息</span></div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">          ENSEMBL SYMBOL                                                    GENENAME</div><div class="line">1 ENSG00000130720 FIBCD1                            fibrinogen C domain containing 1</div><div class="line">2 ENSG00000103257 SLC7A5                            solute carrier family 7 member 5</div><div class="line">3 ENSG00000156414  TDRD9                                   tudor domain containing 9</div><div class="line">4 ENSG00000144644  GADL1                              glutamate decarboxylase like 1</div><div class="line">5 ENSG00000159307 SCUBE1 signal peptide, CUB domain and EGF like domain containing 1</div><div class="line">6 ENSG00000144485   HES6                      hes family bHLH transcription factor 6</div></pre></td></tr></table></figure>
<p>再举个例子，现在我从<code>org.Hs.eg.db</code>数据库中提取<code>BRCA1</code>基因，提取它的ENSEMBL编号，UNIGENE，ENTREZID，CHR，GO和GENENAME等，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">select(org.Hs.eg.db, keys=<span class="string">"BRCA1"</span>, columns=c(<span class="string">"ENSEMBL"</span>,<span class="string">"UNIGENE"</span>,<span class="string">"ENTREZID"</span>,<span class="string">"CHR"</span>,<span class="string">"GO"</span>,<span class="string">"GENENAME"</span>), keytype=<span class="string">"SYMBOL"</span>)</div></pre></td></tr></table></figure>
<p>信息很多，只显示前几行，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">  SYMBOL         ENSEMBL   UNIGENE ENTREZID CHR         GO EVIDENCE ONTOLOGY                     GENENAME</div><div class="line"><span class="number">1</span>   BRCA1 ENSG00000012048 Hs.194143      <span class="number">672</span>  <span class="number">17</span> GO:<span class="number">0000151</span>      NAS       CC BRCA1, DNA repair associated</div><div class="line"><span class="number">2</span>   BRCA1 ENSG00000012048 Hs.194143      <span class="number">672</span>  <span class="number">17</span> GO:<span class="number">0000724</span>      IDA       BP BRCA1, DNA repair associated</div><div class="line"><span class="number">3</span>   BRCA1 ENSG00000012048 Hs.194143      <span class="number">672</span>  <span class="number">17</span> GO:<span class="number">0000729</span>      TAS       BP BRCA1, DNA repair associated</div><div class="line"><span class="number">4</span>   BRCA1 ENSG00000012048 Hs.194143      <span class="number">672</span>  <span class="number">17</span> GO:<span class="number">0000731</span>      TAS       BP BRCA1, DNA repair associated</div><div class="line"><span class="number">5</span>   BRCA1 ENSG00000012048 Hs.194143      <span class="number">672</span>  <span class="number">17</span> GO:<span class="number">0000732</span>      TAS       BP BRCA1, DNA repair associated</div><div class="line"><span class="number">6</span>   BRCA1 ENSG00000012048 Hs.194143      <span class="number">672</span>  <span class="number">17</span> GO:<span class="number">0000800</span>      IDA       CC BRCA1, DNA repair associated</div><div class="line"><span class="number">7</span>   BRCA1 ENSG00000012048 Hs.194143      <span class="number">672</span>  <span class="number">17</span> GO:<span class="number">0003677</span>      TAS       MF BRCA1, DNA repair associated</div><div class="line"><span class="number">8</span>   BRCA1 ENSG00000012048 Hs.194143      <span class="number">672</span>  <span class="number">17</span> GO:<span class="number">0003684</span>      IEA       MF BRCA1, DNA repair associated</div></pre></td></tr></table></figure>
<p>从上面案例就可以发现，一个BRCA1基因可以对应好几个GO terms，再举个例子，根据EntrezID来查询基因名，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">&gt; en &lt;-c(<span class="string">"23032"</span>,<span class="string">"11215"</span>)</div><div class="line">&gt; coils&lt;-c(<span class="string">"SYMBOL"</span>,<span class="string">"GENENAME"</span>)</div><div class="line">&gt; select(org.Hs.eg.db,keys=en,columns=cols,keytype=<span class="string">"ENTREZID"</span>)</div><div class="line"><span class="string">'select()'</span> returned <span class="number">1</span>:<span class="number">1</span> mapping between keys and columns</div><div class="line">  ENTREZID SYMBOL                        GENENAME</div><div class="line"><span class="number">1</span>    <span class="number">23032</span>  USP33 ubiquitin specific peptidase <span class="number">33</span></div><div class="line"><span class="number">2</span>    <span class="number">11215</span> AKAP11   A-kinase anchoring protein <span class="number">11</span></div></pre></td></tr></table></figure>
<p>同时，一个GO term也能对应好几个基因，如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">&gt; select(org.Hs.eg.db,keys=&quot;GO:0000122&quot;,columns=c(&quot;ENSEMBL&quot;),keytype=&quot;GO&quot;)</div><div class="line">&apos;select()&apos; returned 1:many mapping between keys and columns</div><div class="line">          GO EVIDENCE ONTOLOGY SYMBOL</div><div class="line">1 GO:0000122      IGI       BP ACVR2B</div><div class="line">2 GO:0000122      TAS       BP  PARP1</div><div class="line">3 GO:0000122      IMP       BP  AEBP1</div><div class="line">4 GO:0000122      IMP       BP    AES</div><div class="line">5 GO:0000122      IEA       BP  NR0B1</div><div class="line">6 GO:0000122      IGI       BP  APBB1</div><div class="line">.....</div><div class="line">.....</div><div class="line">776 GO:0000122      TAS       BP ZNF559-ZNF177</div></pre></td></tr></table></figure>
<p>可以看到，<code>GO:0000122</code>这一个GO terms对应了776个基因。</p>
<p><code>mapIds</code>功能和<code>select</code>类似，只不过他返回的是一组向量，而不是数据库，用法为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mapIds(x, keys, column, keytype, ..., multiVals)</div></pre></td></tr></table></figure>
<p>如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&gt; mapIds(org.Hs.eg.db,keys=c(&quot;1&quot;,&quot;2&quot;,&quot;672&quot;),column=c(&quot;ALIAS&quot;),keytype=&quot;ENTREZID&quot;)</div><div class="line">&apos;select()&apos; returned 1:many mapping between keys and columns</div><div class="line">      1       2     672 </div><div class="line">  &quot;A1B&quot;  &quot;A2MD&quot; &quot;BRCAI&quot;</div></pre></td></tr></table></figure>
<p>现在就清楚了，ogDB这个数据库的用处在于将不同的基因与各自相应的GO terms给对应起来。</p>
<p>第二个文件就是不同GO terms之间的关系文件，这个文件主要记录的是不同GO terms之间的关系，名字为<code>go-basic</code>，下载地址为：http://snapshot.geneontology.org/ontology/go-basic.obo，在进行GO分析时，就利用这个文件来将GO terms绘制成网络图的形式，现在以<code>go-basic.obo</code>为例，这些信息如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">[Term]</div><div class="line">id: GO:0000001</div><div class="line">name: mitochondrion inheritance</div><div class="line">namespace: biological_process</div><div class="line">def: &quot;The distribution of mitochondria, including the mitochondrial genome, into daughter cells after mitosis or meiosis, mediated by interactions between mitochondria and the cytoskeleton.&quot; [GOC:mcc, PMID:10873824, PMID:11389764]</div><div class="line">synonym: &quot;mitochondrial inheritance&quot; EXACT []</div><div class="line">is_a: GO:0048308 ! organelle inheritance</div><div class="line">is_a: GO:0048311 ! mitochondrion distribution</div><div class="line"></div><div class="line">[Term]</div><div class="line">id: GO:0000002</div><div class="line">name: mitochondrial genome maintenance</div><div class="line">namespace: biological_process</div><div class="line">def: &quot;The maintenance of the structure and integrity of the mitochondrial genome; includes replication and segregation of the mitochondrial chromosome.&quot; [GOC:ai, GOC:vw]</div><div class="line">is_a: GO:0007005 ! mitochondrion organization</div></pre></td></tr></table></figure>
<p>第三个文件就是自己要研究的背景基因与背景基因文件。背景基因其实就是你自己所要研究物种的全部基因，前景基因就是你要研究的目的基因有哪些（例如对照组与实验组的差异基因）。</p>
<h4 id="前景基因文件">前景基因文件</h4>
<p>前景基因文件就是你要富集分析的基因集，例如对照组vs处理组的差异表达基因。格式为每行一个基因ID，可以是文本文件，也可以是表格，总之，就是含有一系列基因ID的文件，这个基因ID可以是EntrezID，也可以是SYMBOL等，如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">NNMT</div><div class="line">MAL</div><div class="line">EEF1A2</div><div class="line">HGD</div><div class="line">TCN2</div><div class="line">CDA</div><div class="line">PCCA</div><div class="line">CRYM</div><div class="line">PDXK</div><div class="line">STC1</div><div class="line">WARS</div><div class="line">HMOX1</div><div class="line">FXYD2</div><div class="line">...</div></pre></td></tr></table></figure>
<h4 id="背景基因文件">背景基因文件</h4>
<p>GO背景基因文件：就是所有的基因集，例如如果对照组和处理组所有的表达基因。如果你研究的物种是有参考基因组的模式物种，那么可以直接使用数据库上已有的参考基因作为背景基因文件，背景基因文件就是这个特种所有的基因对应的GO terms，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180722/BId7Dmijkb.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>第一列是基因名（这个基因名可以是基因的SYMBOL，也可以是GENENAME，也可以是ENTREZID，第2列为对应的GO term，一个基因可以对应多个GO terms。</p>
<p>还可以是这样的形式：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180721/aHicjF8a2A.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>第1列是基因ID，第2列以及第2列之后是这一个基因对应的所有GO号。</p>
<p>前景基因文件与背景基因文件的关系就是，前景基因文件是背景基因文件的子集。</p>
<h3 id="go分析实战">GO分析实战</h3>
<p>前面讲了GO分析的一个大概思路，现在看一个具体的案例。</p>
<p>此处使用Y叔的基因富集工具<code>clusterProfiler</code>，这个包操作容易，更新很快，引用率高，非常受欢迎。此外，<code>clusterProfiler</code>这个包功能很强大，除了能够做GO分析外，还能做GSEA分析，不过这里只介绍GO分析。</p>
<p>以下是利用<code>clusterProfiler</code>包进行GO分析的流程。</p>
<h4 id="第一步安装clusterprofiler">第一步：安装clusterProfiler</h4>
<p>这个包是在bioLite上的，需要这个工具，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 1. Install clusterProfile</span></div><div class="line"><span class="keyword">source</span>(<span class="string">"https://bioconductor.org/biocLite.R"</span>)</div><div class="line">biocLite(<span class="string">'clusterProfiler'</span>)</div><div class="line">biocLite(<span class="string">'org.Hs.eg.db'</span>)</div><div class="line">biocLite(<span class="string">'DOSE'</span>)</div><div class="line">install.packages(<span class="string">"glue"</span>) </div><div class="line"><span class="comment"># 安装这个包的过程中，它还会依赖其它的包</span></div><div class="line"><span class="comment"># 可以根据R语言的提示进行安装其他包</span></div></pre></td></tr></table></figure>
<p>注：这里提一下clusterProfiler包的gene ID转换功能，clusterProfiler包中提供了两个函数，分别为<code>bitr</code>和<code>bitr_kegg</code>，这两个函数用于转换基因ID，这里介绍一下<code>bitr</code>，bitr的参数为<code>bitr(geneID, fromType, toType, OrgDb, drop = TRUE)</code>，其中geneID是基因名，fromType表示的是基因名的类型，在下面的转换中，这个基因名的类型为<code>SYMBOL</code>，toType就是要转换为什么ID，在下面的案例中，我们将<code>SYMBOL</code>转换为<code>ENTREZID</code>，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">x &lt;- c(<span class="string">"GPX3"</span>,  <span class="string">"GLRX"</span>,   <span class="string">"LBP"</span>,   <span class="string">"CRYAB"</span>, <span class="string">"DEFB1"</span>, <span class="string">"HCLS1"</span>,   <span class="string">"SOD2"</span>,   <span class="string">"HSPA2"</span>,</div><div class="line">       <span class="string">"ORM1"</span>,  <span class="string">"IGFBP1"</span>, <span class="string">"PTHLH"</span>, <span class="string">"GPC3"</span>,  <span class="string">"IGFBP3"</span>,<span class="string">"TOB1"</span>,    <span class="string">"MITF"</span>,   <span class="string">"NDRG1"</span>,</div><div class="line">       <span class="string">"NR1H4"</span>, <span class="string">"FGFR3"</span>,  <span class="string">"PVR"</span>,   <span class="string">"IL6"</span>,   <span class="string">"PTPRM"</span>, <span class="string">"ERBB2"</span>,   <span class="string">"NID2"</span>,   <span class="string">"LAMB1"</span>,</div><div class="line">       <span class="string">"COMP"</span>,  <span class="string">"PLS3"</span>,   <span class="string">"MCAM"</span>,  <span class="string">"SPP1"</span>,  <span class="string">"LAMC1"</span>, <span class="string">"COL4A2"</span>,  <span class="string">"COL4A1"</span>, <span class="string">"MYOC"</span>,</div><div class="line">       <span class="string">"ANXA4"</span>, <span class="string">"TFPI2"</span>,  <span class="string">"CST6"</span>,  <span class="string">"SLPI"</span>,  <span class="string">"TIMP2"</span>, <span class="string">"CPM"</span>,     <span class="string">"GGT1"</span>,   <span class="string">"NNMT"</span>,</div><div class="line">       <span class="string">"MAL"</span>,   <span class="string">"EEF1A2"</span>, <span class="string">"HGD"</span>,   <span class="string">"TCN2"</span>,  <span class="string">"CDA"</span>,   <span class="string">"PCCA"</span>,    <span class="string">"CRYM"</span>,   <span class="string">"PDXK"</span>,</div><div class="line">       <span class="string">"STC1"</span>,  <span class="string">"WARS"</span>,  <span class="string">"HMOX1"</span>, <span class="string">"FXYD2"</span>, <span class="string">"RBP4"</span>,   <span class="string">"SLC6A12"</span>, <span class="string">"KDELR3"</span>, <span class="string">"ITM2B"</span>)</div><div class="line">eg = bitr(x, fromType=<span class="string">"SYMBOL"</span>, toType=<span class="string">"ENTREZID"</span>, OrgDb=<span class="string">"org.Hs.eg.db"</span>)</div><div class="line">head(eg)</div></pre></td></tr></table></figure>
<p>转换结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">&gt; head(eg)</div><div class="line">  SYMBOL ENTREZID</div><div class="line"><span class="number">1</span>   GPX3     <span class="number">2878</span></div><div class="line"><span class="number">2</span>   GLRX     <span class="number">2745</span></div><div class="line"><span class="number">3</span>    LBP     <span class="number">3929</span></div><div class="line"><span class="number">4</span>  CRYAB     <span class="number">1410</span></div><div class="line"><span class="number">5</span>  DEFB1     <span class="number">1672</span></div><div class="line"><span class="number">6</span>  HCLS1     <span class="number">3059</span></div></pre></td></tr></table></figure>
<p><code>bitr</code>可以转换的基因ID有很多种，可以使用<code>keytypes</code>来查看，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">&gt; <span class="keyword">library</span>(org.Hs.eg.db)</div><div class="line">&gt; keytypes(org.Hs.eg.db)</div><div class="line"> [<span class="number">1</span>] <span class="string">"ACCNUM"</span>       <span class="string">"ALIAS"</span>        <span class="string">"ENSEMBL"</span>      <span class="string">"ENSEMBLPROT"</span>  <span class="string">"ENSEMBLTRANS"</span></div><div class="line"> [<span class="number">6</span>] <span class="string">"ENTREZID"</span>     <span class="string">"ENZYME"</span>       <span class="string">"EVIDENCE"</span>     <span class="string">"EVIDENCEALL"</span>  <span class="string">"GENENAME"</span>    </div><div class="line">[<span class="number">11</span>] <span class="string">"GO"</span>           <span class="string">"GOALL"</span>        <span class="string">"IPI"</span>          <span class="string">"MAP"</span>          <span class="string">"OMIM"</span>        </div><div class="line">[<span class="number">16</span>] <span class="string">"ONTOLOGY"</span>     <span class="string">"ONTOLOGYALL"</span>  <span class="string">"PATH"</span>         <span class="string">"PFAM"</span>         <span class="string">"PMID"</span>        </div><div class="line">[<span class="number">21</span>] <span class="string">"PROSITE"</span>      <span class="string">"REFSEQ"</span>       <span class="string">"SYMBOL"</span>       <span class="string">"UCSCKG"</span>       <span class="string">"UNIGENE"</span>     </div><div class="line">[<span class="number">26</span>] <span class="string">"UNIPROT"</span></div></pre></td></tr></table></figure>
<p>再举个例子，现在我们将<code>SYMBOL</code>转换为<code>UNIPROT</code>与<code>ENSEMBL</code>的基因名，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">ids &lt;- bitr(x, fromType=<span class="string">"SYMBOL"</span>, toType=c(<span class="string">"UNIPROT"</span>, <span class="string">"ENSEMBL"</span>), OrgDb=<span class="string">"org.Hs.eg.db"</span>)</div><div class="line">head(ids)</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">&gt; head(ids)</div><div class="line">  SYMBOL    UNIPROT         ENSEMBL</div><div class="line"><span class="number">1</span>   GPX3     P22352 ENSG00000211445</div><div class="line"><span class="number">2</span>   GLRX A0A024RAM2 ENSG00000173221</div><div class="line"><span class="number">3</span>   GLRX     P35754 ENSG00000173221</div><div class="line"><span class="number">4</span>    LBP     P18428 ENSG00000129988</div><div class="line"><span class="number">5</span>    LBP     Q8TCF0 ENSG00000129988</div><div class="line"><span class="number">6</span>  CRYAB     P02511 ENSG00000109846</div></pre></td></tr></table></figure>
<p>使用clusterProfiler这个包进行GO分析时，通常并不需要转换ID，所有的ID类型都可以由<code>OrgDb</code>文件提供，并且通过<code>keyType</code>参数在<code>groupGO</code>，<code>enrichGO</code>和<code>gseGO</code>中进行指定。</p>
<h4 id="第二步原始数据">第二步：原始数据</h4>
<p><code>groupGO</code>，<code>enrichGO</code>和<code>gseGO</code>这三个函数都支持拥有<code>OrgDb</code>对象的物种进行GO分析。Bioconductor提供了有20个物种的<code>OrgDb</code>文件。如果用户自身有GO注释数据（数据框形式，第1列是基因ID，第2列是GO ID），此时就可以使用<code>enricher()</code>和<code>gseGO()</code>函数进行表达分析（over-representation）和GSEA分析（gene set enrichment analysis）。</p>
<p>如果基因是被直接注释的，那么这些基因也可以被祖GO节点（ancestor GO nodes）注释（间接注释）。如果用户只使用直接注释，那么这些基因可以使用<code>buildGOmap</code>函数来推测出来基因的间接注释，生成了一个数据框格式的文件，用于<code>enricher()</code>和<code>gesGO</code>分析。</p>
<p>clusterProfiler包中的<code>groupGO</code>包用于基因的分类，此时举个例子，我们使用<code>DOSE</code>这个包里的<code>geneList</code>数据集。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">data(geneList, package=<span class="string">"DOSE"</span>)</div><div class="line">gene &lt;- names(geneList)[abs(geneList) &gt; <span class="number">2</span>]</div><div class="line">gene.df &lt;- bitr(gene, fromType = <span class="string">"ENTREZID"</span>,</div><div class="line">                toType = c(<span class="string">"ENSEMBL"</span>, <span class="string">"SYMBOL"</span>),</div><div class="line">                OrgDb = org.Hs.eg.db)</div><div class="line">head(gene.df)</div></pre></td></tr></table></figure>
<p>这里使用到了DOSE这包，这个包的全称是Disease Ontology Semantic and Enrichment analysis，具体的内容不用管，这里我们只使用它里面的一些基因名称，把基因的名称赋给<code>gene</code>这个变量，此时<code>gene</code>这个变量里面是EntrezID，然后使用<code>bitr</code>把Entrezid转换为ENSEMBL和SYMBOL，结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">&gt; head(gene.df)</div><div class="line">  ENTREZID         ENSEMBL SYMBOL</div><div class="line"><span class="number">1</span>     <span class="number">4312</span> ENSG00000196611   MMP1</div><div class="line"><span class="number">2</span>     <span class="number">8318</span> ENSG00000093009  CDC45</div><div class="line"><span class="number">3</span>    <span class="number">10874</span> ENSG00000109255    NMU</div><div class="line"><span class="number">4</span>    <span class="number">55143</span> ENSG00000134690  CDCA8</div><div class="line"><span class="number">5</span>    <span class="number">55388</span> ENSG00000065328  MCM10</div><div class="line"><span class="number">6</span>      <span class="number">991</span> ENSG00000117399  CDC20</div></pre></td></tr></table></figure>
<h4 id="第三步go分析函数">第三步：GO分析函数</h4>
<p>在clusterProfiler包中有两个做GO分析的函数，一个是groupGO，一个是enrichGO，groupGO它能够指定具体要分析的GO terms的层级，而enrichGO则就是普通的GO分析，分析到哪一层就是哪一层，通常情况下，使用<code>enrichGO</code>就行。</p>
<h5 id="groupgo">groupGO</h5>
<p>这个函数的功能是：</p>
<p>现在使用<code>groupGO</code>函数，对<code>gene</code>这里面的基因进行功能分析，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># Step4. GO analysis</span></div><div class="line"><span class="comment"># groupGO</span></div><div class="line">ggo &lt;- groupGO(gene     = gene.df$ENTREZID,</div><div class="line">               OrgDb    = org.Hs.eg.db,</div><div class="line">               ont      = <span class="string">"CC"</span>,</div><div class="line">               level    = <span class="number">3</span>,</div><div class="line">               readable = <span class="literal">TRUE</span>)</div><div class="line">write.csv(ggo,<span class="string">"D:\\ggo.csv"</span>)</div></pre></td></tr></table></figure>
<p>现在解释一下上述代码，其中gene是一个向量，它含有要分析的基因ID，OrgDb是数据库，ont的参数为<code>CC</code>，<code>BP</code>和<code>MF</code>。level用于指定分析的GO水平，readable：逻辑值，如果为TRUE，则geneID会比对到gene symbol上，现在查看一下使用<code>groupGO</code>分析的结果，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180725/bcCgelD75f.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h5 id="enrichgo">enrichGO</h5>
<p>功能：过表达（over-representation）分析：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">ego &lt;- enrichGO(gene          = gene,</div><div class="line">                universe      = names(geneList),</div><div class="line">                OrgDb         = org.Hs.eg.db,</div><div class="line">                ont           = <span class="string">"CC"</span>,</div><div class="line">                pAdjustMethod = <span class="string">"BH"</span>,</div><div class="line">                pvalueCutoff  = <span class="number">0.01</span>,</div><div class="line">                qvalueCutoff  = <span class="number">0.05</span>,</div><div class="line">        readable      = <span class="literal">TRUE</span>)</div><div class="line">head(ego)</div></pre></td></tr></table></figure>
<p>分析结果如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180725/5EEal4bGij.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>由于<code>OrgDb</code>支持任何形式的gene ID，因此可以在GO分析中直接使用任何gene ID，用户只需要指定<code>keyType</code>标明输入的数据即可，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">ego2 &lt;- enrichGO(gene =gene.df$ENSEMBL,</div><div class="line">                 OrgDb         = org.Hs.eg.db,</div><div class="line">                 keytype       = <span class="string">"ENSEMBL"</span>,</div><div class="line">                 ont           = <span class="string">"CC"</span>,</div><div class="line">                 pAdjustMethod = <span class="string">"BH"</span>,</div><div class="line">                 pvalueCutoff  = <span class="number">0.01</span>,</div><div class="line">                 qvalueCutoff  = <span class="number">0.05</span>)</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180725/ae514mcL52.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>现在解释一下这个结果，</p>
<ol style="list-style-type: decimal">
<li>GO ID: Gene Ontology数据库中唯一的标号信息；</li>
<li>Description ：Gene Ontology功能的描述信息；</li>
<li>GeneRatio：差异基因中与该Term相关的基因数与整个差异基因总数的比值；</li>
<li>BgRation：所有（ bg）基因中与该Term相关的基因数与所有（ bg）基因的比值；</li>
<li>pvalue: 富集分析统计学显著水平，一般情况下， P-value &lt; 0.05 该功能为富集项；</li>
<li>p.adjust 矫正后的P-Value；</li>
<li>qvalue：对p值进行统计学检验的q值；</li>
<li>Count：差异基因中与该Term相关的基因数</li>
</ol>
<h4 id="第四步绘制go图">第四步：绘制GO图</h4>
<h5 id="go条形图">GO条形图</h5>
<p>接下来是GO的层次聚类图，一般是二级GO条目条形图，也就是把得到的GO注释结果再归于二级分类中，绘制出二级GO条目图，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">barplot(ego_cc, showCategory=<span class="number">20</span>,title=<span class="string">"EnrichmentGO CC"</span>)</div></pre></td></tr></table></figure>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180725/H03B9H5H95.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>这里只是绘制了CC这一类的条形图，BP，MF的条形图可以都可以根据这个来绘制，看一下网上其他人绘制的二级图，如下所示：<img src="http://ortxpw68f.bkt.clouddn.com/professional/180720/3b6gFee6ll.png?imageslim" alt="mark"></p>
<p>这张图就是GO分析的二级分类图，它显示了差异基因在各个GO term的数目和富集情况。横坐标代表GO三个 ontology的更细一级分类，即二级分类；纵坐标代表每个分类条目所包含的基因数目。由于一个基因常常对应多个GO term，因此同一个基因会在不同分类条目下出现，即被多次统计，因此如果你把这里所有柱子的基因数目加起来，肯定是多于差异基因的总数目。</p>
<h5 id="go点状图">GO点状图</h5>
<p>如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">dotplot(ego_cc,title=<span class="string">"Enrichment GO CCdot"</span>)</div></pre></td></tr></table></figure>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180725/BbfaajFHke.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h5 id="go的有向无环图">GO的有向无环图</h5>
<p>如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">plotGOgraph(ego_cc)</div></pre></td></tr></table></figure>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180725/ALkHFkgmA2.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>进行局部放大，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180725/CALiilKbI1.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>解释一下这个图形：从整体上来看，GO的注释系统是一个有向无环图（DAG，Directed Acyclic Graphs ），GO term之间的联系是单向，前面提到，GO term之间的关系主要有3种，分别为<code>is_a</code>，<code>part_of</code>和<code>regulates</code>，富集分析的结果会分别给出GO三个本体（CC，BP，MF）的有向无环图，这里我们只绘制了CC本体，在这张图中，超接近根结点的GO term的概括性越强，越往下，分支的GO term表示的结果更细，现在查看一个GO term里面的含义，如下所示，其中就是我们前面GO分析表格中的这一条，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180725/Gb2Dhb29Kg.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>现在我们在GO分析的有向无环图中把这个结果放大，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180725/g9e1Dl7Hhl.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>其中第一行是GO术语的编号，第二行是对GO term的描述，第三行是P值，如果大于0.05，就会显示NA，显白色，上图中的P值小于0.05，因此显黄色。每个节点都有一定的形状，系统默认会把显著性最高的前10个GO term设置为方形，其余的GO term为圆形，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180725/kEE2GfEFhJ.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>颜色的含义：颜色越深，代表该GO term越显著。颜色由浅到深分别为：无色——浅黄——深黄——红色。 那么，从颜色上来看，在molecular function这个ontology上，最显著的GO term是GO:0005819。因此后续可以从这个GO term入手，这个GO term所在的分支上的其他GO term也值得研究。，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180725/E11klgaD3L.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>GO的有向无环图展示了GO term之间的分类关系。</p>
<h2 id="clusterprofiler包的go-basic.ogo文件">ClusterProfiler包的go-basic.ogo文件</h2>
<p>前面说过，在进行GO分析时，需要使用到这几个文件，分别如下所示：</p>
<ol style="list-style-type: decimal">
<li>前景基因与背景基因文件，前景基因是你要研究的目的基因，背景基因其实就是你要研究的某个物种的全部基因文件；</li>
<li>GO注释文件，GO注释文件的作用在于，将GO terms与你的前景基因与背景基因的Gene ID对应起来；</li>
<li>go-basic.ogo文件，这个文件记录的主要是不同GO terms之间的联系，用于绘制DAG图，不过在使用clusterProfiler中，并没有发现这个文件，后来在群里问了一下其他同学，有人说，这个包里面含有GO.db包，这个包里面含的内容就是GO terms的层级信息，如下所示：</li>
</ol>
<p>现在看一下某个GO terms在<code>go-basic.ogo</code>中的信息，如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">[Term]</div><div class="line">id: GO:0000015</div><div class="line">name: phosphopyruvate hydratase complex</div><div class="line">namespace: cellular_component</div><div class="line">def: &quot;A multimeric enzyme complex, usually a dimer or an octamer, that catalyzes the conversion of 2-phospho-D-glycerate to phosphoenolpyruvate and water.&quot; [GOC:jl, ISBN:0198506732]</div><div class="line">subset: goslim_metagenomics</div><div class="line">subset: gosubset_prok</div><div class="line">synonym: &quot;enolase complex&quot; EXACT []</div><div class="line">is_a: GO:0044445 ! cytosolic part</div><div class="line">is_a: GO:1902494 ! catalytic complex</div></pre></td></tr></table></figure>
<p>可以发现，<code>GO:0000015</code>与其他GO terms的关系有2个，分别为<code>GO:0044445</code>和<code>GO:1902494</code>。</p>
<p>现在看一下<code>GO.db</code>文件，如下所示：s</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&gt; xx &lt;- GOCCPARENTS</div><div class="line">&gt; xx$`GO:0000015`</div><div class="line">        is_a         is_a </div><div class="line"><span class="string">"GO:0044445"</span> <span class="string">"GO:1902494"</span></div></pre></td></tr></table></figure>
<p>可以发现，GOCCPARENTS（这个是GO.db包中的某个数据集）中含有<code>GO:0000015</code>与其他GO terms的关系。</p>
<h2 id="参考资料">参考资料</h2>
<ol style="list-style-type: decimal">
<li><a href="https://mp.weixin.qq.com/s/FKlF3zkwnkOrXHvVzKYukw" target="_blank" rel="external">一文掌握GO和pathway分析（公众号：GCBI知识库）</a></li>
<li><a href="https://mp.weixin.qq.com/s/s2_yv7U65FlxE1nLqhxcDw" target="_blank" rel="external">GO、KEGG功能注释是一个相亲的过程（公众号：小张聊科研）</a></li>
<li><a href="https://mp.weixin.qq.com/s/d1KCETQZ88yaOLGwAtpWYg" target="_blank" rel="external">GO、GSEA富集分析一网打进（公众号：生信宝典）</a></li>
<li><a href="https://mp.weixin.qq.com/s/i7GOr5UMRp6OYTO40lgR8g" target="_blank" rel="external">R语言学习 - 富集分析泡泡图 （文末有彩蛋）</a></li>
<li><a href="https://mp.weixin.qq.com/s/AWWLIhxZrHnZkhYtoYx7gA" target="_blank" rel="external">手把手教你看富集分析结果之GO富集</a></li>
<li><a href="http://blog.sina.com.cn/s/blog_670445240101m4z3.html" target="_blank" rel="external">每日一生信–富集分析（超几何分布）（Fisher’s Exact Test）</a></li>
<li><a href="http://blog.sina.com.cn/s/blog_5d1edf6a0100ujcv.html" target="_blank" rel="external">R 超几何分布</a></li>
<li><a href="https://en.wikipedia.org/wiki/Hypergeometric_distribution" target="_blank" rel="external">Wikipedia:Hypergeometric distribution</a></li>
<li><a href="https://mp.weixin.qq.com/s/TiX41zf4Vc5xizTYGj5HnQ" target="_blank" rel="external">基于R语言理解随机变量分布——离散型随机变量</a></li>
<li><a href="https://www.jianshu.com/p/5d4dd7a75362" target="_blank" rel="external">理解差异表达与GO分析</a></li>
<li><a href="http://www.biotrainee.com/thread-242-1-1.html" target="_blank" rel="external">GO层次聚类图-二级GO条目条形图</a></li>
<li><a href="https://www.jianshu.com/p/5a4bda169247" target="_blank" rel="external">功能富集分析概述</a></li>
<li><a href="https://www.jianshu.com/p/3765b1ac02b5" target="_blank" rel="external">基因表达分析</a></li>
<li><a href="http://www.bio-info-trainee.com/370.html" target="_blank" rel="external">转录组-GO和KEGG富集的R包clusterProfiler</a></li>
<li><a href="http://www.omicshare.com/forum/thread-826-1-1.html" target="_blank" rel="external">OS Tools-GO富集分析工具的使用与解读详细教程</a></li>
<li><a href="http://blog.sina.com.cn/s/blog_6a6c136d0100waak.html" target="_blank" rel="external">《生物信息与功能基因组学》</a></li>
<li><a href="http://geneontology.org/page/ontology-documentation" target="_blank" rel="external">Ontology Documentation</a></li>
<li><a href="http://geneontology.org/page/ontology-structure" target="_blank" rel="external">Ontology Structure</a></li>
<li><a href="http://www.bio-info-trainee.com/710.html" target="_blank" rel="external">Bioconductor的数据包library(org.Hs.eg.db)简介</a></li>
<li><a href="https://www.jianshu.com/p/4910d7cec5c8?utm_campaign=maleskine&amp;utm_content=note&amp;utm_medium=seo_notes&amp;utm_source=recommendation" target="_blank" rel="external">转录组入门（8）：差异基因结果注释</a></li>
<li><a href="https://www.bioconductor.org/packages/devel/bioc/vignettes/clusterProfiler/inst/doc/clusterProfiler.html#kegg-analysis" target="_blank" rel="external">Statistical analysis and visualization of functional profiles for genes and gene clusters</a></li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2018/04/01/Python/Python学习笔记（1）-基础语法/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/04/01/Python/Python学习笔记（1）-基础语法/" itemprop="url">Python学习笔记（1）——基础语法笔记</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-04-01T12:00:00+08:00">
                2018-04-01
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Python/" itemprop="url" rel="index">
                    <span itemprop="name">Python</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  1,454
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  7
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="python常用ide">Python常用IDE</h2>
<p>原始的Python自带的解释器是<code>IDLE</code>，常用的PythonIDE有Anaconda带的<code>Jupyter Notebook</code>，使用这种IDE的时候，安装后只需要在<code>cmd</code>中输入<code>jupyter notebook</code>即可。还有一种比较常用的Python IDE是Pycharm。</p>
<h2 id="python基础语法">Python基础语法</h2>
<h3 id="注释扩展名.py">(1)注释<code>#</code>，扩展名<code>.py</code></h3>
<p>先看一段代码，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">biotest@biotest-VirtualBox:~/python3/<span class="number">01</span>basic$ cat hello.py</div><div class="line"><span class="comment">#!/usr/bin/python3</span></div><div class="line"></div><div class="line"><span class="comment"># This is a comment</span></div><div class="line">print(<span class="string">"Hello, python3!"</span>)</div><div class="line"></div><div class="line"><span class="comment"># This is another comment</span></div><div class="line">biotest@biotest-VirtualBox:~/python3/<span class="number">01</span>basic$ python3 hello.py </div><div class="line">Hello, python3!</div></pre></td></tr></table></figure>
<p>从上面的这段代码可以知道这些信息：</p>
<ol style="list-style-type: decimal">
<li>在Python中，注释是以<code>#</code>进行标识的；</li>
<li>Python程序文件以<code>.py</code>为后缀。</li>
<li>开头的代码指明了Python3解释的位置，即<code>#!/usr/bin/pyhton3</code>（其实我发现，不加这一行也能运行）。</li>
</ol>
<p>除了<code>#</code>可以作为注释外，还可以使用多个<code>#</code>和<code>'''</code>和<code>&quot;&quot;&quot;</code>作为注释，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/python3</span></div><div class="line"> </div><div class="line"><span class="comment"># 第一个注释</span></div><div class="line"><span class="comment"># 第二个注释</span></div><div class="line"> </div><div class="line"><span class="string">'''</span></div><div class="line"><span class="string">第三注释</span></div><div class="line"><span class="string">第四注释</span></div><div class="line"><span class="string">'''</span></div><div class="line"> </div><div class="line"><span class="string">"""</span></div><div class="line"><span class="string">第五注释</span></div><div class="line"><span class="string">第六注释</span></div><div class="line"><span class="string">"""</span></div><div class="line"><span class="keyword">print</span> (<span class="string">"Hello, Python!"</span>)</div></pre></td></tr></table></figure>
<h3 id="行与缩进">(2)行与缩进</h3>
<p>Python语法的一大特点应时使用缩进来表示代码块，不需要使用大括号，在下面的例子中，第二行与第四行，必须要缩进4个字符，才能正常运行，否则就会出错，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> <span class="keyword">True</span>:</div><div class="line">    <span class="keyword">print</span> (<span class="string">"True"</span>)</div><div class="line"><span class="keyword">else</span>:</div><div class="line">    <span class="keyword">print</span> (<span class="string">"False"</span>)</div></pre></td></tr></table></figure>
<h3 id="多行语句与引号">(3)多行语句与引号</h3>
<p>如果语句比较长，可以使用反斜杠（<code>\</code>）来实现多行语句，格式如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">total = item_one + \</div><div class="line">        item_two + \</div><div class="line">        item_three</div></pre></td></tr></table></figure>
<p>但是在<code>[]</code>，<code>{}</code>或<code>()</code>中，不需要使用反斜杠，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">total = [<span class="string">'item_one'</span>, <span class="string">'item_two'</span>,<span class="string">'item_three'</span>,</div><div class="line">        <span class="string">'item_four'</span>,<span class="string">'item_five'</span>]</div></pre></td></tr></table></figure>
<p>使用3个双引号，可以直接换行，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>s3 = <span class="string">"""hello,</span></div><div class="line"><span class="string"><span class="meta">... </span>world,</span></div><div class="line"><span class="string"><span class="meta">... </span>this is a multiline statements"""</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(s3)</div><div class="line">hello,</div><div class="line">world,</div><div class="line">this <span class="keyword">is</span> a multiline statements</div></pre></td></tr></table></figure>
<p>其实这段代码就相当下面的代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>s3 = <span class="string">"hello,\nworld,\nthis is a multiline statements."</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(s3)</div><div class="line">hello,</div><div class="line">world,</div><div class="line">this <span class="keyword">is</span> a multiline statements</div></pre></td></tr></table></figure>
<p>三引号，双引号和单引号的区别</p>
<p>看下面的案例就明白了：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>s4 = <span class="string">'Let\'s go'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(s4)</div><div class="line">Let<span class="string">'s go</span></div><div class="line"><span class="string">&gt;&gt;&gt; s5 = "Let'</span>s go<span class="string">"</span></div><div class="line"><span class="string">&gt;&gt;&gt; print(s5)</span></div><div class="line"><span class="string">Let's go</span></div></pre></td></tr></table></figure>
<p>只使用单引号的话，如果字符串里还有单引号，那么需要进行转义，或者说是如果双引号里面还有双引号，也需要转义。</p>
<h3 id="转义字符">(4)转义字符</h3>
<p>先看一个案例，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(str1)</div><div class="line">C:</div><div class="line">ow</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>str2 = <span class="string">'c:\\now'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(str2)</div><div class="line">c:\now</div></pre></td></tr></table></figure>
<p>从这个案例中可以知道，在用Python处理目录时，需要对斜杠进行转义，如果目录的字符串比较长，例如<code>C:\Program Files\Intel\WiFi\Help</code>，那就可以在这个字符串前面加上一个<code>r</code>，如果最后要以斜杠结尾，那么只需要在最后使用转义符号即可，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>str3 =<span class="string">r'C:\Program Files\Intel\WiFi\Help'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(str3)</div><div class="line">C:\Program Files\Intel\WiFi\Help</div><div class="line">    &gt;&gt;&gt; str4 =<span class="string">r'C:\Program Files\Intel\WiFi\Help'</span><span class="string">'\\'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(str4)</div><div class="line">C:\Program Files\Intel\WiFi\Help\</div></pre></td></tr></table></figure>
<h2 id="关键字keyword">关键字<code>keyword</code></h2>
<p>Python的关键字指的Python编译器自己使用的，用户不可以使用，也就是说用户在定义函数，变量的时候不能使用Python自己的关键字，Python的关键字可以通过导入<code>keyword</code>包来查看，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> keyword</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>keyword.kwlist</div><div class="line">[<span class="string">'False'</span>, <span class="string">'None'</span>, <span class="string">'True'</span>, <span class="string">'and'</span>, <span class="string">'as'</span>, <span class="string">'assert'</span>, <span class="string">'break'</span>, <span class="string">'class'</span>, <span class="string">'continue'</span>, <span class="string">'def'</span>, <span class="string">'del'</span>, <span class="string">'elif'</span>, <span class="string">'else'</span>, <span class="string">'except'</span>, <span class="string">'finally'</span>, <span class="string">'for'</span>, <span class="string">'from'</span>, <span class="string">'global'</span>, <span class="string">'if'</span>, <span class="string">'import'</span>, <span class="string">'in'</span>, <span class="string">'is'</span>, <span class="string">'lambda'</span>, <span class="string">'nonlocal'</span>, <span class="string">'not'</span>, <span class="string">'or'</span>, <span class="string">'pass'</span>, <span class="string">'raise'</span>, <span class="string">'return'</span>, <span class="string">'try'</span>, <span class="string">'while'</span>, <span class="string">'with'</span>, <span class="string">'yield'</span>]</div><div class="line">&gt;&gt;&gt;</div></pre></td></tr></table></figure>
<h2 id="python帮助文档查阅">Python帮助文档查阅</h2>
<h3 id="help函数">(1)help函数</h3>
<p>使用help函数可以查看某个函数的帮助，也可以查看所用模块的名称，如下所示：</p>
<p>查看<code>print</code>这个函数的帮助：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>help(<span class="keyword">print</span>)</div><div class="line">Help on built-<span class="keyword">in</span> function <span class="keyword">print</span> <span class="keyword">in</span> module builtins:</div><div class="line"></div><div class="line">print(...)</div><div class="line">    print(value, ..., sep=<span class="string">' '</span>, end=<span class="string">'\n'</span>, file=sys.stdout, flush=<span class="keyword">False</span>)</div><div class="line"></div><div class="line">    Prints the values to a stream, <span class="keyword">or</span> to sys.stdout by default.</div><div class="line">    Optional keyword arguments:</div><div class="line">    file:  a file-like object (stream); defaults to the current sys.stdout.</div><div class="line">    sep:   string inserted between values, default a space.</div><div class="line">    end:   string appended after the last value, default a newline.</div><div class="line">    flush: whether to forcibly flush the stream.</div></pre></td></tr></table></figure>
<p>查看<code>math</code>这个包以及这个包中<code>ssqrt</code>这个函数的帮助，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> math</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>help(math)</div><div class="line">Help on built-<span class="keyword">in</span> module math:</div><div class="line"></div><div class="line">NAME</div><div class="line">    math</div><div class="line"></div><div class="line">DESCRIPTION</div><div class="line">    This module <span class="keyword">is</span> always available.  It provides access to the</div><div class="line">    mathematical functions defined by the C standard.</div><div class="line"></div><div class="line">FUNCTIONS</div><div class="line">    acos(...)</div><div class="line">        acos(x)</div><div class="line"></div><div class="line">        Return the arc cosine (measured <span class="keyword">in</span> radians) of x.</div><div class="line"></div><div class="line">-- More  --</div><div class="line"></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>help(math.sqrt)</div><div class="line">Help on built-<span class="keyword">in</span> function sqrt <span class="keyword">in</span> module math:</div><div class="line"></div><div class="line">sqrt(...)</div><div class="line">    sqrt(x)</div><div class="line"></div><div class="line">    Return the square root of x.</div></pre></td></tr></table></figure>
<h2 id="模块导入">模块导入</h2>
<p>使用<code>import</code>可以加载某个模块，例如<code>import math</code>就加载了<code>math</code>这个模块，使用<code>dir()</code>这个函数可以查看这个模块的成员，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> math</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>dir(math)</div><div class="line">[<span class="string">'__doc__'</span>, <span class="string">'__loader__'</span>, <span class="string">'__name__'</span>, <span class="string">'__package__'</span>, <span class="string">'__spec__'</span>, <span class="string">'acos'</span>, <span class="string">'acosh'</span>, <span class="string">'asin'</span>, <span class="string">'asinh'</span>, <span class="string">'atan'</span>, <span class="string">'atan2'</span>, <span class="string">'atanh'</span>, <span class="string">'ceil'</span>, <span class="string">'copysign'</span>, <span class="string">'cos'</span>, <span class="string">'cosh'</span>, <span class="string">'degrees'</span>, <span class="string">'e'</span>, <span class="string">'erf'</span>, <span class="string">'erfc'</span>, <span class="string">'exp'</span>, <span class="string">'expm1'</span>, <span class="string">'fabs'</span>, <span class="string">'factorial'</span>, <span class="string">'floor'</span>, <span class="string">'fmod'</span>, <span class="string">'frexp'</span>, <span class="string">'fsum'</span>, <span class="string">'gamma'</span>, <span class="string">'gcd'</span>, <span class="string">'hypot'</span>, <span class="string">'inf'</span>, <span class="string">'isclose'</span>, <span class="string">'isfinite'</span>, <span class="string">'isinf'</span>, <span class="string">'isnan'</span>, <span class="string">'ldexp'</span>, <span class="string">'lgamma'</span>, <span class="string">'log'</span>, <span class="string">'log10'</span>, <span class="string">'log1p'</span>, <span class="string">'log2'</span>, <span class="string">'modf'</span>, <span class="string">'nan'</span>, <span class="string">'pi'</span>, <span class="string">'pow'</span>, <span class="string">'radians'</span>, <span class="string">'sin'</span>, <span class="string">'sinh'</span>, <span class="string">'sqrt'</span>, <span class="string">'tan'</span>, <span class="string">'tanh'</span>, <span class="string">'tau'</span>, <span class="string">'trunc'</span>]</div></pre></td></tr></table></figure>
<p>在Python中，模块的导入有两种形式，如下所示：</p>
<p>形式1：import module-name，import后面跟空格，然后是模块名称，例如<code>import os</code></p>
<p>形式2：from module1 import module11，其中module1是一个大模块，里面还有子模块（通常是某个函数）modeule11，我们只想用module11，就可以这么写。</p>
<h3 id="内置函数与模块">(1)内置函数与模块</h3>
<h4 id="内置函数">内置函数</h4>
<p>内置函数不需要导入任何模块即可直接使用，执行下面的命令可以列出所有内置函数和内置对象，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>dir(__builtins__)</div><div class="line">[<span class="string">'ArithmeticError'</span>, <span class="string">'AssertionError'</span>, <span class="string">'AttributeError'</span>, <span class="string">'BaseException'</span>, <span class="string">'BlockingIOError'</span>, <span class="string">'BrokenPipeError'</span>, <span class="string">'BufferError'</span>, <span class="string">'BytesWarning'</span>, <span class="string">'ChildProcessError'</span>, <span class="string">'ConnectionAbortedError'</span>, <span class="string">'ConnectionError'</span>, <span class="string">'ConnectionRefusedError'</span>, <span class="string">'ConnectionResetError'</span>, <span class="string">'DeprecationWarning'</span>, <span class="string">'EOFError'</span>, <span class="string">'Ellipsis'</span>, <span class="string">'EnvironmentError'</span>, <span class="string">'Exception'</span>, <span class="string">'False'</span>, <span class="string">'FileExistsError'</span>, <span class="string">'FileNotFoundError'</span>, <span class="string">'FloatingPointError'</span>,</div><div class="line"> ... ...</div></pre></td></tr></table></figure>
<h4 id="内置模块">内置模块</h4>
<p>内置模块的查看方法如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> sys</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(sys.builtin_module_names)</div><div class="line">(<span class="string">'_ast'</span>, <span class="string">'_bisect'</span>, <span class="string">'_blake2'</span>, <span class="string">'_codecs'</span>, <span class="string">'_codecs_cn'</span>, <span class="string">'_codecs_hk'</span>, <span class="string">'_codecs_iso2022'</span>, <span class="string">'_codecs_jp'</span>, <span class="string">'_codecs_kr'</span>, <span class="string">'_codecs_tw'</span>, <span class="string">'_collections'</span>, <span class="string">'_csv'</span>, <span class="string">'_datetime'</span>, <span class="string">'_findvs'</span>, <span class="string">'_functools'</span>, <span class="string">'_heapq'</span>, <span class="string">'_imp'</span>, <span class="string">'_io'</span>, <span class="string">'_json'</span>, <span class="string">'_locale'</span>, <span class="string">'_lsprof'</span>, <span class="string">'_md5'</span>, <span class="string">'_multibytecodec'</span>, <span class="string">'_opcode'</span>, <span class="string">'_operator'</span>, <span class="string">'_pickle'</span>, <span class="string">'_random'</span>, <span class="string">'_sha1'</span>, <span class="string">'_sha256'</span>, <span class="string">'_sha3'</span>, <span class="string">'_sha512'</span>, <span class="string">'_signal'</span>, <span class="string">'_sre'</span>, <span class="string">'_stat'</span>, <span class="string">'_string'</span>, <span class="string">'_struct'</span>, <span class="string">'_symtable'</span>, <span class="string">'_thread'</span>, <span class="string">'_tracemalloc'</span>, <span class="string">'_warnings'</span>, <span class="string">'_weakref'</span>, <span class="string">'_winapi'</span>, <span class="string">'array'</span>, <span class="string">'atexit'</span>, <span class="string">'audioop'</span>, <span class="string">'binascii'</span>, <span class="string">'builtins'</span>, <span class="string">'cmath'</span>, <span class="string">'errno'</span>, <span class="string">'faulthandler'</span>, <span class="string">'gc'</span>, <span class="string">'itertools'</span>, <span class="string">'marshal'</span>, <span class="string">'math'</span>, <span class="string">'mmap'</span>, <span class="string">'msvcrt'</span>, <span class="string">'nt'</span>, <span class="string">'parser'</span>, <span class="string">'sys'</span>, <span class="string">'time'</span>, <span class="string">'winreg'</span>, <span class="string">'xxsubtype'</span>, <span class="string">'zipimport'</span>, <span class="string">'zlib'</span>)</div><div class="line">&gt;&gt;&gt;</div></pre></td></tr></table></figure>
<h2 id="对象">对象</h2>
<p>在python中，一切都是对象，每个对象在内存都中有自己的一个地址，这就是它的身份，可以通过<code>id()</code>函数来查看它们，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>id(<span class="number">1</span>)</div><div class="line"><span class="number">10943008</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>id(print())</div><div class="line"></div><div class="line"><span class="number">10353568</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>id(<span class="string">"c"</span>)</div><div class="line"><span class="number">139838545314064</span></div></pre></td></tr></table></figure>
<h2 id="参考资料">参考资料</h2>
<p><a href="http://www.runoob.com/python3/python3-basic-syntax.html" target="_blank" rel="external">1. Python3教程|菜鸟教程</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2018/03/31/Tools/Jupyter nook主题设置/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/03/31/Tools/Jupyter nook主题设置/" itemprop="url">Jupyter notebook主题的设置</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-03-31T12:00:00+08:00">
                2018-03-31
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/生信工具/" itemprop="url" rel="index">
                    <span itemprop="name">生信工具</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  422
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  2
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>最近学了一点Python，而Jupyter notebook是一个交互式笔记本，很多Python的命令可以在其中运行，但jupyter的默认主题与字体不好看，网上搜索了一下，发现可以对其进行更改，GitHub上有相应的教程（https://github.com/dunovank/jupyter-themes），现在把怎么修改Jupyter notebook的主题与字体简单地介绍一下。</p>
<h2 id="第一步安装主题">第一步：安装主题</h2>
<p>切换到python的安装目录，即<code>C:\Anaconda3\Scripts</code>下，用pip安装，如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"># install jupyterthemes</div><div class="line">pip install jupyterthemes</div><div class="line"></div><div class="line"># upgrade to latest version</div><div class="line">pip install --upgrade jupyterthemes</div></pre></td></tr></table></figure>
<h2 id="第二步调整juypter-notebook的参数">第二步：调整juypter notebook的参数</h2>
<p><strong>1. 查看主题</strong></p>
<p>直接在cmd命令行下输入<code>jt -l</code>来相看主题，有这些主题： &gt;chesterish grade3 gruvboxd gruvboxl monokai oceans16 onedork solarizedd solarizedl</p>
<p><strong>2. 选择主题</strong></p>
<p>输入<code>jt -t chesterish</code>选择主题，这里我们选择一个chesterish，新建一个文件，输入<code>print (&quot;hello, python!&quot;)</code>，如下所示： <img src="http://ortxpw68f.bkt.clouddn.com/professional/180331/9bDE5f470A.png?imageslim" alt="mark">如果不满意这个主题，想要恢复默认设置，输入<code>jt -r</code>即可。</p>
<p><strong>3. 工具栏设置</strong> 输入<code>jt -t chesterish -T -N</code>可以打开工具窗与文件名称，如下所示： <img src="http://ortxpw68f.bkt.clouddn.com/professional/180331/7kfgkm89BF.png?imageslim" alt="mark"></p>
<p><strong>4. 字体设置</strong> 设置主题为Roboto Mono为12pt大小，在cmd下输入<code>jt -t chesterish -f roboto -fs 12</code>，再输入<code>jupyter notebook</code>，查看，如下所示：</p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/professional/180331/0D7eJlfaEm.png?imageslim" alt="mark"> 我觉得比原来默认的字体好看了。</p>
<p>后来都试了一遍，觉得主题，字体比较好，如下所示： jt -t chesterish -f roboto -fs 12 jupyter notebook</p>
<h2 id="注可用的字体与主题参数列表">注：可用的字体与主题参数列表</h2>
<table>
<thead>
<tr class="header">
<th>-f 参数</th>
<th>字体名称</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>anka</td>
<td>Anka/Coder</td>
</tr>
<tr class="even">
<td>anonymous</td>
<td>Anonymous Pro</td>
</tr>
<tr class="odd">
<td>aurulent</td>
<td>Aurulent Sans Mono</td>
</tr>
<tr class="even">
<td>bitstream</td>
<td>Bitstream Vera Sans Mono</td>
</tr>
<tr class="odd">
<td>bpmono</td>
<td>BPmono</td>
</tr>
<tr class="even">
<td>code</td>
<td>Code New Roman</td>
</tr>
<tr class="odd">
<td>consolamono</td>
<td>Consolamono</td>
</tr>
<tr class="even">
<td>cousine</td>
<td>Cousine</td>
</tr>
<tr class="odd">
<td>dejavu</td>
<td>DejaVu Sans Mono</td>
</tr>
<tr class="even">
<td>droidmono</td>
<td>Droid Sans Mono</td>
</tr>
<tr class="odd">
<td>fira</td>
<td>Fira Mono</td>
</tr>
<tr class="even">
<td>firacode</td>
<td>Fira Code</td>
</tr>
<tr class="odd">
<td>generic</td>
<td>Generic Mono</td>
</tr>
<tr class="even">
<td>hack</td>
<td>Hack</td>
</tr>
<tr class="odd">
<td>hasklig</td>
<td>Hasklig</td>
</tr>
<tr class="even">
<td>inconsolata</td>
<td>Inconsolata-g</td>
</tr>
<tr class="odd">
<td>inputmono</td>
<td>Input Mono</td>
</tr>
<tr class="even">
<td>iosevka</td>
<td>Iosevka</td>
</tr>
<tr class="odd">
<td>liberation</td>
<td>Liberation Mono</td>
</tr>
<tr class="even">
<td>meslo</td>
<td>Meslo</td>
</tr>
<tr class="odd">
<td>office</td>
<td>Office Code Pro</td>
</tr>
<tr class="even">
<td>oxygen</td>
<td>Oxygen Mono</td>
</tr>
<tr class="odd">
<td>roboto</td>
<td>Roboto Mono</td>
</tr>
<tr class="even">
<td>saxmono</td>
<td>saxMono</td>
</tr>
<tr class="odd">
<td>source</td>
<td>Source Code Pro</td>
</tr>
<tr class="even">
<td>sourcemed</td>
<td>Source Code Pro Medium</td>
</tr>
<tr class="odd">
<td>ptmono</td>
<td>PT Mono</td>
</tr>
<tr class="even">
<td>ubuntu</td>
<td>Ubuntu Mono</td>
</tr>
</tbody>
</table>
<p>主题</p>
<table>
<thead>
<tr class="header">
<th>主题名称</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>chesterish</td>
</tr>
<tr class="even">
<td>grade3</td>
</tr>
<tr class="odd">
<td>gruvboxd</td>
</tr>
<tr class="even">
<td>gruvboxl</td>
</tr>
<tr class="odd">
<td>monokai</td>
</tr>
<tr class="even">
<td>oceans16</td>
</tr>
<tr class="odd">
<td>onedork</td>
</tr>
<tr class="even">
<td>solarizedd</td>
</tr>
<tr class="odd">
<td>solarizedl</td>
</tr>
</tbody>
</table>
<h2 id="参考资料">参考资料</h2>
<p>https://github.com/dunovank/jupyter-themes</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2018/03/30/BIoTools/有关测序的数据储存问题/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/03/30/BIoTools/有关测序的数据储存问题/" itemprop="url">有关测序的数据储存问题</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-03-30T12:02:00+08:00">
                2018-03-30
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/生信工具/" itemprop="url" rel="index">
                    <span itemprop="name">生信工具</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  2,858
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  11
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="前言">前言</h2>
<p>现在的高通量测序仪产生的数据量很大，在看相关的文章的时候，经常弄不清楚测序的数据量与碱基之间的关系，有的表示为碱基数目，有的表示为计算机的储存单位，现在总结一下。</p>
<h2 id="计算机的储存单位">计算机的储存单位</h2>
<p>计算机最底层是用0和1来储存的，计算机中的数据就是0和1的集合，我们看下面的一个二进制文件。<img src="http://ortxpw68f.bkt.clouddn.com/professional/180425/hlhI4bLjfd.jpg?imageslim" alt="mark"></p>
<p>对于计算机数据来说，在它们的储存器中，最小的存储单元只能是2种状态，要么是0，要么是1，我们就把这个最基本的储存单元叫做bit，bit也就是计算机中储存数据最小的单位。但bit太小了，一个bit最多只能储存2个信号，即0或1。我们把8个bit称为1个字节（Byte），1个字节可以储存2的8次方，即256种信息，用于储存英文字母来说足够了，其实就是ASCII码的基础。由于汉字比较多，1个汉字通常占用2个字节，多数情况下，我们所说的基本储存单位，都是以字节（B，大写的B常指字节，小写的b指bit），为了方便描述储存空间，还有更大的储存单位，那就是1KB=1024B（1KB通常就叫1千字节），1MB=1024KB（MB通常叫兆字节，也就是100万），1GB=1024MB，1TB=1024GB，等等。</p>
<h2 id="文本文件与二进制文件的存储">文本文件与二进制文件的存储</h2>
<p>文本文件其实在本质也是二进制文件，计算机中储存的所有信息，最终都是转换为以0或1为基础的二进制储存方式。以碱基序列为例说明一下，先看一个文本文件，新建一个名叫<code>base.txt</code>的文本文件，输入ATGC这四个字母，保存，右键属性，可以发现这个文本文件所占的储存空间为4KB，也就是4个字节，但ATGC在计算机中并不是直接储存为ATGC的，而是最终以01这形式进行储存的。</p>
<h2 id="以人类基因组为例说明文本文件">以人类基因组为例说明文本文件</h2>
<p>知乎上有这个样问题，即<a href="https://www.zhihu.com/question/21672220/answer/19590442" target="_blank" rel="external">!人体30亿个碱基对的基因组，容量有多少兆？</a>，下面的回答很好，这里汇总如下：</p>
<p>人类有30亿个碱基对，而碱基只有4种形式，即ATGC，虽然一个碱基对是2个碱基，但是由于DNA的结构特征，在整个碱基对中，G与C配对，A与T配对，在储存测序文件时，只需储存一条链，另外一条链就能互补出来。如果以文本文件储存这30亿个碱基对的话，就需要3000000000个字节，即3GB，注意，这里的GB是指计算机的储存空间，但是这样储存起来比较耗费计算机空间，因为在序列信息方面，只有ATGC这个信息，在文本文件储存时，一个字母就是1个字节，1个字节是8个bit，1个bit可以表示2种信息，即0或1，而2个bit可以表示4种信息，即00，01，10，11，因此仅储存ATGC的话，只需要2个bit就可以了，因此算法学家开发出了压缩碱基信息的算法，可以将文本文件形式的碱基进行压缩，这样的话，用2个bit就能表示1个碱基，30亿个碱基就可以被压缩为3000000000×2 bit/8=750000000个字节了，此时这个0与1还是以文本形式进行储存的，所占空间为750M，这样压缩的目的就在于节约储存空间。现在的话，如果我们测了一批人类基因组的信息，需要与标准基因组进行比对，而压缩的人类参考基因组是750M的0，1字符的文件，肯定不能直接比对，这就需要解压缩，将750M的参考基因组再解压为ATGC的形式，就行了，解压后的文件就成了3GB。</p>
<p>如果不太好理解，可以再举个例子，如果我们有一幅高清的图片，10M，要发给某个人看，如果采用压缩的方式，例如采用WinRAR这个工具来压缩，压缩成了6M，通过邮件发给某人，某人拿到后，用看图软件肯定无法直接打开，他就可以解压缩，将这个6M的文件再解压为10M，就能查看了，这个过程经历了：压缩-解压的过程。而人类基因组的参考序列的压缩原理也是如此，只是它的压缩工具不是WinRAR，是另外的压缩工具，这样做的目的在于节约储存空间。</p>
<h2 id="常见的序列储存单位汇总">常见的序列储存单位汇总</h2>
<p>现在还有一种情况，我们在测序时，生成的信息不可能只有ATGC这样的碱基序列，还有其他的信息，例如reads的位置，质量值等等，现在看一个例子。</p>
<blockquote>
<p>Aggarwal P, Turner A, Matter A, et al. RNA Expression Profiling of Human iPSC-Derived Cardiomyocytes in a Cardiac Hypertrophy Model[J]. Plos One, 2014, 9(9):e108051.</p>
</blockquote>
<p>这篇文献测了一批miRNA-seq，找到其中的一个实验，编号为SRR1542716，在SRA中的信息如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180425/jIcFkfA531.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>从这个表中可以知道，实验的编号为SRR1542716，Spots是read数目，Bases是碱基的数目（后缀是bp是通常是指碱基数目，如果只是M，则通常表示储存空间），Size是压缩后的储存空间，后面的信息就省略了。read数目是2.8M，最下面的绿色长条是reads的统计数据，reads的长度是20bp，2.8M × 20 = 56M个碱基，理论上，这56个碱基所占的储存空间为：56M × 1B = 56M。而SRA数据库中的文件是测序后的数据fastq文件的压缩文件，现在把SRR1542716这个文件下载后，需要解压才能得到最初始的测序文件，即fastq格式的文件，解压后的文件为SRR1542716.fastq，所占空间 为366M，现在查看一下这个文件，用<code>head -5 SRR1542716.fastq</code>命令即可，只查看前5行，如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">@SRR1542716.1 FFVW0:02077:02655 length=24</div><div class="line">TGGGATGTAGTAGGTTGTATAGTT</div><div class="line">+SRR1542716.1 FFVW0:02077:02655 length=24</div><div class="line">+566&gt;==99;7&lt;7&lt;BCBCCC&lt;</div><div class="line">@SRR1542716.2 FFVW0:01819:00311 length=16</div></pre></td></tr></table></figure>
<p>这是fastq文件的格式，它的具体含义如下所示：</p>
<p>第1行：序列标识以及相关的描述信息，以‘@’开头。这里的第1行是<code>@SRR1542716.1 FFVW0:02077:02655 length=24</code>，握住的信息为reads编号，FFVW0:02077:02655这个可能是位置信息，read长度，即length=24;</p>
<p>第2行：序列，这个容易理解。</p>
<p>第3行，以+形状，与第1行一样，是序列标示符，描述信息，不过有的测序仪生成的fastq文件此行信息。</p>
<p>第4行，质量信息，这第2行的序列信息相对应，每个碱基都有一个质量评分，根据评分体系的不同，每个字符的含义表示的数字也不同。</p>
<p>第5行，这是另外的一条read。</p>
<p>从fastq的这个文件中我们可以得出以下信息：</p>
<ol style="list-style-type: decimal">
<li>测序文件的文本中，含有的信息量不仅仅是测序的碱基信息，还有其他的信息；</li>
<li>测序文件所占的空间要大于只有碱基的文本文件所占的空间。</li>
</ol>
<p>这里，我们复制前4行到一个文本文件里，命名为<code>seq_file.txt</code>，右键查看一下，发现空间为133字节（即133B）。再把序列信息，即只有第2行的信息复制到一个文本文件里，命名为<code>seq_base.txt</code>，右键查看一下属性，发现空间为24B，测序文件的信息是碱基信息的133/24=5.5倍，这也就不难理解，为什么SRR1542716中碱基数目的信息大概是56M，而实际的测序fastq文件是366M了（后者大概是前者的6.5倍），因为fastq文件中储存的信息要高于仅储存碱基序列的信息。</p>
<h2 id="测序深度与reads的计算">测序深度与reads的计算</h2>
<p>对于测序深度，reads的计算，以及相关的数据量不太清楚，找了一个篇文章，源于公众号“嘉因”，后方有链接。</p>
<blockquote>
<p>Sequencing depth. The amount of sequencing needed for a given sample is determined by the goals of the experiment and the nature of the RNA sample. Experiments whose purpose is to evaluate the similarity between the transcriptional profiles of two polyA+ samples may require only modest depths of sequencing (e.g. 30M pair-end reads of length &gt; 30NT, of which 20-25M are mappable to the genome or known transcriptome, Experiments whose purpose is discovery of novel transcribed elements and strong quantification of known transcript isoforms requires more extensive sequencing. The ability to detect reliably low copy number transcripts/isoforms depends upon the depth of sequencing and on a sufficiently complex library. For experiments from a typical mammalian tissue or in which sensitivity of detection is important, a minimum depth of 100-200 M 2 x 76 bp or longer reads is currently recommended. [Specialized studies in which the prevalence of different RNAs has been intentionally altered (e.g. “normalizing” using DSN) as part of sample preparation need more than the read amounts (&gt;30M paired end reads) used for simple comparison (see above). Reasons for this include: (1) overamplification of inserts as a result of an additional round of PCR after DSN and (2) much more broad coverage given the nature of A(-) and low abundance transcripts.</p>
</blockquote>
<p>上述文字翻译如下： <strong>根据研究目的决定测序深度：</strong> 目的1：通过抓取polyA尾建库（只测那些带有polyA尾巴的基因，大多是蛋白编码基因），寻找样品间基因转录谱的相似性，只需要30M reads，长度大于30nt即可，双端测序，其中20-25M能够回帖(map)到已知转录组上。 目的2：要发现新的转录本，对已知isoform（同一基因由于不同的可变剪接方式形成多种isoform，勉强译为亚型）进行定量分析，兼顾低表达量的转录本或isoform，就需要100-200M read，长度大于76bp，双端测序。 注：ENCODE测的是人和小鼠，其他物种不包括在此推荐范围内。</p>
<h2 id="reads数的相关计算">reads数的相关计算</h2>
<p>测序深度或者覆盖度（coverage or depth）是指参考序列一个碱基上比对的reads的数目。</p>
<p>计算公式为：测序深度 = reads长度 × 比对的reads数目 / 参考序列长度</p>
<h3 id="mirna测序">miRNA测序</h3>
<p>miRNA测序只需要10M read，每条read长50bp，单端测序，下面是一些测序公司的数据量：</p>
<table>
<colgroup>
<col width="26%">
<col width="16%">
<col width="47%">
<col width="9%">
</colgroup>
<thead>
<tr class="header">
<th>Sequencer</th>
<th>Strategy</th>
<th>Sequencing deep</th>
<th>Company</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Illumina HiSeqTM 2500</td>
<td>SE50</td>
<td>General deep:8Mclean reads High deep:15M clean Reads</td>
<td>南京迪康金诺</td>
</tr>
<tr class="even">
<td>Illumina HiSeq™ 2500</td>
<td>SE36</td>
<td>18.9~28.2M</td>
<td>百迈客</td>
</tr>
<tr class="odd">
<td>Illumina</td>
<td>SE50bp</td>
<td>10M reads/sample</td>
<td>美吉生物</td>
</tr>
<tr class="even">
<td>HiSeq 2500</td>
<td>SE50</td>
<td>General deep:6~10M clean reads High deep:15～20M clean Reads read/sample</td>
<td>诺禾致源</td>
</tr>
<tr class="odd">
<td></td>
<td>SE36 OR SE50</td>
<td>General deep:10M reads High deep：20M reads</td>
<td>阅微基因</td>
</tr>
</tbody>
</table>
<h3 id="reads的转换都是碱基数目不是储存空间">reads的转换（都是碱基数目，不是储存空间）</h3>
<p><strong>1. 双端测序换算</strong> PE150或2×150，即双端测序，每条read长度150bp。 150bp×2端 × read数 = 数据量 例如，测50M read，150bp X 2端 X 50M read = 15000M = 15G（这个G表示的是碱基长度bp，而不是计算机的储存单位GB）。</p>
<p><strong>2. 单端测序换算</strong> SE50或1×50，即单端测序，每条read长度50bp。 50bp ×1端 × read数 = 数据量 例如，测20M read，50bp ×1端 × 20M read = 1000M = 1G</p>
<p><strong>3. 测序仪的数据量换算</strong> 有空补充，现在还没弄明白。</p>
<h3 id="一个问题计算多少条reads">一个问题：计算多少条reads？</h3>
<p><strong>问题描述：RNA-Seq数据，101bp大小。测序公司给我1.5G数据，大约有多少reads？</strong> 答：按照PE测序101和1.5Gbp计算，就是1.5<em>10^9/100=1.5</em>10^7（条reads）=15M条</p>
<p>参考资料 <a href="https://mp.weixin.qq.com/s?src=3&amp;timestamp=1522379641&amp;ver=1&amp;signature=lQd0Tcylwm7fYuKVfGOA8Sl5fp00Y81iT1ao23U6PMfPxIUMWq054KP9EwYtYz9BbVpCEhLQ7kGm7-lQgi5JQd0SxNVa0b*kr7GZ2o2TRzBp2v7sPAu79z3VVkKZHF4xj8nWsM73Nx*ZeJLAx6vI*9GnmYrztfU8FwVXLxlGAaE=" target="_blank" rel="external">测多少数据量？几个G？多少reads？如何换算？</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2018/03/28/Linux/Linux题库解答/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/03/28/Linux/Linux题库解答/" itemprop="url">Linux题库解答</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-03-28T12:00:00+08:00">
                2018-03-28
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Linux/" itemprop="url" rel="index">
                    <span itemprop="name">Linux</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  2,647
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  11
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="前言">前言</h2>
<p>这个教程源于曾健明，<a href="http://www.bio-info-trainee.com/2900.html" target="_blank" rel="external">题库地址为其博客</a>。所使用的Linux系统是曾健明的服务器，服务器信息如下： 1. <code>/usr/local/bin/miniconda3/bin</code>路径下面安装了生物信息学软件，可以使用全路径调用它们，或者添加该目录到环境变量。 2. 两个练手数据： 2.1 转录组数据：<code>/public/study/mRNAseq/tair/</code>的转录组的测试数据，具体教程可以看其博客：<a href="http://www.bio-info-trainee.com/2809.html" class="uri" target="_blank" rel="external">http://www.bio-info-trainee.com/2809.html</a>，可以用<code>ls -lh  --color=auto /public/study/mRNAseq/tair/</code> 命令查看，然后所有的处理，在自己的目录处理，不需要拷贝那些数据. 2.2 找变异：<code>/public/study/variant-calling/tair</code>。 可以参见教程：<a href="http://www.biotrainee.com/thread-696-1-1.html" class="uri" target="_blank" rel="external">http://www.biotrainee.com/thread-696-1-1.html</a></p>
<p>其他的NGS流程，参见Github：<a href="https://github.com/jmzeng1314/NGS-pipeline" class="uri" target="_blank" rel="external">https://github.com/jmzeng1314/NGS-pipeline</a>。</p>
<h2 id="基础知识">基础知识</h2>
<h3 id="基础知识-1">基础知识</h3>
<h3 id="文件目录操作">文件目录操作</h3>
<ol style="list-style-type: decimal">
<li>查看当前目录<code>pwd</code> <img src="http://ortxpw68f.bkt.clouddn.com/professional/180328/AKEdmBFIIH.png?imageslim" alt="mark"></li>
</ol>
<h3 id="系统管理">系统管理</h3>
<p>1.查看当前登录用户<code>w</code> <img src="http://ortxpw68f.bkt.clouddn.com/professional/180328/7fA66bCmEk.png?imageslim" alt="mark"></p>
<p>2.查看命令历史<code>l~/.bash_history</code> Bash shell在“~/.bash_history”（“~/”表示用户目录）文件中保存了500条使用过的命令，这样可以使你输入使用过的长命令变得容易。每个在系统中拥有账号的用户在他的目录下都有一个“.bash_history”文件。</p>
<h3 id="用户权限">用户权限</h3>
<h3 id="文本操作">文本操作</h3>
<h2 id="题库测试">题库测试</h2>
<p><strong>1. 在任意文件夹下面创建形如 1/2/3/4/5/6/7/8/9 格式的文件夹系列。</strong></p>
<p><code>mkdir -p 1/2/3/4/5/6/7/8/9</code> mkdir是建立文件夹命名，添加<code>-p</code>参数可以直接创建多级文件夹，如下所示： <img src="http://ortxpw68f.bkt.clouddn.com/professional/180328/8ki0H89cfC.png?imageslim" alt="mark"></p>
<p><strong>2.在创建好的文件夹下面，比如我的是 /Users/jimmy/</strong>tmp/1/2/3/4/5/6/7/8/9 ，里面创建文本文件 me.txt</p>
<p>先切换到/1/2/3/4/5/6/7/8/9，直接输入<code>cd</code>，然后不停地按<code>Tab</code>键，就会进入下一层文件夹。 <code>touch me.txt</code>创建txt文件。 <img src="http://ortxpw68f.bkt.clouddn.com/professional/180328/AAeBcaD17A.png?imageslim" alt="mark"></p>
<p><strong>3.在文本文件 me.txt 里面输入内容:</strong> Go to: http://www.biotrainee.com/ I love bioinfomatics. And you ?</p>
<p>输入<code>vim me.txt</code>，输入上述文字，然后按<code>Esc</code>键，输入<code>wp</code>退出。</p>
<p><strong>4. 删除上面创建的文件夹 1/2/3/4/5/6/7/8/9 及文本文件 me.txt</strong></p>
<p><code>rm -rf *</code></p>
<p><strong>5. 在任意文件夹下面创建 folder1~5这5个文件夹，然后每个文件夹下面继续创建 folder1~5这5个文件夹，效果如下：</strong></p>
<p><code>mkdir -p folder_{1..5}/folder_{1..5}</code> 如下所示： <img src="http://ortxpw68f.bkt.clouddn.com/professional/180328/b9EHafGmmE.png?imageslim" alt="mark"></p>
<p><strong>6. 在第五题创建的每一个文件夹下面都 创建第二题文本文件 me.txt ，内容也要一样。</strong></p>
<p>先创建一个tmp3目录，其目录下有5个文件夹，5个文件夹下面又有5个文件夹，然后将me.txt拷贝到这25个文件夹中：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">mkdir -p tmp3/folder_&#123;1..5&#125;/folder_&#123;1..5&#125;</div><div class="line">echo tmp3/folder_&#123;1..5&#125;/folder_&#123;1..5&#125; | xargs -n 1 cp -v me.txt</div></pre></td></tr></table></figure>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180328/jggF50km1I.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p><strong>7. 再次删除掉前面几个步骤建立的文件夹及文件。</strong> <code>rm -rf *</code></p>
<p><strong>8. 下载 http://www.biotrainee.com/jmzeng/igv/test.bed 文件，后在里面选择含有 H3K4me3 的那一行是第几行，该文件总共有几行。</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">wget http://www.biotrainee.com/jmzeng/igv/test.bed</div><div class="line">grep -n &quot;H3K4me3&quot; test.bed</div><div class="line">wc test.bed</div></pre></td></tr></table></figure>
<p>结果如下： <img src="http://ortxpw68f.bkt.clouddn.com/professional/180328/6J951D225C.png?imageslim" alt="mark"> 可知，H3K4me3在第8行，用Notepad++打开的话，核对一下，确实如此。 <img src="http://ortxpw68f.bkt.clouddn.com/professional/180328/CmBJ842fB1.png?imageslim" alt="mark"> 用<code>wc</code>命令查看有多少行，一共10行。</p>
<p><strong>9. 下载 http://www.biotrainee.com/jmzeng/rmDuplicate.zip 文件，并且解压，查看里面的文件夹结构</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">wget http://www.biotrainee.com/jmzeng/rmDuplicate.zip</div><div class="line">unzip rmDuplicate.zip</div><div class="line">cd rmDuplicate.zip</div></pre></td></tr></table></figure>
<p>查看文件： <img src="http://ortxpw68f.bkt.clouddn.com/professional/180328/d87Hd2LjLm.png?imageslim" alt="mark"></p>
<p><strong>10. 打开第九题解压的文件，进入 rmDuplicate/samtools/single 文件夹里面，查看后缀为 .sam 的文件，搞清楚 生物信息学里面的SAM/BAM 定义是什么。</strong> <img src="http://ortxpw68f.bkt.clouddn.com/professional/180328/2EhCCfda4e.png?imageslim" alt="mark"></p>
<p><strong>SAM文件与BAM文件</strong> &gt; SAM是一种序列比对格式标准， 由sanger制定，是以TAB为分割符的文本格式。主要应用于测序序列mapping到基因组上的结果表示，当然也可以表示任意的多重比对结果。</p>
<blockquote>
<p>SAM要处理好的问题：</p>
</blockquote>
<blockquote>
<p>非常多序列（read)，mapping到多个参考基因组（reference）上； 同一条序列，分多段（segment）比对到参考基因组上； 无限量的，结构化信息表示，包括错配、删除、插入等比对信息； SAM分为两部分，注释信息（header section）和比对结果部分（alignment section），注释信息可有可无，都是以@开头，用不同的tag表示不同的信息，主要有@HD，说明符合标准的版本、对比序列的排列顺序；<span class="citation">@SQ</span>，参考序列说明；<span class="citation">@RG</span>，比对上的序列（read）说明；<span class="citation">@PG</span>，使用的程序说明；<span class="citation">@CO</span>，任意的说明信息。</p>
</blockquote>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180328/h0kI4HLFg8.jpg?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<blockquote>
<p>比对结果部分（alignment section），每一行表示一个片段（segment）的比对信息，包括11个必须的字段（mandatory fields）和一个可选的字段，字段之间用tag分割。必须的字段有11个，顺序固定，不可用时，根据字段定义，可以为’0‘或者’*‘，这是11个字段包括：</p>
</blockquote>
<blockquote>
<p>QNAME，比对片段的（template）的编号； FLAG，位标识，template mapping情况的数字表示，每一个数字代表一种比对情况，这里的值是符合情况的数字相加总和； RNAME，参考序列的编号，如果注释中对SQ-SN进行了定义，这里必须和其保持一致，另外对于没有mapping上的序列，这里是’<em>‘； POS，比对上的位置，注意是从1开始计数，没有比对上，此处为0； MAPQ，mappint的质量； CIGAR，简要比对信息表达式（Compact Idiosyncratic Gapped Alignment Report），其以参考序列为基础，使用数字加字母表示比对结果，比如3S6M1P1I4M，前三个碱基被剪切去除了，然后6个比对上了，然后打开了一个缺口，有一个碱基插入，最后是4个比对上了，是按照顺序的； RNEXT，下一个片段比对上的参考序列的编号，没有另外的片段，这里是’</em>‘，同一个片段，用’=‘； PNEXT，下一个片段比对上的位置，如果不可用，此处为0； TLEN，Template的长度，最左边得为正，最右边的为负，中间的不用定义正负，不分区段（single-segment)的比对上，或者不可用时，此处为0； SEQ，序列片段的序列信息，如果不存储此类信息，此处为’*‘，注意CIGAR中M/I/S/=/X对应数字的和要等于序列长度； QUAL，序列的质量信息，格式同FASTQ一样。 可选字段（optional fields)，格式如：TAG:TYPE:VALUE，其中TAG有两个大写字母组成，每个TAG代表一类信息，每一行一个TAG只能出现一次，TYPE表示TAG对应值的类型，可以是字符串、整数、字节、数组等。</p>
</blockquote>
<p><strong>11. 安装 samtools 软件</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">mkdir soft</div><div class="line">cd soft</div><div class="line">wget https://github.com/samtools/samtools/releases/download/1.7/samtools-1.7.tar.bz2</div><div class="line">tar jxvf samtools-1.7.tar.bz2</div><div class="line">cd samtools-1.7/</div><div class="line">./configure --prefix=/trainee/home/jlzhang/biosoft</div><div class="line">make</div><div class="line">make install</div><div class="line">export PATH=$PATH:/trainee/home/jlzhang/biosoft/bin:$PATH &gt;&gt;~/.bashrc</div><div class="line">source ~/.bashrc</div></pre></td></tr></table></figure>
<p>可以通过<code>echo $PATH</code>来查看用户变量。</p>
<p><strong>12. 打开 后缀为BAM 的文件，找到产生该文件的命令。</strong></p>
<p>用samtools view打开BAM文件，过程如下：</p>
<p>进入相应文件夹，即<code>samtools view tmp.rmdup.bam | head</code> 输入命令：<code>samtools view tmp.rmdup.bam | head</code> 打开后的BAM文件如下所示： <img src="http://ortxpw68f.bkt.clouddn.com/professional/180328/I2gIbJihKE.png?imageslim" alt="mark"></p>
<p><strong>13. 根据上面的命令，找到我使用的参考基因组 /home/jianmingzeng/reference/index/bowtie/hg38 具体有多少条染色体。</strong> 从网上找到的信息，hg38含有24条染色体，统计代码如下所示：</p>
<p>先找到hg38.fa文件，如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">locate hg38.fa</div></pre></td></tr></table></figure>
<p><img src="http://ortxpw68f.bkt.clouddn.com/professional/180329/cf45ebk16a.png?imageslim" alt="mark"> 随便挑一个进行统计，如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">grep &quot;chr[1-9,X,Y]&quot; /umac/reference/genome/hg38/hg38.fa| cut -d_ -f1 &gt; statistic.chrom</div><div class="line">sort statistic.chrom | uniq | wc</div></pre></td></tr></table></figure>
<p>可以发现，hg38有24条染色体，如下所示： <img src="http://ortxpw68f.bkt.clouddn.com/professional/180329/HGHLBKhlEK.png?imageslim" alt="mark"></p>
<p>其中,sort是对文本文件中的字符进行排序，uniq是去掉重复的行，但是uniq只能去掉相邻的重复行，因此之前要进行sort。</p>
<p><strong>14. 上面的后缀为BAM 的文件的第二列，只有 0 和 16 两个数字，用 cut/sort/uniq等命令统计它们的个数。</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">samtools view tmp.rmdup.bam &gt; bamfile</div><div class="line">awk &apos;&#123;print $2&#125;&apos; bamfile &gt; zero_one</div><div class="line">grep -o &quot;0&quot; zero_one |wc -l</div><div class="line">grep -o &quot;16&quot; zero_one |wc -l</div></pre></td></tr></table></figure>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180329/cbj6hmgGGB.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p><strong>15. 重新打开 rmDuplicate/samtools/paired 文件夹下面的后缀为BAM 的文件，再次查看第二列，并且统计</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">samtools view tmp.rmdup.bam &gt; pairbam</div><div class="line">awk &apos;&#123;print $2&#125;&apos; pairbam &gt; number </div><div class="line">awk &apos;&#123;print $2&#125;&apos; pairbam |sort|uniq -c</div></pre></td></tr></table></figure>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180329/KDd1bmlk0F.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p><strong>16. 下载 http://www.biotrainee.com/jmzeng/sickle/sickle-results.zip 文件，并且解压，查看里面的文件夹结构， 这个文件有2.3M，注意留心下载时间及下载速度。</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">wget http://www.biotrainee.com/jmzeng/sickle/sickle-results.zip</div><div class="line">ls -lh</div><div class="line">unzip sickle-results.zip</div><div class="line">cd sickle-results</div><div class="line">ls -lh</div></pre></td></tr></table></figure>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180329/096904lAFg.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p><strong>17. 解压 sickle-results/single_tmp_fastqc.zip 文件，并且进入解压后的文件夹，找到 fastqc_data.txt 文件，并且搜索该文本文件以 &gt;&gt;开头的有多少行？</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">cd sickle-results</div><div class="line">unzip single_tmp_fastqc.zip</div><div class="line">cd single_tmp_fastqc</div><div class="line">grep &quot;&gt;&gt;&quot;  fastqc_data.txt |wc -l</div></pre></td></tr></table></figure>
<p>一共是24行 <img src="http://ortxpw68f.bkt.clouddn.com/professional/180329/2hChiFB4FK.png?imageslim" alt="mark"></p>
<p><strong>18. 下载 http://www.biotrainee.com/jmzeng/tmp/hg38.tss 文件，去NCBI找到TP53/BRCA1等自己感兴趣的基因对应的 refseq数据库 ID，然后找到它们的hg38.tss 文件的哪一行。 https://www.ncbi.nlm.nih.gov/gene/7157</strong></p>
<ol style="list-style-type: decimal">
<li>打开PUBMED，选GENE，输入“TP53”，点击Search，如下所示： <img src="http://ortxpw68f.bkt.clouddn.com/professional/180329/hE93c3HKlH.png?imageslim" alt="mark"></li>
</ol>
<p>Pubmed中有很多TP53的信息，但是hg38是人类基因组，因此选择第一行的TP53就行，进入即可，找到Go to reference sequence details，点进去即可，如下所示： <img src="http://ortxpw68f.bkt.clouddn.com/professional/180329/f5K40hH9mh.png?imageslim" alt="mark"></p>
<p>找到Go to reference sequence details，进去，其中有NM开头的编号，NM表示mRNA的RefSeq，TP53的就是NM_00054635（小数点部分是版本号，不用管），在hg38.tss中查询即可，BRCA1按照同样操作，查询结果如下所示： <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">wget http://www.biotrainee.com/jmzeng/tmp/hg38.tss</div><div class="line">grep &quot;NM_000546&quot; hg38.tss </div><div class="line">grep &quot;NM_005905&quot; hg38.tss</div></pre></td></tr></table></figure></p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180329/Ih5GL0fIAb.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p><strong>19. 解析hg38.tss 文件，统计每条染色体的基因个数。</strong></p>
<p>hg38.tss文件是基因的坐标，查看了一下文件，文件内容如下所示： <img src="http://ortxpw68f.bkt.clouddn.com/professional/180329/20jK2DK3Kl.png?imageslim" alt="mark"></p>
<p>第1列是基因名称，第2列是染色体名称，第3列到第4列是转录起止坐标，第5列不清楚。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">awk &apos;$5 &gt; 0&apos; hg38.tss &gt; gene2</div><div class="line">awk &apos;&#123;print $2&#125;&apos; gene2 &gt; gene</div><div class="line">cut -d_ -f1 gene |sort |uniq -c</div></pre></td></tr></table></figure>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180329/gHHAJ0II9A.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p><strong>20. 解析hg38.tss 文件，统计NM和NR开头的序列，了解NM和NR开头的含义。</strong></p>
<p>没在hg38.tss文件里找到相应的序列，只找到了名称，提取NM和NR开头的名称命令如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">grep &quot;NM&quot; hg38.tss</div><div class="line">grep &quot;NR&quot; hg38.tss</div></pre></td></tr></table></figure>
<p>NM，mRNA mixed，转录组产物序列；成熟mRNA转录本序列。 NR，RNA mixed，非编码的转录子序列，包括结构RNAs，假基因转子等。</p>
<p>参考资料： 1. <a href="http://boyun.sh.cn/bio/?p=1890" target="_blank" rel="external">博耘生物</a> 2. <a href="http://blog.sina.com.cn/s/blog_72512a1d0102xp6f.html" target="_blank" rel="external">NCBI中编号/编码说明</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2018/03/20/BioItem/生信-拟南芥转录组/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/03/20/BioItem/生信-拟南芥转录组/" itemprop="url">拟南芥转录组完整流程2</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-03-20T12:00:00+08:00">
                2018-03-20
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/生信实战项目/" itemprop="url" rel="index">
                    <span itemprop="name">生信实战项目</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  5,806
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  23
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="前言">前言</h2>
<p>这是根据“思考问题的熊“的课程《生信技能树转录组数据分析入门实战》进行整理的，这是一个标准的转录组分析流程，所用模式生物是拟南芥，整个课程信息如下所示：</p>
<h3 id="课程题目">课程题目：</h3>
<p>生信技能树转录组数据分析入门实战</p>
<h3 id="课程内容">课程内容：</h3>
<ol style="list-style-type: decimal">
<li>课程介绍</li>
<li>Linux操作技巧</li>
<li>生物信息软件安装</li>
<li>转录组分析整体思路</li>
<li>转录组数据预处理</li>
<li>转录组数据序列比对</li>
<li>转录组数据表达定量</li>
<li>转录组数据差异分析</li>
</ol>
<h3 id="所用数据如下所示">所用数据，如下所示：</h3>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180323/aJC86iIddm.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h3 id="二inux操作技巧">（二）inux操作技巧</h3>
<h4 id="linux常用客户端">Linux常用客户端</h4>
<p>Xshell：用于登录远程服务器。 Putty：用于登录远程服务器。 WInSCP：用于下载服务器文件。</p>
<h4 id="linux命名">Linux命名</h4>
<p>这个比较基础，略过，只讲一个alias alias用于缩简一些命令，例如这次的练习数据我放在了<code>/mnt/hgfs/biotest/rnaseq/</code>这个目录下，每次都输入都太麻烦了，因此可以使用alias命名进行添加，如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">cd #进行主目录</div><div class="line">vim .bashrc # 进入bashrc文件</div></pre></td></tr></table></figure>
<p>在.bashrc文件中添加如下字段：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">alias wp=&apos;cd /mnt/hgfs/biotest/rnaseq/&apos;</div></pre></td></tr></table></figure>
<p>保存并退出，其中需要注意的是等号两边不要有空格，否则会出错。 此时直接输入wp就可以直接进行目录。</p>
<h3 id="三生物信息软件安装">（三）生物信息软件安装</h3>
<p>主要是利用conda进行安装，比较简单，详细的教程可以参照<a href="https://zhuanlan.zhihu.com/p/25085567" target="_blank" rel="external">青山屋主的教程</a>，这个是我看到的比较好的教程。</p>
<h3 id="四转录组分析整体思路">（四）转录组分析整体思路</h3>
<p>作者回顾了一下以前的思路，如下所示： <img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190302175319.png"></p>
<p>大图如下所示： <img src="http://ortxpw68f.bkt.clouddn.com/professional/180323/hkA5ea79cL.png?imageslim" alt="mark"></p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190302175407.png">

</div>
<h3 id="五转录组数据预处理">（五）转录组数据预处理</h3>
<h4 id="数据介绍">数据介绍</h4>
<p>按照作者教程中的文件夹整理了所要分析的数据，如下所示： <img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190302175438.png"></p>
<p>现在解释一下这几个文件夹，其中： 1. <code>00ref</code>存放的是参考基因组文件（fasta格式）和注释信息（gtf/gff格式）文件；参考序列以及注释信息的下载地方通有<a href="www.ensembl.org">Ensembl</a>，<a href="https://genome.jgi.doe.gov/portal/" target="_blank" rel="external">JGI</a>，此外，还有一些针对某些模式生物的专门数据库，例如araport是拟南芥的数据库，本文所用的数据就是拟南芥的测序数据（已经下载好，过程略）。</p>
<ol start="2" style="list-style-type: decimal">
<li><p><code>01_raw_data</code>中的是原始数据（测序公司给你的数据），其中，sample1_R1.fastq.gz和sample1_R2.fastq.gz表示的是双端测序（PE），一个是左边的数据，一个是右边的数据。</p></li>
<li><p><code>02clean_data</code>用于存放清洗了原始数据后的数据；</p></li>
<li><p><code>03align_data</code>用于存放比对后的数据（例如BAM或SAM），以及分析的数据；</p></li>
<li><p><code>others</code>文件夹中的数据不清楚，这一部分的数据是从教程的主页上下载下来的，估计是分析后的数据，先不管。</p></li>
</ol>
<h4 id="解压缩参考序列文件">解压缩参考序列文件</h4>
<p>刚下载的参考序列文件与注释文件是以gz结尾的压缩文件，因此先进行解压，<code>gunzip *gz</code>的作用就是将压缩文件解压到当前文件夹，如下所示：</p>
<p><img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190302175519.png"> 两个文件已经解压好了，一个是gtf文件，一个是fasta文件，可以用<code>head</code>命令查看一下序列： <img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190302175617.png"></p>
<p>此外，还能通过<code>cat，less，more，head，tail</code>这几个命令来查看序列，现在查看一下注释文件： <img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190302175753.png"></p>
<h5 id="md5值的计算">MD5值的计算</h5>
<p>MD5主要用于检验数据传输后，前后两个数据是否完整，简单来说就是，测序文件很大，通过MD5我就能知道上传或下载后的数据跟我原来的数据是不是一样。检测过程如下所示： 生成4个原始数据的MD5值： <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">cd ../01raw_data </div><div class="line">md5sum *gz &gt; md5.txt</div></pre></td></tr></table></figure></p>
<p>上述两个命令是切换到原始数据的文件夹，通过<code>md5sum</code>命令是生成该文件夹下的所有gz格式文件的MD5值，并将这些MD5值给md5.txt文件，现在查看一下md5.txt文件<code>less md5.txt</code>： <img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190302175827.png"></p>
<h5 id="检验md5值">检验MD5值</h5>
<p>用md5sum命令来检验一下MD5的值： <img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190302175850.png"> 如果文件完整，后面会显示OK。</p>
<h4 id="测序文件的质控">测序文件的质控</h4>
<p>质控软件是<code>fastqc</code>，如果没有安装可以利用ocnda进行安装，<code>conda install fastqc</code>，安装后，查看一下版本<code>fastqc -v</code>，如下所示： <img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190302175912.png"></p>
<h5 id="第一种方法质控常规方法">第一种方法质控：常规方法</h5>
<p>现在用fastqc进行质控，如下所示： <code>fastqc sample*gz</code>， <img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190302175939.png"> 运行过程与测序文件的大小以及计算机的性能有关，我们这个数据量不大，比较快，结束后，用<code>tree</code>来查看一下结果：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190302180004.png">

</div>
<p>其中以html结尾的数据就是测序的结果，关于测序结果的解读，以前参考过<a href="https://zhuanlan.zhihu.com/p/20731723" target="_blank" rel="external">青山屋主的《使用 FastQC 做质控》</a>，可以看一下。</p>
<h5 id="第二种方法质控用for循环">第二种方法质控：用for循环</h5>
<p>此外，还可以用<code>for</code>循环来做，先把原来的zip和html文件删除掉<code>rm -f *zip</code>和<code>rm -f *html</code>，用于<code>for i in</code>ls *gz<code>;do fastqc $i;done</code>来进行循环，同样能达到相同的目的。</p>
<h5 id="第三种方法质控利用管道命令">第三种方法质控：利用管道命令</h5>
<p>先把原来的zip和html文件删除掉<code>rm -f *zip</code>和<code>rm -f *html</code>，然后输入命名<code>ls *gz |xargs -I [] echo 'nohup fastqc [] &amp;'</code>，这个命名是的运行过程就是列出raw_data文件夹下的所有测序文件（就是4个原始数据文件），然后导入到xargs命名中，利用xargs命令调用nohup命名。关于这个命名的解释： 2. <code>ls *gz</code>是列出当前目录下的所有gz文件。 3. <code>|</code>表示将上面列出的文件导入到下一步（xargs命名），这叫管道命令，很形象，就是将上面的结果像管道一下，输入到下一步。 4. xargs命令是给其他命令传递参数的一个过滤器，也是组合多个命令的一个工具，使用-I指定一个替换字符串[]，这个字符串在xargs扩展时会被替换掉，当-I与xargs结合使用，每一个参数命令都会被执行一次，我们使用上述的这段命名时，它表示，用<code>ls *gz</code>列出的几个文件名字替换掉<code>nuhup fastqc []</code>的中括号。 4. <code>echo</code>用于输出字符串； 5. nohup是将操作置于后台，它要与<code>&amp;</code>配合使用。 6. 有关管道与<code>xargs</code>的用法，这个<a href="https://www.cnblogs.com/wangqiguo/p/6464234.html" target="_blank" rel="external">文章介绍得不错《xargs命令详解，xargs与管道的区别》</a>。</p>
<p>再看一下流程： ls *gz |xargs -I [] echo ‘fastqc []’ 就是将第一个[]里的内容替换掉第二个[]，如下所示： <img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190302180033.png"></p>
<p>将上述命令保存到<code>fastqc.sh</code>文件中，并运行fastqc.sh文件，如下所示： <img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190302180101.png"></p>
<p>结果如下： <img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190302180123.png"></p>
<h5 id="第四种方法质控multiqc">第四种方法质控：multiqc</h5>
<p>这种方法严格来说并不是做质控，而是把fastqc的质控结果给合并起来，直接在fastqc分析后的结果的目录中输入<code>multiqc .</code>就可以，如下所示： <img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190302180152.png"> 打开multiqc_report文件，如下所示： <img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190302180214.png"></p>
<h4 id="数据的过滤去接头">数据的过滤（去接头）</h4>
<p>数据过程主要使用的是Trimmomatic软件，此软件的功能是用于去掉原始数据的接头序列，先看一下测序的质量文件中的Adaptor Concent，如下所示： <img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190302180238.png"> 这张图衡量的是序列中两端adapter的情况，从图中我们可以看出这些测序文件的接头序列并没有去掉，因此我们要去掉这些软件，Trimmomatic就是实现这个功能的，它的一些介绍如下所示：</p>
<p><strong>软件特点：</strong> 1. 支持多线程，处理数据速度快； 2. 主要用于去除Illumina平台接头； 3. 根据碱基质量对fastq进行筛选； 4. 支持SE和PE测序数据，支持gzip和bzip2压缩文件。</p>
<p><strong>质量过滤的依据：</strong> 1. ILLUMINACLIP：过滤reads中的Illumina接头； 2. LEADING：从reads开头切除质量值低于阈值的碱基； 3. TRAILING：从reads末尾切除质量值低于阈值的碱基； 4. SLIDINGWINDOW：从reads的5’端开始，进行滑窗过滤，切掉碱基质量平均值低于阈值的滑窗； 5. MINLEN：丢弃经过剪切后长度低于阈值的这条reads； 6. TOPHRED33：将reads的碱基质量值体系转换为phred-33（一般都选择phred-33）； 7. TOPHRED66:将reads的碱基质量值体系转换为phred-64。</p>
<p><strong>软件使用</strong> <strong>1. 接头序列的选择：</strong></p>
<ul>
<li><p>软件默认提供了几个接头文件，在FastQC的结果中会提示是哪种接头，如下所示： <img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190302180302.png"> 文件显示的是TruSeq Adapter，因此要选择“TrueSeq3-SE.fa” and “TruSeq3-PE.fa”进行过滤（我们前面知道，本次案例中的是双端测序，因此用到的是TruSeq3-PE.fa）。</p></li>
<li><p>但是如果显示的是Illumina Single End”/“Illumina Paired End”就要选择“TruSeq2-SE.fa”和“TruSeq2-PE.fa”，</p></li>
</ul>
<p><strong>2. 去接头参数的选择</strong> 选择true或false，随后会介绍。</p>
<h5 id="trimmomatic使用案例">trimmomatic使用案例</h5>
<p>双端测序会输入2个文件，分别是正向测序序列和反向测序序列，过滤完数据后，会输出4个文件，双端测序都保留的是paired，如果其中一端序列过滤后被丢弃了，另一端序列被保留了，则为unpaired。</p>
<p>现在使用trimmomatic去掉adapter，如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">trimmomatic PE -threads 4 \</div><div class="line">sample1_R1.fastq.gz sample1_R2.fastq.gz \</div><div class="line">../02clean_data/sample1_paired_clean_R1.fastq.gz \</div><div class="line">../02clean_data/sample1_unpair_clean_R1.fastq.gz \</div><div class="line">../02clean_data/sample1_paired_clean_R2.fastq.gz \</div><div class="line">../02clean_data/sample1_unpair_clean_R2.fastq.gz \</div><div class="line">ILLUMINACLIP:/home/biotest/ENTER/share/trimmomatic-0.36-5/adapters/TruSeq3-PE-2.fa:2:30:10:1:true \</div><div class="line">LEADING:3 TRAILING:3 \</div><div class="line">SLIDINGWINDOW:4:20 MINLEN:50 TOPHRED33</div></pre></td></tr></table></figure>
<p>代码的解释： 1. -threads:后面的数据表示是线程数，可不设置，程序会自行检测并选择核心数。 2. ILLUMINACLIP:过滤 reads 中的 Illumina 测序接头和引物序列，并决定是否去除反向互补的 R1/R2 中的 R2。在此命令中输入的是/home/biotest/ENTER/share/trimmomatic-0.36-5/adapters/TruSeq3-PE-2.fa，它是接头序列文件，可以在trimmomatic的安装目录中找到，这一步要使用绝对路径； 4. LEADING:3 TRAILING:3 5. SLIDINGWINDOW:从 reads 的 5’ 端开始，进行滑窗质量过滤，切掉碱基质量平均值低于阈值的滑窗。 6. LEADING: 从 reads 的开头切除质量值低于阈值的碱基。 7. TRAILING: 从 reads 的末尾开始切除质量值低于阈值的碱基。 8. MINLEN: 如果经过剪切后 reads 的长度低于阈值则丢弃这条 reads，被丢弃的 reads 数会被统计在 Trimmomatic 日志的 dropped reads 中。 9. AVGQUAL: 如果 reads 的平均碱基质量值低于阈值则丢弃这条 reads。 10. TOPHRED33: 将 reads 的碱基质量值体系转为 phred-33。 11. TOPHRED64: 将 reads 的碱基质量值体系转为 phred-64。 运行过程如下所示： <img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190302180330.png"> 这个过程根据序列的长度与计算机的性能有所不同，我在虚拟机中跑了大概5分钟，运行完后，如下所示： <img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190302180353.png"></p>
<p>这个结果显示，输入了250000个序列，其中196007个序列（78.40%）的序列留下，14.26%留在了一端，2.39%留在了另一端，另外，扔掉了4.94%的序列。如果将ILLUMINACLIP:/home/biotest/ENTER/share/trimmomatic-0.36-5/adapters/TruSeq3-PE-2.fa:2:30:10:1:true 中的true改为false，则结果如下所示： <img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190302180418.png"></p>
<p>这个结果显示，输入了250000个序列，其中90442个序列（36.02%）的序列留下，56.64%留在了一端，1.23%留在了另一端，另外，扔掉了6.11%的序列。 另外一个sample2样本也按照同样的操作（选true），去掉接头的所有文件如下所示： <img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190302180440.png"></p>
<h3 id="六转录组数据序列比对">（六）转录组数据序列比对</h3>
<h4 id="软件介绍">软件介绍</h4>
<p>序列比对分为两种，一种是有参比对，另一种是无参比对。这个过程就是将公司测序得到的reads比对到参考基因组上，如果我们所研究的物种有参考基因组的话，就是将reads直接比对到参考基因组上就行，如果没有参考基因组，则先需要拼接出一个基因组，然后再进行比对。这两种方式的差别如下所示：</p>
<p><img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190302180504.png"> 这张图里面涉及三种比对，分别是基因组，有参转录组，无参转录组，可以参考一下（图片出处：Conesa A, Madrigal P, Tarazona S, et al. A survey of best practices for RNA-seq data analysis. Genome Biology. 2016;17:13. doi:10.1186/s13059-016-0881-8.）</p>
<p>转录组测序的比对通常分为基因组比对和转录组比对两种，顾名思义，基因组比对就是把reads比对到完整的基因组序列上，而转录组比对则是把reads比对到所有已知的转录本序列上。无参转录组所用到的工具是trinity，有参转录本所用到的工具是STAR。</p>
<p>如果是基于基因组比对，所用的工具是STAR和Hisat2。如果是基于转录组进行比对，则可以使用RSEM（可以结合bowtie2和STAR进行比对和定量分析）。关于转录组所使用的一些工具2017年，<a href="https://mp.weixin.qq.com/s?src=11&amp;timestamp=1521872470&amp;ver=773&amp;signature=QyvVfMDkq46O3CxqFprV5ni3hSooBgOg2PVu*rGT4sfNaLH4Z7fsj8DvJepECqczTPF71CfQfTbQXaW7c7rn*ZWcLJqyC4YZzuVKqTDIP1fC9-cs0NuRk94DGQED1HmN&amp;new=1" target="_blank" rel="external">Nature Com去年发一篇文章，讲的39个工具，可以看一下。</a></p>
<p>本案例所用工具是STAR。过程包括①建立索引；②进行比对（分为两种操作，分为简单版与复杂版）；③查看比对文件。</p>
<h4 id="建立索引">建立索引</h4>
<p>这一步位于质控之后，比对之前。在比对的时候为什么要建立索引，这涉及到比对软件的一些算法。大致原理就是，如果直接将reads比对到参考基因组上，非常消耗计算资源，通常不这干。通常情况下就是，利用索引，将reads比对到参考基因组上，这样会比较节省计算资源，具体的原理我也不太清楚。</p>
<p>建立索引的步骤如下：</p>
<p>先建立一个目录，用于存放索引文物，即在<code>rnaseq</code>目录下，输入<code>mkdir arab_STAR_genome</code>，建立一个名叫arab_STAR_genome的目录。接着安装STAR软件，命令为<code>conda install star</code>，记得是小写。</p>
<p>现在切换到biotest/rnaseq目录下（这个目录就是00ref，arab_STAR_genome的上层目录，一定要在这个目录下，否则运行会出错），运行软件，代码如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">STAR --runThreadN 6 --runMode genomeGenerate \ </div><div class="line">--genomeDir arab_STAR_genome \ </div><div class="line">--genomeFastaFiles 00ref/TAIR10_Chr.all.fasta \ --sjdbGTFfile 00ref/Araport11_GFF3_genes_transposons.201606.gtf \ --sjdbOverhang 149</div></pre></td></tr></table></figure>
<p>运行过程中出现了错误，STAR的进程被杀死了，因为我用的是虚拟机，虚拟机的内存是1G，而STAR这个软件很耗内存，因此把虚拟机的内存上调到8G，再次运行，出现finished successfully即表示运行结束，如下所示： <img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190302180535.png"></p>
<p>进程还是被杀死，因此最后切换到笔记本的Ubuntu中进去，STAR能顺利运行，运行结束后，如下所示： <img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190302180557.png"></p>
<p>可以查看一下arab_STAR_genome文件夹，下图就是运算的结果 ： <img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190302180619.png"></p>
<h4 id="比对">比对</h4>
<p>接着进行第二步，先进行简单版的比对，简单版的比对输入的参数比较少，以比对sample1为例 说明，如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">STAR  --runThreadN 5 --genomeDir arab_STAR_genome \</div><div class="line">--readFilesCommand zcat \</div><div class="line">--readFilesIn 02clean_data/sample1_paired_clean_R1.fastq.gz \</div><div class="line">02clean_data/sample1_paired_clean_R2.fastq.gz \</div><div class="line">--outFileNamePrefix 03align_out/sample1_</div></pre></td></tr></table></figure>
<p>在03align_out文件 中可以看到这些文件 ：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190302180642.png">

</div>
<p>SJ文件包括了一些可变剪接的信息，还有3个Log文件，它们包括了一些处理过程的信，sample1_Log.final.out含有了一些统计信息，如下所示 ： <img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190302180709.png"></p>
<p>sample1_align.out.sam文件则是比对的结果，例如是否有错配，哪些reads比对上了。接着用复杂版进行比对 ， 这次用sample2进行复杂比对，如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">STAR  --runThreadN 5 --genomeDir arab_STAR_genome \</div><div class="line">--readFilesCommand zcat \</div><div class="line">--readFilesIn 02clean_data/sample2_paired_clean_R1.fastq.gz \</div><div class="line">02clean_data/sample2_paired_clean_R2.fastq.gz \</div><div class="line">--outFileNamePrefix 03align_out/sample2_ \</div><div class="line">--outSAMtype BAM SortedByCoordinate \</div><div class="line">--outBAMsortingThreadN 5 \</div><div class="line">--quantMode TranscriptomeSAM GeneCounts</div></pre></td></tr></table></figure>
<p>出现successfully表示比对结束，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190302180734.png">

</div>
<p>比对后的结果如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190302180754.png">

</div>
<p>与sample1的简单比对相比，sample2的复杂比对结果中，少了一个sam文件，而多了2个bam文件，其中一个是经过坐标转换的，形成的转录本文件（sample2_Aligned.toTranscriptome.out.bam），另外一个是排过序的bam文件（sample2_Aligned.sortedByCoord.out.bam）。此外，还有一个文件，叫sample2_ReadsPerGene.out.tab，这个文件所含的信息是，一个基因上含有多少个reads。可以查看一下这个文件，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190302180813.png">

</div>
<p>第一列是基因名称，后面3列是基因的reads数。</p>
<p>现在查看一下sample2排序后的数据，所用命令为samtools view 文件名，如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">samtools view sample2_Aligned.sortedByCoord.out.bam | head</div></pre></td></tr></table></figure>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190302180837.png">

</div>
<h4 id="转录组数据表达定量">转录组数据表达定量：</h4>
<p>处理原始比对文件 picard/samtools 将sam格式转换为bam格式 对bam文件进行排序 去除比对得分比较低的序列 如果需要（当质量不好时）可以去除重复reads</p>
<h5 id="定量表达的流程">定量表达的流程：</h5>
<p>STAR+RSEM：输出结果选择转录本定量或者基因定量；定量单位包括feature count,FPKM，TPM；操作相对复杂；先比对再定量</p>
<p>STAR+HTSeq：输出结果为原始read count；结果可用于差异表达分析;操作相对 简单；先比对再定量</p>
<p>Kallisto（free-alignment）：速度快省内存；基于转录本定量；不产生Bam文件，不方便基它后续分析（不进行比对，直接定量）。</p>
<p>新建一个文件夹，arab_RSEM</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">rsem-prepare-reference --gtf 00ref/Araport11_GFF3_genes_transposons.201606.gtf \ 00ref/TAIR10_Chr.all.fasta \ arab_RSEM/arab_rsem</div></pre></td></tr></table></figure>
<p>开始 运行，如下所示： <img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190302180858.png"></p>
<p>生成了7个文件，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190302180920.png">

</div>
<p>其中比较重要的是<code>arab_rsem.transcripts.fa</code>，这个文件提供了转录本的信息;接着，再新建一个目录 ，命名为04rsem_out，然后输入以下命令：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">rsem-calculate-expression --paired-end --no-bam-output --alignments -p 5 -q 03align_out/sample2_Aligned.toTranscriptome.out.bam arab_RSEM/arab_rsem 04rsem_out/sample2_rsem</div></pre></td></tr></table></figure>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190302180944.png">

</div>
<p>运行结束，一共生成 了3个文件 ，如下所示： <img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190302181002.png"></p>
<p>在这三个文件中，sample2_rsem.stat含有统计信息，这些信息可以用于进一步的分析，例如可视化。而sample2_rsem.genes.results则是基因的结果，可以查看一下，如下所示：</p>
<p><img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190302181027.png"> 其中，第1列是基因id，第2列是一个基因对应的转录本.</p>
<p>接着看一下基于转录本的信息，即文件sample2_rsem.isoforms.results的信息，如下所示： <img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190302181048.png"></p>
<p>第1列就变成了转录本的id，第2列就成了基因的id。 以上是STAR+RSEM的定量流程。</p>
<h5 id="用kallisto进行定量">用kallisto进行定量。</h5>
<p>如果没有安装kallisto，则用conda进行安装，安装后，新建一个目录，arab_kallisto，进入该目录，随后建立 索引 ，如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">mkdir arab_kallisto</div><div class="line">cd arab_kallisto</div><div class="line">kallisto index -i arab_kallisto ../arab_RSEM/arab_rsem.transcripts.fa</div></pre></td></tr></table></figure>
<p>开始运行，运行过程如下所示： <img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190302181108.png"></p>
<p>整个过程可能需要几分钟，最终会生成一个叫arab_kallisto的文件，这个文件就是后面进行定量的索引文件，如下所示： <img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190302181131.png"></p>
<p>现在再新建一个目录，用于存放定量的结果，如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">mkdir 05kallisto_out</div><div class="line">kallisto quant -i arab_kallisto/arab_kallisto -o 05kallisto_out/sample2 02clean_data/sample2_paired_clean_R1.fastq.gz 02clean_data/sample2_paired_clean_R2.fastq.gz</div></pre></td></tr></table></figure>
<p>这个过程很快，结果如下所示： <img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190302181200.png"></p>
<p>然后进入05kallisto_out目录，里面还有一个称为sample2的目录，进入，如下所示： <img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190302181221.png"></p>
<p>sample2目录里有3个文件，其中tsv文件是可读的，可以查看一下，如下所示： <img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190302181241.png"></p>
<p>数据差异分析：</p>
<p>STAR+featureCounts是STAR+HTSeq的升级版，在这一部分中，利用STAR的结果，通过featureCounts来计算。</p>
<h4 id="表达结果转换为表达矩阵">表达结果转换为表达矩阵。</h4>
<p>为了方便进行差异分析，我们需要根据前文提到的内容，用STAR的复杂分析，将所有的样本都转化为相应的BAM格式，原始数据有sample1和sample2，2个样本又有2个生物学重复，因此是4个数据，分别为sample1，sample1_2，sample2和sample2_2，转换后的数据如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190302181313.png">

</div>
<p>安装subread工具，<code>conda install subread</code> 随后进行分析，计算结果非常快，如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">featureCounts -p -a ../00ref/Araport11_GFF3_genes_transposons.201606.gtf -o out_counts.txt -T 6 -t exon -g gene_id sample*Aligned.sortedByCoord.out.bam</div></pre></td></tr></table></figure>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190302181354.png">

</div>
<p>03align_out中会出现2个文件，分别为out_count.txt与out_counts.txt.summary。可以查看一下out_counts.txt文件，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190302181417.png">

</div>
<p>这个文件就是定量的结果。</p>
<h4 id="将定量的结果转换为表达矩阵">将定量的结果转换为表达矩阵。</h4>
<p>根据前文的案例，将所有的样本都转化为表达矩阵，如下所示： <img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190302181439.png"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">rsem-generate-data-matrix *_rsem.genes.results &gt; output.matrix</div></pre></td></tr></table></figure>
<p>第1列是基因名称，第2到第5列是样本的整合，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190302181502.png">

</div>
<p>有的基因表达量是0,随后可以将基因表达量为0的基因去掉，并且将表头进行更改，</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">awk &apos;BEGIN&#123;print &quot;geneid\ta1\ta2\tb2\tb2\n&quot;&#125;&#123;if($2+$3+$4+$5&gt;0)print $0&#125;&apos; output.matrix &gt; deseq2_input.txt</div></pre></td></tr></table></figure>
<p>运行后，查看一下原来的行数 wc -l output.matrix与wc -l deseq2_input.txt，如下所示：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190302181525.png">

</div>
<p>上图中，去掉基因表达量为0的基因前，矩阵是37337行，去掉后为17971行，后续用deseq2_input.txt进行分析 。现在 建立一个06deseq_out的文件夹，进行差异分析，并将deseq2_input.txt复制过去：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">mkdir 06deseq_out</div><div class="line">mv deseq2_input.txt ../06deseq_out/</div></pre></td></tr></table></figure>
<p>接着用R语言进行分析，代码如下所示：</p>
<p>加载各种所需要的包： <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">getwd()</div><div class="line"># 获取当前目录</div><div class="line">setwd(&quot;D:\\netdisk\\biotest\\rnaseq&quot;)</div><div class="line"># 将工作目录定位到测序结果的目录</div><div class="line">source(&quot;http://bioconductor.org/biocLite.R&quot;)</div><div class="line"># 调用biocLite</div><div class="line">biocLite(&quot;DESeq2&quot;)</div><div class="line">biocLite(&quot;edgeR&quot;)</div><div class="line"># 安装分析数据所用的包</div><div class="line">install.packages(&quot;ggrepel&quot;)</div><div class="line">library(DESeq2)</div><div class="line">library(edgeR)</div><div class="line">library(ggrepel)</div><div class="line">library(ggplot2)</div></pre></td></tr></table></figure></p>
<p>导入数据： <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">input_data &lt;- read.table(</div><div class="line">  &quot;D:\\netdisk\\biotest\\rnaseq\\06deseq_out\\deseq2_input.txt&quot;,</div><div class="line">  header = TRUE, </div><div class="line">  row.names=1)</div><div class="line"># 导入数据，其中添加row.names=1是将第1列设为矩阵的名称</div><div class="line">input_data &lt;- round(input_data,digits = 0)</div><div class="line"># reads数都是整数，因此要保留整数部分，否则后面会出错</div><div class="line"></div><div class="line">input_data &lt;- as.matrix(input_data)</div><div class="line">condition &lt;- factor(c(rep(&quot;ctl&quot;,2),rep(&quot;exp&quot;,2)))</div><div class="line">coldata &lt;- data.frame(row.names = colnames(input_data),condition)</div></pre></td></tr></table></figure></p>
<p>构建差异分析矩阵： <figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">dds &lt;- DESeqDataSetFromMatrix(countData = input_data,            </div><div class="line">                              colData = coldata,</div><div class="line">                              design = ~condition)</div><div class="line"><span class="comment"># dds是分析矩阵</span></div><div class="line">dds &lt;- DESeq(dds) <span class="comment"># 进行差异分析</span></div><div class="line">res &lt;- results(dds,alpha = <span class="number">0.05</span>) <span class="comment"># 提取分析结果</span></div><div class="line">summary(res)</div><div class="line"><span class="comment"># 查看分析结果</span></div><div class="line"></div><div class="line">names(resdata)[<span class="number">1</span>] &lt;- <span class="string">"Gene"</span></div><div class="line"></div><div class="line">res &lt;- res[order(res$padj),]</div><div class="line">resdata &lt;- merge(as.data.frame(res),</div><div class="line">                 as.data.frame(counts(dds,normalized = <span class="literal">TRUE</span>)),</div><div class="line">                 by = <span class="string">"row.names"</span>,sort = <span class="literal">FALSE</span>)</div><div class="line"></div><div class="line">write.table(resdata,file=<span class="string">"diffexpr_results.txt"</span>,</div><div class="line">            sep=<span class="string">"\t"</span>,</div><div class="line">            quote = <span class="literal">F</span>,</div><div class="line">            row.names = <span class="literal">F</span>)</div><div class="line">plotMA(res)</div></pre></td></tr></table></figure></p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190302181551.png">

</div>
<p>M是纵轴，表示log2 fold change，A是和横轴，代表标准后的cont的平均值，红点表示padj值小于0.1，落在绘图区域外的值用小三角表示。</p>
<h4 id="p-value设定为na的情况">p-value设定为NA的情况：</h4>
<ol style="list-style-type: decimal">
<li>在同一行中，所有样品的count值都为0，这时baseMean为0，log2 fold change、p-value以及adjusted p-value都可设为NA</li>
<li>如果一行中包含了一个落在可信区域之外的极值，p-value 以及 adjusted p-value可设定为NA 。极值的确定可根据Cook距离，也可自行设定。</li>
<li>如果一行因为含有过低的mean normalized count而被自动独立过滤（automatic independent filtering）过滤掉了，这时可把adjusted p-value设定为NA</li>
</ol>
<p>构建maplot函数：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">maplot &lt;- function(res,thresh = 0.05, labelsig = TRUE, ...)&#123;</div><div class="line">  with(res, plot(baseMean, log2FoldChange, pch=20, cex=.5, log=&quot;x&quot;,...))</div><div class="line">  with(subset(res,padj&lt;thresh),points(baseMean, log2FoldChange, col=&quot;red&quot;,pch=20, cex = 1.5))</div><div class="line">&#125;</div><div class="line"></div><div class="line">maplot(resdata,main=&quot;MA plot&quot;)</div></pre></td></tr></table></figure>
<p>构建的maplot函数的绘图：</p>
<div class="figure">
<img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190302181622.png">

</div>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">resdata$significant &lt;- as.factor(resdata$padj&lt;0.05 &amp; abs(resdata$log2FoldChange) &gt;1)</div><div class="line"></div><div class="line">ggplot(data=resdata, aes(x=log2FoldChange, y = -log10(padj),color = significant)) +</div><div class="line">  geom_point()+</div><div class="line">  ylim(0, 8)+</div><div class="line">  scale_color_manual(values = c(&quot;black&quot;,&quot;red&quot;))+</div><div class="line">  geom_hline(yintercept = -log10(0.05),lty=4, lwd=0.6,alpha=0.8)+</div><div class="line">  geom_vline(xintercept = c(1,-1),lty=4,lwd=0.6,alpha=0.8)+</div><div class="line">  theme_bw()+</div><div class="line">  theme(panel.border = element_blank(),</div><div class="line">        panel.grid.major = element_blank(),</div><div class="line">        axis.line = element_line(colour = &quot;black&quot;))+</div><div class="line">  labs(title=&quot;Volcanoplot_biotest(by RVDSD)&quot;, x=&quot;log2(fold change)&quot;,</div><div class="line">       y=&quot;-log10(padj&quot;)+</div><div class="line">  theme(plot.title = element_text(hjust = 0.5))+</div><div class="line">  geom_text_repel(data=subset(resdata, -log10(padj) &gt; 6),</div><div class="line">                  aes(label = Gene),col=&quot;black&quot;,</div><div class="line">                  alpha = 0.8)</div></pre></td></tr></table></figure>
<p>ggplot2绘制的火山图： <img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190302181652.png"></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2018/03/19/Linux/Linux-虚拟机Ubuntu与windows的文件夹共享/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/03/19/Linux/Linux-虚拟机Ubuntu与windows的文件夹共享/" itemprop="url">虚拟机Ubuntu与windows的文件夹共享</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-03-19T12:02:00+08:00">
                2018-03-19
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Linux/" itemprop="url" rel="index">
                    <span itemprop="name">Linux</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  190
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  1
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <ol style="list-style-type: decimal">
<li><p>在虚拟机Vmware的菜单栏上，单击“安装VMware Tools”，随后在虚拟机中出现VMware-tools-distrib的文件，将其解压到Documnts文件夹，如下所示： <img src="http://ortxpw68f.bkt.clouddn.com/professional/180324/b3el81mc1k.png?imageslim" alt="mark"></p></li>
<li><p>打开解压后的文件夹，文件夹中有这些文件，如下所示： <img src="http://ortxpw68f.bkt.clouddn.com/professional/180324/AFjJDIh5bB.png?imageslim" alt="mark"></p></li>
</ol>
<p>３. 右键打开Terminal，输入<code>sudo ./vmware-install.pl</code>进行安装，一路回车就行。</p>
<ol start="4" style="list-style-type: decimal">
<li>重启电脑，若不重启电脑，虚拟机的设置选项中的共享文件夹是灰色的，无法进行选择。现在切换到这个选项卡，如下所示： <img src="http://ortxpw68f.bkt.clouddn.com/professional/180324/K94gGA2BGB.png?imageslim" alt="mark"></li>
</ol>
<p>选择“总是启用“，并添加相应的文件夹（我的文件夹是bitest），如下所示： <img src="http://ortxpw68f.bkt.clouddn.com/professional/180324/hF1Dic9f1I.png?imageslim" alt="mark"></p>
<ol start="5" style="list-style-type: decimal">
<li>打开Ubuntu中的以下目录 <code>/mnt/hgfs</code>就可以看到了共享的文件夹了。 <img src="http://ortxpw68f.bkt.clouddn.com/professional/180324/JGAeIDCKKB.png?imageslim" alt="mark"></li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2017/10/13/Literature/文献笔记-miRNA/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/10/13/Literature/文献笔记-miRNA/" itemprop="url">microRNA笔记</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-10-13T12:00:00+08:00">
                2017-10-13
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/文献笔记/" itemprop="url" rel="index">
                    <span itemprop="name">文献笔记</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  1,639
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  6
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="背景资料">背景资料</h2>
<p>MicroRNA (miRNA) 是一类由内源基因编码的长度约为22 nt的非编码单链RNA 分子,它们在动植物中参与转录后基因表达调控。大意就是，Micro RNA就是一条不会翻译蛋白的小的RNA。其单位是22nt，而不是22bp，因为nt是核苷酸，bp是碱基对，Micro RNA是用nt作为单位的，起码说明了Micro RNA是单链的。</p>
<h2 id="命名">命名</h2>
<h3 id="mirna的转录">miRNA的转录</h3>
<p>MiRNA首先是由MiRNA的host gene转录获得的，host gene转录，形成了primary microRNA（<strong>pri-MiRNA</strong>），然后通过Drosha–Pasha 复合体，形成了precursor microRNA（也就是<strong>pre-MiRNA</strong>），接着pre-MiRNA被Dicer剪切成双链的RNA，然后双链RNA被AGO1保护起来，其中一条链被降解，另一条链就被保留下来了。 <img src="http://ortxpw68f.bkt.clouddn.com/rnatrans.png"> 被降解的链一般被称之为“Passenger strand（过客链）”，这条链一般不容易被检测到，因为被降解了，这条链也被称之为星号链，一般会表示为“miR-×××*”。另一条链被称之为“Guide strand”，也就是先导链，这条就是我们通常所说的miRNA。</p>
<p>注：从图上就可以看出，Passenger strand和Guide strand链都是来源于一个基因，但它们两个还能互补。</p>
<h3 id="pri-mirna">pri-miRNA</h3>
<p><strong>pri-miRNA：</strong>长度从几百到几千个碱基不等，带有5‘帽子和3’polyA尾巴，以及1到数个发夹径环结构，如下所示<img src="http://ortxpw68f.bkt.clouddn.com/rna2.png">：</p>
<p>用上述的命名方法的话，比如我们说MiRNA-21和MiRNA-21*，就大概是这样的，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/m21.png">

</div>
<p>这个图上，我们可以看到MiRNA-21是产生在precursor microRNA的5’臂上的，而MiRNA-21*是产生于precursor microRNA的3’臂上的。“*”这个标志，主要告诉我们，这条链是“Passenger strand”，也就是miRNA-21产生的一个副产品，表达量超低，所以星号链经常被认为是没有功能的。</p>
<h3 id="mirna的5p端与3p端">miRNA的5p端与3p端</h3>
<p>但是，问题来了，2011年开始，有很多文献，开始表明miRNA星号链是有功能的（Widespread regulatory activity of vertebrate microRNA* species.，Yang，2011），星号链的功能，也有可能比先导链更为高级。那这样用“*”来标记就有点过时了。于是就产生了这样的命名方法，就是按照microRNA产生于precursor microRNA的5’臂或者是3’臂，来将miRNA表示成“MiR-×××-5p”或者“MiR-×××-3p”，这样的话miR-21，就被命名成为了“miR-21-5p”，它的星号链就被命名成为了“miR-21-3p”。之前还有用“-s”（sence）“-as”（antisence）来对先导链（先导链是-s）和星号链（星号链是-as）来命名，主要是dsRNA形成过程时的正向和反向。但由于很容易搞混，所以已经被取消了。可能看到老一点的文献中会有。</p>
<h3 id="mirna的编号">miRNA的编号</h3>
<p>pre-miRNA以“mir”命名，其编号以“MI”编号，如人的miRNA 122的前体ID为hsa-mir-122，Accession为MI0000442；而miRNA的成熟链以“miR”命名，其编号以“MIMAT”编号，如人的miR-122的一个成熟体的ID为hsa-miR-122-5p ，Accession为 MIMAT0000421。</p>
<p>因此，miRNA的命令示意图如下所示： <img src="http://ortxpw68f.bkt.clouddn.com/professional/180516/JCHALCKc33.png?imageslim" alt="mark"></p>
<h3 id="mirna命名方式的汇总">miRNA命名方式的汇总</h3>
<ol style="list-style-type: decimal">
<li>一个系统命名包含三部分内容，即物种，microRNA类别，序号。三者间用短线连接。</li>
<li>物种一般用三个小写字母表示，如hsa,mmu和rno分别代表人，小鼠和大鼠。</li>
<li>MicroRNA类别是指所命名的microRNA是pre-miRNA还是mature miRNA。pre-miRNA用mir表示，mature miRNA用miR表示。</li>
<li>序号为一阿拉伯数字，代表microRNA发现的先后。一般而言，数字越小，发现越早</li>
<li>高度同源的miRNA在No.其后加英文字母(小写,一般从a开始) 如miR-199a 和miR-199b</li>
<li>由不同染色体上的DNA序列转录加工而成的具有相同成熟体序列的miRNA，则在后面加上阿拉伯数字以区分, 如miR-199a-1和miR-199a-2；</li>
<li>如果一个前体的2个臂分别加产生miRNA，则根据克隆实验，在表达水平较低的miRNA 后面加“<em>” ，如miR-199amiR-199a</em>，或进行如下命名，miR-142-5p(也可命名为miR-142-s，表示从5’ 端的臂加工而来)和miR-142-3p(也可命名为miR-142-as，表示从3’端的臂加工而来)；</li>
<li>确定命名规则之前发现的miRNA，如let-7，则保留原来名字。</li>
</ol>
<h2 id="作用机理">作用机理</h2>
<p>作用机理的图片如下所示： <img src="http://ortxpw68f.bkt.clouddn.com/professional/180516/9JIG1HBfcd.png?imageslim" alt="mark"></p>
<blockquote>
<p>要说MiRNA具体是咋起作用的？好吧，给你举个例子，你感受一下。普通的mRNA就好比是一条高速公路，路上会有很多会排出尾气的汽车（核糖体，它们在mRNA上边走边翻译蛋白），一条高速路上会有很多辆车（多聚核糖体Polysome），车越多、开得越快，尾气就越大（蛋白表达量就越高），这个时候，在路快到尽头的地方（mRNA的3’UTR上）就出现了一个交警（MiRNA聚合一些蛋白的RISC，RNA-Induced SilencingComplex，RNA诱导沉默复合体），他稳稳地站在路的最后（通过RISC中的MiRNA与3’UTR互补，结合到mRNA的3’UTR上），整个车队就停下来了，尾气也没了（蛋白表达降低）。好了，现在也明白为啥过表达MiRNA之后下游基因的mRNA变化不大，但蛋白会有变化了吧？因为警察是不会拆路的……</p>
</blockquote>
<p>比较详细的图</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/rna6.jpg">

</div>
<h3 id="mirna种子区seedregion">miRNA种子区（“seed”region）</h3>
<p>5’端2-8个碱基被称为种子序列 <img src="http://ortxpw68f.bkt.clouddn.com/rna3.jpg"></p>
<h3 id="mirna与mirna靶标的结合">miRNA与miRNA靶标的结合</h3>
<p>主要有两类：5’-dominant Site和3’-compensatory Site。 1. <strong>5‘显性位点：满足经典种子区2-8完全互补结合的方式</strong>。如下所示<img src="http://ortxpw68f.bkt.clouddn.com/rna4.jpg">： 2. <strong>3’端补偿位点：5‘端并非满足2-8经典完全互补，知识部分互补，这样3‘端补偿位点结合，增强了miRNA与标靶结合稳定性，如下所示：5’-dominant Site和3’-compensatory Site，如下所示</strong><img src="http://ortxpw68f.bkt.clouddn.com/rna5.jpg"></p>
<h2 id="rna的靶点预测">RNA的靶点预测</h2>
<h3 id="工具汇总如下">工具汇总如下</h3>
<p>miEAA 网址：https://ccb-compute2.cs.uni-saarland.de/mieaa_tool/ 分析microRNA的功能、信号通路、疾病等进行分析</p>
<p>YM500v2： http://ngs.ym.edu.tw/ym500v2/index.php</p>
<p>Starbase（http://starbase.sysu.edu.cn/index.php） 交叉预测网站，既可以通过靶基因预测microRNA也可以通过microRNA预测靶基因。</p>
<p>miRPathDB（https://mpd.bioinf.uni-sb.de/overview.html） 查询参与通路内调控的miRNAs，包含了人、鼠两类数据。</p>
<p>mirbase（mirbase：http://www.mirbase.org/）</p>
<h2 id="参考资料">参考资料：</h2>
<ol style="list-style-type: decimal">
<li><a href="https://mp.weixin.qq.com/s?__biz=MzA3ODU1NjUyNw==&amp;mid=404311107&amp;idx=1&amp;sn=85308a8ad9806f65072de4c8ed79f54c&amp;scene=1&amp;srcid=0314tK0Lw7HkKyoJRoAjwPmg#rd" target="_blank" rel="external">miRNA到底是怎么命名的？</a></li>
<li><a href="https://mp.weixin.qq.com/s?__biz=MzA3ODU1NjUyNw==&amp;mid=200526001&amp;idx=1&amp;sn=ae82f47928f8cd4c519c89f69ab8d103&amp;scene=21#wechat_redirect" target="_blank" rel="external">Micro RNA，从一窍不通到略知一二</a></li>
<li><a href="http://mp.weixin.qq.com/s?__biz=MzA5ODQ1NDIyMQ==&amp;mid=2649602388&amp;idx=2&amp;sn=6097b6c76944a795a628bce7fbbac934&amp;chksm=888846f6bfffcfe0a579d0a9bd1dd24083a28937c4057db9e25abd3c006858b8d2675690f5ae&amp;mpshare=1&amp;scene=1&amp;srcid=0901fXzOX8InCPG3nb2oSiDS#rd" target="_blank" rel="external">搞懂RNA命名，miRNA、lncRNA、circRN不再傻傻分不清</a></li>
<li><a href="https://mp.weixin.qq.com/profile?src=3&amp;timestamp=1507870340&amp;ver=1&amp;signature=y-Qin6PEYzPl9NMOQjgJYLIB1ca8JQ1JnnITRYLuVFI*N2jLLUI74CFzvPaSyi-PVLDYcUEOeEIiXXC4QtOf4w==" target="_blank" rel="external">艾博思生物（公众号： ibsbio）</a></li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2017/10/08/BioItem/生信-转录组学习笔记08差异基因结果注释/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/10/08/BioItem/生信-转录组学习笔记08差异基因结果注释/" itemprop="url">转录组学习笔记08-差异基因结果注释</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-10-08T12:00:00+08:00">
                2017-10-08
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/生信实战项目/" itemprop="url" rel="index">
                    <span itemprop="name">生信实战项目</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  0
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  1
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/9/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/9/">9</a><span class="page-number current">10</span><a class="page-number" href="/page/11/">11</a><span class="space">&hellip;</span><a class="page-number" href="/page/16/">16</a><a class="extend next" rel="next" href="/page/11/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">RVDSD</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">159</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">10</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">45</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          <div class="links-of-author motion-element">
            
          </div>

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

<div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">RVDSD</span>

  
</div>



<div class="powered-by">
<i class="fa fa-user-md"></i><span id="busuanzi_container_site_pv">
  本站访客数:<span id="busuanzi_value_site_uv"></span>
</span>
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.3</div>




<div class="theme-info">
  <div class="powered-by"></div>
  <span class="post-count">博客全站共605.2k字</span>
</div>

        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.3"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.3"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.3"></script>



  


  




	





  





  












  





  

  

  
  

  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config("");
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="custom_mathjax_source">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->
  


  

  

</body>
</html>
