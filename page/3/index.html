<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.3" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.3">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.3" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta property="og:type" content="website">
<meta property="og:title" content="RVDSD的个人笔记本">
<meta property="og:url" content="http://rvdsd.top/page/3/index.html">
<meta property="og:site_name" content="RVDSD的个人笔记本">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="RVDSD的个人笔记本">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.3',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://rvdsd.top/page/3/"/>





  <title>RVDSD的个人笔记本</title><!-- hexo-inject:begin --><!-- hexo-inject:end -->
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">RVDSD的个人笔记本</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">学习过程中的输出</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2018/06/07/BioStatistics/生物统计-StatQuest学习笔记06-分位数及其应用/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/06/07/BioStatistics/生物统计-StatQuest学习笔记06-分位数及其应用/" itemprop="url">StatQuest学习笔记06——分位数及其应用</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-06-07T12:10:54+08:00">
                2018-06-07
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/生物统计/" itemprop="url" rel="index">
                    <span itemprop="name">生物统计</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  2,751
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  10
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="前言主要内容">前言——主要内容</h2>
<p>这篇笔记的内容是StatQuest视频文件的第23，24，25。文件第23讲的是分位数(quantiles)与百分位数(percentiles)；文件24讲的是QQ图；文件25讲的是分位数的均一化。</p>
<h2 id="分位数">分位数</h2>
<p>先看一个案例，我们检测了一些基因的表达情况，下图是第1个基因的表达数据：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/C5efDi5GHF.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>最终，我们检测了15个基因的表达情况，它们的数据如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/FbebD6AEk7.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>从图上我们可以看出，坐标中一共有15个点，如果我们从下向上数，数到第8个点时，划一条线，这个条的上方有50%的点，即7个点，下方也有50%的点，即7个点，这个点就叫做中位数（median），如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/mk1IHI58ei.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>从技术角度来讲，中位数就是一个百分比数（quantile），因为它把这一组数据划分成了2个部分，每部分所占的点数占总数目都是相同的，有时候，这个点也被标为0.5，也时候也被标为50%。</p>
<blockquote>
<p>中位数(median)是将n个变量值从小到大排列，位置居于中间的那个数。当n为奇数时取位次居中的变量值，当n为偶数时，取位次居中的两个变量值的均值。</p>
<p>百分位数(percentile)是一种位置指标，用Px来表示，读作第X百分位数。一个百分位数Px将全部产变量值分为两部分，在Px处若无相同变量值，则在不包含Px的全部变量值中有X%的变量值小于它，有(100-X)%变量值大于它。故百分位数是一个界值，其重要用途是确定医学参考值范围（reference range）。中位数实际上是第50百分位数。</p>
<p>——《医学统计学》（第四版）.孙振球.2014</p>
</blockquote>
<p>从下图中我们可以看到，这个中位数的值为4.5，也就是说第50分位数的值为4.5，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/Fgmb94Al6i.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>现在我们再添加两条线，再加上前面的50%分位数的线，这三条线就把整个数据分成了4部分，其中最下面的那条线叫0.25或25%百分位数，因为大概为25%的点低于它，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/CjCaci7h1b.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>最上面的线叫75%百分位数，因为约有75%的点低于它，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/hK1Jm20lJ2.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>通常来说，分位数就是那些能够把数据集分为相同区间组的线，这是技术上的定义。而百分位数（percentiles）则是指那些能够把数据集分为100份相同区间的分位数（quantiles），不过在实际运用中，这个术语非常灵活。例如我们把50%百分位数称为中位数，把75%百分位数称为第75百分位数（这就与我们引用教材中的命名相同了），如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/Lcb75988CI.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>最低下的数字，也就是最小的数字，称为0%百分位数，也叫第0百分位数，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/892elmg3fJ.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>倒数第2个数字则是第7百分位数，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/b4D04fdG2d.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>在R语言中，有专门计算分位数的函数，就是<code>quantile()</code>，它提供了9种不同的方法来计算分位数，其结果可能略微有所不同。这就说明，如果你的数据集很小，那么这个函数按照不同方法计算出来的分位数就有很大的同，如果数据集很大，那么计算结果就大体相同。</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/adcHLIcEI0.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h2 id="qq图">QQ图</h2>
<p>QQ图的全称为Quantile-Quantile图，也就是分位数的图，它研究的是数据是否符合正态分布。还以前面的基因表达为例来说明一下，我们检测了15个基因表达值，这些数据服是否服从正态分布？这就需要QQ图来回答，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/KDfCIcbih3.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>第一步：计算出每个点的百分位数，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/Bh6HHGa9Gm.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>第二步：绘制出正态分布曲线，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/8lBcEgEKg8.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>第三步：将同样的分位数映射到这个正态分布曲线上（我的理解就是某个数字，例如0.6，它的分位数是0.07的话，那么就在正态分布曲线上找到相应的一条直线x，这条直线与正态分布曲线构成的左边面积为0.07，其余的数字都这么做），如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/La9igA8E9B.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>数据集中有15个点，它们把这批数据分成了相同区间的组（equal sized group）（注：我的理解就是，这个相同区间指的是分位数的比，而不是实际值，例如我有100个点，这个点从小到大排列，每个点都会有自己相应的分位数，如果把按它们各自的分位数进行划分，那么可以把100%划分为100份1%），那么这些数据对应的分位数都投射到正态分布区间上，就是下面的这个图，从图上可以知道，中间部分的直线间隔小，两边的直线间隔长，这个很好理解，因为划分是按面积进行划分的，面积代表了概率，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/aIeF92g7bE.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>对于正态分布曲线来说，“相同区间的组”（equal sized groups）意味着一个数据在每组中的概率是相同的（一组就是由x轴，正态分布曲线，两侧的红线构成的狭长区域）：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/i162da0eBi.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>现在就可以绘制QQ图了，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/lclf3IBclk.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>QQ图含有2个坐标，横坐标是正态分布的x轴，纵坐标是原始数据的分位数，现在我们绘制原始数据中最小的那个点，它的数值是0.6，这个数值对应的就是纵坐标，它的这个值所对应的分位数在正态分布曲线上的点是x轴上-1.5的点，此时将它们绘制到QQ图上，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/h854FF2J76.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>接着，把所有的点都绘制到QQ图上，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/40l6692Jde.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时，我们看一下这些点是否与下面红色的直线重合（这个红色的直线其实就是y=x，如果数据符合正态分布，那么它就重合），如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/0edaBDCFeF.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>这些点貌似与红色的线重合得并不多，我们再看一下这些数据与另外的一种分布（这种分布就是均匀分布，即uniform distribution）的比较，第1步，求出各个数据点对应的分位数，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/36ifhJ2mdG.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>第二步：绘制出相应均值分布的曲线，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/L7KL1eDiCH.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>第三步：将原始数据对应的分位数投射到这个曲线上：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/e4kBaCJc5d.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>第四步：绘制QQ图，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/KL4EBdmHfD.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>我们此时发现，这组数据与均值分布对应的红色直线比较匹配，它就更加杂得均值分布，下图是数据与正态分布的QQ图的比较：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/HA0Ekm3KaI.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h2 id="比较两组数据">比较两组数据</h2>
<p>现在我们再来看一个案例，在这个案例中，我们比较这两组数据，其中第二组数据比较少，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/hjf32C9ebj.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>第二组数据只有4个数字，其实就是4个四分位数（我觉得视频中有问题，四分位数分别为25%，50%，75%的百分位数，只有3个，视频中却说有4个），因此我们也可以找出第一组数据中相应的四分位数，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/0FJLIDeffb.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>在第一组中，与第二组第一个数字（也就是3.8）百分位数相同的是2.5，那么就在QQ图 纵坐标的位置画一条直线（这个直线是y=2.5，即下图的黑色虚线），此时在横坐标上画出x=3.8的直线（下图红色虚线，代表第二组中的3.8），两个直线交叉就是第1个点在QQ图上的位置，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/5374e6mI0D.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>然后依次画出第二组中4个点与第一组中相应点构成的点，连成直线，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/Bgc7L3E9La.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>由于上图中QQ图的点很少，很难判断这两组数据是否是相同的分布，因此为了判断两组数据是否服从同样的分布，需要收集更多的点。</p>
<h2 id="分位数的标准化">分位数的标准化</h2>
<p>先看一个案例，例如我们手中有一批芯片（基因表达芯片，非集成电路）的数据，芯片有以下这些特点：</p>
<ol style="list-style-type: decimal">
<li>检测样本中基因活跃的程度（其实就是基因表达量的高低）；</li>
<li>芯片检测基因的活跃程度是通过不同颜色的光来达到的；</li>
<li>如果你检测芯片的仪器的光源更亮，那么这批数据就比其他的仪器检测到的信号更强。</li>
</ol>
<p>由于芯片的这些特点，我们就需要对芯片的数据进行标准化，从而研究不同样本之间的差异是由技术重复引起的，还是实验因素引起的，芯片数据标准化的过程跟生物的关系不大，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/ig2DDi48gg.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>我们来看一下原始数据，下图中的不同颜色表示不同的基因，这个数据中的每个点已经转换为了光强的密度值（intensity values），如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/C5hblj7KLD.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>下面是每个样本的均值，</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/kiDAIi8IaK.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>每个样本的均值都不同，这表明，我们需要校正所有光的强度，分位数标准化（quantile normalization）就是为了解决这个问题的，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/iemjHHEG75.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>第一步，我们先看每个样本中亮度最强的那个点，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/1ejfmmD3JC.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>第二步：计算这3个点的均值，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/I2FGcHcHJL.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>第三步：把这些均值投射到一个新的坐标轴上，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/2FhGmiCGbh.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>那么，样本1中强度最大的那个点（就是蓝色的点）的分位数标准化的值的就是上面我们计算出来的均值，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/B3LL2KLKhL.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>样本2和样本3中那两个点也是如此，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/9md269cb34.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>第四步：现在把亮度强度次亮的点再投射到这个新的坐标轴上，方法与前面的一样，也是先救出均值，然后再投射，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/Figi3gkK7c.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>所有的点都按照这样处理，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/KBddbLEaG4.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>经过这样的分位数标准化后，每个样本的数据基本上都一样了，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/l1lH0kG0ja.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>并且，每个样本中不同基因的原始次序也得到了保留，sample 1中的红色基因原来是最后一个，经处理后中，还是最后一个，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180609/EeEf0Lhib2.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>以上的整个过程就是分位数标准化的整个过程，因为标准化后的数据与原始数据都有相同的分位数。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2018/06/04/BioStatistics/生物统计-StatQuest学习笔记04-拟合/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/06/04/BioStatistics/生物统计-StatQuest学习笔记04-拟合/" itemprop="url">StatQuest学习笔记04——拟合</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-06-04T12:10:54+08:00">
                2018-06-04
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/生物统计/" itemprop="url" rel="index">
                    <span itemprop="name">生物统计</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  4,973
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  17
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="前言主要内容">前言——主要内容</h2>
<p>这篇笔记是StatQuest视频的第13到第15，文件13内容是拟合度；文件14是内容是线性回归；文件15是局部加权最小二乘法。</p>
<p>在这篇笔记中，我们需要弄清楚几个问题：</p>
<ol style="list-style-type: decimal">
<li>什么是相关系数（correlation，简称为R），相关系数的值有什么意义？</li>
<li>我们为什么关注R的平方？</li>
<li>最小二乘法的原理。</li>
</ol>
<h2 id="第1个案例r的平方">第1个案例：R的平方</h2>
<p>先看一个案例，下图是小鼠的体重与小鼠编号的散点图，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180606/I88BACB2C7.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>红色的是点是小鼠的体重，黑色的横线是平均值。x轴上是小鼠的编号，如果我们要查看这组数据的变异（variation），我们就把每只小鼠的体重送去平均值，然后再平方，再加起来（这个在统计学上叫离均差平方和，英文是sum of squares of deviations from mean），用数学公式就是下面的这个样子：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180606/Hj239BG5DE.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时我们再找一种方法绘制这个散点图，此时将x轴坐标改为小鼠的大小，y轴还是小鼠的体重，此时散点图就是下图这个样子：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180606/D9bfjL9i7g.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时，它的平均值还是不变的，还是如下图的样子：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180606/7bmGhLBi4J.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>从这个图上，我们直观上可以看出，小鼠的体重貌似是随着小鼠的大小而增加的（这个很好理解，不解释）。此时，我们可以再想一下，我们是否能够通过小鼠的大小来预测它的体重？我们画一条线，大致符合这些数据点的分布，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180606/Hd2jFhEd2l.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时，如果我们已知一个小鼠的大小（size），我们就能够根据这条直线大致知道这个小鼠的体重。但是此时有个问题，这条直接是否能够比平均值代表这批小鼠的大小与体重的关系？其实是可以的，我们有个指标，就是R的平方，它能判断某条直线是否代表了小鼠的大小和体重的关系，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180606/F4aD1GFGBE.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时我们可以计算这个直线与均值的差异，其实就是计算<span class="math inline">\({R}^2\)</span>（顺便说一句，写统计学笔记，免不了要使用公式，现在markdown中对公式支持的比较好的是mathjax语法，而为目前来看，Typora（最新版），为知笔记对mathjax语法支持都不错），计算公式如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180606/AKlI1J7Jke.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>通过计算，var(mean)=32,Var(line)=6，根据公式，<span class="math inline">\({R}^2\)</span>如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180606/GFLkH7010k.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>注：<span class="math inline">\({R}^2\)</span>在统计学上叫决定系数（determination coefficient），它反映了因变量的变异能够被模型（纳入的自变量）所解释的比例，也就是模型解释的变异占总变异的比例，此案例中，这条直线能够解释81%的体重与大小的关系。</p>
<p>这个案例中讲的情况我们在用BCA测蛋白浓度法时经常使用，x轴是吸光度，y轴是蛋白含量，通过做曲线，找出吸光度与蛋白浓度的关系，曲线做得好，R的平方能达到0.99，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180606/E05A82dC09.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h2 id="第2个案例">第2个案例</h2>
<p>再看一个案例，在这个案例中，x轴是小鼠嗅岩石所花的时间（我不太清楚这是什么实验，照字面翻译了），y轴是小鼠的体重，它的散点图以及计算的R平方如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180606/AD9j5DJ4c5.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>结果显示，R的平方是6%，它也就是说小鼠嗅岩石所花的时间与小鼠的体重关系不大，这条蓝色只能解释6%的变异。</p>
<h2 id="r平方的意义">R平方的意义</h2>
<p>因此，我们在做某条直线来表示两个变量之间的关系时，如果R的平方是0.9，那么我们可以说，这条直接可以解释这两个变量90%的变异。如果是0.01，那么我们可以说，这条直接只能解释这两个变量1%的变异，也就是说这两个变量没什么关系。</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180606/910Bd7Cgak.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h2 id="r与r的平方">R与R的平方</h2>
<p>那么什么是R，什么是R的平方呢？什么时候使用这两个参数？看下图的解释：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180606/78KEgaKB9J.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>通过情况，评估一个直线的好坏，都是看R平方的，它直接代表了变异，更好解释直线的拟合好坏，而不是看R（很多统计软件中也都是这样）。例如一个直线的R是0.7，另外一个是0.5，那么转换为R的平方，肯定是前者比后者要好，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180606/4B22cJ13Fh.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>但R的平方也有局限，就是R的平方都是正值，没有负值，它不代表两个变量的具体关系，也就是说，这两个变量是正相关（一个增加，另外一个也增加），还是负相关（一个增加，另外一个减少），此时就要看R了，R是正值，表示正相关，R是负值，表示负相关。</p>
<p>结论就是，R的平方表示直线的拟合程度，R表示了两个变量变化的关系。</p>
<h2 id="线性回归">线性回归</h2>
<p>先看一个场景，下图是某个散点图：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180606/2a53hIiL2J.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时我们要绘制一条直线来代表这些点，这些直线可以有多条，就像下面的这些直线一样：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180606/DJIKHe7aLC.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>但此时有个问题：哪一条直线最合适？</p>
<p>问题解决思路如下：</p>
<p>第一，假如我们先随便找条直接，例如y=3.5这条直线，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180606/0JE9m2bal5.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>我们可以计算这些点与这条直线的接近程序，例如第一个点（x1,y1），如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180606/gI7lG006j2.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>那么第2个点的距离就是这个样子：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180606/f1F3dF4ijH.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>再接着，计算第3个，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180606/3C19h8gAAH.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>还有第4个点：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180606/9c527i8590.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>这第4个点与前面3个点不太一样，因为，b-y4是一个负值，第5个点也是如下：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180606/C23lIeDkG8.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>第4个点与第5个点和前面的点不太一样，因为前面的b-y1，b-y2，b-y3都是正值，那么最终计算这些点与这个条直接的距离总和时，会相互抵消，为了避免这个问题，可以将所有的数值平方，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180606/cfkahca5D4.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时，计算一下这些值的平方，数值为24.62，这个数值在统计学上叫残差平方和（sum of squared residuals，简称SSE），残差（residual）指的是实际数据与拟合曲线的差值平方的和，这个值越小，表示实际的数值离拟合曲线的距离越小，也就是越能代表这些真实的数据，求出的这条曲线的方程的过程叫线性回归（Linear regression）。</p>
<p>此时，我们再换条曲线试试，就是把上面的这条曲线旋转一下，再计算一下SSE，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180606/fcglJic4Bd.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>它的SSE是18.72，貌似比第一曲线更好，再旋转一下看看：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180606/7A5CI3h038.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>它的SSE是14.05，貌似更好，再旋转一下试试：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180606/2h8fH1gh8j.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>这个SSE是31.71，貌似就比较差了。此时我们再看一下常规的曲线方程，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180606/m2kEF7kaem.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>其中，a代表这条曲线的斜率，b代表截矩。我们要寻找最佳的拟合曲线必然是SSE最小的那条。而在统计学中，我们经常把下面的公式叫做残差平方和，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180606/B5IBG15h4l.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>由于我们寻找这条曲线（寻找这条曲线，其实就是寻找这条曲线的斜率与截矩）的方法是通过寻找最小的SSE这个原理实现的，因此，这种求直线的方法就叫做最小二乘法（Least squares）（为什么这种方法的中文译名与英语差异这么大？因为平方在中国古代的数学中就叫二乘，因此这种方法就翻译成了最小二乘法），如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180606/JDmgEJ3HBl.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>如果我们将上面的这些曲线以及旋转后的曲线的SSE绘制出来，我们就会得到下面的这个图形：<img src="http://ortxpw68f.bkt.clouddn.com/professional/180606/HBiI9JEALI.png?imageslim" alt="mark"></p>
<p>x轴上是各种曲线的形状（它们拥有不同的斜率与截矩），y轴是SSE。上面的散点图的本质其实也是一条曲线（数学上的曲线包括弯曲的线与直线，它是点运动的集合），如何找到最佳拟合的曲线（这条曲线指提原始数据的拟合曲线）呢，就是对曲线（这里的曲线指的上图的这条曲线，也就是不同斜率和截矩下的各种曲线的SSE的集合）求导（derivative），那么导数为0时，也就是SSE最小（导数的推导与意义可以参见高中数学），如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180606/IlaCmBLlL0.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>过程如下：</p>
<p>先看第一个点：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180606/60f84gccKJ.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>再看第二个点：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180606/8IaamD6I56.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>第三个点：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180606/1bHhicc2Da.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>在第三个点处的导数斜率为0（这点很重要），还有这些点：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180606/dgi53mCaee.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>再回头看第3个点：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180606/iaa56BhjLi.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>我们只需要记住，在对原始数据进行拟合时，曲线的旋转代表了不同的斜率a和截矩b。</p>
<p>在计算最佳的拟合曲线时，我们还使用一种三维坐标系（x轴是斜率，y辆是截矩，z值是SSE），如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180606/h661AB8AB2.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>那么如果我们选定一个截矩，然后绘制不同斜率对应的SSE，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180606/388D924jFa.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>接着，我们按照同样的方法绘制大量不同截矩与斜率的曲线对应的SSE，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180606/k9f3kclAIG.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>然后计算这些曲线的斜率与截矩的导数，然后找出导数为0时的斜率与截矩。这种方法的计算过程通常是由计算机完成的。最终求出的线性回归方程如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180606/68cK9g8L4G.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h2 id="局部线性回归">局部线性回归</h2>
<p>现在我看一个散点图，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180606/L0iI9gf5kk.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>我们如果对这散点进行拟合，困难貌似比较大，因为这些散点图不可能用一个方程表示的直线进行拟合。因此，我们为了拟合这种散点图，就要换一种方法，这种方法的核心思想是：</p>
<p>第一，将这些散点通过一个滑动的窗口将它们分成更小的部分，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/2754EGKj3D.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>第二，在每个滑动窗口中，对这一小部分数据进行拟合，求出它的线性回归方向，此时，就跟线性回归一样了，最终再把这些线性回归方程汇总起来，其本质我觉得就是微积分的思想，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/2im7m9Il3g.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>下面是具体的思维过程，上面的散点图有点复杂，我们先看一个比较简单的散点图，我们把下面的散点图以x轴的5个单位为基本单位进行窗口的划分，那么第一个滑动窗口中含有5个数据点，就是图中绿色方框圈起来的部分，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/Hi5di4l7Aa.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时，我们把这个方框中的第一个点称为这个窗口的焦点（focal point），如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/D4HI84ab12.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>在第一个滑动窗口的这5个点中，第2个点就是最接近焦点的点，它距离焦点是1个单位，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/8hDacHf4Hk.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>第3个点就是第2个最接近焦点的点，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/iEBja97flL.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>同理，还有第3个，第4个最接近焦点的点，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/IB930je8bl.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时，我们对这5个点做一个“加权最小二乘”（weighted least squares），离焦点最近的点它的权重（weight）就大（权重可以理解为影响拟合曲线的影响力），如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/f8mB03iJ4f.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>由上述描述可知，焦点的权重最大，而其余点的权重与其跟焦点的距离成反比，最远的点（也就是上图中4号点）权重最小，此时，我们先做一个普通的最小二乘法线性回归，此时的回归并不考虑各个点的权重，它的曲线如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/7K4mKbHBJa.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>我们再做一个加权后的线性回归，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/6Lkc9Je5g7.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>从图中可以知，最后一个点的权重小，它对于这线曲线的斜率影响不大，并不会把斜率拉高，此时我就对这5个数据点有了一条拟合曲线，此时，我们把第1个点（也就是上图黑色的点）的x轴坐标代入这个拟合的曲线方程，求出一个新的点的坐标，这个新的点的坐标就是我们最终要拟合的曲线上的点，就是下图的红叉所在位置（虽然这个红叉在图片上与第1个点重合，但它们不是一个点），如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/ckL3L8f6HJ.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>我们再继续。此时我们把第2个点当作是焦点，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/lDfA33l186.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>这个滑动窗口中还是含有原来的4个点，但是离焦点最近的点的已经变成了2个，它们离焦点是1个单位，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/BgKfBdCHiH.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>接着，离焦点次近一点的是离焦点有2个单位的点，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/KGaial5089.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>最远的点，是距离焦点有3个单位的点，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/iBJj3FEl1m.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时，我们使用加权最小二乘法时，焦点权重最大，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/faL4m0i9L7.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>两边的两个点权重次之，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/f5Dc4il0m7.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>最远的点，权重最小，此时我们画出拟合曲线，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/B6f5D80Kjm.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时，我们利用这个方程求出最终要拟合曲线上的点（这个点的x轴坐标与上面第2个点的x轴坐标一样，但y轴坐标不一样），因此，这个红叉所在点（虽然图片上看上去这个红叉是与第2个点重合，其实是不是重合的）是我们最终要拟合的曲线上的第2个点，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/9ieKF2IlFb.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时，我们再研究第3个点，将它当成焦点，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/G31G6e8hii.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>方法如同第1个点和第2个点一样，以第3个点为焦点拟合的曲线如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/DaGKkifCj7.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>其中，红叉的地方，就是我们最终要拟合的曲线上的点，接着，我们看第4个点，如果第4个点是焦点的话，此时有点不太一样，这个滑动窗口与前面第1，2，3个点的窗口都有所不同（1，2，3个点的窗口其实是一样的，因为距离它们最近的5个点都相同），而第4个点的话，离它最近的4个点（一个窗口一共是5个点），并不包括第1个点，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/I2K851gC1H.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>离第4个点最近的两个点在它的两边，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/Fd52hD8FhJ.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>其次，离它最近的两个点是稍远一点的，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/0EHHhC7h7L.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>从图上可知，我们划分窗口宽度的时候，只考虑x轴，并不考虑y轴。此时，我们采用加权最小二乘法进行拟合，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/3jfdDA4b2C.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>然后，根据这条曲线，计算我们最终要拟合曲线上的点，它的求法是将第4个点的x轴坐标代入上面的曲线方程，求出这个拟合曲线上的点，如下所示（此时的这个点与第4个点并不重合，只是x轴坐标一样）：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/25GhCh0dfF.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时，我们再看一下我们前面求出的新的点，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/kEL3LDjl2m.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>按照这个方法，我们划出一个窗口，然后求出这个窗口中的拟合曲线，然后计算这个窗口中焦点对应的最终拟合曲线上的新的点，最终，求出的所有新的点如下图中的红叉所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/L9ddJi9mf5.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>从下面的图我们可知，黑色椭圆中的这些点是被最上面的点拉上去了，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/e3IL99dLg9.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>而最上面的这个点就是个离群点（outliner），为了避免这个点对整体拟合效果的影响，我们需要根据这个点距离原始点和新生成点的距离，对这个点额外添加一个权重，如下所示：<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/e102G9aG6J.png?imageslim" alt="mark"></p>
<p>从上面的图还可以知道，大括号标中的点的权重比较低，因为原始点与新生成的点距离比较远。而下面的这个点权重更低，因为它离得更远，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/8LiGDcHKHB.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>根据新生成的点与原始点之间的距离，我们可以计算出新的权重，这样我们此时就有了两组权重，</p>
<p>第一组就是基于每个窗口中，每个点距离焦点距离的原始权重，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/KgAkeA274i.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>第二组就是基于原始点与新生成点的距离的权重，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/H7klAefk8j.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>根据这些权重调整了原始点与新生成点的位置后，我们就可以看到“新-新”的点（new-new point），从下图中的第4个点和第5个点就能明显看出来，它们之间的距离缩短了，如下所示，利用这些调整后的点绘制曲线，就会显得更加光滑。</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/Bh0A3adHCH.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>我们把所有的点都进行调整，我们就会得到一个完美，平滑的回归曲线，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/10HH8A1kEL.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>不过，这个调整过程要不断地进行几次才能得到理想的平滑曲线，以下就是最终得到的曲线：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/1cAB3l9K6d.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h3 id="另外的思考">另外的思考</h3>
<p>我们试想一下，在第1个窗口中，我们采用回归曲线是直线，其实它也可以做成抛物线，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/m01AKA5Bbi.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>我们先看一个案例，还是最初的散点图：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/A6AllAK8FG.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>下图的黑色曲线是在每一步都采用了加权最小二乘法得到的曲线，蓝色曲线是在每一步都采用了抛物线进行拟合的曲线：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/J7lbh4a9l2.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>从图中我们可以看到，貌似划线的拟合效果更好。在而R语言中，如果只想拟合为常规的这种直线，可以采用<code>lowess()</code>函数，如果想要拟合为抛物线或直线，可以采用<code>loess()</code>函数，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/a9elCdCeI9.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>在Ｒ中，使用<code>loess()</code>函数还能绘制出曲线的置信区间，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/aDH2Lb7cem.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>关于滑动窗口的设置取决于用户自身，滑动窗口的划分可以按照精确的单位进行划分，也可以按照百分比来进行划分，下图我认为是使用了5%这个比例来进行划分的（从图上大概可以看出来，5%的比例范围内，这个曲线是直线）：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/FAbeGjJ88h.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>下图的蓝色拟合曲线是使用了总数据点的三分之一进行窗口划分的：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/d72h86EFj5.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>下图的红色曲线是使用了R语言中<code>loess()</code>这个函数的默认值进行拟合的，而它的默认值是75%的数据点，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/E16gaHkf5D.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h3 id="关于权重">关于权重</h3>
<p>计算权重的公式仅仅是出于数学上的考虑，并没有考虑它们的生物学或物理学上的意义。</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/Hb8GjCGj0g.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>下图的左图是考虑了每个数据点距离x轴的距离后计算的权重，下图的右图是考虑了原始数据点与新生成数据点的距离后计算的权重：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/Cg0b0h8I0h.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>下图左图是对这两种权重进行比较，我们可以发现，这两种权重有一些微妙的差别，而右图表示的是另外的一种权重函数（右图没听清楚原视频中说的是什么意思，有空翻一下书再来补充）：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180607/LaIeacaadC.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2018/06/03/BioStatistics/生物统计-StatQuest学习笔记03-标准差、标准与置信区间/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/06/03/BioStatistics/生物统计-StatQuest学习笔记03-标准差、标准与置信区间/" itemprop="url">StatQuest学习笔记03——标准差、标准与置信区间</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-06-03T12:10:54+08:00">
                2018-06-03
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/生物统计/" itemprop="url" rel="index">
                    <span itemprop="name">生物统计</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  1,789
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  6
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="前言主要内容">前言——主要内容</h2>
<p>这是StatQuest视频教程的第8-12个。</p>
<p>第8个视频的内容为标准差，标准误，第9个视频是柱状图与饼状图；第10个视频是对数转换以及对数的运算，这个非常简单；第11个视频：置信区间；第12个视频：</p>
<h2 id="标准差与标准误">标准差与标准误</h2>
<p>看下面的案例，这5个点是5只小鼠的体重，其中红色竖线是均值，红色横线就是标准差（standard deviation），它表示的是数据的分布情况，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180605/BCF6eHaj20.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>接着，我们在5个时间点，又分别测量了这5只小鼠的体重，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180605/EEEFheLeLe.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>我们分别计算一下这5次检测的均值与标准差，就是下图中竖线与横线所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180605/am7ieAacGG.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时，将这5次测量数据的均值放到一起，计算这些均值的均值与标准差，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180605/jI2LD0blBe.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时，我们称这个均值的均值为标准误（The Standard Error,SE，有的书会称为SEM）。</p>
<h2 id="标准差与标准误的区分">标准差与标准误的区分</h2>
<h3 id="标准差">标准差</h3>
<p>标准差研究 提一次测量中，数据的变异程度，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180605/4ikdCf83fI.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h3 id="标准误">标准误</h3>
<p>标准误研究的是多次测量的变异程度，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180605/ic1e8AI204.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h3 id="标准误的估算">标准误的估算</h3>
<p>对于标准误比较让人糊涂的地方在于，虽然标准误研究的是多次测量的变异，但是，一次的检测数据也能估算出标准误（其实就是标准差除以样本数的平方根）。因此，如果你只有一次检测的数据，也是能够画出标准误的曲线的（在GraphPad中就能发现这种绘图方法）。</p>
<p>但是，多数情况下，绘图中经常出现的是标准差，而不是标准误（虽然标准误很好看），因为图形展示的通常是你的测量数据，而不是研究几次测量数据的变异。</p>
<h2 id="饼状图与柱状图">饼状图与柱状图</h2>
<p>这两种图的用途很好区分，从形状上就能看出，饼状图通常是研究不同成分在整体中的比例，柱状图通常是研究不同成分自身的数据，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180605/45Fc3Fdm5I.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>如果是两组数据，只看柱状图不太容易看出它们整体中各种成分的差异，如果是饼状图就很容易看出来了，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180605/0f892mC7jF.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h2 id="对数">对数</h2>
<p>先看一组数据，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180605/1A0BFa043J.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>在上图中，左边数轴上是0到8，而这些数字可以写成2的指数幂形式，这样的话，1就是2的0次方，2是2的1次方，4是2的2次方，相应的的5，6，7都可以这么写，只是它们的指数不是整数，这样的话，我们将这个数轴转换一下，让这些数字的指数作为数轴上的数字，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180605/5ecG44194D.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>从上图可知，使用了一个对数log转换，将原始数字转换成了以2为底的对数形式。</p>
<p>在生物学中，RT-qPCR的数据基本上都是以2为底的对数的形式展现的，我们经常看到RT-qPCR的数值不是整数，这也好理解，因为PCR的扩增效率不可能是100%（如果是100%，则肯定是整数）。在qPCR的数据处理中，通常使用的是几何均数。几何均数是对各变量值的连乘积开项数次方根。 另外，在对转录组数据进行分析时，也通常使用对数，对于差异基因的结果，通常也是对数表示的，正数表示基因表达上调，反之，下调。</p>
<h2 id="置信区间confidence-intervals">置信区间（confidence intervals）</h2>
<p>先看一个场景，下图是我们检测了一批雌性小鼠（12只）的体重，其中红色竖线是这次数据的均值：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180605/89hkG8j5kb.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时，我们从这批小鼠中自举（bootstrap）一些样本，例如我们随机选取12只（肯定有重复挑中的小鼠，这个没有关系），如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180605/lG74dJm6jh.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>关于自举：</p>
<blockquote>
<p>自举的思想：</p>
<p>从给定训练集中有放回的均匀抽样，也就是说，每当选中一个样本，它等可能地被再次选中并被再次添加到训练集中。从初始样本重复随机替换抽样，生成一个或一系列待检验统计量的经验分布。 无需假设一个特定的理论分布，便可生成统计量的置信区间，并能检验统计假设。</p>
</blockquote>
<p>自举后，计算这次抽样的均数，然后再自举，再算均数，这个过程持续很多次（大于1000次），计算出的均数如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180605/b45IGE8k1E.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时我们计算置信区间，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180605/Illf8bdDE2.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>这个95%的置信区间就是指，它覆盖了这次自举所有数据的95%均值范围。由于这个置信区间覆盖了95%的均值，那么我们就知道，均数在这个区间之外的概率是不到5%（0.05只是一个界限）。那也就是说，任何在这个区间之外的数字的概率p值是小于0.05的（也就是说有显著意义）。</p>
<h3 id="置信区间的用处">置信区间的用处</h3>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180605/iGbemGdE30.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>先看置信区间的示意图：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180605/Cm49lc46b1.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>均值是对“真实”值的估计（真实值是无法知道的，只能通过不断地测量一步一步接近）。</p>
<p>它有95%的可能落在95%的置信区间内，下图的绿色椭圆的范围是在95%的置信区间之外，它的最右边是20，我们可以发现，在这个绿色椭圆之内也有一个均值（是通过自举法计算的），也就是说这个均值落在了这个绿色的椭圆之内，那么均值落在它里面的概率是多少？这个概率我们通常用p值来表示。从图形上可以看出来，这个绿色椭圆的范围是在95%的置信区间之外，因此我们就可以推断出此时p值是小于0.05的（这只是一种非常粗糙的推断，具体的推导过程可以看相关的数学书），因此我们就可以下结论：“真实”值出现在95%区间以外的概率不到5%（也就是说p值小于0.05时有统计学意义）。</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180605/KhHLl4jgJB.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h3 id="两个数据集的比较">两个数据集的比较</h3>
<p>再看一个案例，下图是雌性小鼠与在雄性小鼠体重的测量结果，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180605/AIibFKF7jL.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>其中，上图的黑色横线表示的是各自的95%置信区间。从图片上我们就可以直接看出，这两组数据的95%置信区间并不重复，它是有统计学意义的，也就是说我们可以直接看出来p值是小于0.05的（在实际运用中不可以这么做，还是要通过t检验进行计算）。但是，如果它们的95%置信区间有部分重合，就像下面的这个样子：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180605/bB89CE917d.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时就要进行t检验了。</p>
<h2 id="section"></h2>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2018/06/02/BioStatistics/生物统计-StatQuest学习笔记02-样本量与重复/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/06/02/BioStatistics/生物统计-StatQuest学习笔记02-样本量与重复/" itemprop="url">StatQuest学习笔记02——样本量与重复</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-06-02T12:10:54+08:00">
                2018-06-02
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/生物统计/" itemprop="url" rel="index">
                    <span itemprop="name">生物统计</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  1,895
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  7
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="前言">前言</h2>
<p>这是StatQuest视频教程的第6、第7个。</p>
<h2 id="技术重复">技术重复</h2>
<p>现在考虑一个场景，我们要对一批人进行采血，并对这些血样进行基因表达的分析。此时我们先对A进行采血，A的血样我们会检测3次，这3次就叫技术重复（technical replicates），因为我们是对同一个样品进行了测序，研究其基因表达谱，这其实类似于我们做RT-qPCR中的复孔（RT-qPCR我们通常对同一个样本的同一个基因做3个复孔）。</p>
<p>做技术重复我们要解决的问题是：</p>
<ol style="list-style-type: decimal">
<li><p>能够对一个人的基因表达谱进行更加精确地检测；</p></li>
<li><p>能够评估一次实验数据是否精确，例如我们做了3次技术重复，这3次结果都非常接近，那么这批数据就非常可信，相反，如果这3次结果差异很大，那么这批数据就不太可信。通常来说，如果我们开发出了一种新的检测方法，3次技术重复是必不可少的。</p></li>
</ol>
<p>再看下面的案例：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180604/lLemJgLbjm.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>如果我们对同一个人采血，采血了3次，对这3次分别检测他的基因表达，这3次实验我们也认为是技术重复，因为此时研究的对象是同一个人。此时我们从这3次实验中可以获知一些方法之外的信息，因为这3次实验的差异（差异可能很小），可能与一些除了检测方法之外的因素有关。</p>
<h2 id="生物学重复">生物学重复</h2>
<p>现在我们再看一种情况，此时有三个人，分别为A，B，C，我们分别取他们的血样，进行基因检验，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180604/fbg9f18jd4.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>这三个分别来自于A，B，C三个人（男性）的重复称为生物学重复，生物学重复主要是为了研究一类对象中的基因表达情况，这个一类对象可以是人类，或者是小鼠，或者是植物，或者是细胞系（cell lines）。这个实验主要是为了研究男性的基因表达情况，从这些数据中你不太可能知道女性的基因表达情况。如果我只想研究Y染色体的基因表达情况，这就是一个很好的实验。但是，如果我想研究整个人类（包括男性与女性）的基因表达情况，我还需要检测女性的基因表达情况，然后汇总起来分析。</p>
<p>再来看一个情况。如果只检测A的基因表达情况，那么最终的结果只能说是研究了A的基因表达情况，而不是B或C的基因表达，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180604/840Ch0hkE1.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h2 id="技术重复和生物学重复的使用">技术重复和生物学重复的使用</h2>
<p>在实际运用过得中，可以联合使用生物学重复和技术重复，这主要取决于实验类型。有时候如果增加更多的生物学重复，就可以不用技术重复，如果看文献的话，我们经常看到，某实验检测了几十个某病毒的基因表达谱，这些数据通常就不做技术重复，另外，还有一些实验，例如使用的是细胞系，细胞系的样本之间通常差异很小，都是由一个克隆长出来的，因此细胞系的通常也不做技术重复，只做2个生物学重复就行（有的还是做3个生物学重复），如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180604/K3kf0BDmIb.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h2 id="样本量simple-size">样本量（simple size）</h2>
<p>试想以下场景：</p>
<ol style="list-style-type: decimal">
<li>我们对蓝色男性的基因表达有兴趣；</li>
<li>我们是一个小鼠遗传学家，我们可以把这个蓝色的对象视为一种特殊品系的小鼠，例如C57BL/6；</li>
<li>我们对植物感兴趣，此时我们把这个蓝色的对象视为某个品种的树木。</li>
</ol>
<p>先看第一种场景：我们要对这三个蓝色男性（此时这个蓝色男性不再表示一个人，而是某个民族，例如汉族）进行采血，然后检测其基因表达，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180604/mFlbGm4Ccd.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>这样，我们就检测了3次汉族男性的基因表达情况，此时我们用N来表示样本数目，此时N=3。即使我们对每个血液样本检测了2次基因表达情况，如下所示，此时的样本数目仍然是3：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180604/G61Bj5BleL.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>其中一个样本的2次检测就是技术重复，只是用于评估基因检测方法是否精确，它不会告诉我们这3个样本之间的差异。如果我们研究基因检测方法的精确性，那么我们就需要多进行几次技术重复，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180604/gh8JbCe82d.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时，N=4（这个4表示对一个样本做了4次技术重复，注意与前面的生物学重复进行区分），我们要注意，技术重复只是在描述一个方法时才有意义。</p>
<h2 id="有效样品量effective-sample-size">有效样品量（effective sample size）</h2>
<p>此时我们看一种比较复杂的情况，现在我们要研究一些男性基因表达谱的常规特征，这个时候就需要检测多个不同的男性，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180605/agj0f7jEci.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>在这个方案里，我们要检测除了蓝色男性之外的其他男性的基因表达情况，也就是说，我们要检测蓝色，黄色，绿色男性的基因表达情况，此时N=3。此到很好理解N=3，但是，如果蓝色是双胞胎，我们检测了这4个人的基因表达情况，也就是如下所示的情况，此时N值就不一定等于3了，如果说N值为4，也有点不太对劲，如下所示：<img src="http://ortxpw68f.bkt.clouddn.com/professional/180605/d7hBlk00JI.png?imageslim" alt="mark"></p>
<p>事实上，此时N值是位于3到4之间的数字。双胞胎其实也是两个不同的的，独立的人，但他们的基因是高度相关的，至少与黄色，绿色人相比，这两个蓝色人的基因更加相似：<img src="http://ortxpw68f.bkt.clouddn.com/professional/180605/baKAI2glCa.png?imageslim" alt="mark"></p>
<p>如果我们计算一下这对双胞胎的基因相关性（correlation），那么我们就能计算出有效的相样量（effective sample size）：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180605/md5dakKkAg.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>例如，如果我们计算出这对双胞胎的相关性是0.7（具体的计算过程先不要管），那么，有效的样本数就是如下所示的公式：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180605/30bH9h3bDc.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>代入公式，则为：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180605/Cec16i95ma.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>因此，当这两个双胞胎高度相关时，他们就不能被视作是2个样本，而是1.18个样本：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180605/7h195jF6EB.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>如果这对双胞胎之间的相关性很低，比如说是0.1，那么代入公式，有效样本量就如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180605/I0D41050F6.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时这两个双胞胎就相当于1.82个样本（这种算法很好理解，毕竟，如果两个人非常相似，就相当于是一个人了）。</p>
<p>在实际情况中，有效样本数的计算更加复杂，不过基本思想是一致的，也就是说，如果样本之间高度相似，它们不能被视为一个样本。</p>
<h2 id="总结">总结</h2>
<ol style="list-style-type: decimal">
<li>技术重复用于评估方法的准确性。</li>
<li>生物学重复用于评估其个物种的特性；</li>
<li>涉及多个样本的时候，如果某两个样本比较相似，要考虑到有效的样本数。</li>
</ol>
<h2 id="补充知识点">补充知识点</h2>
<p>effective sample size：</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2018/06/01/BioStatistics/生物统计-StatQuest学习笔记01-统计学分布及抽样/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/06/01/BioStatistics/生物统计-StatQuest学习笔记01-统计学分布及抽样/" itemprop="url">StatQuest学习笔记01——统计学分布及抽样</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-06-01T12:10:54+08:00">
                2018-06-01
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/生物统计/" itemprop="url" rel="index">
                    <span itemprop="name">生物统计</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  1,777
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  6
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="前言">前言</h2>
<p>这个系列的笔记是StatQuest视频的学习笔记，我的这些笔记有时候会使用一些自己以前收录的数据，外加自己补充的一些笔记。此篇笔记是基础知识，视频教程的1-5。</p>
<h2 id="什么是直方图">什么是直方图</h2>
<p>如果我们测量一批人的身高，他们的身高并不固定，因此我们先做一个x轴，从左到右身高依次增高，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180602/70DL93Hd72.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>此时，我们开始测量这批人的身高，一个点代表一个人，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180602/23dFF1d16h.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>这种图有个缺陷，就是一些相同身高的人的点会重合，并不直观，因此我们可以转换一下图形，把相同身高的人的点叠加起来，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180602/6G4Agk0haI.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>这样的话， 我们就能很清楚地看到这批人身高的统计情况，这种图形可以叫直方图（histogram），直方图的下端（也就是x轴）的数据是连续的，可以自己设定，从图中可以明显看到，中间的人的点数多，两边的人点数少。再进一步，我们可以使用“分布（distribution）”这个术语来表示我们这次测量的为数据，将这些数据点的顶端用一个近似曲线连接起来，就成了下面的这个样子：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180602/HJl26FJlgm.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>这种图形类似于一个钟型（bell）我们可以称它为正态分布（normal distribution），如果我们测量出来的数据是下面的这个样子，它就呈现一种指数分布（exponential distribution）：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180602/d8IJBHmmfa.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h2 id="直方图的特点">直方图的特点</h2>
<p>如果我们在测量这批人的数据时，以0.5英尺（约合30cm）为单位，也就是说，在绘制直方图时，x轴的坐标上的宽度分布是这个样子的：<img src="http://ortxpw68f.bkt.clouddn.com/professional/180602/98FBa3heAl.png?imageslim" alt="mark"></p>
<p>可以看到，这次测量把这批人的身高数据划分了4份，分别为小于5，5到5.5，5.5到6，大于6。如果改变一下，把数据划分为8份，也就是说最小的单位值是0.25，就是下面的这个样子：<img src="http://ortxpw68f.bkt.clouddn.com/professional/180602/6c2A7mi4kH.png?imageslim" alt="mark"></p>
<p>如果测量更多的人，使用更加小的划分单位，我们就会得到一个对人体身高更加精确的估计值，下图是划分了18份，如下所示：<img src="http://ortxpw68f.bkt.clouddn.com/professional/180602/flIcGdeFdb.png?imageslim" alt="mark"></p>
<p>并且还可以画出一条曲线（curve），对这批数据进行估计，如下所示：<img src="http://ortxpw68f.bkt.clouddn.com/professional/180602/k2kg7ab0iG.png?imageslim" alt="mark"></p>
<p>从这张图上我们可以得到以下信息：<img src="http://ortxpw68f.bkt.clouddn.com/professional/180602/BHbkI8IG71.png?imageslim" alt="mark"></p>
<p>测量一个人，得到这个低于4.5或高于6.5的概率比较低，而很大的概率会得到曲线中间凸出来的部分。使用曲线来估计一批人数据比直方图更有优势。第一，直方图有时候并不准，例如上图右侧蓝箭头这部分数据并没有测到，如果换一批人，就有可能测到；第二，使用曲线时，并不用考虑最小数据的分隔单位，就能估计一个数值的概率，例如我们要计算得到5.021和5.317这个数据的概率有多大，就直接利用曲线就能得到。第三，人的精力与资源有限，直接去测量大批数据并不现实，而估计一条曲线只需要我们手中少量数据的标准差与均值即可。<img src="http://ortxpw68f.bkt.clouddn.com/professional/180602/a8ecG659K4.png?imageslim" alt="mark"></p>
<p>在这张图里，直方图与曲线都表示这批数据的分布，其中曲线的最高处以及直方图的中间地带，都是最有可能测量到的部分。除了这种正态分布的图形外，还有其他的分布（下图左上是正态分布，右上是指数分页，左下是均匀分页），如下所示：<img src="http://ortxpw68f.bkt.clouddn.com/professional/180602/0fHibjmk1K.png?imageslim" alt="mark"></p>
<h2 id="直方图与柱状图的区别">直方图与柱状图的区别</h2>
<p>直方图x轴上的组距是连续的，从上面的图形可以得知，测量的身高的不同划分是小于5，5到5.5，5.5到6，6以上。而柱状图的x轴上通常是一些分类的数据类型，看下图：<img src="http://ortxpw68f.bkt.clouddn.com/professional/180602/EgD46kd4gG.png?imageslim" alt="mark"></p>
<p>这张图就是一个柱状图（有人也称条形图），它的x轴是不连续的，只是一些分类变量。</p>
<h2 id="正态分布">正态分布</h2>
<p>先看一下正态分布图形，就是上一部分中的身高分布数据，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180602/5alkghAAl8.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>从图形上可以看到正态分布的特点：</p>
<ol style="list-style-type: decimal">
<li>左右对称，因此也叫钟型曲线（bell shaped curve）；</li>
<li>中间凸起，两侧平缓。</li>
</ol>
<p>再看另外的两个正态分布图形：<img src="http://ortxpw68f.bkt.clouddn.com/professional/180602/gDaJ9H1B7L.png?imageslim" alt="mark"></p>
<p>其中，左侧绿线表示的是出生的婴儿的身高分布（英寸），右侧的划线表示的是成人身高的分布，从这两个曲线上我们可以得到这些信息：</p>
<ol style="list-style-type: decimal">
<li>婴儿的正态分布曲线比较尖锐，这表示婴儿身高比较集中，成人身高的正态分布曲线比较平缓，这表示成人身高比较分散；</li>
<li>成人身高的平均值要高于婴儿身高的平均值。</li>
</ol>
<p>再看一下婴儿和成人身高的95%的集中程度：<img src="http://ortxpw68f.bkt.clouddn.com/professional/180602/afg2l14Jgd.png?imageslim" alt="mark"></p>
<p>自然界的很多事物都符合正态分布，其背后的一个原理就是中心极限定理（the central limit theorem），以后的笔记会提到。</p>
<h2 id="模型">模型</h2>
<p>模型，英文是指“model”。在统计学中，模型是指对现实世界中的一些事情的抽象处理，数据模型使用一些表格，图表，公式来研究现实世界中的一些规律，例如下图就是使用一个图表和公式来表示小鼠的体重与大小的关系：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180602/KC54a6FL81.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>有时候，图形不一定是直线，也有可能是曲线，如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180602/g72KFhjJcD.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h2 id="抽样分布">抽样分布</h2>
<p>下图是一个直方图，一个点表示一个人的身高：<img src="http://ortxpw68f.bkt.clouddn.com/professional/180602/5a7H4b2Bim.png?imageslim" alt="mark"></p>
<p>然后用一条曲线来表示数据的分布：<img src="http://ortxpw68f.bkt.clouddn.com/professional/180602/g4Ce3kEI04.png?imageslim" alt="mark"></p>
<p>如果我们从这个分布里面随机抽出一个样本的话，有很大的概率会抽到中间的这一部分，就是下图中黑色圆角矩形表示的区域：<img src="http://ortxpw68f.bkt.clouddn.com/professional/180602/ja213fBCEF.png?imageslim" alt="mark"></p>
<p>如果我们使用某个程序（例如R语言）随机地从服从正态分布的数据中挑出许多样本，然后对它们进行统计的话，看一下会发生哪些事情，例如从下面的这个正态分布中随机地挑出两个样本，一个样本的数量是3（一个样本不一定只是一个数据点），如下所示：<img src="http://ortxpw68f.bkt.clouddn.com/professional/180602/E3D4lLLK6k.png?imageslim" alt="mark"></p>
<p>然后对这两个样本进行t检验，由于它们都是来源于同不一个分布，因此t检验结果的p值会很大（也就是说p很有可能大于0.05）。如果这两个样本是来源两个不同的分布，如下所示：<img src="http://ortxpw68f.bkt.clouddn.com/professional/180602/8F7mCeJJll.png?imageslim" alt="mark"></p>
<p>那么经过t检验，得到的p值就会很小。如果想到得到较小的p值，这就可能要增加样本，或者是就此为止（增加样本涉及到一类错误与二类错误，这里不表）。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2018/05/28/Experiment/实验笔记-miRNA的qPCR方法笔记/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/05/28/Experiment/实验笔记-miRNA的qPCR方法笔记/" itemprop="url">miRNA的qPCR方法笔记</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-05-28T12:00:00+08:00">
                2018-05-28
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/生物实验笔记/" itemprop="url" rel="index">
                    <span itemprop="name">生物实验笔记</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  1,704
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  6
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="前言">前言</h2>
<p>microRNA（后方简称miRNA）的长度比较短，通常是20nt到24nt长度，因此用常规的qPCR法很难对其直接定量。现在常用的对miRNA的定量方法主要有三种，分别为加尾法，茎环引物法，探针法。这篇笔记主要以mmu-miR-30d-50为例总结一下这前两种方法，因为探针法的原理与实验步骤我以前总结过。就我自己的看法，这三种方法最根本的原理就是延长miRNA。</p>
<h2 id="茎环引物法">茎环引物法</h2>
<h3 id="原理">原理</h3>
<p>茎环引物是一种能够自身环化的长引物，它的长度约为45bp。下面是茎环引物的示意图：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180524/Dh99I4kDc3.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>茎环引物的使用流程：</p>
<p>第一步：在反转录过程中，茎环逆转录引物（需要自己设计）与miRNA结合，反转录为cDNA；</p>
<p>第二步：在qPCR过程中，茎环结构打开，两条引物与打开茎环结构结合，其中一条引物与茎环引物上的公共序列结合，另外一条与相应的miRNA序列结合（需要自己设计），其他的miRNA也可以使用公共引物。</p>
<h3 id="mmu-mir-30d-5p的茎环引物设计">mmu-miR-30d-5p的茎环引物设计</h3>
<p>第一步，查询<a href="http://www.mirbase.org/cgi-bin/mirna_entry.pl?acc=MI0000549" target="_blank" rel="external">mmu-miR-30d-5p的成熟体序列</a>（5’-&gt;3’）如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">UGUAAACAUCCCCGACUGGAAG</div></pre></td></tr></table></figure>
<p>将U转换为T，就如下所示： <figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">TGTAAACATCCCCGACTGGAAG</div></pre></td></tr></table></figure></p>
<p>第二步，设计茎环引物，茎环引物由两部分构成，一部分是通用的序列（通用序列有很多种，这里只列举一种），如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">CTCAACTGGTGTCGTGGAGTCGGCAATTCAGTTGAGC</div></pre></td></tr></table></figure>
<p>另外一部分是针对某个miRNA特定序列，这一部分的序列是6个碱基，我们设计的是miR-30d-5p，从它的3‘端，开始数取6-8个序列，即<code>GAAGGTCA</code>，取它的互补序列，即为<code>CTTCCAGT</code>，将这段序列与茎环引物的通用序列，结合，就成了miR-30d-5p的反转录引物，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">CTCAACTGGTGTCGTGGAGTCGGCAATTCAGTTGAGCCTTCCAGT</div></pre></td></tr></table></figure>
<p>这个引物是在反转录的时候使用，它在反转录过程中的示意图如下所示：<img src="http://ortxpw68f.bkt.clouddn.com/professional/180528/e54eA3ACjl.jpg?imageslim" alt="mark"></p>
<p>第三步，设计qPCR引物，正向引物，每个正向引物包括5’端通用序列和3‘端miRNA特异序列，5’端通用序列为：<code>5’-GCCGAG-3’</code>或<code>5’-TCGGCAGG-3’</code>，用于延伸实时定量PCR产物的长度；3’端为跟据成熟miRNA自身碱基组成及GC含量适当删减几个碱基所得的寡核苷酸或完整的成熟miRNA。即：上游引物为5‘- 通用引物+NNNNNNNNNNNNNNNNN-3’ ，自miRNA5’端抄起，14-16个或13-14个，这里就抄14个碱基。 通俗的说就是：保护性碱基（用来调GC含量的）+miRNA 5 端的13-16个碱基（不要抄到最后那6-8个上去了，意思就是不要与RT那段重叠了），因此miR-30d-5p的qPCR正向引物序列就是： <figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">TCGGCAGGTGTAAACATCCCCG</div></pre></td></tr></table></figure></p>
<p>反向引物，就是茎环引物上的一段序列，这里直接写为<code>5'-CTCAACTGGTGTCGTGGA-3'</code>（就是茎环引物上的一段序列）。这两条引物在qPCR中的反应过程如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180528/ad22mEl3fa.jpg?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<h3 id="rna提取的实验材料">RNA提取的实验材料</h3>
<p>Trizol（Thermo Fisher Scientific）</p>
<p>RNAase-Free水</p>
<p>无水乙醇（重庆川东化工有限公司）</p>
<p>氯仿（成都市科龙化工试剂厂）</p>
<p>异丙醇（成都市科龙化工试剂厂）</p>
<p>qPCR试剂盒（Takara，货号：RR820A）</p>
<p>反转录试剂盒（Takara，货号：RR037A）</p>
<h3 id="qpcr实验过程">qPCR实验过程</h3>
<h3 id="提取rna">1.提取RNA</h3>
<p>提取RNA，按照常规的Trizol法提取即可，最终提取并测完浓度后，将RNA样本稀释到300ng/uL的浓度，并分装到3个EP管中，并取一部分出来，进行质控。质控的内容包括：1.2%的琼脂糖电泳，电压120V，40分钟，上样量200ng。</p>
<h3 id="反转录">2. 反转录</h3>
<ol style="list-style-type: decimal">
<li>反转录采用Takara的反转录试剂盒，这个试剂盒是常规的反转录试剂盒，在反转录miRNA的时候，不需要试剂盒里面的2个引物，即成分3（Oligo dT primer）和成分4（Random 6 mers），使用自己设计的茎环引物进行反转，反转体系如下所示（20μL体系）：</li>
</ol>
<table>
<thead>
<tr class="header">
<th>成分</th>
<th>体积</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>5XPrimeScript Buffer</td>
<td>4</td>
</tr>
<tr class="even">
<td>PrimeScript RT Enzyme Mix I</td>
<td>1</td>
</tr>
<tr class="odd">
<td>茎环引物</td>
<td>1</td>
</tr>
<tr class="even">
<td>总RNA</td>
<td>1</td>
</tr>
<tr class="odd">
<td>无RNAase水</td>
<td>20μL</td>
</tr>
</tbody>
</table>
<p>PCR程序为：</p>
<ol style="list-style-type: decimal">
<li>Step 1：37℃, 15min</li>
<li>Step 2：85 ℃, 5 sec</li>
<li>Step 3：4 ℃, 5min</li>
</ol>
<h3 id="qpcr反应">3. qPCR反应</h3>
<p>反应体系如下所示：</p>
<table>
<thead>
<tr class="header">
<th>组分</th>
<th>体积(μL)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>2×SsoAdvanced SYBR Green Supermix</td>
<td>10</td>
</tr>
<tr class="even">
<td>Forward Primer(10μM)</td>
<td>1</td>
</tr>
<tr class="odd">
<td>Reverse Primer(10μM)</td>
<td>1</td>
</tr>
<tr class="even">
<td>cDNA Template</td>
<td>1</td>
</tr>
<tr class="odd">
<td>ddH2O</td>
<td>To 20μL</td>
</tr>
</tbody>
</table>
<p>(2)PCR反应条件：</p>
<p>第一步：预变性条件95℃/10s；1 cycle；</p>
<p>第二步：PCR反应条件95℃/5s，60℃/30s，70℃/20s；40 cycles；</p>
<p>第三步：融解曲线分析95℃ 0s，20℃/s，65℃ 15s，20℃/s ，95℃ 0s ，0.1℃/s。</p>
<p>分析数据即可。</p>
<h3 id="茎环引物法的优缺点">茎环引物法的优缺点</h3>
<p>茎环引物法的优点就在于特异性强，成本低。缺点就是一次只能针对一种特定的miRNA进行检测，而加尾法则能够对miRNA进行批量筛选。</p>
<h2 id="加尾法">加尾法</h2>
<h3 id="原理-1">原理</h3>
<p>加尾法的根本原理也是延长miRNA，然后再用上下游引物来进行qPCR。</p>
<p>在这里，还以miR-30d-5p为例，以及Takara的一个miRNA试剂盒为例说明一下加尾法的原理，参考资料主要是该试剂盒的说明书，即Mir-X™ miRNA First-Strand Synthesis and SYBR® qRT-PCR User Manual。这个试剂盒里面有这些成分：①mRQ Enzyme Mix；②mRQ Buffer (2X)；③mRQ 3’ Primer (10 μM) ；④U6 Forward Primer (10 μM)；⑤U6 Reverse Primer (10 μM)。</p>
<p>其中，①mRQ Enzyme Mix中含有poly(A)聚合酶，该酶向miRNA的3’末端添加poly(A)尾，此外还含有SMART MMLV逆转录酶，这个酶主要用于将加了poly(A)的RNA反转录为cDNA。②mRQ buffer是缓冲液，很好理解；③mRA 3‘ Primer这个我猜测可能是进行qPCR反应时的公共引物；④与⑤是U6的内参，这个也好理解。</p>
<p>整个反转录过程如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180528/BBk2j7KAjd.jpg?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>以上就是加尾法对miRNA进行检测的原理。这里只是以mmu-miR-30d-5p为例说明了一下，其实它也可以是miR-770-5p，也可以是miR-21-3p等，一次反转录几乎能够把细胞内的所有miRNA都给反转录成cDNA。因此，如果批量对miRNA进行qPCR筛选的话，加尾法是一种比较合适的方法，它只需要设计针对某个miRNA的特异引物即可，这样一次反转录生成的cDNA就可以重复做多个miRNA的检测。</p>
<h3 id="加尾法的上游引物设计">加尾法的上游引物设计</h3>
<p>从原理图上可以知，例如针对miR-30d-5p的引物其实就是miR-30d-5p序列本身，只是把U变成了T。例如miR-30d-5p的成熟体序列为<code>UGUAAACAUCCCCGACUGGAAG</code>，那么它的加尾法上游引物就是<code>TGTAAACATCCCCGACTGGAAG</code>。</p>
<h3 id="qpcr反应-1">qPCR反应</h3>
<p>加尾法的qPCR反应体系跟普通的qPCR体系一样，程序也类似（如果一次筛选大量的miRNA，则需要优化一下退火温度）。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2018/05/19/Perl/Perl学习笔记（8）-文件与目录操作/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/05/19/Perl/Perl学习笔记（8）-文件与目录操作/" itemprop="url">Perl学习笔记（8）-文件与目录操作</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-05-19T12:00:00+08:00">
                2018-05-19
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Perl/" itemprop="url" rel="index">
                    <span itemprop="name">Perl</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  3,582
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  16
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="perl文件操作概述">Perl文件操作概述</h2>
<p>Perl使用一种叫做<code>文件句柄</code>类型的变量来操作文件。从文件读取或者写入数据需要使用文件句柄。文件句柄(file handle)是一个I/O连接的名称，可以简单地地理解为控制文件的某个东西。Perl提供了三种文件句柄:STDIN,STDOUT,STDERR，分别代表标准输入、标准输出和标准出错输出。</p>
<p>Perl 中打开文件可以使用以下方式： <figure class="highlight perl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">open</span> FILEHANDLE, EXPR</div><div class="line"><span class="keyword">open</span> FILEHANDLE</div><div class="line"><span class="keyword">sysopen</span> FILEHANDLE, FILENAME, MODE, PERMS</div><div class="line"><span class="keyword">sysopen</span> FILEHANDLE, FILENAME, MODE</div></pre></td></tr></table></figure></p>
<p>参数说明: <figure class="highlight perl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">FILEHANDLE：文件句柄，用于存放一个文件唯一标识符，它就是一串数字，其实可以理解为文件编号。</div><div class="line">EXPR：文件名及文件访问类型组成的表达式。</div><div class="line">MODE：文件访问类型。</div><div class="line">PERMS：访问权限位(permission bits)。</div></pre></td></tr></table></figure></p>
<h2 id="open函数">Open函数</h2>
<h3 id="只读方式打开">只读方式打开</h3>
<p>open是打开某个文件的函数，它的用法为<code>open(filevar,filenmae)</code>，其中，filevar是文件句柄，filename是文件名，路径可以是绝对路径，也可以是相对路径。<code>open(DATA,&quot;&lt;file.txt&quot;);</code>表示以只读的方式（只读的方式是<code>&lt;</code>号）打开文件<code>file.txt</code>。如下所示：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~<span class="regexp">/perl/</span><span class="number">06</span>file$ cat open.pl </div><div class="line"><span class="comment">#!/usr/bin/perl</span></div><div class="line"></div><div class="line"><span class="keyword">open</span>(DATA,<span class="string">"&lt;file.txt"</span>) <span class="keyword">or</span> <span class="keyword">die</span> <span class="string">"file.txt can not be opened,$!"</span>;</div><div class="line"></div><div class="line"><span class="keyword">while</span>(&lt;DATA&gt;)&#123;</div><div class="line">    <span class="keyword">print</span> <span class="string">"$_"</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line">biotest@ubuntu:~<span class="regexp">/perl/</span><span class="number">06</span>file$ perl open.pl </div><div class="line">This is a test file.</div><div class="line">biotest@ubuntu:~<span class="regexp">/perl/</span><span class="number">06</span>file$ cat file.txt </div><div class="line">This is a test file.</div></pre></td></tr></table></figure>
<h3 id="写入方式打开">写入方式打开</h3>
<p>写入方式打开是用<code>&gt;</code>符号，使用格式为：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">open</span>(DATA,<span class="string">"&gt;file.txt"</span>) <span class="keyword">or</span> <span class="keyword">die</span> <span class="string">"file.txt can not be open, $!"</span>;</div></pre></td></tr></table></figure>
<h3 id="读写方式打开">读写方式打开</h3>
<p>如果要以读写方式打开文件，需要要<code>&gt;</code>或<code>&lt;</code>字符前添加<code>+</code>号，这种方式不会删除文件原来的内容，它的格式如下：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">open</span>(DATA,<span class="string">"+&lt;file.txt"</span>); <span class="keyword">or</span> <span class="keyword">die</span> <span class="string">"file.txt can not be opened,$!"</span>;</div></pre></td></tr></table></figure>
<h3 id="删除文件内容">删除文件内容</h3>
<p>删除文件内容，需要在<code>+</code>号后面添加<code>&gt;</code>符号，如下所示：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">open</span> DATA, <span class="string">"+&gt;file.txt"</span> <span class="keyword">or</span> <span class="keyword">die</span> <span class="string">"file can not be opened, $!"</span>;</div></pre></td></tr></table></figure>
<h3 id="追加数据">追加数据</h3>
<p>追加数据使用双大于号（<code>&gt;&gt;</code>），如下所示：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">open</span>(DATA,<span class="string">"&gt;&gt;file.txt"</span>)|| <span class="keyword">die</span> <span class="string">"file.txt can not be opened,$!"</span>;</div></pre></td></tr></table></figure>
<h3 id="读取追加文件的内容">读取追加文件的内容</h3>
<p>在追加符号前面加上<code>+</code>号即可，如下所示：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">open</span>(DATA,<span class="string">"+&gt;&gt;file.txt"</span>) || <span class="keyword">die</span> <span class="string">"file.txt can not be opened,$!"</span>;</div></pre></td></tr></table></figure>
<h3 id="不同的访问模式汇总">不同的访问模式汇总</h3>
<table>
<thead>
<tr class="header">
<th>模式</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>&lt;</code>或<code>r</code></td>
<td>只读方式打开，将文件指针指向文件头。</td>
</tr>
<tr class="even">
<td><code>&gt;</code>或<code>w</code></td>
<td>写入方式打开，将文件指针指向文件头并将文件大小截为零。如果文件不存在则尝试创建之。</td>
</tr>
<tr class="odd">
<td><code>&gt;&gt;</code>或<code>a</code></td>
<td>写入方式打开，将文件指针指向文件末尾。如果文件不存在则尝试创建之。</td>
</tr>
<tr class="even">
<td><code>+&lt;</code>或<code>r+</code></td>
<td>读写方式打开，将文件指针指向文件头。</td>
</tr>
<tr class="odd">
<td><code>+&gt;</code>或<code>w+</code></td>
<td>读写方式打开，将文件指针指向文件头并将文件大小截为零。如果文件不存在则尝试创建之。</td>
</tr>
<tr class="even">
<td><code>+&gt;&gt;</code>或<code>a+</code></td>
<td>读写方式打开，将文件指针指向文件末尾。如果文件不存在则尝试创建之。</td>
</tr>
</tbody>
</table>
<h2 id="sysopen函数">Sysopen函数</h2>
<p><code>sysopen</code>函数类似于<code>open</code>函数，它的使用格式如下所示：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">sysopen</span>(FH,$filename,O_RDWR|O_CREAT,<span class="number">0666</span>)（中间有一个竖线，是OR的意思）</div></pre></td></tr></table></figure>
<p>参数解释：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="number">1</span>. FH:文件句柄，与<span class="keyword">open</span>函数的第<span class="number">1</span>个参数一样；</div><div class="line"><span class="number">2</span>. $filename：文件名；</div><div class="line"><span class="number">3</span>. O_RDWRIO_CREAT：模式值，tl模块提供的逻辑OR运算组合起来的常数构成；</div><div class="line"><span class="number">4</span>. 这个参数可先，是八进制值，<span class="number">0666</span>表示数据文件，<span class="number">0777</span>表示程序</div><div class="line">如果文件能够打开，则返回true，如果失败，返回false。</div></pre></td></tr></table></figure>
<p>以读写(<code>+&lt;filename</code>)的方式打开文件的代码是<code>sysopen(DATA,&quot;file.txt&quot;,O_RDWR);</code>如果需要在更新文件前清空文件，代码是`sysopen(DATA,“file.txt”,O_RDWR|O_TRUNC);。所有的模式值如下表所示：</p>
<table>
<thead>
<tr class="header">
<th>模式</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>O_RDWR</td>
<td>读写方式打开，将文件指针指向文件头。</td>
</tr>
<tr class="even">
<td>O_RDONLY</td>
<td>只读方式打开，将文件指针指向文件头。</td>
</tr>
<tr class="odd">
<td>O_WRONLY</td>
<td>写入方式打开，将文件指针指向文件头并将文件大小截为零。如果文件不存在则尝试创建之。</td>
</tr>
<tr class="even">
<td>O_CREAT</td>
<td>创建文件</td>
</tr>
<tr class="odd">
<td>O_APPEND</td>
<td>追加文件</td>
</tr>
<tr class="even">
<td>O_TRUNC</td>
<td>将文件大小截为零</td>
</tr>
<tr class="odd">
<td>O_EXCL</td>
<td>如果使用O_CREAT时文件存在,就返回错误信息,它可以测试文件是否存在</td>
</tr>
<tr class="even">
<td>O_NONBLOCK</td>
<td>非阻塞I/O使我们的操作要么成功，要么立即返回错误，不被阻塞。</td>
</tr>
</tbody>
</table>
<h2 id="close函数">Close函数</h2>
<p>在文件使用完后，要关闭文件，以刷新与文件句柄相关联的输入输出缓冲区，关闭文件的语法如下：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">close</span> FILEHANDLE</div><div class="line"><span class="keyword">close</span></div></pre></td></tr></table></figure>
<p>FILEHANDLE 为指定的文件句柄，如果成功关闭则返回 true，如下所示：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">close</span>(DATA) || <span class="keyword">die</span> <span class="string">"can not close file"</span></div></pre></td></tr></table></figure>
<h2 id="读写文件">读写文件</h2>
<p>向文件读写信息有几种不同的方式。</p>
<h3 id="第一种方式filehandle操作符">第一种方式：<code>&lt;FILEHANDLE&gt;操作符</code></h3>
<p>从打开的文件句柄读取信息的主要方法是<code>&lt;FILEHANDLE&gt;操作符</code>。在标量上下文中，它从文件句柄返回单一行，如下所示：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">open</span> file<span class="string">";</span></div><div class="line"><span class="string">@lines=&lt;DATA&gt;;</span></div><div class="line"><span class="string">print @lines;</span></div><div class="line"><span class="string">close(DATA);</span></div><div class="line"><span class="string">biotest@ubuntu:~/perl/06file$ perl import.pl</span></div><div class="line"><span class="string">1</span></div><div class="line"><span class="string">2</span></div><div class="line"><span class="string">3</span></div></pre></td></tr></table></figure>
<h3 id="getc-函数">getc 函数</h3>
<p><code>xgetc</code>函数从指定的<code>FILEHANDLE</code>返回单一的字符，如果没指定返回 STDIN：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">getc</span> FILEHANDLE</div><div class="line"><span class="keyword">getc</span></div></pre></td></tr></table></figure>
<p>如果发生错误，或在文件句柄在文件末尾，则返回 undef。</p>
<h3 id="read函数">read函数</h3>
<p>read函数用于从缓冲区的文件句柄读取信息。 这个函数用于从文件读取二进制数据，格式如下所示：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">read</span> FILEHANDLE,SCALAR,LENGTH,OFFSET</div><div class="line"><span class="keyword">read</span> FILEHANDLE,SCALAR,LENGTH</div></pre></td></tr></table></figure>
<p>参数说明: <figure class="highlight perl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="number">1</span>. FILEHANDLE：文件句柄，用于存放一个文件唯一标识符。 </div><div class="line"><span class="number">2</span>. SCALAR：存贮结果，如果没有指定OFFSET，数据将放在SCALAR的开头。否则数据放在SCALAR中的OFFSET字节之后。</div><div class="line"><span class="number">3</span>. LENGTH：读取的内容长度。</div><div class="line"><span class="number">4</span>. OFFSET：偏移量。</div><div class="line">如果读取成功返回读取的字节数，如果在文件结尾返回<span class="number">0</span>，如果发生错误返回<span class="keyword">undef</span>。</div></pre></td></tr></table></figure></p>
<h3 id="print函数">print函数</h3>
<p>对于所有从文件句柄中读取信息的函数，在后端主要的写入函数为 print： <figure class="highlight perl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">print</span> FILEHANDLE LIST</div><div class="line"><span class="keyword">print</span> LIST</div><div class="line"><span class="keyword">print</span></div></pre></td></tr></table></figure></p>
<p>利用文件句柄和print函数可以把程序运行的结果发给输出设备(STDOUT：标准输出)，如下所示：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">print</span> <span class="string">"Hello World!\n"</span>;</div></pre></td></tr></table></figure>
<h2 id="文件操作实例">文件操作实例</h2>
<h3 id="复制文件数据">复制文件数据</h3>
<p>在下面的案例中，打开一个已经存在的文件<code>file1.txt</code>，并读取它的每一行，写入到文件<code>file2.txt</code>中，如下所示：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~<span class="regexp">/perl/</span><span class="number">06</span>file$ cat file1.txt</div><div class="line">This is line1 of file1.txt</div><div class="line">This is line2 of file1.txt</div><div class="line">This is line3 of file1.txt</div><div class="line">biotest@ubuntu:~<span class="regexp">/perl/</span><span class="number">06</span>file$ cat operation.pl </div><div class="line"><span class="comment">#!/usr/bi/perl</span></div><div class="line"></div><div class="line"><span class="comment"># Open file1 with only-read</span></div><div class="line"><span class="keyword">open</span>(DATA1,<span class="string">"&lt;file1.txt"</span>);</div><div class="line"></div><div class="line"><span class="comment"># Open new file2</span></div><div class="line"><span class="keyword">open</span>(DATA2,<span class="string">"&gt;file2.txt"</span>);</div><div class="line"></div><div class="line"><span class="comment"># copy data</span></div><div class="line"><span class="keyword">while</span>(&lt;DATA1&gt;)</div><div class="line">&#123;</div><div class="line">    <span class="keyword">print</span> DATA2 $_;</div><div class="line">&#125;</div><div class="line"><span class="keyword">close</span>(DATA1);</div><div class="line"><span class="keyword">close</span>(DATA2);</div><div class="line">biotest@ubuntu:~<span class="regexp">/perl/</span><span class="number">06</span>file$ perl operation.pl </div><div class="line">biotest@ubuntu:~<span class="regexp">/perl/</span><span class="number">06</span>file$ cat file2.txt </div><div class="line">This is line1 of file1.txt</div><div class="line">This is line2 of file1.txt</div><div class="line">This is line3 of file1.txt</div></pre></td></tr></table></figure>
<h3 id="重命名文件">重命名文件</h3>
<p>在下面的案例中，将<code>file1.txt</code>重命令为<code>new_file1.txt</code>，如下所示：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~<span class="regexp">/perl/</span><span class="number">06</span>file$ ls -lh *.txt</div><div class="line">-rw-rw-r-- <span class="number">1</span> biotest biotest <span class="number">81</span> May <span class="number">18</span> <span class="number">20</span>:<span class="number">13</span> file1.txt</div><div class="line">-rw-rw-r-- <span class="number">1</span> biotest biotest <span class="number">81</span> May <span class="number">18</span> <span class="number">20</span>:<span class="number">17</span> file2.txt</div><div class="line">-rw-rw-r-- <span class="number">1</span> biotest biotest <span class="number">21</span> May <span class="number">18</span> <span class="number">19</span>:<span class="number">44</span> file.txt</div><div class="line">-rw-rw-r-- <span class="number">1</span> biotest biotest  <span class="number">7</span> May <span class="number">18</span> <span class="number">20</span>:<span class="number">04</span> import.txt</div><div class="line">biotest@ubuntu:~<span class="regexp">/perl/</span><span class="number">06</span>file$ cat rename.pl </div><div class="line"><span class="comment">#!/usr/bin/perl</span></div><div class="line"></div><div class="line"><span class="keyword">rename</span>(<span class="string">"/home/biotest/perl/06file/file1.txt"</span>,<span class="string">"/home/biotest/perl/06file/new_file1.txt"</span>);</div><div class="line">biotest@ubuntu:~<span class="regexp">/perl/</span><span class="number">06</span>file$ perl rename.pl </div><div class="line">biotest@ubuntu:~<span class="regexp">/perl/</span><span class="number">06</span>file$ ls -lh *.txt</div><div class="line">-rw-rw-r-- <span class="number">1</span> biotest biotest <span class="number">81</span> May <span class="number">18</span> <span class="number">20</span>:<span class="number">17</span> file2.txt</div><div class="line">-rw-rw-r-- <span class="number">1</span> biotest biotest <span class="number">21</span> May <span class="number">18</span> <span class="number">19</span>:<span class="number">44</span> file.txt</div><div class="line">-rw-rw-r-- <span class="number">1</span> biotest biotest  <span class="number">7</span> May <span class="number">18</span> <span class="number">20</span>:<span class="number">04</span> import.txt</div><div class="line">-rw-rw-r-- <span class="number">1</span> biotest biotest <span class="number">81</span> May <span class="number">18</span> <span class="number">20</span>:<span class="number">13</span> new_file1.txt</div></pre></td></tr></table></figure>
<h3 id="删除文件">删除文件</h3>
<p>现在删除当前目录下的<code>file2.txt</code>文件，使用的是<code>unlink</code>函数，如下所示：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~<span class="regexp">/perl/</span><span class="number">06</span>file$ ls -lh *.txt</div><div class="line">-rw-rw-r-- <span class="number">1</span> biotest biotest <span class="number">81</span> May <span class="number">18</span> <span class="number">20</span>:<span class="number">17</span> file2.txt</div><div class="line">-rw-rw-r-- <span class="number">1</span> biotest biotest <span class="number">21</span> May <span class="number">18</span> <span class="number">19</span>:<span class="number">44</span> file.txt</div><div class="line">-rw-rw-r-- <span class="number">1</span> biotest biotest  <span class="number">7</span> May <span class="number">18</span> <span class="number">20</span>:<span class="number">04</span> import.txt</div><div class="line">-rw-rw-r-- <span class="number">1</span> biotest biotest <span class="number">81</span> May <span class="number">18</span> <span class="number">20</span>:<span class="number">13</span> new_file1.txt</div><div class="line">biotest@ubuntu:~<span class="regexp">/perl/</span><span class="number">06</span>file$ vim delete.pl</div><div class="line"></div><div class="line">biotest@ubuntu:~<span class="regexp">/perl/</span><span class="number">06</span>file$ cat delete.pl </div><div class="line"><span class="comment">#!/usr/bin/perl</span></div><div class="line"></div><div class="line"><span class="keyword">unlink</span>(<span class="string">"/home/biotest/perl/06file/file2.txt"</span>);</div><div class="line"></div><div class="line">biotest@ubuntu:~<span class="regexp">/perl/</span><span class="number">06</span>file$ perl delete.pl </div><div class="line">biotest@ubuntu:~<span class="regexp">/perl/</span><span class="number">06</span>file$ ls -lh *.txt</div><div class="line">-rw-rw-r-- <span class="number">1</span> biotest biotest <span class="number">21</span> May <span class="number">18</span> <span class="number">19</span>:<span class="number">44</span> file.txt</div><div class="line">-rw-rw-r-- <span class="number">1</span> biotest biotest  <span class="number">7</span> May <span class="number">18</span> <span class="number">20</span>:<span class="number">04</span> import.txt</div><div class="line">-rw-rw-r-- <span class="number">1</span> biotest biotest <span class="number">81</span> May <span class="number">18</span> <span class="number">20</span>:<span class="number">13</span> new_file1.txt</div></pre></td></tr></table></figure>
<h2 id="指定文件位置">指定文件位置</h2>
<p><code>tell</code>函数用于获取文件的位置，<code>seek</code>函数指定文件内的位置。</p>
<h3 id="tell函数">tell函数</h3>
<p>tell函数的使用如下所示：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">tell</span> FILEHANDLE</div><div class="line"><span class="keyword">tell</span></div></pre></td></tr></table></figure>
<p>如果指定 FILEHANDLE 该函数返回文件指针的位置，以字节计。如果没有指定则返回默认选取的文件句柄。</p>
<h3 id="seek函数">seek函数</h3>
<p>seek()函数是通过文件句柄来移动文件读写指针的方式来读取或写入文件的，以字节为单位进行读取和写入，使用格式如下所示：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">seek</span> FILEHANDLE, POSITION, WHENCE</div></pre></td></tr></table></figure>
<p>参数说明: <figure class="highlight perl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="number">1</span>. FILEHANDLE：文件句柄，用于存放一个文件唯一标识符。</div><div class="line"><span class="number">2</span>. POSITION：表示文件句柄(读写位置指针)要移动的字节数。</div><div class="line"><span class="number">3</span>. WHENCE：表示文件句柄(读写位置指针)开始移动时的起始位置，可以取的值为<span class="number">0</span>、<span class="number">1</span>、<span class="number">2</span>；分别表示文件开头、当前位置和文件尾。</div></pre></td></tr></table></figure></p>
<p>以下案例就是从文件开头读取256个字节： <figure class="highlight perl"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">seek</span> DATA, <span class="number">256</span>, <span class="number">0</span>;</div></pre></td></tr></table></figure></p>
<h3 id="使用案例">使用案例</h3>
<p>以下代码用于判断这个文件是否𥇛，是否可读写，代码如下所示：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~<span class="regexp">/perl/</span><span class="number">06</span>file$ cat file_info.pl </div><div class="line"><span class="comment">#!/usr/bin/perl</span></div><div class="line"></div><div class="line"><span class="keyword">my</span> $file=<span class="string">"/home/biotest/perl/06file/file.txt"</span>;</div><div class="line"><span class="keyword">my</span> (@description, $size);</div><div class="line"><span class="keyword">if</span> (-e $file)</div><div class="line">&#123;</div><div class="line">    <span class="keyword">push</span> @description, <span class="string">'is a binary file'</span> <span class="keyword">if</span> (-B <span class="number">_</span>);</div><div class="line">    <span class="keyword">push</span> @description, <span class="string">'is a socket'</span> <span class="keyword">if</span> (-S <span class="number">_</span>);</div><div class="line">    <span class="keyword">push</span> @description, <span class="string">'is a text file'</span> <span class="keyword">if</span> (-T <span class="number">_</span>);</div><div class="line">    <span class="keyword">push</span> @description, <span class="string">'is a special file'</span> <span class="keyword">if</span> (-b <span class="number">_</span>);</div><div class="line">    <span class="keyword">push</span> @description, <span class="string">'is a special character file'</span> <span class="keyword">if</span> (-c <span class="number">_</span>);</div><div class="line">    <span class="keyword">push</span> @description, <span class="string">'is a dictionary'</span> <span class="keyword">if</span> (-d <span class="number">_</span>);</div><div class="line">    <span class="keyword">push</span> @description, <span class="string">'file exists'</span> <span class="keyword">if</span> (-<span class="keyword">x</span> <span class="number">_</span>);</div><div class="line">    <span class="keyword">push</span> @description, (($size=-<span class="keyword">s</span> <span class="number">_</span>))? <span class="string">"$size byte"</span>:<span class="string">'null'</span>;</div><div class="line">    <span class="keyword">print</span> <span class="string">"$file information: "</span>,<span class="keyword">join</span>(<span class="string">','</span>,@description),<span class="string">"\n"</span>;</div><div class="line">&#125;</div><div class="line">biotest@ubuntu:~<span class="regexp">/perl/</span><span class="number">06</span>file$ perl file_info.pl </div><div class="line">/home/biotest/perl/<span class="number">06</span>file/file.txt information: is a text file,<span class="number">21</span> byte</div></pre></td></tr></table></figure>
<p>文件测试操作符如下表所示：</p>
<table>
<thead>
<tr class="header">
<th>操作符</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>-A</code></td>
<td>文件上一次被访问的时间(单位：天)</td>
</tr>
<tr class="even">
<td><code>-B</code></td>
<td>是否为二进制文件</td>
</tr>
<tr class="odd">
<td><code>-C</code></td>
<td>文件的(inode)索引节点修改时间(单位：天)</td>
</tr>
<tr class="even">
<td><code>-M</code></td>
<td>文件上一次被修改的时间(单位：天)</td>
</tr>
<tr class="odd">
<td><code>-O</code></td>
<td>文件被真实的UID所有</td>
</tr>
<tr class="even">
<td><code>-R</code></td>
<td>文件或目录可以被真实的UID/GID读取</td>
</tr>
<tr class="odd">
<td><code>-S</code></td>
<td>为socket(套接字)</td>
</tr>
<tr class="even">
<td><code>-T</code></td>
<td>是否为文本文件</td>
</tr>
<tr class="odd">
<td><code>-W</code></td>
<td>文件或目录可以被真实的UID/GID写入</td>
</tr>
<tr class="even">
<td><code>-X</code></td>
<td>文件或目录可以被真实的UID/GID执行</td>
</tr>
<tr class="odd">
<td><code>-b</code></td>
<td>为block-special (特殊块)文件(如挂载磁盘)</td>
</tr>
<tr class="even">
<td><code>-c</code></td>
<td>为character-special (特殊字符)文件(如I/O 设备)</td>
</tr>
<tr class="odd">
<td><code>-d</code></td>
<td>为目录</td>
</tr>
<tr class="even">
<td><code>-e</code></td>
<td>文件或目录名存在</td>
</tr>
<tr class="odd">
<td><code>-f</code></td>
<td>为普通文件</td>
</tr>
<tr class="even">
<td><code>-g</code></td>
<td>文件或目录具有setgid属性</td>
</tr>
<tr class="odd">
<td><code>-k</code></td>
<td>文件或目录设置了sticky位</td>
</tr>
<tr class="even">
<td><code>-l</code></td>
<td>为符号链接</td>
</tr>
<tr class="odd">
<td><code>-o</code></td>
<td>文件被有效UID所有</td>
</tr>
<tr class="even">
<td><code>-p</code></td>
<td>文件是命名管道(FIFO)</td>
</tr>
<tr class="odd">
<td><code>-r</code></td>
<td>文件可以被有效的UID/GID读取</td>
</tr>
<tr class="even">
<td><code>-s</code></td>
<td>文件或目录存在且不为0(返回字节数)</td>
</tr>
<tr class="odd">
<td><code>-t</code></td>
<td>文件句柄为TTY(系统函数isatty()的返回结果；不能对文件名使用这个测试)</td>
</tr>
<tr class="even">
<td><code>-u</code></td>
<td>文件或目录具有setuid属性</td>
</tr>
<tr class="odd">
<td><code>-w</code></td>
<td>文件可以被有效的UID/GID写入</td>
</tr>
<tr class="even">
<td><code>-x</code></td>
<td>文件可以被有效的UID/GID执行</td>
</tr>
<tr class="odd">
<td><code>-z</code></td>
<td>文件存在，大小为0(目录恒为false)，即是否为空文件，</td>
</tr>
</tbody>
</table>
<h2 id="perl目录操作">Perl目录操作</h2>
<p>下面是Perl中常用的一些操作目录的函数：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">opendir</span> DIRHANDLE, EXPR  <span class="comment"># 打开目录</span></div><div class="line"><span class="keyword">readdir</span> DIRHANDLE        <span class="comment"># 读取目录</span></div><div class="line"><span class="keyword">rewinddir</span> DIRHANDLE      <span class="comment"># 定位指针到开头</span></div><div class="line"><span class="keyword">telldir</span> DIRHANDLE        <span class="comment"># 返回目录的当前位置</span></div><div class="line"><span class="keyword">seekdir</span> DIRHANDLE, POS   <span class="comment"># 定位指定到目录的 POS 位置</span></div><div class="line">closedir DIRHANDLE       <span class="comment"># 关闭目录</span></div></pre></td></tr></table></figure>
<h3 id="显示所有文件">显示所有文件</h3>
<p>在下面的案例中，可以显示所有的文件，使用了<code>glob</code>函数，如下所示：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~<span class="regexp">/perl/</span><span class="number">06</span>file$ cat glob.pl </div><div class="line"><span class="comment">#!/usr/bin/perl</span></div><div class="line"></div><div class="line"><span class="comment"># display /home/biotest/perl/06file/ all files</span></div><div class="line">$dir = <span class="string">"/home/biotest/perl/06file/*"</span>;</div><div class="line"><span class="keyword">my</span> @files=<span class="keyword">glob</span>($dir);</div><div class="line"></div><div class="line"><span class="keyword">foreach</span>(@files)&#123;</div><div class="line">    <span class="keyword">print</span> $_. <span class="string">"\n"</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment"># display all files with .pl in /home/biotest/perl/06file/</span></div><div class="line">$dir=<span class="string">"/home/biotest/perl/06file/*.pl"</span>;</div><div class="line">@files=<span class="keyword">glob</span>($dir);</div><div class="line"></div><div class="line"><span class="keyword">foreach</span>(@files)&#123;</div><div class="line">    <span class="keyword">print</span> $_.<span class="string">"\n"</span>;</div><div class="line">&#125;</div><div class="line">biotest@ubuntu:~<span class="regexp">/perl/</span><span class="number">06</span>file$ perl glob.pl </div><div class="line">/home/biotest/perl/<span class="number">06</span>file/delete.pl</div><div class="line">/home/biotest/perl/<span class="number">06</span>file/file.txt</div><div class="line">/home/biotest/perl/<span class="number">06</span>file/file_info.pl</div><div class="line">/home/biotest/perl/<span class="number">06</span>file/glob.pl</div><div class="line">/home/biotest/perl/<span class="number">06</span>file/import.pl</div><div class="line">/home/biotest/perl/<span class="number">06</span>file/import.txt</div><div class="line">/home/biotest/perl/<span class="number">06</span>file/m1.pl</div><div class="line">/home/biotest/perl/<span class="number">06</span>file/new_file1.txt</div><div class="line">/home/biotest/perl/<span class="number">06</span>file/open.pl</div><div class="line">/home/biotest/perl/<span class="number">06</span>file/operation.pl</div><div class="line">/home/biotest/perl/<span class="number">06</span>file/rename.pl</div><div class="line">/home/biotest/perl/<span class="number">06</span>file/delete.pl</div><div class="line">/home/biotest/perl/<span class="number">06</span>file/file_info.pl</div><div class="line">/home/biotest/perl/<span class="number">06</span>file/glob.pl</div><div class="line">/home/biotest/perl/<span class="number">06</span>file/import.pl</div><div class="line">/home/biotest/perl/<span class="number">06</span>file/m1.pl</div><div class="line">/home/biotest/perl/<span class="number">06</span>file/open.pl</div><div class="line">/home/biotest/perl/<span class="number">06</span>file/operation.pl</div><div class="line">/home/biotest/perl/<span class="number">06</span>file/rename.pl</div></pre></td></tr></table></figure>
<p>显示当前目录下所有文件，使用<code>opendir</code>函数，如下所示：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~<span class="regexp">/perl/</span><span class="number">06</span>file$ cat opendir.pl </div><div class="line"><span class="comment">#!/usr/bin/perl</span></div><div class="line"></div><div class="line"><span class="keyword">opendir</span>(DIR,<span class="string">'.'</span>) <span class="keyword">or</span> <span class="keyword">die</span> <span class="string">"Can not open directory,$!"</span>;</div><div class="line"><span class="keyword">while</span>($file=<span class="keyword">readdir</span> DIR)&#123;</div><div class="line">    <span class="keyword">print</span> <span class="string">"$file\n"</span>;</div><div class="line">&#125;</div><div class="line">closedir DIR;</div><div class="line">biotest@ubuntu:~<span class="regexp">/perl/</span><span class="number">06</span>file$ perl opendir.pl </div><div class="line">open.pl</div><div class="line">file.txt</div><div class="line">..</div><div class="line">rename.pl</div><div class="line">glob.pl</div><div class="line">import.pl</div><div class="line">opendir.pl</div><div class="line">operation.pl</div><div class="line">new_file1.txt</div><div class="line">file_info.pl</div><div class="line">.</div><div class="line">m1.pl</div><div class="line">delete.pl</div><div class="line">import.txt</div></pre></td></tr></table></figure>
<h3 id="显示当前目录下所有以.pl结尾的文件">显示当前目录下所有以<code>.pl</code>结尾的文件</h3>
<p>如下所示：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~<span class="regexp">/perl/</span><span class="number">06</span>file$ cat display_file_pl.pl </div><div class="line"><span class="comment">#!/usr/bin/perl</span></div><div class="line"></div><div class="line"><span class="keyword">opendir</span>(DIR,<span class="string">'.'</span>) <span class="keyword">or</span> <span class="keyword">die</span> <span class="string">"can not open directionary, $!"</span>;</div><div class="line"><span class="keyword">foreach</span> (<span class="keyword">sort</span> <span class="keyword">grep</span>(<span class="regexp">/^.*\.pl$/</span>,<span class="keyword">readdir</span>(DIR)))&#123;</div><div class="line">     <span class="keyword">print</span> <span class="string">"$_\n"</span>;</div><div class="line">&#125;</div><div class="line">closedir DIR;</div><div class="line">biotest@ubuntu:~<span class="regexp">/perl/</span><span class="number">06</span>file$ perl display_file_pl.pl </div><div class="line">delete.pl</div><div class="line">display_file_pl.pl</div><div class="line">file_info.pl</div><div class="line">glob.pl</div><div class="line">import.pl</div><div class="line">m1.pl</div><div class="line">open.pl</div><div class="line">opendir.pl</div><div class="line">operation.pl</div><div class="line">rename.pl</div></pre></td></tr></table></figure>
<h3 id="创建一个新目录">创建一个新目录</h3>
<p>mkdir也是Perl中的一个函数，它用于创建一个新目录，但是使用之前，要有足够的权限，如下所示：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~<span class="regexp">/perl/</span><span class="number">06</span>file$ cat mkdir.pl </div><div class="line"><span class="comment">#!/usr/bin/perl</span></div><div class="line"></div><div class="line">$dir=<span class="string">"/home/biotest/perl/06file/new"</span>;</div><div class="line"></div><div class="line"><span class="keyword">mkdir</span>($dir) <span class="keyword">or</span> <span class="keyword">die</span> <span class="string">"Can not create $dir directionary, $!"</span>;</div><div class="line"><span class="keyword">print</span> <span class="string">"Create a directionary!"</span>;</div><div class="line">biotest@ubuntu:~<span class="regexp">/perl/</span><span class="number">06</span>file$ perl mkdir.pl </div><div class="line">Create a directionary!</div><div class="line"></div><div class="line">biotest@ubuntu:~<span class="regexp">/perl/</span><span class="number">06</span>file$ ls</div><div class="line">delete.pl           glob.pl     mkdir.pl       open.pl</div><div class="line">display_file_pl.pl  import.pl   new            operation.pl</div><div class="line">file_info.pl        import.txt  new_file1.txt  rename.pl</div><div class="line">file.txt            m1.pl       opendir.pl</div></pre></td></tr></table></figure>
<h3 id="删除目录">删除目录</h3>
<p>使用rmdir来删除目录，使用这个函数之前用户需要有足够的权限，如下所示：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~<span class="regexp">/perl/</span><span class="number">06</span>file$ cat del_dir.pl </div><div class="line"><span class="comment">#!/usr/bin/perl</span></div><div class="line"></div><div class="line">$dir=<span class="string">"/home/biotest/perl/06file/new"</span>;</div><div class="line"></div><div class="line"><span class="keyword">rmdir</span>($dir) <span class="keyword">or</span> <span class="keyword">die</span> <span class="string">"Can not delete $dir directionary, $!"</span>;</div><div class="line"><span class="keyword">print</span> <span class="string">"Delete directionary successfully!\n"</span>;</div><div class="line">biotest@ubuntu:~<span class="regexp">/perl/</span><span class="number">06</span>file$ perl del_dir.pl </div><div class="line">Delete directionary successfully!</div><div class="line">biotest@ubuntu:~<span class="regexp">/perl/</span><span class="number">06</span>file$ ls</div><div class="line">del_dir.pl          file.txt    m1.pl          open.pl</div><div class="line">delete.pl           glob.pl     mkdir.pl       operation.pl</div><div class="line">display_file_pl.pl  import.pl   new_file1.txt  rename.pl</div><div class="line">file_info.pl        import.txt  opendir.pl</div></pre></td></tr></table></figure>
<h3 id="切换目录">切换目录</h3>
<p>切换目录使用chdir函数，如下所示：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~<span class="regexp">/perl/</span><span class="number">06</span>file$ pwd</div><div class="line">/home/biotest/perl/<span class="number">06</span>file</div><div class="line">biotest@ubuntu:~<span class="regexp">/perl/</span><span class="number">06</span>file$ cat chdir.pl </div><div class="line"><span class="comment">#!/usr/bin/perl</span></div><div class="line"></div><div class="line">$dir=<span class="string">"/home/biotest"</span>;</div><div class="line"></div><div class="line"><span class="keyword">chdir</span>($dir) <span class="keyword">or</span> <span class="keyword">die</span> <span class="string">"Can not change to $dir, $!"</span>;</div><div class="line"><span class="keyword">print</span> <span class="string">"Your current directionary is $dir\n"</span>;</div><div class="line"></div><div class="line"><span class="keyword">opendir</span>(DIR,<span class="string">'.'</span>) <span class="keyword">or</span> <span class="keyword">die</span> <span class="string">"Can not open $dir,$!"</span>;</div><div class="line"><span class="keyword">while</span>($file=<span class="keyword">readdir</span> DIR)&#123;</div><div class="line">    <span class="keyword">print</span> <span class="string">"$file\n"</span>;</div><div class="line">&#125;</div><div class="line">closedir DIR;</div><div class="line">biotest@ubuntu:~<span class="regexp">/perl/</span><span class="number">06</span>file$ perl chdir.pl|head</div><div class="line">Your current directionary is /home/biotest</div><div class="line">Desktop</div><div class="line">Miniconda2-latest-Linux-x86_64.sh</div><div class="line">filename</div><div class="line">Pictures</div><div class="line">.dmrc</div><div class="line">Videos</div><div class="line">.xsession-errors.old</div><div class="line">.bash_history</div><div class="line">.cache</div></pre></td></tr></table></figure>
<p>从结果来看，运行代码后，chdir并不会在shell中直接切换到<code>/home/biotest</code>目录，但是，我们后来使用了<code>opendir</code>函数后，显示的文件确实是<code>/home/biotest</code>目录下的文件，这一点需要注意：切换目录改变的只能是Perl程序运行中的目录，而不是Shell实际中的目录。</p>
<h2 id="参考资料">参考资料</h2>
<p><a href="http://www.runoob.com/perl/perl-tutorial.html" target="_blank" rel="external">Perl教程|菜鸟教程</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2018/05/18/Perl/Perl学习笔记（7）-引用/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/05/18/Perl/Perl学习笔记（7）-引用/" itemprop="url">Perl学习笔记（7）-引用</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-05-18T12:00:00+08:00">
                2018-05-18
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Perl/" itemprop="url" rel="index">
                    <span itemprop="name">Perl</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  724
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  3
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="perl-引用">Perl 引用</h2>
<p>引用就是指针，Perl的引用是一个标量类型，它可以指向变量、数组、哈希表（也叫关联数组）和函数，可以应用在程序的任何地方。</p>
<h2 id="创建引用">创建引用</h2>
<p>定义变量的时候，在变量名前面加个，就得到了这个变量的一个引用，如下所示：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">$scalarref = \$foo;     <span class="comment"># 标量变量引用</span></div><div class="line">$arrayref  = \@ARGV;    <span class="comment"># 列表的引用</span></div><div class="line">$hashref   = \%ENV;     <span class="comment"># 哈希的引用</span></div><div class="line">$coderef   = \&amp;handler; <span class="comment"># 函数引用</span></div><div class="line">$globref   = \*foo;     <span class="comment"># GLOB句柄引用</span></div></pre></td></tr></table></figure>
<p>在数组中我们可以用匿名数组引用，使用 [] 定义，在Perl中，匿名数组使用方括号（<code>[]</code>）来表示，而正常的数组，则是使用小括号来表示，例如<code>@ages=(25,30,40)</code>。当使用匿名数组引用时，使用方括号（<code>[]</code>），如下所示：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$aref= [ <span class="number">1</span>,<span class="string">"foo"</span>,<span class="keyword">undef</span>,<span class="number">13</span> ];</div></pre></td></tr></table></figure>
<p>匿名数组的元素仍然可以是匿名数组，所以可以用这种方法构造数组的数组，可以构造任意维度的数组，如下所示：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">my</span> $aref = [</div><div class="line">        [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>],</div><div class="line">        [<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>],</div><div class="line">        [<span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>],</div><div class="line">]</div></pre></td></tr></table></figure>
<p>在哈希中我们可以用匿名哈希引用，使用 {} 定义：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$href= &#123; <span class="string">APR =&gt;</span><span class="number">4</span>, <span class="string">AUG =&gt;</span><span class="number">8</span> &#125;;</div></pre></td></tr></table></figure>
<p>也可以创建一个没有子程序名的匿名子程序引用:</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$coderef = <span class="function"><span class="keyword">sub</span> </span>&#123; <span class="keyword">print</span> <span class="string">"Runoob!\n"</span> &#125;;</div></pre></td></tr></table></figure>
<h2 id="取消引用">取消引用</h2>
<p>取消引用可以根据不同的类型使用<code>$</code>，<code>@</code>或<code>%</code>来消除，如下所示：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~<span class="regexp">/perl/</span><span class="number">05</span>function$ cat quote.pl </div><div class="line"><span class="comment">#!/usr/bin/perl</span></div><div class="line"></div><div class="line">$var = <span class="number">10</span>;</div><div class="line">$r = \$var; <span class="comment"># $r 引用 $var 标量</span></div><div class="line"><span class="keyword">print</span> <span class="string">"$var is "</span>, $$r, <span class="string">"\n"</span>;  <span class="comment"># 输出本地存储的 $r 的变量值</span></div><div class="line"></div><div class="line">@var = (<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>);<span class="comment"># $r 引用  @var 数组</span></div><div class="line">$r = \@var;</div><div class="line"><span class="keyword">print</span> <span class="string">"@var is "</span>, @$r, <span class="string">"\n"</span>;<span class="comment"># 输出本地存储的 $r 的变量值</span></div><div class="line"></div><div class="line">%var = (<span class="string">'key1'</span> =&gt; <span class="number">10</span>, <span class="string">'key2'</span> =&gt; <span class="number">20</span>);  <span class="comment"># $r 引用  %var 数组</span></div><div class="line">$r = \%var;</div><div class="line"><span class="keyword">print</span> <span class="string">"%var is :"</span>,%$r, <span class="string">"\n"</span>;<span class="comment"># 输出本地存储的 $r 的变量值</span></div><div class="line"></div><div class="line">biotest@ubuntu:~<span class="regexp">/perl/</span><span class="number">05</span>function$ perl quote.pl </div><div class="line"><span class="number">10</span> is <span class="number">10</span></div><div class="line"><span class="number">1</span> <span class="number">2</span> <span class="number">3</span> is <span class="number">123</span></div><div class="line">%var is :key110key22<span class="number">0</span></div></pre></td></tr></table></figure>
<h2 id="判断引用类型">判断引用类型</h2>
<p>如果你不能确定变量类型，你可以使用 ref 来判断，返回值列表如下，如果没有以下的值返回 false：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">SCALAR</div><div class="line">ARRAY</div><div class="line">HASH</div><div class="line">CODE</div><div class="line">GLOB</div><div class="line">REF</div></pre></td></tr></table></figure>
<p>案例如下所示：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~<span class="regexp">/perl/</span><span class="number">05</span>function$ cat determined.pl </div><div class="line"><span class="comment">#!/usr/bin/perl</span></div><div class="line"></div><div class="line">$var = <span class="number">10</span>;</div><div class="line">$r = \$var;</div><div class="line"><span class="keyword">print</span> <span class="string">"Reference type of r is "</span>, <span class="keyword">ref</span>($r), <span class="string">"\n"</span>;</div><div class="line"></div><div class="line">@var = (<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>);</div><div class="line">$r = \@var;</div><div class="line"><span class="keyword">print</span> <span class="string">"Reference type of r is "</span>, <span class="keyword">ref</span>($r), <span class="string">"\n"</span>;</div><div class="line"></div><div class="line">%var = (<span class="string">'key'</span> =&gt; <span class="number">10</span>, <span class="string">'key2'</span> =&gt; <span class="number">20</span>);</div><div class="line">$r = \%var;</div><div class="line"><span class="keyword">print</span> <span class="string">"Reference type of r is "</span>,<span class="keyword">ref</span>($r), <span class="string">"\n"</span>;</div><div class="line">biotest@ubuntu:~<span class="regexp">/perl/</span><span class="number">05</span>function$ perl determined.pl </div><div class="line">Reference type of r is SCALAR</div><div class="line">Reference type of r is ARRAY</div><div class="line">Reference type of r is HASH</div></pre></td></tr></table></figure>
<h2 id="循环引用">循环引用</h2>
<p>循环引用在两个引用相互包含时出现。你需要小心使用，不然会导致内存泄露，如下实例：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~<span class="regexp">/perl/</span><span class="number">05</span>function$ cat quote_loop.pl </div><div class="line"><span class="comment">#!/usr/bin/perl</span></div><div class="line"></div><div class="line"><span class="keyword">my</span> $foo = <span class="number">100</span>;</div><div class="line">$foo = \$foo;</div><div class="line"></div><div class="line"><span class="keyword">print</span> <span class="string">"Value of foo is "</span>, $foo, <span class="string">"\n"</span>;</div><div class="line"></div><div class="line">biotest@ubuntu:~<span class="regexp">/perl/</span><span class="number">05</span>function$ perl quote_loop.pl </div><div class="line">Value of foo is REF(<span class="number">0x1fb50f8</span>)</div></pre></td></tr></table></figure>
<h2 id="引用函数">引用函数</h2>
<p>函数引用格式: <code>\&amp;</code>，调用引用函数格式: <code>&amp; + 创建的引用名</code>，如下所示：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">sub</span> <span class="title">PrintHash</span></span>&#123;</div><div class="line">    <span class="keyword">my</span>(%hash) = @_;</div><div class="line">	</div><div class="line">	<span class="keyword">foreach</span> $item (%hash)&#123;</div><div class="line">	    <span class="keyword">print</span> <span class="string">"Element: $item\n"</span>;</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">%hash = (<span class="string">'name'</span> =&gt; <span class="string">'Baidu'</span>, <span class="string">'age'</span> =&gt; <span class="number">11</span>);</div><div class="line"></div><div class="line">$cref = \&amp;PrintHash;</div><div class="line"></div><div class="line">&amp;$cref(%hash);</div></pre></td></tr></table></figure>
<h2 id="参考资料">参考资料</h2>
<p><a href="http://www.runoob.com/perl/perl-tutorial.html" target="_blank" rel="external">Perl教程|菜鸟教程</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2018/05/17/Perl/Perl学习笔记（6）-函数设计/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/05/17/Perl/Perl学习笔记（6）-函数设计/" itemprop="url">Perl学习笔记（6）-函数设计</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-05-17T12:00:00+08:00">
                2018-05-17
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Perl/" itemprop="url" rel="index">
                    <span itemprop="name">Perl</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  1,457
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  6
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="perl的函数">Perl的函数</h2>
<p>Perl函数也叫子程序，就是用户定义的函数。为了方便，我一律称为函数，不称子程序。Perl函数的语法格式如下所示：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">sub</span> <span class="title">subroutine</span></span>&#123;</div><div class="line">statements;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>调用函数的语法格式为<code>subroutine( 参数列表 )</code>，如下所示： <figure class="highlight perl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">sub</span> <span class="title">Hello</span></span>&#123;</div><div class="line"><span class="keyword">print</span> <span class="string">"Hello, World!\n"</span>;</div><div class="line">&#125;</div><div class="line">Hello();</div></pre></td></tr></table></figure></p>
<p>由于在设计<code>Hello</code>函数时，并没有设计相应的参数，因此在运行时就不需要加参数，但是还需要加上括号。</p>
<h2 id="向函数传递参数">向函数传递参数</h2>
<p>Perl 函数可以和其他编程语言一样接受多个参数，函数参数使用特殊数组<code>@_</code>标明。因此函数第一个参数为<code>_[0]</code>, 第二个参数为<code>_[1]</code>, 以此类推，用户可以通过改变<code>@_</code>数组中的值来改变相应实际参数的值。。不论参数是标量型还是数组型的，用户把参数传给函数时，perl默认按引用的方式调用它们，如下所示： <figure class="highlight perl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~<span class="regexp">/perl/</span><span class="number">05</span>function$ cat function_parameter.pl </div><div class="line"><span class="comment">#!/usr/bin/perl</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">sub</span> <span class="title">mean</span></span>&#123;</div><div class="line">    $n = <span class="keyword">scalar</span>(@_);</div><div class="line">    $sum = <span class="number">0</span>;</div><div class="line">    <span class="keyword">foreach</span> $item(@_)&#123;</div><div class="line">    $sum = $sum + $item;</div><div class="line">&#125;</div><div class="line">$average = $sum/$n;</div><div class="line"><span class="keyword">print</span> <span class="string">'Input parameter is : '</span>,<span class="string">"@_\n"</span>;</div><div class="line"><span class="keyword">print</span> <span class="string">"The first parameter is $_[0]\n"</span>;</div><div class="line"><span class="keyword">print</span> <span class="string">"The average of inputed parameters is $average\n"</span>;</div><div class="line">&#125;</div><div class="line">mean(<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>);</div><div class="line">biotest@ubuntu:~<span class="regexp">/perl/</span><span class="number">05</span>function$ perl function_parameter.pl </div><div class="line">Input parameter is : <span class="number">10</span> <span class="number">20</span> <span class="number">30</span></div><div class="line">The first parameter is <span class="number">10</span></div><div class="line">The average of inputed parameters is <span class="number">20</span></div></pre></td></tr></table></figure></p>
<p>代码解释：scalar不是求元素个数，它用来产生一个标量环境，对数组进行操作时，会返回元素个数。<code>$n = scalar(@_)</code>就是获取所有传入的参数的个数，在这段代码中，n值就是3。</p>
<h2 id="向函数传递列表">向函数传递列表</h2>
<p>由于<code>@_</code>变量是一个数组，所以它可以向函数中传递列表。但如果我们需要传入标量和数组参数，需要把列表放在最后一个参数上，如下所示： <figure class="highlight perl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~<span class="regexp">/perl/</span><span class="number">05</span>function$ cat print_list.pl </div><div class="line"><span class="comment">#!/usr/bin/perl</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">sub</span> <span class="title">PrintList</span></span>&#123;</div><div class="line"><span class="keyword">my</span> @list = @_;</div><div class="line"><span class="keyword">print</span> <span class="string">"List is @list\n"</span>;</div><div class="line">&#125;</div><div class="line">$a = <span class="number">10</span>;</div><div class="line">@b = (<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>);</div><div class="line">PrintList($a, @b);</div><div class="line">biotest@ubuntu:~<span class="regexp">/perl/</span><span class="number">05</span>function$ perl print_list.pl </div><div class="line">List is <span class="number">10</span> <span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">4</span></div></pre></td></tr></table></figure></p>
<h2 id="向函数传递哈希">向函数传递哈希</h2>
<p>当向函数传递哈希表时，它将复制到<code>@_</code>中，哈希表将被展开为键/值组合的列表，如下所示： <figure class="highlight perl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~<span class="regexp">/perl/</span><span class="number">05</span>function$ cat print_hash.pl </div><div class="line"><span class="comment">#!/usr/bin/perl</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">sub</span> <span class="title">PrintHash</span></span>&#123;</div><div class="line">    <span class="keyword">my</span>(%hash) = @_;</div><div class="line">    <span class="keyword">foreach</span> <span class="keyword">my</span>$key (<span class="keyword">keys</span> %hash)&#123;</div><div class="line">    <span class="keyword">my</span> $value =$hash&#123;$key&#125;;</div><div class="line">    <span class="keyword">print</span> <span class="string">"$key:$value\n"</span>;</div><div class="line">   &#125;</div><div class="line">&#125;</div><div class="line">%hash = (<span class="string">'name'</span> =&gt; <span class="string">'Baidu'</span>, <span class="string">'age'</span> =&gt;<span class="number">11</span>);</div><div class="line">PrintHash(%hash);</div><div class="line">biotest@ubuntu:~<span class="regexp">/perl/</span><span class="number">05</span>function$ perl print_hash.pl </div><div class="line">name:Baidu</div><div class="line">age:<span class="number">11</span></div></pre></td></tr></table></figure></p>
<h2 id="函数返回值">函数返回值</h2>
<p>函数可以向其他编程语言一样使用<code>retur</code> 语句来返回函数值。如果没有使用<code>return</code>语句，则函数的最后一行语句将作为返回值，如下所示： <figure class="highlight perl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~<span class="regexp">/perl/</span><span class="number">05</span>function$ cat <span class="keyword">return</span>.pl </div><div class="line"><span class="comment">#!/usr/bin/perl</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">sub</span> <span class="title">add_a_b</span></span>&#123;</div><div class="line">    $_[<span class="number">0</span>] + $_[<span class="number">1</span>];</div><div class="line">&#125;</div><div class="line"><span class="keyword">print</span> add_a_b(<span class="number">1</span>,<span class="number">12</span>).<span class="string">"\n"</span>;</div><div class="line">biotest@ubuntu:~<span class="regexp">/perl/</span><span class="number">05</span>function$ perl <span class="keyword">return</span>.pl </div><div class="line"><span class="number">13</span></div></pre></td></tr></table></figure></p>
<h2 id="函数的局部变量">函数的局部变量</h2>
<p>默认情况下，Perl 中所有的变量都是全局变量，这就是说变量在程序的任何地方都可以调用。如果我们需要设置私有变量（私有变量其实与其他编程语言中的局部变量是一样的，后文一律称为局部变量），可以使 <code>my</code>操作符来设置。<code>my</code>操作符用于创建作用域变量，通过<code>my</code>创建的变量，存活于声明开始的地方，直到闭合作用域的结尾。<code>闭合作用域</code>指的可以是一对花括号中的区域，可以是一个文件，也可以是一个<code>if, while, for, foreach, eval</code>字符串。它的用法如下所示： <figure class="highlight perl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">sub</span> <span class="title">somefunc</span> </span>&#123;</div><div class="line">   <span class="keyword">my</span> $variable; <span class="comment"># $variable在函数somefunc()之外不可见</span></div><div class="line">   <span class="keyword">my</span> ($another, @an_array, %a_hash); <span class="comment">#  同时声明多个变量</span></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>以下案例就演示了如何声明一个或多个局部变量： <figure class="highlight perl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~<span class="regexp">/perl/</span><span class="number">05</span>function$ cat local_variable.pl </div><div class="line"><span class="comment">#!/usr/bin/perl</span></div><div class="line"></div><div class="line">$variable_global = <span class="string">"Hello, World!\n"</span>;</div><div class="line"><span class="function"><span class="keyword">sub</span> <span class="title">PrintHello</span></span>&#123;</div><div class="line">    <span class="keyword">my</span> $variable_global;</div><div class="line">    $variable_global = <span class="string">"Hello, Learner!\n"</span>;</div><div class="line">    <span class="keyword">print</span> <span class="string">"Strings in function is :$variable_global\n"</span>;</div><div class="line">&#125;</div><div class="line">PrintHello();</div><div class="line"><span class="keyword">print</span> <span class="string">"Strings beyond function is : $variable_global\n"</span>;</div><div class="line"></div><div class="line">biotest@ubuntu:~<span class="regexp">/perl/</span><span class="number">05</span>function$ perl local_variable.pl </div><div class="line">Strings in function is :Hello, Learner!</div><div class="line">Strings beyond function is : Hello, World!</div></pre></td></tr></table></figure></p>
<h2 id="变量的临时赋值">变量的临时赋值</h2>
<p>我们可以使用 local 为全局变量提供临时的值，在退出作用域后将原来的值还回去。local定义的变量不存在于主程序中，但存在于该函数和该函数调用的函数中。定义时可以给其赋值，如下所示： <figure class="highlight perl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~<span class="regexp">/perl/</span><span class="number">05</span>function$ cat local_temp.pl </div><div class="line"><span class="comment">#!/usr/bin/perl</span></div><div class="line"></div><div class="line">$variable_global = <span class="string">"Hello, World!\n"</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">sub</span> <span class="title">PrintLocal</span></span>&#123;</div><div class="line"><span class="keyword">local</span> $variable_global;</div><div class="line">$variable_global = <span class="string">"Hello, Learner!\n"</span>; <span class="comment">#临时赋值</span></div><div class="line">PrintMe();</div><div class="line"><span class="keyword">print</span> <span class="string">"PrintLocal function has strings: $variable_global\n"</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">sub</span> <span class="title">PrintMe</span></span>&#123;</div><div class="line"><span class="keyword">print</span> <span class="string">"PrintMe function has strings: $variable_global\n"</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">sub</span> <span class="title">PrintHello</span></span>&#123;</div><div class="line"><span class="keyword">print</span> <span class="string">"PrintHello function has strings: $variable_global\n"</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line">PrintLocal();</div><div class="line">PrintHello();</div><div class="line"><span class="keyword">print</span> <span class="string">"Strings beyond function is : $variable_global\n"</span>;</div><div class="line"></div><div class="line">biotest@ubuntu:~<span class="regexp">/perl/</span><span class="number">05</span>function$ perl local_temp.pl </div><div class="line"></div><div class="line">PrintMe function has strings: Hello, Learner!</div><div class="line"></div><div class="line">PrintLocal function has strings: Hello, Learner!</div><div class="line"></div><div class="line">PrintHello function has strings: Hello, World!</div><div class="line"></div><div class="line">Strings beyond function is : Hello, World!</div></pre></td></tr></table></figure></p>
<h2 id="静态变量">静态变量</h2>
<p><code>state</code>关键字将局部变量永久存在。state也是词法变量，所以只在定义该变量的词法作用域中有效，如下所示： <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~/perl/05function$ cat state.pl </div><div class="line">#!/usr/bin/perl</div><div class="line"></div><div class="line">use feature &apos;state&apos;;</div><div class="line">sub PrintCount&#123;</div><div class="line">state $count = 0;</div><div class="line">print &quot;counter value is : $count\n&quot;;</div><div class="line">$count++;</div><div class="line">&#125;</div><div class="line">for (1..5)&#123;</div><div class="line">PrintCount();</div><div class="line">&#125;</div><div class="line">biotest@ubuntu:~/perl/05function$ perl state.pl </div><div class="line">counter value is : 0</div><div class="line">counter value is : 1</div><div class="line">counter value is : 2</div><div class="line">counter value is : 3</div><div class="line">counter value is : 4</div></pre></td></tr></table></figure></p>
<p>注1：state仅能创建闭合作用域为函数内部的变量。 注2：state是从Perl 5.9.4开始引入的，所以使用前必须加上 use。 注3：state可以声明标量、数组、哈希。但在声明数组和哈希时，不能对其初始化（至少Perl 5.14不支持）。</p>
<h2 id="函数调用上下文">函数调用上下文</h2>
<p>函数调用过程中，会根据上下文来返回不同类型的值，比如<code>localtime()</code>函数，在标量上下文返回字符串，在列表上下文返回列表，如下所示： <figure class="highlight perl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~<span class="regexp">/perl/</span><span class="number">05</span>function$ cat function_context.pl </div><div class="line"><span class="comment">#!/usr/bin/perl</span></div><div class="line"></div><div class="line"><span class="keyword">my</span> $variable = <span class="keyword">localtime</span>(<span class="keyword">time</span>);</div><div class="line"><span class="keyword">print</span> $variable;</div><div class="line"></div><div class="line"><span class="keyword">print</span> <span class="string">"\n"</span>;</div><div class="line"></div><div class="line">($sec,$min,$hour,$mday,$mon, $year,$wday,$yday,$isdst) = <span class="keyword">localtime</span>(<span class="keyword">time</span>);</div><div class="line"><span class="keyword">printf</span>(<span class="string">"%d-%d-%d %d:%d:%d\n"</span>,$year+<span class="number">1990</span>,$mon+<span class="number">1</span>,$mday,$hour,$min,$sec);</div><div class="line"></div><div class="line">biotest@ubuntu:~<span class="regexp">/perl/</span><span class="number">05</span>function$ perl function_context.pl </div><div class="line">Fri May <span class="number">18</span> <span class="number">16</span>:<span class="number">53</span>:<span class="number">48</span> <span class="number">2018</span></div><div class="line"><span class="number">2108</span>-<span class="number">5</span>-<span class="number">18</span> <span class="number">16</span>:<span class="number">53</span>:<span class="number">48</span></div></pre></td></tr></table></figure></p>
<h2 id="参考资料">参考资料</h2>
<p><a href="http://www.runoob.com/perl/perl-tutorial.html" target="_blank" rel="external">Perl教程|菜鸟教程</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2018/05/16/Perl/Perl学习笔记（5）-时间日期处理与格式化输出/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/05/16/Perl/Perl学习笔记（5）-时间日期处理与格式化输出/" itemprop="url">Perl学习笔记（5）-格式化输出与时间日期的处理</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-05-16T12:00:00+08:00">
                2018-05-16
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Perl/" itemprop="url" rel="index">
                    <span itemprop="name">Perl</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  2,291
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  10
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="格式化输出">格式化输出</h2>
<p>Perl 是一个非常强大的文本数据处理语言。Perl 中可以使用 format 来定义一个模板，然后使用 write 按指定模板输出数据。Perl 格式化定义语法格式如下</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">format</span> FormatName =</div><div class="line">fieldline</div><div class="line">value_one, value_two, value_three</div><div class="line">fieldline</div><div class="line">value_one, value_two</div><div class="line">.</div></pre></td></tr></table></figure>
<p>参数解释：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">FormatName ：格式化名称。</div><div class="line">fieldline ：一个格式行，用来定义一个输出行的格式,类似 @,^,&lt;,&gt;,| 这样的字符。</div><div class="line">value_one,value_two…… ：数据行，用来向前面的格式行中插入值,都是perl的变量。</div><div class="line">. ：结束符号。</div></pre></td></tr></table></figure>
<p>看一个简单的案例：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~<span class="regexp">/perl/</span><span class="number">04</span><span class="keyword">time</span>$ cat format01.pl </div><div class="line"><span class="comment">#!/usr/bin/perl</span></div><div class="line"></div><div class="line">$text=<span class="string">"google runoob taobao"</span>;</div><div class="line"><span class="keyword">format</span> STDOUT = </div><div class="line">first:^&lt;&lt;&lt;&lt;&lt; <span class="comment"># left-justified 6 characters</span></div><div class="line">    $text</div><div class="line">second: ^&lt;&lt;&lt;&lt;&lt; <span class="comment"># left-justified 6 characters</span></div><div class="line">    $text</div><div class="line">third: ^&lt;&lt;&lt;&lt; <span class="comment"># left-justified 5 characters, last "o" will be removed</span></div><div class="line">    $text</div><div class="line">.</div><div class="line"><span class="keyword">write</span></div><div class="line"></div><div class="line">biotest@ubuntu:~<span class="regexp">/perl/</span><span class="number">04</span><span class="keyword">time</span>$ perl format01.pl </div><div class="line">first:google</div><div class="line">second: runoob</div><div class="line">third: taoba</div></pre></td></tr></table></figure>
<h2 id="格式行语法">格式行语法</h2>
<ol style="list-style-type: decimal">
<li>格式行以<code>@</code>或者<code>^</code>开头，这些行不作任何形式的变量代换。</li>
<li><code>@</code>字段(不要同数组符号<code>@</code>相混淆)是普通的字段。</li>
<li><code>@,^</code>后的<code>&lt;, &gt;,|</code>长度决定了字段的长度，如果变量超出定义的长度,那么它将被截断。</li>
<li><code>&lt;, &gt;,|</code>还分别表示,左对齐,右对齐,居中对齐。</li>
<li><code>^</code>字段用于多行文本块填充。</li>
</ol>
<h2 id="值域格式">值域格式</h2>
<table>
<thead>
<tr class="header">
<th>格式</th>
<th>值域含义</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>@&lt;&lt;&lt;</code></td>
<td>左对齐输出</td>
</tr>
<tr class="even">
<td><code>@&gt;&gt;&gt;</code></td>
<td>右对齐输出</td>
</tr>
<tr class="odd">
<td><code>@|||</code></td>
<td>中对齐输出</td>
</tr>
<tr class="even">
<td><code>@##.##</code></td>
<td>固定精度数字</td>
</tr>
<tr class="odd">
<td><code>@*</code></td>
<td>多行文本</td>
</tr>
</tbody>
</table>
<p>每个值域的第一个字符是行填充符，当使用<code>@</code>字符时，不做文本格式化。在上表中，除了多行值域<code>@*</code>，域宽都等于其指定的包含字符<code>@</code>在内的字符个数，例如<code>@###.##</code>表示7个字符的宽度，小数点前4个，小数点后2个，如下所示：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~<span class="regexp">/perl/</span><span class="number">04</span><span class="keyword">time</span>$ cat format02.pl </div><div class="line"><span class="comment">#!/usr/bin/perl</span></div><div class="line"></div><div class="line"><span class="keyword">format</span> EMPLOYEE = </div><div class="line">=============================</div><div class="line">@&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;@&lt;&lt;</div><div class="line">$name,$age</div><div class="line">@#<span class="comment">####.##</span></div><div class="line">$salary</div><div class="line">=============================</div><div class="line">.</div><div class="line"></div><div class="line"><span class="keyword">select</span>(STDOUT);</div><div class="line">$~=EMPLOYEE;</div><div class="line"></div><div class="line">@n=(<span class="string">"Ali"</span>,<span class="string">"Runoob"</span>,<span class="string">"Tencent"</span>);</div><div class="line">@a=(<span class="number">20</span>,<span class="number">30</span>,<span class="number">40</span>);</div><div class="line">@s=(<span class="number">2000.00</span>,<span class="number">2500.00</span>,<span class="number">4000.00</span>);</div><div class="line"></div><div class="line">$i=<span class="number">0</span>;</div><div class="line"><span class="keyword">foreach</span>(@n)&#123;</div><div class="line">    $name=$_;</div><div class="line">    $age=$a[$i];</div><div class="line">    $salary=$s[$i++];</div><div class="line">    <span class="keyword">write</span>;</div><div class="line">&#125;</div><div class="line">biotest@ubuntu:~<span class="regexp">/perl/</span><span class="number">04</span><span class="keyword">time</span>$ perl format02.pl </div><div class="line">=============================</div><div class="line">Ali                    <span class="number">20</span></div><div class="line">  <span class="number">2000.00</span></div><div class="line">=============================</div><div class="line">=============================</div><div class="line">Runoob                 <span class="number">30</span></div><div class="line">  <span class="number">2500.00</span></div><div class="line">=============================</div><div class="line">=============================</div><div class="line">Tencent                <span class="number">40</span></div><div class="line">  <span class="number">4000.00</span></div><div class="line">=============================</div></pre></td></tr></table></figure>
<h2 id="格式变量">格式变量</h2>
<ol style="list-style-type: decimal">
<li><code>$~ ($FORMAT_NAME)</code> ：格式名字；</li>
<li><code>$^ ($FORMAT_TOP_NAME)</code> ：当前的表头格式名字存储；</li>
<li><code>$% ($FORMAT_PAGE_NUMBER)</code> ：当前输出的页号；</li>
<li><code>$= ($FORMAT_LINES_PER_PAGE)</code> ：每页中的行数；</li>
<li><code>$| ($FORMAT_AUTOFLUSH)</code> ：是否自动刷新输出缓冲区存储；</li>
<li><code>$^L ($FORMAT_FORMFEED)</code> ：在每一页(除了第一页)表头之前需要输出的字符串存储。</li>
</ol>
<p>在下面的案例中，使用了<code>$~进行格式化，</code>案例如下所示：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"></div></pre></td></tr></table></figure>
<p>如果不指定<code>$~</code>的情况下，会输出名为<code>STDOUT</code>的格式，如下所示：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~<span class="regexp">/perl/</span><span class="number">04</span><span class="keyword">time</span>$ cat format04.pl </div><div class="line"><span class="comment">#!/usr/bin/perl</span></div><div class="line"></div><div class="line"><span class="keyword">write</span>; <span class="comment"># 没有指定$~，程序会会寻找名为STDOUT的格式</span></div><div class="line"><span class="keyword">format</span> STDOUT=</div><div class="line">----------------</div><div class="line">STDOUT formats</div><div class="line">----------------</div><div class="line">.</div><div class="line">biotest@ubuntu:~<span class="regexp">/perl/</span><span class="number">04</span><span class="keyword">time</span>$ perl format04.pl </div><div class="line">----------------</div><div class="line">STDOUT formats</div><div class="line">----------------</div></pre></td></tr></table></figure>
<p>在下面的案例中，添加报表头部信息来说明<code>$^</code>或<code>$FORMAT_TOP_NAME</code>变量的使用：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~<span class="regexp">/perl/</span><span class="number">04</span><span class="keyword">time</span>$ cat format05.pl </div><div class="line"><span class="comment">#!/usr/bin/perl</span></div><div class="line"></div><div class="line"><span class="keyword">format</span> EMPLOYEE =</div><div class="line">====================================</div><div class="line">@&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt; @&lt;&lt;</div><div class="line">$name, $age</div><div class="line">@#<span class="comment">####.##</span></div><div class="line">$salary</div><div class="line">====================================</div><div class="line">.</div><div class="line"></div><div class="line"><span class="keyword">format</span> EMPLOYEE_TOP=</div><div class="line">====================================</div><div class="line">Name                     Age Page @&lt;</div><div class="line">                         $%</div><div class="line">====================================</div><div class="line">.</div><div class="line"></div><div class="line"><span class="keyword">select</span>(STDOUT);</div><div class="line">$~ = EMPLOYEE;</div><div class="line">$^ = EMPLOYEE_TOP;</div><div class="line"></div><div class="line">@n=(<span class="string">"Ali"</span>,<span class="string">"Runoob"</span>,<span class="string">"Tencent"</span>);</div><div class="line">@a=(<span class="number">20</span>,<span class="number">30</span>,<span class="number">40</span>);</div><div class="line">@s=(<span class="number">2000.00</span>,<span class="number">2500.00</span>,<span class="number">4000.000</span>);</div><div class="line"></div><div class="line">$i=<span class="number">0</span>;</div><div class="line"><span class="keyword">foreach</span>(@n)&#123;</div><div class="line">    $name=$_;</div><div class="line">    $age=$a[$i];</div><div class="line">    $salary=$s[$i++];</div><div class="line">    <span class="keyword">write</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line">biotest@ubuntu:~<span class="regexp">/perl/</span><span class="number">04</span><span class="keyword">time</span>$ perl format05.pl </div><div class="line">====================================</div><div class="line">Name                     Age Page <span class="number">1</span></div><div class="line">====================================</div><div class="line">====================================</div><div class="line">Ali                      <span class="number">20</span></div><div class="line">  <span class="number">2000.00</span></div><div class="line">====================================</div><div class="line">====================================</div><div class="line">Runoob                   <span class="number">30</span></div><div class="line">  <span class="number">2500.00</span></div><div class="line">====================================</div><div class="line">====================================</div><div class="line">Tencent                  <span class="number">40</span></div><div class="line">  <span class="number">4000.00</span></div><div class="line">====================================</div></pre></td></tr></table></figure>
<h2 id="输出到其它文件">输出到其它文件</h2>
<p>默认情况下函数<code>write</code>将结果输出到标准输出文件<code>STDOUT</code>，我们也可以使它将结果输出到任意其它的文件中。最简单的方法就是把文件变量作为参数传递给<code>write</code>，例如<code>write(MYFILE)</code>，此时write就用缺省的名为MYFILE的打印格式输出到文件MYFILE中。但是这样就不能用<code>$~</code>变量来改变所使用的打印格式。系统变量<code>$~</code>只对默认文件变量起作用，我们可以改变默认文件变量，改变<code>$~</code>，再调用<code>write</code>，如下所示：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~<span class="regexp">/perl/</span><span class="number">04</span><span class="keyword">time</span>$ cat myfile.pl </div><div class="line"><span class="comment">#!/usr/bin/perl</span></div><div class="line"></div><div class="line"><span class="keyword">if</span>(<span class="keyword">open</span>(MYFILE,<span class="string">"&gt;tmp"</span>))&#123;</div><div class="line">$~=<span class="string">"MYFORMAT"</span>;</div><div class="line"><span class="keyword">write</span> MYFILE;</div><div class="line"></div><div class="line"><span class="keyword">format</span> MYFILE=</div><div class="line">========================</div><div class="line">Input into file</div><div class="line">========================</div><div class="line">.</div><div class="line"><span class="keyword">close</span> MYFILE;</div><div class="line">&#125;</div><div class="line"></div><div class="line">biotest@ubuntu:~<span class="regexp">/perl/</span><span class="number">04</span><span class="keyword">time</span>$ perl myfile.pl </div><div class="line">biotest@ubuntu:~<span class="regexp">/perl/</span><span class="number">04</span><span class="keyword">time</span>$ cat tmp </div><div class="line">========================</div><div class="line">Input into file</div><div class="line">========================</div></pre></td></tr></table></figure>
<p>以使用<code>select</code>改变默认文件变量时，它返回当前默认文件变量的内部表示，这样我们就可以创建子程序，按自己的想法输出，又不影响程序的其它部分，如下所示：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~<span class="regexp">/perl/</span><span class="number">04</span><span class="keyword">time</span>$ cat select.pl </div><div class="line"><span class="comment">#!/usr/bin/perl</span></div><div class="line"></div><div class="line"><span class="keyword">if</span>(<span class="keyword">open</span>(MYFILE,<span class="string">"&gt;&gt;tmp"</span>))&#123;</div><div class="line"><span class="keyword">select</span>(MYFILE);</div><div class="line">$~=<span class="string">"OTHER"</span>;</div><div class="line"><span class="keyword">write</span>;</div><div class="line"></div><div class="line"><span class="keyword">format</span> OTHER=</div><div class="line">========================</div><div class="line">input something into file</div><div class="line">========================</div><div class="line">.</div><div class="line"><span class="keyword">close</span> MYFILE;</div><div class="line">&#125;</div><div class="line">biotest@ubuntu:~<span class="regexp">/perl/</span><span class="number">04</span><span class="keyword">time</span>$ perl select.pl </div><div class="line">biotest@ubuntu:~<span class="regexp">/perl/</span><span class="number">04</span><span class="keyword">time</span>$ cat tmp</div><div class="line">========================</div><div class="line">Input into file</div><div class="line">========================</div><div class="line">========================</div><div class="line">input something into file</div><div class="line">========================</div></pre></td></tr></table></figure>
<h2 id="perl中处理时间的函数">Perl中处理时间的函数</h2>
<p>Perl中处理时间的函数有以下这些： 1. time() 函数：返回从1970年1月1日起累计的秒数 2. localtime() 函数：获取本地时区时间 3. gmtime() 函数： 获取格林威治时间</p>
<h2 id="当前时间和日期">当前时间和日期</h2>
<p><code>localtime()</code>函数返回当前的时间和日期。 以下 9 个符号代表不同的时间日期参数：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">sec,     # 秒， 0 到 61</div><div class="line">min,     # 分钟， 0 到 59</div><div class="line">hour,    # 小时， 0 到 24</div><div class="line">mday,    # 天， 1 到 31</div><div class="line">mon,     # 月， 0 到 11</div><div class="line">year,    # 年，从 1900 开始</div><div class="line">wday,    # 星期几，0-6,0表示周日</div><div class="line">yday,    # 一年中的第几天,0-364,365</div><div class="line">isdst    # 如果夏令时有效，则为真</div></pre></td></tr></table></figure>
<p>使用案例如下所示：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~<span class="regexp">/perl/</span><span class="number">04</span><span class="keyword">time</span>$ cat time.pl </div><div class="line">@months = <span class="string">qw(Janurary February March April May June July August September October November December)</span>;</div><div class="line">@days = <span class="string">qw(Sunday Saturday Monday Tuesday Wednesday Friday)</span>;</div><div class="line"></div><div class="line">($sec, $min, $hour, $mday,$mon,$year, $wday, $yday, $isdst) = <span class="keyword">localtime</span>() ;</div><div class="line"></div><div class="line"><span class="keyword">print</span><span class="string">"$mday $months[$mon] $days[$wday]\n"</span>;</div><div class="line">biotest@ubuntu:~<span class="regexp">/perl/</span><span class="number">04</span><span class="keyword">time</span>$ perl time.pl </div><div class="line"><span class="number">18</span> May Friday</div></pre></td></tr></table></figure>
<p>如果直接调用 localtime() ，它返回系统当期设置时区的时间，如下所示：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~<span class="regexp">/perl/</span><span class="number">04</span><span class="keyword">time</span>$ cat localtime.pl </div><div class="line"><span class="comment">#!/usr/bin/perl</span></div><div class="line"></div><div class="line">$datenow=<span class="keyword">localtime</span>();</div><div class="line"><span class="keyword">print</span> <span class="string">"Now time is $datenow\n"</span>;</div><div class="line">biotest@ubuntu:~<span class="regexp">/perl/</span><span class="number">04</span><span class="keyword">time</span>$ perl localtime.pl </div><div class="line">Now <span class="keyword">time</span> is Fri May <span class="number">18</span> <span class="number">16</span>:<span class="number">05</span>:<span class="number">51</span> <span class="number">2018</span></div></pre></td></tr></table></figure>
<h2 id="格林威治时间-gmt">格林威治时间 (GMT)</h2>
<p>函数 gmtime() 与 localtime() 类似，但它返回标准格林威治时间，如下所示： <figure class="highlight perl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~<span class="regexp">/perl/</span><span class="number">04</span><span class="keyword">time</span>$ cat gmt.pl </div><div class="line"><span class="comment">#!/usr/bin/perl</span></div><div class="line"></div><div class="line">$Chongqing_time = <span class="keyword">localtime</span>();</div><div class="line">$gmt_time = <span class="keyword">gmtime</span>();</div><div class="line"></div><div class="line"><span class="keyword">print</span> <span class="string">"Chongqing time is $Chongqing_time\n"</span>;</div><div class="line"><span class="keyword">print</span> <span class="string">"GMT time is $gmt_time\n"</span>;</div><div class="line">biotest@ubuntu:~<span class="regexp">/perl/</span><span class="number">04</span><span class="keyword">time</span>$ perl gmt.pl </div><div class="line">Chongqing <span class="keyword">time</span> is Fri May <span class="number">18</span> <span class="number">16</span>:<span class="number">07</span>:<span class="number">05</span> <span class="number">2018</span></div><div class="line">GMT <span class="keyword">time</span> is Fri May <span class="number">18</span> <span class="number">23</span>:<span class="number">07</span>:<span class="number">05</span> <span class="number">2018</span></div></pre></td></tr></table></figure></p>
<p>运行结果可以看出，中国当地时间和格林威治时间相差了8小时，中国是东八区。</p>
<h2 id="格式化日期和时间">格式化日期和时间</h2>
<p>使用<code>localtime()</code>函数的 9 个时间元素来可以输出需要制定的格式时间。格式化输出使用 printf() 函数，如下所示： <figure class="highlight perl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~<span class="regexp">/perl/</span><span class="number">04</span><span class="keyword">time</span>$ cat format_time.pl </div><div class="line"><span class="comment">#!/usr/bin/perl</span></div><div class="line"></div><div class="line">($sec,$min,$hour,$mday,$mon,$year,$wday,$yday,$isdst)=<span class="keyword">localtime</span>();</div><div class="line"></div><div class="line"><span class="keyword">printf</span>(<span class="string">"Formated time is HH:MM:SS\n"</span>);</div><div class="line"><span class="keyword">printf</span>(<span class="string">"%02d:%02d:%02d\n"</span>, $hour, $min, $sec);</div><div class="line">biotest@ubuntu:~<span class="regexp">/perl/</span><span class="number">04</span><span class="keyword">time</span>$ perl format_time.pl </div><div class="line">Formated <span class="keyword">time</span> is HH:MM:SS</div><div class="line"><span class="number">16</span>:<span class="number">10</span>:<span class="number">03</span></div></pre></td></tr></table></figure></p>
<h2 id="新纪元时间epoch-time">新纪元时间(Epoch Time)</h2>
<p>使用 time() 函数来获取新纪元时间，该函数返回从1970年1月1日起累计的秒数，如下所示：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~<span class="regexp">/perl/</span><span class="number">04</span><span class="keyword">time</span>$ cat epoch_time.pl </div><div class="line"><span class="comment">#!/usr/bin/perl</span></div><div class="line"></div><div class="line">$epoch_time = <span class="keyword">time</span>();</div><div class="line"><span class="keyword">print</span> <span class="string">"Accumulated seconds from 1970.1.1. is $epoch_time\n"</span>;</div><div class="line">biotest@ubuntu:~<span class="regexp">/perl/</span><span class="number">04</span><span class="keyword">time</span>$ perl epoch_time.pl </div><div class="line">Accumulated seconds from <span class="number">1970.1</span>.<span class="number">1</span>. is <span class="number">1526685082</span></div></pre></td></tr></table></figure>
<p>也可以输出一个用户想要的时间格式，如下所示： <figure class="highlight perl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~<span class="regexp">/perl/</span><span class="number">04</span><span class="keyword">time</span>$ cat custom_time.pl </div><div class="line"><span class="comment">#!/usr/bin/perl</span></div><div class="line"></div><div class="line">($sec,$min,$hour,$mday,$mon,$year,$wday,$yday,$isdst) = <span class="keyword">localtime</span>();</div><div class="line"><span class="keyword">print</span> <span class="string">"Current time and date"</span>;</div><div class="line"><span class="keyword">printf</span> (<span class="string">"%d-%d-%d %d:%d:%d"</span>, $year+<span class="number">1900</span>, $mon +<span class="number">1</span>, $mday, $hour, $min, $sec);</div><div class="line"></div><div class="line"><span class="keyword">print</span> <span class="string">"\n"</span>;</div><div class="line"></div><div class="line">$epoch_time = <span class="keyword">time</span>();</div><div class="line">$epoch_time = $epoch_time - <span class="number">24</span>*<span class="number">60</span>*<span class="number">60</span>; </div><div class="line">($sec, $min, $hour, $mday, $mon, $year, $wday, $yday, $isdst) = <span class="keyword">localtime</span>($epoch_time);</div><div class="line"></div><div class="line"><span class="keyword">print</span> <span class="string">"Yesterady time and date is: "</span>;</div><div class="line"><span class="keyword">printf</span> (<span class="string">"%d-%d-%d %d:%d:%d"</span>, $year+<span class="number">1900</span>, $mon +<span class="number">1</span>, $mday, $hour, $min, $sec);</div><div class="line"></div><div class="line"><span class="keyword">print</span> <span class="string">"\n"</span>;</div><div class="line">biotest@ubuntu:~<span class="regexp">/perl/</span><span class="number">04</span><span class="keyword">time</span>$ perl custom_time.pl </div><div class="line">Current <span class="keyword">time</span> <span class="keyword">and</span> date2018-<span class="number">5</span>-<span class="number">18</span> <span class="number">16</span>:<span class="number">12</span>:<span class="number">46</span></div><div class="line">Yesterady <span class="keyword">time</span> <span class="keyword">and</span> date is: <span class="number">2018</span>-<span class="number">5</span>-<span class="number">17</span> <span class="number">16</span>:<span class="number">12</span>:<span class="number">46</span></div></pre></td></tr></table></figure></p>
<h2 id="posix-函数-strftime">POSIX 函数 strftime()</h2>
<p>函数<code>strftime()</code>可以将时间格式化为我们想要的格式。 下表列出了一些格式化的符号，<code>*</code> 号表示想要依赖本地时间：</p>
<table>
<thead>
<tr class="header">
<th>符号</th>
<th>描述</th>
<th>实例</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>%a</td>
<td>星期几的简称（ Sun..Sat） <code>*</code></td>
<td>Thu</td>
</tr>
<tr class="even">
<td>%A</td>
<td>星期几的全称（ Sunday..Saturday） <code>*</code></td>
<td>Thursday</td>
</tr>
<tr class="odd">
<td>%b</td>
<td>月的简称（Jan..Dec） <code>*</code></td>
<td>Aug</td>
</tr>
<tr class="even">
<td>%B</td>
<td>月的全称（January..December） <code>*</code></td>
<td>August</td>
</tr>
<tr class="odd">
<td>%c</td>
<td>日期和时间 *</td>
<td>Thu Aug 23 14:55:02 2001</td>
</tr>
<tr class="even">
<td>%C</td>
<td>年份除于100，并取整 (00-99)</td>
<td>20</td>
</tr>
<tr class="odd">
<td>%d</td>
<td>一个月的第几天 (01-31)</td>
<td>23</td>
</tr>
<tr class="even">
<td>%D</td>
<td>日期, MM/DD/YY 相等于%m/%d/%y</td>
<td><code>08/23/01</code></td>
</tr>
<tr class="odd">
<td>%e</td>
<td>一个月的第几天，使用空格填充个位数 ( 1-31)</td>
<td>23</td>
</tr>
<tr class="even">
<td>%F</td>
<td>YYYY-MM-DD 的简写类似于 %Y-%m-%d</td>
<td>2001/8/23</td>
</tr>
<tr class="odd">
<td>%g</td>
<td>年份的最后两位数 (00-99)</td>
<td>1</td>
</tr>
<tr class="even">
<td>%g</td>
<td>年</td>
<td>2001</td>
</tr>
<tr class="odd">
<td>%h</td>
<td>月的简称 <code>*</code>(和%b选项相同)</td>
<td>Aug</td>
</tr>
<tr class="even">
<td>%H</td>
<td>24 小时制 (00-23)</td>
<td>14</td>
</tr>
<tr class="odd">
<td>%I</td>
<td>12 小时制 (01-12)</td>
<td><code>02</code></td>
</tr>
<tr class="even">
<td>%j</td>
<td>一年的第几天 (001-366)</td>
<td>235</td>
</tr>
<tr class="odd">
<td>%m</td>
<td>月 (01-12)</td>
<td><code>08</code></td>
</tr>
<tr class="even">
<td>%M</td>
<td>分钟 (00-59)</td>
<td>55</td>
</tr>
<tr class="odd">
<td>%n</td>
<td>新行 (‘’)</td>
<td></td>
</tr>
<tr class="even">
<td>%p</td>
<td>显示出AM或PM</td>
<td>PM</td>
</tr>
<tr class="odd">
<td>%r</td>
<td>时间（hh：mm：ss AM或PM），12小时 <code>*</code></td>
<td><code>02:55:02 pm</code></td>
</tr>
<tr class="even">
<td>%R</td>
<td>24 小时 HH:MM 时间格式,相等于 %H:%M</td>
<td>14:55</td>
</tr>
<tr class="odd">
<td>%S</td>
<td>秒数 (00-61)</td>
<td><code>02</code></td>
</tr>
<tr class="even">
<td>%t</td>
<td>水平制表符 (‘’)</td>
<td></td>
</tr>
<tr class="odd">
<td>%T</td>
<td>时间（24小时制）（hh:mm:ss），相等于%H:%M:%S</td>
<td>14:55</td>
</tr>
<tr class="even">
<td>%u</td>
<td>ISO 8601 的星期几格式，星期一为1 (1-7)</td>
<td>4</td>
</tr>
<tr class="odd">
<td>%U</td>
<td>一年中的第几周，星期天为第一天(00-53)</td>
<td>33</td>
</tr>
<tr class="even">
<td>%V</td>
<td>ISO 8601 第几周 (00-53)</td>
<td>34</td>
</tr>
<tr class="odd">
<td>%w</td>
<td>一个星期的第几天（0代表星期天） (0-6)</td>
<td>4</td>
</tr>
<tr class="even">
<td>%W</td>
<td>一年的第几个星期，星期一为第一天 (00-53)</td>
<td>34</td>
</tr>
<tr class="odd">
<td>%x</td>
<td>显示日期的格式（mm/dd/yy） <code>*</code></td>
<td>08/23/01</td>
</tr>
<tr class="even">
<td>%X</td>
<td>显示时间格式 <code>*</code></td>
<td>14:55:02</td>
</tr>
<tr class="odd">
<td>%y</td>
<td>年，两位数 (00-99)</td>
<td><code>01</code></td>
</tr>
<tr class="even">
<td>%Y</td>
<td>年</td>
<td>2018</td>
</tr>
<tr class="odd">
<td>%z</td>
<td>ISO 8601与UTC的时区偏移(1 minute=1, 1 hour=100)</td>
<td><code>+100</code></td>
</tr>
<tr class="even">
<td>%Z</td>
<td>当前时区的名称,如“中国标准时间” <code>*</code></td>
<td>CDT</td>
</tr>
<tr class="odd">
<td>%%</td>
<td>% 符号</td>
<td>%</td>
</tr>
</tbody>
</table>
<p>使用案例如下所示：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">biotest@ubuntu:~<span class="regexp">/perl/</span><span class="number">04</span><span class="keyword">time</span>$ cat strftime.pl </div><div class="line"><span class="comment">#!/usr/bin/perl</span></div><div class="line"><span class="keyword">use</span> POSIX <span class="string">qw(strftime)</span>;</div><div class="line"></div><div class="line">$current_time = strftime <span class="string">"%Y-%m-%d %H:%M:%S"</span>, <span class="keyword">localtime</span>;</div><div class="line"><span class="keyword">printf</span> (<span class="string">"Time and Date - $current_time\n"</span>);</div><div class="line"></div><div class="line">$current_time = strftime <span class="string">"%Y-%m-%d %H:%M:%S"</span>, <span class="keyword">gmtime</span>;</div><div class="line"><span class="keyword">printf</span> <span class="string">"Time and Date - $current_time\n"</span>;</div><div class="line">biotest@ubuntu:~<span class="regexp">/perl/</span><span class="number">04</span><span class="keyword">time</span>$ perl strftime.pl </div><div class="line">Time <span class="keyword">and</span> Date - <span class="number">2018</span>-<span class="number">05</span>-<span class="number">18</span> <span class="number">16</span>:<span class="number">20</span>:<span class="number">05</span></div><div class="line">Time <span class="keyword">and</span> Date - <span class="number">2018</span>-<span class="number">05</span>-<span class="number">18</span> <span class="number">23</span>:<span class="number">20</span>:<span class="number">05</span></div></pre></td></tr></table></figure>
<h2 id="参考资料">参考资料</h2>
<p><a href="http://www.runoob.com/perl/perl-tutorial.html" target="_blank" rel="external">Perl教程|菜鸟教程</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/2/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span><a class="page-number" href="/page/4/">4</a><span class="space">&hellip;</span><a class="page-number" href="/page/10/">10</a><a class="extend next" rel="next" href="/page/4/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">RVDSD</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">100</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">9</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">93</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          <div class="links-of-author motion-element">
            
          </div>

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

<div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">RVDSD</span>

  
</div>



<div class="powered-by">
<i class="fa fa-user-md"></i><span id="busuanzi_container_site_uv">
  本站访客数:<span id="busuanzi_value_site_uv"></span>
</span>
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.3</div>




<div class="theme-info">
  <div class="powered-by"></div>
  <span class="post-count">博客全站共338.5k字</span>
</div>

        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.3"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.3"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.3"></script>



  


  




	





  





  










  
  <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/valine@1.1.4/dist/Valine.min.js"></script>
  <script type="text/javascript">
    new Valine({
        av: AV,
        el: '#vcomments' ,
        verify: true,
        notify: true,
        app_id: '4ORLDMxXCFDLSHPJ4wSSDkkw-gzGzoHsz',
        app_key: 'HSWpCY7XlN0pGV5DCrKoC0ic',
        placeholder: 'Comment input placeholder'
    });
  </script>



  





  

  

  
  

  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config("");
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="custom_mathjax_source">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->
  


  

  

</body>
</html>
