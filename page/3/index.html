<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.3" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.3">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.3" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta property="og:type" content="website">
<meta property="og:title" content="RVDSD的个人笔记本">
<meta property="og:url" content="http://rvdsd.top/page/3/index.html">
<meta property="og:site_name" content="RVDSD的个人笔记本">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="RVDSD的个人笔记本">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.3',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://rvdsd.top/page/3/"/>





  <title>RVDSD的个人笔记本</title><!-- hexo-inject:begin --><!-- hexo-inject:end -->
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">RVDSD的个人笔记本</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2019/08/05/Literature/文献笔记-RNA sequencing the teenage years/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/08/05/Literature/文献笔记-RNA sequencing the teenage years/" itemprop="url">文献笔记-RNA sequencing the teenage years</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-08-05T12:00:00+08:00">
                2019-08-05
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/文献笔记/" itemprop="url" rel="index">
                    <span itemprop="name">文献笔记</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  29,502
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  105
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="文献信息"><a href="#文献信息" class="headerlink" title="文献信息"></a>文献信息</h2><p>本文是2019年7月份发表在《Nature Reviews Genetics》上的有关RNA-seq的综述文章。</p>
<p>文献信息如下所示：</p>
<p>Stark, R., et al. (2019). “RNA sequencing: the teenage years.” Nature Reviews Genetics.</p>
<h2 id="摘要"><a href="#摘要" class="headerlink" title="摘要"></a>摘要</h2><p>在过去的十年中，RNA测序(RNA-seq)已经成为在全转录组范围内分析差异基因表达和mRNAs差异剪接的重要工具。然而，随着下一代测序技术的发展，RNA-seq技术也在不断发展。现在，RNA-seq用于研究RNA生物学的许多方面，其中包括单细胞基因表达、翻译（翻译组,translatome）和RNA结构（结构组，structurome）。RNA-seq的其它应用也在开发中，例如空间转录学(spatialomics)。加上新的长读长 （long-read，<strong>注：在本文中，RNA-seq测序生成的read统一译为“读长“</strong>）和直接RNA-seq(direct RNA-seq)技术以及用于数据分析的更好的计算工具的整合，RNA-seq技术的创新有助于人们更全面地理解RNA生物学，例如从何时何地转录发生到控制RNA功能的折叠和分子间相互作用等问题。</p>
<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>RNA-seq技术出现于十年之前，自其诞生之日起，RNA-seq就成了研究分子生物学的普遍工具，这项技术几乎构成了我们对基因组功能的认知基础 。RNA-seq中最常用的分析方法就是找出<strong>差异基因表达(Differential gene expression, DGE)</strong>。从最早的出版期刊开始，DGE分析的基本阶段就未发生实质性的改变。在实验室中，其标准流程就分为三步：</p>
<p>第一步是构建测序文库，这一步骤包括提取RNA，富集mRNA或清除核糖体RNA，合成 cDNA，加上接头。</p>
<p>第二步，在高通量平台（通常是Illumina平台）上对文库进行测序，每个样本的测序深度为10-30M读长数（读长这里就是前面说的reads）。</p>
<p>第三步是数据分析，具体的工作是：对测序得到的读长进行<strong>比对(aligning)</strong>和/或组装到转录组上，对这些覆盖了转录组的读长进行过滤，归一化(Normalization)，根据统计模型找出那些在不同样本之间有差异的转录本。早期的RNA-seq从大量的实验样本中产生了DGE数据，这充分说明了RNA-seq在广泛的生物体以及系统中的使用，这些生物体包括玉米(Zea mays), 拟南芥(Arabiodopsis thaliana), 酿酒酵母（Saccharomyces cerevisae），小鼠(Mus musculus)以及人类。虽然RNA-seq这个术语经常被用于那些完全不同的方法学方法和/或生物学，但是DGE分析仍然是RNA-seq（补充材料中的表1）的主要应用，并被视为常规研究工具。</p>
<p>RNA-seq的更广泛应用已经促进了我们对生物学多方面的理解 ，例如通过提示mRNA剪接和非编码RNAs和增强子RNAs对基因表达的调控。RNA-seq的应用和进步是由技术发展（湿实验室和计算生物学）驱动的，相对于以前的基因芯片，RNA-seq这种方法对RNA生物学和转录组产生更丰富并且偏见更小的信息。到目前为止，从标准的RNA-seq方法衍生而来的各种RNA-seq方法几乎有100种。Illumina的短读长(short-read)测序平台能对这些由大部分不同方法的RNA-seq构建的文库进行测序，但是最近长读长(long-read)RNA-seq的与直接RNA-seq测序(direct RNA sequencing, dRNA-seq)的进步已经能够解决以前研究人员使用短序列手段无法解决的一些问题。</p>
<p>在这篇综述中，我们首先会介绍一些最基本的短读长RNA-seq中的DGE方法，再将这种基础方法与最近新兴的长读长RNA-seq和dRNA-seq进行比较。我们会介绍短读长测序方法在文库制备方面的进展，以及实验设计和DGE的数据分析方法。随后我们会拓展这些常规的RNA-seq方法，介绍一些单细胞测序和空间转录组学的分析。我们会提供一些案例，介绍RNA-seq在RNA生物学方面的关键应用，包括转录组分析，翻译动力学，RNA结构，RNA-RNA之间相互作用和RNA-蛋白质的相互作用。最后，我们会简单描述一下RNA-seq的未来，以及单细胞和空间RNA-seq方法是否会像DGE分析一样成为常规工具，长读长测序方法是否会取代短读长测序方法。由于篇幅限制，我们无法介绍所有的RNA-seq方法，在这些方法中，值得注意的是非编码转录组学，原核转录组学(prokaryotic transcriptomes)和表观转录组学(epitranscriptome)。</p>
<h2 id="RNA-seq技术的发展历史"><a href="#RNA-seq技术的发展历史" class="headerlink" title="RNA-seq技术的发展历史"></a>RNA-seq技术的发展历史</h2><p>Illumina的短序列读长测序技术生成了<strong>SRA(Short Read Archive)</strong>中95%已表达的数据（附件表2）。由于cDNA的短序列读长测序方法几乎是一种常规的方法，因此 我们认为这是一种最基础的 RNA-seq技术，我们先来讨论这种测序主要流程与局限。不过，长读长cDNA测序与dRNA-seq已经兴起，随着研究人员对能提供更丰富转录本水平方面(isoform-level)数据需求增大，这两种新的测序方法有望对常规的短读长测序方法提出挑战(FIG1, TABLE1)。</p>
<h3 id="Table1-短读长与长读长RNA-seq平台"><a href="#Table1-短读长与长读长RNA-seq平台" class="headerlink" title="Table1-短读长与长读长RNA-seq平台"></a>Table1-短读长与长读长RNA-seq平台</h3><div class="table-container">
<table>
<thead>
<tr>
<th>测序技术</th>
<th>平台</th>
<th>优势</th>
<th>劣势</th>
<th>重要应用</th>
</tr>
</thead>
<tbody>
<tr>
<td>短读长cDNA</td>
<td>Illumina，   Ion   Torrent</td>
<td>①高通量，一次运行产生的读长是长读长平台的100倍到1000倍。②偏倚与错误明确（对Ion   Torrent平台来说，聚合物(homopolymers)仍是一个问题）。③ 现在有大量可兼容的方法和计算流程；   4． 可对降解的RNA进行分析。</td>
<td>①样本制备包括逆转录，PCR与片段大小选择，所有的这些操作增加了测序偏倚。②针对异构体检测与定量的能力有限。③转录本发现分析需要从头对转录本进行比对和/或组装步骤。</td>
<td>几乎所有的RNA-seq方法都已经是针对短读长cDNA测序而开发的：DGE，WETA，smallRNA， 半日细胞，空间转录组，nascent RNA，翻译组，结构和RNA-蛋白质相互作用分析等等。</td>
</tr>
<tr>
<td>长读长cDNA</td>
<td>PacBio，   ONT</td>
<td>①可捕获1-50kb的长读长；   ②从头转录组分析方法简单。</td>
<td>①中低通量：目前一次运行只能生成0.5M到10M的读长；②样本制备包括逆转录，PCR和片段选择，增加了偏倚；③针对降解的RNA分析能力有限。</td>
<td>用于研究新异构体，从头转录组分析，融合转录本发现，MHC，HAL或其它复杂的转录本分析。</td>
</tr>
<tr>
<td>长读长RNA</td>
<td>ONT</td>
<td>①可捕获许多1-50kb的全长转录组；②从头转录组分析方法简单；   ③样本制备并不需要进行逆转录或PCR，从而降低了PCR导致的偏倚；④ 可检测RNA的修饰；⑤ 直接在单细胞水平上对poly(A)进行估计。   ①</td>
<td>低通量，目前一次运行只能生成0.5M到1M的读长；②样本制备与测序偏倚不明；③无法对降解的RNA进行分析。</td>
<td>①用于研究新异构体，从头转录本分析，融合转录本，MHC，HLA或其它的复杂转录本分析。②检测核糖核酸修饰。</td>
</tr>
</tbody>
</table>
</div>
<h3 id="Figure-1-短读长，长读长和直接RNA-seq技术与工作流程"><a href="#Figure-1-短读长，长读长和直接RNA-seq技术与工作流程" class="headerlink" title="Figure 1-短读长，长读长和直接RNA-seq技术与工作流程"></a>Figure 1-短读长，长读长和直接RNA-seq技术与工作流程</h3><p><img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190805185923.png" alt=""></p>
<p><strong>Figure 1-短读长，长读长和直接RNA-seq技术与工作流程。</strong></p>
<p><strong>(a)不同RNA-se方法的文库制备，这些方法可以分为3种，分别是短读长测序（黑色），长读长测序（绿色），或长读长直接RNA-seq（蓝色）。根据使用的文库制备方法不同，文库制备会表现出相应的复杂性和偏倚。短读长与长读长cDNA文库在制备时有一些步骤是相同的，不过所有的方法都需要一个接头连接步骤，并且它们都受到样本质量和文库上下游计算问题的影响。</strong></p>
<p><strong>(b)三种主流的RNA-seq测序方法。</strong></p>
<p><strong>Illumina的工作流程（左边）：文库制备好后，每个cDNA就会在一个泳道(flowcell)上通过合成来聚集成簇，其中合成的过程使用3’阻断的荧光标记的核苷酸。在每一轮测序的过程中，新合成的DNA链就会被成像，从而检测出参与合成的是哪种核苷酸，这种测序方法产生的读长是50-500bp。</strong></p>
<p><strong>Pacific Biosciences工作流程（中间）：文库制备好后，每个分子被加载到一个测序芯片上，在芯片上这些分子与固定到纳米孔(nanowell)底部的聚合酶进行结合。随着每一个荧光标记的核苷酸被整合到新合成的链上，这些核苷酸发出的荧光就会被检测到，这种方法产生的读长为50kb。</strong></p>
<p><strong>Oxford纳米孔工作流程（右边）：文库制备好后，每个分子被加载到流动室(flowccell)中，流式室中含有马达蛋白，马达蛋白固定在流动室中，它可以与文库的接头结合。马达蛋白控制RNA链通过纳米孔，从而造成纳米孔中电流的改变，这种技术产生的读长为1-10kb。</strong></p>
<p><strong>(c) 短读长、长读长与直接RNA-seq分析的比较。超过90%的人类基因(gene n)存在可变剪接，它们会形成两个或更多的可表达异构体（转录本x与y）。短读长cDNA测序中就增加了捕获信息的复杂性，短读长对异构体的检测会受到其读长的限制，在这种技术里，短读长无法精确地回贴（注：测序分析方法中的术语“map“在本文中都译为”回贴“）到转录组上，而长读长测序方法则能直接鉴定异构体。在短读长cDNA测序中，有很大比例的读长会不明确地回贴到不同异构相同的外显子上；而那些跨越了外显子-外显子连接处的读长可以提高对异构体的分析效果，但是当不同的异构体都含有这个连接处时，这种操作意义不大。这些问题都加剧了数据分析的复杂性，以及无法对结果进行明确地解释。长读长cDNA方法能够产生全长的异构体读长，从而去除或大幅度降低这些不精确的结果，并改进差异异构表达的分析结果。然而这些方法依赖于cDNA的转换，它去除了RNA碱基的修饰信息，并且只能粗略地估计多聚腺苷酸(poly(A))尾巴长度。直接RNA-seq可以进行全长导构体分析，碱基修饰检测（例如N6-甲基腺苷(M6A)）和poly(A)尾巴长度估计。</strong></p>
<h3 id="短读长cDNA测序"><a href="#短读长cDNA测序" class="headerlink" title="短读长cDNA测序"></a>短读长cDNA测序</h3><p>短读长已经成了在整个转录组范围内对基因进行检测和定量的事实方法(de facto method)，部分原因是这种方法比芯片成本更低，操作更方便，但是其主要原因还是因为这种方法能生成更全面，更高质量的数据，这种方法能够 对整个转录组中的基因表达水平进行定量。使用Illumina短读长测序平台进行DGE分析的核心步骤包括： RNA提取、cDNA合成、接头连接、PCR扩增、测序和数据分析(FIG1)。在这个过程中，存在打断片段，片段长度选择和基于磁珠的文库纯化这些操作，因此这种方法产生的cDNA片段通常都是在200bp以下。RNA-seq文库的测序读长分配到每个样本上的话，每个样本会测到平均20-30 million条读长(reads)（也就是常说的20-30M条读长），数据经过处理后，使用这些读长对每个基因或转录本进行定量，最后再用统计学方法来统计基因的差异。短读长RNA-seq方法很稳健，并且通过对短读长测序技术的大范围比较发现，这种技术在平台内和平台间的相关性很好。但是，在样本制备和数据分析这两个阶段会引入一些干扰和偏倚。这种局限可能会影响通过实验来解决特定生物学问题的能力，例如准确识别和量化多个异构体中的哪个来源于一个基因。对于研究那些非常长，高度可变的转录本异构的人来说，这种局限表现得尤为明显，例如在人类转录组研究中；人类转录本的长度范围是109bp到186kb，其中50%转录本长度大于2500bp。尽管短读长RNA-seq可以对最长的转录本进行详细的分析，但是涉及的实验方法不能扩展到全转录组分析。其他的偏倚与局限来源于那些大量的计算方法，这些方法包括例如如何处理模糊或多个回贴的读长(multi-mapped reads)。现在出现了一种<strong>合成长读长(synthetic long reads)</strong>的新方法，这种方法可以实现全长的mRNA测序，并试图解决其中的一些局限。这种方法使用了<strong>唯一分子标识符(unique molecular identifiers,UMI)</strong>来标记全长的cDNA，在制备短读长RNA文库之前，加入的UMI会随着单个cDNA分子而进行复制。转录本异构体可以在高达4kd的contigs中重建，用于发现异构体和表达分析。但是，对于从根本上解决短读长cDNA测序固有局限的最可能解决方案则是长读长cDNA测序和dRNA-seq测序 。</p>
<h3 id="长读长cDNA测序"><a href="#长读长cDNA测序" class="headerlink" title="长读长cDNA测序"></a>长读长cDNA测序</h3><p>虽然Illumina测序目前是占主导地位的RNA-seq平台，但PacBio和Oxford Nanopore(ONT)公司都提供了可供选择的长读长技术，能够对完整的单个RNA分子进行单分子水平级的测序。通过消除短RNA-seq测序数据的组装这一步，这些新方法克服了短读长测序方法相关的一些问题。例如，减少了测序读长回贴过程中的歧义，并且可以识别更长的转录本，这样就能获取更完整的异构体多样性信息。这些方法还能降低许多短读长RNA-seq计算工具中关于剪接连接的假阳性。</p>
<p>PacBio的Iso-Seq技术可以读取最高可达15kb的转录本的全长cDNA，这就有利于发现大量以前未注释的转录本，并通过检测物种的全长同源序列证实了早期的基因预测。在标准的Iso-Seq操作流程中，高质量的RNA被一个模板切换凝聚力转录酶(a template-switching reverse transcriptase)反转录为全长的cDNA。生成的cDNAs再经过PCR扩增，加入到PacBio的单分子实时(single-molecule, real-time)文库制备系统中。制备好的短转录本序列可以很快地扩散到测序芯片的活性表面，但由于短转录本的测序存在偏倚，因此在对转录本进行测序时，建议选择片段的长度是1到4kb，这样就能在此范围对长转录本和短转录本进行更加均匀地采样。由于PacBio测序方法需要大量的模板，因此需要进行多轮PCR，不过这一操作还需要进行优化，从而降低扩增导致的偏倚。经过PCR的末端修复和PacBio SMRT接头连接后，就可以进行长读长测序了；通过修改测序芯片的上样条件，就可以在这一步骤进一步控制测序片段长度。</p>
<p>ONT cDNA测序方法也能产生全长的转录本读长，甚至还能在单细胞水平上产生该读长。模板转录逆转录酶也在这种方法中用于制备全长cDNA，制备好的cDNA可以选择使用PCR来进行扩增，随后在产物上加上接头，形成测序文库。直接cDNA测序会消除PCR偏倚，从而形成高质量的测序结果；但是，如果使用PCR来制备测序文库的话，需要的RNA数量更少。ONT cDNA测序法尚未报道过在PacBio测序仪上观察到的片段长度偏倚。</p>
<p>这两种长读长cDNA方法都受到标准模板切换逆转录酶使用的限制，这种逆转录酶能用全长RNA以及截短的RNA来生成cDNA。逆转录酶可以将那些只含5ʹ帽子结构的mRNA置换为cDNA，这样的话，那些由于RNA降解，RNA剪接或不完全cDNA合成而生成的短转录本就不会被反转录为cDNA，从而提高数据质量。但是，有报道指出，逆转录酶会对ONT平台的读长产生不良影响。</p>
<h3 id="长读长直接RNA测序"><a href="#长读长直接RNA测序" class="headerlink" title="长读长直接RNA测序"></a>长读长直接RNA测序</h3><p>前面我们提到了长读长测序方法，这种测序方法与短读长测序平台一样，它们都依赖于将mRNA转换为cDNA。而最近Oxford Nanopore指出，他们的纳米孔测序技术可以直接对RNA进行测序，也就是说，这种测序手段不需要常规测建库过程中的的cDNA的合成和/或PCR扩增操作。这种方法称为dRNA-seq，这种方法就消除了常规建库过程中的偏倚，并且能够保留表观遗传学信息。这种方法可以从RNA直接进行两个接头的连接来制备文库。首先，带有一个oligo(dT)悬臂的双链核酸接头退火并连接到RNA的多聚腺苷酸(PolyA)尾部，随后就是可选（但不推荐的）的逆转录操作，这一步用于提高测序的通量。第二个连接操作就是添加测序接头，这个测序接头上已经提前安装有驱动测序的马达蛋白。文库随后进行MinION测序，其中RNA直接从3ʹpoly(A)尾部向5ʹcap端进行测序。最初的研究表明，dRNA-seq的测序长度过超过1000bp，最大测序长度过超过10kb。与短读长测序相比，这种长读长测序的几个优势在于：长读长测序可以提高对异构体的检测，并且它们还可以用于下方代码poly(A)尾巴的长度，这对于可变poly(A)分析（ alternative poly(A) analysis）来说非常重要。Nanopolish-polya这个工具可以对那些用纳米孔测序得到的数据进行分析，计算出poly(A)尾的长度，这就包括基因之间的长度，也包括转录亚型之间的长度。这种分析证实了，保留内含子的转录本比完全剪接的转录本具有略长的poly(A)尾巴。虽然dRNA-seq还处于起步阶段，但是它具有检测RNA碱基修饰的潜力，因此它的应用潜力巨大，尤其是能够对表观遗传学转录进行新的分析。</p>
<h3 id="长读长与短读长技术的比较"><a href="#长读长与短读长技术的比较" class="headerlink" title="长读长与短读长技术的比较"></a>长读长与短读长技术的比较</h3><p>虽然长读长技术在评估转录本方面比短读长技术有一些明显的优势，但是长读长技术也有一些明显的局限。尤其是与短读长技术相比，长读长技术的测序通量更低，错误率更多。但长读长技术的主要优势在于，它们能够捕获更多的单个转录本，不过这依赖于高质量的RNA文库。总体来说，这些局限影响了那些完全依赖于长读长测序实验的灵敏性(sensitivity)与特异性(specificity)。</p>
<p>长读长测序方法的主要局限就是当前的通量。在Illumina平台上，运行单次的RNA-seq可以生成10E9-10E10条短读长，但是在PacBio和ONT平台上，一次RNA-seq则只能产生10E6-10E7条读长。这种低通量限制了应用长读长测序技术进行实验的规模，并降低了对差异基因表达检测的灵敏性。然而，并非所有的实验都需要高深度测序。对于那些主要研究异构体的发现以及其特征的研究者们来说，测序长度比测序深度更重要。例如1百万个PacBio环形一致性测序(circular consensus-sequencing, CCS)的读长几乎就可以保证产生那些大于1kb的高表达基因的检测，ONT测序技术也是如此。因此，对于那些低到中等水平表达的基因来说，测序深度确实是一个主要问题。当进行同期功能基因组学分析(contemporary functional genomics analysis)大规模的DGE实验时，这种低通量测序技术的局限就会表现得明显。在这些研究中，必须对多个样本组进行分析，每组就是由多个生物学重复构成的，这样就能够实现充分的统计功效来有确认那些在整个转录组水平上发生的精确变化。对于这种需求，长读长技术不太可能取代短读长技术，除非长读长的测序读长的生成量能提高2个数量级。随着全长RNA-seq读长数目的增加，转录本检测的灵敏度将会增加到类似于Illumina平台上的这种水平，并同时具有更高的特异性。与此同时，通过将Illumina 的短读长RNA-Seq与PacBio的长读长Iso-Seq结合(并且可能还与ONT方法结合)，可以增加全长RefSeq注释的异构体检测的数量、灵敏性和特异性，同时保留转录本量化的质量。虽然长读长RNA-seq方法目前的实验成本较高，但它们可以检测到短读长方法遗漏的异构体，尤其是那些难以测序但与临床相关的区域，例如高度多态的人类MHC或雄激素受体。</p>
<p>长读长测序平台的第二个主要局限就是其更高的错误率，它比成熟的Illumina测序仪要高出一到两个数量级。长读长测序平台上生成的数据还包含更多的插入-删除错误。虽然这些错误与识别变化(variant calling)有关，但在RNA-seq中，每个碱基都被正确识别并非那么重要而长读长测序的目标是要阐明转录本和异构体（While these error rates are of concern for variant calling, in RNA- seq it is less crucial that every base be called correctly, as the goal is only to disambiguate transcripts and isoforms）。这种错误率对于其应用来说确实是一个值得观注的问题，现在正在解决这一问题。PacBio SMRT测序平台上出现的随机错误通常可以通过使用CCS增加测序深度来进行解决，在这种技术里，cDNA经过长度选择和接头进行环化后，每个分子就可以被多次测序，从而产生长度范围是10-60kb的连续长读长，并且包含许多原始cDNA的拷贝。这些长读长经过数据分析后就被处理为单个cDNA子子读长(subreads)，这些子读长被组合后就可以产生一致的序列。分子测序的次数越多，产生的错误率就越低；CCS已经被证明可以将错误率降低到与短读长相当的水平，甚至更低。但是，将更多的这个平台的测序能力用于重新读取相同的分子，就又加剧了其测序通量的问题，因为可以读取的唯一转录本变得更少了。</p>
<p>长读长RNA-seq方法的灵敏度还受到其他几个因素的限制。首先，它们依赖于长RNA分子以全长转录本的形式进行测序，但是要达到这种情况并非总能实现，因为在样品处理和RNA提取过程中RNA会发生降解或剪接。这种情况在短读长RNA-seq中也存在（3ʹ端的偏倚），但这种问题在短读长中是可控的，对于全长转录组分析进行研究的研究者们来说，即使是低水平的RNA降解，也能限制长读长的RNA-seq效果。因此，对于那些即将使用长读长进行测序的研究者来说，需要仔细地对提取的RNA进行质控。其次，中位数的读长长度会进一步受到文库制备中的技术问题与偏倚的限制，例如有些cDNA合成的截断或某些cDNA是由降解的mRNA合成的，最近开发的高效逆转录酶对此有所改进，这些酶有着更高的链特异性，甚至能够产生更多的3ʹ-5ʹ转录本的覆盖。虽然这些酶还未被广泛使用，但是这些高效逆转录酶也提高了结构稳定的RNAs，例如tRNAs的覆盖率，在oligo-dT和全转录组分析(WTA)方法中使用的逆转录酶很难处理这些结构稳定的RNAs。第三，长读长测序平台固有的偏倚（例如长文库分子在测序芯片表面上的低扩散）会降低更长转录本的覆盖率。</p>
<p>长读长方法(使用cDNA或dRNA-seq)解决了用于异构体分析的短读长测序方法中的一个基本问题，即它们的读长长度。长读长方法可以生成从Poly(A)尾部到5ʹcap的跨异构体的全长转录本读长。因此，这些方法使得分析转录本及其异构体成为可能，从而无需从短的读长中重构它们或推断它们的存在；每个测序的读长仅仅代表了它的起始RNA分子。全长cDNA测序或dRNA-seq用于分析DGE的未来应用将依赖于PacBio和ONT技术的更高通量。长读长RNA-seq分析正被研究者们迅速采用，并与深度短读长RNA-seq数据结合起来，用于更全面的分析，这非常类似于基因组组装所采取的混合方法。随着时间的推移，长读长和dRNA-seq方法可能会用于证明已经鉴定的基因和转录本的列表，即使在研究很透的生物中，对于基因和转录本的研究也还远远不够。随着方法的成熟，以及测序通量的增加，差异转录本分析将会成为常规方法。合成长读长RNA-seq或其它技术的发展将对这个领域产生什么样的影响，还有待观察。然而从目前来看，Illumina短读长RNA-seq依然占据了主导地位，在这篇综述的剩下部分中我们将会集中讨论短读长测序。</p>
<h2 id="改良RNA-seq建库方法"><a href="#改良RNA-seq建库方法" class="headerlink" title="改良RNA-seq建库方法"></a>改良RNA-seq建库方法</h2><p>RNA-seq最初用于分析多聚腺苷酸化的转录本，使用的方法源于早期的表达序列标签(expressed-sequence tag)和芯片研究。然而，下一代测序的使用指出了这些方法的局限性，而这些局限性在芯片数据中并不明显。因此，在RNA-seq首次报道后不久，就有研究报道了文库制备方法的一些重大进展。例如，在cDNA合成之前，对RNA进行片段化可以产生3ʹ:5ʹ偏倚，链特异性文库制备方法能够更好的区分正义链与反义链，这些改进都能够对转录本丰度进行更准确的估计。RNA片段化和链特异性文的制备很快就成了RNA-seq文库制备试剂盒中的标准方法。这里我们简要描述了其它RNA-seq方法的改良，使用这些改进方法的可以让研究者们根据他们的生物学问题以及特定样本进行选择。这些改进的方法包括在选择RNA进行测序时，取代dligo-dT富集的替代方法，或者是那些专门选择转录本的3ʹ或5ʹ末端的方法，或者是使用UMIs进行区分技术重复和生物重复的方法，以及针对RNA易降解特性改良的文库制备方法。这些方法的组合可以使研究者们阐明由可变poly(A)(alternative poly(A),APA)，或替代启动子(alternative promoter)使用和可变剪接(alternative splicing)生成的复杂转录本。</p>
<h3 id="Poly-A-富集的替代方法"><a href="#Poly-A-富集的替代方法" class="headerlink" title="Poly(A)富集的替代方法"></a>Poly(A)富集的替代方法</h3><p>大多数发表的RNA-seq数据都是基于oligo-dT富集的mRNA方法，这种方法会选择包含poly(A)尾的转录本，并将集中测序测序那些在转录组的蛋白质编码区上。不过这种方法除了产生3ʹ偏倚外，RNA中还有许多非编码RNA，例如miRNA和增强子RNA，这些RNA不含有poly(A)，因此不能使用这种方法进行研究。如果不进行poly(A)富集也无法达到目的，因为这会导致高达95%的读长来源于rRNA。因此，研究者们可以选择使用oligo-dT用于mRNA-seq，或者是剔除rRNA后进行WTA。短的非编码RNAs无法被oligo-dT方法捕获，使用WTA也很难对其进行研究，因此在研究非编码短RNA时需要特定的小RNA方法，这些方法主要是通过顺序RNA连接(sequential RNA ligation)实现的（通常小RNA建库试剂盒中就有相应的说明）。</p>
<p>WTA生成的RNA-seq数据来源于编码和一些非编码RNA。RNA的部分降解也能使用这种方法进行测序，RNA的降解会导致一些poly(A)从转录的末端分离。rRNA的去除有两种方法，一种是将rRNAs从其它RNA中剔除掉（所谓的pull-out法），另一种就是使用RNAse H酶来对rRNA进行降解。这两种方法都是使用序列特异性和物种特异性寡核苷酸探索来实现的，这些探针能与细胞质rRNA(5S rRNA，5.8S rRNA，18S rRNA和28S rRNA)和线粒体rRNA(12S rRNA和16S rRNA)互补。为了简化人类，大鼠，小鼠或细菌(16S和23S rRNA)样本的处理，通常将预先混合的寡核苷酸添加到RNA中，然后让它们与rRNA进行杂交，以便进行下一步的清除。其它高丰度的转录本，例如珠蛋白(globin)或线粒体RNA也可以按照类似的方法去除。pull-out方法结合了生物素化的探针和链霉素包裹的磁珠，它们可以用于除去寡聚的rRNA复合物，留下剩余的RNA用于建库例如Ribo-Zero(Illumina，USA)和RiboMinus(Thermo Fisher，USA)。RNase H酶降解法可以降低那些生成的loigo-DNA:RNA复合物，例如，NEBNext RNA depletion(NEB，USA)和RiboErase(Kapa Biossystems，USA)。最近对这些方法的比较说明，在高质量的RNA中，这两种方法都可以将rRNA降低至后续RNA-seq读长的20%以下。但是，作者说明了，RNase H方法比pull-out法的稳定性要强，并且比较不同试剂盒时，最后得到的DGE长度的偏倚比较明显。作者还描述了另外一种类似于RNase H的方法，这种方法表现不错，并且以前没有报道过。ZapR方法是Takara Bio的一项专有技术，它使用一种酶来降解RNA-seq文中的rRNA片段。rRNA剔除方法的一个局限是，相比对oligo-dT RNA测序方法，rRNA剔除方法需要更高的测序深度，主要是因为里面还会存有一定的rRNA。</p>
<p>Oligo-dT和rRNA剔除法都可以用于后续实验的DGE分析，研究者们可能会默认使用以前在他们的实验室中使用的方法或最容易使用的方法。然而，对于这些方法的使用应该考虑一些因素，尤其是那些易降解的样本，另外，WTA方法会检测到更多的转录本，但是其实验成本要高于oligo-dT方法。</p>
<h3 id="富集的RNA-3ʹ末端用于Tag-RNA-seq以及可变多聚腺苷酸分析-Enriching-RNA-3ʹends-for-Tag-RNA-seq-and-alternative-polyadenylation-analysis"><a href="#富集的RNA-3ʹ末端用于Tag-RNA-seq以及可变多聚腺苷酸分析-Enriching-RNA-3ʹends-for-Tag-RNA-seq-and-alternative-polyadenylation-analysis" class="headerlink" title="富集的RNA 3ʹ末端用于Tag RNA-seq以及可变多聚腺苷酸分析(Enriching RNA 3ʹends for Tag RNA- seq and alternative polyadenylation analysis.)"></a>富集的RNA 3ʹ末端用于Tag RNA-seq以及可变多聚腺苷酸分析(Enriching RNA 3ʹends for Tag RNA- seq and alternative polyadenylation analysis.)</h3><p>标准的短读长Illumina方法需要对每个样本生成1000万到3000万条（10M到30M条）读长用于高质量的DGE分析。对于那些专注于基因水平表达，并从事大型或高度重复实验的研究者们，或资源受限的研究者来说，可以选择使用3ʹtag计数。由于测序集中在转录本的3ʹ末端，因此需要的读长(reads)更少，这就降低了成本，并且一次测序的样本数目也可以更多。富集的3ʹ末端也可以用于确定单个转录本的poly(A)位点，而由于mRNA前体上存在的APA，其3‘末端可能会发生变化。</p>
<p>3ʹ mRNA-seq方法会产生每个转录本的单个标签读长(tag read)，这些读长来源于3ʹ末端，这个标签(tag)丰度与转录本的丰度是成正比的。标签测序法(tag-sequencing protocols)，例如QuantSeq(Lexogen, Austria)通常比标准RNA-seq法流程更为简单。标签测序法已经进行了优化，这种方法使随机引物或锚定的oligo-dT-primed来进行cDNA合成，从而并不需要poly(A)富集这一步骤，并在cDNA合成后立即进行PCR，从而取代了接头连接步骤。这种方法可以在低测序深度上实现与标准RNA-seq类似的灵敏度水平，因此，这种方法可以使用多路复用的形式实现多个文库的同步测序。这种建库方法的数据分析也进行了简化，因为不需要外显子连接检测和基因长度测序读长的归一化。但是，3ʹ mRNA-seq方法可能会被受到转录本同聚区(homopolymeric regions0的影响，这会导致错误标签；这种方法只能提供非常有限的异构体分析，这就会抵消它们较低测序深度带来的任何成本收益，尤其是对于那些仅够一次使用的样本来说。</p>
<p>mRNAs的APA化会产生3ʹ UTR长度不等的异构体。对于一个特定的基因来说，它不仅产生了这个基因的多个亚型，而且由于3ʹUTR中存在着顺式调控元件，这也会影响该转录本的调控。这种方法可以使用那些研究APA的研究者们更详细地研究miRNA的调控作用，mRNA的稳定和定位，以及mRNA的翻译。APA法指在富集转录本的3ʹ末端，从而提升信号与灵敏度，而前面提到的标签测序法非常适合此目的。其它方法多聚腺苷酸位点测序(polyadenylation site sequencing,PAS-seq)，这种方法可以将mRNA打断为150bp左右的片段，并且使用oligo-dT标记的模板转换来生成cDNA用于测序，其中的80%读长就来源于3ʹUTR。TAIL-seq方法能不使用oligo-dT，在对RNA进行打断之前，这种方法会剔除rRNA，并将3ʹ-RNA接头连到的poly(A)的尾部。当片段化后，再加上5ʹ-RNA接头就完成了RNA-seq文库的制备。在RNA-蛋白分析方法中也能评估APA，例如紫外交联免疫沉淀(cross- linking immunoprecipitation, CLIP)测序。</p>
<h3 id="富集的RNA-5ʹ末端用于起始位点回贴-Enriching-RNA-5ʹends-for-transcription-start-site-mapping"><a href="#富集的RNA-5ʹ末端用于起始位点回贴-Enriching-RNA-5ʹends-for-transcription-start-site-mapping" class="headerlink" title="富集的RNA 5ʹ末端用于起始位点回贴(Enriching RNA 5ʹends for transcription start- site mapping)"></a>富集的RNA 5ʹ末端用于起始位点回贴(Enriching RNA 5ʹends for transcription start- site mapping)</h3><p>使用富集7-甲基鸟苷5ʹ加帽RNA(7-methylguanosine 5ʹ-capped RNA)也可以进行DGE分析，这种方法可以用来鉴定启动子和转录起始位点(TSSs)。现存有几种方法都可以实现这个目的，但是这些方法很少作为常规手段来进行使用。在对基因表达的加帽分析(CAGE, cap analysis of gene expression)，以及用于基因表达分析的启动子的RNA注释和定位(RAMPAGE, RNA annotation and mapping of promoters for analysis of gene expression)分析中，当使用随机引物生成第一链cDNA后，mRNA 5ʹ的帽子结构就被生物素化，这就可以将5ʹ cDNA通过链霉亲和素进行富集。CAGE使用II型限制性内切酶来生成短的cDNA标签，这种酶会从5ʹ端的接头下游切割21-27p的核核苷酸。相比之下，RAMPAGE操作则使用模板转换(template switching)来生成较长的cDNA，这个cDNAs随后被富集起来，用于测序。单细胞标签逆转录测序技术(single-cell-tagged reverse transcription sequencing, STRT-seq)能够在单细胞水平上实现TSS的回贴(mapping)。STRT-seq技术使用生物素化的模板转换oligos来生成cDNA，被磁珠捕获后，就在5ʹ末端进行片段化，产生短的cDNA标签。作为CAGE基础的5ʹ末端的加帽技术是由日本理化所(Riken)开发的，这种技术用于早期功能基因组学实验中，使全长cDNA克隆数量最大化。日本理化所主导的小鼠功能注释(FANTOM, Functional Annotation of the Mouse)协会通过阐明了1300多个人类和小鼠原代细胞，组织和细胞系的TSS，这充分显示了CAGE的强大。在最近一些方法比较中，CAGE也表示不俗。但是作者却报道说，仅使用5ʹ末端测序产生的假阳性TSS峰也是最多的，他们建议使用正交方法进一步来确认阳性，例如DNase I的回贴或H3K4me3染色质免疫沉淀测序(ChIP-seq)。</p>
<h3 id="使用唯一分子标识符来检测PCR重复"><a href="#使用唯一分子标识符来检测PCR重复" class="headerlink" title="使用唯一分子标识符来检测PCR重复"></a>使用唯一分子标识符来检测PCR重复</h3><p>RNA-seq数据通常具有较高的重复率(duplication rates)，也就是说许多测序读长会回贴到转录组的相同位置。与全基因组测序不同的是，在全基因组测序中，重复的读长被以认为是PCR这一步中出现的技术偏倚导致的，它会被移除，而在RNA-seq中，这些重复的读长则被认为是真正的生物学信号并被保留。在一个样本中，数百万个起始RNA分子也许代表了高表达的转录本，当对cDNA进行测序时，就会发现很多片段是相同的。因此，在比对(alignment)过程中，并不建议通过计算去除那些不必要的重复，因为这些重复中很多是真正的生物信号。当使用单端测序(single-end sequencing)时更是如此，因为一对片段中只要一端相同，就可以被认为是一个重复(duplicate)，至于双端测序(paired-end sequencing)，两端必须在同一位置时才能被认为是一个重复，但这种情况很少。但是，由于PCR偏倚，在制备cDNA文库时，还会存在着某种程度上技术重复，并且PCR复制偏倚是一种质控问题，它有可能对RNA-seq实验结果造成影响时，很难区分出这些技术重复与生物重复的程度。</p>
<p>现在已经提到将UMIs作为一种解释扩增偏倚的方法。在扩增前将随机UMIs添加到cDNA分子中，使得能够确认PCR重复，并且可以在后续的数据分析中将其除去，同时保护真正的生物学重复，从而改善基因表达的量化和等位基因频率估计的效果。当一对测序读长被确认为一个技术重复时，它们应该包括相同的UMI，并且被回贴到转录组中相同的位置（一端或两端，这取决于使用的是单端测序还是双端测序）。</p>
<p>UMIs已经被证明能够降低变异和错误发现率来提升RNA-seq中的DGE数据分析，并且这种方法在单细胞数据分析方面也有着重要作用，单细胞数据中的扩增偏倚可能更为严重。当试图在RNA-seq数据中进行变异检测(variant calling)时，UMIs也非常有用。 虽然高表达的转录本可以产生适合这种变异检测的高覆盖率，尤其是包含了了这种重复时，但UMIs可以用于去他可能导致第二位基因频率错误计算的扩增假象。UMIs正在成为单细胞RNA-seq(scRNA-seq)的文库制备试剂盒中的标准，同时它也日益频繁地用于常规RNA-seq。</p>
<h3 id="提高降解RNA的分析"><a href="#提高降解RNA的分析" class="headerlink" title="提高降解RNA的分析"></a>提高降解RNA的分析</h3><p>RNA-seq文库制备方法的发展也改进了低质量或降解RNA的分析，例如从临床相关获得的那些用福尔马林固定石蜡包埋(FFPE)块存储的样本中的RNA。低质量的RNA会导致不均匀的基因覆盖率，更高的DGE假阳性率和更高的重复率，它们与文库的复杂性呈负相关。但是，文库的制备方法已经被改良，改良后的方法能降低RNA降解的影响。这些方法可能在基于RNA-seq的诊断技术的发展中显得尤为重要，例如将来有可能出现的类似于OncotypeDX（目前并不是测序分析）的诊断，这种试剂盒基于21个基因RNA的标签来预测乳腺癌的复发。虽然现在有几种方法可以使用，但是比较后发现两种方法表现最好，即RNase H与RNA exome。我们前面提到，RNase H法使用核酸本科来降低RNA:DNA复合物中的rRNA，但是它却能阻止mRNA的降解。RNA exome方法使用类似于外显子测序(exome sequencing)那样的方法，使用寡核苷酸探针来捕获RNA-seq文库分子。这两种方法都能通过减少rRNA，同时不影响mRNA的手段来产生高质量和高度一致的基因表达数据。3ʹ末端标记测序技术与扩增子测序（在PCR扩增中能产生超过2万个外显子扩增子）方法也可以用于分析降低的RNA，但是这两种方法并没有RNase H方法使用广泛。</p>
<h2 id="设计更好的RNA-seq实验"><a href="#设计更好的RNA-seq实验" class="headerlink" title="设计更好的RNA-seq实验"></a>设计更好的RNA-seq实验</h2><p>仔细设计DGE RNA-seq实验对于获取高质量和生物意义数据有着非常重要的意义。尤其是要考虑到复制的层次，测序深度以及单端还是双端测序。</p>
<h3 id="重复与实验功效-replication-and-experimental-power"><a href="#重复与实验功效-replication-and-experimental-power" class="headerlink" title="重复与实验功效(replication and experimental power)"></a>重复与实验功效(replication and experimental power)</h3><p>在一个实验中，足够的生物学重复(biological replicates)能够捕获不同样本之间的生物学变异；在定量分析中的置信度依赖于测序深度与读长长度。虽然RNA-seq比芯片表现了更低的技术偏倚，但是生物系统中固有的随机变化都要求任何RNA-seq实验要做生物学重复。使用额外的重复能够确定异常样本，在必要情况下，在进行生物学分析之前，移除这些异常样本或降低这些异常样本的权重。确定生物学重复需要考虑几个因素，包括效应大小(effect size)，组内变异，可接受的假阳性和假阴性阈值，以及最大样本数目，有的时候还需要RNA-seq实验设计工具或功效(power)计算工具的辅助。</p>
<p>在一个实验中要想确定一个合适的生物学重复并非是一件简单的事情。一项48个重复的酵母研究表明，当使用3个生物学重复时，计算样本用于DGE分析的工具只能检测出20-40%的差异表达基因。研究表明，至少应该使用6个生物学重复，这个数量要超过文献中常用的3到4个生物重复的数量。最近的一项研究表明，4个生物学重复可能足够的，但是研究指出，在确定合适的重复数目之前，需要做一个预实验来确定生物样本的方差。对于高度多样化的样本，例如来自癌症患者肿瘤的临床组织，可能需要更多的重复，以便能以更高的置信度来确定基因的变化。</p>
<h3 id="确定合适的读取深度-Determining-the-optimal-read-depth"><a href="#确定合适的读取深度-Determining-the-optimal-read-depth" class="headerlink" title="确定合适的读取深度(Determining the optimal read depth)"></a>确定合适的读取深度(Determining the optimal read depth)</h3><p>一旦文制备好，就需要决定对它们进行多深的测序。读取深度指的是，每个样本获得的测序读长的目标数目。对于真核基因组中的常规RNA-seq DGE分析来说，一般认为每个样本需要100万-300万条读长（也就是我们常说的10M到30M数量）。但是，在多个物种中的实验结果显示当每个样本的测序读长数量为1M时，那么这个数量级的测序读长提供的转录本丰度信息与转录组中表达最高表达量的一半的转录本30M测序提供的丰度信息类似。如果实验的重点是关注那些最高表达相对较大变化的基因，并且如果有足够的生物学重复，那么就可以使用较低深度的测序就能解决驱动实验的假设。测序完成后，通过检查读长在样本之间的分布以及检查饱和曲线就能评估进一步的测序能够增加实验的灵敏度。随着测序通量的增加，为了控制技术偏倚，可以将一个实验的所有样本都添加一个“混合”文库中进行测序，这已经成了标准做法。一次测序所需要读长总数则是样本数乘以读取深度；然后根据生成所需的读长总数来对这个混合文库进行多次测序。这种合并需要严格检测每个样本RNA-seq文库的浓度，并假设每个文库中的cDNA量相对均值（低方差），因此总的读长数目就会平均地分布在每个样本上。在进行一次昂贵的，多泳道(lane)测序之前，运行单个泳道以验证样本之间的低方差通常是值得的。</p>
<h3 id="选择参数：测序长度，单端测序或双端测序"><a href="#选择参数：测序长度，单端测序或双端测序" class="headerlink" title="选择参数：测序长度，单端测序或双端测序"></a>选择参数：测序长度，单端测序或双端测序</h3><p>最终的测序参数包括测序长度，单端测序还是双端测序。在许多测序应用中，测序读长的长度对于数据的利用有着重要的影响，因此更长的读长可以使测序的DNA覆盖率更高。当使用RNA-seq来进行DGE分析时这种方法并不适用，其中重要的原因则是，确定每个读长来源于转录组的哪个位置的能力有限。一旦一个读长能够明确其回贴位置，那么较长的读长在基于量化的分析中就不会再提供太多的价值。对于那些更定性的RNA-seq分析来说，例如特定异构体的鉴定，更长的读长可能更有用。</p>
<p>单端测序与双端测面临的问题是类似的。在单端测序中，每个cDNA片段只有一个末端(3ʹ端或5ʹ端)用于产生测序读长，但双端测序则是一个片段产生2条读长（一个是3ʹ端，一个是5ʹ端）。在那些需要尽可能高的核苷酸覆盖率的分析实验中，长读长双端测序可能更好。然后，DGE分析不需要对转录本片段的每个碱基都进行测序，在DGE分析中，研究者只需要比对后，统计出那些回贴到转录本上的读长数目即可。例如，通过比较测序读长发现，“短”的50bp单端测序与“长”的100bp双端测序所产生的DGE结果没有区别。这是因为单端测序足以鉴定出大多数测序片段来源的基因。同样的研究表明，使用短的单端测序降低了检测出异构体的能力，因为跨越剪接连接的读长较少。双端测序还有助于消除读长回贴的歧义，并对可变外显子量化(alternative-exon quantification)，融合转录本检测和从头开始(de novo)的转录本发现，尤其是处理那些没有很好注释的转录本来说，双端测序更是首选。</p>
<p>在实际应用中，单端测序或双端测序之间的选择通常基于成本或研究者们可用的测序技术。在Illumina NovaSeq发布之前，在多数情况下，每M读长的单端测序的成本要低于双端测序，因此，在相同实验成本的前提下，单端测序能够实现更高的复制或读长深度。</p>
<p>在Illumina NovaSeq发布之前，在大多数情况下，单端测序的每百万次读取的成本低于成对末端测序，因此允许以相同的实验成本进行更高的复制或读取深度。当选择了更多的短单端测序读长和产生更长的双端测序读长后，那么增加读取深度将对提高DGE实验的灵敏度产生更大的影响。</p>
<h2 id="RNA-seq数据分析"><a href="#RNA-seq数据分析" class="headerlink" title="RNA-seq数据分析"></a>RNA-seq数据分析</h2><p>用于分析测序读长以确定差异表达的计算方法的数量在过去10年里大量增加，并且即使对于最简单的DGE分析来说，在分析实践中，每个步骤也存在着大量的差异。然而，每个步骤都可以使用不同方法，这些方法的不同组合会对从数据中得到的生物学结论产生重要的影响。 这些工具的最佳组织取决于正在研究的特定生物学问题，以及可用的计算机资源。虽然有着尽可能多的排列组合，但是我们的重点在于研究，每个世界大在样本之间的差异表达的可能性的工具和技术。针对这个目标，我们可以将分析过程划分为4个阶段（FIG 2；TABLE 2）。</p>
<p>第1阶段是将一个测序平台产生的原始测序读长导入工具，并将这些读长回贴到转录组上。</p>
<p>第2阶段，是对每个基因或转录本相关的读长数目进行定量（表达矩阵）。这一过程涉及一个或多个不同的比对(alignment)，组装(assembly)与定量(quantification)亚过程，或者是可以在单个步骤中从读长计数中，整体地生成表达矩阵。</p>
<p>第3阶段是通过过滤低表达特征来改变表达矩阵，这一步的关键步骤是对原始读长计数进行归一化，用于解释样本之间的技术差异。</p>
<p>第4阶段是样本组之间的统计建模与协变量(covariates)，以及计算与差异表达相关的置信统计量。</p>
<h3 id="Figure2-差异基因表达的RNA-seq数据分析流程"><a href="#Figure2-差异基因表达的RNA-seq数据分析流程" class="headerlink" title="Figure2-差异基因表达的RNA-seq数据分析流程"></a>Figure2-差异基因表达的RNA-seq数据分析流程</h3><p><img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190805190015.png" alt=""></p>
<p><strong>Figure 2-差异基因表达的RNA-seq数据分析流程。差异基因表达(DGE)分析的第一步是原始RNA测序读长的FASTQ格式的数据，DGE的分析有多种方式。主流的分析流程有三种（用实线划的三个方框，分别用A，B和C表示），并且图上还列出了许多替代工具（用虚线表示）。</strong></p>
<p><strong>在A分析流程中，比对工具例如TopHat，STAR或HISAT2使用一个参考基因组来将读长回贴到基因组的位置上，然后使用一些定量工具，例如HTSeq和featureCounts，来将读长比对于基因的特征上。在归一化后（通常归一化的方式都内嵌到了一些分析工具，例如TMM），基因表达就通过一些计建模工具，例如edgeR，DESeq2和limma+voom进行计算，计算结果是一些差异表达基因或转录本的列表，这数据用于下一步的可视化和生物学解释。</strong></p>
<p><strong>在B分析流程中，使用一些较新的免比对工具，例如Kallisto与Salmon，这些工具会在一步操作中组装转录组并对相应的转录本进行定量。这些工具的输出结果通常是转录本定量的一些估计值（例如tximport，TXI），然后通过与A分析流程中相同的归一化和统计建模，产生出差异基因或转录本列表。</strong></p>
<p><strong>在C分析流程中，第一步是比对读长（这一步的工具通常是TopHat，虽然有些分析方法也会用STAR与HISAT），接头使用CuffLinks来处理原始读长，再然后是使用CuffDiff2包来输出转录本丰度的估计值，以及一个差异表达基因或转录本的列表。</strong></p>
<p><strong>其它常用的工具还包括StringTie，这个工具使用TopHat（或类似工具）的输出结果来组装一个转录本模型，然后将结果输出到RSEM或MMSEQ中，用于估计转录本的丰度值，最后将转录本的丰度值输出给Ballgown来计算差异表达基因或转录本。而SOAPdenovo-trans这个工具则能同时对读长进行比和组装，其结果用于输入给RSEM或MMSEQ。</strong></p>
<h3 id="TABLE2-RNA-seq数据分析工具"><a href="#TABLE2-RNA-seq数据分析工具" class="headerlink" title="TABLE2-RNA-seq数据分析工具"></a>TABLE2-RNA-seq数据分析工具</h3><div class="table-container">
<table>
<thead>
<tr>
<th>工具名称</th>
<th>组装</th>
<th>定量</th>
<th>均一化</th>
<th>差异表达</th>
</tr>
</thead>
<tbody>
<tr>
<td>TopHat</td>
<td>参考基因组+注释   Reference genome+ annotation</td>
<td>NA</td>
<td>NA</td>
<td>NA</td>
</tr>
<tr>
<td>STAR</td>
<td>参考基因组+注释   Reference genome+ annotation</td>
<td>NA</td>
<td>NA</td>
<td>NA</td>
</tr>
<tr>
<td>HISAT</td>
<td>参考基因组+注释   Reference genome+ annotation</td>
<td>NA</td>
<td>NA</td>
<td>NA</td>
</tr>
<tr>
<td>SOAPdevovo-Trans</td>
<td>De novo assembly</td>
<td>NA</td>
<td>NA</td>
<td>NA</td>
</tr>
<tr>
<td>StringTie</td>
<td>De novo assembly</td>
<td>Transcript estimates</td>
<td>NA</td>
<td>NA</td>
</tr>
<tr>
<td>Kallisto</td>
<td>Alignment-free assembly</td>
<td>Transcript estimates</td>
<td>NA</td>
<td>NA</td>
</tr>
<tr>
<td>Salmon</td>
<td>Alignment-free assembly</td>
<td>Transcript estimates</td>
<td>NA</td>
<td>NA</td>
</tr>
<tr>
<td>Cufflinks</td>
<td>Transcript assembly</td>
<td>Transcript estimates</td>
<td>NA</td>
<td>NA</td>
</tr>
<tr>
<td>RSEM</td>
<td>NA</td>
<td>Transcript estimates</td>
<td>NA</td>
<td>NA</td>
</tr>
<tr>
<td>MMSeq</td>
<td>NA</td>
<td>Transcript estimates</td>
<td>NA</td>
<td>NA</td>
</tr>
<tr>
<td>HTseq</td>
<td>NA</td>
<td>Read counts from  non- overlapping annotated features</td>
<td>NA</td>
<td>NA</td>
</tr>
<tr>
<td>FeatureCounts</td>
<td>NA</td>
<td>Read counts from     non- overlapping    annotated features</td>
<td>NA</td>
<td>NA</td>
</tr>
<tr>
<td>Tximport</td>
<td>NA</td>
<td>Transcript estimates    converted to read counts</td>
<td>NA</td>
<td>NA</td>
</tr>
<tr>
<td>edgeR</td>
<td>NA</td>
<td>NA</td>
<td>TMM</td>
<td>Negative binomial distribution + GLM</td>
</tr>
<tr>
<td>limma+voom</td>
<td>NA</td>
<td>NA</td>
<td>TMM</td>
<td>Mean–variance transform + GLM</td>
</tr>
<tr>
<td>DESeq2</td>
<td>NA</td>
<td>NA</td>
<td></td>
<td>Negative binomial distribution + GLM</td>
</tr>
<tr>
<td>Ballgown</td>
<td>NA</td>
<td>NA</td>
<td>Various</td>
<td>Input from StringTie, RSEM or    alignment- free quantification, + GLM</td>
</tr>
<tr>
<td>CuffDiff</td>
<td>NA</td>
<td>NA</td>
<td>NA</td>
<td>DE from Cufflinks estimates</td>
</tr>
</tbody>
</table>
</div>
<h3 id="第1阶段-测序读长的比对-alignment-与组装-assembly"><a href="#第1阶段-测序读长的比对-alignment-与组装-assembly" class="headerlink" title="第1阶段-测序读长的比对(alignment)与组装(assembly)"></a>第1阶段-测序读长的比对(alignment)与组装(assembly)</h3><p>测序完成后，分析的起点就是数据文件，这个数据文件包含了测序计数的碱基，这些数据文件通常是以FASTQ文件的格式存在。处理这些FASTQ文件最常见的第一步操作就是将测序读长回贴到已知的转录组上（或已经注释的基因组上），将每个测序读长转换为一个或多个基因组坐标。这一过程可以使用多个不同的比对工具，例如TopHat，STAR或HISAT，它们都依赖于一个参考基因组。由于测序的cDNA都源于RNA，而RNA有可能跨外显子边界，因此当与参考基因组（含有内含子与外显子）进行比对时，这些工具进行一个剪接比对后，测序读长之间会出现一些间隙。 </p>
<p>如果测序的物种没有一个可用的高质量基因组注释（含有已经知的外显子边界），或者说如果希望将测序读长与转录本（而不是基因）关联起来，那么可以使用比对的读长进行转录组的组装。一些组装工具，例如StringTie，SOAPdenovo-Trans使用利用那些已经比对好的结果中的空隙来推测其外显子边界，以及可能的剪接位点。当参考基因组注释没有或者是不完整时，或者是你感兴趣的组织（例如在肿瘤组织）中转录本异常的情况下，这些从头组装转录本的工具尤其好用。当使用的是双端测序和/或更长的测序技术时，这种转录组组装方法效果更好，因为这些测序技术有更大的可能性跨越了剪接位点。但是，从RNA-seq数据中进行转录本的完整组装对于计算DGE来说，并不是一个必需的步骤。</p>
<p>最近，已经开发出了计算高效的“免比对”(alignment-free)工具，例如Sailfish，Kallisto与Salmon，这些工具可以直接将测序读长与转录本进行关联，从而无需单独的定量步骤（参考后面的第2阶段部分）。这些工具在那些表征更高丰度（以及更长的）转录本方面表现得非常良好；然后它们在那些定量低丰度或短转录本方面表现不佳。</p>
<p>用于将测序读长回贴到转录本的不同的工具在它们如何对测序的子集进行分配方面有着显著的差异，这会影响最终的表达估计值。当有来自一个不同基因，伪基因或转录本的多个读长时，这种效果尤为明显。一项比对12个基因表达估计方法的比较显示，一些比对方法低估了许多与临床相关的基因的表达，这主要是由于其并不精确的回贴读长所导致的。在RNA-seq数据的计算分析中，如何将多个回贴的读长合理进行分析仍然是一个值得研究的方向。通常的做法是将这些读长排除在下一步的分析之外，但这可能会使结果产生偏（参考阶段2-转录本丰度的量化）。其它的估计包括生成“合并“表达特征，这些特征包含了那些共同回贴后的读长的重叠区域，以及要在随后的置信度计算中，对每个估计的基因的回贴的不确定性进行估计。</p>
<h3 id="第2阶段-转录本丰度的量化"><a href="#第2阶段-转录本丰度的量化" class="headerlink" title="第2阶段-转录本丰度的量化"></a>第2阶段-转录本丰度的量化</h3><p>一旦读长被回贴到基因组的位置或转录组的位置，接下来的步骤就是将这些读长分配到基因或转录本上，以确定它们的丰度。不同的比较研究表明，在量化步骤中采用的不同的方法对最终的结果影响最大，这种影响甚至超过了第1步中比对工具的选择。对每个基因(即该基因所有转录本的亚型)测序读长丰度的量化依赖于转录组注释来对那些重叠到已知基因上的测序读长进行量化。但是，使用短读长对测序读长进行特定异构体分配来说还需要一个估计步骤，因为许多读长并不能跨越剪接位点，因此它们无法精确地分配给特定的异构体。当一个基因的主要表达形式是在不同长度的转录本之间进行转换时，那么即使在仅研究基因层面的差异表达分析的前提下，对这些转录本进行定量则会产生一个更加精确的结果。例如，在一个样本中，一个主要的转录本也许只有另外一个样本中同样转录本的一半长度，但是前者的表达量是后者的2倍，那么单纯地基因基因定量的工具无法区分这个转录本的差异表达。</p>
<p>常用的量化工具包括RSEM，CuffLinks，MMSeq与HTSeq以及前面提到的那些免比对工具。一些基于读长计算的工具，例如HTSeq（或者是R equivalent，featureCounts）通常会丢弃许多比对好的读长，包括那些回贴到多个位置的读长，或者是重叠多个表达特征的读长。其结果就是，在随后的分析中清除了那些同源和重叠的转录本。RSEM会使用期望最大化的方法来分配那些比对不明的读长，Kallisto这个无参比对工具会将比对不明的读长包括在它们相应的转录本计数中，从而导致结果偏倚。使用tximport包可以将转录本丰度估计转化为读长计数值(read count equivalents)。量化步骤中产生的结果通常会合并为一个表达矩阵，在这个矩阵中，每一行是表达特征（基因或转录本），每一列是样本名，表达矩阵中的值要和是实际的读长值，要么是一种估计丰度。</p>
<h3 id="第3阶段-过滤和归一化"><a href="#第3阶段-过滤和归一化" class="headerlink" title="第3阶段-过滤和归一化"></a>第3阶段-过滤和归一化</h3><p>通常来说，定量后的基因或转录本计数结果还需要过滤和归一化，从而用于解释读长深度，表达模式以及技术偏倚。过滤用于去除那些不均一的低读长丰度特征的值，从而提高对那些真正差异表达值的检测能力。而对表达矩阵进行归一化则更加复杂。直接转换可以调整丰度值，以便能更加说明GC含量的差异以及读长深度。早期用于归一化的方法就是RPKM，但这种方法现在已经淘汰，它已经被那些能够校正样本之间更细微差异的方法所取代，例如四分位数法或中位数归一法。</p>
<p>广泛的研究表明，归一化方法的选择会对最终的结果以及生物学结论产生重要的影响。大多数进行归一化的算法依赖于两个重要的假设：第一，大多数基因的表达水平在重复的样本组之间保持不变；第二，不同的样本组在总体的mRNA水平上不表现出显著差异。当这些基础假设不成立时，那么就需要慎重考虑是否进行归一化，以及如何进行归一化。例如，如果一些基因在一个样本中高表达，同时相同的基因，以及另外的一些基因在同一组中的另外一个样本里正常表达，如果对读长深度进行简单的归一化则明显不够，因为相同数目的测序读长会分配到第二个样本里更多的基因上面。归一化过程，例如截断均值化M值(The Trimmed Mean of M-values,TMM)方法（它已经整合到的edgeR包中）就能解决这个问题。选择一个合适的归一化方法或许很困难；一种做法就是深度使用多种方法进行分析，然后比较它们结果的一致性。如果结果对于归一化方法高度敏度，则应该对数据进行进一步的探索，以确定差异来源。但是，比较不同的归一化方法时，要谨慎确保这种归一化方法的比较不是为了选择与原始假设最兼容的归一化方法。</p>
<p>处理这些问题的一种方法的spike-in control RNAs，这种方法会引入一些外源已知的RNA序列，这些外源已知的RNA序列已知，浓度已知，在建库的过程中，将它们添加到样本中。RNA-seq中的Spike-ins方法包括外部RNA控制协会混合物(External RNA Controls Consortium  mix, ERCCs)，spike-in RNA突变物(spike-in RNA variants, SIRVs)与测序spike-ins(sequencing spike-ins, Sequins)。由于预先知道spike-in的浓度，这些浓度直接与生成的读长数相关，因为就可以对这些来自样本转录的表达水平进行校正。也有人指出，如果不进行spike-in控制时，那么就不能对那些有强烈倍数变化基因的实验进行分析。然后在实践中，很难在预设水平上一致地整合spike-ins，并且它们在基因水平上对测序读长数目进行归一化比转录本更加可靠，因为在一个样本中，每个异构体的表达水平不同。目前，spike-in控制法并没有在发表RNA-seq DGE实验中得到广泛使用，如果这种方法被进一步改进，提高其一致性的话，则这种方法会得到广泛使用，但现在很多研究者们在他们的单细胞实验（这种实验里会更加广泛地使用spike-in）使用了这种方法。</p>
<h3 id="第4阶段-差异表达的统计建模"><a href="#第4阶段-差异表达的统计建模" class="headerlink" title="第4阶段-差异表达的统计建模"></a>第4阶段-差异表达的统计建模</h3><p>一旦测序读长被处理为表达矩阵，那么就可以对实验进行统计建模，从而确定哪些转录本发生了改变。一些工具可以达到这些目的；其中一些工具会对基因水平的读长数目进行统计建模，而一些则依赖于转录本水平的估计。基因水平的工具通常依赖于比对好的读长数目，使用广义线性模型(Generalized Linear Models)处理这些数据，从而能够评估复杂的实验设计。这些工具包括edgeR，DESeq2以及limma+voom，这些工具能够进行有效地计算，并提供比较结果。对差异异构体表达进行统计建模的工具包括CuffDiff，MMSEQ与Ballgown，这些工具通常需要更多的算力(computational power)，并且不同工具的结果中的信息量更大。但是，在进行选择差异表达工具之前做的那些工作，例如比对，定量或过滤以及归一化这些操作对最终结果的总体方差会产生更大的影响。</p>
<h2 id="常规RNA-seq进阶"><a href="#常规RNA-seq进阶" class="headerlink" title="常规RNA-seq进阶"></a>常规RNA-seq进阶</h2><p>源于整块组织和/或大量细胞的RNA-seq数据已经彻底改变了我们对生物学的理解，但是这种常规的RNA-seq无法轻易地分辨出特定的细胞类型，也无法保存空间信息，而这两个信息都是理解生物系统复杂性的关键因素。促进研究者们从常规的RNA-seq走出去的情形与常规RNA-seq当初出现的理由类似，但这种进阶能够能够解决很多不同的问题。单细胞测序让人们发现了，即使在被认为研究透彻的疾病背后，还存在着一些未知细胞类型，例如发现了离子细胞(ionocyte cell)，这类细胞可能与囊性纤维化疾病有关。空间分辨RNA-seq则提示了在实体组织中细胞与细胞之间的相互作用，例如发现了成年心脏组织中一小群胎儿标记基因表达的细胞。虽然在可预见的未来，常规RNA-seq仍然是一个占据主导地位的工具。但是，单细胞测序与分析方法正在快速地被研究者利用，并且随着空间RNA-seq方法的成熟，它们有可能成为常规RNA-seq分析中的一部分。这两种方法都将提高我们对多细胞生物体复杂性的理解，它们都有可能与常规RNA-seq方法结合使用。在这里我们简单描述一下主要的单细胞测序以及空间RNA-seq方法，以及它们与常规RNA-seq的不同之处，以及新的研究者们如何着手。</p>
<h3 id="单细胞分析"><a href="#单细胞分析" class="headerlink" title="单细胞分析"></a>单细胞分析</h3><p>scRNA-seq于2009年首次报道，当时的研究者在含有裂解缓冲液的EP管中分离了单个卵母细胞。单细胞测序对生物学新问题的解释，以及现有的实验室和计算方法以极快的速度发展，甚至最近几年综述都已经过时了。每种scRNA-seq方法都需要将实体组织进行分离，分离出单个细胞（使用不同的方法），以及标记上每个细胞的RNA，对RAN扩增后进行测序，所有的这些方法都来源于早期常规RNA-seq的方法。</p>
<p>机械裂解和胶原酶加DNAase的酶解会生成单细胞悬液，从而产生大量可用的细胞，但是这种产生是高度组织特异性的，比较依赖于经验，其过程也需要非常小心。一旦制备好了单细胞悬液，就可以通过各种方法分离单细胞（FIG 3a）；大多数的实验都是使用流式细胞仪来进行单细胞分选，这种方法是最容易，它可以将单个细胞直接分选到含有裂解液的微孔板中。对于更高通量的实验，现存有大量分离单细胞的专门仪器，这些仪器需要自己构建或购买。单个细胞可以通过物理手段被捕获到微流控芯片中，或者是通过Poisson分布的原理被分配到加载到含有纳米孔(nanowell)的芯片中，随后这些单细胞被分离后就被液滴微流分离技术合并到含有试剂的液滴中（例如Drop-Seq与InDrop），或者是单细胞被原位标记上标签（例如单细胞混合索引RNA测序技术, single-cell combinatorial indexing RNA sequencing, sci-RNA-seq以及分离-混合-连接转录组测序技术，split- pool ligation- based transcriptome sequencing,SPLiT-seq）。单细胞分离后，它们就被裂解，将RNA释放到溶解中用于cDNA合成，并将cDNA用于RNA-seq文库制备。在文库制备过程中，来源于每个细胞的RNA会通过PCR进行扩增。这种扩增就引入了PCR偏倚，但是UMIs可以用于校正这种偏倚。由于Poisson采样，一个细胞中只有10-20%的转录本会被逆转录，这就限制了转录本检测的灵敏度，以及各种方法产生的可用数据。在湿实验之外，计算方法也在迅速发展，最近已经出现了关于scRNA-seq的实验设计指南。方法学的快速发展意味着scRNA-seq方法的技术已经快速过时了。然而Ziegenhain等人提供了scRNA-seq方法的详细概述，他着重强调了UMIs的在数据分析方面 的重要性，并报道了提到了的6种方法中哪一种最为灵敏。然而他们的研究范围并不包括现在被广泛使用的10X Geneomics方法。</p>
<h3 id="Figure3-单细胞RNA-seq与空间RNA-seq的概念"><a href="#Figure3-单细胞RNA-seq与空间RNA-seq的概念" class="headerlink" title="Figure3-单细胞RNA-seq与空间RNA-seq的概念"></a>Figure3-单细胞RNA-seq与空间RNA-seq的概念</h3><p><img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190805190056.png" alt=""></p>
<p><strong>Figure 3-单细胞RNA-seq与空间RNA-seq的概念。(a)单细胞RNA-seq(scRNA-seq)工作流程概述。scRNA-seq的第一步就是从样本中分离单个细胞（例如从解离的皮肤组织），分离单细胞的方式有多种，其中包括微移液管将细胞转移到单独的微管中，或者是使用流式细胞仪将单细胞分选到含有裂解液的96孔板或384孔板中，或者是将细胞捕获到微流控芯片中，或者是将细胞分布到纳米孔(nanowells)中，或者是使用含有试剂的液滴分离系统，或者是使用原位条形码技术。细胞进行逆转录以产生cDNA（通常使用UMIs来对这些cDNA进行标记），用于制备RNA-seq文库和测序。质控(QC)，差异基因表达(DGE)与2D可视化(t-distributed stochastic neighbour embedding, tSNE)以及无监督聚类在和网络分析来对scRNA-seq的数据进行分析，用于区分不同的细胞种群。这些技术通常会标明细胞数据，以及与RNA-seq的策略一样，还会标明测序技术是3’末端还是5’末端还是全长cDNA。(b)空间转录组学工作流程概述。空间编码需要将冷冻组织切片加到含有寡聚核苷酸微阵列的载玻片上，或者是加载到密集包装的被寡核苷酸包被的pucks上。mRNA扩散到载玻片表面，然后与oligo-dT合成引物杂交，这些引物中含有UMIs与空间编码序列。随后mRNA逆转录成cDNA，cDNA汇集起来用于文库制备和测序。空间转录本组学的计算方法以能够将测序读长回贴到它们的空间坐标上，随后是DGE分析与差异空间表达分析的可视化。scRNA-seq与空间RNA-seq数据通常是用短读长测序仪进行测序的。上述图片(a)源于Springer Nature Limited。</strong></p>
<p>当研究者们在选择scRNA-seq方法，需要考虑的主要因素包括：他们是否需要全长转录本的读长，在分析更多细胞表达谱（宽度, breadth）或每个细胞更多转录本（深度，depth）之间进行权衡，以及总体实验成本。全长scRNA-seq系统的通量比较低，因此每个细胞需要单独地处理，直到最终生成scRNA-seq文库。但是，此系统可以让研究者们研究可变剪接与等位基因特异性表达。非全长系统则会从转录本的3’或5’末端生成序列，但这就限制了异构体表达的分析，但是当细胞cDNA合成被混合后，细胞所加工的数量会比前一种高出2到3个数量级。单细胞测序宽度与细胞，组织或样本的数量有关，而深度则是与测序读长数目固定下，要分析的转录组有关。虽然实验中测序的细胞数量是由选择的方法决定的，但是这也允许一些灵活性，不过随着分析的细胞数目的增多，测序成本的增加，往往限制了转录组分析的深度。因此，可以使用宽度和深度两个维度来评估不同的scRNA-seq系统。单细胞测序典型的做法是基于孔板或微流控方法来捕获尽量少的细胞，但同时对每个细胞检测出更多的基因，而基于液滴的系统可以用于分析最大数目的细胞，它已经能从超过一百万个细胞中产生单独的数据集。</p>
<p>scRNA-seq的力量正在推动着大规模的细胞图谱项目，这些项目指在确定生物体或组织中完整的细胞类型。 人类细胞地图集(Human Cell Atlas)与NIH大脑计划(NIH Brain Initiative)项目分别是为了对人体以及大脑中的所有细胞类型进行测序。人类细胞地图集的第1阶段目标是对3000万到1亿个细胞进行测序，并将随着技术的发展在广度和深度上进行增加。这个项目的最新成本包括发现了离子细胞，以及发现肾癌是在儿童和成年人中是由不同的细胞类型发展而来的。不过，scRNA-seq的研究者们应该意识到，这些技术可以用于几乎所有的生物。最近，对A. thaliana根细胞原生质的分析表明，即使是植物的坚韧细胞壁这种障碍也能被解决，能产生用于测序的单细胞。scRNA-seq正在迅速成为生物学家们工具包的标准配置，并有可能在10年后被广泛使用，就像今天的常规RNA-seq一样。</p>
<h3 id="空间分辨RNA-seq法"><a href="#空间分辨RNA-seq法" class="headerlink" title="空间分辨RNA-seq法"></a>空间分辨RNA-seq法</h3><p>当前的常规RNA-seq和scRNA-seq方法为研究者们提供了关于组织或细胞群体的高度详细的数据，但是没有捕获空间信息，就是会降低细胞环境与基因表达之间关系的分析能力。空间转录组学(spatialomics)的两种方法是空间编码(spatial encoding)与原位转录组学(in situ transcriptomics)。在RNA-seq文库制备过重中，空间编码方法能够记录其空间信息，或者是通过分离空间受限的细胞（例如，通过激光捕获显微解剖， laser-capture micro-dissection, LCM）， 或者是通过分离前的位置对RNA加上条形码（通过从组织切片中直接捕获mRNA）(FIG. 3b)。原位转录组学能够在组织切片中，通过对细胞中的RNA进行测序或成像来生成数据。我们建议感兴趣的读者是阅读最近的深度评论，从而对这一领域进行更全面的理解。</p>
<p>LCM已经成功地用于从组织切片中的特定区域分离和分析单个细胞用于RNA-seq。虽然LCM需要专门的设备，但是许多机构已经广泛使用了这种技术。但是，虽然这种技术可能实现高度空间分辨率，但是它消耗人力，并且难以批量使用。使用空间转录学 (Spatial Transcriptomics，10X Genomics)与Slide-seq方法可以直接从冰冻组织切片中直接捕获mRNAs，然后将这些mRNAs直接加载到寡核苷酸微阵列玻片(oligo- arrayed microarray slides)或严密包装寡核苷酸的pucks上。寡核苷酸包括空间条形码、UMI和oligo-dT引物，它们能唯一地识别每个转录本及其位置。测序读长被回贴到玻片的坐标上，用于生成空间基因表达信息。空间转录学方法已经被证明能够在一系列物种的组织中能发挥作用，其中就包括小鼠大脑和人类乳腺癌组织，人类心脏组织和拟南芥(A. thaliana)花序组织。Slide- seq是最近开发的一种技术，它已经被证明能够对小鼠大脑的冰冻切片进行测序。这些直接 mRNA捕获方法并不需要特殊的设备，且有相对简单的分析方法，并有可能大规模地应用于许多组织。然而，还有两个局限需要解决。首先，该技术只能应用于新鲜的冷冻组织。其次，分辨率受到到阵列大小和捕获寡核苷酸点和珠子的间距的限制；目前的分析只能使用6.5x7 mm和3x3mm这两种规格，这就限制了组织切片的尺寸。空间转录组学斑点的直径为100µm，间距为100µm，这意味着它们不够小或不够密集，无法实现单细胞级分辨率。Slide- seq珠子则要小的多，直径只有10µm，而且非常密集，比相对前者具有十倍的空间分辨率，并且测序中的大约一半的珠子似乎是从单个细胞层面产生的数据。从分解的组织和空间编码的数据与scRNA-seq混合起来的计算方法可以改善分辨率，但是需要基础技术的进一步发展，以使其成为更常规的RNA-seq工具。</p>
<p>上述空间分辨RNA-seq方法的替代方案包括原位测序和使用单分子荧光原位杂交的基于成像的方法。这些方法能够产生比RNA-seq方法更窄的转录组信息，但它们能直接检测RNA，并且能够对低丰度的转录本进行分析。同时，它们还能提供组组织结构和微环境的信息，并能产生亚细胞数据。这种方法目前正取得了巨大进步，但是成像方法的一个主要局限就是需要高分辨率或超分辨率显微镜与自动流体技术结合，并且这种技术的成像时间可能要花上数小时，甚至是几天。测序成本的下降比摩尔定律预测的速度更快，与测序成本相比，高通量成规模的成像系统的机会似乎更有限。</p>
<p>上述提到的空间转录组学都受到无法产生深度转录组学数据的限制，以及受到细胞分辨率和/或高成本（时间和/或资金）的限制，但是这些方法正在迅速改进，并且已经应用于临床样本。空间转录组学的具体计算方法开始出现。此外，原位RNA测序和成像方法的进步已经使得10E3到10E5个细胞生成的转录组数据成为可能，这与基于液滴的单细胞方法获得的数据量相近。未来的发展有可能使得空间转录组学让更普通的研究者们使用。然而，大多数的研究们者并不太可能需要真正的单细胞或亚细胞级分辨率。因此，转录组表达谱的宽度和对广泛的组织或样本的应用性可能会推动这些技术在特定小众领域被采用。如果空间转录组学的这些技术限制能够被解决，那么它才有可能被广泛使用。</p>
<h3 id="动态RNA-seq分析-Beyond-steady-state-RNA-analysis"><a href="#动态RNA-seq分析-Beyond-steady-state-RNA-analysis" class="headerlink" title="动态RNA-seq分析(Beyond steady-state RNA analysis)"></a>动态RNA-seq分析(Beyond steady-state RNA analysis)</h3><p>DGE分析是使用RNA-seq来检测稳态下的mRNA表达水平，这一表达水平是通过mRNA的转录，加工和降解速度来决定的。但是，RNA-seq也可以用于研究涉及转录，翻译所涉及的过程与动力学特征，这些研究为基因表达提供了新的思路。</p>
<h3 id="使用新生RNA-nascent-RNA-方法来研究活性转录"><a href="#使用新生RNA-nascent-RNA-方法来研究活性转录" class="headerlink" title="使用新生RNA(nascent RNA)方法来研究活性转录"></a>使用新生RNA(nascent RNA)方法来研究活性转录</h3><p>基因表达是一个内在的动态过程，但是在检测复杂转录应答的细微以及快速变化或确定不稳定的非编码RNAs，例如增强子RNAs方面，常规的DGE分析方法就比较受限。RNA-seq可以用于绘制TSSs以及定量新合成的新生RNA，这就可以用来研究RNA动力学。但是，与DGE分析相比，nascent RNA的分析则比较难，因为它们半衰期短，丰度低。因此，为了研究这些动态的重要性，研究者们就开发了多种方法来分析nascent RNA；这些方法揭示了在启动子处的差异转录程度，表明RNA聚合酶II(Pol II)在启动子附近的暂停是基因表达的关键调节步骤，证明了nascent RNA有直接调节转录的作用，并表明其序列和结构影响转录的延伸，暂停和停顿，以及发挥染色体修饰结合和增强了子的作用。nascent RNA- seq方法旨在区分新近转录的RNA和其它RNAs，这些方法可以分为3类：run-on方法，Pol II免疫沉淀法，代谢标记法(FIG. 4)。</p>
<h3 id="Figure4-nascent-RNA与翻译组分析的关键概念"><a href="#Figure4-nascent-RNA与翻译组分析的关键概念" class="headerlink" title="Figure4-nascent RNA与翻译组分析的关键概念"></a>Figure4-nascent RNA与翻译组分析的关键概念</h3><p><img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190805185641.png" alt=""></p>
<p><strong>Figure 4- nascent RNA与翻译组分析的关键概念。nascent RNA分析方法是将那些在一个细胞中新转录的RNAs从其它的RNAs中富集出来，并将它们与未富集的RNA（成熟的RNA）进行比较，富集nascent RNAs的方法主要有三种。(a)Run-on方法是利用一个限时脉冲的方法将修饰过的核糖核酸添加到细胞培养基中，对细胞的RNA进行标记；这一过程可以用使用各种修饰的核苷酸，但是，图中的GRO-seq使用的是Bru修饰的核苷酸。当修饰过的核苷酸整合到RNA后，利用抗BrU的抗体，通过IP的手段将nascent-RNA链富集起来，并用于文库制备以及测序分析。(b)RNA聚合酶II(Pol II)的IP方法则是利用了微球菌核酸酶(micrococcal nuclease)消化了染色质后，使用相应的抗体拉下了与Pol II结合的RNA。在染色质消化过程中，nascent RNA通过其Pol II足迹保护而不受核酸酶活性的影响，并不会被降解。(c)代谢标记方法标记RNA的方法类似于Run-on方法，但前者使用的是核苷酸类似物4 sU。提取RNA后，烷基化4 sU，在逆转录过重中，就会产生G核苷酸的错配，从而通过在碱基对级分辨率的突变分析中直接确定4 sU的整合位点。制备3’末端RNA文库会通过降低未标记的RNA数量来增加测序过程中的信号强度。图片参考文献为214。</strong></p>
<p>Run-on法是将核酸类似物添加到样品中，从而使nascent RNA能够从总的RNA混合物中进行富集，并能够检测瞬时RNA的转录(FIG. 4a)。全局run-on测序(Global run-on sequencing, GRO-seq)与精确核酸run-on测序(Precision nuclear run-on sequencing, PRO-seq)是分别将Bru或生物素修饰的核酸在RNA的转录期整合到nascent RNA中来实现的。其过程大致为，分离细胞核，并通过洗涤除去内源性核苷酸，再添加外源生物素标记的核苷酸，随后恢复转录。通过免疫沉淀或亲和纯化的方法，对富集的新转录RNA进行测序，从而检测参与转录的RNA聚合酶的位置和活性。由于run-on过程中标记的核苷酸的数据，GRO-seq只能测到10-50bp的长度，这就降低的TSS检测的精度。PRO-seq能够实现单个碱基级的分辨率，因为生物素标记的核苷酸掺入后转录就停止，可以识别出转录位点。Run-on方法理解起来很简单，就是RNA分子整合了修饰的核苷酸，并对其进行富集，用于测序，但是在实践中，背景中存在有non-nascent RNA，这就需要增加读长深度。利用这些方法，提示了启动子处，启动子处差异或双向转录本起始的程度，确定了增强子RNA在调节基因表达方面的作用。通过特定富集5’加帽的RNAs，GRO-cap，PRO-cap或small 5’capped RNA测序(small 5ʹ-capped RNA sequencing, START-seq)增加了检测转录起始和捕获RNAs的灵敏度和特异性，这种处理还会降低源于转录后加帽的RNAs的背景信号。</p>
<p>Pol II的免疫共沉淀方法包括，天然延长转录测序(native elongating transcription sequencing, NET-seq)和哺乳动物染色质天然转录测序法(native elongating transcript sequencing for mammalian chromatin, mNET-seq)，使用抗FLAG（用FLAG标记的Pol II）抗体进行沉淀的方法，或各种针对Pol II C末端结构域(CTD)的沉淀方法(FIG. 4b)。与这些染色质复合物结合的nascent RNA的RNA-seq方法用于检测TSSs，虽然non-nascent Pol II结合的RNA与背景mRNA会对读长浓度产生负面影响，影响分析。NET-seq缺乏特异性，因为任何与Pol II强烈结合的RNA都会污染nascent RNA的富集效果，例如在NET-seq数据中就存在有tRNA和small nucleolar RNA。在mNRET-seq中使用多个CTD抗体提示了VTD修饰是如何影响转录的，检测到了RNA加工的中间体，并能能够将特定的Pol II nascent RNAs定位于TSSs。然而，这些检测能力是以更复杂的实验，更多的细胞数量和更高的测序成本为代价的。</p>
<p>使用核苷酸类似物硫代吡啶(4-thiouridine, 4 sU)进行代谢脉冲标记(Metabolic pulse- labelling)的方法可以识别nascent RNA(FIG. 4c)。但是，在那些需要长标记时间的方法中，大多数的转录本都会被标记，这就限制了这种方法的灵敏度。通过专门针对RNAs的3’末端（仅最近拉RNA聚合酶的新转录的RNA）的方法，瞬时转录组测序(transient transcriptome sequence, TT-seq)与硫醇(SH, thiol)连接的烷基化RNA代谢测序(thiol(SH)-linked alkylation for metabolic sequencing of RNA， SLAM-seq)能够降低来源于5’RNA的信号。TT-seq将标记时间限制在5分钟，因此只标记新转录本的3’末端，它在进行生物素亲和纯化前，有一个RNA片段化操作，用于富集标记的RNA。SLAM-seq整合了3’mRNA-seq文库制备方法（虽然它也用于其它的文库制备，例如miRNA）， 它仅针对标记的新转录的RNA进行测序，而非整个转录本进行测序。此外，在SLAM-seq中，提取RNA后，还要加入碘乙酰胺(iodoacetamide)，用于烷基化已经插入到新生成的nascent RNA链中的4 sU残基。这种修饰会诱导反转录式依赖的胞腺嘧啶到胞嘧啶的转换(T &gt; C)，这在测序分析中会被检测为“突变”，从而直接识别为4 su整合位点。然而，低掺入率意味着只有少量的4 sU位点可以被转换为胞嘧啶，这就限制了灵敏性。有两种方法，即TUC-seq与TimeLapse-seq也使用T&gt;C这种突变分析方法，但是它们并不富集3’末端。这两种方法用于研究细胞干扰后的转录应答和RNA的半衰期。</p>
<p>Nascent RNA分析方法还未进行过直接比较。Nascent RNA方法都受到非特异性背景和/或降解的RNA的负面影响，这会影响读取深度。通过仅测序3’末端，那么non-nascent RNA的效应就会在PRO-seq，TT-seq和SLAM-seq中降低，但是几乎没有证据表明是否有其他方法更优。亲和纯化方法费时费力，与代谢标记法相比，前者需要更多的起始材料，但是，确定脉冲标记的时间比较复杂，并且短脉冲产生用于分析的RNA很少，这限制了灵敏度。最近开发的，组织特异性RNA标记方法以及亲折突变分析计算方法或许能够促进研究者转向使用生化（基于生物素）富集的手段来研究富含生物学意义的nascent RNA和其它RNA。Nascent RNA方法以及它们与其它方法的隧和，例如空间转录组学或RNA-RNA与RNA-蛋白质相互作用的方法，将会提高我们对转录过程的理解。</p>
<h3 id="使用核糖体分析方法检测活跃的翻译"><a href="#使用核糖体分析方法检测活跃的翻译" class="headerlink" title="使用核糖体分析方法检测活跃的翻译"></a>使用核糖体分析方法检测活跃的翻译</h3><p>RNA-seq的主要用途在于研究样本中的mRNA的种类与数量，但是mRNAs的存在与否并不直接关系到蛋白质的合成。现在有两种方法可以研究转录以外的翻译情况，可以让研究者们更好的理解翻译组(translatome)：一种是多核糖体表达谱(polysomal profiling)，一个是核糖体足迹RNA-seq(Ribo-seq)。核糖体对mRNAs的翻译具有高度的调节作用，蛋白质水平主要由翻译活性决定。多核糖体表达谱与Ribo-seq可以让研究者探索一个转录本占用多少个核糖体以及核糖体在转录本上的分布(FIG. 5)。这种方法可以让研究者推断在特定时间或细胞状态下哪些转录本正在被活跃地翻译。这两种方法都假设mRNA 核糖体的密度与蛋白质合成的水平相关。在不同样本之间进行比较，就能提示治疗条件下，时间推移以及疾病发展过程中，核糖体的动力学特征，上述的这些情况都与翻译的异常调控有关，例如纤维化，朊病毒或癌症。</p>
<p><img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190805185740.png" alt=""></p>
<p><strong>Figure 5-翻译组的关键概念。翻译组方法是从那些与核糖体结合的RNA中生成RNA-seq数据，这种方法假设mRNA上的核糖体的密度与蛋白质的合成水平相关。(a)多核糖体表达谱的方法是通过离心将RNA分子分成多核糖组分，然后通过RNA-seq的方法进行比较。在多核糖体组分中表达较高的RNA被认为是更活跃的转录。(b)核糖体足迹(Ribo-seq)法使用RNase来降解暴露的RNA，同时保留那些被核糖体保护的未被降解的RNA。通过对这些保护的RNA进行测序，就可以揭示出核糖体的密度与位置。通过修改变标准Ribo-seq方法，定量翻译起始测序(QTI-seq)或翻译复杂表达谱测序(TCP-seq)可以专门富集起始核糖体或其亚基，同时剔除延长的核糖体，因此可以对翻译的动态过程进行更详细的分析。对翻译组RNA-seq数据的过计算 分析可能确定每个mRAN的相对翻译程度，可以研究翻译的起始，延长与终止的动力学过程。</strong></p>
<p>在多核糖体表达谱实验中，使用蔗糖梯度超离心将与多个核糖体(多核糖体组分)结合的mRNA和与单个核糖体结合的mRNA（单核糖体组分）分离开来，前者用于RNA seq文库制备(FIG. 5a)。与单核糖体组分中检测到的mRNA相比，在多核糖体组织中检测到的高丰度mRNAs可以被认为翻译得更频繁。这种方法也可以用于推测单个mRNAs的翻译状态，也可以用于生成高分辨率的核糖体占有信息与密度（尽管它无法确定核糖体的位置）。这类方法的原始方法已经进行了几项改进。例如，使用非线性蔗糖梯度改善了多核糖体收集，使多核糖体在不同浓度蔗糖溶液界面的收集过程更为简单，使用Smart-seq文库构建技术可以让研究者们分析仅10ng级的多核糖体mRNA，使用更高分辨率的蔗糖梯度和深度测序可以检测了转录本异构体的特异性翻译。然而，多核糖体表达谱实验生成的翻译组信息分辨率相对低，这一过程还比较费力，需要特殊的仪器，这就限制了其应用范围。</p>
<p>Ribo-seq是基于RNA足迹的方法，它最初用于酵母研究。这种方法用环己胺(cyclohexamide)来抑制翻译延伸，并诱导核糖体在mRNAs上停滞。用RNase I消化mRNA会留下20-30个核苷酸，这20-30个核苷酸就是受核糖体保护的足迹，这些足迹被处理后用于制备RNA-seq文库(FIG. 5b)。Ribo-seq能生成高分辨率的翻译谱，描绘核糖体丰度和单个转录本的位置。而多核糖体分析中无法提供核糖体的位置信息时，这说明有可能检测到了翻译的暂停，这些检查可以调节蛋白质的表达。当方法修改了缓冲液和对酶进行了优化后，就能更清楚地揭示Ribo-seq数据中3-bp的周期性，以及条形码和UMIs（检测单个分子的事件）。标准的RNA-seq工具可以用于Ribo-seq的计算分析，但最近已经出现了特定的工具用于寻找开放阅读框，用于差异或异构体水平的翻译分析，以及用于研究密码子偏倚。Ribo-seq的主要限制就是超速离心，以及由于核酸酶不同批次间的变化，以需要经验来确定RNase I的消化条件。</p>
<p>这些方法检测的是来自翻译起始、延伸和终止的信号的平均强度，但是对Ribo-seq的修改可使得其能够研究翻译动力学。定量翻译起始测序(Quantitative translation initiation sequencing, QTI-seq)通过化学“冷冻”和富集起始核糖体，同时从结合的mRNA中去除延长的核糖体来定位转录起始位点。翻译复杂谱测序(Translation complex profile sequencing, TCP-seq)也通过在组装成熟核糖体之前富集与40S核糖体小亚基结合的RNA来检测起始位点。然而，由于这种方法中保留了核糖体的完整性，也可以分析和比较80S核糖体组分，从而更全面检测翻译动力学(FIG. 5b)。</p>
<p>所有的翻译组方法在概念上都是相似的；它们假设mRNA核糖体的密度与蛋白质的合成水平相关。虽然它们的样本制备方案不同，但都需要大量的起始细胞数。最终，翻译组与RNA-seq结合起来研究基因的表达水平，并与蛋白质组学一道来研究蛋白水平，这可能就需要对mRNA的翻译进行一个广泛地理解。如果想要了解翻译组的更详细信息，可以阅读最近的综述。</p>
<h2 id="RNA结构与相互作用分析-Beyond-analysis-of-gene-expression"><a href="#RNA结构与相互作用分析-Beyond-analysis-of-gene-expression" class="headerlink" title="RNA结构与相互作用分析(Beyond analysis of gene expression)"></a>RNA结构与相互作用分析(Beyond analysis of gene expression)</h2><p>RNAs在调节其它生物分子和生物过程（例如剪接和翻译）中发挥着重要作用，它们涉及RNA与各种蛋白质和/或其它RNA分子的相互作用。RNA-seq可以用于研究分子内和分子间RNA-RNA的相互作用(RNA-RNA interactions, RRIs)，这可能让研究者更好地理解结构组(structurome)，或者是研究RNA与蛋白质之间的相互作用，这样就可以深入理解转录与翻译(FIG. 6)。针对相互作用组(interactome)分析而开发的各种方法都有一个共同的主题：在RNA中富集出那些与其它RNA有相互作用的RNA。一些方法利用的是天然生物学相互作用，而其它的方法则是在目标分子之间计算瞬时作用力或共价键；大多数方法使用的是抗体pull-dwon、亲和纯化或探针杂交的手段来富集RNA进行测序。在这里我们简要描述一下主要的基于RNA-seq的方法来研究结构组和相互作用体的内容。</p>
<h3 id="Figure6—RNA结构和RNA-蛋白质相互作用分析的关键概念"><a href="#Figure6—RNA结构和RNA-蛋白质相互作用分析的关键概念" class="headerlink" title="Figure6—RNA结构和RNA-蛋白质相互作用分析的关键概念"></a>Figure6—RNA结构和RNA-蛋白质相互作用分析的关键概念</h3><p><img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190805185828.png" alt=""></p>
<p><strong>Figure 6-RNA结构和RNA-蛋白质相互作用分析的关键概念。(a)结构组分析使用核酸酶或化学标记试剂在全转录组范围内来研究结构化RNA（例如双链RNA，dsRNA）或非结构化RNA（单链RNA，ssRNA）。在大多数实验中，在单独的反应中对ssRNA和dsRNA进行检测，其结果联合反应性分析法来确定其结构特征。核酸酶消化方法使用针对dsRNA和/或ssRNA的一个或多个核酸酶来研究RNA的结构。例如，在对RNA结构要的并行分析(PARS)中，在体外使用RNase V1（一种dsRNA特异性核酸酶）或S1核酸酶（一种ssRNA特异性核酸酶）来酶切并行样本。酶解后剩余的RNA被转化为cDNA，然后进行测序，测序的读长深度与比对区域的反应性成正比。RNA-seq数据的覆盖和比较结果就能推断RNA的结构。化学分析法(Chemical-mapping methods)，例如使用引物延伸的选择性2ʹ-羟基酰化分析法(SHAPE-seq)或突变表达谱分析法(SHAPE-Map)，这些方法通过结构依赖形式在体外或体内对双链或单链区域的核糖核苷酸进行修饰。标记物可以阻断逆转录，导致cDNAs的截短，或者是导致修饰位置错误地掺入突变。RNA被转化为cDNA后进行测序，读长深度或突变率与比对区域的反应性成正比，从而推断RNA的结构。(b)RNA-RNA的相互作用分析方法，例如SPLASH，这种方法的第一步是将有相互作用的RNA分子通过生物素化的补骨脂进行交联，然后以通过链霉亲和素对其进行富集，第二步是在邻近位置加入相互作用RNA的自由端加入邻近连接与及片段化。第三步是进行RNA接头的连接以及环化，制备RNA-seq文库用于测序，从而揭示出分子内（也就是结构）的RNA相互作用以及分子间的相互作用位点。(c)RNA-蛋白质相互作用方法，例如RNA交联免疫沉淀后测序(CLIP-seq)，这种方法使用UV辐射在相互作用的RNA和蛋白质之间产生共价交联。目的蛋白被抗体富集后，与此蛋白结合的RNA也就被富集了下来，这些RNA加上3’接头后，提取出来用于cDNA的合成。从结合了接头的RNA生成的cDNA用于文库制备，测序。</strong></p>
<h3 id="通过研究RNA分子内的相互作用来研究RNA的结构"><a href="#通过研究RNA分子内的相互作用来研究RNA的结构" class="headerlink" title="通过研究RNA分子内的相互作用来研究RNA的结构"></a>通过研究RNA分子内的相互作用来研究RNA的结构</h3><p>核糖体RNA和tRNA构成细胞的大部分RNA。它们与其他结构非编码RNA一起在细胞中发挥各种作用，例如从基因调节到翻译。现存主要有两种研究RNA结构的方法：基于核酸酶的方法和化学探针方法。核糖核酸酶消化于1965年首次用于研究RAN(tRNA(Ala))的结构。在接下来的40年中发展了化学方法，例如，通过引物延伸的选择性2ʹ-羟基酰化法(selective 2ʹ-hydroxyl acylation analysed by primer extension, SHAPE)，此种方法用于在单碱基分率水平上检测tRNA(Asp)的结构。但是，只有将各种核酸酶法和化学方法与RNA-seq相结合，才能使方法从单一RNA转移到全转录分析，这正在改变我们对结构复杂性和重要性的理解。在这里，我们集中讨论核酸酶和化学分析方法之间的主要区别(图·6a)，如果想对这方面有进一步的理解，可以看Strobel在这方面的综述。</p>
<p>核酸酶方法，例如RNA结构的平行分析法(Parallel Analysis of RNA Structure，PARS)和片段测序法(fragmentation sequencing, FRAG-seq)，这两种方法使用能消化单链RNA(ssRNA)或双链RNA(dsRNA)的酶。核酸酶消化后剩余的RNA用作RNA-seq的文库构建。随后通过对产生的RNA序列数据进行计算分析来识别结构化(双链)和非结构化(单链)区域。核酸酶易于使用，可以用于研究ssRNA和dsRNA，但是由于核酸酶消化法的随机特性，它们与化学分析法相比，分辨率比较低。此外，由于核酸酶尺寸比较大，这就限制了这些核酸酶进入细胞，这就使得它们不适合体内研究。</p>
<p>​     化学分析法使用与RNA分子反应的化学探针，来标记结构化或非结构化核苷酸。这些标记要么阻断逆转录，要么导致cDNA的错配，从而可以定位并分析RNA-seq读长，用于揭示结构组。SHAPE之后进行测序，这种技术方法能够RNA骨架上的核糖2’-羟基反应来标记未配对的ssRNA，虽然发夹环中的碱基折叠会降低其效率。Structure-seq与硫酸二甲酯测序(dimethyl sulfate sequencing, DMS-seq)能使用DMS来标记腺嘌呤和胞嘧啶残基，阻断逆转录，最终从生成的截短cDNAs分析中推断出RNA结构。SHAPE和突变表达谱(SHAPE and utational profiling, SHAPE-Map)和DMS突变表达谱测序(DMS-MaPseq)都修改了实验条件，从而提高了逆转录酶的加工能力，并防止cDNA截短。相反，化学标记会导致错配事件，在RNA-seq数据的分析中，能够检测出这些“突变”，从而揭示RNA结构。化学探针是小分子化合物，尽管由于细胞内的环境处于动态变化中，数据有可能更加多变，但是化学探针还是能够用于研究活体内的有生物学意义的结构。化学探针还可以用于nascent RNAs的结构分析，并揭示共转录RAN折叠的顺序。</p>
<p>核酸酶和反转录阻断方法通常产生短RNA片段，并且只报告单个酶切位点或化学标记，而错误结合和突变检测方法可以报告每个读长的多个化学标记。没有方法不存在偏倚；逆转录阻断永远不会100%有效，本应诱导突变的化学标记可以阻断cDNA合成，这两个因素都可以影响数据的解读。Spike-in控制有可能改善结构组分析的质量，但尚未得到广泛使用。SHAPE方法的比较揭示了仅在体内实验中才会出现效率差异，因此这就突显出比较类似复杂方法时所需要谨慎。</p>
<p>这些方法正在产生关于RNA结构如何在基因和蛋白质调控中发挥作用的新理解。例如，DMS分析说明了，RNA结构有可能调控APA，或许会减慢催化活性区域的翻译，使得更多的时间用于蛋白质的折叠，从而减少错误折叠事件。结构RNA-seq方法的结合有可能产生所有的完整结构组信息。随着该领域的扩展，我们可能会发现，RNA的结构与疾病的进展和或疾病的状态有关；最近的结果表明，异常RNA结构在重复扩张性疾病方面可能发挥作用。最终，结构组分析也许会促进那些靶向作用于研究透彻的RNA结构的小分子的开发，从而开辟治疗开发的新领域。</p>
<h3 id="研究分子间RNA-RNA相互作用"><a href="#研究分子间RNA-RNA相互作用" class="headerlink" title="研究分子间RNA-RNA相互作用"></a>研究分子间RNA-RNA相互作用</h3><p>分子间的RRIs在转录后调控中发挥着重要作用，例如miRNA与靶基因的3’UTR结合。现在已经开发了用于研究分子间RRI的工具，它们用于靶向分析和转录组分析。这些分析方法含有一个共同的工作流程，即RNA在打断与邻位连接之前，通过交联来保护其相互作用(FIG. 6b)。大多数并非全部，由不同方法嵌合生成的嵌合cDNA来源于稳定碱基配对（即相互作用）RRNA分子的连接。靶向方法，例如交联，连接和杂交物测序(Crosslinking, ligation and sequencing  of hybrids, CLASH)， RNA相互作用组分析和测序(RNA interactome analysis and sequencing, RIA-seq)和RNA反义纯化方法测序(RNA antisense purification followed by RNA sequencing, RAP-RNA)能产生一个RNA或RNA家族的高深度相互作用图谱。CLASH丰富了使用IP来进行特定蛋白复合物介导的RRI分析方法，而RIA-seq使用反应寡核苷酸来回收那些与靶基因有相互作用的RNAs；这两种方法都无法区分直接和间接的RRIs，这就导致其生物学解释变得复杂。为了提高RRI分析的分辨率，RAP-RNA使用补骨脂素(psoralen)和其他交联剂，然后用反义寡核苷酸捕获RNA，以及使用高通量RNA-seq来检测直接和间接RRI。虽然该方法可以进行更具体的分析，它需要制备多个文库（每个交联剂一个文库）。</p>
<p>转录组方法从根本上类似于靶向方法：相互作用的RNA在体外被交联后并被富集。通过减少进入连接反应的非相互作用RNA的量来提高富集的特异性，并且可以通过2D凝胶纯化(如在RNA相互作用和结构的补骨脂素分析(psoralen analysis of RNA interactions and structures, PARIS)或交联RNA的生物素亲和纯化(如在补骨脂素交联，连接和选择的杂交测序， sequencing of psoralen crosslinked, ligated and selected hybrids,SPLASH)来实现，或者通过RNase R酶的消化来清除非交联RNA(如在相互作用的RNA连接之后的RNA-seq, ligation of interacting RNA followed by RNA- seq， LIGR-seq)。连接后，在进行RNA-seq文库制备前，去除交联，然后进行测序。PARIS能够生成所有方法中最高数目的相互作用次数，但是每个样本需要75M的读长，这些任何其他的RRI方法都多，并且所需要的DGE实验平均读长深度是其他实验的2倍。</p>
<p>对整理好的RNA相互作用数据的分析可以对多个相互作用进行可视化，并些这种分析方法已经提示了RNA各类的RRI分布的变化。总之，90%的RRIs涉及mRNAs。近一半涉及miRNA或长链非编码RNA，对于这些RNA，大多数相互作用都与mRNA靶基因相关。对这些整理数据的比较揭示了不同方法对特定RNA物种的偏倚，这导致这些方法之间几乎没有重叠。因此，绘制RRI的完整图谱可能需要使用不止一种方法。然而，RRI方法有几个局限性。也许最具挑战性的就是RRI是动态的，并受结构构象和其他分子间相互作用的影响，这使得在没有重复的情况下，很难对其进行解释。分子内的相互作用为分子间的RRI分析增加了干扰，这就需要过滤并除去那些高度结构化的RNAs，例如rRNAs。其它的问题还包括RNA提取过程中相互相互作用的打断，这就需要稳定的交联方法，但最常用的RRI交联剂是补骨脂素和4’-氨基-甲基三氧沙林(4ʹ-amino- methyltrioxsalen, AMT)，这些交联剂只交联嘧啶，其效率比较低，会降低灵敏度。此外，邻近连接步骤低效，并且这会连接相互作用和非相互作用RNA，进一步降低灵敏度。</p>
<h3 id="研究RNA-蛋白质相互作用"><a href="#研究RNA-蛋白质相互作用" class="headerlink" title="研究RNA-蛋白质相互作用"></a>研究RNA-蛋白质相互作用</h3><p>ChIP-seq已经成了绘制和研究DNA-蛋白质相互作用不可或缺的工具；类似的IP方法也用于研究RNA-蛋白质的相互作用。RNA-蛋白质相互作用方法依赖于IP，利用针对感兴趣的RNA结合蛋白的抗体来捕获其结合的RNA进行分析（第一次报道时是用芯片进行分析的）(FIG. 6c)。各种RNA-蛋白质相互作用方法之间最明显的区别在于相互作用的RNA和蛋白质是否交联以及如何交联：一些方法避免交联(天然IP， native IP)，其他方法使用甲醛进行交联，一些方法使用紫外线(UV)光进行交联。最简单的方法就是RNA免疫沉淀测序(RNA immunoprecipitation and sequencing, RIP-seq)，时常，但并非所有情况下都使用天然IP法，以及并非总进行RNA打断。这种简便性使用该方法易于被采用。这种方法能产生有用的生物学信息，但是它有两个重要的缺陷。第一，用于保存RNA-蛋白质相互作用的前提是需要进行温和地洗涤，这就意味着富集的片段中有相对高的非特异性结合片段。第二，没有进行RNA打断就降低了结合位点的分析。因此，RIP-seq具有高度灵活性，并依赖于RNA-蛋白质结合的自然稳定性。使用甲醛交联在RNA与其相互作用的蛋白质之间产生可逆的共价键提高了稳定性，并减少了非特异性RNA的回收，但甲醛也会导致蛋白质-蛋白质的交联。这种影响可以通过使用0.1%的甲醛（比ChIP-seq研究使用的甲醛低10倍）进行温和的交联来降低，这能在多个蛋白质靶点上产生高质量的结果。</p>
<p>在CLIP中使用254nm的UV来进行联系是一项关键的技术，它提高了RNA-蛋白质相互作用分析方法的特异性和位置分辨率。UV交联在蛋白质和RNA的相互作用位点产生共价键，但最重要的是，它不对蛋白质-蛋白质相互交联。这就稳定了RNA-蛋白质的结合，允许严格的富集，破坏了天然RNA-蛋白质的相互作用，减少了背景信号。CLIP的实验方法随后就构成了许多方法发展的基础。单个核苷酸分辨率的CLIP(iCLIP)将UMIs整合到文库中，用于移除PCR复制。它还利用了cDNA合成在交联核苷酸处常见的过早截短，通过对截短的cDNA进行扩增来获得交联位点的定量，核苷酸级分辨率图谱。光激活核糖核苷增强片段(Photoactivatable- ribonucleotide-enhanced CLIP,PAR-CLIP)通过使用4 sU和356nM的UV来进行交联。在细胞培养过程中，4 sU被整合到内源RNAs中，356nm的UV辐射会在4 sU整合位点处产生交联（产生高度的特异性）。在产生的测序数据中检测反转录诱导的T&gt;C替换就会能够实现碱基对级的分辨率，并且能够区分交联片段和非交联片段，进一步降低背景信号。最近对CLIP的改进提高了它的效应和灵敏度。红外CLIP(infrared CLIP, irCLIP)用红外凝胶成像技术来代替放射性同位素检验，它是基于珠子的纯化技术。与常规的iCLIP使用的1百万到2百万细胞相比，这些技术的改进可分析只有2万个细胞的RNA-蛋白质相互作用。增强型CLIP(enhanced CLIP, eCLIP)抛弃了RNA-蛋白质复合物的质控和可视化操作，而是在RNA接头中添加了条形码，这种改进可能让所有的样本混合到一起，并用珠子来代替了凝胶。这些改进旨在简化实验操作，eCLIP实验已经研究了近200个蛋白，它已经成了ENCODE项目的一部分。但是，irCLIP与eCLIP目前都没有被广泛采用，部分原因是eCLIP和irCLIP的灵敏性增加的原因是由于其特异性降低导致的，比如利用两个方法所鉴定的PTBP1结合位点上结合或有序和调节外显子的富集减少。随着公共数据库中可用的大量数据为计算分析提供了新的机会，因此谨慎考虑CLIP数据的质控，过滤，以及峰值调用(peak calling)和归一化方法就变得非常重要，这些会影响数据的生物学解释。为了更全面地讨论 RNA-蛋白质的相互作用的CLIP实验方法，我们建议读者可以阅读最近关于这个主题的综述。</p>
<p>一些RRI以及所有的RNA-蛋白质结合方法对IP的依赖限制了其对有良好特征抗体蛋白质的研究，而非特异抗体的结合仍然是一个问题（虽然这一问题并非局限于这个领域）。RNA结构也会影响RNA-蛋白质之间的相互作用；一些蛋白质能识别特异的RNA二级结构或与这些结构竞争结合RNA，这使得体外的发现转向体内就变得复杂了。此外，结构和RNA-蛋白质相互作用方法通常报告一个特定转录本或位置的平均值。在实验室方法中，在计算方法和单分子测序方面的未来发展或许有助于破译一些这些生物变异。</p>
<h2 id="结论"><a href="#结论" class="headerlink" title="结论"></a>结论</h2><p>Wang，Gerstein和Snyder关于RNA-seq将“革命性地[如何]分析真核转录体”的预测肯定是正确的。但是，即使是他们，也有可能对这种转型的规模感到惊讶。现在我们可以分析RNA生物学的许多方面，这对于基因组功能、研究开发和确定导致癌症和其他疾病的分子调控异常方面来说是必不可少的。虽然生物学发现阶段还远未结束，但是已经在临床中使用了RNA-seq方法。单细胞测序正在成为许多实验的标准配置，空间转录组学的分析可能会遵循类似的路径，使其能够在与开发当前方法的实验室范围之外使用。长读长测序方法也有可能取代当前相当大比例的研究者们默认选择的Illumina的短读长RNA-seq。对于这种情况的出现，长读长测序技术还需要在增加通量和降低错误率方面做出极大的改进。 然而，长读长mRNA异构体测序的优点是，如果它变得像现在短读长测序一样便宜和可靠，那么对于那些除了易降解材料外，长读长测序就可能是首选。考虑到这些因素，那么任何关于RNA-seq在未来十年可能如何发展的预测都有可能过于保守。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2019/08/04/DAL/DALS004_Inference03_CLT_T_test/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/08/04/DAL/DALS004_Inference03_CLT_T_test/" itemprop="url">DALS004-统计推断(Inference)02-CLT与T-test</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-08-04T12:00:00+08:00">
                2019-08-04
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/生物统计/" itemprop="url" rel="index">
                    <span itemprop="name">生物统计</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  9,808
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  39
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>这篇笔记是《Data Analysis for the Life Sciences》的第2章：统计推断(Inference)的第3部分。这一部分的主要内容涉及中心极限理论，t检验和功效计算。</p>
<h2 id="中心极限定理-Central-Limit-Theorem-与t分布"><a href="#中心极限定理-Central-Limit-Theorem-与t分布" class="headerlink" title="中心极限定理(Central Limit Theorem)与t分布"></a>中心极限定理(Central Limit Theorem)与t分布</h2><h3 id="中心极限定理-CLT"><a href="#中心极限定理-CLT" class="headerlink" title="中心极限定理(CLT)"></a>中心极限定理(CLT)</h3><p>当样本的数目非常大的，一个随机样本的均值$\bar{Y}$就会服从正态分布，这个正态分布的均值是总体均值($\mu_{Y}$)，标准差是总体的标准差$\sigma_{Y}$除以样本的数目$N$的平方根。</p>
<p>如果我们将一个随机变量减去一个常数，那么这个新生成的随机变量就会领衔这个常数，从数学角度来说，如果$X$是一个服从均值为$\mu$的分布，$a$是一个常数，那么$X-a$的均值的分布的均值就是$\mu-a$。这个也适应用乘法与标准差(SD)。</p>
<p>如果$X$是一个随机变量，它的分布的均值$\mu$和标准差(SD)为$\sigma$，而$a$是一个常数，那么$aX$这个新的随机变量分布的均值是$a\mu$，标准差为$|a|\sigma$。为了说明这个问题，我们就假设，每只小鼠的体重都减去10，那么平均体重也应该会减去10，类似的，如果我们将小鼠的体重单位由克(g, gram)换成毫克(mg, milligram)，也就相当于把原来的数字都乘以了1000，那么数字的扩散程度也会变大。</p>
<p>这就说明了，如果我们获得了$N$个样本，那么这个公式$\frac{\overline{Y}-\mu}{\sigma_{Y} / \sqrt{N}}$就接近于均值为0，标准差为1的正态分布。</p>
<p>现在我们感兴趣的是两个样本的均值的差值。这个数学公式就比较有用了。</p>
<p>如果我们有两个随机变量，即$X$和$Y$，它们的总体均值与总体均值差为$\mu_{X}$和$\mu_{Y}$，$\sigma_{X}$和$\sigma_{Y}$，然后我们就会得到这些结果：</p>
<p>$X+Y$的均值：$\mu_{X}+\mu_{Y}$。</p>
<p>也会得到$Y-X$的均值，其实这也相当于$Y-X=Y+aX$，其中$a=-1$，这其实也就是说$Y-X$的均值为$\mu_{Y}-\mu_{X}$。</p>
<p>如果说$X$和$Y$是相互独立的样本，那么$Y+X$的方差，就是$\sigma_{Y}^2+\sigma_{X}^2$，从这里我们可以推到，$Y-X$，也即$Y+aX$（其中a为-1）的方差是$\sigma_{Y}^2+a^2\sigma_{X}^2=\sigma_{Y}^2+\sigma_{X}^2$。因此说，$Y-X$这个差值的方差也是两个样本的方差和，这有点反直觉，我们需要知道的就是，X与Y这两个样本是相互独立的，它们确实不相互影响。</p>
<p>从数学角度来理解上面的内容对我们的研究目（两个样本的均值，以及均值的差值）。因此这两个样本都服从正态分布，它们的差值也服从正态分布，方差是两个样本总体的方差之和。在零假设（也就是说这两个样本所代表的两个总体的均值没有差异）成立的前提下，样本均值$\bar{Y}-\bar{X}$的差值的分布接近于均值为0（也就是说没有差异），标准差为$\sqrt{\sigma_{X}^{2}+\sigma_{Y}^{2}} / \sqrt{N}$的正态分布，也就是说下面的这个公式：</p>
<script type="math/tex; mode=display">
\frac{\overline{Y}-\overline{X}}{\sqrt{\frac{\sigma_{X}^{2}}{M}+\frac{\sigma_{Y}^{2}}{N}}}</script><p>的值接近于标准正态分布（均值为0，标准差为1）。</p>
<p>通过这种近似计算，我们就能够将计算p值的过程简单化，因为我们知道任何值在标准正态分布下的比例。例如，这些值中只有5%的比例会大于2（绝对值），计算过程如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pnorm(-<span class="number">2</span>) + (<span class="number">1</span> - pnorm(<span class="number">2</span>))</div></pre></td></tr></table></figure>
<p>计算结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; pnorm(-<span class="number">2</span>) + (<span class="number">1</span> - pnorm(<span class="number">2</span>))</div><div class="line">[<span class="number">1</span>] <span class="number">0.04550026</span></div></pre></td></tr></table></figure>
<p>从上面结果我们就可以知道，只有5%的可能性会大于2，我们前面计算的obstdiff的值是3.020833，因此12只小鼠足够了，不需要买更多的小鼠。</p>
<p>但是，这还没完。因为我们并不知道总体的标准差，也就是不知道$\sigma_{X}$与$\sigma_{Y}$。它们是未知的总体参数，但是，我们可以通过样本的标准差对它们进行估算，估算的总体标准差我们不能希腊字母$\mu$来表示，只能用$s$来表示，那么它们的估计值如下所示：</p>
<script type="math/tex; mode=display">
s_{X}^{2}=\frac{1}{M-1} \sum_{i=1}^{M}\left(X_{i}-\overline{X}\right)^{2} \text { and } s_{Y}^{2}=\frac{1}{N-1} \sum_{i=1}^{N}\left(Y_{i}-\overline{Y}\right)^{2}</script><p>我们需要注意的是，上面的公式里面除以的是$M-1$与$N-1$，而不是前面的$M$与$N$，这有数学方面计算的原因，这里不表，记住就行。但是，为了更加直观地说明一些东西，我们还是要涉及一点。试想，如果你有2个数，把它们画在数轴上，它们之间的距离如果是L，那么中间的那一点就是它们的平均值，这个平均值离它们的距离分别都是0.5L。因此，从这个角度来说，你从这2个数中的一个就能够获取这个信息（这涉及自由度的问题），而不需要2个数，这点不怎么重要，重要的一点是，我们是用了$s_{X}$和$s_{Y}$来估计总体的均值，即$\sigma_{X}$和$\sigma_{Y}$，因为总体均值未知，只能靠样本均值来估计。</p>
<p>因此我们就把前面的那个公式：</p>
<script type="math/tex; mode=display">
\frac{\overline{Y}-\overline{X}}{\sqrt{\frac{\sigma_{X}^{2}}{M}+\frac{\sigma_{Y}^{2}}{N}}}</script><p>定义为下面的这个样子：</p>
<script type="math/tex; mode=display">
\frac{\overline{Y}-\overline{X}}{\sqrt{\frac{s_{X}^{2}}{M}+\frac{s_{Y}^{2}}{N}}}</script><p>如果$M=N$，那么公式就可以化简为如下所示：</p>
<script type="math/tex; mode=display">
\sqrt{N} \frac{\overline{Y}-\overline{X}}{\sqrt{s_{X}^{2}+s_{Y}^{2}}}</script><p>CLT告诉我们，当M与N足够大的时候，上面的这个随机变量就会服从均值为0，标准差为1的正态分布。</p>
<h3 id="t分布"><a href="#t分布" class="headerlink" title="t分布"></a>t分布</h3><p>CLT的计算依赖于大量的样本，也就是我们指的渐进性结果。当CLT不适用时，还需要另外一种不依赖于渐进性结果的选择。当原始总体来源于一个变量，也就是$Y$时，如果这个$Y$是服从均值为0的标准正态分布，那么我们就可以计算下面这个变量的分布：</p>
<script type="math/tex; mode=display">
\sqrt{N} \frac{\overline{Y}}{s_{Y}}</script><p>这是两个随机变量的比值，因此这个比值不一定服从正态分布。事实上，这个公式的分母会偶然变小，因此就相应地会增加观察到更大值的概率。Gosset最初发现的这种分布，由于他开始在论文中以Student的名义投的稿，因此就称这种分布为Student‘s t-distribution，也就是t分布。</p>
<p>现在我们以小鼠的表型数据为例说明一下，我们创建2向量，一个当作对照总体，一个当作高脂总体，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">url &lt;- <span class="string">"https://raw.githubusercontent.com/genomicsclass/dagdata/master/inst/extd\</span></div><div class="line"><span class="string">ata/mice_pheno.csv"</span></div><div class="line">filename &lt;- <span class="string">"mice_pheno.csv"</span></div><div class="line">download(url,destfile=filename)</div><div class="line">dat &lt;- read.csv(filename)</div><div class="line">head(dat)</div><div class="line"></div><div class="line"><span class="keyword">library</span>(dplyr)</div><div class="line">controlPopulation &lt;- filter(dat, Sex == <span class="string">"F"</span> &amp; Diet == <span class="string">"chow"</span>) %&gt;% select(Bodyweight) %&gt;% unlist</div><div class="line">hfPopulation &lt;- filter(dat, Sex == <span class="string">"F"</span> &amp; Diet == <span class="string">"hf"</span>) %&gt;% select(Bodyweight) %&gt;% unlist</div></pre></td></tr></table></figure>
<p>这里需要注意提，我们假设的是的$y_{1},y_{2},\dots,y_{n}$的分布，而不是随机变量$\bar{Y}$的分布。现在我们来看一下这两个总体的分布：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">library</span>(rafalib)</div><div class="line">mypar(<span class="number">1</span>,<span class="number">2</span>)</div><div class="line">hist(hfPopulation)</div><div class="line">hist(controlPopulation)</div></pre></td></tr></table></figure>
<p><img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190721200113.png" alt=""></p>
<p>我们可以使用qq图来确认一下上面的分布是比较接近正态分布的，这里我们只作初步了解，更详细的了解在后面。如果在qq图上，点大致都藻在一条直线附近，它们就属于正态分布，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">mypar(<span class="number">1</span>,<span class="number">2</span>)</div><div class="line">qqnorm(hfPopulation)</div><div class="line">qqline(hfPopulation)</div><div class="line">qqnorm(controlPopulation)</div><div class="line">qqline(controlPopulation)</div></pre></td></tr></table></figure>
<p><img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190721200657.png" alt=""></p>
<h2 id="练习"><a href="#练习" class="headerlink" title="练习"></a>练习</h2><p>P47</p>
<h2 id="中心极限定理的实际运用"><a href="#中心极限定理的实际运用" class="headerlink" title="中心极限定理的实际运用"></a>中心极限定理的实际运用</h2><p>现在我们使用上面的数据来看一下，中心极限定理是如何逼近样本的均值的：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">url &lt;- <span class="string">"https://raw.githubusercontent.com/genomicsclass/dagdata/master/inst/extd\</span></div><div class="line"><span class="string">ata/mice_pheno.csv"</span></div><div class="line">filename &lt;- <span class="string">"mice_pheno.csv"</span></div><div class="line">download(url,destfile=filename)</div><div class="line">dat &lt;- read.csv(filename)</div><div class="line">head(dat)</div><div class="line"></div><div class="line"><span class="keyword">library</span>(dplyr)</div><div class="line">controlPopulation &lt;- filter(dat, Sex == <span class="string">"F"</span> &amp; Diet == <span class="string">"chow"</span>) %&gt;% select(Bodyweight) %&gt;% unlist</div><div class="line">hfPopulation &lt;- filter(dat, Sex == <span class="string">"F"</span> &amp; Diet == <span class="string">"hf"</span>) %&gt;% select(Bodyweight) %&gt;% unlist</div><div class="line">mu_hf &lt;- mean(hfPopulation)</div><div class="line">mu_control &lt;- mean(controlPopulation)</div><div class="line">mu_hf - mu_control</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">&gt; head(dat)</div><div class="line">  Sex Diet Bodyweight</div><div class="line"><span class="number">1</span>   <span class="literal">F</span>   hf      <span class="number">31.94</span></div><div class="line"><span class="number">2</span>   <span class="literal">F</span>   hf      <span class="number">32.48</span></div><div class="line"><span class="number">3</span>   <span class="literal">F</span>   hf      <span class="number">22.82</span></div><div class="line"><span class="number">4</span>   <span class="literal">F</span>   hf      <span class="number">19.92</span></div><div class="line"><span class="number">5</span>   <span class="literal">F</span>   hf      <span class="number">32.22</span></div><div class="line"><span class="number">6</span>   <span class="literal">F</span>   hf      <span class="number">27.50</span></div><div class="line">&gt; </div><div class="line">&gt; <span class="keyword">library</span>(dplyr)</div><div class="line">&gt; controlPopulation &lt;- filter(dat, Sex == <span class="string">"F"</span> &amp; Diet == <span class="string">"chow"</span>) %&gt;% select(Bodyweight) %&gt;% unlist</div><div class="line">&gt; hfPopulation &lt;- filter(dat, Sex == <span class="string">"F"</span> &amp; Diet == <span class="string">"hf"</span>) %&gt;% select(Bodyweight) %&gt;% unlist</div><div class="line">&gt; mu_hf &lt;- mean(hfPopulation)</div><div class="line">&gt; mu_control &lt;- mean(controlPopulation)</div><div class="line">&gt; mu_hf - mu_control</div><div class="line">[<span class="number">1</span>] <span class="number">2.375517</span></div></pre></td></tr></table></figure>
<p>现在计算一下种群的标准差，这里不要使用R的<code>sd()</code>函数，因此这个函数是计算样本的标准差的，它会除以<code>(n-1)</code>，当我们想要对总体进行估计时，按以下代码计算：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">x &lt;- controlPopulation</div><div class="line">N &lt;- length(x)</div><div class="line">populationvar &lt;- mean((x-mean(x))^<span class="number">2</span>)</div><div class="line">populationvar</div><div class="line">var(x)</div><div class="line">var(x)*(N-<span class="number">1</span>)/N</div><div class="line">identical(var(x)*(N-<span class="number">1</span>)/N,populationvar)</div><div class="line">identical(var(x), populationvar)</div></pre></td></tr></table></figure>
<p>计算结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">&gt; populationvar</div><div class="line">[<span class="number">1</span>] <span class="number">11.67205</span></div><div class="line">&gt; var(x)</div><div class="line">[<span class="number">1</span>] <span class="number">11.72416</span></div><div class="line">&gt; var(x)*(N-<span class="number">1</span>)/N</div><div class="line">[<span class="number">1</span>] <span class="number">11.67205</span></div><div class="line">&gt; identical(var(x)*(N-<span class="number">1</span>)/N,populationvar)</div><div class="line">[<span class="number">1</span>] <span class="literal">TRUE</span></div><div class="line">&gt; identical(var(x), populationvar)</div><div class="line">[<span class="number">1</span>] <span class="literal">FALSE</span></div></pre></td></tr></table></figure>
<p>因此，为了在数学计算上是准确的，我们不使用<code>sd()</code>或<code>var()</code>函数，我们可以使用<code>rafalib</code>包中的<code>popvar()</code>与<code>popsd()</code>函数，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">library</span>(rafalib)</div><div class="line">sd_hf &lt;- popsd(hfPopulation)</div><div class="line">sd_control &lt;- popsd(controlPopulation)</div></pre></td></tr></table></figure>
<p>这里需要注意，在实际统计中，我们并不会计算总体参数，我们通常是由样本来估计总体参数，现在我们从总体中抽样，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">N &lt;- <span class="number">12</span></div><div class="line">hf &lt;- sample(hfPopulation, N)</div><div class="line">control &lt;- sample(controlPopulation,N)</div></pre></td></tr></table></figure>
<p>CLT告诉我们，对于更大的N来说，这些样本都近拉于正态分布。作为一种经验，这个N通常是大于30，这仅是一个经验法则，具体来说，它还需要取决于总体的分布。这里我们实际上可以查看一下近似值，并对各种N值进行计算，代码如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Ns &lt;- c(<span class="number">3</span>, <span class="number">12</span>, <span class="number">25</span>, <span class="number">50</span>)</div><div class="line">B &lt;- <span class="number">10000</span></div><div class="line">res &lt;- sapply(Ns, <span class="keyword">function</span>(n)&#123;</div><div class="line">  replicate(B, mean(sample(hfPopulation, n)) - mean(sample(controlPopulation, n)))</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<p>现在使用qq图看一下CLT理论对这些数据的近似值的适应情况。如果这些数据非常接近正态分布，那么这些数据点就会落在一个直线上（这个直接是正态分布的分位数(quantiles))。越偏离，说明数据越不符合正态分布，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">mypar(<span class="number">2</span>,<span class="number">2</span>)</div><div class="line"><span class="keyword">for</span> (i <span class="keyword">in</span> seq(along=Ns))&#123;</div><div class="line">  titleavg &lt;- signif(mean(res[,i]),<span class="number">3</span>)</div><div class="line">  titlesd &lt;- signif(popsd(res[,i]),<span class="number">3</span>)</div><div class="line">  title &lt;- paste0(<span class="string">"N="</span>, Ns[i], <span class="string">"Avg="</span>, titleavg, <span class="string">" SD="</span>, titlesd)</div><div class="line">  qqnorm(res[,i], main = title)</div><div class="line">  qqline(res[,i], col=<span class="number">2</span>)</div><div class="line">  </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190721204249.png" alt=""></p>
<p>从上面结果可以看出来，第3组数据的拟合结果最合适，这是因为它的总体相对最接近正态分布，平均值也最接近于正态分布。在实际中，我们可以计算这样一个比值：除以估计的标准误差来判断，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">Ns &lt;- c(<span class="number">3</span>, <span class="number">12</span>, <span class="number">25</span>, <span class="number">50</span>)</div><div class="line">B &lt;- <span class="number">10000</span></div><div class="line">computetstat &lt;- <span class="keyword">function</span>(n)&#123;</div><div class="line">  y &lt;- sample(hfPopulation, n)</div><div class="line">  x &lt;- sample(controlPopulation, n)</div><div class="line">  (mean(y)- mean(x))/sqrt(var(y)/n+var(x)/n)</div><div class="line">&#125;</div><div class="line">res &lt;- sapply(Ns, <span class="keyword">function</span>(n)&#123;</div><div class="line">  replicate(B, computetstat(n))</div><div class="line">&#125;)</div><div class="line"></div><div class="line">mypar(<span class="number">2</span>,<span class="number">2</span>)</div><div class="line"><span class="keyword">for</span> (i <span class="keyword">in</span> seq(along=Ns))&#123;</div><div class="line">  qqnorm(res[,i], main = Ns[i])</div><div class="line">  qqline(res[,i], col=<span class="number">2</span>)</div><div class="line">  </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190721205303.png" alt=""></p>
<p>从上面可以看出来，当$N=3$时，CLT并不会提供一个有用的估计，当$N=12$时，在较大值的点方面，稍微有点偏离。当$N=25$或$N=50$时，所有的点基本上都在直线上。</p>
<p>也就是说，在这个案例中，只要$N=12$就能证明CLT，就像前言提到的那样，在多数情况下，这种模拟并不会很好。我们在这里只是通过这种模拟手段来说明CLT背后的思想与局限。</p>
<h2 id="练习-1"><a href="#练习-1" class="headerlink" title="练习"></a>练习</h2><p>P52</p>
<h2 id="t检验的实际计算"><a href="#t检验的实际计算" class="headerlink" title="t检验的实际计算"></a>t检验的实际计算</h2><p>现在我们来看一下如何通过计算得到p值，先来导入数据，在这一步中，我们要确定哪些是treatment组，哪些是control组，并且计算出它们的均值差异，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">library</span>(dplyr)</div><div class="line">dir &lt;- system.file(package = <span class="string">"dagdata"</span>)</div><div class="line">filename &lt;- file.path(dir,<span class="string">"extdata/femaleMiceWeights.csv"</span>)</div><div class="line">dat &lt;- read.csv(filename)</div><div class="line">control &lt;- filter(dat,Diet==<span class="string">"chow"</span>) %&gt;% select(Bodyweight) %&gt;% unlist</div><div class="line">treatment &lt;- filter(dat,Diet==<span class="string">"hf"</span>) %&gt;% select(Bodyweight) %&gt;% unlist</div><div class="line">diff &lt;- mean(treatment) - mean(control)</div><div class="line">print(diff)</div></pre></td></tr></table></figure>
<p>计算结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; print(diff)</div><div class="line">[<span class="number">1</span>] <span class="number">3.020833</span></div></pre></td></tr></table></figure>
<p>现在我们开始计算p值，上面的代码中有一个<code>diff</code>变量，可以称为<code>observed effect size</code>，这是一个随机变量，我们还知道，在零假设的前提下，<code>diff</code>均值的分布是0，而这个随机变量分布的标准误则是总体的标准差(population standard deviation)除了样本数目的平方根，如下所示：</p>
<script type="math/tex; mode=display">
S E(\overline{X})=\sigma / \sqrt{N}</script><p>我们使用样本样本标准差(sample standard deviation)来对总体的标准差(population standard deviation)进行估计，在R中，也可以使用的<code>sd()</code>函数来计算标准误(SE)，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sd(control)/sqrt(length(control))</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; sd(control)/sqrt(length(control))</div><div class="line">[<span class="number">1</span>] <span class="number">0.8725323</span></div></pre></td></tr></table></figure>
<p>这个值就是样本均值(sample average)的SE，不过实际上，我们相想要的是<code>diff</code>的SE。我们前面已经知道了，统计学理论告诉我们，两个随机变量差的方差是原两个随机变量方差的和，因此我们计算一下方差以及平方根：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">se &lt;- sqrt(</div><div class="line">var(treatment)/length(treatment) +</div><div class="line">var(control)/length(control)</div><div class="line">)</div><div class="line">se</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; se</div><div class="line">[<span class="number">1</span>] <span class="number">1.469867</span></div></pre></td></tr></table></figure>
<p>统计学理论还告诉我们，如果我们将一个随机变量除以其SE，我们就会得到一个SE为1的新的随机变量，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">tstat &lt;- diff/se</div><div class="line">tstat</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&gt; tstat &lt;- diff/se</div><div class="line">&gt; tstat</div><div class="line">[<span class="number">1</span>] <span class="number">2.055174</span></div></pre></td></tr></table></figure>
<p>上面计算出来的<code>tstat</code>就是我们称的t统计量(t-statistic)。这是两个随机变量的比值，因此它也是一个随机变量。一旦我们知道了这个随机的分布，我们就很容易计算出其p值。</p>
<p>前面我们提到，CLT可以告诉我们，如果有大样本(large sample size)，那么样本的均值<code>mean(treatment)</code>和<code>mean(control)</code>都服从正态分布。统计学理论告诉我们，两个正态分布的随机变量的差值还服从正态分布，因此CLT也告诉我们，<code>tstat</code>接近于均值为0(零假设)，SD为1（我们除以它的SE）的正态分布。</p>
<p>现在我们要计算一下p值，此时我们需要问的一个问题就是：一个服从正态分布的随机变量有多大的概率会大于<code>diff</code>？R语言中的有一个<code>pnorm()</code>函数有解决这个问题。<code>pnorm(a)</code>会以返回一个值，这个值就是概率，它表示在一个标准正态分布中，一个随机变量低于<code>a</code> 的概率，具体这个函数的原理与用法，可以参考这篇笔记《R语言中dnorm, pnorm, qnorm与rnorm以及随机数》。</p>
<p>如果要计算大于<code>a</code>的概率，那么可以使用<code>1-pnorm(a)</code>，如果我们想知道看到一些像diff这种极端事件的概率：例如要么小于（更多的时候指的是负值）<code>-abs(diff)</code>，要么是大于<code>abs(diff)</code>，那么我们也可以过计算这两个尾部区域的概率：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">righttail &lt;- <span class="number">1</span>-pnorm(abs(tstat))</div><div class="line">lefttail &lt;- pnorm(-abs(tstat))</div><div class="line">pval &lt;- lefttail + righttail</div><div class="line">print(pval)</div></pre></td></tr></table></figure>
<p>计算结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; print(pval)</div><div class="line">[<span class="number">1</span>] <span class="number">0.0398622</span></div></pre></td></tr></table></figure>
<p>在这个案例中，p值小于0.05，根据传统的p值阈值0.05，我们就可以下给结论，这种差值有统计学意义。</p>
<p>现在我们就面临一个问题，CLT只有在大样本的前提下才有效，12个样本这个数目够么？根据经验法则，通常大于30个样本（这仅仅是经验法则），就能满足CLT。我们计算的这个p值，只有在假设成立的前提下才是有效的近似值，而实际情况并非如此，还好，除了CLT之外，我们还有另外一种选择。</p>
<h2 id="t分布的实际计算"><a href="#t分布的实际计算" class="headerlink" title="t分布的实际计算"></a>t分布的实际计算</h2><p>如果一个总体的分布是正态分布，那么我们在不需要CLT思想的前提下，就可以计算出t-statistic的精确分布。但是，如果我们只有小样本，我们就很难知道总体是否是正态的。但是，对于一些常见的统计量，例如体重，我们就可以猜测它的总体分布非常接近于正态分布，因此我们可以使用这种近似。此外，我们可以使用对样本画qq图，它会显示出样本的分布，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">library</span>(rafalib)</div><div class="line">mypar(<span class="number">1</span>,<span class="number">2</span>)</div><div class="line">qqnorm(treatment)</div><div class="line">qqline(treatment,col=<span class="number">2</span>)</div><div class="line">qqnorm(control)</div><div class="line">qqline(control,col=<span class="number">2</span>)</div></pre></td></tr></table></figure>
<p><img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190727104205.png" alt=""></p>
<p>如果我们使用这种近似计算，那么从统计学理论角度来讲我们随机变量<code>tstat</code>的分布就服从一个t分布(<code>-t-distribution</code>)，这种分布比正态分布更复杂。t分布没有像正态分布那样的位置参数( location parameter )，正态分布的参数是自由度(<code>degrees of freedom</code>)，R中的<code>t.test()</code>函数可以用于计算相应的p值，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">t.test(treatment, control)</div></pre></td></tr></table></figure>
<p>计算结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">&gt; t.test(treatment, control)</div><div class="line"></div><div class="line">	Welch Two Sample t-test</div><div class="line"></div><div class="line">data:  treatment and control</div><div class="line">t = <span class="number">2.0552</span>, df = <span class="number">20.236</span>, p-value = <span class="number">0.053</span></div><div class="line">alternative hypothesis: true difference <span class="keyword">in</span> means is not equal to <span class="number">0</span></div><div class="line"><span class="number">95</span> percent confidence interval:</div><div class="line"> -<span class="number">0.04296563</span>  <span class="number">6.08463229</span></div><div class="line">sample estimates:</div><div class="line">mean of x mean of y </div><div class="line"> <span class="number">26.83417</span>  <span class="number">23.81333</span></div></pre></td></tr></table></figure>
<p>如果只想看p值，那么使用以下代码即可，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">result &lt;- t.test(treatment,control)</div><div class="line">result$p.value</div></pre></td></tr></table></figure>
<p>结果如下：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&gt; result &lt;- t.test(treatment,control)</div><div class="line">&gt; result$p.value</div><div class="line">[<span class="number">1</span>] <span class="number">0.05299888</span></div></pre></td></tr></table></figure>
<p>从计算结果来看，这个p值有点大，这是因为在CLT近似的计算中，<code>tstat</code>的分布实际上是固定的（对于大样本来说，分母实际上就是固定的），而t分布的近似计算则是考虑到了分母（差值的标准误）是一个随机变量，是不固定的，样本数目越小，那分母的变化就越大。</p>
<p>这样来看的，我们使用了两种方法，得到了2个不同的p值，这在数据分析过程中很常见，因为我们是使用了不同的前提，不同的近似，因此会得到不同的结果。在后面讲到的功效计算(power calculation)中，我们会讲到I类错误，II类错误。在这里我们只说一下，使用CLT近似会错误地拒绝( incorrectly reject )零假设(假阳性)，而t分布则会错误地接受(inccorrectly acept)零假设(假阴性)。</p>
<p>在R中计算t检验如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">library</span>(dplyr)</div><div class="line">dir &lt;- system.file(package = <span class="string">"dagdata"</span>)</div><div class="line">filename &lt;- file.path(dir,<span class="string">"extdata/mice_pheno.csv"</span>)</div><div class="line">dat &lt;- read.csv(filename)</div><div class="line">control &lt;- filter(dat,Diet==<span class="string">"chow"</span>) %&gt;% select(Bodyweight)</div><div class="line">treatment &lt;- filter(dat,Diet==<span class="string">"hf"</span>) %&gt;% select(Bodyweight)</div><div class="line">t.test(treatment,control)</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">&gt; t.test(treatment,control)</div><div class="line"></div><div class="line">	Welch Two Sample t-test</div><div class="line"></div><div class="line">data:  treatment and control</div><div class="line">t = <span class="number">7.1932</span>, df = <span class="number">735.02</span>, p-value = <span class="number">1.563e-12</span></div><div class="line">alternative hypothesis: true difference <span class="keyword">in</span> means is not equal to <span class="number">0</span></div><div class="line"><span class="number">95</span> percent confidence interval:</div><div class="line"> <span class="number">2.231533</span> <span class="number">3.906857</span></div><div class="line">sample estimates:</div><div class="line">mean of x mean of y </div><div class="line"> <span class="number">30.48201</span>  <span class="number">27.41281</span></div></pre></td></tr></table></figure>
<h2 id="置信区间-Confidence-Intervals"><a href="#置信区间-Confidence-Intervals" class="headerlink" title="置信区间(Confidence Intervals)"></a>置信区间(Confidence Intervals)</h2><p>在生命科学研究中，仅在研究结论中报道p值是不够的，因为统计学上的显著性无法保证科学研究上的意义。例如在对体重的差异进行统计时，使用大样本的情况下，即使是1毫克的差异，也有可能有统计学意义，不过这种1毫克的差异是一个重要的发现么？我们能否说明，某个因素导致了不到1%的体重变化？仅报道p值是无法提供一些有价值的信息的，也不会提供有关效应量(the effect size)的信息，效应量(effect size)就是我们前面提到的观察到的差异(observed difference)。有的时候，效应量会用除以对照组的均值，因此会表示为百分比。</p>
<p>为了纠正仅报道p值偏差，另外一个统计量就提了出来，即置信区间(confidence intervals)。置信区间包括了估计的效应量(estimated effect size)，以及与这个估计有关的不确定性(uncertainty)，现在我们使用这批小鼠数据来计算一下置信区间。</p>
<h3 id="总体均值的置信区间"><a href="#总体均值的置信区间" class="headerlink" title="总体均值的置信区间"></a>总体均值的置信区间</h3><p>在我们展示如何过计算两组差值的置信区间之前，我们先来看一下如何计算对照组雌性小鼠的总体均值的置信区间。随后，我们会计算样本的置留区间，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">dir &lt;- system.file(package = <span class="string">"dagdata"</span>)</div><div class="line">filename &lt;- file.path(dir,<span class="string">"extdata/mice_pheno.csv"</span>)</div><div class="line">dat &lt;- read.csv(filename)</div><div class="line">chowPopulation &lt;- dat[dat$Sex==<span class="string">"F"</span> &amp; dat$Diet==<span class="string">"chow"</span>,<span class="number">3</span>]</div><div class="line">mu_chow &lt;- mean(chowPopulation)</div><div class="line">print(mu_chow)</div></pre></td></tr></table></figure>
<p>计算结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; print(mu_chow)</div><div class="line">[<span class="number">1</span>] <span class="number">23.89338</span></div></pre></td></tr></table></figure>
<p>现在计算的结果就是 总体均值$\mu_{X}$。</p>
<p>现在我们对这个结果进行估计，在实际分析过程中，我们并不会获取所有的总体，因此我们也像前面计算p值那样，我们来演示一下，通过抽样的方法来计算置信区间，现在我们先抽30个样本，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">N &lt;- <span class="number">30</span></div><div class="line">chow &lt;- sample(chowPopulation, N)</div><div class="line">print(mean(chow))</div></pre></td></tr></table></figure>
<p>计算结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; print(mean(chow))</div><div class="line">[<span class="number">1</span>] <span class="number">23.95033</span></div></pre></td></tr></table></figure>
<p>我们知道这个均值是一个随机变量，因此样本均值并不是一个非常好的估计。实际上，我们使用这个案例只是为了计算这个样本的均值，每次计算并非完全一样，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">&gt; N &lt;- <span class="number">30</span></div><div class="line">&gt; chow &lt;- sample(chowPopulation, N)</div><div class="line">&gt; print(mean(chow))</div><div class="line">[<span class="number">1</span>] <span class="number">23.48467</span></div><div class="line">&gt; </div><div class="line">&gt; N &lt;- <span class="number">30</span></div><div class="line">&gt; chow &lt;- sample(chowPopulation, N)</div><div class="line">&gt; print(mean(chow))</div><div class="line">[<span class="number">1</span>] <span class="number">25.22967</span></div><div class="line">&gt; </div><div class="line">&gt; N &lt;- <span class="number">30</span></div><div class="line">&gt; chow &lt;- sample(chowPopulation, N)</div><div class="line">&gt; print(mean(chow))</div><div class="line">[<span class="number">1</span>] <span class="number">23.732</span></div></pre></td></tr></table></figure>
<p>如上所示，每次抽样计算的均值都不一样。现在我们来了解一下置信区间，置信区间一种报道你数据中样本均值的一种统计学表示方法，它能明确地显示出随机变量的变异程度。</p>
<p>现在我们的的样本是30，CLT告诉我们，$\bar{X}$或chow组的均值(mean)服从一个均值为$\mu_{X}$（这个是chowPopulaiton这个总体的均值，即<code>mean(chowPopulation)</code>，这个均值服从均值为$\mu_{X}$，标准误$s_{X} / \sqrt{N}$的标准分布，计算过程如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">se &lt;- sd(chow)/sqrt(N)</div><div class="line">print(se)</div></pre></td></tr></table></figure>
<p>计算结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&gt; se &lt;- sd(chow)/sqrt(N)</div><div class="line">&gt; print(se)</div><div class="line">[<span class="number">1</span>] <span class="number">0.597656</span></div></pre></td></tr></table></figure>
<h3 id="定义区间"><a href="#定义区间" class="headerlink" title="定义区间"></a>定义区间</h3><p>95%置信区间是一个随机区间，这个区间有95%概率落在我们估计值的参数中。这里需要注意的是，说95%的随机区间将会包括真值，并不等于说真值有95%的概率落在我们的区间中。为了构建置信区间，我们需要注意，CLT告诉我们，$\sqrt{N}\left(\overline{X}-\mu_{X}\right) / s_{X}$服从均值为0，SD为1的正态分布，这个概率也就是以下事件的概率：</p>
<script type="math/tex; mode=display">
-2 \leq \sqrt{N}\left(\overline{X}-\mu_{X}\right) / s_{X} \leq 2</script><p>在R中的计算为：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pnorm(<span class="number">2</span>) - pnorm(-<span class="number">2</span>)</div></pre></td></tr></table></figure>
<p>计算结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; pnorm(<span class="number">2</span>) - pnorm(-<span class="number">2</span>)</div><div class="line">[<span class="number">1</span>] <span class="number">0.9544997</span></div></pre></td></tr></table></figure>
<p>这个值与95%很接近，也就是<code>qnorm(1-0.05/2)</code>的这个值，现在我们把上面的公式变换一下，把$\mu_{X}$放中间，就成了如下的样子：</p>
<script type="math/tex; mode=display">
\overline{X}-2 s_{X} / \sqrt{N} \leq \mu_{X} \leq \overline{X}+2 s_{X} / \sqrt{N}</script><p>也就是上面这个值的概率是95%。需要注意的是，区间$\overline{X} \pm 2 s_{X} / \sqrt{N}$是两个边界，它们是随机的。此外，我们需要明确一下，置信区间的定义是，95%的随机区间（random intervals)包含真正的固定值$\mu_{X}$。对于一个计算结果来说，计算出来的这个特定的区间，它要么包括固定的总体均值$\mu$，要么不包括。</p>
<p>现在我们来模拟一下其中的思路，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">N &lt;- <span class="number">30</span></div><div class="line">chow &lt;- sample(chowPopulation, N)</div><div class="line">se &lt;- sd(chow)/sqrt(N)</div><div class="line">Q &lt;- qnorm(<span class="number">1</span> - <span class="number">0.05</span>/<span class="number">2</span>)</div><div class="line">interval &lt;- c(mean(chow)-Q*se, mean(chow) + Q*se)</div><div class="line">interval</div><div class="line">interval[<span class="number">1</span>] &lt; mu_chow &amp; interval[<span class="number">2</span>] &gt; mu_chow</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&gt; interval</div><div class="line">[<span class="number">1</span>] <span class="number">22.17089</span> <span class="number">24.58044</span></div><div class="line">&gt; interval[<span class="number">1</span>] &lt; mu_chow &amp; interval[<span class="number">2</span>] &gt; mu_chow</div><div class="line">[<span class="number">1</span>] <span class="literal">TRUE</span></div></pre></td></tr></table></figure>
<p>从上面我们可以看到，这个区间覆盖了总体均值$\mu_{X}$或<code>mean(chowPopulation)</code>。但是，如果我们再取另外一批样本的话，有可能不会覆盖总体均值$\mu_{X}$，但是，统计学理论告诉我们，经过均数次抽样后，这个样本覆盖均值的概率是95%。由于我们能够获取总体数据，现在我们来看一些样本：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">library</span>(rafalib)</div><div class="line">B &lt;- <span class="number">250</span></div><div class="line">mypar()</div><div class="line">plot(mean(chowPopulation)+c(-<span class="number">7</span>, <span class="number">7</span>), c(<span class="number">1</span>,<span class="number">1</span>), type=<span class="string">"n"</span>,</div><div class="line">     xlab=<span class="string">"weight"</span>, ylab = <span class="string">"interval"</span>, ylim=c(<span class="number">1</span>,B))</div><div class="line">abline(v=mean(chowPopulation))</div><div class="line"><span class="keyword">for</span> (i <span class="keyword">in</span> <span class="number">1</span>:B)&#123;</div><div class="line">  chow &lt;- sample(chowPopulation, N)</div><div class="line">  sd &lt;- sd(chow)/sqrt(N)</div><div class="line">  interval &lt;- c(mean(chow)-Q*se, mean(chow)+Q*se)</div><div class="line">  covered &lt;- </div><div class="line">    mean(chowPopulation) &lt;= interval[<span class="number">2</span>] &amp; mean(chowPopulation) &gt;= interval[<span class="number">1</span>]</div><div class="line">  color &lt;- ifelse(covered, <span class="number">1</span>,<span class="number">2</span>)</div><div class="line">  lines(interval, c(i, i), col= color)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190727142655.png" alt=""></p>
<p>在这个案例中，我们模拟了250次随机抽样，计算了250次置信区间，其中颜色表示这个区间是否包含总体均值，其中绿色是包括的，棕色是不包括的。</p>
<p>上面这个案例的置信区间比较大（这个案例除以的是是$\sqrt{5}$，而非$\sqrt{30}$），我们可以看到很多区间并未覆盖$\mu_{X}$，这是因为CLT错误地告诉了我们(chow)的均值是近似地接近于正态分布，实际上这个数据是不太符合正态分布的（在接近$\pm \infty$的地方，它有一个比较扁平的尾巴）。这种错误会影响我们计算<code>Q</code>值，而这个<code>Q</code>值在计算的时，是以正态分布为前提,，使用<code>qnorm()</code>来计算的。在这种情况下，数据会更符合t分布，现在我们使用<code>qt()</code>函数来计算<code>Q</code>值，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">mypar()</div><div class="line">plot(mean(chowPopulation)+ c(-<span class="number">7</span>,<span class="number">7</span>), c(<span class="number">1</span>,<span class="number">1</span>),type=<span class="string">"n"</span>,</div><div class="line">     xlab=<span class="string">"weight"</span>,ylab=<span class="string">"interval"</span>,ylim=c(<span class="number">1</span>,B))</div><div class="line">abline(v=mean(chowPopulation))</div><div class="line">Q &lt;- qt(<span class="number">1</span>-<span class="number">0.05</span>/<span class="number">2</span>, df=<span class="number">4</span>)</div><div class="line">N &lt;- <span class="number">5</span></div><div class="line"><span class="keyword">for</span> (i <span class="keyword">in</span> <span class="number">1</span>:B)&#123;</div><div class="line">  chow &lt;- sample(chowPopulation, N)</div><div class="line">  se &lt;- sd(chow)/sqrt(N)</div><div class="line">  interval &lt;- c(mean(chow)-Q*se, mean(chow)+Q*se)</div><div class="line">  covered &lt;- mean(chowPopulation) &lt;= interval[<span class="number">2</span>] &amp; mean(chowPopulation) &gt;= interval[<span class="number">1</span>]</div><div class="line">  color &lt;- ifelse(covered, <span class="number">1</span>,<span class="number">2</span>)</div><div class="line">  lines(interval, c(i,i), col=color)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190728085017.png" alt=""></p>
<p>上面这个图中，我们使用了小样本来模拟了250次计算，得到了它的95%置信区间，这个置信区间是基于t分布进行计算的。与前面的那个案例相比，这个案例中置信区间更大，这是因为t分布的尾部更为扁平，得到的置信区间就更大，现在我们来计算一下t分布的累积分分布，并拿它与正态分布比较一下，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">qt(<span class="number">1</span>-<span class="number">0.05</span>/<span class="number">2</span>, df=<span class="number">4</span>)</div><div class="line">qnorm(<span class="number">1</span>-<span class="number">0.05</span>/<span class="number">2</span>)</div></pre></td></tr></table></figure>
<p>计算结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&gt; qt(<span class="number">1</span>-<span class="number">0.05</span>/<span class="number">2</span>, df=<span class="number">4</span>)</div><div class="line">[<span class="number">1</span>] <span class="number">2.776445</span></div><div class="line">&gt; qnorm(<span class="number">1</span>-<span class="number">0.05</span>/<span class="number">2</span>)</div><div class="line">[<span class="number">1</span>] <span class="number">1.959964</span></div></pre></td></tr></table></figure>
<p>从上面结果就可以看出来，t分布的置信区间更大，因此它才能以更大的概率(例如95%)来覆盖$\mu_{X}$。</p>
<h3 id="置信区间与p值的关系"><a href="#置信区间与p值的关系" class="headerlink" title="置信区间与p值的关系"></a>置信区间与p值的关系</h3><p>作者推荐报道实验结果时使用置信区间，而非仅用p值，对于某些原因，我们可能只需要提供p值即可，或者是提供0.05或0.01水平上的统计结果，其实置信区间也能提供这些信息。</p>
<p>当我们谈论t检验(t-test)的p值时，我们实际上是在谈论我们观察到的这两个样本的差值($\overline{Y}-\overline{X}$)以及更极端情况下差值的概率，就像是谈论两个总体之间的总体均值之差等于0这种极端情况下的概率。因此我们可以构建一个含有这个观察到的差值的置信区间，不过我们不再写为$\overline{Y}-\overline{X}$这种形成，而是写为一种新的形式，即$d \equiv \overline{Y}-\overline{X}$。</p>
<p>当我们来写一个差值的95%置信区间时，使用CLT则会写为$d \pm 2 s_{d} / \sqrt{N}$这种形式，这个结果并不包含0（假阳性）。因为置信区间不含0，这就暗示了，$d-2 s_{d} / \sqrt{N}&gt;0$或$d+2 s_{d} / \sqrt{N}<0$，这种表达形式还说明，$\sqrt{n} d="" s_{d}="">2$或$\sqrt{N} d / s_{d}&lt;2$。这说明，t统计量比2更极端，反过来又说明，p值必然小于0.05（为了更加精确地计算，可以使用<code>qnorm(0.05/2)</code>来替换2）。如果使用t分布来取代CLT，则使用使用<code>qt(0.05/2, df=N-2</code>。总之，一个95%或99%置信区间并不包含0，p它们的p值必然小于0.05或小于0.01。</0$，这种表达形式还说明，$\sqrt{n}></p>
<p>现在我们使用t检验来计算一下<code>d</code>的置信区间，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">t.test(treatment,control,conf.level=<span class="number">0.95</span>)$conf.int</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&gt; t.test(treatment,control,conf.level=<span class="number">0.95</span>)$conf.int</div><div class="line">[<span class="number">1</span>] <span class="number">2.231533</span> <span class="number">3.906857</span></div><div class="line">attr(,<span class="string">"conf.level"</span>)</div><div class="line">[<span class="number">1</span>] <span class="number">0.95</span></div></pre></td></tr></table></figure>
<p>如果我们把置信水平改为0.9，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&gt; t.test(treatment,control,conf.level=<span class="number">0.90</span>)$conf.int</div><div class="line">[<span class="number">1</span>] <span class="number">2.366479</span> <span class="number">3.771911</span></div><div class="line">attr(,<span class="string">"conf.level"</span>)</div><div class="line">[<span class="number">1</span>] <span class="number">0.9</span></div></pre></td></tr></table></figure>
<p>可以发现，置信区间变小了。</p>
<h2 id="功效计算"><a href="#功效计算" class="headerlink" title="功效计算"></a>功效计算</h2><p>在前面的案例中，我们研究了不同包含对小鼠体重的影响，由于我们在使用这个案例的时候，我们研究的是总体，发现了这两种包含对小鼠的体重有着明显的影响，计算结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">library</span>(dplyr)</div><div class="line">dir &lt;- system.file(package = <span class="string">"dagdata"</span>)</div><div class="line">filename &lt;- file.path(dir,<span class="string">"extdata/mice_pheno.csv"</span>)</div><div class="line">dat &lt;- read.csv(filename)</div><div class="line">controlPopulation &lt;- filter(dat, Sex == <span class="string">"F"</span> &amp; Diet == <span class="string">"chow"</span>) %&gt;% dplyr::select(Bodyweight) %&gt;% unlist</div><div class="line">hfPopulation &lt;- filter(dat, Sex == <span class="string">"F"</span> &amp; Diet == <span class="string">"hf"</span>) %&gt;% dplyr::select(Bodyweight) %&gt;% unlist</div><div class="line"></div><div class="line">mu_hf &lt;- mean(hfPopulation)</div><div class="line">mu_control &lt;- mean(controlPopulation)</div><div class="line">print(mu_hf - mu_control)</div><div class="line">print((mu_hf - mu_control)/mu_control*<span class="number">100</span>)</div></pre></td></tr></table></figure>
<p>计算结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&gt; print(mu_hf - mu_control)</div><div class="line">[<span class="number">1</span>] <span class="number">2.375517</span></div><div class="line">&gt; print((mu_hf - mu_control)/mu_control*<span class="number">100</span>)</div><div class="line">[<span class="number">1</span>] <span class="number">9.942157</span></div></pre></td></tr></table></figure>
<p>某些情况下，我们会采用抽样的形式，抽取一定数目的小鼠体重作为样本，此时就不能使用总体的计算方法，而是采用t检验，此时计算得到的p值不一定小于0.05，例如，我们随机抽取5只小鼠来计算一下，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">set.seed(<span class="number">1</span>)</div><div class="line">N &lt;- <span class="number">5</span></div><div class="line">hf &lt;- sample(hfPopulation, N)</div><div class="line">control &lt;- sample(controlPopulation, N)</div><div class="line">t.test(hf,control)$p.value</div></pre></td></tr></table></figure>
<p>计算结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; t.test(hf,control)$p.value</div><div class="line">[<span class="number">1</span>] <span class="number">0.1410204</span></div></pre></td></tr></table></figure>
<p>前后两种的计算方法出现了差异，第一次计算（使用小鼠的总体来进行计算）与第二次计算（随机抽两组的5只小鼠来计算）的p值不一样，是否出现了错误？</p>
<p>在第二次计算中，p值大于0.05，因此我们不拒绝零假设，从而说饮食对小鼠的体重没有影响么？</p>
<p>能否这么讲？答案不是能。</p>
<p>我们只能说，无法拒绝零假设（注意，没有后面那半句：包含对小鼠的体重没有影响）。我们无法拒绝零假设，并不意味着零假设一定为真。在这个特殊的案例中，这里我们面临的一个问题就是，我们没有足够的功效(power)。如果你从事科学研究，很有可能在某些时候不得不做一个功效计算。在很多情况下，这是一种首选义务，因此它可以帮助你在人的研究中，避免使用过多的小鼠，或者是避免使用过多的受试患者。现在我们就来解释一下统计功效(statistical power)的含义。</p>
<h3 id="错误类型"><a href="#错误类型" class="headerlink" title="错误类型"></a>错误类型</h3><p>我们要有这么一个思路，一旦我们做统计，就有可能出现计算错误，这也就是为什么p值不等于0。在进行统计时，当p值很小时，这说明我们可以拒绝零假设，但是这种拒绝也有可能犯错误（虽然犯错误的概率很低），例如零假设确实是真时。例如当p值等于0.05时，那么我们重复20实验，就有可能1次会发生零假设成功的事件，统计学家把这种错误称为I类错误(<code>type I error</code>)。</p>
<p>I类错误的定义就是，零假设成立时，我们拒绝了（其实不应该拒绝的），也就是所谓假阳性。这里为什么使用0.05，而不使用0.00001呢？这是因为如果阈值设得过低，成本会非常高。此时我们还要引入II类错误(<code>type I error</code>)，II类错误是指，零假设不成立，但是我们接受了零假设，也就是所谓的假阴性。前面我们抽样了5只小鼠，计算得到的值大于0.05，因此我们无法拒绝零假设（在0.05这个水平上），此时所犯的错误就是II类错误，也就是假阴性（从总体上看，实际上是有差异的，但是我们没有发现）。如果我们把阈值提高到0.25，我们就不会犯这个错误了（计算出的p值为0.1410204），不过通常情况下，不会这么干。</p>
<h3 id="0-05与0-01阈值-cut-off"><a href="#0-05与0-01阈值-cut-off" class="headerlink" title="0.05与0.01阈值(cut-off)"></a>0.05与0.01阈值(cut-off)</h3><p>多数的期刊或监管机构都坚持0.01或0.05的显著性水平，当然这么做无可厚非。我们本书的目标就之一就是让读者对p值以及置信区间有一个更深入的理解，以便读者能够在一些情况下做出合理的选择。不幸的是，这些阈值在某些程度上已经滥用，不过这是又是一个容易引起争论的话量，此处不表。</p>
<h3 id="功效计算-1"><a href="#功效计算-1" class="headerlink" title="功效计算"></a>功效计算</h3><p>功效(power)是指：当零假设为假时，拒绝它的概率，原书的描述如下所示：</p>
<blockquote>
<p>Power is the probability of rejecting the null when the null is false.</p>
</blockquote>
<p>不过“零假设为假”这种情况比较复杂，因为在许多情况下，零假设都有可能为假。$\Delta \equiv \overline{Y}-\overline{X}$可以是任意的，功效实际上要依赖于这个参数，功效同时还依赖于你估计值的标准误，反过来，标准误又依赖于样本数目，以及总体标准差。实际情况中，我们并不知道一些$\Delta$，$\sigma_{X}$，$\sigma_{Y}$值以及样本数目这些值。但是通过统计学理论，我们可以计算功效，R中的<code>pwr</code>包可以进行这样的计算，现在我们来模拟一下这个过程：</p>
<p>第一步：确定样本数目，我们确定为12，即<code>N &lt;- 12</code>；</p>
<p>第二步：设定拒绝零假设的阈值，这里为0.05，也就是常见的p值水平，即<code>alpha &lt;- 0.05</code>；</p>
<p>第三步：设计重复抽样次数，我们会重复地进行抽样，来计算一下拒绝零假设的比例，这里设为2000，即<code>B &lt;- 2000</code>；</p>
<p>这个模拟过程就是：我们会从对照组和处理组中抽取<code>N</code>个样本，使用t检验来计算p值，观察p值是否小于0.05，现在我们把这个过程写为一个函数，代码如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">N &lt;- <span class="number">12</span></div><div class="line">alpha &lt;- <span class="number">0.05</span></div><div class="line">B &lt;- <span class="number">2000</span></div><div class="line"></div><div class="line">reject &lt;- <span class="keyword">function</span>(N, alpha=<span class="number">0.05</span>)&#123;</div><div class="line">  hf &lt;- sample(hfPopulation, N)</div><div class="line">  control &lt;- sample(controlPopulation, N)</div><div class="line">  pval &lt;- t.test(hf, control)$p.value</div><div class="line">  pval &lt; alpha</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>如果样本数目为12，那么我们是否能拒绝零假设呢，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; reject(<span class="number">12</span>)</div><div class="line">[<span class="number">1</span>] <span class="literal">FALSE</span></div></pre></td></tr></table></figure>
<p>答案是不能。现在我们使用<code>replicate()</code>函数来重复2000次，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">N &lt;- <span class="number">12</span></div><div class="line">rejections &lt;- replicate(B, reject(N))</div><div class="line">mean(rejections)</div></pre></td></tr></table></figure>
<p>计算结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; mean(rejections)</div><div class="line">[<span class="number">1</span>] <span class="number">0.218</span></div></pre></td></tr></table></figure>
<p>其中<code>rejecctions</code>的结果是一个逻辑值，即里面只有<code>TRUE</code>或<code>FALSE</code>，其中<code>TRUE</code>为1，<code>FALSE</code>是0，那么我们计算的均值，即<code>mean(rejections)</code>就是<code>TRUE</code>所占的比例，因此我们计算出来的功效为0.218。这就是为什么，当我们知道零假设为假时，t检验也无法拒绝的原因。当样本数目为12时，功效是21.8%，对为能够在0.05水平上降低假阳性，那么我们可以设置更高的阈值，但这会导致II类错误的增多。</p>
<p>现在我们来看一下，功效是如何随着N的变化而变化的，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">Ns &lt;- seq(<span class="number">5</span>,<span class="number">50</span>, <span class="number">5</span>)</div><div class="line">power &lt;- sapply(Ns, <span class="keyword">function</span>(N)&#123;</div><div class="line">  rejections &lt;- replicate(B, reject(N))</div><div class="line">  mean(rejections)</div><div class="line">&#125;)</div><div class="line">power</div></pre></td></tr></table></figure>
<p>计算结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; power</div><div class="line"> [<span class="number">1</span>] <span class="number">0.0960</span> <span class="number">0.1640</span> <span class="number">0.2775</span> <span class="number">0.3775</span> <span class="number">0.4795</span> <span class="number">0.5540</span> <span class="number">0.6415</span> <span class="number">0.7075</span> <span class="number">0.7725</span> <span class="number">0.8160</span></div></pre></td></tr></table></figure>
<p>从上面的结果我们可以发现，随着N的增加，功效也在增加，曲线如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">plot(Ns, power, type = <span class="string">"b"</span>)</div></pre></td></tr></table></figure>
<p><img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190728122626.jpeg" alt=""></p>
<p>再来看一个案例。我们把<code>alpha</code>这个拒绝阈值改变一下，再来看一下功效的变化。如果想要降低I类错误，那么功效就会越小，也就说，我们需要在两类错误之间进行权衡，现在我们看下面的代码，在保证N值相同的前提下，改变<code>alpha</code>后功效的大小：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">N &lt;- <span class="number">30</span></div><div class="line">alphas &lt;- c(<span class="number">0.1</span>, <span class="number">0.05</span>, <span class="number">0.01</span>, <span class="number">0.001</span>, <span class="number">0.001</span>)</div><div class="line">power &lt;- sapply(alphas, <span class="keyword">function</span>(alpha)&#123;</div><div class="line">  rejections &lt;- replicate(B, reject(N, alpha=alpha))</div><div class="line">  mean(rejections)</div><div class="line">&#125;)</div><div class="line">plot(alphas, power, xlab=<span class="string">"alpha"</span>, type=<span class="string">"b"</span>, log=<span class="string">"x"</span>)</div></pre></td></tr></table></figure>
<p>变化曲线如下所示：</p>
<p><img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190728123209.jpeg" alt=""></p>
<p>在实际统计中，没有绝对的功效，也没有绝对的alpha值，但是我们要理解这背后的统计学硬。</p>
<h3 id="替代假设下的p值"><a href="#替代假设下的p值" class="headerlink" title="替代假设下的p值"></a>替代假设下的p值</h3><p>当零假设为假，替代假设为真时，那么p值有的时候就比较任意了。当替代假设为真时，我们通过增加样本数目，可以得到一个尽可能小的p值，通过从总体中不断抽取更大的样本数，我们就会知道p值的这种特性，现在看一下这个过程。</p>
<p>第一步：构建一个函数，这个函数能够返回一个样本数目为N时的p值，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">calculatePvalue &lt;- <span class="keyword">function</span>(N)&#123;</div><div class="line">  hf &lt;- sample(hfPopulation,N)</div><div class="line">  control &lt;- sample(controlPopulation, N)</div><div class="line">  t.test(hf, control)$p.value</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>第二步：设定样本数目，对于每个样本数目的计算，我们会得到一系列p值，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Ns &lt;- seq(<span class="number">10</span>, <span class="number">200</span>, by=<span class="number">10</span>)</div><div class="line">Ns_rep &lt;- rep(Ns, each=<span class="number">10</span>)</div></pre></td></tr></table></figure>
<p>第三步：计算p值，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pvalues &lt;- sapply(Ns_rep, calculatePvalue)</div></pre></td></tr></table></figure>
<p>第四步：绘制样本数目与其对应的p值，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">plot(Ns_rep, pvalues, log=<span class="string">"y"</span>, xlab=<span class="string">"Sample size"</span>,</div><div class="line">     ylab=<span class="string">"p-value"</span>)</div><div class="line">abline(h=c(<span class="number">0.01</span>, <span class="number">0.05</span>), col=<span class="string">"red"</span>, lwd=<span class="number">2</span>)</div></pre></td></tr></table></figure>
<p><img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190728125345.jpeg" alt=""></p>
<p>上图是随着样本数目的变化，p值的变化。从上面结果可以看出，当替代假设成立时，随着样本数目的增多，p值会越来越小，从上面的两条红线分别是0.01与0.05的区间。</p>
<p>一旦我们在某个阈值上拒绝了零假设，我们如果想要获得一个更小的p值，那么就需要更多的样本，例如实验小鼠。样本增大会增加我们对差值$\Delta$估计的精确性，但是，这个p值的降低仅仅是数学计算的自然结果。因为在计算p值时，它公式中的分母是样本数目的平方根，即$\sqrt{N}$，即如果$\Delta$不等于0，随着N的增加，p值必然降低。</p>
<p>因此，一个好的统计学结果需要列出效应量(effect size)与置信区间。效应量的计算是：将差值(difference)和置信区间(confidence interval)除以对照总体的均值，获得一个百分数，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">N &lt;- <span class="number">12</span></div><div class="line">hf &lt;- sample(hfPopulation, N)</div><div class="line">control &lt;- sample(controlPopulation, N)</div><div class="line">diff &lt;- mean(hf) - mean(control)</div><div class="line">diff/mean(control)*<span class="number">100</span></div><div class="line">t.test(hf, control)$conf.int / mean(control) * <span class="number">100</span></div></pre></td></tr></table></figure>
<p>计算结果为：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&gt; diff/mean(control)*<span class="number">100</span></div><div class="line">[<span class="number">1</span>] <span class="number">5.783149</span></div><div class="line">&gt; t.test(hf, control)$conf.int / mean(control) * <span class="number">100</span></div><div class="line">[<span class="number">1</span>] -<span class="number">8.169363</span> <span class="number">19.735661</span></div><div class="line">attr(,<span class="string">"conf.level"</span>)</div><div class="line">[<span class="number">1</span>] <span class="number">0.95</span></div></pre></td></tr></table></figure>
<p>此外，我们还可以写出一个名为<code>Cohen&#39;s d</code>的统计量，它是两组之间的差值除以这两组总和的标准差，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">sd_pool &lt;- sqrt(((N-<span class="number">1</span>)*var(hf) + (N-<span class="number">1</span>)*var(control))/(<span class="number">2</span>*N - <span class="number">2</span>))</div><div class="line">diff / sd_pool</div></pre></td></tr></table></figure>
<p>计算结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&gt; sd_pool &lt;- sqrt(((N-<span class="number">1</span>)*var(hf) + (N-<span class="number">1</span>)*var(control))/(<span class="number">2</span>*N - <span class="number">2</span>))</div><div class="line">&gt; diff / sd_pool</div><div class="line">[<span class="number">1</span>] <span class="number">0.3510624</span></div></pre></td></tr></table></figure>
<p>这个结果告诉我们，hf组的小鼠体重的均值与对照组(control)小鼠体重平均值偏离多少个标准差。在替代假设下，t统计量会随着样本数目的增加而增加，但是效应量(effect size)与<code>Cohen&#39;s d</code>却会变得更加精确。</p>
<h3 id="练习-2"><a href="#练习-2" class="headerlink" title="练习"></a>练习</h3><p>P76</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2019/08/03/DAL/DALS003_Inference02_Population_Estimates/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/08/03/DAL/DALS003_Inference02_Population_Estimates/" itemprop="url">DALS003-统计推断(Inference)02-总体与样本估计</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-08-03T12:00:00+08:00">
                2019-08-03
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/生物统计/" itemprop="url" rel="index">
                    <span itemprop="name">生物统计</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  912
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  4
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>这篇笔记是《Data Analysis for the Life Sciences》的第2章：统计推断(Inference)的第2部分。这一部分的主要内容涉及一些统计学的术语，即总体，样本和估计。</p>
<h2 id="总体-population-、样本-Sample-和估计-Estimates"><a href="#总体-population-、样本-Sample-和估计-Estimates" class="headerlink" title="总体(population)、样本(Sample)和估计(Estimates)"></a>总体(population)、样本(Sample)和估计(Estimates)</h2><h3 id="总体参数-population-parameters"><a href="#总体参数-population-parameters" class="headerlink" title="总体参数(population parameters)"></a>总体参数(population parameters)</h3><p>在小鼠体重的案例中，我们有两种总体，对照组雌性小鼠，高脂组雌性小鼠，其中体重是我们感兴趣的指标。现在我们假设种群的数目是固定的，而其中的随机误差就来源于抽样。我们使用下面的这个数据集来作为案例，这是因为我们正好有这种类型小鼠的数据，现在导入数据，跟前面的流程一下，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">library</span>(downloader)</div><div class="line">url &lt;- <span class="string">"https://raw.githubusercontent.com/genomicsclass/dagdata/master/inst/extd\</span></div><div class="line"><span class="string">ata/mice_pheno.csv"</span></div><div class="line">filename &lt;- <span class="string">"mice_pheno.csv"</span></div><div class="line">download(url,destfile=filename)</div><div class="line">dat &lt;- read.csv(filename)</div><div class="line">head(dat)</div></pre></td></tr></table></figure>
<p>计算结果如下：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">&gt; head(dat)</div><div class="line">  Sex Diet Bodyweight</div><div class="line"><span class="number">1</span>   <span class="literal">F</span>   hf      <span class="number">31.94</span></div><div class="line"><span class="number">2</span>   <span class="literal">F</span>   hf      <span class="number">32.48</span></div><div class="line"><span class="number">3</span>   <span class="literal">F</span>   hf      <span class="number">22.82</span></div><div class="line"><span class="number">4</span>   <span class="literal">F</span>   hf      <span class="number">19.92</span></div><div class="line"><span class="number">5</span>   <span class="literal">F</span>   hf      <span class="number">32.22</span></div><div class="line"><span class="number">6</span>   <span class="literal">F</span>   hf      <span class="number">27.50</span></div></pre></td></tr></table></figure>
<p>现在挑一个对照组的种群，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">library</span>(dplyr)</div><div class="line">controlPopulation &lt;- filter(dat,Sex == <span class="string">"F"</span> &amp; Diet == <span class="string">"chow"</span>) %&gt;% dplyr::select(Bodyweight) %&gt;% unlist</div><div class="line">head(controlPopulation)</div><div class="line">length(controlPopulation)</div></pre></td></tr></table></figure>
<p>如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&gt; head(controlPopulation)</div><div class="line">Bodyweight1 Bodyweight2 Bodyweight3 Bodyweight4 Bodyweight5 Bodyweight6 </div><div class="line">      <span class="number">27.03</span>       <span class="number">24.80</span>       <span class="number">27.02</span>       <span class="number">28.07</span>       <span class="number">23.55</span>       <span class="number">22.72</span> </div><div class="line">&gt; length(controlPopulation)</div><div class="line">[<span class="number">1</span>] <span class="number">225</span></div></pre></td></tr></table></figure>
<p>我们通常使用$x_{1},x_{2},\dots,x_{m}$来表示对照组的这些数据，其中$m$表示上述总体中的数字的数目。</p>
<p>现在我们来挑hf组的总体，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">hfPopulation &lt;- filter(dat, Sex ==<span class="string">"F"</span> &amp; Diet == <span class="string">"hf"</span>) %&gt;% dplyr::select(Bodyweight) %&gt;% unlist</div><div class="line">head(hfPopulation)</div><div class="line">length(hfPopulation)</div></pre></td></tr></table></figure>
<p>如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&gt; head(hfPopulation)</div><div class="line">Bodyweight1 Bodyweight2 Bodyweight3 Bodyweight4 Bodyweight5 Bodyweight6 </div><div class="line">      <span class="number">31.94</span>       <span class="number">32.48</span>       <span class="number">22.82</span>       <span class="number">19.92</span>       <span class="number">32.22</span>       <span class="number">27.50</span> </div><div class="line">&gt; length(hfPopulation)</div><div class="line">[<span class="number">1</span>] <span class="number">200</span></div></pre></td></tr></table></figure>
<p>现在我们使用y来表示hf组总体中的数目，即$y_{1}, y_{2}, \dots,y_{y}$，现在我们定义这些总体的一些参数：</p>
<p>均值：</p>
<script type="math/tex; mode=display">
\mu_{X}=\frac{1}{m} \sum_{i=1}^{m} x_{i} \text { and } \mu_{Y}=\frac{1}{n} \sum_{i=1}^{n} y_{i}</script><p>方差(variance)：</p>
<script type="math/tex; mode=display">
\sigma_{X}^{2}=\frac{1}{m} \sum_{i=1}^{m}\left(x_{i}-\mu_{X}\right)^{2} \text { and } \sigma_{Y}^{2}=\frac{1}{n} \sum_{i=1}^{n}\left(y_{i}-\mu_{Y}\right)^{2}</script><p>我们从总体中获得的这两个参数，即均值和方差，称为总体参数(population parameters)。</p>
<p>我们一开始的问题就可以这么写：$\mu_{Y}-\mu_{X}=0$?</p>
<p>虽然在我们的案例中我们获取了所有的值，并且验证这个问题是否为真，但是在实际中，我们并不能这么干。例如，在实际实验中，购买一个总体中的所有小鼠非常昂贵。此时，我们可以抽取一个样本(sample)来回答这个问题（也就是hf组和chow组中的小鼠体重的差异是否为0这个问题）。这就是统计推断(statistical inference)的本质。</p>
<h3 id="样本估计-sample-estimates"><a href="#样本估计-sample-estimates" class="headerlink" title="样本估计(sample estimates)"></a>样本估计(sample estimates)</h3><p>在前面部分中，我们从每个总体（hf总体和chow总体）中获取了样本，每个样本中有12只小鼠。在统计学中，我们经常使用大写字母来表示这些随机抽取的样本。因此这些样本就是$X_{1}, \ldots, X_{M}$和$Y_{1}, \ldots, Y_{N}$，在这个案例中，假设我们有12个样本，也就是说$N=M=12$，当我们列出总体的值时（这个总体此时是设定的，不随机的），我们就使用小写字母来下标它们。</p>
<p>由于我们想知道总体的两个均值$\mu_{Y}-\mu_{X}$是否为0，我们可以通过计算它们的样本之差是否为0，也即$\bar{Y}-\bar{X}$是否为0来进行推断（在统计学中，常用希腊字母$\mu$来表示总体均值，而用大写字母上加横的形式表示样本均值）：</p>
<script type="math/tex; mode=display">
\overline{X}=\frac{1}{M} \sum_{i=1}^{M} X_{i} \text { and } \overline{Y}=\frac{1}{N} \sum_{i=1}^{N} Y_{i}</script><p>需要注意的是，2个均值的差值也是一个随机变量，这些内容我们在前面已经提及。</p>
<h2 id="练习"><a href="#练习" class="headerlink" title="练习"></a>练习</h2><p>P39</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2019/08/02/DAL/DALS002_Inference01_Distribution/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/08/02/DAL/DALS002_Inference01_Distribution/" itemprop="url">DALS002-统计推断(Inference)01-概率分布</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-08-02T12:00:00+08:00">
                2019-08-02
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/生物统计/" itemprop="url" rel="index">
                    <span itemprop="name">生物统计</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  3,213
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  13
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>这篇笔记是《Data Analysis for the Life Sciences》的第2章：统计推断(Inference)的第1部分。这一部分的主要内容涉及p值，置信区间(confidence intervals)。</p>
<h2 id="统计学基础"><a href="#统计学基础" class="headerlink" title="统计学基础"></a>统计学基础</h2><p>先来看一篇文献，文献信息如下所示：</p>
<p>Winzell, M. S. and B. Ahren (2004). “The high-fat diet-fed mouse: a model for studying mechanisms and treatment of impaired glucose tolerance and type 2 diabetes.” Diabetes 53 Suppl 3: S215-219.<br>这篇文献的摘要部分有这么一句话：</p>
<blockquote>
<p>Body weight was higher in mice fed the high-fat diet already after the first week, due<br>to higher dietary intake in combination with lower metabolic efficiency.</p>
</blockquote>
<p>上面摘要的这句话的意思是，饲喂高脂饮料的小鼠，在前一周内，体重上升，这是由能量摄入较高，外加代谢消耗低导致的。</p>
<p>为了支持这种结论，作者在结果部分提到了这些话：</p>
<blockquote>
<p>Already during the first week after introduction of high-fat diet, body weight increased<br>significantly more in the high-fat diet-fed mice (+1.6± 0.1g) than in the normal diet-<br>fed mice (+ 0.2±0.1 g; P &lt; 0.001)</p>
</blockquote>
<p>当小鼠在第1周内饲喂高脂饮料后，饮喂高脂饲料的小鼠体重的增加 (+1.6± 0.1g) 明显高于普通饲料饲喂的小鼠体重增加(+0.2±0.1g; P &lt; 0.001)。</p>
<p>这里面有几个地方需要注意，第一就是<code>P&lt;0.001</code>。第二就是<code>±</code>。</p>
<p>要了解这两个内容，第一步就需要理解随机变量(random variables)，这里使用作者在Github上提供的原始数据来计算，在第1篇笔记中已经提到，导入数据如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">filename &lt;- file.path(dir,<span class="string">"extdata/femaleMiceWeights.csv"</span>)</div><div class="line">dat &lt;- read.csv(filename)</div></pre></td></tr></table></figure>
<p>我们先要来研究一个问题：给小鼠特定的饲料，几周后小鼠的体重是否会增加？现在我们从Jackson实验室（Jackson实验室是全球最大的实验小鼠供应商）购买了24只小鼠，随机分布它们吃正常的饲料(chow)和高脂饲料(hf, high fat)，几周后，研究人员称量小鼠的体重，获取数据如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">&gt; head(dat)</div><div class="line">  Diet Bodyweight</div><div class="line"><span class="number">1</span> chow      <span class="number">21.51</span></div><div class="line"><span class="number">2</span> chow      <span class="number">28.14</span></div><div class="line"><span class="number">3</span> chow      <span class="number">24.04</span></div><div class="line"><span class="number">4</span> chow      <span class="number">23.45</span></div><div class="line"><span class="number">5</span> chow      <span class="number">23.68</span></div><div class="line"><span class="number">6</span> chow      <span class="number">19.79</span></div></pre></td></tr></table></figure>
<p>现在问题来了，饲喂高脂饲料(hf)的小鼠体重是否更重？从数据中我们可以知道，在hf组，编号24的小鼠体重是20.73g，它是最轻的小鼠，但是编号21的小鼠是34.02g，它是最重的小鼠，但是它们吃的都是高脂饲料，无法比较。此时，我们把这些小鼠体重的变化称为<code>变异(variability)</code>。</p>
<p>再回到那篇文献，那篇文献下结论的时候，指的变量就是小鼠体重的平均变化，现在我们计算每组小鼠的平均变化，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">library</span>(dplyr)</div><div class="line">control &lt;- filter(dat, Diet == <span class="string">"chow"</span>) %&gt;% select(Bodyweight) %&gt;% unlist</div><div class="line">treatment &lt;- filter(dat, Diet == <span class="string">"hf"</span>) %&gt;% select(Bodyweight) %&gt;% unlist</div><div class="line">print(mean(treatment))</div><div class="line">print(mean(control))</div><div class="line">obsdiff &lt;- mean(treatment) - mean(control)</div><div class="line">obsdiff</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">&gt; print(mean(treatment))</div><div class="line">[<span class="number">1</span>] <span class="number">26.83417</span></div><div class="line">&gt; print(mean(control))</div><div class="line">[<span class="number">1</span>] <span class="number">23.81333</span></div><div class="line">&gt; obsdiff &lt;- mean(treatment) - mean(control)</div><div class="line">&gt; obsdiff</div><div class="line">[<span class="number">1</span>] <span class="number">3.020833</span></div></pre></td></tr></table></figure>
<p>从结果中我们可以发现，hf组小鼠的平均体重大概高于chow组小鼠平均体重的10%。为什么在这个地方我们不能下确定的结论，还需要一个p值(p-value)与置信区间(confidence intervals)？</p>
<p>这是因为这些均数数是随机变量，如果我们再重复一次实验，也就是说，我们再从Jackson实验室购买24只小鼠，随机将它们分为2组，一组hf，一组chow，我们还会得到一个不同的平均值。每重复一次，都会得到一个平均值，我们称这样的数据为随机变量(random variable)。</p>
<h2 id="随机变量-random-variable"><a href="#随机变量-random-variable" class="headerlink" title="随机变量(random variable)"></a>随机变量(random variable)</h2><p>现在我们进一步研究随机变量。试想，我们能够获取所有对照组小鼠的体重，把它们都放在R中计算，从统计学角度来说，这个所有的对照组小鼠的体重就是总体(population)，我们可以从这个总体中随机抽取24只小鼠，事实上来说，我们不可能拿到总体，因为太大了，不过我们可以模拟这个思路，现在下载这个数据，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">dir &lt;- system.file(package = <span class="string">"dagdata"</span>)</div><div class="line">filename &lt;- file.path(dir,<span class="string">"extdata/femaleControlsPopulation.csv"</span>)</div><div class="line">population &lt;- read.csv(filename)</div><div class="line">population &lt;- unlist(population) <span class="comment"># turn it into a numeric</span></div></pre></td></tr></table></figure>
<p>现在我们随机从总体(population)中抽取12个样本，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">control &lt;- sample(population, <span class="number">12</span>)</div><div class="line">mean(control)</div><div class="line">control &lt;- sample(population, <span class="number">12</span>)</div><div class="line">mean(control)</div><div class="line">control &lt;- sample(population, <span class="number">12</span>)</div><div class="line">mean(control)</div></pre></td></tr></table></figure>
<p>运行结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">&gt; control &lt;- sample(population, <span class="number">12</span>)</div><div class="line">&gt; mean(control)</div><div class="line">[<span class="number">1</span>] <span class="number">23.33917</span></div><div class="line">&gt; control &lt;- sample(population, <span class="number">12</span>)</div><div class="line">&gt; mean(control)</div><div class="line">[<span class="number">1</span>] <span class="number">23.53917</span></div><div class="line">&gt; control &lt;- sample(population, <span class="number">12</span>)</div><div class="line">&gt; mean(control)</div><div class="line">[<span class="number">1</span>] <span class="number">24.18167</span></div></pre></td></tr></table></figure>
<p>现在我们可以发现，每次抽取的时候，平均都发生了变化，我们可以一直这么重复的抽样下去，然后就能了解随机变量的分布。</p>
<h2 id="零假设-Null-Hypothesis"><a href="#零假设-Null-Hypothesis" class="headerlink" title="零假设(Null Hypothesis)"></a>零假设(Null Hypothesis)</h2><p>现在我们再回到前面的那个hf组与chow组小鼠平均体重差值的变量<code>obsdiff</code>上来。众所周知，科学家都有怀疑精神，我们做了一次实验，我们如何知道<code>obsdiff</code>这个是由饮食造成的呢？如果我们给这2组小鼠都喂同样的饲料，结果会是什么呢？万一<code>obsdiff</code>这个值更大咋办？统计学家们就把这种情况称为零假设(Null Hypothesis)。这个零(null)指的就是怀疑的方向：我认为这2组小鼠的体重没有差异的可能性(possibility)有多大(credence)。（注：原话是：we give credence to the possibility that there is no difference)。</p>
<p>因为我们假设了我们能够获得总体，我们实际上可能尽可能多地观察到，当饲料没对体重没有影响时的差值。现在我们假设随机取了24只对照小鼠，把它们分为2组，也就是每组12只，现在我们观察一下它们平均体重值的差值，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">control &lt;- sample(population, <span class="number">12</span>) <span class="comment"># control mice</span></div><div class="line">treatment &lt;- sample(population, <span class="number">12</span>)</div><div class="line"><span class="comment"># We assume high diet have no effect on weight</span></div><div class="line">print(mean(treatment) - mean(control))</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; print(mean(treatment) - mean(control))</div><div class="line">[<span class="number">1</span>] <span class="number">0.2275</span></div></pre></td></tr></table></figure>
<p>现在我们重复这个过程1万次（最好不要使用for循环，这里可以使用<code>replicate()</code>函数），如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">n &lt;- <span class="number">10000</span></div><div class="line">null &lt;- vector(<span class="string">"numeric"</span>, n)</div><div class="line"><span class="keyword">for</span> (i <span class="keyword">in</span> <span class="number">1</span>:n)&#123;</div><div class="line">  control &lt;- sample(population, <span class="number">12</span>)</div><div class="line">  treatment &lt;- sample(population, <span class="number">12</span>)</div><div class="line">  null[i] &lt;- mean(treatment) - mean(control)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>其中变量<code>null</code>就是我们称的零分布(null distribution)，它里面有10000个差值，现在我们来计算一下，这里面的10000个差值与前面<code>obsdiff</code>的比较（原来过计算的obsdiff为3.020833），看一下大于原来的3.020833这个数字的比例有多大，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mean(null &gt;= <span class="number">3.020833</span>)</div></pre></td></tr></table></figure>
<p>如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; mean(null &gt;= <span class="number">3.020833</span>)</div><div class="line">[<span class="number">1</span>] <span class="number">0.013</span></div></pre></td></tr></table></figure>
<p>这个比例是0.013，也就是1.3%，也就是说，假设饲料对小鼠的体重没有影响，我们重复1万次实验，只有1.3%的比例，也就是说只有130次实验能说明“饲料对小鼠的体重没影响”这个结论，另外9870次我们都得不出这个结论，因此，即使作为怀疑性极强的科学们家，也只能说，当饲料对体重没有影响时，我们只能看到1.3%的的可能性。这就是p值。</p>
<p>下面是通过<code>replicate()</code>函数来实现上述过程，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">null_f &lt;- <span class="keyword">function</span>(x)&#123;</div><div class="line">  control &lt;- sample(x, <span class="number">12</span>)</div><div class="line">  treatment &lt;- sample(x, <span class="number">12</span>)</div><div class="line">  null &lt;- mean(treatment) - mean(control)</div><div class="line">  <span class="keyword">return</span>(null)</div><div class="line">&#125;</div><div class="line"></div><div class="line">null_result &lt;- replicate(n, null_f(population))</div><div class="line">mean(null_result&gt;=<span class="number">3.020833</span>)</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; mean(null_result&gt;=<span class="number">3.020833</span>)</div><div class="line">[<span class="number">1</span>] <span class="number">0.0123</span></div></pre></td></tr></table></figure>
<p>1.23%。</p>
<h2 id="分布-distributions"><a href="#分布-distributions" class="headerlink" title="分布(distributions)"></a>分布(distributions)</h2><p>分布简单来说就是，对大量数据的精简描述，例如你测量了一个总体中的所有男性的身高，现在你需要把这些数据向一个外星人描述，而这个外星人从来没到过地球，数据如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">library</span>(UsingR)</div><div class="line">x &lt;- father.son$fheight</div></pre></td></tr></table></figure>
<p>注：这个包<code>UsingR</code>是《Using R for Introductory Statistics》 Second Edition的数据。其中<code>father.son</code>这个数据集含有的是父亲的身高与儿子的身高（单位是英寸），用于研究Pearson相关系数。</p>
<p>现在向外星人描述比较简单的方法就是把它们都列出来，现在我们随机选择10个数据，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">round(sample(x,<span class="number">10</span>),<span class="number">10</span>)</div></pre></td></tr></table></figure>
<p>如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&gt; round(sample(x,<span class="number">10</span>),<span class="number">10</span>)</div><div class="line"> [<span class="number">1</span>] <span class="number">65.25267</span> <span class="number">62.41134</span> <span class="number">68.83427</span> <span class="number">66.69404</span> <span class="number">65.98544</span> <span class="number">69.60692</span> <span class="number">71.96564</span> <span class="number">68.11283</span> <span class="number">67.93353</span></div><div class="line">[<span class="number">10</span>] <span class="number">67.41537</span></div></pre></td></tr></table></figure>
<h3 id="累积分布函数-Cumulative-Distribution-Function-CDF"><a href="#累积分布函数-Cumulative-Distribution-Function-CDF" class="headerlink" title="累积分布函数(Cumulative Distribution Function, CDF)"></a>累积分布函数(Cumulative Distribution Function, CDF)</h3><p>通过查看这些数字，我们了解一个大概，但是非常低效。但是我们可以通过一个分布曲线(distribution)来画一下这些数据，现在我们定义一下分布，先取一个值a，小于a值的数字的比例，就是分布，如下所示：</p>
<script type="math/tex; mode=display">
F(a) \equiv \operatorname{Pr}(x \leq a)</script><p>这个函数叫累积分布函数(CDF)，当CDF来源于一个数据集中，而不是理论值时，我们就称它为经验累积分布函数(empirical CDF, ECDF)，我们可以画出这个分布曲线，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">smallest &lt;- floor(min(x))</div><div class="line">largest &lt;- ceiling(max(x))</div><div class="line">values &lt;- seq(smallest, largest, len=<span class="number">300</span>)</div><div class="line">heightecdf &lt;- ecdf(x)</div><div class="line">plot(values, heightecdf(values), type=<span class="string">"l"</span>,</div><div class="line">     xlab=<span class="string">"a(Height in inches)"</span>, ylab=<span class="string">"Pr(x &lt;= a)"</span>)</div></pre></td></tr></table></figure>
<p><img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190721111343.jpeg" alt=""></p>
<h3 id="直方图-Histograms"><a href="#直方图-Histograms" class="headerlink" title="直方图(Histograms)"></a>直方图(Histograms)</h3><p><code>ecdf</code>这个函数在R中并不常用，现在我们使用区间的形式来给出间内的比例，如下所示：</p>
<script type="math/tex; mode=display">
\begin{equation}
\operatorname{Pr}(a \leq x \leq b)=F(b)-F(a)
\end{equation}</script><p>使用直方图更加直观，因为我们多数感兴趣的是某个区间的高度，例如70到71这个区间的比例，而很少会去看低于70这个比例，直方图如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">hist(x)</div></pre></td></tr></table></figure>
<p><img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190721111829.jpeg" alt=""></p>
<p>可以对这个直方图做进一步的修饰，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">bins &lt;- seq(smallest, largest)</div><div class="line">hist(x, breaks=bins, xlab=<span class="string">"Height(in inches)"</span>, main=<span class="string">"Adlt men heights"</span>)</div></pre></td></tr></table></figure>
<p><img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190721112009.jpeg" alt=""></p>
<p>这种图比纯列数字更加直观，从图上我们大致就能判断出高于72英寸的人大概有70个人。</p>
<h2 id="概率分布-Probability-Distribution"><a href="#概率分布-Probability-Distribution" class="headerlink" title="概率分布(Probability Distribution)"></a>概率分布(Probability Distribution)</h2><p>分布的一个更加重要的功能是用于描述一个随机变量的可能结果。与一组固定的数据不同，我们实际上无法观测到随机变量的所有可能结果，因此，我们在这种情况下，不描述比例(proportions)，而是用于描述概率(probabilities)。例如，当我们从上面的那组身高数据中取机挑一个数字，它落在a与b区间内的概率就可以用下面的公式表示：</p>
<script type="math/tex; mode=display">
\operatorname{Pr}(a \leq X \leq b)=F(b)-F(a)</script><p>上面公式中的<code>X</code>表示随机变量，这个公式定义了随机变量的概率分布。例如，在这种情况下，如果我们知道了零假设下的小鼠体重均值的差值分布是真的，那么，我们就能在这个分布上找到与我们实验中计算出的值对应值的概率，也就是p值。</p>
<p>在前面的案例中，我们计算了10000个零假设下的随机变量概率分布（这种重复抽样的方法叫蒙特卡罗法,Monte Carlo），现在我们再重复一次，不过这次有所不同，在每重复做一次实验，我们就把这个点添加到图片上，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">library</span>(rafalib)</div><div class="line">n &lt;- <span class="number">100</span></div><div class="line">nullplot(-<span class="number">5</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">30</span>, xlab=<span class="string">"Observed differences(grams)"</span>, ylab=<span class="string">"Frequencey"</span>)</div><div class="line">totals &lt;- vector(<span class="string">"numeric"</span>,<span class="number">11</span>)</div><div class="line"><span class="keyword">for</span> (i <span class="keyword">in</span> <span class="number">1</span>:n)&#123;</div><div class="line">  control &lt;- sample(population, <span class="number">12</span>)</div><div class="line">  treatment &lt;- sample(population, <span class="number">12</span>)</div><div class="line">  nulldiff &lt;- mean(treatment) - mean(control)</div><div class="line">  j &lt;- pmax(pmin(round(nulldiff)+<span class="number">6</span>, <span class="number">11</span>),<span class="number">1</span>)</div><div class="line">  totals[j] &lt;- totals[j]+<span class="number">1</span></div><div class="line">  text(j-<span class="number">6</span>, totals[j], pch=<span class="number">15</span>, round(nulldiff,<span class="number">1</span>),cex=<span class="number">1</span>)</div><div class="line">  <span class="keyword">if</span>(i &lt;<span class="number">15</span>) Sys.sleep(<span class="number">1</span>) <span class="comment"># See values appear slowly</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190721114309.jpeg" alt=""></p>
<p>上面的图其实就是一个直方图，obsdiff最初的值是3.020833，从上面的图我们可以知道，与这个值接近的数字很少。</p>
<p>从前面我们计算的null可以看出来，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">hist(null, freq=<span class="literal">TRUE</span>)</div><div class="line">abline(v=obsdiff, col=<span class="string">"red"</span>, lwd=<span class="number">2</span>)</div></pre></td></tr></table></figure>
<p><img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190721114517.jpeg" alt=""></p>
<p>上面是我们手动计算<code>Pr(a)</code>的过程，但多数情况下，一些分布的<code>Pr(a)</code>公式都是已知的，例如正态分布。</p>
<h2 id="正态分布-Normal-Distribution"><a href="#正态分布-Normal-Distribution" class="headerlink" title="正态分布(Normal Distribution)"></a>正态分布(Normal Distribution)</h2><p>正态分布是最常见的分布之一，normal就是正常，常见的意思，它的公式如下所示：</p>
<script type="math/tex; mode=display">
\operatorname{Pr}(a<x<b)=\int_{a}^{b} \frac{1}{\sqrt{2 \pi \sigma^{2}}} \exp \left(\frac{-(x-\mu)^{2}}{2 \sigma^{2}}\right) d x</script><p>在R的<code>pnorm()</code>函数中，a通常是负无穷，b则是你要计算的参数，另外，要计算区间的概率，还需要两个参数，分别是均值与标准差，即<code>pnomr(x, mu, sigma)</code>，这个公式计算的就是小于x的这值的概率，现在回到前面的<code>obsdiff(3.020833)</code>这个变量上来，我们计算一下：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="number">1</span> - pnorm(obsdiff, mean(null),sd(null))</div></pre></td></tr></table></figure>
<p>如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; <span class="number">1</span> - pnorm(obsdiff, mean(null),sd(null))</div><div class="line">[<span class="number">1</span>] <span class="number">0.01377017</span></div></pre></td></tr></table></figure>
<h2 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h2><p>计算hf组与chow组小鼠的体重差异的p值是非常简单的。为了做这个计算，我们可以买来所有的小鼠，来重复的计算，找到零假设，但是不现实，因此我们要使用统计推断(Statistical Inference)的思想，这种思想可以允许我们使用少量的样本，例如24只小鼠就能得到一个相对靠谱的结论。</p>
<h2 id="练习"><a href="#练习" class="headerlink" title="练习"></a>练习</h2><p>原书P37</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2019/08/01/DAL/DALS001_Getting_Start/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/08/01/DAL/DALS001_Getting_Start/" itemprop="url">DALS01-数据准备(Getting Started)</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-08-01T12:00:00+08:00">
                2019-08-01
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/生物统计/" itemprop="url" rel="index">
                    <span itemprop="name">生物统计</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  1,528
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  7
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>本书是《Data Analysis for the Life Sciences》这本书的读书笔记。</p>
<p><img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190721083503.png" alt=""></p>
<p>此书一共分了10部分，分别为：</p>
<ul>
<li>第一章：数据准备(Getting Started)</li>
<li>第二章：统计推断(Inference)</li>
<li>第三章：数据挖掘(Exploratory Data Analysis)</li>
<li>第四章：矩阵代数(Matrix Algebra)</li>
<li>第五章：线性模型(Linear Models)</li>
<li>第六章：高维数据推断(Inference For high Dimensional Data)</li>
<li>第七章：统计模型(Statistical Models)</li>
<li>第八章：距离与降低(Distance and Dimension Reduction)</li>
<li>第九章：基础机器学习(Basic Machine Learning)</li>
<li>第十章：批次效应(Batch Effects)</li>
</ul>
<p>这篇笔记是《Data Analysis for the Life Sciences》第一章的内容，是关于书中原始数据的准备，相关知识主要是R语言的基础语法，文件路径操作，数学符号。</p>
<p>作者已经把这本书中的所有代码已经分享到了<a href="https://github.com/genomicsclass/labs" target="_blank" rel="external">Github</a>上，可以参考。</p>
<h2 id="R语言包与原始数据准备"><a href="#R语言包与原始数据准备" class="headerlink" title="R语言包与原始数据准备"></a>R语言包与原始数据准备</h2><p>这本书中涉及到的统计学原理与案例分析都是通过R语言实现的，作者也把相应的脚本与数据放到了Github上。</p>
<p>这里先安装几个R包，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">library</span>(devtools)</div><div class="line">install_github(<span class="string">"genomicsclass/dagdata"</span>)</div><div class="line">dir &lt;- system.file(package = <span class="string">"dagdata"</span>)</div><div class="line">list.files(dir)</div></pre></td></tr></table></figure>
<p>加载原始数据 ，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&gt; dir &lt;- system.file(package = <span class="string">"dagdata"</span>)</div><div class="line">&gt; list.files(dir)</div><div class="line">[<span class="number">1</span>] <span class="string">"data"</span>        <span class="string">"DESCRIPTION"</span> <span class="string">"extdata"</span>     <span class="string">"help"</span>        <span class="string">"html"</span>        <span class="string">"Meta"</span>       </div><div class="line">[<span class="number">7</span>] <span class="string">"NAMESPACE"</span>   <span class="string">"script"</span></div></pre></td></tr></table></figure>
<p>上面的代码使用了到几个包与命令，其中<code>devtool</code>包中的<code>install_github()</code>函数用于直接从Github下载相应包，以前的笔记中已经说明了这个包的用法<a href="http://rvdsd.top/2017/04/07/R/R%E5%8C%85%E7%9A%84%E6%93%8D%E4%BD%9C%E4%B8%8E%E5%86%85%E7%BD%AE%E6%95%B0%E6%8D%AE%E9%9B%86/">《R语言笔记之包的操作与内置数据集》</a>。</p>
<p>另外还有两个函数，其中<code>system.file()</code>函数的功能是：发现包的完整路径名，例如上面的变量<code>dir</code>的输出就是如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; dir</div><div class="line">[<span class="number">1</span>] <span class="string">"C:/Users/20161111/Documents/R/win-library/3.5/dagdata"</span></div></pre></td></tr></table></figure>
<p><code>list.files()</code>函数的功能是列出相应路径下的文件，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&gt; list.files(dir)</div><div class="line">[<span class="number">1</span>] <span class="string">"data"</span>        <span class="string">"DESCRIPTION"</span> <span class="string">"extdata"</span>     <span class="string">"help"</span>        <span class="string">"html"</span>        <span class="string">"Meta"</span>       </div><div class="line">[<span class="number">7</span>] <span class="string">"NAMESPACE"</span>   <span class="string">"script"</span></div></pre></td></tr></table></figure>
<p>使用<code>list.files()</code>函数还能继续列举出目录下一层目录中的内容，例如现在我们列出<code>extdata</code>这个目录中的内容，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&gt; list.files(file.path(dir,<span class="string">"extdata"</span>))</div><div class="line">[<span class="number">1</span>] <span class="string">"admissions.csv"</span>               <span class="string">"astronomicalunit.csv"</span>        </div><div class="line">[<span class="number">3</span>] <span class="string">"babies.txt"</span>                   <span class="string">"femaleControlsPopulation.csv"</span></div><div class="line">[<span class="number">5</span>] <span class="string">"femaleMiceWeights.csv"</span>        <span class="string">"mice_pheno.csv"</span>              </div><div class="line">[<span class="number">7</span>] <span class="string">"msleep_ggplot2.csv"</span>           <span class="string">"README"</span>                      </div><div class="line">[<span class="number">9</span>] <span class="string">"spider_wolff_gorb_2013.csv"</span></div></pre></td></tr></table></figure>
<p>其中这里面用到<code>file.path()</code>函数，它的功能是将字符串连接起来，形成路径，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; file.path(dir,<span class="string">"extdata"</span>)</div><div class="line">[<span class="number">1</span>] <span class="string">"C:/Users/20161111/Documents/R/win-library/3.5/dagdata/extdata"</span></div></pre></td></tr></table></figure>
<p>现在加载原始数据，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">filename &lt;- file.path(dir,<span class="string">"extdata/femaleMiceWeights.csv"</span>)</div><div class="line">dat &lt;- read.csv(filename)</div><div class="line"><span class="comment"># input raw data</span></div><div class="line">head(dat)</div><div class="line">str(dat)</div></pre></td></tr></table></figure>
<p>数据如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">&gt; head(dat)</div><div class="line">  Diet Bodyweight</div><div class="line"><span class="number">1</span> chow      <span class="number">21.51</span></div><div class="line"><span class="number">2</span> chow      <span class="number">28.14</span></div><div class="line"><span class="number">3</span> chow      <span class="number">24.04</span></div><div class="line"><span class="number">4</span> chow      <span class="number">23.45</span></div><div class="line"><span class="number">5</span> chow      <span class="number">23.68</span></div><div class="line"><span class="number">6</span> chow      <span class="number">19.79</span></div><div class="line">&gt; str(dat)</div><div class="line"><span class="string">'data.frame'</span>:	<span class="number">24</span> obs. of  <span class="number">2</span> variables:</div><div class="line"> $ Diet      : Factor w/ <span class="number">2</span> levels <span class="string">"chow"</span>,<span class="string">"hf"</span>: <span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="keyword">...</span></div><div class="line"> $ Bodyweight: num  <span class="number">21.5</span> <span class="number">28.1</span> <span class="number">24</span> <span class="number">23.4</span> <span class="number">23.7</span> <span class="keyword">...</span></div></pre></td></tr></table></figure>
<p>从数据我们可以知道，这是一个数据框，有2列，第1列是小鼠的包含情况，分别是chow（正常组）,hf（高脂组，就是high fat的缩写），第2列的体重，从常识可以知道，单位是g（一只标准的小鼠体重是18-22g）。</p>
<p>以上是原始数据的下载过程，涉及到的知识点为：R包的下载与加载，另外，也可以通过<code>downloader</code>包来下载原始数据，整个操作如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">install.packages(<span class="string">"downloader"</span>)</div><div class="line">url &lt;- <span class="string">"https://raw.githubusercontent.com/genomicsclass/dagdata/master/inst/extd\</span></div><div class="line"><span class="string">ata/femaleMiceWeights.csv"</span></div><div class="line">filename &lt;- <span class="string">"femaleMiceWeights.csv"</span></div><div class="line">download(url, destfile=filename)</div></pre></td></tr></table></figure>
<p>这一过程不再演示，跟前面的目的是一样，都是下载原始数据。</p>
<p>有了原始数据后，现在过程一下数据，我们捏造chow组的小鼠数据，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">library</span>(dplyr)</div><div class="line">chow &lt;- filter(dat, Diet ==<span class="string">"chow"</span>)</div><div class="line"><span class="comment"># Extract chow gropu from raw data of dat </span></div><div class="line">head(chow)</div><div class="line">str(chow)</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&gt; chow &lt;- filter(dat, Diet ==<span class="string">"chow"</span>)</div><div class="line">&gt; str(chow)</div><div class="line"><span class="string">'data.frame'</span>:	<span class="number">12</span> obs. of  <span class="number">2</span> variables:</div><div class="line"> $ Diet      : Factor w/ <span class="number">2</span> levels <span class="string">"chow"</span>,<span class="string">"hf"</span>: <span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="keyword">...</span></div><div class="line"> $ Bodyweight: num  <span class="number">21.5</span> <span class="number">28.1</span> <span class="number">24</span> <span class="number">23.4</span> <span class="number">23.7</span> <span class="keyword">...</span></div></pre></td></tr></table></figure>
<p>仅提取chow组的体重，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">chowVals &lt;- select(chow, Bodyweight)</div><div class="line">head(chowVals)</div><div class="line">str(chowVals)</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">&gt; head(chowVals)</div><div class="line">  Bodyweight</div><div class="line"><span class="number">1</span>      <span class="number">21.51</span></div><div class="line"><span class="number">2</span>      <span class="number">28.14</span></div><div class="line"><span class="number">3</span>      <span class="number">24.04</span></div><div class="line"><span class="number">4</span>      <span class="number">23.45</span></div><div class="line"><span class="number">5</span>      <span class="number">23.68</span></div><div class="line"><span class="number">6</span>      <span class="number">19.79</span></div><div class="line">&gt; str(chowVals)</div><div class="line"><span class="string">'data.frame'</span>:	<span class="number">12</span> obs. of  <span class="number">1</span> variable:</div><div class="line"> $ Bodyweight: num  <span class="number">21.5</span> <span class="number">28.1</span> <span class="number">24</span> <span class="number">23.4</span> <span class="number">23.7</span> <span class="keyword">...</span></div><div class="line">&gt; class(chowVals)</div><div class="line">[<span class="number">1</span>] <span class="string">"data.frame"</span></div><div class="line">&gt; <span class="comment"># OR perform as following:</span></div><div class="line">&gt; <span class="comment"># chowVals &lt;- filter(dat, Diet=="chow") %&gt;% select(Bodyweight)</span></div></pre></td></tr></table></figure>
<p>从上面结果可以看出来，<code>chowVals</code>是一个数据框，现在我们将其转换为数字向量：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">chowVals &lt;- unlist(chowVals)</div><div class="line">str(chowVals)</div><div class="line">class(chowVals)</div></pre></td></tr></table></figure>
<p>如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&gt; str(chowVals)</div><div class="line"> Named num [<span class="number">1</span>:<span class="number">12</span>] <span class="number">21.5</span> <span class="number">28.1</span> <span class="number">24</span> <span class="number">23.4</span> <span class="number">23.7</span> <span class="keyword">...</span></div><div class="line"> - attr(*, <span class="string">"names"</span>)= chr [<span class="number">1</span>:<span class="number">12</span>] <span class="string">"Bodyweight1"</span> <span class="string">"Bodyweight2"</span> <span class="string">"Bodyweight3"</span> <span class="string">"Bodyweight4"</span> <span class="keyword">...</span></div><div class="line">&gt; class(chowVals)</div><div class="line">[<span class="number">1</span>] <span class="string">"numeric"</span></div></pre></td></tr></table></figure>
<h2 id="数学术语与符号"><a href="#数学术语与符号" class="headerlink" title="数学术语与符号"></a>数学术语与符号</h2><p>作者在书中提到，他会尽量避免使用数学术语与数学符号，但是，有一些太常见的数据符号是大家常见的，需要知道。</p>
<h3 id="希腊字母"><a href="#希腊字母" class="headerlink" title="希腊字母"></a>希腊字母</h3><p>$\sum$是希腊字母中的S的写法，表示相加，例如$S=\sum_{i=1}^{n} x_{i}$</p>
<p>$\mu$表示未知均数，相当于m，即mean；</p>
<p>$\sigma$表示标准差，相当于s，即standard difference；</p>
<p>$\epsilon$表示随机误差，相当于error；</p>
<p>$\beta$表示效应，即effect。</p>
<h3 id="无穷-Infinity"><a href="#无穷-Infinity" class="headerlink" title="无穷(Infinity)"></a>无穷(Infinity)</h3><p>书中指出，我们经常使用的统计学结果是一种渐进结果(asymptotic results)。这个渐进结果指的是一种近似(approximation)，也就是说随着数据点数目的增大，这个结果只能接近，无法完全相等，只有当数据点的数目是无穷($\infty$)时，数字最接近，看下面的一个案例：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">&gt; onethird &lt;- <span class="keyword">function</span>(n) sum(<span class="number">3</span>/<span class="number">10</span>^c(<span class="number">1</span>:n))</div><div class="line">&gt; <span class="number">1</span>/<span class="number">3</span> - onethird(<span class="number">4</span>)</div><div class="line">[<span class="number">1</span>] <span class="number">3.333333e-05</span></div><div class="line">&gt; <span class="number">1</span>/<span class="number">3</span> - onethird(<span class="number">10</span>)</div><div class="line">[<span class="number">1</span>] <span class="number">3.333334e-11</span></div><div class="line">&gt; <span class="number">1</span>/<span class="number">3</span> - onethird(<span class="number">16</span>)</div><div class="line">[<span class="number">1</span>] <span class="number">0</span></div></pre></td></tr></table></figure>
<p>在这个案例中，我们就看到了，0.3的1到n次方的和是接近1/3的。</p>
<h3 id="积分-Integrals"><a href="#积分-Integrals" class="headerlink" title="积分(Integrals)"></a>积分(Integrals)</h3><p>积分在统计学也是比较常用的一个手段，有的时候要计算某个统计学分布的概率分布例如下面的这个曲线：</p>
<p><img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190721091241.png" alt=""></p>
<p>这个曲线是一个概率密度曲线，右下角的灰色面积占整个曲线下面积的比例，就是相应的概率（后面会讲），那么通过积分的手段来计算面积的分公式就是：</p>
<script type="math/tex; mode=display">
\int_{2}^{4} f(x) d x</script><h2 id="练习"><a href="#练习" class="headerlink" title="练习"></a>练习</h2><p>原书P16页</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2019/07/23/BioItem/iTRAQ定量蛋白质组(下)/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/07/23/BioItem/iTRAQ定量蛋白质组(下)/" itemprop="url">iTRAQ定量蛋白质组(下)</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-07-23T12:00:00+08:00">
                2019-07-23
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/生信实战项目/" itemprop="url" rel="index">
                    <span itemprop="name">生信实战项目</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  75
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  1
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>TMT标签</p>
<p><a href="https://www.thermofisher.com/cn/zh/home/life-science/protein-biology/protein-mass-spectrometry-analysis/protein-quantitation-mass-spectrometry/tandem-mass-tag-systems.html" target="_blank" rel="external">https://www.thermofisher.com/cn/zh/home/life-science/protein-biology/protein-mass-spectrometry-analysis/protein-quantitation-mass-spectrometry/tandem-mass-tag-systems.html</a></p>
<p><a href="http://www.mtoz-biolabs.com/itraq-tmt.html" target="_blank" rel="external">http://www.mtoz-biolabs.com/itraq-tmt.html</a></p>
<p><a href="http://www.bioinfor.com/quantification/" target="_blank" rel="external">http://www.bioinfor.com/quantification/</a></p>
<p><a href="https://www.sciencedirect.com/topics/medicine-and-dentistry/isobaric-labeling" target="_blank" rel="external">https://www.sciencedirect.com/topics/medicine-and-dentistry/isobaric-labeling</a></p>
<p><a href="https://www.thermofisher.com/cn/zh/home/life-science/protein-biology/protein-biology-learning-center/protein-biology-resource-library/pierce-protein-methods/quantitative-proteomics.html" target="_blank" rel="external">https://www.thermofisher.com/cn/zh/home/life-science/protein-biology/protein-biology-learning-center/protein-biology-resource-library/pierce-protein-methods/quantitative-proteomics.html</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2019/07/15/R/R语言中的颜色设置/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/07/15/R/R语言中的颜色设置/" itemprop="url">R语言中的颜色设置</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-07-15T12:00:00+08:00">
                2019-07-15
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/R/" itemprop="url" rel="index">
                    <span itemprop="name">R</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  860
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  4
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="RColorBrewer包"><a href="#RColorBrewer包" class="headerlink" title="RColorBrewer包"></a>RColorBrewer包</h2><p>此包的官方配色网站是：<a href="http://colorbrewer2.org" target="_blank" rel="external">http://colorbrewer2.org</a></p>
<h3 id="brewer-pal"><a href="#brewer-pal" class="headerlink" title="brewer.pal()"></a><code>brewer.pal()</code></h3><p>参数为：<code>brewer.pal(n ,name)</code>，其中n为不同颜色数，最小为3，最大取决于调色板中的颜色数。name指颜色的名称，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">mypalette&lt;-brewer.pal(<span class="number">7</span>,<span class="string">"Greens"</span>)</div><div class="line">mypalette</div></pre></td></tr></table></figure>
<p>运行结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&gt; mypalette&lt;-brewer.pal(<span class="number">7</span>,<span class="string">"Greens"</span>)</div><div class="line">&gt; mypalette</div><div class="line">[<span class="number">1</span>] <span class="string">"#EDF8E9"</span> <span class="string">"#C7E9C0"</span> <span class="string">"#A1D99B"</span> <span class="string">"#74C476"</span> <span class="string">"#41AB5D"</span> <span class="string">"#238B45"</span> <span class="string">"#005A32"</span></div></pre></td></tr></table></figure>
<h3 id="display-brewer-pal"><a href="#display-brewer-pal" class="headerlink" title="display.brewer.pal()"></a><code>display.brewer.pal()</code></h3><p>在窗口中显示显示的颜色，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">display.brewer.pal(<span class="number">7</span>,<span class="string">"BrBG"</span>)</div></pre></td></tr></table></figure>
<p>运行结果如下所示：</p>
<p><img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190715095133.png" alt=""></p>
<h3 id="brewer-pal-info-可以查看颜色信息"><a href="#brewer-pal-info-可以查看颜色信息" class="headerlink" title="brewer.pal.info()可以查看颜色信息"></a><code>brewer.pal.info()</code>可以查看颜色信息</h3><figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">brewer.pal.info[<span class="string">"Blues"</span>,]</div></pre></td></tr></table></figure>
<p>如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&gt; brewer.pal.info[<span class="string">"Blues"</span>,]</div><div class="line">      maxcolors category colorblind</div><div class="line">Blues         <span class="number">9</span>      seq       <span class="literal">TRUE</span></div></pre></td></tr></table></figure>
<h3 id="display-brewer-all"><a href="#display-brewer-all" class="headerlink" title="display.brewer.all()"></a><code>display.brewer.all()</code></h3><p>参数为：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">display.brewer.all(n=<span class="number">10</span>, type=<span class="string">"all"</span>, select=<span class="literal">NULL</span>, exact.n=<span class="literal">TRUE</span>, </div><div class="line">colorblindFriendly=<span class="literal">FALSE</span>)</div></pre></td></tr></table></figure>
<p>同时显示几个调色板，如下所示：</p>
<p><img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190715095827.png" alt=""></p>
<h4 id="颜色类型"><a href="#颜色类型" class="headerlink" title="颜色类型"></a>颜色类型</h4><p>其中参数<code>type</code>是显示颜色类型，一共有三种颜色类型，分别是seq连续型，div离散型，qual极端型，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">display.brewer.all(type = <span class="string">"seq"</span>)</div></pre></td></tr></table></figure>
<p><img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190715095816.png" alt=""></p>
<p>如果我们要使用YIOrRd组中的第1，3，4，6，8，9这6种颜色，可以使用下面的代码：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">barplot(rep(<span class="number">1</span>,<span class="number">6</span>),col = brewer.pal(<span class="number">9</span>,<span class="string">"YlOrRd"</span>)[c(<span class="number">1</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">6</span>,<span class="number">8</span>,<span class="number">9</span>)])</div></pre></td></tr></table></figure>
<p><img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190715100025.png" alt=""></p>
<p>div离散型颜色，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">display.brewer.all(type = <span class="string">"div"</span>)</div></pre></td></tr></table></figure>
<p><img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190715100112.png" alt=""></p>
<p>这种颜色两边亮，中间暗，比较适合进行高低对比。</p>
<p>现在我们使用BrBG组中的3到8种颜色，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">barplot(rep(<span class="number">1</span>,<span class="number">6</span>),col = brewer.pal(<span class="number">11</span>,<span class="string">"BrBG"</span>)[<span class="number">3</span>:<span class="number">8</span>])</div></pre></td></tr></table></figure>
<p><img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190715100205.png" alt=""></p>
<p>qual极端型颜色</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">display.brewer.all(type = <span class="string">"qual"</span>)</div></pre></td></tr></table></figure>
<p><img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190715100235.png" alt=""></p>
<p>这种颜色比较适合呈现分类变量。</p>
<p>现在使用Set3中的3到8种颜色，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">barplot(rep(<span class="number">1</span>,<span class="number">6</span>),col = brewer.pal(<span class="number">12</span>,<span class="string">"Set3"</span>)[<span class="number">3</span>:<span class="number">8</span>])</div></pre></td></tr></table></figure>
<p><img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190715100306.png" alt=""></p>
<h2 id="RColorBrewer包使用案例"><a href="#RColorBrewer包使用案例" class="headerlink" title="RColorBrewer包使用案例"></a>RColorBrewer包使用案例</h2><h3 id="第1案例：从现在的颜色中挑选颜色"><a href="#第1案例：从现在的颜色中挑选颜色" class="headerlink" title="第1案例：从现在的颜色中挑选颜色"></a>第1案例：从现在的颜色中挑选颜色</h3><p>代码如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">### Set the display a 1 by 1 grid</span></div><div class="line">par(mfrow=c(<span class="number">1</span>,<span class="number">1</span>))</div><div class="line"><span class="comment">### Generate random data matrix</span></div><div class="line">rand.data &lt;- replicate(<span class="number">8</span>,rnorm(<span class="number">100</span>,<span class="number">100</span>,sd=<span class="number">1.5</span>))</div><div class="line"><span class="comment">### Draw a box plot, with each box coloured by the 'Set3' palette</span></div><div class="line">boxplot(rand.data,col=brewer.pal(<span class="number">8</span>,<span class="string">"Set3"</span>))</div></pre></td></tr></table></figure>
<p>这里使用到了<code>replicate()</code>函数，这个函数在<code>rand.data &lt;- replicate(8,rnorm(100,100,sd=1.5))</code>这个语句中的意思是，将后面的<code>rnorm(100,100,sd=1.5)</code>这个语句运行100次，也就是生成800个均值为100，sd为1.5的，符合正态分布的数据，结果如下所示：</p>
<p><img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190715100823.png" alt=""></p>
<h3 id="第2案例：使用colorRampPalette-来扩展颜色"><a href="#第2案例：使用colorRampPalette-来扩展颜色" class="headerlink" title="第2案例：使用colorRampPalette()来扩展颜色"></a>第2案例：使用<code>colorRampPalette()</code>来扩展颜色</h3><p>代码如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">### 使用colorRampPalette可以扩展颜色。</span></div><div class="line">newpalette&lt;-colorRampPalette(brewer.pal(<span class="number">9</span>,<span class="string">"Blues"</span>))(<span class="number">10</span>)</div><div class="line"><span class="comment">### Generate random data matrix</span></div><div class="line">rand.data &lt;- replicate(<span class="number">10</span>,rnorm(<span class="number">100</span>,<span class="number">100</span>,sd=<span class="number">1.5</span>))</div><div class="line"><span class="comment">### Draw a box plot, with each box coloured by the 'newpalette' palette</span></div><div class="line">boxplot(rand.data,col=newpalette)</div></pre></td></tr></table></figure>
<p><img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190715101208.png" alt=""></p>
<p>这里使用到了<code>colorRampPalette()</code>函数，此函数可以自定义一繁殖颜色梯度，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">colors &lt;- colorRampPalette(c(<span class="string">"green"</span>, <span class="string">"red"</span>))(<span class="number">5</span>)</div><div class="line">colors</div><div class="line">rand.data &lt;- replicate(<span class="number">10</span>,rnorm(<span class="number">100</span>,<span class="number">100</span>,sd=<span class="number">1.5</span>))</div><div class="line">boxplot(rand.data,col=colors)</div></pre></td></tr></table></figure>
<p><img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190715101512.png" alt=""></p>
<p>这种功能在绘制热图时很有用。</p>
<h2 id="wesanderson颜色包"><a href="#wesanderson颜色包" class="headerlink" title="wesanderson颜色包"></a><code>wesanderson</code>颜色包</h2><p>可用的颜色有好几个，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&gt; names(wes_palettes)</div><div class="line"> [<span class="number">1</span>] <span class="string">"BottleRocket1"</span>  <span class="string">"BottleRocket2"</span>  <span class="string">"Rushmore1"</span>      <span class="string">"Rushmore"</span>      </div><div class="line"> [<span class="number">5</span>] <span class="string">"Royal1"</span>         <span class="string">"Royal2"</span>         <span class="string">"Zissou1"</span>        <span class="string">"Darjeeling1"</span>   </div><div class="line"> [<span class="number">9</span>] <span class="string">"Darjeeling2"</span>    <span class="string">"Chevalier1"</span>     <span class="string">"FantasticFox1"</span>  <span class="string">"Moonrise1"</span>     </div><div class="line">[<span class="number">13</span>] <span class="string">"Moonrise2"</span>      <span class="string">"Moonrise3"</span>      <span class="string">"Cavalcanti1"</span>    <span class="string">"GrandBudapest1"</span></div><div class="line">[<span class="number">17</span>] <span class="string">"GrandBudapest2"</span> <span class="string">"IsleofDogs1"</span>    <span class="string">"IsleofDogs2"</span></div></pre></td></tr></table></figure>
<p>查看一下，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">wes_palette(<span class="string">"BottleRocket1"</span>)</div></pre></td></tr></table></figure>
<p><img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190715102342.png" alt=""></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">wes_palette(<span class="string">"BottleRocket2"</span>)</div></pre></td></tr></table></figure>
<p><img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190715102408.png" alt=""></p>
<p>看一下使用案例：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">library</span>(<span class="string">"ggplot2"</span>)</div><div class="line">ggplot(mtcars, aes(factor(cyl), fill=factor(vs))) +  geom_bar() +</div><div class="line">  scale_fill_manual(values = wes_palette(<span class="string">"Royal1"</span>))</div></pre></td></tr></table></figure>
<p><img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190715102457.png" alt=""></p>
<p>看一下热图案例：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">pal &lt;- wes_palette(<span class="string">"Zissou1"</span>, <span class="number">100</span>, type = <span class="string">"continuous"</span>)</div><div class="line"><span class="comment"># heatmap is a local dataset</span></div><div class="line">ggplot(heatmap, aes(x = X2, y = X1, fill = value)) +</div><div class="line">  geom_tile() + </div><div class="line">  scale_fill_gradientn(colours = pal) + </div><div class="line">  scale_x_discrete(expand = c(<span class="number">0</span>, <span class="number">0</span>)) +</div><div class="line">  scale_y_discrete(expand = c(<span class="number">0</span>, <span class="number">0</span>)) + </div><div class="line">  coord_equal()</div></pre></td></tr></table></figure>
<p><img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190715102638.png" alt=""></p>
<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><ol>
<li><a href="https://www.cnblogs.com/homewch/archive/2016/07/25/5704153.html" target="_blank" rel="external">R语言配色方案 — RColorBrewer包</a></li>
<li><a href="https://www.cnblogs.com/huzs/p/3742000.html" target="_blank" rel="external">R语言编程入门—replicate()函数比较有意思!</a></li>
<li><a href="https://www.cnblogs.com/xudongliang/p/6932195.html" target="_blank" rel="external">R语言colorRampPalette函数-创建颜色梯度(渐变色)</a></li>
<li><a href="https://www.cnblogs.com/sanmenyi/p/7219574.html" target="_blank" rel="external">R语言可视化—颜色</a></li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2019/07/12/Literature/炎性小体/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/07/12/Literature/炎性小体/" itemprop="url">炎性小体</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-07-12T12:00:00+08:00">
                2019-07-12
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/文献笔记/" itemprop="url" rel="index">
                    <span itemprop="name">文献笔记</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  3,200
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  12
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h2><p>胚系编码的一一些受体，例如NLR，ALR，TRIM在外界刺激（通常是病原体）下，会形成一个更大分子量的复合物，也就是炎性小体，炎性小体会通过ASC来招募促炎性的蛋白，即caspase-1。</p>
<p>炎性小体的大致结构如下所示<sup><a href="#fn_1" id="reffn_1">1</a></sup>:</p>
<p><img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190712153128.png" alt=""></p>
<p>炎性小体的核心结构进而会招募并寡聚化(oligomerize)半胱氨酸蛋白酶caspase-1，其中caspase-1是以丝状的形式存在的，如上图所示，这种丝状的结构会促进caspase-1自身的活化。</p>
<p>ASC蛋白位于中间，它的N端是PYD，C末端是CARD，其中CARD参与caspase-1的相互作用。caspase-1会切除炎症细胞因子IL-1beta与IL-18的前体，将它们释放到细胞外。</p>
<p>炎性小体的活化会诱导细胞的裂解死亡，这种形式称为<strong>焦亡(pyroptosis)</strong>，这是细胞对抗病原体的一种免疫机制。</p>
<p>在天然免疫中，炎性小体是一个重要的组成成分，书中对炎性小体的定义如下所示<sup><a href="#fn_2" id="reffn_2">2</a></sup>：</p>
<blockquote>
<p>By definition, inﬂammasomes are scaffolds for activation of the inﬂammatory cysteine-dependent aspartate-specific protease caspase-1.</p>
</blockquote>
<p>也就是说，炎性小体是一类脚手架蛋白(scaffold)，其功能是参与光胱氨酸依赖的天冬氨酸特异性蛋白酶caspase-1的活化，这种酶活化后参与炎性细胞因子，IL-1beta，IL-18的成熟与分泌， 以及参与焦亡，与焦亡相关的另外一个酶是caspase-11。</p>
<p>pyroptosis是宿主细胞的一种防御机制，它能裂解那些被病原体感染的细胞，从而将病原体暴露出来，与免疫细胞接触。pyroptosis相关的细胞裂解还会释放DAMP，例如IL-1瞢a和HMGB1。</p>
<h3 id="PRRs作为炎性小体的脚手架蛋白"><a href="#PRRs作为炎性小体的脚手架蛋白" class="headerlink" title="PRRs作为炎性小体的脚手架蛋白"></a>PRRs作为炎性小体的脚手架蛋白</h3><p>常见的炎性小体结构如下所示<sup><a href="#fn_2" id="reffn_2">2</a></sup>：</p>
<p><img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190712171054.png" alt=""></p>
<p>NLRP1， NLRP2，NLRP3，NLRP6，NLRC4以及NLRP12它们都含有一个NBD，NBD也被称为NACHT。还含有一个LRR，剩下的要么含有CARD，要么含有PYD。</p>
<p>AIM2与IFI16是PYHIN家族成员，它们都含有PYD与HIN200结构域，这两个结构域参与配体结合<sup><a href="#fn_4" id="reffn_4">4</a></sup>。</p>
<p>其它文献关于它们的结构总结如下所示：</p>
<p><img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190715105613.png" alt=""></p>
<p>其中的缩写如下所示：</p>
<ol>
<li>PYD: Pyrin domain</li>
<li>NLR: nucleotide-binding domain and leucine-rich repeat containing receptors </li>
<li>NACHT：NAIP-CIITA-HET-E domain</li>
<li>NAIP: neuronal apoptosis inhibitor protein</li>
<li>LRR: leucine-rich repeat</li>
<li>NOD: nucleotide-binding oligomerization domain</li>
<li>FIND:‘ Function to find ’ domain</li>
<li>CARD: Caspase recruitment domain</li>
<li>BIR: Baculovirus inhibitor repeat(Baculovirus是杆状病毒)</li>
<li>NLRP: NLR family, pyrin domain containing</li>
<li>NLRC: containing a caspase recruitment domain </li>
<li>NLRB: containing a Baculovirus inhibitor repeat (BIR) domain</li>
<li>Hin200: Hematopoietic interferon-inducible nuclear protein family, 200 amino acid repeat</li>
<li>CC: coiled-coil</li>
</ol>
<p>NLRs（这个s指的是P，C，B，也就是NLRP，NLRB，NLRC这3种炎性小体）这种结构的炎性小体的结构前文已经提及，它含有NACHT/NBD，LRR，这两个组件(NACHT与LRR）通常位于中央。多数的NLRs型炎性小体在氨基端还有BIR，PYD,CARD这些结构。</p>
<p>NLR家族一共有22个人类炎性小体，有34个鼠源炎性小体。</p>
<h2 id="炎性小体功能"><a href="#炎性小体功能" class="headerlink" title="炎性小体功能"></a>炎性小体功能</h2><p>哺乳动物的NLRs有几个阐明功能了，其余的功能还不清楚。其中研究比较透彻的是NOD1和NOD2(nucleotide-binding oligomerization domain containing proteins 1/2)，他们能促进RIPK2与CARD9依赖的NF-kappaB与AP1靶基因的活化。MHC II在抗原提呈中也需要NLR蛋白CIITA的参与。</p>
<p>另一个NLRs亚家族，也就是NLRP1，NLRP3，NLRC4和NAIP通过炎性小体信号转导参与免疫应答。</p>
<p>信号转导诱导PRR的聚集与招募，促进procaspase-1丝状物的成核，随后procaspase-1会经历邻近诱导的自我活化(proximity-induced autoactivation)。</p>
<h2 id="相关细胞因子"><a href="#相关细胞因子" class="headerlink" title="相关细胞因子"></a>相关细胞因子</h2><p>IL-1beta与IL-18的分泌与其它的细胞因子不同，proIL-1beta和proIL-18最先是以非活性的形式（前体）分泌到细胞质中，然后再经caspase-1的切割，形成生物活性形式。</p>
<h2 id="NLRP3"><a href="#NLRP3" class="headerlink" title="NLRP3"></a>NLRP3</h2><p>NLRP3能对大量的激活剂产生应答，它需要NF-kappaB信号的诱导才能活化。NF-kappaB信号是第一信号 （signal 1或priming）。例如NF-kappaB调控物A20/TNFAIP3缺陷的小鼠就无法出现 NLRP3的活化。</p>
<p>signla 2：细菌，真菌的一些成分会诱导NLRP3的活化，除了经典的刺激（细菌成分）诱导 NLRP3炎性小体外，还有一些其它的蛋白能诱导NLRP3的活化，这些属于NLRP3的非经典活化内容，例如人类的caspase-11或它的鼠源直系同源蛋白 caspase-4和caspase-5参与细胞质LPS诱导的NLRP3炎性小体的活化。在这些非经典信号通路中，caspase-11诱导的pyroptosis并不依赖于NLRP3炎性小体 ，但是proIL-1beta与por-IL-18的切割却要通过NLRP3来实现 。在观其NLRP3活化过程中，K+是一种重要的诱导物。</p>
<p>非经典NLRP3炎性小体信号转导通常在格兰氏阴性菌的识别过程中有着重要作用。</p>
<p>pyroptosis的一个关键事件就是Gasdermin D的切割，它的切割与LPS诱导的caspase-11和caspase-1有关。</p>
<p>线粒体膜的破坏，以及线粒体DNA的氧化是NLRP3活化的一个因素。</p>
<p>线粒体异常有时候伴随着离子流的异常，这种行为也会控制NLRP3的活化。心磷脂(cardiolipin)的释放，氧化的线粒体DNA与线粒体膜的破坏都是NLRP3活化的第二信使。最近发现的Nek7是NLRP3活化的一个关键蛋白，它控制K+的流入来影响NLRP3的组装。</p>
<h2 id="NLRP1"><a href="#NLRP1" class="headerlink" title="NLRP1"></a>NLRP1</h2><p>NLRP1是第1个发现的炎性小体，它通常FIIND结构域进行自我切割，FIIND位于CARD与LRR中间。人类有1个NLRP1基因，小鼠有3个，分别是Nlrp1a，Nlrp1b与Nlrp1c。Nlrp1b在Bacillus anthracis的LeTx(lethal toxin)诱导下进行组装。ASC对于Nlrp1b依赖的IL-1beta和IL-18分泌来说并非是必不可少的，只是ASC能够增强这两种细胞因子的分泌。这表明，proaspase-1招募到Nlrp1b平台上后，会诱导caspase-1构象的改变，诱导其活化，而ASC依赖的caspase-1自我切割则会锁定这种活化构象。</p>
<p>炎性小体活化的经典与非经典通路：</p>
<p><img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190713103622.png" alt=""></p>
<h2 id="NLRC4"><a href="#NLRC4" class="headerlink" title="NLRC4"></a>NLRC4</h2><p>NLRC4与其它炎性小体的结构如下所示<sup><a href="#fn_3" id="reffn_3">3</a></sup>：</p>
<p><img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190713104104.png" alt=""></p>
<p>上图列出了NLRC4活化的上游机制，NLRC4在氨基末端有一个CARD，在没有ASC的前提下，NLRC4通过CARD与procaspase-1相互作用。一些微生物能活化NLRC4的活化，例如Salmonella enterica serovar Typhimurium， Legionella pneumophila，Pseudomonas auruginosa，Shigella ﬂ exneri， Listeria monocytogenes），这些细菌的毒力因子都是依赖于鞭毛蛋白(flagellin)介导的运行，会向宿主细胞传递T3SS和T4SS。NLRC4不直接检测这些毒力因子，而是NAIP检测到这些成分后，再作用于NLRC4。人类的全长NAIP与小鼠的Naip5，Naip6是鞭毛蛋白的受体。人类短的NAIP与小鼠的Nip1能识别T3SS的针状蛋白(needle protein)，但Naip2则能与T3SS杆状蛋白(rod protein)结合。S. Typhimurium能诱导NLRC4在Ser533位点的磷酸化，进而活化NLRC4。</p>
<p>在Naip5缺陷的巨噬中，falgellin依赖的NLRC4磷酸化并不依赖地Naip5。这说明，Nlrc4的活化机制分两步，先是在Ser533位点磷酸化，随后，Naip5再诱导NLRC4的活化。NLRC4与天然免疫有关，也与自身免疫性疾病有关。</p>
<h2 id="AIM2"><a href="#AIM2" class="headerlink" title="AIM2"></a>AIM2</h2><p>AIM2全称是absent in melanoma2，这是一个HIN200家族/AIM2家族的一个成员(ALR)。当细菌或病毒来源的dsDNA与Hin200结构域结合时，就会诱发AIM2炎性小体的组装。AIM2会诱导髓系细胞(myeloid cells)产生IL-1beta和IL-18，诱导细胞的pyroptosis。AIM2在控制一些病原体感染方面有着重要作用，例如 Francisella tularensis,Listeria monocytogenes,mouse cytomegalovirus,vaccinia virus。</p>
<h2 id="Pyrin"><a href="#Pyrin" class="headerlink" title="Pyrin"></a>Pyrin</h2><p>人类MEFV基因编码Pyrin/TRIM20蛋白，这是一个TRIM家族的成员。Pyrin主要表达于髓系细胞(myeloid cell)，在单核细胞向巨噬分化过程中，Pyrin的表达会降低。RhoA-inactivating bacterial toxins会诱导Pyrin组装成炎性小体，激活caspase-1，参与IL-1beta的分泌。</p>
<h2 id="炎性小体的组装与信号转导"><a href="#炎性小体的组装与信号转导" class="headerlink" title="炎性小体的组装与信号转导"></a>炎性小体的组装与信号转导</h2><p>ASC依赖的炎性小体的组装过程：</p>
<p><img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190713152009.png" alt=""></p>
<p>上游的NLR或ALR识别其配体后，会通过PYD或CARD聚集，聚集的NLR或ALR会形成一个平台，通过PYD-PYD或CARD-CARD的相互作用来招募ASC，形成一个丝状的核心。其中ASC(CARD)位于外层，它形成另外一个平台，通过CARD-CARD的相互作用来招募caspase-1，高度聚合化折caspase-1会诱导自身的切割，产生活性炎性小体。</p>
<h2 id="Listeria-monocytogenes与炎性小体"><a href="#Listeria-monocytogenes与炎性小体" class="headerlink" title="Listeria monocytogenes与炎性小体"></a>Listeria monocytogenes与炎性小体</h2><p>Lm能激活不同的炎性小体。</p>
<h3 id="NLRP3与Lm"><a href="#NLRP3与Lm" class="headerlink" title="NLRP3与Lm"></a>NLRP3与Lm</h3><p>Lm是第一个发现的能激活NLRP3的病原体。Mariathasan发现，细胞质中的Lm能激活NLRP3炎性小体，但是被囊泡包裹的Lm无法激活炎性小体，这说明被囊泡包裹这一过程对于炎性小体的活化非常重要。Kannengati观察到，Lm的总RNA能刺激NLRP3的活化，这进一步说明，LM能通过各种机制来刺激NLRP3。</p>
<p>胞外的LLO形成的孔洞会诱导K+外流，导入NLRP3炎性小体的活化。除此之外，Lm的RNA，iap基因编码的p60也能激活NLRP3。p60的N端LysM与SH3结构域刺激IL-1beta和IL-18的释放，这些活动独立于细胞的焦亡形式死亡。使用DPI抑制ROS能降低IL-1beta的分泌，但IL-18的分泌不受影响。这些实验是在小鼠细胞上做的。</p>
<p>在人类PBMC实验方面，使用Lm感染PBMC，细胞会经历LLO诱导的NLRP3依赖的炎性小体活化，这种炎性小体一的活化依赖于吞噬泡的西化与cathepsin B的释放，这些现象与小鼠的细胞有所不同。</p>
<p>Lm诱导的快速NRLP3的活化依赖于TLR信号转导，因为MyD88缺陷的细胞无法活化炎性小体。这些应答依赖于MyD88的下游信号分子IRAK1，因此IRAK1缺陷的细胞无法激活炎性小体，以及无法分泌IL-1beta和IL-18。但是，在致敏状态(priming)，IRAK1对于炎性小体的活化又不是必需的。另外，延长感染时间会出现Lm诱导的非NLRP3依赖的炎性小体活化。总之就是，LM在早期感染中激活NLRP3。</p>
<h3 id="NLRC4与Lm"><a href="#NLRC4与Lm" class="headerlink" title="NLRC4与Lm"></a>NLRC4与Lm</h3><p>NRLC4识别鞭毛蛋白(flagellin)与T3SS(Type III secretion system)。</p>
<p>Lm是格兰阳性菌，不含T3SS成分，它的鞭毛蛋白是激活NLRC4的成分。但Lm鞭毛蛋白似乎并非只激活NRLC4，因为使用鞭毛蛋白缺陷菌ΔflaA来感染，也能产生caspase-1的活化以及形成IL-1beta。</p>
<h3 id="AIM2与Lm"><a href="#AIM2与Lm" class="headerlink" title="AIM2与Lm"></a>AIM2与Lm</h3><p>AIM2通常HIN200结构域来识别dsDNA。前面提到，在NLRP3缺失的情况下，鞭毛蛋白缺陷菌ΔflaA也能诱导caspase-1的活化。但在AIM2缺陷的细胞中，caspase-1的活化则会消失。</p>
<p>Lm的DNA激活AIM2。</p>
<h3 id="其它炎性小体"><a href="#其它炎性小体" class="headerlink" title="其它炎性小体"></a>其它炎性小体</h3><p>NLRC5与NLRP3结合参与NLRP3的活化。NLRC5敲除的小鼠感染Lm后，载菌是不是更多，机制不明。NLRP6敲除的小鼠载菌量低，NLRPP6在LM感染方面的作用，不依赖于炎性小体的信号转导。Lm在刺激炎性小体方面的作用，体外数据很好，但是体内数据研究机制不明，其中AIM2有可能与体内相关炎性小体最密切的一个炎性小体。</p>
<p>在体外实验中，虽然LM能激活很多炎性小体，但是在体内感染方面，Lm会避免过度激活炎性小体，从而避免自身被清除，它已经进化出了逃避炎性小体监测的机制。</p>
<p>Lm会通过调控自身LLO，鞭毛蛋白(flagellin)来逃避宿主细胞的监测。</p>
<p>Lm的感染会诱导caspase-11的表达，但是敲除caspase-11后，caspase-1的功能不受影响，这说明caspase-11对于Lm的感染来说是可有可无的。</p>
<p>ASC敲除的异噬细胞无法激活caspase-1，不能分泌IL-1beta和IL-18.</p>
<p>Lm激活与逃避炎性小体监测的机制：</p>
<p><img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190713165831.png" alt=""></p>
<p>Fig1：WT LM能最小程度地激活caspase-1，维持Lm在细胞内的存活，最终形成感染。相比之下，那些能激活炎性小体的Lm会诱导强烈的caspase-1以及pyroptosis，释放IL-1beta和IL-18，最终导致Lm的清除，增强活化巨噬细胞的招募，中性粒细胞的流入。</p>
<p>炎性小体的活化能清除Lm。</p>
<p><img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190713170002.png" alt=""></p>
<p>炎性小体相互关的炎症会损伤宿主针对Lm的细胞免疫。</p>
<p><img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190713170251.png" alt=""></p>
<h2 id="炎性小体研究思路"><a href="#炎性小体研究思路" class="headerlink" title="炎性小体研究思路"></a>炎性小体研究思路</h2><h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><p><sup><a href="#fn_1" id="reffn_1">1</a></sup>:Janeway immunobiology. 9th</p>
<p><sup><a href="#fn_2" id="reffn_2">2</a></sup>:Backert S . Inflammasome Signaling and Bacterial Infections[M]. Springer International Publishing, 2016.<br><sup><a href="#fn_3" id="reffn_3">3</a></sup>: Lamkanfi, M. and Vishva M. Dixit (2014). “Mechanisms and Functions of Inflammasomes.” Cell 157(5): 1013-1022.</p>
<blockquote id="fn_4">
<sup>4</sup>. Inflammasomes in health and disease.Nature. 2012 Jan 18;481(7381):278-86. doi: 10.1038/nature10759.<a href="#reffn_4" title="Jump back to footnote [4] in the text."> &#8617;</a>
</blockquote>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2019/07/11/Literature/支架蛋白与脚手架蛋白/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/07/11/Literature/支架蛋白与脚手架蛋白/" itemprop="url">支架蛋白与脚手架蛋白</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-07-11T12:00:00+08:00">
                2019-07-11
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/文献笔记/" itemprop="url" rel="index">
                    <span itemprop="name">文献笔记</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  812
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  3
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>信号转导通路（Signaling pathway）本身就是一种机制，或者说是一种过程，在这个过程中，一个信号到达细胞后（细胞表面，或者是细胞内部），这个信号就会触发一系列有序的事件（信号转导通路），最终导致细胞内出现一些变化。这些变化通常伴随着基因的表达或者是某些物质浓度的变化，这些事件能够使细胞对某种信号作出反应，并根据当前环境调整细胞自身的代谢活动。</p>
<p>信号转导通路始于某个信号本身，这个信号分子与细胞表面的信号分子受体结合，受体通过大量的不同的蛋白来将信号传递到细胞内部。从本质上来说，衔接蛋白（adaptor protein）与脚手架蛋白（Scaffold protein）都位于前述的这些蛋白集合中，它们负责将信号从受体进一步传递到细胞内部。</p>
<p>衔接蛋白与脚手架蛋白的区别就在于它们的功能和结构上的不同。脚手架蛋白的作用是通过“吸引”大量的，信号转导通路所需的不同蛋白来协调信号转导，这从一点我们可以知道，脚手架蛋白本身比较大。它们本质上是将信号通路中的执行者锭定到一个蛋白复合物中，并将它们定位到特定的位置，从而使信号转导更加有效，脚手架蛋白是发挥一个平台作用，将很多蛋白招募到一起，让它们之间发生相互作用。由于有这种作用，脚手架蛋白还能通过正反馈与负反馈信号来调控信号转导通路，脚手架蛋白还能将特定的蛋白（例如当前活跃的信号通路）从其它不需要的竞争性蛋白复合物中的分离出来。</p>
<p>衔接蛋白（有的译为接头蛋白），即adaptor protein，这种蛋白的分子量相对比较小，它们有助于形成蛋白复合物，但是衔接蛋白通常只与两类蛋白质结合。衔接蛋白通过特定的结构域（通常是SH2和SH3）来与其它蛋白结合，这两个结构域能识别靶蛋白的特定氨基酸序列。衔接蛋白本身可能没有酶活性，但它们会招募那些有功能的蛋白来发挥作用，例如MyD88，Grb2，SHC1等。</p>
<p>我们以脚手架蛋白MEKK1为例说明一下，此蛋白存在于MAPK通路中，此通路会将信号传递到细胞核，调控与细胞周期和细胞分化相关的特定转录因子的表达。而GRB2（生长因子受体结合蛋白2，Growthfactor receptor=bound protein 2）是一种衔接蛋白，它通过SH2结构域与EGF受体结合，并通过SH3结构域吸引此信号通路中下一个蛋白（Sos蛋白）。</p>
<p>MAPK信号通路图片如下所示：</p>
<p>![](<a href="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190712163909.jpg" target="_blank" rel="external">https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190712163909.jpg</a></p>
<p>参考资料</p>
<ol>
<li><a href="https://www.biotechnologyforums.com/thread-3331.html" target="_blank" rel="external">https://www.biotechnologyforums.com/thread-3331.html</a></li>
<li><a href="https://cshperspectives.cshlp.org/content/4/11/a011254.full%22" target="_blank" rel="external">https://cshperspectives.cshlp.org/content/4/11/a011254.full%22</a></li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2019/07/08/BioItem/iTRAQ定量蛋白质组(上)/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/07/08/BioItem/iTRAQ定量蛋白质组(上)/" itemprop="url">iTRAQ定量蛋白质组(上)</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-07-08T12:00:00+08:00">
                2019-07-08
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/生信实战项目/" itemprop="url" rel="index">
                    <span itemprop="name">生信实战项目</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  6,685
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  24
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>这篇笔记是腾讯课堂上的蛋白质组数据分析教程的笔记，教程的全称是<a href="https://ke.qq.com/course/400449" target="_blank" rel="external">《iTRAQ定量蛋白质组》</a>教程中涉及到的蛋白质谱使用的方法是iTRAQ，分析的物种是玉米，虽然与我的方向不一致，但是原理与数据分析的思路都是相通的，这一部分仅是背景知识。</p>
<p>这个视频教程笔记分2篇，上篇主要是蛋白质谱背景知识介绍，以及文献中的常规思路分析。</p>
<p>下篇主要是进行案例训练。</p>
<h2 id="蛋白质组知识背景"><a href="#蛋白质组知识背景" class="headerlink" title="蛋白质组知识背景"></a>蛋白质组知识背景</h2><p>蛋白质组(proteome)：由一个细胞、一个组织或一个机体的基因组所表达的全部相应的蛋白质，是一个整体的概念。</p>
<p>蛋白质组学(proteomics)：以蛋白质组为研究对象，从蛋白质整体水平来认识重合活动规律的科学，是后基因组计划的重要组成部分。</p>
<p>蛋白质组学本质上指的是在大规模水平上研究蛋白质的特征，包括蛋白质的表达水平、翻译后的修饰、蛋白质与蛋白质相互作用等，由此获得蛋白质水平上的关于疾病机理、细胞代谢等过程的整体而全面的认识。</p>
<h3 id="蛋白质组学分类"><a href="#蛋白质组学分类" class="headerlink" title="蛋白质组学分类"></a>蛋白质组学分类</h3><p><img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190709172614.png" alt=""></p>
<p>常用的是非标Label Free，以及标记的iTRAQ分板技术。</p>
<h3 id="定量蛋白组学"><a href="#定量蛋白组学" class="headerlink" title="定量蛋白组学"></a>定量蛋白组学</h3><p>定量蛋白组学：研究不同条件下蛋白表达水平的变化（上下调情况）。</p>
<p><img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190709172748.png" alt=""></p>
<h2 id="iTRAQ知识背景"><a href="#iTRAQ知识背景" class="headerlink" title="iTRAQ知识背景"></a>iTRAQ知识背景</h2><p><strong>iTRAQ</strong>的全称是<strong>Isobaric tag for relative and absolute quantitation</strong>，翻译为中文就是<strong>同重元素标记的相对与绝对定量技术</strong>。这是由AB SCIEX公司研发的一种体外同重同位素标记的相对与绝对定量技术。该技术利用同位素试剂可同时标记8个多肽样品，标记的多肽样品等量混匀后，经液相色谱分离及串联质谱（MS/MS）分析，可得到各肽段的一、二级质谱信息。</p>
<p>在一级质谱中，不同样品来源的同一肽段表现出相同的质荷比；</p>
<p>在二级质谱中，化学键断裂释放出iTRAQ报告离子，在质谱低质量区产生了8个报告离子峰，其强度反应了该肽段在不同样品中的相对表达量信息，另外二级质谱中的肽段碎片离子峰质荷比反应了该肽段的序列信息；这些质谱原始数据经过数据库检索，可得到蛋白质的定性和相对定量信息。</p>
<p>iTRAQ技术在微生物抗协迫机制和动植物发育分化机理研究及医学生物标记物筛选领域都有广泛应用。</p>
<p><strong>iTRAQ</strong>：采用4种或8种同位素标签，通过特异性标记多肽的氨基基团，进行串联质谱分析从而比较不同样本中蛋白质的相对含量，其特点是：</p>
<ul>
<li><p>蛋白通量高，覆盖度高；</p>
</li>
<li><p>定量准确，可信度高；</p>
</li>
<li><p>分离能力强、分析范围广，定性结果可靠；</p>
</li>
<li><p>自动化程度高、分析时间快，分离效果好。</p>
</li>
</ul>
<h2 id="定量蛋白质组原理"><a href="#定量蛋白质组原理" class="headerlink" title="定量蛋白质组原理"></a>定量蛋白质组原理</h2><h3 id="iTRAQ试剂"><a href="#iTRAQ试剂" class="headerlink" title="iTRAQ试剂"></a>iTRAQ试剂</h3><ul>
<li>iTRAQ试剂是可与氨基酸末端及赖氨酸侧链连接的胺标记的同位素元素；</li>
<li>iTRAQ试剂由三部分组成：报告基团、质量平衡基团和肽反应标记试剂基团；</li>
<li>报告基因：常见4标或8标，可同时标记4组或8组样品，报告基团有8种分子量，范围从113到121（无120）；</li>
<li>平衡基因：保证iTRAQ标记的同一肽段的质荷比相同，平衡基团也8有种不同的分子量，与不同的报告基团搭配，能保证被标记的不同来源的同一肽段在一级质谱中具有相同的质荷比，就是下图中右侧的部分，在上图，也就是a图中，它们的荷质比都是145.10，在下图，也就是b图中，荷质比都是305.10；</li>
<li>肽反应标记基团：可与肽段N端及辣氨酸侧链发生共价连接，从而标记上肽段。</li>
</ul>
<p>这几个试剂的结构如下所示：</p>
<p><img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190709185729.png" alt=""></p>
<p>（图片来源于：Aggarwal S., Yadav A.K. (2016) Dissecting the iTRAQ Data Analysis. In: Jung K. (eds) Statistical Analysis in Proteomics. Methods in Molecular Biology, vol 1362. Humana Press, New York, NY,277）</p>
<h3 id="iTRAQ的实验流程原理"><a href="#iTRAQ的实验流程原理" class="headerlink" title="iTRAQ的实验流程原理"></a>iTRAQ的实验流程原理</h3><p>在质谱峰图中，虽然不同样本带有不同的同位素标签，但是经过质量平衡基因的平衡，任何一种试剂标记不同样本中的同一蛋白多肽表现为相同的质荷比，从而形成单一的峰。</p>
<p>在串联质谱结果中，经过激光通量轰击肽段，iTRAQ试剂的三部分之间的键断裂，平衡基因断裂，平衡基团丢失，不同同位素标签的同一多肽的离子信号表现为不同质荷比的峰，因此可根据波峰的高度和面积比较同一蛋白不同处理的定量信息，如下所示：</p>
<p><img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190709190427.png" alt=""></p>
<p>（图片出处为：Aggarwal S., Yadav A.K. (2016) Dissecting the iTRAQ Data Analysis. In: Jung K. (eds) Statistical Analysis in Proteomics. Methods in Molecular Biology, vol 1362. Humana Press, New York, NY，P278）</p>
<p>一级质谱：</p>
<p>二级质谱：</p>
<h4 id="常规实验流程"><a href="#常规实验流程" class="headerlink" title="常规实验流程"></a>常规实验流程</h4><p><img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190709184551.jpg" alt=""></p>
<h4 id="实验流程如下所示："><a href="#实验流程如下所示：" class="headerlink" title="实验流程如下所示："></a>实验流程如下所示：</h4><p><img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190709185226.png" alt=""></p>
<p>第一步：蛋白酶解样本，也就是将蛋白样本酶解为肽段；</p>
<p>第二步：使用iTRAQ同位素标记，也就是使用不同的iTRAQ标签来标记不同的肽段样本；</p>
<p>第三步：SCX预分级，使用强阳离子交换SCX（HPLC）将肽段分为多个组分；</p>
<p>第四步：使用LC-MS对每个组分进行质谱检测。</p>
<h4 id="质谱仪的组成部分"><a href="#质谱仪的组成部分" class="headerlink" title="质谱仪的组成部分"></a>质谱仪的组成部分</h4><p>蛋白质谱的核心就质谱，原理就是样本在特定条件下转变为高速运动的离子，根据离子质荷比的不同在静电场和磁场作用下进行分离，再用特定检测器记录不同质荷比的各离子的相对强度并形成质谱图。</p>
<h5 id="质谱仪"><a href="#质谱仪" class="headerlink" title="质谱仪"></a>质谱仪</h5><p><strong>质谱仪</strong>：在真空状态下分析离子的质荷比m/z，质谱仪主要是由离子源、质量分析器和离子检测器组成，iTRAQ技术中常用LC-MS/MS，液相色谱串联质谱。</p>
<ul>
<li><p>离子源：将蛋白或多肽变成气态的带电离子，常用的有2类：①电喷雾电泳ESI；②基质辅助激光解吸电离MALDI（脉冲方式使用样本离子化0；</p>
</li>
<li><p>质量分析器：将离子源形成的离子按质荷比大小分开：常见有的5类：①四级杆(Quadrupole)；②离子阱(Ion trap)；③飞行时间(TOF)；④傅里叶(FTICR)；⑤轨道阱(Qrbitrap)。</p>
</li>
</ul>
<p>质量分析器的参数</p>
<p>质量分析器的质量范围是指测定质荷比范围，它决定了能检测到的离子范围，例如ESI离子源可产生许多质荷比大于3000的离子，但是如果质量分析器的上限达不到3000，则就无法检测大于3000的离子。</p>
<p>分辨率：观测到的质谱峰的质荷比/半峰高处的峰宽(FWHM)。</p>
<h4 id="不同类型质量分析器的比较"><a href="#不同类型质量分析器的比较" class="headerlink" title="不同类型质量分析器的比较"></a>不同类型质量分析器的比较</h4><p>不同质量分析器有不同的分辨率，其中傅里叶&gt;轨道阱&gt;时间飞行&gt;离子阱&gt;四级杆，具体的参数如下所示：</p>
<p><img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190717184549.png" alt=""></p>
<p>市场上不同型号质谱仪的比较：</p>
<p><img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190717184735.png" alt=""></p>
<p>其中在使用iTRAQ分析时，比较常用的是Thermo的Q-Exactive与Q-Exactive HF。</p>
<ul>
<li><p>离子检测器：①直接检测器；②电子倍增器；③闪烁检测器。</p>
</li>
<li><p>液相色谱LC：利用物质在流动相和固定相中的分配系数差异，进行分离检测。</p>
</li>
<li><p>质谱MS：把不同质荷比的离子分开排列成谱。</p>
</li>
</ul>
<h2 id="实验方案设计"><a href="#实验方案设计" class="headerlink" title="实验方案设计"></a>实验方案设计</h2><p>教学视频中的案例是植物方向，其实原理跟动物方向一样的，以下的都是植物蛋白质谱的实验设计。</p>
<h3 id="方案设计-生物学重复"><a href="#方案设计-生物学重复" class="headerlink" title="方案设计-生物学重复"></a>方案设计-生物学重复</h3><ol>
<li>至少设置3个以上的生物学重复；</li>
<li>为了增加实验结果的可靠性，可通过增加质谱的技术重复上机次数；</li>
<li>严谨的实验通常进行3次生物学重复和3次技术重复，也就是一共9批MS数据；</li>
<li>出于经费考虑，有的文献也只进行2-3次技术重复（在动物实验方面，技术重复就是同一个样本上3针质谱即可）。</li>
</ol>
<h3 id="方案设计-不同组样本的标记选择和上机组合"><a href="#方案设计-不同组样本的标记选择和上机组合" class="headerlink" title="方案设计-不同组样本的标记选择和上机组合"></a>方案设计-不同组样本的标记选择和上机组合</h3><h4 id="两组样品"><a href="#两组样品" class="headerlink" title="两组样品"></a>两组样品</h4><p>常见的组合包括2组，3组，4组，5组，6组样本，现在以植物干旱无罪推定研究为例说明一下。</p>
<p>假设我们有2组样本，对照组这里用CK表示，它表示正常浇水；实验组使用Treatment不胜感激，它表示不浇水3天，现在有2个方案：</p>
<p>第一个方案：每组2个生物学重复，1个3标；</p>
<p>第二个方案：第组3个生物学重复，1个6标，如下所示：</p>
<p><img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190717185946.png" alt=""></p>
<h4 id="三组样本"><a href="#三组样本" class="headerlink" title="三组样本"></a>三组样本</h4><p>现在将实验扩展一下，我们使用3组：</p>
<p>对照组：CK，正常浇水；</p>
<p>干预组不浇水，包括2组：</p>
<p>不浇水3天：T1</p>
<p>不浇水6天：T2</p>
<p>第一个方案：每组两个生物学重复，1个6标；</p>
<p>第二个方案：每组3个生物学重复，3个4标或1个9标，如下所示：</p>
<p><img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190717190254.png" alt=""></p>
<h4 id="四组样本"><a href="#四组样本" class="headerlink" title="四组样本"></a>四组样本</h4><p>对照组：CK，正常浇水</p>
<p>处理组：Treatment</p>
<p>不浇水3天：T1</p>
<p>不浇水6天：T2</p>
<p>不浇水9天：T3</p>
<p>方案一：每组2个生物学重复，1个8标；</p>
<p>方案二：每组3个生物学重复，3个4组，如下所示：</p>
<p><img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190717190615.png" alt=""></p>
<h4 id="五组样本"><a href="#五组样本" class="headerlink" title="五组样本"></a>五组样本</h4><p>对照组：CK，正常浇水</p>
<p>处理组：Treatment</p>
<p>不浇水1天：T1</p>
<p>不浇水2天：T2</p>
<p>不浇水3天：T3</p>
<p>不浇水4天：T4</p>
<p>方案一：每组3个生物学重复，3个5标；</p>
<p>方案二：每组3个生物学重复，3个6标，如下所示：</p>
<p><img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190717190812.png" alt=""></p>
<h4 id="六组样本"><a href="#六组样本" class="headerlink" title="六组样本"></a>六组样本</h4><p>对照组：CK，正常浇水</p>
<p>处理组：</p>
<p>不浇水1天：T1</p>
<p>不浇水2天：T2</p>
<p>不浇水3天：T3</p>
<p>不浇水4天：T4</p>
<p>不浇水5天：T5，如下所示：</p>
<p><img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190717190946.png" alt=""></p>
<h3 id="实验方案小结"><a href="#实验方案小结" class="headerlink" title="实验方案小结"></a>实验方案小结</h3><ul>
<li>需要比较的差异分组放在同一组标记中；</li>
<li>不同组织部位不要放在一组标记中检测；</li>
<li>生物学重复可分批上机，此时可不需要内参；</li>
<li>可将所有样本混合作为内参，分析时可通过内参间接找到有无变化的蛋白质。</li>
</ul>
<h1 id="蛋白数据分析流程"><a href="#蛋白数据分析流程" class="headerlink" title="蛋白数据分析流程"></a>蛋白数据分析流程</h1><p>iTRAQ定量蛋白组数据分析流程如下所示：</p>
<p><img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190717191336.png" alt=""></p>
<p>从质谱仪上拿到的数据是原始质谱数据，然后要将原始数据进行一个数据格式转换，数据转换后，要进行搜库来鉴定蛋白质，这一步是要看找到了多少个蛋白质，随后对找到的蛋白进行蛋白定量。</p>
<p>定量后就是各种分析，包括GO，KEGG，蛋白相互作用等。</p>
<h3 id="一-搜库"><a href="#一-搜库" class="headerlink" title="[一]搜库"></a>[一]搜库</h3><p><code>搜库</code>是指通过实验得到的谱图与数据库中的理论谱图进行匹配，得到可能的肽段序列，从而鉴定蛋白质，进行搜库的操作就是将质谱仪得到的谱图输入到搜库软件，常用的搜库软件包括：</p>
<ul>
<li>ProteinPilot(AB SCIEX)</li>
<li>Proteome Discoverer(Thermo scientific)</li>
<li>Mascot（这个软件是上述2个软件的核心）</li>
</ul>
<p>数据的产生其实就是：<code>蛋白-&gt;肽段-&gt;谱图</code>；而数据分析就是这个过程的逆过程，即<code>谱图-&gt;肽段-&gt;蛋白</code>。</p>
<p>整个流程如下所示：</p>
<p><img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190717191954.png" alt=""></p>
<h4 id="搜库的原理"><a href="#搜库的原理" class="headerlink" title="搜库的原理"></a>搜库的原理</h4><p>搜库软件运行的主要步骤包括：</p>
<ol>
<li>从数据库中选择分子量与输入值相等的肽段；</li>
<li>形成理论碎片，并进一步生成理论谱图；</li>
<li>将实验谱图与理论谱图进行匹配；</li>
<li>对匹配进行打分；</li>
<li>按打分进行排序，通过统计学分析，确定最佳的匹配结果并导出。</li>
</ol>
<p>流程示意图如下所示：</p>
<p><img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190717192309.png" alt=""></p>
<h4 id="搜库数据库的选择"><a href="#搜库数据库的选择" class="headerlink" title="搜库数据库的选择"></a>搜库数据库的选择</h4><p>数据库的选择是基于质谱数据的蛋白质鉴定策略中的重要一步，最终鉴定到的蛋白序列都来源于被选择的数据库。</p>
<ul>
<li>如果是已经测序的生物，直接选用该物种蛋白数据库(NCBI)，或同批样本转录组数据构建的蛋白库。</li>
<li>如果是非测序生物，则选择与被测样本最为相关的大类蛋白质组数据库；</li>
<li>NCBInr分类库，包括动物全库、植物全库、微生物全库、细菌全部库等。</li>
<li>SwissProt/UniProt分类库，动物全库、植物全库、微生物全库、细菌库等。</li>
</ul>
<h4 id="蛋白质谱鉴定的结果"><a href="#蛋白质谱鉴定的结果" class="headerlink" title="蛋白质谱鉴定的结果"></a>蛋白质谱鉴定的结果</h4><p>定量蛋白质鉴定数目一般在几千左右，远少于转录组检测的表达的基因数目和参考基因组的基因数目，如下所示：</p>
<p><img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190717192758.png" alt=""></p>
<p>右上图是根据分析量来确定的蛋白数据，右下图是根据肽段来确定的鉴定的蛋白数目。蛋白鉴定的数目跟转录鉴定的基因不在一个数量级上，这是因为蛋白质谱在实验的通量，数据库，实验技术方面都有一定的局限。</p>
<h3 id="二-蛋白质功能注释"><a href="#二-蛋白质功能注释" class="headerlink" title="[二]蛋白质功能注释"></a>[二]蛋白质功能注释</h3><p>通过搜库对蛋白质进行鉴定后，接着就是对这些搜到的蛋白进行功能注释，这有助于了解蛋白的功能，从而解析样本相关表型，常用于功能注释的数据库有：GO、COG、KEGG、NR、Pfam、Swiss-Prot，下图是一个玉米的项目，玉米的蛋白在各个数据库中的注释结果：</p>
<p><img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190717193450.png" alt=""></p>
<h4 id="数据库介绍"><a href="#数据库介绍" class="headerlink" title="数据库介绍"></a>数据库介绍</h4><h5 id="NR"><a href="#NR" class="headerlink" title="NR"></a>NR</h5><p>全称是Non-redundant protein sequences，包含GenBank所有编码序列，以及PDB，swissprot，PIR，PRF数据库的所有编码序列的一个非冗余数据库，其数据库完整度高；这是一个氨基酸序列数据库。</p>
<h5 id="Pfam"><a href="#Pfam" class="headerlink" title="Pfam"></a>Pfam</h5><p>全称是Protein families database，通过蛋白序列的比对建立了每个家族的氨基酸序列的HMM统计模型，是最全面的蛋白结构域注释的分类系统；通过识别蛋白质的结构域序列，可以预测蛋白质的功能。</p>
<h5 id="Swiss-Prot"><a href="#Swiss-Prot" class="headerlink" title="Swiss-Prot"></a>Swiss-Prot</h5><p>这是上EBI维护的数据库，主要收录人工注释的序列及其相关文献信息和经过计算机辅助分析的序列；注释结果包括对蛋白质功能、酶学特性、剪接异构体、相关疾病信息的注释等待，注释结果无冗余。</p>
<h5 id="COG"><a href="#COG" class="headerlink" title="COG"></a>COG</h5><p>全称是Clusters of Orthologous Groups of proteins，这是一个蛋白质直系同源数据库。通过对菌类，藻类和真核生物等66个完整基因组的编码蛋白，根据系统进化关系构建而成。这对于预测单个蛋白的功能和整个基因组中蛋白质的功能具有重要的作用。</p>
<h5 id="GO与KEGG"><a href="#GO与KEGG" class="headerlink" title="GO与KEGG"></a>GO与KEGG</h5><p>常见，不介绍。</p>
<h3 id="三-定量"><a href="#三-定量" class="headerlink" title="[三]定量"></a>[三]定量</h3><h4 id="蛋白定量原理回顾"><a href="#蛋白定量原理回顾" class="headerlink" title="蛋白定量原理回顾"></a>蛋白定量原理回顾</h4><p>先来了解一下iTRAQ蛋白质定量的原理，如下所示：</p>
<ul>
<li>iTRAQ试剂是等量的，因此不同同位素在标记同一多肽后在一级质谱检测中，分子量完全相同。</li>
<li>在一级质谱检测到前体离子后进行碰撞诱导解离，产物离子通过二级质谱进行分析。</li>
<li>在二级质谱中，报告基团、质量平衡基团和多肽反应基团之间的键断裂，质量平衡基团丢失，产生低质荷比(m/z)的报告离子。</li>
<li>由于二级质谱可分析相对分子质量相差为1的报告基团，不同报告基团离子强度的差异就代表了它所标记的多肽相对丰度。</li>
<li>多肽内的酰胺键断裂，形成一系列b离子和y离子，得到离子片段的质量数，通过搜库就可以鉴别出相应蛋白质。</li>
</ul>
<p><img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190717195201.png" alt=""></p>
<h4 id="蛋白定量分析工具"><a href="#蛋白定量分析工具" class="headerlink" title="蛋白定量分析工具"></a>蛋白定量分析工具</h4><ul>
<li>常用的软件前面已经提了，包括：IQuant(BGI), ProteinPilot(AB SCIEX)、Proteome Discoverer(Thermo scientific)</li>
<li><a href="https://onlinelibrary.wiley.com/doi/full/10.1002/pmic.201300361" target="_blank" rel="external">IQuant</a>：整合了Mascot算法，采用机器学习算法自动对搜索结果进行重新打分，提高结果的鉴定率。</li>
</ul>
<p>核心的值有3个：</p>
<ol>
<li>在谱图/肽段水平进行1%FDR的过滤(PSM-level PDF&lt;=0.01)，获得显性性鉴定的谱图和肽段列表。</li>
<li>基于<strong>简约原则</strong>(the parsimony principle)， 利用肽段进行蛋白组装，并生产一系列的蛋白组。</li>
<li>在蛋白质水平以FDR 1%再次进行过滤(Protein-level FDR&lt;=0.01)，以控制蛋白的假阳性。</li>
</ol>
<p>IQuant的工作流程为：</p>
<p><code>蛋白质过滤 --&gt; 报告基团标签纯度校正 --&gt; 定量值归一化 --&gt; 缺失值补全 --&gt; 蛋白定量值计算 --&gt; 统计检验</code>。</p>
<h3 id="四-差异蛋白筛选"><a href="#四-差异蛋白筛选" class="headerlink" title="[四]差异蛋白筛选"></a>[四]差异蛋白筛选</h3><p>对蛋白进行定量后，需要对蛋白的差异进行筛选，筛选的内容包括3个，如下所示：</p>
<ul>
<li>根据实验设计来设置差异分析，例如<code>A_VS_B</code>；</li>
<li>显示差异蛋白选择的阈值，Fold Change &gt; 1.2或1.5和Q-value &lt; 0.05；</li>
<li>统计学方法：t-test或ANOVA。</li>
</ul>
<p>现在来看一个差异计算后的结果：</p>
<p><img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190717200544.png" alt=""></p>
<p>第1列是蛋白名称；</p>
<p>第2列到第4列是3个生物学重复；</p>
<p>第5列与第6列是FC与pvalue。</p>
<h3 id="五-富集分析"><a href="#五-富集分析" class="headerlink" title="[五]富集分析"></a>[五]富集分析</h3><p>富集分析常见的就是GO分析与KEGG分析，不介绍。</p>
<h3 id="六-表达聚类和蛋白互作"><a href="#六-表达聚类和蛋白互作" class="headerlink" title="[六]表达聚类和蛋白互作"></a>[六]表达聚类和蛋白互作</h3><p>表达聚类分析的核心就是热图与聚类图，不介绍。</p>
<p>蛋白相互作用通常使用的数据库是STRING数据库，它能分析预测差异蛋白质之间的互作关系，这个数据库的主要信息如下</p>
<ul>
<li>STRING是一个搜索已知蛋白之间和预测蛋白之间相互作用系统的数据库，包括蛋白质直接物理的相互作用，也包括蛋白质之间间接功能相关性；</li>
<li>数据包括：实验数据、从PubMed摘要中挖掘结果，利用生物信息学方法预测的结果；</li>
<li>通过打分对不同方法得来的结果给予一定权重，得到综合打分，且可根据打分结果绘制蛋白相互作用网络图，它的网络图如下所示：</li>
</ul>
<p><img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190717201930.png" alt=""></p>
<h2 id="案例解析"><a href="#案例解析" class="headerlink" title="案例解析"></a>案例解析</h2><p>先来看一篇文献，文献内容如下所示：</p>
<p>Liancheng Wu, Shunxi Wang, Lei Tian, Liuji Wu, Mingna Li, Jun Zhang, Pei Li, Weiqiang Zhang, Yanhui Chen<br>Comparative proteomic analysis of the maize responses to early leaf senescence induced by preventing pollination,Journal of Proteomics,Volume 177,2018,Pages 75-87,ISSN 1874-3919.</p>
<h3 id="研究背景"><a href="#研究背景" class="headerlink" title="研究背景"></a>研究背景</h3><p>玉米是一种一年生作物，叶片衰老的过早或过晚都可能会影响产量，在成熟后期，营养物质的再活化受到负面影响，导致幼叶的光合作用受损和系列能力下降，相反，过早的叶片衰老则阻碍了植物生长并降低其CO2的同化能力。叶片衰老是一个高度调控的过程，由几个称为衰老相关基因(SAGs)的基因介导，然后在蛋白质水平上仅鉴定了少数SAG。目前，使用蛋白质组学分析全体蛋白质波动比功能分析的转录组学更有效，因为蛋白质与功能更直接相关。本研究的目的是，研究玉米阻断授粉诱导叶片衰老过程中蛋白质的全局差异积累和代谢物质的变化。</p>
<h4 id="叶片衰老的生理特征"><a href="#叶片衰老的生理特征" class="headerlink" title="叶片衰老的生理特征"></a>叶片衰老的生理特征</h4><p>叶片衰老通常与植物衰老以及开花和种子形成有关。叶色也与叶片衰老有关，是植物重合周期阶段的可见指标。叶片衰老时会出现一系列的生理过程，包括叶绿素分解、光合作用停止、蛋白质和核酸降解、分解代谢和营养物质的运输，以及细胞死亡反应，从而导致营养物质再循环到新发育的营养器官和生殖器官。</p>
<h4 id="分子机制研究进展"><a href="#分子机制研究进展" class="headerlink" title="分子机制研究进展"></a>分子机制研究进展</h4><p>叶片衰老可以通过许多环境和内源信号来调节，包括年龄、发育信号和植物生长调节剂。植物激素与植物中的各种生物过程（包括叶片衰老）相关，如外源施用脱落酸(ABA)可促进叶片衰老，内源ABA水平在几种植物叶片衰老后增加。</p>
<p>水杨酸(SA)是另一种对叶片衰老正调控的植物激素，而生长素、细胞分裂素和赤霉素对叶片衰老有负调控作用。</p>
<p>糖代谢是与叶片衰老相关的另一因素，如糖类直接应用于拟南芥的叶细胞会导致早衰。</p>
<h4 id="表型分析－糖"><a href="#表型分析－糖" class="headerlink" title="表型分析－糖"></a>表型分析－糖</h4><p>实验材料：授粉(POL)和不授粉(NPNPOL)的玉米自交系Yu816。</p>
<p>发育时间：吐丝扣6天到21天(DAS)。</p>
<p>参数检测：叶片的可溶性糖含量和淀粉含量。</p>
<p>分析结果：</p>
<p>可溶性糖，6-18 DAS两种材料中均增加；21 DAS和POL中稍微下降，而NONPL的大量下降。</p>
<p>淀粉：趋势与可溶性糖类似，数据如下所示：</p>
<p><img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190717203730.png" alt=""></p>
<h4 id="表型分析-叶片形态和叶绿素分析"><a href="#表型分析-叶片形态和叶绿素分析" class="headerlink" title="表型分析-叶片形态和叶绿素分析"></a>表型分析-叶片形态和叶绿素分析</h4><ul>
<li><p>穗叶和上部的叶片；</p>
</li>
<li><p>两组材料在6-14 DAS时一样保持绿色。</p>
</li>
<li><p>NONPOL组，18 DAS时叶脉积累红色色素，尖端变黄且干燥；21 DAS时穗叶的三分之二变黄；27 DAS时叶片完全干燥。</p>
</li>
<li><p>POL组，仅在27 DAS时表现出轻微黄色。</p>
</li>
<li><p>叶绿素含量：</p>
</li>
<li><p>NONPOL组，穗叶尖端在6-27 DAS显著下降（相对中部和基部），而同时POL组只是稍微一些辞职。</p>
</li>
<li><p>相同的趋势也发生在穗叶的中部和基部。</p>
</li>
<li><p>在两组中Chl含量随着发育而下降，但是NONPOL组比POL组下降得更快，数据如下所示：</p>
</li>
</ul>
<p><img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190717204222.png" alt=""></p>
<h3 id="iTAAQ蛋白组实验设计"><a href="#iTAAQ蛋白组实验设计" class="headerlink" title="iTAAQ蛋白组实验设计"></a>iTAAQ蛋白组实验设计</h3><p>样本数目：7组样本，8标，每个3个生物学重复</p>
<p>实验材料：玉米自交系Yu816</p>
<p>实验处理：授粉(POL)、不授粉(NONPOL)</p>
<p>取样部位：叶片</p>
<p>取样时间点：吐丝后6天(DAS)、14天、18天和21天</p>
<p>生物学重复：3个</p>
<p>方法与仪器：iTRAQ、LC-MS/MS(Thermo Fisher Scientific, Q-exactive)</p>
<p>流程如下所示：</p>
<p><img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190717204548.png" alt=""></p>
<h3 id="蛋白质组整体分析"><a href="#蛋白质组整体分析" class="headerlink" title="蛋白质组整体分析"></a>蛋白质组整体分析</h3><p>文章的附件中列出了蛋白质谱的一些数据，得到了959464个广谱，其中150650匹配上肽段谱图，通过Mascot软件匹配上已知多肽，且28605个匹配上唯一多肽。</p>
<p>鉴定了6941个蛋白，其中4371个唯一蛋白时至少有两个以上肽段匹配的，数据如下所示：</p>
<p><img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190717205151.png" alt=""></p>
<h3 id="筛选差异蛋白分析"><a href="#筛选差异蛋白分析" class="headerlink" title="筛选差异蛋白分析"></a>筛选差异蛋白分析</h3><ul>
<li>文献中使用了ANOVA来筛选差异蛋白(DAP)，其中阈值为：FC大于1.2或小于0.83(0.83其实就是1.2的倒数)，p值小于0.05。</li>
<li>POL组有700个显著差异积累的蛋白，NONPOL组有1832个；</li>
<li>其中261中仅在POL中显著积累，1393个只在NONPOL组中显著积累，而439个在两组均显著积累；</li>
<li>分析不同时间诱导的衰老：A1 VS B1， A2 vs B2， A3 VS B3；1443个显著差异积累，其中809个仅在NONPOL中显著差异积累，然后进一步分析在14 DAS、18 DAS和21 DAS的做好心理情况下，以及上下调情况；</li>
<li>通过比较本研究和之前文献报告的玉米自交系B73阻断授粉诱导衰老的转录组研究，发现两个数据集仅有154个重叠的基因，这说明在Yu816中有着相对不同的调控机制：</li>
</ul>
<p><img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190717205707.png" alt=""></p>
<h3 id="差异蛋白功能分析—GO和KEGG分析"><a href="#差异蛋白功能分析—GO和KEGG分析" class="headerlink" title="差异蛋白功能分析—GO和KEGG分析"></a>差异蛋白功能分析—GO和KEGG分析</h3><ul>
<li>对NONPOL组809个DAP进分别进行GO和KEGG分析，使用cytoscape、Cluego和Cluepedia软件绘制GO注释和KEGG网络图；</li>
<li>通过评分得到65条边连接的36个Term， 表明在鉴定的蛋白质相互作用组中相当多的富集(P&lt;0.05)；</li>
<li>显著富集的Term：光合作用、光合作用光系统II、生长素生物合成过程、JA代谢过程、器官衰老、络氨酸代谢、脯氨酸生物合成过程；</li>
<li>从亚细胞定位角度来看，显著宝座的蛋白主要定位于叶绿体、光合体系、过氧化酶体和核糖体，如下所示：</li>
</ul>
<p><img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190717210255.png" alt=""></p>
<h3 id="差异蛋白表达分析"><a href="#差异蛋白表达分析" class="headerlink" title="差异蛋白表达分析"></a>差异蛋白表达分析</h3><p>表达分析的核心就是热图与聚类。</p>
<ul>
<li>在诱导叶片衰老过程中，大多数核糖体蛋白质丰度下降，包括50S核糖体蛋白L5-1(B6SST7)， 其在14 DAS时稍微下降了0.98倍，在18 DAS时下降了0.8倍，但在21 DAS下降到了0.6。</li>
<li>NONPOL组蛋白酶丰度增加，如光胱氨酸蛋白酶1(B6TGM9)在14 DAS增加1.09倍，在18 DAS时增加1.43位，21 DAS时增加到了2.89倍。</li>
<li>在差异积累的蛋白质中，29种与光合作用有关，并且大部分光合作用相关蛋白丰度减少，例如PSII反应中心蛋白H(P24993)在14 DAS时减少了1.00倍，在18 DAS时为0.72倍，在21 DAS时为0.46倍，如下所示：</li>
</ul>
<p><img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190717210704.png" alt=""></p>
<ul>
<li>糖代谢相关的蛋白质在NONPOL组中丰度增加，如淀粉合酶，和叶绿体/淀粉体蛋白（B6U167)在14 DAS时半圆了0.98倍，在18 DAS时增加了1.18倍，21 DAS的1.65倍；</li>
<li>参与ROS过程的蛋白质，抗氧化蛋白质在诱导叶片衰老过程中丰度降低了，例如铁氧还原蛋白(Q6JAD2)在14 DAs时减少了0.84位，在18 DAS时减少了0.76倍，在21 DAS时减少了0.55倍；</li>
<li>但是氧化蛋白质各类如脂氧合酶(Q8W0V2)在14 DAS时增加了0.87倍，在18 DAS时增加了1.78倍，在21 DAS时增加了2.26倍；</li>
<li>ABA响应蛋白(B6U8P6)在14 DAS时增加了0.88倍，在18 DAS时增加了1.32倍，在21 DAS时增加了1.5倍；但与生长素和赤霉素相关的蛋白质丰度降低，数据如下所示：</li>
</ul>
<p><img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190717211150.png" alt=""></p>
<p>文章最后使用WB进行验证，测序类文章中基本上都要有验证，这一部分略去不表。</p>
<p>文章到此就结束了，整个文献的数据分析思路如下所示：</p>
<p><img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190717211539.png" alt=""></p>
<p>简化一下就是下图：</p>
<p><img src="https://pic-1256416512.cos.ap-chengdu.myqcloud.com/img/20190717211604.png" alt=""></p>
<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><ol>
<li><a href="http://www.fitgene.com/fuwu/danbaizhizuxue/iTRAQ.html" target="_blank" rel="external">iTRAQ标记定量蛋白质组学.辉骏生物</a></li>
<li><a href="https://zhuanlan.zhihu.com/p/28203867" target="_blank" rel="external">iTRAQ(稳定同位素标记蛋白质组学技术)</a></li>
<li><a href="https://sciex.com/products/consumables/itraq-reagent" target="_blank" rel="external">iTRAQ® Reagents</a></li>
<li><a href="iTRAQ/TMT.MtoZ Biolabs Experit in Mass Spectrometry Analysis">iTRAQ/TMT.MtoZ Biolabs Experit in Mass Spectrometry Analysis</a></li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/2/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span><a class="page-number" href="/page/4/">4</a><span class="space">&hellip;</span><a class="page-number" href="/page/22/">22</a><a class="extend next" rel="next" href="/page/4/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">RVDSD</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">217</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">12</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">107</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          <div class="links-of-author motion-element">
            
          </div>

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

<div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">RVDSD</span>

  
</div>



<div class="powered-by">
<i class="fa fa-user-md"></i><span id="busuanzi_container_site_pv">
  本站访客数:<span id="busuanzi_value_site_uv"></span>
</span>
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>


<div class="BbeiAn-info">
	<a target="_blank" href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=41018102000118" style="color:#909090;text-decoration:none;padding-left:0px;no-repeat left center" rel="nofollow">豫公网安备 41018102000118</a>	  <!--这里将图标作为了背景，以使得能和后面的文字在同一行-->
</div>

  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.3</div>




<div class="theme-info">
  <div class="powered-by"></div>
  <span class="post-count">博客全站共859.6k字</span>
</div>

        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.3"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.3"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.3"></script>



  


  




	





  





  












  





  

  

  
  

  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config("");
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="custom_mathjax_source">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->
  


  

  

</body>
</html>
