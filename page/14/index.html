<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.3" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.3">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.3" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta property="og:type" content="website">
<meta property="og:title" content="RVDSD的个人笔记本">
<meta property="og:url" content="http://rvdsd.top/page/14/index.html">
<meta property="og:site_name" content="RVDSD的个人笔记本">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="RVDSD的个人笔记本">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.3',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://rvdsd.top/page/14/"/>





  <title>RVDSD的个人笔记本</title><!-- hexo-inject:begin --><!-- hexo-inject:end -->
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">RVDSD的个人笔记本</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">学习过程中的输出</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2017/07/04/Experiment/病毒包装笔记(4)-质粒的提取与测序/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/07/04/Experiment/病毒包装笔记(4)-质粒的提取与测序/" itemprop="url">病毒包装笔记(4)-质粒的提取与测序</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-07-04T12:00:00+08:00">
                2017-07-04
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/生物实验笔记/" itemprop="url" rel="index">
                    <span itemprop="name">生物实验笔记</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  1,724
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  6
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="实验原理"><a href="#实验原理" class="headerlink" title="实验原理"></a>实验原理</h2><p>细菌质粒是一类双链、闭环的DNA，大小范围从1kb至200kb以上不等。各种质粒都是存在于细胞质中、独立于细胞染色体之外的自主复制的遗传成份，通常情况下可持续稳定地处于染色体外的游离状态，但在一定条件下也会可逆地整合到寄主染色体上，随着染色体的复制而复制， 并通过细胞分裂传递到后代。质粒已成为目前最常用的基因克隆的载体分子，重要的条件是可获得大量纯化的质粒DNA分子。目前已有许多方法可用于质粒DNA的提取，下面主要介绍碱裂解法提取质粒DNA的方法。</p>
<p>在 pH 12.0～12.6 碱性环境中，细菌的线性大分子量染色体 DNA 变性分开，而共价闭环的质粒 DNA 虽然变性但仍处于拓扑缠绕状态。将 pH 调至中性并有高盐存在及低温的条件下，大部分染色体 DNA 、大分子量的 RNA 和蛋白质在去污剂 SDS 的作用下形成沉淀，而质粒 DNA 仍然为可溶状态。通过离心，可除去大部分细胞碎片、染色体 DNA 、 RNA 及蛋白质，质粒 DNA 尚在上清中，然后用硅酸纤维膜吸附或者酚、氯仿抽提进一步纯化质粒 DNA 。</p>
<h2 id="实验材料："><a href="#实验材料：" class="headerlink" title="实验材料："></a>实验材料：</h2><p>试剂盒E.Z.N.A.® Plasmid DNA Mini Kit I（OMEGA　Bio-tek）<br>Epoch微孔板分光光度计（BioTek）<br>1.5mL管<br>5mL 离心管</p>
<h2 id="实验流程："><a href="#实验流程：" class="headerlink" title="实验流程："></a>实验流程：</h2><ol>
<li>自新鲜划痕选择培养板中分离单菌落，接种含适当选择性抗生素的5ml的LB培养基进行培养。37℃强力摇动（~300rpm）孵育16h。括DH5α。</li>
<li>将5.0ml细菌室温10,000 g离心1min，放到5 mL的EP管中，如果菌液多，则分两次加入。</li>
<li>轻轻倒出或吸走培养基并丢弃。</li>
<li>加入250μL 的溶液I/Rnase A重悬沉淀，涡旋或用移液器反复吹打。充分重悬沉淀对于获得高质量的DNA非常重要。（<strong>注：溶液Ⅰ的成分及作用为：①50mM 葡萄糖—-增稠，使悬浮后的大肠杆菌不会快速沉积到管子的底部；②10mM EDTA—-抑制DNase的活性。这一步溶液中还可以加入RNase，③25mM Tris-HCl，pH=8.0—-提取适当的缓冲液体系和PH；④RNase—-除去RNA，此成分不受EDTA影响，并且可以在后续步骤中被除去</strong>）</li>
<li>加入250μL溶液II（在孵箱中预热），倒置、转动试管数次使之轻轻混匀，得到透明的裂解产物。可能需要孵育2min。不要用力混合，以免使染色体DNA断裂，减低质粒的纯度。该步反应不要超过5min。溶液II不用时要拧紧瓶盖，以免试剂被空气中的CO2酸化。（<strong>溶液II的成分及作用为为①0.2M NaOH—-裂解细菌，使双层膜变化为micelle微囊；②1%SDS——结合蛋白质（平均2个氨基酸结合上一个SDS），和钾离子形成十二烷基硫酸钾PDS,进而形成大量的沉淀。</strong>）</li>
<li>加入350μL溶液III，立即倒置试管数次混匀，直至白色絮状沉淀物形成。为避免形成局部沉淀，加入溶液III后应立即、充分混匀溶液。（<strong>溶液III的成分及作用为：①3M醋酸钾—-钾离子和SDS形成PDS，大量的沉淀；②2M醋酸—-中和NaOH，防止基因组DNA断裂。</strong>）</li>
<li>室温≥13,000g离心10分钟。白色沉淀物形成，立即进行下一步操作。</li>
<li>将HiBindDNAMini Column 加入到2mL的收集管上。</li>
<li>小心翼翼的吸取上清液（注意不要吸到沉淀，如果不放心，可以将上清吸到另一新的EP管，然后再离心一次，吸取上清），加入装配在2ml收集管中的小量纯化柱I中。确保离心沉淀未受扰动，确保没有细胞碎片加入到柱子中。</li>
<li>室温下10,000g离心1分钟，使裂解液完全通过柱子。再将裂解液加回柱子，再离心一次。</li>
<li>丢弃滤过液，重新使用2ml收集管。</li>
<li>加入500μL HBC缓冲液清洗柱子。(<strong> HBC的成分没有查到，但根据相关的信息，HBC的成分应该是酚，氯仿，异戊醇的混合用；它们的作用分为：①酚—-使残余的蛋白质变性（远强于氯仿）；②氯仿—-和酚混合使用，增加比重。酞与氯仿是非极性分子，水是极性分子，当蛋白水溶液与酚或氯仿混合时，蛋白质分子之间的水分子就被酚或氯仿挤去，使蛋白失去水合状态而变性过离心，变性蛋白质的密度比水的密度为大，因而与水分离，沉淀在水相下面，从而与溶解在水相中的DNA分开；③异戊醇—-可以使用酚：氯仿：异戊醇=25:24:1的比例抽提质粒DNA，在抽提DNA时，为了混合均匀，必须剧烈振荡容器数次，这时在混合液内易产生气泡，气泡会阻止相互间的充分作用。加入异戊醇能降低分子表面张力，所以能减少抽提过程中的泡沫产生。</strong>)</li>
<li>室温13,000 g离心1分钟，使溶液完成通过柱子。该步操作需确保残余的蛋白质污染被去除，以保证获得高品质的DNA以适合于下游的应用。</li>
<li>丢弃滤过液，重新使用2ml收集管。</li>
<li>加入700μL DNA Wash Buffer。DNA清洗液的浓缩液使用前必须用无水乙醇稀释（5倍稀释），如果DNA清洗液稀释液经过冷藏，则使用之前必须置于室温。(<strong>wash buffer的作用：加入无水乙醇后,终浓度差不多就是70%的乙醇溶液了,在沉淀的DNA中,由于过多的盐杂质存在,影响DNA的酶切等反应,wash buffer就是洗去这些盐杂质的。</strong>)</li>
<li>室温10,000g离心1分钟。</li>
<li>丢弃滤过液。</li>
<li>将空柱子≥13,000 x g离心2min，使柱子的基质干燥。此步骤为关键操作，不可遗漏。</li>
<li>将柱子放入干净的1.5ml微量离心管中，60℃孵育5min。</li>
<li>将80μL无菌去离子水直接加入柱子基质上。</li>
<li>60℃孵育5min。</li>
<li>≥13,000 x g离心1min洗脱DNA。可以进行二次洗脱，以收集残存的DNA。</li>
<li>检测质粒浓度，A260/A280的比率可以反映核酸的纯度。比值大于1.8表明核算的纯度在90%以上。将质粒稀释到400ng/uL。</li>
</ol>
<h2 id="测序"><a href="#测序" class="headerlink" title="测序"></a>测序</h2><p>取10uL的质粒样品，送到测序公司即可。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2017/07/03/Experiment/病毒包装笔记(3)-转化/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/07/03/Experiment/病毒包装笔记(3)-转化/" itemprop="url">病毒包装笔记(3)-转化</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-07-03T12:00:00+08:00">
                2017-07-03
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/生物实验笔记/" itemprop="url" rel="index">
                    <span itemprop="name">生物实验笔记</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  675
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  3
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h2><p>转化（ transformation ）是指一段同源或异源的 DNA 转入受体细胞并得到表达的水平基因的转移过程，是现代分子生物学研究和基因工程不可缺少的重要技术。</p>
<p>转化过程所用的受体细胞（通常是大肠杆菌），一般是限制修饰系统缺陷的变异株，即不含限制性内切酶和甲基化酶的突变体，它可以容忍外源DNA分子进入体内并稳定地遗传给后代，受体细胞经过一些特殊方法的处理后，细胞膜的通透性发生了暂时性的改变，成为能允许外源DNA分子进入的感受态细胞。进入受体细胞的DNA分子通过复制，表达实现遗传信息的转移，使受体细胞出现新的遗传性状。将经过转化后的细胞在筛选培养基中培养，即可筛选出转化子（即带有异源DNA分子的受体细胞）。</p>
<h2 id="菌株"><a href="#菌株" class="headerlink" title="菌株"></a>菌株</h2><p>E.coli DH5a 菌株（感受态）</p>
<h2 id="转化"><a href="#转化" class="headerlink" title="转化"></a>转化</h2><ol>
<li>质粒1uL加入10ul的感受态细胞中，冰上放置40min。</li>
<li>42℃水浴锅内热激90s（让质粒进入感受态细胞）。</li>
<li>取出，冰上放置5min（让感受态细胞关闭）。</li>
<li>加入200ul LB液体培养基（无抗性AMP），37℃摇床培养1h。</li>
</ol>
<h2 id="涂板"><a href="#涂板" class="headerlink" title="涂板"></a>涂板</h2><p>将上述培养液20uL涂布在含AMP的LB固体培养基上，过液培养。</p>
<h2 id="挑菌"><a href="#挑菌" class="headerlink" title="挑菌"></a>挑菌</h2><p>次日如果发现板子已经长有菌落，则用5uL的枪头挑一个单菌落，打入5mL的LB液体培养基中（ 实验室的氨苄为1000X的，即100mg/mL，因此5mL的液态培养基里加入5uL，即100ug/mL  )，放于摇床培养，37℃过夜。（5mL LB培养基+5uL AMP + 用枪头挑菌，枪头可加入培养瓶中）</p>
<p>第二天提取质粒或保藏（保藏菌株放于负80冰箱）。</p>
<h2 id="LB培养基的配制"><a href="#LB培养基的配制" class="headerlink" title="LB培养基的配制"></a>LB培养基的配制</h2><p>下面以100mL（250mL）的LB培养基为例说明</p>
<ol>
<li>胰蛋白胨(Tryptone)-1g（250mL–2.5g)</li>
<li>酵母提取物（Yeast Extract) 0.5g(250mL–1.25g)</li>
<li>NaCl-1g)(250mL–2.5g)</li>
<li>琼脂(Agar) 1.5g(250mL–3.75g)</li>
<li>单蒸水：100mL(250mL–250mL)</li>
</ol>
<h2 id="抗性LB培养基"><a href="#抗性LB培养基" class="headerlink" title="抗性LB培养基"></a>抗性LB培养基</h2><ol>
<li>高压灭菌后，将融化的LB固体培养基置与55℃的水浴中；</li>
<li>待培养基温度降到55℃时(手可触摸)加入抗生素（实验室的氨苄为1000X的，即100mg/mL，因此5mL的液态培养基里加入5uL，即100ug/mL ），以免温度过高导致抗生素失效；</li>
<li>充分摇匀。</li>
<li>如果是固体培养基，则用封口胶封边，并倒置放于4℃保存，一个月内使用。</li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2017/07/02/Experiment/病毒包装笔记(2)-质粒/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/07/02/Experiment/病毒包装笔记(2)-质粒/" itemprop="url">病毒包装笔记(2)-质粒</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-07-02T12:00:00+08:00">
                2017-07-02
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/生物实验笔记/" itemprop="url" rel="index">
                    <span itemprop="name">生物实验笔记</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  1,975
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  7
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h2><p>1952年Joshua Lederberg创造一个词“质粒(Plasmid)”，它指的是任何染色体外的遗传决定物质，共价、闭合、环状双链DNA（cccDNA），大小从1kb~1000kb。质粒是一种独立于染色体外独立复制的双链DNA片段，通常都含有基因。尽管质粒在细菌、古细菌和真核细胞中都有发现，但质粒对于细菌的生物学意义更加重要，因为细菌与细菌之间可以通过鞭毛等相互交换质粒信息，而这种遗传信息的交换是有利的，因为质粒上面含有耐药基因等信息。</p>
<p>但天然存在的野生型质粒有着一些缺点，例如分子量大(＞15kb)、拷贝数低、单一酶切位点少、遗传标记不理想等缺陷，不能满足克隆载体的要求。因此需要进行改造：</p>
<ol>
<li>去除多余的和功能研究无关的片段删除掉，将质粒的长度从15kb缩短到1~5kb。</li>
<li>给它添加上各种元件，例如安装各种酶切位点，遗传标记，例如抗性基因（氨苄霉素、卡那霉素、四环素…）、报告基因（luciferase、EGFP…）等。</li>
</ol>
<h2 id="质粒的分类（原核-真核-穿梭载体）"><a href="#质粒的分类（原核-真核-穿梭载体）" class="headerlink" title="质粒的分类（原核/真核/穿梭载体）"></a>质粒的分类（原核/真核/穿梭载体）</h2><ol>
<li>克隆载体：能带动外源基因，在宿主细胞中复制扩增。它是用来克隆和扩增DNA片段（基因）的载体，这类载体没有启动子等启动转录、翻译的元件。 </li>
<li>表达载体：具有克隆载体的基本元件（ori,Ampr,Mcs等）还具有转录/翻译所必需的DNA序列。 </li>
<li>穿梭载体是指一类人工构建的具有两种不同复制起点和选择标记，因而可以在两种不同类群宿主中存活和复制的质粒载体。此概念不仅用于不同的微生物菌群之间，也可以推广到真核生物表达载体的构建，如用于枯草的pBE2、酵母的pPIC9K、哺乳动物表达载体pMT2 和用于植物细胞的Ti 质粒。这些穿梭载体不仅可以在大肠杆菌中复制扩增，也可以在相应的枯草、酵母、动物或植物细胞中扩增和表达。这样利于对质粒的分子生物学操作和大量制备。</li>
<li>基因下调载体：用于减少某个内源基因的表达，该载体上含有针对目标基因mRNA的shRNA，起到基因沉默的作用，下调基因的蛋白表达。 </li>
<li>病毒质粒：基于病毒的基因组改造而成的质粒，可以独立包装成为病毒颗粒，巧妙地去除了病毒的感染致病性却保留了病毒的其他功能，为功能基因的灵活进入细胞并整合到基因组中提供了非常方便的工具。</li>
</ol>
<h2 id="质粒的命名"><a href="#质粒的命名" class="headerlink" title="　质粒的命名"></a>　质粒的命名</h2><p>pUC19、pEGFP-N3。小写字母p代表质粒”plasmid”，2~4个大写字母代表发明者、实验室名称或者其他表型性状（EGFP是增强型绿色荧光蛋白）。</p>
<h2 id="质粒图谱"><a href="#质粒图谱" class="headerlink" title="质粒图谱"></a>质粒图谱</h2><h3 id="质粒图谱如下所示：第一张图："><a href="#质粒图谱如下所示：第一张图：" class="headerlink" title="质粒图谱如下所示：第一张图："></a>质粒图谱如下所示：第一张图：</h3><p><img src="http://ortxpw68f.bkt.clouddn.com/pl.png" alt=""></p>
<hr>
<h3 id="质粒图谱：第二张图："><a href="#质粒图谱：第二张图：" class="headerlink" title="质粒图谱：第二张图："></a>质粒图谱：第二张图：</h3><p><img src="http://ortxpw68f.bkt.clouddn.com/pw.jpg" alt=""></p>
<ol>
<li><p>箭头。大多数质粒都会有箭头，箭头有两种解释。一种是代表转录方向，转录方向主要是由启动子开始的一个大箭头，是启动子启动序列的顺序。另一种是复制起始位点的方向，复制起始位点就是该质粒在大肠杆菌等细菌或真菌中DNA复制的一个方向。我们还需要提到的是F1启动子（图上的f1 ori）代表的是噬菌体的复制起始方向，只能复制出单链的DNA哦，但是可以用来测序。看懂转录的方向，这样就方便设计插入片段的位置和方向性。复制起始位点Ori，了解质粒的类型（原核/真核/穿梭质粒）：招募复制蛋白，进行质粒的自我复制，增加拷贝数，随着细胞的增殖而增殖；</p>
</li>
<li><p>抗性基因：加抗性基因的原因是因为质粒对于一般细胞来讲不是必需元件，在没有抗生素的培养基中不断增殖的过程中，质粒载体慢慢就丢失了，只有培养基里面加入抗生素，抗性基因赋予宿主菌分解抗生素的能力，细胞才会需要该质粒。常见抗性基因有：<strong>Ampr</strong> 水解β－内酰胺环，解除氨苄的毒性；<strong>tetr</strong> 可以阻止四环素进入细胞；<strong>camr</strong> 生成氯霉素羟乙酰基衍生物，使之失去毒性；<strong>neor（kanr）</strong> 氨基糖苷磷酸转移酶 使G418（长那霉素衍生物）失活。</p>
</li>
<li><p>多克隆位点（MCS）：它具有多个限制内切酶的单一切点，便于要研究的基因的插入。如果在这些位点外有外源基因的插入，会导致某种标志基因的失活，而便于筛选，最常见的是β-半乳糖苷酶的蓝白斑筛选系统。</p>
</li>
<li><p>是否含有表达系统元件，即启动子（promoter）－核糖体结合位点（RBS）－转录终止信号（AATAAA同时是poly A）。这是用来区别克隆载体与表达载体。克隆载体中加入一些与表达调控有关的元件即成为表达载体。选用那种载体，还是要以实验目的为准绳。<strong>启动子</strong>是促进DNA转录的DNA顺序，这个DNA区域常在基因或操纵子编码顺序的上游，是DNA分子上可以与RNApol特异性结合并使之开始转录的部位，但启动子本身不被转录。<strong>增强子/沉默子</strong>－是真核基因组（包括真核病毒基因组）中的一种具有增强邻近基因转录过程的调控顺序。其作用与增强子所在的位置或方向无关。即在所调控基因上游或下游均可发挥作用。/沉默子－负增强子，负调控序列。<strong>克核糖体结合位点/起始密码/SD序列（Rbs/AGU/SDs）</strong>：mRNA有核糖体。<strong>转录终止顺序（终止子）/翻译终止密码子</strong>结构基因的最后一个外显子中有一个AATAAA的保守序列，此位点down－stream有一段GT或T富丰区，这2部分共同构成poly（A）加尾信号。结构基因的最后一个外显子中有一个AATAAA的保守序列，此位点down－stream有一段GT或T富丰区，这2部分共同构成poly（A）加尾信号。</p>
</li>
<li>报告基因：例如β-半乳糖苷酶、EGFP、luciferase等，便于迅速检查功能基因是否表达的阳性判断，表达成功的蛋白在小鼠体内分布位置，直接看EGFP、luciferase的荧光就ok。</li>
<li>引物结合区（primer）：一般位于多克隆位点区的上、下游，便于通用引物的PCR验证、测序验证之用。</li>
</ol>
<h2 id="质粒的查询"><a href="#质粒的查询" class="headerlink" title="质粒的查询"></a>质粒的查询</h2><p>Vectorpedia<br><a href="http://www.addgene.org/pgvec1?f=v&amp;cmd=listvecinfo" target="_blank" rel="external">http://www.addgene.org/pgvec1?f=v&amp;cmd=listvecinfo</a></p>
<p>google<br>检索式子：质粒名 ＋ map<br>质粒名 ＋sequence ＋filetype:txt or filetype:pdf 或者：进入 google，点击图片搜索，直接查找图谱。</p>
<p>google scholar<br>有些质粒是经过改造的，所以通过上述方法不能查询到相应信息。这时，可以在 google scholar 中输入质粒名称，可以直观地看哪些学者在何文章中使用了该质粒，从而可了解到质粒的来源; 或者籍此向作者咨询或索取。</p>
<p>大量图谱：<a href="http://www.embl-hamburg.de" target="_blank" rel="external">http://www.embl-hamburg.de</a></p>
<p>PET 系列载体信息：<a href="http://www.merckbiosciences.com/g.asp?f=NVG/pETtable.html" target="_blank" rel="external">http://www.merckbiosciences.com/g.asp?f=NVG/pETtable.html</a></p>
<h2 id="转染"><a href="#转染" class="headerlink" title="转染"></a>转染</h2><p>以转染293T细胞为例，使用Lipofiter (汉恒)/DNA转染试剂（biotool），或lipo2000/3000，Fugen HD等转染试剂。</p>
<p>参考资料</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2017/07/01/Experiment/病毒包装笔记(1)-慢病毒/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/07/01/Experiment/病毒包装笔记(1)-慢病毒/" itemprop="url">病毒包装笔记(1)-慢病毒</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-07-01T12:00:00+08:00">
                2017-07-01
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/生物实验笔记/" itemprop="url" rel="index">
                    <span itemprop="name">生物实验笔记</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  4,831
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  17
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="慢病毒背景"><a href="#慢病毒背景" class="headerlink" title="慢病毒背景"></a>慢病毒背景</h2><p>慢病毒包括<strong>灵长类慢病毒</strong>，如人类免疫缺陷病毒(HIV)和猴免疫缺陷病毒(SIV)，以及<strong>非灵长类慢病毒</strong>如猫免疫缺陷病毒(FIV)、马传染性贫血病毒(EIAV)、牛免疫缺陷病毒(BIV)和<strong>维斯纳-梅迪病毒(VMV)</strong>等。目前，HIV-1、HIV-2、SIV、FIV及EIAV被广泛研究用作基因治疗的载体，而其中又以HIV-1最为热门。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">注：慢病毒的英文是lentivirus，它是反转录病毒科下的一个属，此属病毒的特征是需要较长的时间才能培养出来，例如人类免疫缺陷病毒(HIV)、猴免疫缺陷病毒(SIV)、猫免疫缺陷病毒(FIV)都是慢病毒属，慢病毒属的原文是Lentivirus，其中Lenti-在拉丁文中有慢的意思，因此称为慢病毒。慢病毒属可以由宿主细胞直接感染周围的细胞，不必经由形成病毒颗粒此一步骤。它一般的逆转录病毒载体不同，慢病毒对分裂细胞和非分裂细胞均具有感染能力。由于这一特点目前慢病毒也被广泛地应用于表达RNA干预的研究中。慢病毒属是反转录病毒科下的一个属，此属病毒的特征是需要较长的时间才能培养出来，例如人类免疫缺陷病毒(HIV)、猴免疫缺陷病毒(SIV)、猫免疫缺陷病毒(FIV)都是慢病毒属，慢病毒属的原文是Lentivirus，其中Lenti-在拉丁文中有慢的意思。</div></pre></td></tr></table></figure>
<h2 id="HIV-1病毒形态与结构"><a href="#HIV-1病毒形态与结构" class="headerlink" title="HIV-1病毒形态与结构"></a>HIV-1病毒形态与结构</h2><p>现在的慢病毒包装系统通常是由HIV-1病毒改造而来的，因此有必要了解一下HIV-1的结构与功能。HIV-1的基因组由两条相同的正股RNA链在5′端通过部分碱基互补配对而成二聚体。病毒基因组全长约9200bp，含有gag、pol、env 3个结构基因以及tat、rev、nef、vif、vpr、vpu6个调节基因。在病毒基因组的5′端和3′端各有相同的一段核苷酸序列，称为长末端重复序列(longterminalrepeat，LTR)。</p>
<h3 id="HIV-1的病毒结构如下所示"><a href="#HIV-1的病毒结构如下所示" class="headerlink" title="HIV-1的病毒结构如下所示"></a>HIV-1的病毒结构如下所示<img src="http://ortxpw68f.bkt.clouddn.com/HIV-1.png" alt=""></h3><h4 id="各个元件的作用："><a href="#各个元件的作用：" class="headerlink" title="各个元件的作用："></a>各个元件的作用：</h4><h5 id="编码病毒的基本结构："><a href="#编码病毒的基本结构：" class="headerlink" title="编码病毒的基本结构："></a>编码病毒的基本结构：</h5><ol>
<li>gag基因编码病毒的核心蛋白，即p55的蛋白前体，经蛋白酶裂解而形成病毒的核衣壳蛋白(p7)、内膜蛋白(p17)和衣壳蛋白(p24)。</li>
<li>pol基因编码病毒复制所需的酶类。</li>
<li>env基因编码病毒的包膜糖蛋白，决定病毒感染宿主的靶向性。编码p55的蛋白前体，经蛋白酶裂解而形成病毒的核衣壳蛋白(p7)、内膜蛋白(p17)和衣壳蛋白(p24)。</li>
</ol>
<h5 id="调节基因"><a href="#调节基因" class="headerlink" title="调节基因"></a>调节基因</h5><ol>
<li>tat基因编码的gp14是一种反式激活的转录因子，与LTR结合后能促进病毒所有基因的转录。</li>
<li>rev基因编码的产物gp19能促进未经拼接的大mRNA分子从细胞核向胞浆转运，并相对减少拼接后小mRNA分子的数量。</li>
<li>nef基因编码负调节蛋白，对病毒的结构蛋白和调节蛋白的表达均有下调作用。</li>
<li>vif编码产物与病毒体的感染性有关，vpu产物与病毒的装配、成熟和释放有关，而vpr编码产物的功能尚不清楚。</li>
</ol>
<h2 id="HIV-1生活史"><a href="#HIV-1生活史" class="headerlink" title="HIV-1生活史"></a>HIV-1生活史</h2><p>　　HIV-1病毒通过gp120与宿主细胞的CD4分子和趋化因子受体结合，然后将病毒的基因(RNA)、蛋白及酶等释放到宿主细胞内;随后，逆转录酶将病毒RNA转录成DNA，病毒DNA在整合酶的作用下插入宿主细胞核的基因组中，此时的病毒DNA也称为原病毒;紧接着，原病毒转录成mRNA，mRNA从细胞核进入细胞质，并利用宿主细胞的原料合成病毒的各种成分(蛋白质)，新合成的各种蛋白、酶及RNA等聚集在宿主细胞的膜下，病毒的包膜蛋白(gp120，gp41)插入宿主细胞的细胞膜并形成一种未成熟的病毒(<strong>此时病毒无传染性，这也是包病毒中病毒包膜质粒的作用</strong>);最后蛋白酶将病毒核心中的许多过长的蛋白及酶切短，便形成成熟的病毒。病毒利用宿主细胞的细胞膜将自己包被起来，离开该细胞去寻找新的宿主。</p>
<h2 id="慢病素是操作基因的工具"><a href="#慢病素是操作基因的工具" class="headerlink" title="慢病素是操作基因的工具"></a>慢病素是操作基因的工具</h2><h3 id="引入外源基因"><a href="#引入外源基因" class="headerlink" title="引入外源基因"></a>引入外源基因</h3><p>慢病毒和逆转录病毒基因递送系统利用了逆转录病毒复制方面的性质以获得目标核酸序列稳定的整合。核酸转染只能获得瞬时的转基因表达（这种转染能在宿主细胞中引入外源基因，但无法稳定遗传），而基于逆转录病毒和慢病毒的系统却可以获得外源基因稳定的整合，外源基因于是被遗传下去随重复的细胞分裂持续表达。慢病毒和逆转录病毒载体的一个重要特征是他们产生的是复制有缺陷的，即自身无活性的病毒颗粒。这使得目标序列得以转运，而在目标细胞中不存在连续的病毒复制。</p>
<h3 id="用于RNAi的研究"><a href="#用于RNAi的研究" class="headerlink" title="用于RNAi的研究"></a>用于RNAi的研究</h3><p>慢病毒也被广泛地应用于表达RNAi的研究中。由于有些类型细胞脂质体转染效果差，转移到细胞内的siRNA半衰期短，体外合成siRNA对基因表达的抑制作用通常是短暂的，因而使其应用受到较大的限制。采用事先在体外构建能够表达siRNA的载体, 然后转移到细胞内转录siRNA的策略，不但使脂质体有效转染的细胞种类增加，而且对基因表达抑制效果也不逊色于体外合成siRNA，在长期稳定表达载体的细胞中，甚至可以发挥长期阻断基因表达的作用。在所构建的siRNA表达载体中，是由rna聚合酶Ⅲ启动子来指导RNA合成的，这是因为RNA聚合酶Ⅲ有明确的起始和终止序列，而且合成的RNA不会带poly A尾。当RNA聚合酶Ⅲ遇到连续4个或5个T时，它指导的转录就会停止，在转录产物3’端形成1~4个U。U6和H1 RNA启动子是两种RNA聚合酶Ⅲ依赖的启动子，其特点是启动子自身元素均位于转录区的上游，适合于表达～21ntRNA和～50ntRNA茎环结构(stem loop)。在siRNA表达载体中，构成siRNA的正义与反义链，可由各自的启动子分别转录,然后两条链互补结合形成siRNA;也可由载体直接表达小发卡状RNA(small hairpin RNA, shRNA), 载体包含位于RNA聚合酶Ⅲ启动子和4～5T转录终止位点之间的茎环结构序列，转录后即可折叠成具有1~4 个U 3 ’突出端的茎环结构，在细胞内进一步加工成siRNA。构建载体前通常要通过合成siRNA的方法，寻找高效的siRNA，然后从中挑选符合载体要求的序列，将其引入siRNA表达载体。</p>
<h2 id="慢病毒载体的构建"><a href="#慢病毒载体的构建" class="headerlink" title="慢病毒载体的构建"></a>慢病毒载体的构建</h2><p>慢病毒载体（Lentiviral vector,LVs）是在HIV-1病毒基础上改造而成的病毒载体系统，它能高效的将目的基因（或RNAi）导入动物和人的原代细胞或细胞系。慢病毒载体基因组是正链RNA，其基因组进入细胞后，在细胞浆中被其自身携带的反转录酶反转为DNA，形成DNA整合前复合体，进入细胞核后，DNA整合到细胞基因组中。整合后的DNA转录mRNA，回到细胞浆中，表达目的蛋白；或产生RNAi干扰。</p>
<h3 id="慢病毒包装系统的组成"><a href="#慢病毒包装系统的组成" class="headerlink" title="慢病毒包装系统的组成"></a>慢病毒包装系统的组成</h3><p>该系统由<strong>[1]包装质粒、[2]载体质粒、[3]包膜质粒及</strong>3种质粒组成。</p>
<p><strong>包装质粒</strong>：这一部分能够表达出各种病毒酶蛋白。包装质粒由HIV基因组去除了包装、逆转录和整合所需的顺式作用序列而构建，能够反式提供产生病毒颗粒所必需的蛋白表达HIV复制所需的全部反式激活蛋白，但不产生病毒包膜蛋白及辅助蛋白vpu。它由HIV前病毒基因组作简单修改得到，其5′端LTR由（LTR本身也有启动子活性）异源病毒启动子/增强子元件取代。为了防止来自辅助质粒的RNA衣壳化，特意将5′端主要剪接供体位点(splice donor site)和gag编码序列起始端之间的包装信号区(E/Ψ region)删除，而下游的启动子由外源多聚腺苷酸信号(polyA)取代。另外利用点突变将env编码序列打断，但仍然保留rev反应元件。这样的辅助结构能表达所有的病毒蛋白，包括tat及rev(env除外)。</p>
<p><strong>载体质粒</strong>：该质粒用于将目标基因递送至靶细胞。载体成分与包装成分互补，即含有包装、逆转录和整合所需的HIV顺式作用序列，同时具有异源启动子控制下的多克隆位点及在此位点插入的目的基因。为降低载体质粒与包装质粒这两种成分同源重组恢复成野生型病毒的可能，因此需尽量减少两者的同源性，例如将包装成分上5′LTR换成巨细胞病毒(CMV)早期启动子、3′LTR换成SV40 polyA等。它携带了5′端LTR和全部5′端非翻译区域(包括gag编码序列的350个核苷酸)，另外还带有rev应答元件(Revresponsiveelement，RRE)及3′端LTR，其瞬时表达盒采用巨细胞病毒(CMV)启动子及增强子元件，在某些研究领域，可以携带绿色荧光蛋白基因、荧光素酶基因或半乳糖苷酶基因作为生物标记。</p>
<p><strong>包膜质粒</strong>:病毒载体可以借助其他病原体的外壳蛋白包装成假病毒，以改变其嗜性。最常用的是疱疹性口腔炎病毒膜融合包膜G糖蛋白（VSV-G）。,env由单独的包膜质粒携带并在病毒生产过程中共转染后表达。本系统包膜质粒的改进之处在于，引入了VSV-G基因表达包膜结构，这样做的结果至少具有3个方面的积极意义:</p>
<p>①包膜的更换进一步降低了HIV-1载体恢复成野生型病毒的可能;<br>②使HIV载体感染宿主的范围不再仅限于CD4+细胞，而扩大到几乎能感染所有组织来源的细胞;<br>③VSV的包膜赋予HIV载体颗粒高度的稳定性，使其能够通过超速离心而浓缩，达到高滴度。使HIV-1载体滴度由105转录单位(TU)/ml达到108TU/ml。这样的改进无疑是HIV载体系统走向应用而迈出的一大步。</p>
<h4 id="第二代HIV-1来源的慢病毒载体"><a href="#第二代HIV-1来源的慢病毒载体" class="headerlink" title="第二代HIV-1来源的慢病毒载体"></a>第二代HIV-1来源的慢病毒载体</h4><p>　　尽管第一代载体产生RCR的几率极小，仍然不能忽略产生的可能性。毕竟包装质粒可以表达除env外所有HIV-1病毒蛋白，其中部分蛋白与HIV-1的毒力密切相关，且已发现部分蛋白对细胞存在潜在的毒害作用，比如:vpr可引起细胞周期停滞，vif能抑制某些细胞的生长而Nef能引起凋亡。1997年，Zufferey等将包装质粒上的vif、vpr、vpu和nef基因敲除，从而得到第二代慢病毒载体，而其他方面与上述第一代载体系统一致。研究发现即使全部4个调节基因都被敲除。病毒颗粒的产量也不会受到影响。这种载体仍然具有体外感染非分裂期细胞、在体感染分化成熟大鼠神经元的能力，但是目前尚不能确定这种载体是否能转染全部种类细胞。由于敲除的调节基因与野生型HIV-1病毒的生活周期以及毒力密切相关，所以这些载体即使发生多位点重组形成RCR，亲代病毒仍不具有致病性。</p>
<h4 id="第三代HIV-1来源的慢病毒载体"><a href="#第三代HIV-1来源的慢病毒载体" class="headerlink" title="第三代HIV-1来源的慢病毒载体"></a>第三代HIV-1来源的慢病毒载体</h4><p>　　利用慢病毒来源的包装系统的最大问题在于生产过程中可能产生复制型病毒。当质粒DNA转染进入包装细胞，以及辅助质粒及载体质粒的RNA包装入同一病毒颗粒时，将有可能发生重组。减少这种可能性的方法之一就是减少辅助质粒与载体质粒的同源性。另一个方法便是将gag/pol和rev编码序列隔离，分散在不同的质粒。这样的包装系统需要四质粒来代替原有的三质粒包装系统。质粒一携带了gag/pol编码序列及RRE;质粒二包含了编码rev的序列;质粒三是载体质粒;质粒四表达env。采用四质粒代替三质粒系统、除去tat均减少了产生复制型病毒的可能性，从而增加了载体系统的安全性。</p>
<h4 id="自身失活型-SIN-慢病毒载体"><a href="#自身失活型-SIN-慢病毒载体" class="headerlink" title="自身失活型(SIN)慢病毒载体"></a>自身失活型(SIN)慢病毒载体</h4><p>　　由于具有逆转录方式的特点，在逆转录过程中存在于病毒基因组3′端U3区的启动子/增强子元件将被复制，并置于前病毒两端的LTR。因此，3′LTR的U3区启动子发生失活突变后，将在逆转录过程中转移至5′LTR。如果这样的载体整合入靶细胞，将不会产生完整长度的载体RNA，因此命名为“自身失活型载体”。这种技术最先应用于莫洛尼氏小鼠白血病病毒(MoMLV)载体和鸟类的脾坏死病毒(SNV)载体。进一步研究表明，U3区的频繁突变将导致病毒滴度下降，原因是该区域的某些序列是载体有效多聚腺苷酸化所必需的。在HIV-1基因组内，核心多聚腺苷酸化信号存在R区。现已证实，U3区序列能影响多聚腺苷的酸化效率。与MoMLV相比，将HIV-1的3′LTRU3区(除上述多聚腺苷酸化增强相关序列，以及病毒整合酶识别的U3区5′末端外)删除后并不会影响滴度。这种删除能确保病毒RNA逆转录并整合入靶细胞染色体后，从5′LTR端启动子起始的复制被有效抑制。这种设计的另一个优势是能增强瞬时表达效率，这可能与减少了病毒LTR和细胞启动子之间的启动子竞争有关。</p>
<h3 id="慢病毒载体的包装"><a href="#慢病毒载体的包装" class="headerlink" title="慢病毒载体的包装"></a>慢病毒载体的包装</h3><p>　　大部分研发人员目前都使用瞬时转染293T细胞的方式生产病毒载体。这种方法的缺点在于生产获得的病毒载体可能会出现有缺陷的基因组。为了生产高质量的载体，必须筛选合适的包装细胞系，而建立包装细胞系的最大难点在于某些病毒蛋白具有细胞毒性。比如，vpr能诱导细胞停滞在G2期，不利于建立vpr蛋白高表达的细胞系，病毒蛋白水解酶同样能水解细胞内的蛋白，不利于建立稳定表达病毒gag-pol蛋白的细胞系;VSV-G蛋白的表达同样对细胞具有毒性。目前，为了建立合适的慢病毒载体包装细胞系，许多科学家都在尝试使用诱导型或可调节的启动子来克服病毒蛋白的细胞毒作用。</p>
<h2 id="慢病毒的包装过程"><a href="#慢病毒的包装过程" class="headerlink" title="慢病毒的包装过程"></a>慢病毒的包装过程</h2><h3 id="所用质粒"><a href="#所用质粒" class="headerlink" title="所用质粒"></a>所用质粒</h3><p>本实验室现在使用的慢病毒包装系统为三质粒系统，三个质粒分别为①psPAX2（包装质粒），②pMD2G（包膜质粒），③目的质粒（载体质粒）。从网上的信息来看，这是第二代慢病毒包装系统。</p>
<h3 id="慢病毒载体滴度的测定"><a href="#慢病毒载体滴度的测定" class="headerlink" title="慢病毒载体滴度的测定"></a>慢病毒载体滴度的测定</h3><p>　　慢病毒载体滴度可以参考腺病毒载体滴度的检测方法，将病毒与293细胞共培养后，通过流式细胞仪检测GFP蛋白表达水平来分析病毒滴度，病毒滴度为表达GFP的细胞数乘以相应稀释倍数。另外，还可以通过TaqManPCR检测细胞中病毒拷贝数的方法检测滴度。</p>
<h3 id="病毒包装的简单流程"><a href="#病毒包装的简单流程" class="headerlink" title="病毒包装的简单流程"></a>病毒包装的简单流程</h3><p>本文只是背景资料搜集，因此不涉及具体的实验操作。大致操作如下：</p>
<ol>
<li><strong>转化</strong>：目的在于将质粒进行扩增，质粒的本质就是DNA，在一定条件下可以进行大量扩增，因此在拿到质粒的第一件事情就是先扩增出大量的质粒进行备份（前提是这个质粒的序列是对的）；常用的宿主细胞是DHalpha大肠杆菌。</li>
<li>孵育293FT细胞。细胞株293T，慢病毒的包装细胞，为贴壁依赖型成上皮样细胞，生长培养基为DMEM(含10%FBS)。贴壁细胞经培养生长增殖形成单层细胞。菌株大肠杆菌菌株DH5α。用于扩增慢病毒载体和辅助包装载体质粒。这种细胞是已经被筛选出来专门用来合成病毒的。将1中的质粒转染到293FT细胞中，进入病毒包装，提取病毒，进入下一步的转染操作。</li>
<li>目的细胞：就是自己最终实验所用到的细胞，例如DC2.4细胞。将包装好的病毒对目的细胞进行感染。</li>
<li>分离目的细胞：质粒上通常带有报告基因，例如GFP，成功被病毒感染的细胞通常会表达这些绿色荧光蛋白，通过FACS就可以将细胞进行筛选出来，然后继续养细胞，长到一定密度后，再通常一定手段（例如WB或qPCR来鉴定目的基因是否导入或者是目的基因是否被敲除，这取决于具体的实验设计）。</li>
</ol>
<h2 id="附录：常见质粒元件"><a href="#附录：常见质粒元件" class="headerlink" title="附录：常见质粒元件"></a>附录：常见质粒元件</h2><h3 id="SV40"><a href="#SV40" class="headerlink" title="SV40"></a>SV40</h3><p>SV40的全称是<code>Simian vacuolating virus 40 or Simian virus 40</code>，即<code>猴空泡病毒40</code>，猿猴病毒40或猴病毒40的缩写，多瘤病毒科，这是在人类和猴子都发现的致瘤病毒。SV40病毒的基因组是一种环形双链的DNA，基因组5.2kb，病毒的直径45nm，病毒成熟部位细胞核，无被膜，62个核壳粒亚单位，这种大小很适于基因操作。同时它也是第一个完成基因组DNA全序列分析的动物病毒。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2017/06/28/Literature/文献笔记-巨噬细胞/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/06/28/Literature/文献笔记-巨噬细胞/" itemprop="url">巨噬细胞笔记</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-06-28T12:00:00+08:00">
                2017-06-28
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/文献笔记/" itemprop="url" rel="index">
                    <span itemprop="name">文献笔记</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  980
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  4
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="什么是巨噬细胞？"><a href="#什么是巨噬细胞？" class="headerlink" title="什么是巨噬细胞？"></a>什么是巨噬细胞？</h2><p>答：</p>
<p>主要文献信息：<br>Ginhoux, F., et al. (2016). “New insights into the multidimensional concept of macrophage ontogeny, activation and function.” Nat Immunol 17(1): 34-40.</p>
<h2 id="巨噬细胞分类"><a href="#巨噬细胞分类" class="headerlink" title="巨噬细胞分类"></a>巨噬细胞分类</h2><p>经典活化型：LPS与IFN-gamma的刺激会诱导一个炎症表型，它能促进TH1应答，有抗菌，抗肿瘤的特性。这种表型称为“经典活化型”，即M1型（classically activated macrophage）。Adams,  D.O.  &amp;  Hamilton,  T.A.  The  cell  biology  of  macrophage  activation.  Annu. Rev. Immunol. 2, 283–318 (1984).</p>
<p>替代活化型巨噬细胞：IL-4或IL-13刺激，特征是产生促炎细胞因子，偏向精氨酸代谢为鸟氨酸（ornithine），表达精氨酸酶，清道夫受体表达增加，吞噬活性增强。即M2型。Stein,  M.,  Keshav,  S.,  Harris,  N.  &amp;  Gordon,  S.  Interleukin  4  potently  enhances murine macrophage mannose receptor activity: a marker of alternative immunologic macrophage activation. J. Exp. Med. 176, 287–292 (1992).</p>
<h2 id="小鼠品系差异"><a href="#小鼠品系差异" class="headerlink" title="小鼠品系差异"></a>小鼠品系差异</h2><p>C57BL/6小鼠的巨噬细胞经LPS刺激后可以将精氨酸代谢为NO，在LPS与IFN-gamma处理后表现出TH1样细胞因子的应答。BALB/c小鼠的巨噬细胞偏向于TH2应答，它将精氨酸代谢为鸟氨酸。因此巨噬细胞分为M1型和M2型。Mills, C.D., Kincaid, K., Alt, J.M., Heilman, M.J. &amp; Hill, A.M. M-1/M-2 macrophages and the Th1/Th2 paradigm. J. Immunol. 164, 6166–6173 (2000).这样划分主要是依照TH1和TH2细胞的应答进行的。</p>
<h2 id="M2细胞的严密划分"><a href="#M2细胞的严密划分" class="headerlink" title="M2细胞的严密划分"></a>M2细胞的严密划分</h2><p>M2细胞红抗炎因子现后表现出一些精密的不同，因此可以进一步划分，即M2a（由IL-4或IL-13诱导），M2b（IL-10诱导），M2c（免疫复合物与LPS诱导）。 Mantovani,  A.  et  al.  The  chemokine  system  in  diverse  forms  of  macrophage<br>activation and polarization. Trends Immunol. 25, 677–686 (2004).</p>
<h2 id="M1-M2划分的不足"><a href="#M1-M2划分的不足" class="headerlink" title="M1-M2划分的不足"></a>M1-M2划分的不足</h2><p>某些疾病中的巨噬细胞不明确地表现出M1和M2表型。<strong>(1)</strong> Egawa, M. et al. Inflammatory monocytes recruited to allergic skin acquire an anti-inflammatory  M2  phenotype  via  basophil-derived  interleukin-4.  Immunity  38, 570–580 (2013).<strong>(2)</strong>Arnold,  L.  et  al.  Inflammatory  monocytes  recruited  after  skeletal  muscle  injury switch  into  antiinflammatory  macrophages  to  support  myogenesis.  J.  Exp.  Med. 204, 1057–1069 (2007).<strong>(3)</strong>Nahrendorf,  M.  &amp;  Swirski,  F.K.  Monocyte  and  macrophage  heterogeneity  in  the heart. Circ. Res. 112, 1624–1633 (2013).</p>
<p>巨噬细胞的微环境决定了巨噬细胞的表型。</p>
<p>除了以下的情况以外，单核细胞不会参与组织巨噬细胞的稳态：肠道，皮肤，心脏（在这三个地方，单核细胞会分化为巨噬细胞）。<strong>(1)</strong>Bain, C.C. et al. Constant replenishment from circulating monocytes maintains the macrophage  pool  in  the  intestine  of  adult  mice.  Nat.  Immunol.  15,  929–937 (2014).<strong>(2)</strong>Tamoutounour, S. et al. Origins and functional specialization of macrophages and of conventional and monocyte-derived dendritic cells in mouse skin. Immunity 39,925–938 (2013).<strong>(3)</strong>Epelman, S. et al. Embryonic and adult-derived resident cardiac macrophages are maintained through distinct mechanisms at steady state and during inflammation. Immunity 40, 91–104 (2014).<br>在一些炎症中，源于胚胎祖细胞的巨噬细胞可以自我更新。 Ginhoux, F. &amp; Jung, S. Monocytes and macrophages: developmental pathways and tissue homeostasis. Nat. Rev. Immunol. 14, 392–404 (2014).</p>
<h2 id="巨噬细胞起源"><a href="#巨噬细胞起源" class="headerlink" title="巨噬细胞起源"></a>巨噬细胞起源</h2><p>参见fig.1<img src="http://ortxpw68f.bkt.clouddn.com/macrophage.png" alt=""></p>
<p>巨噬细胞起源有：（1）</p>
<h2 id="巨噬细胞与感染"><a href="#巨噬细胞与感染" class="headerlink" title="巨噬细胞与感染"></a>巨噬细胞与感染</h2><p>在细菌感染过程中，单核细胞（monocytes）会补充Kupffer细胞的丢失</p>
<p>文献：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Molawi, K. <span class="keyword">and</span> M. H. Sieweke (<span class="number">2015</span>). <span class="string">"Monocytes compensate Kupffer cell loss during bacterial infection."</span> Immunity <span class="number">42</span>(<span class="number">1</span>): <span class="number">10</span><span class="number">-12.</span></div></pre></td></tr></table></figure>
<p>细菌感染会导致Kupffer的坏死性坏死（necroptosis），它会被单细胞来源的巨噬细胞替换。巨噬细胞是髓系细胞的天然免疫细胞，在胚胎形成过程中，大多数驻留组织巨噬细胞会增多，它们会一直持续到成人时期（Gentek, R., Molawi, K., and Sieweke, M.H. (2014).Immunol. Rev. 262 , 56–73.）。但组织中巨噬细胞也会被单核细胞来源的巨噬细胞取代，心脏中的巨噬细胞就是这样，而小肠中的巨噬细胞则不太容易被取代。Ble´ riot, C., Dupuis, T., Jouvion, G., Eberl, G., Dis-<br>son, O., and Lecuit, M. (2015). Immunity 42 , this issue, 145–158.LM感染过程中，M-CSFR与IL-4信号是刺激巨噬细胞增殖的外部信号。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2017/06/28/Literature/文献笔记-中性粒细胞/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/06/28/Literature/文献笔记-中性粒细胞/" itemprop="url">中性粒细胞笔记</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-06-28T12:00:00+08:00">
                2017-06-28
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/文献笔记/" itemprop="url" rel="index">
                    <span itemprop="name">文献笔记</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  1,675
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  7
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="中性粒细胞背景"><a href="#中性粒细胞背景" class="headerlink" title="中性粒细胞背景"></a>中性粒细胞背景</h2><p>中性粒细胞（neutrophils）是循环中白细胞中最非常的细胞。19世纪晚期，Paul Ehrlich用新发明的细胞染色方法研究白细胞（leukocytes）中的亚群，他发现白细胞中存在着一些亚群，其中的一类他称为“多型核细胞”（polymorphous nucleus），即中性粒细胞。</p>
<h2 id="中性粒细胞特征"><a href="#中性粒细胞特征" class="headerlink" title="中性粒细胞特征"></a>中性粒细胞特征</h2><ol>
<li>细胞核呈多核；</li>
<li>含有颗粒状的细胞质，里面含有抗菌物质。</li>
<li>细胞数量：小鼠循环血液中占30%，人类的则占70%.</li>
</ol>
<h2 id="活化"><a href="#活化" class="headerlink" title="活化"></a>活化</h2><p>炎症部位，细菌来源的物质以及宿主产生的炎症信号非常丰富。这些物质及信号包括LPS，fMLP，TNF-alpha，IL-1beta，IL-17会促进内皮细胞产生黏附因子（adhesion），即P-选择素，E-选择素，一些整合素家族的成员（ICAMs）。中性粒细胞表面有两个分子：PSGL-1，L-选择素，这两个分子可以识别内皮细胞的炎症信号，一旦中性粒细胞与内皮细胞随机接触，这两个物质就分别与P选择素和E选择素结合，将中性粒细胞固定在内皮表面。接着中性粒细胞会在内皮表面进行翻滚。</p>
<p>PSGL-1和L-选择素的接触会诱导各种激酶的活化，包括Src家族汽配Syk，还有PI3K，以及p3丝裂原激活蛋白激酶，这种级联反应会改变中性粒细胞的生物学特征，并使细胞进入整合素活化阶段，产生更牢固的黏附。</p>
<p>牢固结合的阶段是由beta2整合素家族蛋白介导的（LFA-a和Mac-1），牢固结合之后就是跨内皮细胞的迁移。随着中性粒细胞在内皮上的翻滚，加上趋化因子，细胞因子，细胞产物的作用，中性粒细胞表面的beta2整合素开始聚合，它的配体是ICAM-1。之后，中性粒细胞产生尖锐边缘的片足，趋化因子受体和吞噬受体会在片足上集合，细胞骨架会重构，向着趋化因子浓度梯度的方向进行迁移，从而诱发中性粒细胞的氧爆作用(oxidative burst)。</p>
<p>中性粒细胞的招募示意图如下所示：<img src="http://ortxpw68f.bkt.clouddn.com/Neutrophil%20recruitment%20to%20sites%20of%20in%EF%AC%82ammation..png" alt=""><br>NET为neutrophil extracellular traps。</p>
<h2 id="中性粒细胞的杀菌物质"><a href="#中性粒细胞的杀菌物质" class="headerlink" title="中性粒细胞的杀菌物质"></a>中性粒细胞的杀菌物质</h2><p>三种颗粒：</p>
<ol>
<li>Azurophilic granules (嗜天青颗粒，也称为as peroxidase-positive或primary granules) ，尺寸最大，直径约为0.3 μM，这是中性粒细胞成熟中最先生成的颗粒，含有 myeloperoxidase (MPO)。</li>
<li>specific颗粒</li>
<li>gelatinase颗粒。</li>
<li><img src="http://ortxpw68f.bkt.clouddn.com/Neutrophil%20granules..png" alt=""></li>
</ol>
<h2 id="中性粒细胞的分离"><a href="#中性粒细胞的分离" class="headerlink" title="中性粒细胞的分离"></a>中性粒细胞的分离</h2><p>根据中性粒细胞的来源（外周血，骨髓，腹腔），中性粒细胞的分离有三种方法：</p>
<h3 id="从骨髓中分离中性粒细胞"><a href="#从骨髓中分离中性粒细胞" class="headerlink" title="从骨髓中分离中性粒细胞"></a>从骨髓中分离中性粒细胞</h3><h4 id="实验原理"><a href="#实验原理" class="headerlink" title="实验原理"></a>实验原理</h4><p>Histopaque主要由葡聚糖、泛影葡胺钠组成，并调整成不同的密度，利用密度梯度离心或双重梯度离心技术，从人、大鼠、小鼠或其他小型哺乳动物全血中分离纯化单核细胞、淋巴细胞和粒细胞等。</p>
<h4 id="实验材料与试剂"><a href="#实验材料与试剂" class="headerlink" title="实验材料与试剂"></a>实验材料与试剂</h4><ol>
<li>Histopaque 1077（密度梯度离心液，Sigma- Aldrich, catalog number: 10771 ; MP Biomedicals, catalog number: 091692254，这个型号是1077）</li>
<li>Histopaque 1119</li>
<li>无菌PBS（HBSS或Hanks液）</li>
<li>离心机</li>
<li>双抗</li>
<li>1640培养基</li>
<li>剪刀，15cm离心管</li>
</ol>
<h4 id="实验步骤"><a href="#实验步骤" class="headerlink" title="实验步骤"></a>实验步骤</h4><ol>
<li>处死小鼠，取出小鼠的股骨和胫骨；</li>
<li>放75%的酒精中消毒，随后再放入无菌PBS冲掉多余的酒精；</li>
<li>剪掉骨头的一头，用PBS冲洗骨头，冲洗三次；</li>
<li>四摄氏度，2000rmp离心5分钟，去掉上清；</li>
<li>用2mL的无菌PBS重悬；</li>
<li>在15mL的离心管底部中加入3mL的Histopaque 1119；</li>
<li>其次，缓慢加入3mL的Histopaque 1077；</li>
<li>最后，缓慢将2mL的细胞悬液加入到Histopaque 1-77的上层；</li>
<li>2000rpm，no brake,no accelerate，4摄氏度，离心30分钟；</li>
<li>在 Histopaque 1119和Histopaque 1077界面处取白色层的细胞；</li>
<li>用加入了双抗的1640培养基冲洗1次（1400rpm，7min，4摄氏度）；</li>
<li>取合适量细胞流式染色Ly-6G和CD11b；</li>
<li>30min后清洗细胞，上机检测细胞纯度。<br>Histopaque的加入分层如下图右图所示：<br><img src="http://ortxpw68f.bkt.clouddn.com/Histopaque.png" alt=""></li>
</ol>
<h3 id="外周血中性粒细胞的分离"><a href="#外周血中性粒细胞的分离" class="headerlink" title="外周血中性粒细胞的分离"></a>外周血中性粒细胞的分离</h3><h4 id="实验步骤-1"><a href="#实验步骤-1" class="headerlink" title="实验步骤"></a>实验步骤</h4><ol>
<li>收集4mL的PMBC，加入肝素化的试管中；</li>
<li>在15mL的离心管中加入4mL的Histopaque。</li>
<li>将PMBC轻轻加到Histopaque的上层（要注意Histopaque与PMBC呈现明显的两层，动作不能过大）。</li>
<li>100g，离心30分钟，刹车与加速都要调到最小。</li>
<li>吸取白色的细胞层（位于Histopaque和培养基之间，如下图的左图所示），这一步要在10分钟内完成 。</li>
<li>用PBS清洗细胞两次（100g，10分钟），4mL的PBMC约能取到1X10e7-8个细胞。<br><img src="http://ortxpw68f.bkt.clouddn.com/Histopaque.png" alt=""></li>
</ol>
<h4 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h4><ol>
<li>Histopaque与所要离心的外周血体积比为1:1。</li>
<li>Histopaque的储存温度是4摄氏度，在使用之前，要将Histopaque置于室温下1到2个小时，使其温度与室温接近，因为PBMC在低温下会发生冷休克（cold shock），并有可能在离心过程中形成聚集物。</li>
</ol>
<h2 id="中性粒细胞杀伤作用评价"><a href="#中性粒细胞杀伤作用评价" class="headerlink" title="中性粒细胞杀伤作用评价"></a>中性粒细胞杀伤作用评价</h2><p>（Blank, B. S., et al. (2014). “Misregulation of the broad-range phospholipase C activity increases the susceptibility of Listeria monocytogenes to intracellular killing by neutrophils.” Microbes and Infection 16(2): 104-113.）</p>
<ol>
<li>纯化后的BMN（骨髓来源中性粒细胞）用1640培养基混匀（加10% FBS，10mM HEPES），抑肽酶（aprotinin）浓度为0.4ug/mL，浓度为2X10e7/mL。</li>
<li>加入细菌，离心10分钟，700g。</li>
<li>孵育25分钟（吞菌）</li>
<li>用Opti-MEM培养基（含有50ug/ gentamicin）来替代原来的培养基；</li>
<li>感染25分钟后（从离心后开始计算时间），用含有200ug/mL的gentamicin的完全培养基清洗细胞；，</li>
<li>继续孵育30分钟，杀死细胞外细菌；</li>
</ol>
<h2 id="中性粒细胞的流式鉴定"><a href="#中性粒细胞的流式鉴定" class="headerlink" title="中性粒细胞的流式鉴定"></a>中性粒细胞的流式鉴定</h2><h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><ol>
<li>Amulic B, Cazalet C, Hayes G L, et al. Neutrophil Function: From Mechanisms to Disease[J]. Annual Review of Immunology, 2012, 30(1):459.</li>
<li><a href="http://www.bioon.com/trends/news/609626.shtml" target="_blank" rel="external">http://www.bioon.com/trends/news/609626.shtml</a></li>
<li>Panda, S. K., S. Kumar, N. C. Tupperwar, T. Vaidya, A. George, S. Rath, V. Bal and B. Ravindran (2012). Chitohexaose activates macrophages by alternate pathway through TLR4 and blocks endotoxemia. PLoS Pathog 8(5): e1002717.</li>
<li>Boari, J. T. and Rodríguez, E. A. (2012). Adoptive Transfer of Isolated Bone Marrow Neutrophils. Bio-protocol 2(23): e298. DOI: 10.21769/BioProtoc.298; Full Text</li>
<li>Tosello Boari, J., Amezcua Vesely, M. C., Bermejo, D. A., Ramello, M. C., Montes, C. L., Cejas, H., Gruppi, A. and Acosta Rodriguez, E. V. (2012). IL-17RA signaling reduces inflammation and mortality during Trypanosoma cruzi infection by recruiting suppressive IL-10-producing neutrophils. PLoS Pathog 8(4): e1002658.</li>
<li>Swamydas M, Lionakis MS. Isolation, Purification and Labeling of Mouse Bone Marrow Neutrophils for Functional Studies and Adoptive Transfer Experiments. Journal of Visualized Experiments : JoVE. 2013;(77):50586. doi:10.3791/50586.</li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2017/06/22/BioStatistics/生物统计-12COX比例风险回归模型/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/06/22/BioStatistics/生物统计-12COX比例风险回归模型/" itemprop="url">COX比例风险回归模型笔记</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-06-22T12:02:00+08:00">
                2017-06-22
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/生物统计/" itemprop="url" rel="index">
                    <span itemprop="name">生物统计</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  1,602
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  6
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="COx回归模型简介"><a href="#COx回归模型简介" class="headerlink" title="COx回归模型简介"></a>COx回归模型简介</h2><p>Kaplan-Meier法与寿命表法研究的是单个分组变量的生存分析，而Cox比例风险回归模型（Cox proportional hazard regression medel）研究的由是多因素生存分析的主要方法。此方法是由英国统计学家Cox提出的而因此命名。</p>
<h3 id="Cox模型的基本形式"><a href="#Cox模型的基本形式" class="headerlink" title="Cox模型的基本形式"></a>Cox模型的基本形式</h3><script type="math/tex; mode=display">h(t,{\bf{X}})=h_{0} exp({\bf{\beta' X}})=h_{0}exp(\beta_{1}X_{1}+\beta_{2}X_{2}+\cdots+\beta_{m}X_{m})</script><p>其中$h(t,{\bf{X}})$是具有协变量${\bf{X}}$的个体在时刻t时的风险函数，t为生存时间，${\bf{X}}=(X_{1},X_{2},\cdots,X_{m})’$是可能影响生存时间的有关因素，也称协变量，这些变量可以是定量的，也可以是定性的，在整个观察期间内不随时间的变化而变化。$h_{0}(t)$是所有协变量取0时的风险函数，称为基线风险函数（）。${\bf{\beta}}=(\beta1,\beta2,\cdots,\beta_{m})’$为Cox模型的回归系数，是一组估的回归参数。由于此公式右侧的$h_{0}(t)$不需要服从特定的分布是形状，具有非参数的特点，而指数部分$exp({\bf{\beta’X}})$具有参数模型的形式，因此模型又称为半参数模型（semi-parametric model）。</p>
<p>如果采用生存率表示，则模型可写为：</p>
<script type="math/tex; mode=display">S(t,{\bf{X}}=S_{0}(t)^{exp({\bf{\beta'X}})}=S_{0}(t)^{exp(\beta_{1}X_{1}+\beta_{2}X_{2}+\cdots+\beta_{m}X_{m})}</script><p>其中S(t,X)是具有协变量X的个体在时刻t时的生存率，$S_{0}(t)$为在时刻t的基线生存率。</p>
<h3 id="RR或HR"><a href="#RR或HR" class="headerlink" title="RR或HR"></a>RR或HR</h3><p>两个分别具有协变量$X_{i}$和$X_{j}$的个体，其风险函数之比筄为相对危险度（risk ration，RR）或风险比（hazard ration，HR），是一个与时间无关的量，即</p>
<script type="math/tex; mode=display">h(t,{\bf{X_{i}}}/h(t,{\bf{X_{j}}}=exp[{\bf{\beta(X_{i}-X_{j)})}}]</script><p>例如$X_{i}$是暴露组观察对象对应各因素的聚会，$X_{j}$是非暴露组观察对象对应各因素的取值，求得${\bf{\beta}}$的估计时后就能救出暴露组对非暴露组的相对危险度估计。</p>
<h3 id="因素的初步筛选与最佳模型的建立"><a href="#因素的初步筛选与最佳模型的建立" class="headerlink" title="因素的初步筛选与最佳模型的建立"></a>因素的初步筛选与最佳模型的建立</h3><p><strong>1. 因素的筛选</strong>：影响生存时间的因素称为协变量，当协变量较多时，需要对这些协商量进行筛选。</p>
<p><strong>2. 最佳模型的建立</strong>：为建立最佳模型常需要对研究的因素进行筛选，筛选因素的方法有前进法，后退法和逐步回归法。在逐步筛选变量建立多元Cox回归模型的时候需要规定检验水准，以确定方程中引入哪些因素和剔除哪些因素，一般情况下确定引入检验的水准为0.05，剔除检验水准为0.1。检验各因素是否有统计学意义的方法有似然比检验、Wald检验和计分检验。</p>
<h3 id="比例风险假定的检验"><a href="#比例风险假定的检验" class="headerlink" title="比例风险假定的检验"></a>比例风险假定的检验</h3><p>Cox比例风险回归模型的主要前提是假定风险比值$h(t)/h_{0}(t)$为固定值，即协变量对生存率的影响不随时间的改变而改变，只有该条件得到满足，Cox回归模型的结果才有效，检验这一假定条件的方法有：</p>
<p>①如果分类协变量的每一组别的Kaplan-Meier生存曲线间无交叉，同满足比例风险假定；</p>
<p>②以生存时间t为横轴，对数生存率$ln[-ln\hat{S}(t)]$为纵轴，绘制分类协变量每一组别的生存曲线，如果协变量各组别对应的曲线平行，则满足风险比例条件；</p>
<p>③对于连续型协变量，可将每个协变量与对数生存时间的交互作用项$(Xln(t))$放入回归模型中，如果交互作用项无统计学意义，则满足风险比例条件。</p>
<p>当风险比例的假定条件不成立时，可采用如下方法解决：①将不成比例的协变量作为分层变量，然后再用其余变量进行多元Cox回归模型分析；②采用参数回归模型替代Cox回归模型进行分析。</p>
<h3 id="案例分析流程"><a href="#案例分析流程" class="headerlink" title="案例分析流程"></a>案例分析流程</h3><h4 id="案例"><a href="#案例" class="headerlink" title="案例"></a>案例</h4><p>（例19-5）为探讨某恶性肿瘤的预后，某研究值得收集了63例患者的生存时间生存结局及影响因素。影响因素包括患者年龄、性别、组织学类型、治疗方式、淋巴结转移、肿瘤浸润程度，生存时间t以月计算。变量的同形和所收集的资料分别见下表，试用Cox回归模型进行分析。<br><img src="http://ortxpw68f.bkt.clouddn.com/cox1.png" alt=""></p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/cox2.png" alt=""></p>
<p>完整数据<a href="https://github.com/20170505a/raw_data/blob/master/data_szq_survival_cox1.csv" target="_blank" rel="external">单击此处</a>。</p>
<h4 id="R包及函数"><a href="#R包及函数" class="headerlink" title="R包及函数"></a>R包及函数</h4><p>所用到R包为survival，所用函数如下所示：</p>
<ol>
<li>coxph：构建COX回归模型</li>
<li>cox.zph：检验PH假设是否成立</li>
<li>survreg：构建参数模型</li>
</ol>
<h4 id="计算流程"><a href="#计算流程" class="headerlink" title="计算流程"></a>计算流程</h4><h5 id="导入原始数据："><a href="#导入原始数据：" class="headerlink" title="导入原始数据："></a>导入原始数据：</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">data1905 &lt;- read.csv(&quot;https://raw.githubusercontent.com/20170505a/raw_data/master/data_szq_survival_cox1.csv&quot;,sep=&quot;,&quot;)</div><div class="line"># read raw data</div></pre></td></tr></table></figure>
<h5 id="构建生存分析对象："><a href="#构建生存分析对象：" class="headerlink" title="构建生存分析对象："></a>构建生存分析对象：</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">data1905.surv &lt;- Surv(data1905$t,data1905$Y)</div><div class="line">coxph.data1905 &lt;- coxph(data1905.surv ~ X1+X2+X3+X4+X5+X6,</div><div class="line">                        data=data1905,</div><div class="line">                        method=&quot;breslow&quot;)</div></pre></td></tr></table></figure>
<h5 id="筛选变量："><a href="#筛选变量：" class="headerlink" title="筛选变量："></a>筛选变量：</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">step(coxph.data1905)</div></pre></td></tr></table></figure>
<p>结果如下所示：<img src="http://ortxpw68f.bkt.clouddn.com/cox3.jpg" alt=""></p>
<h5 id="AIC信息准则"><a href="#AIC信息准则" class="headerlink" title="AIC信息准则"></a>AIC信息准则</h5><p>从筛选的变量结果来看，里面含有AIC的字样，AIC的全称为Akaike information criterion，这是衡量统计模型拟合优良性的一种标准，由于它为日本统计学家赤池弘次创立和发展的，因此又称赤池信息量准则。</p>
<p>在一般的情况下，AIC可以表示为： AIC=2k-2ln(L)<br>其中：k是参数的数量，L是似然函数。 假设条件是模型的误差服从独立正态分布。 让n为观察数，RSS为剩余平方和，那么AIC变为： AIC=2k+nln(RSS/n)。</p>
<p>AIC鼓励数据拟合的优良性但是尽量避免出现过度拟合(Overfitting)的情况。<strong>所以优先考虑的模型应是AIC值最小的那一个</strong>。赤池信息准则的方法是寻找可以最好地解释数据但包含最少自由参数的模型。</p>
<p>从<code>step(coxph.data1905)</code>计算的结果来看，筛选出来的变量是X4和X5，如下所示：<br><img src="http://ortxpw68f.bkt.clouddn.com/cox4.jpg" alt=""></p>
<p>然后对X4和X5进行Cox回归，如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">fit &lt;- coxph(data1905.surv~X4+X5,data=data1905,method = &quot;breslow&quot;)</div><div class="line">fit</div></pre></td></tr></table></figure>
<p>结果如下所示：<br><img src="http://ortxpw68f.bkt.clouddn.com/cox5.png" alt=""></p>
<p>从结果中可以看来，新型疗法的死亡风险只是传统疗法的0.172倍，协变量X5对应的相对危险度为2.538，这说明有淋巴结转移者的死亡风险是无淋巴结转移风险者的2.5倍。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2017/06/21/BioStatistics/生物统计-11生存分析/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/06/21/BioStatistics/生物统计-11生存分析/" itemprop="url">生存分析笔记</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-06-21T12:01:00+08:00">
                2017-06-21
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/生物统计/" itemprop="url" rel="index">
                    <span itemprop="name">生物统计</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  3,049
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  12
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="生存分析"><a href="#生存分析" class="headerlink" title="生存分析"></a>生存分析</h2><p>使用对象：生存分析（survival analysis）使是将事件的结果和出现这一结果所经历的时间结合起来分析的一类统计分析方法，不仅考虑事件是否出现，而且也考虑事件出现的时间长短，因此这类方法也称为事件时间分析（time-to-event analysis）。</p>
<p>生存分析的资料通常有以下特点：①同时考虑生存时间和生存结局；②通常含有删失数据；③生存时间的分布通常不服从正态分析。</p>
<h3 id="以案例说明各种术语"><a href="#以案例说明各种术语" class="headerlink" title="以案例说明各种术语"></a>以案例说明各种术语</h3><p>以教材中的案例一下：<br>例19-1  为了估计HIV（人类免疫缺陷病毒）阳性患者的生存时间，某研究者进行了临床随访研究。研究对象是于2002年1月1日至2004年12月31日期间在某市确诊为HIV阳性者，随访这些对象直至死于AIDS（艾滋病）或其并发症（status=1为死亡，0为删失），研究截至日期为2008年12月31日。并记录每个研究对象的性别（sex=1为男， 0为女）、年龄（age，岁）、是否用药（drug=1为用药，0为不用），2017-09-26 15:09:14结果见表19-1所示。<br><img src="http://ortxpw68f.bkt.clouddn.com/19-1.png" alt=""></p>
<h4 id="起始事件、终点事件、生存时间"><a href="#起始事件、终点事件、生存时间" class="headerlink" title="起始事件、终点事件、生存时间"></a>起始事件、终点事件、生存时间</h4><p>事件可以分为起始事件（initial event）和终点事件（terminal event），从起始事件到终点事件之间所经历的时间跨度为生存时间（survival time），常记为随机㸄T，其中T&gt;=0，其值记为t。</p>
<p>在例19-1中的起始事件就是“确认HIV明性”，感兴趣的终点事件为“死于AIDS或其并发症”。表19-1中的起始日期（entdate）至终点日期（enddate）之间的月数就是生存时间（time），如编号ID个体的生存时间t=10个月。</p>
<h4 id="生存时间的分布"><a href="#生存时间的分布" class="headerlink" title="生存时间的分布"></a>生存时间的分布</h4><p>生存时间的分布通常不呈正态分布，而呈偏态分布，如呈指数分析、Weibul分布、Gompertz分布、对数Logistic分布等，下图就是19-1中的生存间分布图，其中组距为6个月，横轴是生存时间，纵轴是频率（%，其分子为频数，分母为总例数）：<br><img src="http://ortxpw68f.bkt.clouddn.com/19-1-2.png" alt=""></p>
<h4 id="删失"><a href="#删失" class="headerlink" title="删失"></a>删失</h4><p>生存结局（status）分为“死亡”和“删失”两类，“死亡”是感兴趣的终点事件，其它的终点事件或生存结局都归于删失（censoring，也称为示截尾或终检）。产生删失的原因可能为：①研究截至日期时，感兴趣终点事件仍未出现；②因搬迁等原因失去联系，不知感兴趣终点事件何时发生或是否会发生；③困其它各种原因中途退出；④死亡其它“事件”，例如交通事故或其它产生。</p>
<p>删失分为左删失、区间删失、右删失3类。</p>
<p>左删失：只知道感兴趣终点事件会在目前知晓时间（如截至时间、失访时间、死于其它疾病时间）之前发生。</p>
<p>区间删失：只知道感兴趣终点事件会在某一区间内发生。</p>
<p>右删失：只知道感兴趣终点事件会在知晓昱是之后发生。例如表19-1的ID=2个体的生存时间为1个月，因为是删失个体，所以该个体至少可以存活1个月，记为t=1+(月)，采用“+”就表示个体为右删失。</p>
<h4 id="生存时间图示"><a href="#生存时间图示" class="headerlink" title="生存时间图示"></a>生存时间图示</h4><p>每一个体进入随访队列的时间可以相同也可以不相同，当起时间不相同的时候，一般应规定一个时间范围，如例19-1就规定2002年1月1日至2004年12月31日。通常研究也会规研究截至时间，例19-1就规定为2008年12月31日。为了采用图形反映生存时间，特从表19-1中取出了个5个个体。生存结局根据记录的“终点事件”获得。生存时间通地客经2列和第3列的起始日期与终点日期计算获得。<br><img src="http://ortxpw68f.bkt.clouddn.com/19-1-3.png" alt=""><br><img src="http://ortxpw68f.bkt.clouddn.com/19-1-4.png" alt=""><br>图19-2分别采用年历时间（图19-2a）和生存时间（图19-2b）反映了表19-2中5个个体的生存情况，用“X”表示“死亡”，用“o”表示“删失”。第4、29、78号个体“死于AIDS”，即死于感兴趣的终点事件，其终点标记为“X”。第38号、39号个体为删失数据，其终点标记为“o”。第38号个体删失的原因为“失访”；第89号个体删失的原因为已到“截至日期”，感兴趣终点事件仍然没有发生。</p>
<h4 id="生存率"><a href="#生存率" class="headerlink" title="生存率"></a>生存率</h4><p>如果对图19-1的生存时间直方图拟合一条光滑曲线（图19-3），如下所示：<img src="http://ortxpw68f.bkt.clouddn.com/19-1-5%EF%BC%882%EF%BC%89.png" alt="曲线"><br>则这条曲线就是死亡概率密度函数（probability density funciotn,PDF）曲线，死亡概率密度函数记为f(t)，其定义为：</p>
<script type="math/tex; mode=display">f(t)=\lim_{\Delta \to 0} \frac{P(t\leq T< t + \Delta t)}{\Delta t}</script><p>如果资料中没有删失数据，则生存率如下所示：</p>
<script type="math/tex; mode=display">S(t)=P(Tt)=\frac{t时刻仍存活的例数}{观察总例数}</script><p>如果含有删失数据，则要分时段计算生存概率。假定观察对象在各个时段的生存事件独立，应用概率乘法定量将各时段的生存概率相乘得到生存率，如下所示：</p>
<script type="math/tex; mode=display">S(t)=p_{1}\cdot p_{2} \cdots p_{i} \cdots p_{k}=S(t_{k-1})\cdot p_{k}</script><p>其中</p>
<script type="math/tex; mode=display">p_{i}(i=1,2, \cdots,k)$$是各时段的生存概率。对于以区间陈列的生存时间资料，可以采用以下的公式来计算死亡概率密度函数值：
$$f(t)=[S(t_{i-1})-S(t_{i})]</script><p>其中，$wi$为第i区间的时间宽度，$S(t_{i-1})$、$S(t_{i})$分别是时间$t_{i-1})$和$t_{i})$的生存率。</p>
<h4 id="生存概率与死亡概率"><a href="#生存概率与死亡概率" class="headerlink" title="生存概率与死亡概率"></a>生存概率与死亡概率</h4><p>生存概率（probablity of survival）表示某时段开始时存活的个体，到该时段估结束时仍存活的可能性。如年生存要纺表示年初尚存人口存活满一年的可能性。如下所示：</p>
<script type="math/tex; mode=display">p=\frac{活过该年人数}{某年年初人数}</script><p>死亡概率（probablity of death）表示某时段开始时存活的个体，在该时段内死亡的可能性。如年死亡概率表示年初尚存人口在今后1年内死亡的可能性，如下所示：</p>
<script type="math/tex; mode=display">q=\frac{该年内死亡人数}{某年年初人口数}</script><p>显然，死亡概率$q=1-p$。</p>
<p>注：死亡概率与一般死亡率（death rate或mortality rate）有所不同，如年死亡率：</p>
<script type="math/tex; mode=display">m=\frac{该年内死亡人数}{某年平均人口数}</script><p>其分母不同，为”某年平均人口数”，但分子相同。</p>
<h4 id="风险函数"><a href="#风险函数" class="headerlink" title="风险函数"></a>风险函数</h4><p>风险率（hazard rate）或风险函数（hazard funciton）记为h(t)，定义如下所示：</p>
<script type="math/tex; mode=display">f(t)=\lim_{\Delta \to 0} \frac{P[(t\leq T< t + \Delta t|(T\geq t))}{\Delta t}=\frac{f(t)}{S(t)}</script><p>公式解读：已生存到时间t的观察对象在t时刻的瞬时死亡率。为非负数，且可以$&gt;1$。当Δt=1，$h(t)\approx P(t\leq T &lt; t+1|T \geq t)$，此时的风险率就是时刻t存活的个体在此后一个单位时段内的死亡概率。</p>
<p>累积风险函数（cumulative hazard function），记为H(t)，与和正函数之间的关系为H(t)=-lnS(t)</p>
<h2 id="生存分析的两种方法"><a href="#生存分析的两种方法" class="headerlink" title="生存分析的两种方法"></a>生存分析的两种方法</h2><h3 id="Kaplan-Meier法"><a href="#Kaplan-Meier法" class="headerlink" title="Kaplan-Meier法"></a>Kaplan-Meier法</h3><p>R中与生存分析有关的包是survival，会涉及到三个函数，如下所示：</p>
<ul>
<li>Surv：用于创建生存数据对象</li>
<li>survfit：创建KM生存曲线或是Cox调整生存曲线</li>
<li>survdiff：用于不同组的统计检验，其中rho数量参数用以指定检验类型，0为log-rank法或Mantel-Haenszel法，1为Wilcoxon法，默认为0。</li>
</ul>
<h4 id="案例1：Kaplan-Meier法，生存曲线，"><a href="#案例1：Kaplan-Meier法，生存曲线，" class="headerlink" title="案例1：Kaplan-Meier法，生存曲线，"></a>案例1：Kaplan-Meier法，生存曲线，</h4><p>例19-2  为了比较不同手术方法治疗肾上腺肿瘤的疗效，某研究者随机将43例病人分成两组，甲组23例、乙组20例的生存时间（月）如下所示：</p>
<h5 id="原始数据如下所示："><a href="#原始数据如下所示：" class="headerlink" title="原始数据如下所示："></a>原始数据如下所示：</h5><p>甲组：1，3，5（3），6（3），7，8，10（2），14+，17，19+，20+ ，22+，26+，31+，34， 34+，44，59</p>
<p>乙组：1（2），2，3（2），4（3），  6（2），8，9（2），10，11，12，13，15，17，18<br>其中有“+”者是删失数据，表示病人仍生存或失访，括号内为重复死亡数。试计算甲组的生存率与标准误。</p>
<p>计算过程如下所示：</p>
<h5 id="导入原始数据"><a href="#导入原始数据" class="headerlink" title="导入原始数据"></a>导入原始数据</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">library(survival)</div><div class="line">library(coin)</div><div class="line"></div><div class="line"># 导入例题19-02的数据文件</div><div class="line">data1902 &lt;- read.csv(&quot;https://raw.githubusercontent.com/20170505a/raw_data/master/data_szq_1902.csv&quot;,sep=&quot;,&quot;)</div><div class="line"></div><div class="line">str(data1902) # 查看数据结构</div></pre></td></tr></table></figure>
<p>如下所示：</p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/survival-1.jpg" alt=""></p>
<p>可以发现，group都是整数型，需要将其转换为因子类型的数据：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">data1902$group &lt;-as.factor(data1902$group) #将分组转化为因子类型的数据</div><div class="line">str(data1902)</div></pre></td></tr></table></figure>
<p>转换结果如下所示：</p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/survival-2.jpg" alt=""></p>
<h5 id="创建生存分析的对象："><a href="#创建生存分析的对象：" class="headerlink" title="创建生存分析的对象："></a>创建生存分析的对象：</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">Surv(data1902$t,data1902$status==1) </div><div class="line">#此语句的意思是创建一个生存分析对象；</div><div class="line">#status==1表示完整数据，0为删失数据；</div><div class="line"># 其中&quot;+&quot;是删失的数据，表示病人仍生存或失访</div></pre></td></tr></table></figure>
<p>生存分析对象如下所示：</p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/survival-4.jpg" alt=""></p>
<h5 id="生存分析各种参数进行计算："><a href="#生存分析各种参数进行计算：" class="headerlink" title="生存分析各种参数进行计算："></a>生存分析各种参数进行计算：</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">data.fit &lt;- survfit(Surv(t,status==1)~group,data=data1902) </div><div class="line">summary(data.fit)</div><div class="line"># 查看分析结果，group=1表示甲组，2表示乙组</div></pre></td></tr></table></figure>
<p>计算结果如下所示：</p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/survival-3.jpg" alt=""></p>
<h5 id="Surv-结果说明："><a href="#Surv-结果说明：" class="headerlink" title="Surv()结果说明："></a>Surv()结果说明：</h5><ol>
<li>time表示的是生存时间，这里与教材中的不太一样，教材中的信息比较全，而R中只列举了有死亡事件出现的生存时间，例如教材中的14个月有数据，而R中没有，因为在14月这个生存时间内，没有死亡，但R中没有列出，没有教材中的详细</li>
<li>n代表处于风险中的人数，这个数字就是上一个生存时间内的人数减去上一个生存时间内的死亡人数</li>
<li>n.event代表的是事件数，默认的status==1表示的是1代表死亡；</li>
<li>survival表示的是生存率</li>
<li>std.err表示的是生存率的标准误；</li>
<li>lower 95% CI：下95%置信区间；</li>
<li>upper 95% CI：上95%置信区间。</li>
</ol>
<h5 id="Log-Rank检验："><a href="#Log-Rank检验：" class="headerlink" title="Log-Rank检验："></a>Log-Rank检验：</h5><p>这里使用的是Log-Rank检验法，</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">survdiff(Surv(t,status==1)~group,data=data1902)</div><div class="line"># 比较两条生存曲线的差异，用的是Log-rank检验</div></pre></td></tr></table></figure>
<p>如下所示<br><img src="http://ortxpw68f.bkt.clouddn.com/survival-5.jpg" alt="">：</p>
<p>可以发现，${\chi}^2$ 值为8.8，p值为0.00309，可见这两种组别的数据有差异。</p>
<h5 id="绘制生存曲线："><a href="#绘制生存曲线：" class="headerlink" title="绘制生存曲线："></a>绘制生存曲线：</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">plot(data.fit,col=c(&quot;red&quot;,&quot;blue&quot;),lwd=1) #绘图</div><div class="line"></div><div class="line">legend(&quot;topright&quot;,legend=c(&quot;甲组&quot;,&quot;乙组&quot;),col=c(&quot;red&quot;,&quot;blue&quot;),lty=1,cex=0.8,adj=-0.7,bty=&quot;o&quot;) </div><div class="line">#加图例</div></pre></td></tr></table></figure>
<p>如下所示：</p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/survival-6.png" alt=""></p>
<p>或者使用survminer包中的ggsurvplot生成图片：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">library(survminer)</div><div class="line">data.fit &lt;- survfit(Surv(data1$time~data1$status)~data1$group)</div><div class="line">ggsurvplot(data.fit,legend.title = &quot;Sex&quot;,legend.labs = c(&quot;甲组&quot;, &quot;乙组&quot;))</div></pre></td></tr></table></figure>
<p>如下所示：<br><img src="http://ortxpw68f.bkt.clouddn.com/ggsurvplot.png" alt=""></p>
<h5 id="中位数生存时间"><a href="#中位数生存时间" class="headerlink" title="中位数生存时间"></a>中位数生存时间</h5><p>中位数生存时间（median survival time）又称为生存时间的中位数，表示刚好有50%的个体其存活期大于该时间。</p>
<p>计算中位数生存时间的方法有两种：</p>
<p>①在纵轴生存率为0.5处画一条与横轴平等的线，并与生存率曲线相交，然后自交点画垂线与横轴相交，此效应对应的时间点即为中位生存时间，但结果较粗略，如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">plot(data.fit,col=c(&quot;red&quot;,&quot;blue&quot;),lwd=1) #绘图</div><div class="line"></div><div class="line">legend(&quot;topright&quot;,legend=c(&quot;甲组&quot;,&quot;乙组&quot;),col=c(&quot;red&quot;,&quot;blue&quot;),lty=1,cex=0.8,adj=-0.7,bty=&quot;o&quot;) </div><div class="line">#加图例 </div><div class="line"></div><div class="line">abline(h=0.5)</div></pre></td></tr></table></figure>
<p><img src="http://ortxpw68f.bkt.clouddn.com/suvival-median2.jpeg" alt=""></p>
<p>②线性内插法，原理见书，但R中有类似的方法，如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">a &lt;- which(data1902$group==1)</div><div class="line">b &lt;- which(data1902$group==2)</div><div class="line">data1902[a]</div><div class="line">data1902[b]</div><div class="line">median_a &lt;- Surv(data1902[a,]$t,data1902[a,]$status==1)</div><div class="line">median_b &lt;- Surv(data1902[b,]$t,data1902[b,]$status==1)</div><div class="line">summary(median_a)</div><div class="line">summary(median_b)</div></pre></td></tr></table></figure>
<p><img src="http://ortxpw68f.bkt.clouddn.com/survival-median.png" alt=""></p>
<p>可以看到，甲组的中位数生存时间为10个月；乙组为7个月，跟书中略有出入。</p>
<h2 id="案例分析补充"><a href="#案例分析补充" class="headerlink" title="案例分析补充"></a>案例分析补充</h2><h3 id="案例1"><a href="#案例1" class="headerlink" title="案例1"></a>案例1</h3><p>某研究者分别用免疫疗法、药物与免疫结合疗法治疗黑色素瘤患者，经随访得到各患的生存时间（月）见下表（孙振球. 医学统计学习题解答-第4版[M]. 人民卫生出版社, 2015.P136）。</p>
<ol>
<li>试彩乘积极限法计算其生存率及其标准误。</li>
<li>对两组的生存率进行log-rank可检验。</li>
<li>绘制生存曲线。</li>
</ol>
<p>计算过程如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">library(survival)</div><div class="line">library(coin)</div><div class="line">data1&lt;- read.csv(&quot;https://raw.githubusercontent.com/20170505a/raw_data/master/data_szq_survival_case1.csv&quot;,sep=&quot;,&quot;)</div><div class="line">data1$group &lt;-as.factor(data1$group) #将分组转化为因子类型的数据</div><div class="line">Surv(data1$time,data1$status==1)</div><div class="line">data.fit &lt;- survfit(Surv(data1$t,data1$status==1)~data1$group) </div><div class="line">summary(data.fit)</div><div class="line">survdiff(Surv(time,status==1)~group,data=data1) </div><div class="line">plot(data.fit,col=c(&quot;red&quot;,&quot;blue&quot;),lwd=1) #绘图</div><div class="line">legend(&quot;topright&quot;,legend=c(&quot;BCG治疗组&quot;,&quot;药物和BCG治疗组&quot;),col=c(&quot;red&quot;,&quot;blue&quot;),lty=1,cex=0.8,x.intersp=1,bty=&quot;o&quot;)</div></pre></td></tr></table></figure>
<p>标准误与生存率：</p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/survival_case1_1.png" alt=""></p>
<p>两组进行比较：<br><img src="http://ortxpw68f.bkt.clouddn.com/survival_case1_2.png" alt=""><br>p值为0.811，还不能认为两种治疗方法有差异。</p>
<p>生存曲线：<br><img src="http://ortxpw68f.bkt.clouddn.com/survival_case1_3.png" alt=""></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2017/06/09/BioStatistics/生物统计-11Logistics回归/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/06/09/BioStatistics/生物统计-11Logistics回归/" itemprop="url">广义线性模型与Logistics回归笔记</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-06-09T12:02:00+08:00">
                2017-06-09
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/生物统计/" itemprop="url" rel="index">
                    <span itemprop="name">生物统计</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  6,715
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  28
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="一般线性模型与广义线性模型"><a href="#一般线性模型与广义线性模型" class="headerlink" title="一般线性模型与广义线性模型"></a>一般线性模型与广义线性模型</h2><p>由于统计模型的多样性和各种模型的适应性，针对因变量（也就是我们常用于回归方程中的y）和解释变量（就是自变量，也就是我们常用于回归的x）的取值性质，可以将统计模型分为多种类型。通常自变量为定性变量的线性模型称为<code>一般线性模型（general linear model，GLM）</code>，如实验设计模型、方差分析模型。因变量为非正态分布的线性模型为<code>广义线性模型（Generalized linear model,GENMOD）</code>，如Logistic回归模型、对数线性模型和Cox比例风险模型。</p>
<p>对于一般线性线性模型，其基本假定是y服从正态分布，或至少y的方差$\sigma^2$为有限常数。但是在实际研究中，情况并非总是如此，例如当y是发病率(y=k/n)时，y服从二项分布，期望值和方差分别为E(y)=π，Var(y)=1/n x π(1-π)，其方差与倒数呈反比，且是π的函数。又如，当y是单位时间内的放射性计数时，y服从Poisson分布，期望值和方差分别为E(y)=μ,Var(y)=μ，方差是μ的函数。实际数据中有很多资料均不符合一般线性模型的基本假定。尽管也可以将频率或频数作为y代入一般线性模型，但拟合结果往往不能令人满意，例如会出现频率的拟合值y&gt;1、频数的拟合值y&lt;0这种奇怪现象。</p>
<p>后来有人在一般线性模型的基础上，对$\sigma^2$为有限常数的假定作了进一步的推广，提出了广义线性模型的概念和<code>拟似然函数(quasi-likelihood function)</code>的方法，用于求解满足下列条件的线性模型：</p>
<p>$E(y) = \mu $</p>
<p>$m(\mu) = X\beta$</p>
<p>$cov(y) = \sigma^2 V(\mu) \quad （一）$</p>
<p>其中m为连接函数组成的向量，将$\mu$转化为$\beta$的线性表达式，$V(\mu)$为$n \times n$矩阵，其中每个元素均为$\mu$的函数，当处$y_{i}$值相互独立时，$V(\mu)$为对角矩阵。当$m(\mu)=\mu$，$V(\mu)=I$时，(一)中的三个公式为一般线性模型，也就是说，（一）中包括了一般线性模型。在广义线性模型中，均假定观察值y具有指数族概率密度函数，如下所示：</p>
<p>$f(y|\theta,\phi) = exp{[y\theta -b(\theta)]/a(\phi)=c(y,\phi)} \quad (二)$</p>
<p>其中，a、b和c是三种函数形式，θ为典则参数，如果给定φ（散布参数，有时写作$\sigma^2$），<code>（二）</code>式就是具有参数θ的指数族密度函数，以正式分布为例：</p>
<p>与<code>（二）</code>式对照，如下所示：</p>
<p>$\theta=\mu$</p>
<p>$b(\theta)=\mu^2/2$</p>
<p>$\phi=\sigma^2$</p>
<p>$a(\phi)=\sigma^2$</p>
<p>$c(y,\phi)=-\frac{1}{2}[y^2/\sigma^2 + ln(2\pi\sigma^2) ]$</p>
<p>根据样本和y的函数可建立对数似然函数，并可导出y的期望值和方差。在广义线性模型中，<code>（二）</code>式中的典则参数不仅仅是μ的函数，还是参数β0，β1,..βp的线性表达式，因此对μ作变换，则可得到下面三种分布连接函数的形式：</p>
<p>正态分布：$m(\mu)=\mu=\sum\beta_{j}x_{j}$</p>
<p>二项分布：$m(\mu)=ln(\frac{\mu}{1-\mu})=\sum\beta_{j}x_{j}$</p>
<p>Poisson分布：$mu(\mu)=ln(\mu)=\sum\beta_{j}x_{j}$</p>
<p>Logistic属于广义线性模式的一种，它是通常的正态线性模型的推广，它要求应变量只能通过线性形式依赖于自变量。上述推广体现在以下两个方面：</p>
<ol>
<li><p>通过一个连接函数，将应变量与自变量建立线性关系</p>
<p>$m(E(y))=\beta_{0}+\beta_{1}x_{1}+\beta_{2}x_{2}+\cdots+\beta_{p}x_{p}$</p>
</li>
<li><p>通过一个误差函数，说明广义线性模型的最后一部分随机项。</p>
</li>
</ol>
<p>因此，Logistic是关于应变量为0到1定性变量的广义线性回归问题，且广义线性模型的分布族为二项分布。</p>
<p>广义线性模型中常用的分布族如下所示：</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>分布</th>
<th>函数</th>
<th>模型</th>
</tr>
</thead>
<tbody>
<tr>
<td>正态(Gaussian)</td>
<td>$E(y)=X’\beta$</td>
<td>普通线性模型</td>
</tr>
<tr>
<td>二项(Binomial)</td>
<td>$E(y)=\frac{exp(X’\beta)}{1+exp(X’\beta)}$</td>
<td>Logistic模型和概率模型单位(probit)模型</td>
</tr>
<tr>
<td>泊松(Poisson)</td>
<td>$E(y)=exp(X’\beta)$</td>
<td>对数线性模型</td>
</tr>
</tbody>
</table>
</div>
<p>在R语言中，正态分布（也叫高斯分布）的广义线性模型事实上同线性模型是相同的，即</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">gm &lt;- glm(formula,family = gaussian, data)</div></pre></td></tr></table></figure>
<p>与线性模型<code>fm &lt;- lm(formula, data)</code>得到的结论是一致的，当然，其效率会差很多。下面是广义线性模型函数<code>glm()</code>的用法：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">glm(formula, family = gaussian, data,<span class="keyword">...</span>)</div><div class="line">formula为公式，即为要拟合的模型；</div><div class="line">family为分布族，包括正态分布(Gaussian)、二项分布(Binomial)、泊松分布(Poisson)和伽玛分布(Gamma)，分布族还可以通过选项link=来指定使用的连接函数</div><div class="line">data为可选择的数据框</div></pre></td></tr></table></figure>
<p>这样，在广义线性意义下，我们不仅知道了一般线性模型是广义线性模型的一个特例，而且导出了处理频率资料的Logistic模型和处理频数资料的对数线性模型。这个重要结果还说明，虽然Logistic模型和对数线性模型都是非线性模型，即μ和β呈非线性关系，但通过连接函数使m(μ)和β呈线性关系，从而使我们可以用线性拟合的方法求解这类非线性模型。更有意义的是，实际研究中的主要数据形式无非是计量资料、频率资料和频数资料（半计量资料实际上可以看做有序的频数资料），因此，掌握了广义线性模型的思想和方法，就可以使用统一的方法处理各种类型的统计数据。</p>
<h2 id="Logistic回归简介"><a href="#Logistic回归简介" class="headerlink" title="Logistic回归简介"></a>Logistic回归简介</h2><p>在回归中，如果因变量不是数量型的，而是取两个可能值的分类变量，而自变量可以为定性变量及定量变量，那么此时普通的线性回归模型就不适用了，至少回归方程的左边不能是分类变量。我们回忆一下二项分布Bin(n,p)，取两个值的二分布变量和二项分布有关，满足二项分布的变量取两种可能的值，处理过程可以看成为n次独立的随机试验（Bernoulli试验），每次试验只可能取两个可能的值之一，如果称一个试验结果为“成功”，而另一个为“不成功”，并记每次试验成功的概率为p，那么不成功的概率则为1-p。在这里，在所有n次试验中，成功概率p保持不变，然而在实际情况中，概率在所有情况下都不变的假定往往不成立，概率p可能是一些自变量的函数，此时，回归方程的右边与普通的回归方程的类似，而左边则是概率p的函数，而不是p（因变量成功概率）本身，这种回归就是Logistic回归。</p>
<p><code>Logistic回归（logistic regression）</code>属于概率型线性回归，它是研究二分类（可以扩展到多类）观察结果与一些影响因素之间关系的一种多变量分析方法。在流行病学研究中，经常需要分析疾病与各危险因素之间的定量关系，如食管癌的发生与吸烟、饮酒、不良包含习惯等危险因素的关系，为了正确说明这种关系，需要排除一些混杂因素的影响，传统上常使用<code>Mantel-Haenszel分层分析方法</code>，但这一方法适用于样本含量大、分析因素较少的情况。如果用线性回归，由于应变量Y是一个二值变量（通常取值为1或0），不满足应用条件，尤其当各因素都处于低水平或高水平时，预测值$\hat{Y}$可能超出0~1的范围，出现不合理的现象，用Logistic回归分析就是为了解决上述问题的。</p>
<h2 id="基本概念"><a href="#基本概念" class="headerlink" title="基本概念"></a>基本概念</h2><h4 id="logistic回归模型"><a href="#logistic回归模型" class="headerlink" title="logistic回归模型"></a>logistic回归模型</h4><p>设应变量是一个二值变量，取值为0或1，如下所示：</p>
<p>$Y=<br>\begin{cases}<br>1 &amp;出现阳性结果（发病、有效、死亡等） \\<br>0 &amp;出现阴性结果（未发病、无效、存活等）<br>\end{cases}$</p>
<p>另有影响Y取值的m个自变变量，分别为$X_{1},X_{2},\dots,X_{m}$，记作$P=P(Y=1|X_{1},X_{2},\dots,X_{m})$，表示在m个自变量作用下阳性结果发生的概率，Logistic回归模型就可以表示为下面的公式，如下所示：</p>
<p>$P=\frac{1}{1+exp[-(\beta_{0}+\beta_{1}X_{1}+\beta_{2}X_{2}+\cdots+\beta_{m}X_{m})]} \quad (16-1)$</p>
<p>其中$\beta_{0}$是常数项，$\beta_{1},\beta_{2},\cdots,\beta_{m}$是回归系数，如果用Z表示m个自变量的线性组合，就是下面的样子：</p>
<p>$Z=\beta_{0}+\beta_{1}X_{1}+\beta_{2}X_{2}+\cdots+\beta_{m}X_{m}$</p>
<p>则Z与P之间的Logistic曲线就是下面的图形，如下所示：</p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/professional/180726/cblf06iB27.png?imageslim" alt="mark"></p>
<p>从图中可以看出：当Z趋于$+\infty$时，P值逐渐趋于1；当Z趋于$-\infty$时，P值逐渐趋于0；P值的变化在0~1这个范围内，并且随着Z的增加或减少，以点$(0,0.5)$为中心呈对称S形变化，logistic模型的这些特点能够较好地配合生物学反应资料，对(16-1)的公式作对数变量，logistic回归模型就成了下面的线性形式，如下所示：</p>
<p>$ln(\frac{P}{1-P})=\beta_{0}+\beta_{1}X_{1}+\beta_{2}X_{2}+\cdots+\beta_{m}X_{m} \quad (16-2)$</p>
<p>上述公式的左端为阳性与阴性结果发生概率之比的自然对数，称为P的Logit变换，称为<code>logitP</code>，这就可以看出，虽然概率P的取值范围是0~1，但是<code>logitP</code>却没有数值界限，这里我们使用了<code>ln(p/1-p)</code>将<code>p/1-p</code>变成了线性方程，这里的<code>ln(x)</code>就是我们前面提到的连接函数。</p>
<h4 id="模型参数意义"><a href="#模型参数意义" class="headerlink" title="模型参数意义"></a>模型参数意义</h4><p>以流行病学来说明一下模型参数的意义，从<code>公式(16-2)</code>可以看出，常数项$\beta_{0}​$表示暴露剂量为0时，个体发病与不发病概率比之的自然对数，回归系数$\beta_{j}(j=1,2,\cdots,m)​$表示自变量$X_{j}​$改变一个单位时，<code>logitP</code>的改变量，它与衡量危险因素作用大小的比数变称<code>优势比</code>（<code>odds ratio</code>，<code>OR</code>，也有教材译为<code>比数比</code>）有一个对应的关系，对比某一危险因素两个不同暴露水平$X_{j}=c_{1}​$与$X_{j}=c_{0}​$的发病情况（假定其他因素的水平相同），其优势比的自然对数如下所示：</p>
<p>$ \begin{align<em>}lnOR_{j}&amp;=ln[\frac{P_{1}/(1-P_{1})}{P_{0}/(1-P_{0})}]\\<br>&amp;=logitP_{1}-logitP_{0}\\&amp;=(\beta_{0}+\beta_{j}c_{1}+\sum \limits_{t\neq j}^m \beta_{t}X_{t}-(\beta_{0}+\beta_{j}c_{0}+\sum \limits_{t\neq j}^m \beta_{t}X_{t}) \\&amp;=\beta_{j}(c_{1}-c_{0}) \end{align</em>}\quad(16-3)$</p>
<p>转换成真数，则是如下的样子：</p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/professional/180726/5ekdJ13eik.png?imageslim" alt="mark"></p>
<p>在上面的这些公式中，$P_{1}$和$P_{2}$分别表示在$X_{j}$取值为$c_{1}$及$c_{0}$时的发病概率，$OR_{j}$称作<code>多变量调整后的优势比（adjusted odds ratio）</code>，表示扣除了其他自变量影响后危险因素的作用，如果$X_{j}$赋值上为1，如下所示：</p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/professional/180726/2HEiLjbAjK.png?imageslim" alt="mark"></p>
<p>那么，暴露组与非暴露组发病的优势比则为</p>
<p>$OR_{j}=exp(\beta_{j}) \qquad $(<strong>16-5</strong>)</p>
<p>当$\beta_{j}=0$时，$OR_{j}=1$，说明因素$X_{j}$对产生的发生不起作用；当$\beta_{j}&gt;0$时，$OR_{j}&gt;1$，说明$X_{j}$是一个危险因子；当$\beta_{j}&lt;1$时，$OR_{j}&lt;1$，说明$X_{j}$是一个保护因子。</p>
<p>由于$OR_{j}$值与模型中的常数项无关，$\beta_{0}$在危险因素分析中视为无效参数，对于发病率较低的慢性疾病如心脑血管疾病、恶性中肿瘤等，由于P很小，优势比可以作用<code>相对危险度（relative risk，RR）</code>的近似估计，如：</p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/professional/180726/G0jKg4aH0E.png?imageslim" alt="mark"></p>
<p>这是logistic回归用于流行病学调查资料的优势之一，即得到某一因素的回归系数估计值后，便可以得到该因素不同水平下优势比的估计值和相对危险度的近似估计值，关于比数比，可以参考这篇笔记<a href="http://rvdsd.top/2018/06/09/BioStatistics/%E7%94%9F%E7%89%A9%E7%BB%9F%E8%AE%A1-StatQuest%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B008-%E6%AF%94%E6%95%B0%E4%B8%8E%E6%AF%94%E6%95%B0%E6%AF%94/">《比数与比数比》</a>。</p>
<h3 id="Logistic回归模型的参数估计"><a href="#Logistic回归模型的参数估计" class="headerlink" title="Logistic回归模型的参数估计"></a>Logistic回归模型的参数估计</h3><h4 id="参数估计"><a href="#参数估计" class="headerlink" title="参数估计"></a>参数估计</h4><p>根据一组实际观察资料估计Logistic回归模型的参数时，通常采用<strong>最大似然法估计（maximum likelihood estimate, MLE）</strong>，关于最大似然法，可以参考这篇笔记<a href="http://rvdsd.top/2018/06/08/BioStatistics/%E7%94%9F%E7%89%A9%E7%BB%9F%E8%AE%A1-StatQuest%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B007-%E6%9C%80%E5%A4%A7%E4%BC%BC%E7%84%B6%E6%B3%95%E8%AF%A6%E8%A7%A3/">《最大似然法详解》</a>。</p>
<p>最大似然法即建立一个样本似然函数，如下所示：</p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/professional/180726/BCLLk6g26i.png?imageslim" alt="mark"></p>
<p>式中$P_{i}$表示第$i$例观察对象在暴露条件下阳性结果发生的概率，如果实际出现的是阳性结果，取$Y_{i}=1$，否则取$Y_{i}=0$，根据最大似然原理，在一次抽样中，获得现有样本的概率应该最大，即似然函数L应该达到最大值，为了简化计算，通常取似然函数的对数形式，如下所示：</p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/professional/180726/ca1ifm2laf.png?imageslim" alt="mark"></p>
<p>形成要计算的目标函数lnL，然后采用Newton-Raphson迭代方法使对数似然函数达到极大值，此时参数的取值$b_{0},b_{1},b_{2},\cdots,b_{m}$即为$\beta_{0},\beta_{1},\beta_{2},\cdots,\beta_{m}$的最大似然估计值，同时得到参数估计值的方差，即协方差矩阵（对角线元素开平方为标准误$S_{b_{0}},S_{b_{1}},S_{b_{2}},\cdots,S_{b_{m}}$。</p>
<p>如果我们有下述的分层资料，如下所示：</p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/professional/180726/5iAFH48fd5.png?imageslim" alt="mark"></p>
<p>高有g层，每层有$n_{k}(k=1,2,\cdots,g)$例观察以对象，其中有$d_{k}$个病例，则似然函数为：</p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/professional/180726/8ghGBC6Kaf.png?imageslim" alt="mark"></p>
<p>其中，$P_{k}$表示第k层阳性结果发生的概率，上述求解过程现在都是通过软件来完成的。</p>
<h4 id="优势比估计"><a href="#优势比估计" class="headerlink" title="优势比估计"></a>优势比估计</h4><p>根据公式(16-4)，其一因素两个不同水平$(c_{1},c_{0})$优势比的估计值如下所示：</p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/professional/180726/4fi9JCGKgL.png?imageslim" alt="mark"></p>
<p>$OR_{j}$的可信区间可以利用$b_{j}$的抽样分布来估计，在样本含量比较大的情况下，它近似服从正态分布，特殊情况下，若自变量$X_{j}$只有暴露和非暴露两个水平，则优势比$OR_{j}$的$1-\alpha$可信区间计算公式如下所示：</p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/professional/180920/D0fbdC49El.png?imageslim" alt="mark"></p>
<h3 id="Logistic案例计算："><a href="#Logistic案例计算：" class="headerlink" title="Logistic案例计算："></a>Logistic案例计算：</h3><p>对前面所述的表格（16-1）做Logistic回归分析，也就是下面的这个表格</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>分层</th>
<th>吸烟$X_{1}$</th>
<th>饮酒$X_{2}$</th>
<th>观察例数$n_{k}$</th>
<th>阳性数$d_{k}$</th>
<th>阴性数$n_{k}-d_{k}$</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>0</td>
<td>0</td>
<td>199</td>
<td>63</td>
<td>136</td>
</tr>
<tr>
<td>2</td>
<td>0</td>
<td>1</td>
<td>170</td>
<td>63</td>
<td>107</td>
</tr>
<tr>
<td>3</td>
<td>1</td>
<td>0</td>
<td>101</td>
<td>44</td>
<td>57</td>
</tr>
<tr>
<td>4</td>
<td>1</td>
<td>1</td>
<td>416</td>
<td>265</td>
<td>151</td>
</tr>
</tbody>
</table>
</div>
<p>确定各变量的赋值或编码，如下所示：</p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/professional/180726/21e8gfChkI.png?imageslim" alt="mark"></p>
<p>进行logistic回归计算，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">smoke &lt;- c(<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>) <span class="comment"># 0表示不吸烟，1表示吸烟</span></div><div class="line">wine &lt;- c(<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>)</div><div class="line">n1 &lt;- c(<span class="number">199</span>,<span class="number">170</span>,<span class="number">101</span>,<span class="number">416</span>) <span class="comment"># 0表示不饮酒，1表示饮酒</span></div><div class="line">positive1 &lt;- c(<span class="number">63</span>,<span class="number">63</span>,<span class="number">44</span>,<span class="number">265</span>)</div><div class="line">negative1 &lt;- c(<span class="number">136</span>,<span class="number">107</span>,<span class="number">57</span>,<span class="number">151</span>)</div><div class="line">data1 &lt;- positive1/n1 <span class="comment"># data1用来计算阳性率</span></div><div class="line">result1 &lt;- glm(data1~smoke+wine,binomial,weights=n1) <span class="comment"># data1为百分比，需要加上总数</span></div><div class="line">con1 &lt;- as.matrix(confint(result1))[<span class="number">2</span>,] <span class="comment"># confint(result1)查看各个系数对应的置信区间</span></div><div class="line">exp(con1) <span class="comment"># 计算吸烟与不吸烟优势比的可信区间</span></div><div class="line">con2 &lt;- as.matrix(confint(result1))[<span class="number">3</span>,] </div><div class="line">exp(con2) <span class="comment"># 计算饮酒与不饮酒优势比的可信区间</span></div><div class="line">summary(result1) <span class="comment"># 查看各个系数,z值的平方即为Wald检验值</span></div><div class="line">anova(result1,test=<span class="string">"Chisq"</span>) <span class="comment"># 似然比卡方检验</span></div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line">exp(con1) <span class="comment"># 计算吸烟与不吸烟优势比的可信区间</span></div><div class="line"><span class="comment"># 2.5 %   97.5 % </span></div><div class="line"><span class="comment">#   1.809052 3.258006 </span></div><div class="line"></div><div class="line">con2 &lt;- as.matrix(confint(result1))[<span class="number">3</span>,] </div><div class="line">exp(con2) <span class="comment"># 计算饮酒与不饮酒优势比的可信区间</span></div><div class="line"><span class="comment"># 2.5 %   97.5 % </span></div><div class="line"><span class="comment">#   1.244161 2.304882 </span></div><div class="line">summary(result1) <span class="comment"># 查看各个系数,z值的平方即为Wald检验值</span></div><div class="line"><span class="comment"># Call:</span></div><div class="line"><span class="comment">#   glm(formula = data1 ~ smoke + wine, family = binomial, weights = n1)</span></div><div class="line"><span class="comment"># Deviance Residuals: </span></div><div class="line"><span class="comment">#   1        2        3        4  </span></div><div class="line"><span class="comment"># 0.9133  -0.9240  -1.1731   0.5968  </span></div><div class="line"><span class="comment"># Coefficients:</span></div><div class="line"><span class="comment">#   Estimate Std. Error z value Pr(&gt;|z|)    </span></div><div class="line"><span class="comment"># (Intercept)  -0.9099     0.1358  -6.699 2.11e-11 ***</span></div><div class="line"><span class="comment">#   smoke         0.8856     0.1500   5.904 3.54e-09 ***</span></div><div class="line"><span class="comment">#   wine          0.5261     0.1572   3.348 0.000815 ***</span></div><div class="line"><span class="comment">#   ---</span></div><div class="line"><span class="comment">#   Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span></div><div class="line"><span class="comment"># (Dispersion parameter for binomial family taken to be 1)</span></div><div class="line"><span class="comment"># Null deviance: 71.9659  on 3  degrees of freedom</span></div><div class="line"><span class="comment"># Residual deviance:  3.4202  on 1  degrees of freedom</span></div><div class="line"><span class="comment"># AIC: 32.005</span></div><div class="line"><span class="comment"># Number of Fisher Scoring iterations: 3</span></div></pre></td></tr></table></figure>
<p>从上面结果可以看出：</p>
<p>$b_{0}=-0.9099,S_{b_{0}}=0.1358,b_{1}=0.8856,S_{b_{1}}=0.1500,b_{2}=0.5261,S_{b_{2}}=0.1572$</p>
<p>吸烟与不吸烟的优势比为：</p>
<p>$ \widehat{OR_{1}}=exp(b_{1})=exp(0.8856)=2.42 $ </p>
<p>$OR_{1}$的95%可信区间如下所示：</p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/professional/180726/B338JCG4gA.png?imageslim" alt="mark"></p>
<p>饮酒与不饮酒的优势比为：</p>
<p>$ \widehat{OR_{2}}=exp(b_{2})=exp(0.5261)=1.69 $ </p>
<p>$OR_{2}$的95%可信区间如下所示：</p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/professional/180726/mfI8e4D6gg.png?imageslim" alt="mark"></p>
<h3 id="Logistic回归模型的假设检验"><a href="#Logistic回归模型的假设检验" class="headerlink" title="Logistic回归模型的假设检验"></a>Logistic回归模型的假设检验</h3><p>得到logistic回归方程后，还需要对其回归系数进行假设检验，用于说明所研究的自变量对于应变量Y的是影响是否有统计学意义，为此，需要对模型中的回归系数是否不全为0作出检验，这个跟多重线性回归的检验是一样的，检验假设条件如下所示：</p>
<p>$H_{0}:\beta_{1}=\beta_{2}=\cdots=\beta_{m}=0$</p>
<p>$H_{1}:$各$\beta_{j}(j=1,2,\cdots,m)$不全为0</p>
<p>更典型的问题是对一个回归系数的检验，检验假设为$H_{0}:\beta_{j}=0,H_{1}:\beta \neq 0$。常用的检验验方法有<code>似然比检验（likelihood ratio test）</code>，<code>Wald检验</code>和<code>计分检验（score test）</code>。</p>
<h4 id="似然比检验"><a href="#似然比检验" class="headerlink" title="似然比检验"></a>似然比检验</h4><p>似然比检验的基本思想是比较在两种不同假设条件下的对数似然函数值，看其差别大小。具体做法是，先拟合一个不包含准备检测的变量在内的logistic回归模型，求出它的对数似然函数值$lnL_{0}$，然后把需要检验的变量加入模型中去，再检验配合，得到一个新的对数似然函数值$lnL_{1}$，假设前后两个模型分别包含$l$个自变量和$p$个自变量，似然比统计量G的计算公式为：</p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/professional/180726/GEj57Gk3Cf.png?imageslim" alt="mark"></p>
<p>当样本含量较大时，在零假设下得到的G统计量近似服从自由度为$d(d=p-l)​$的$\chi^2​$分布，若$G\geq{\chi^2_{\alpha,d}}​$时，则新加入的$d​$个自变量对回归方程有统计学意义，如果只对一个回归系数检验，则$d=1​$，由上面的案例可以计算出来：</p>
<p>$lnL(X_{1})=-585.326,lnL(X_{2})=-597.436,lnL(X_{1},X_{2})=-579.711$</p>
<p>符号$L(X_{1})$和$L(X_{2})$分别表示模型中只含有$X_{1}$和$X_{2}$的最大似然函数值，而$L(X_{1},X_{2})$则表示模型中同时含有$X_{1}$和$X_{2}$的最大似然函数。</p>
<p>对于$H_{0}:\beta_{1}=0,H_{1}:\beta \neq 0$，则有：</p>
<p>$G=2[lnL(X_{1},X_{2})-lnL(X_{2})]=2[-579.711-(-597.436)]=35.45$</p>
<p>查$\chi^2$界值表可以得，$\chi^2_{0.05,1}=3.84$，$G&gt;3.84$，因此在$\alpha=0.05$检验水平上拒绝$H_{0}$，接受$H_{1}$，说明控制了饮酒因素是呼后，食管癌与吸烟有显著性关系。</p>
<p>同理，对于$H_{0}:\beta_{2}=0,H_{1}:\beta_{2} \neq 0$，则有</p>
<p>$G=2[lnL(X_{1},X_{2})-lnL(X_{2})]=2[-579.711-(-585.326)]=11.23$</p>
<p>$G&gt;3.84$，拒绝$H_{0}$，接受$H_{1}$，说明控制了吸烟因素的影响后，食管癌与饮酒有显著性关系。</p>
<p>看一下R对于似然比卡方的检验，因变量服从二项分布，因此对模型的方差检验需要使用似然比卡方检验，<code>anova()</code>函数提供了检验Logistic模型的馀在卡方比的功能，它也能逐一地检验模型的自变量是否显著。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">anova(result1,test=<span class="string">"Chisq"</span>) <span class="comment">#似然比卡方检验</span></div><div class="line"><span class="comment"># Analysis of Deviance Table</span></div><div class="line"><span class="comment"># Model: binomial, link: logit</span></div><div class="line"><span class="comment"># Response: data1</span></div><div class="line"><span class="comment"># Terms added sequentially (first to last)</span></div><div class="line"><span class="comment"># Df Deviance Resid. Df Resid. Dev  Pr(&gt;Chi)    </span></div><div class="line"><span class="comment"># NULL                      3     71.966              </span></div><div class="line"><span class="comment"># smoke  1   57.315         2     14.651 3.713e-14 ***</span></div><div class="line"><span class="comment">#   wine   1   11.230         1      3.420 0.0008047 ***</span></div><div class="line"><span class="comment">#   ---</span></div><div class="line"><span class="comment">#   Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span></div></pre></td></tr></table></figure>
<p>从结果可能看出来，wine能够产生11.23的偏差，其p值小于0.01，对模型的影响是十分显著的。模型偏差度量了自变量对模型的影响程度，该值越小，就说明自变量造的偏差越小，对因变量的分类越没有帮助；该值越大，就说明自变量造成的偏差越大，对因变量的分类帮助越多，根据模型偏差的显著与否，能合理地判断自变量是否适合引物Logistic回归模型。</p>
<h4 id="Wald检验"><a href="#Wald检验" class="headerlink" title="Wald检验"></a>Wald检验</h4><p>Wald检验的原理可以再看一下这篇笔记<a href="http://rvdsd.top/2018/06/09/BioStatistics/%E7%94%9F%E7%89%A9%E7%BB%9F%E8%AE%A1-StatQuest%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B008-%E6%AF%94%E6%95%B0%E4%B8%8E%E6%AF%94%E6%95%B0%E6%AF%94/">《比数与比数比》。</a></p>
<p>Wald只需要将各参数$\beta_{j}$的估计值$b_{j}$与0比较，并且它的标准误$S_{b_{j}}$作为参照；为检验$H_{0}:\beta_{j}=0,H_{1}:\beta_{j} \neq0$，计算如下统计量</p>
<p>$\mu=\frac{b_{j}}{S_{b_{j}}} \qquad (16-13)$</p>
<p>或</p>
<p>$\chi^2=(\frac{b_{j}}{S_{b_{j}}})^2 \qquad (16-14)$</p>
<p>对于大样本资料，在零假设下$\mu$近似服从标准正态分布，而$\chi^2$则近似服从自由度$\nu=1$的$\chi^2$分布，在本例中，对于$H_{0}:\beta_{1}=0,H_{1}:\beta_{2} \neq 0$，则有：</p>
<p>$\chi^2=(\frac{0.8856}{0.1500})^2=34.86$</p>
<p>对于$H_{0}:\beta_{2}=0,H_{1}:\beta_{2} \neq 0$，则有：</p>
<p>$\chi^2=(\frac{0.5261}{0.1572})^2=11.20$</p>
<p>$\chi^2$值均大于3.84，说明食管癌与吸烟、吸烟有显著性关系，结论同前。</p>
<h2 id="Logistic回归变量筛选"><a href="#Logistic回归变量筛选" class="headerlink" title="Logistic回归变量筛选"></a>Logistic回归变量筛选</h2><p>与多元线性回归分析类似，当自变量的个数较多时，为了使建立的logistic回归模型比较稳定和便于解释，应尽可能将回归效果显著的自变量选入模型中，将作用不显著的自变量排除在外，具体的算法有前进法、后退法和逐步法。logistic逐步回归与线性逐步回归过程非常相似，使用其中所用的检验统计量不再是F统计量，而是似然比统计量、Wald统计量和计分统计量之一，例如使用似然比统计量，即利用如下的公式：</p>
<p>$G=2(lnL_{1}^{(l)}-lnL_{0}^{(l)})$</p>
<p>在进行到第$l$步时，通过比较含有某一自变量$X_{j}$和不含有$X_{j}$的模型，决定$X_{j}$是否引入模型或从模型中剔除。</p>
<p>看下面的案例（《医学统计学》，第四版，孙振球）：</p>
<h3 id="案例B"><a href="#案例B" class="headerlink" title="案例B"></a>案例B</h3><p>为了探讨冠心病的有关危险因素，对26例冠心病患者和28便对照者进行病例对照研究，各因素的说明及资料见下表1和表2，试用logistic逐步回归分析法筛选危险因素（$\alpha_{入}=0.10$，$\alpha_{出}=0.15$），如下所示：</p>
<div class="table-container">
<table>
<thead>
<tr>
<th></th>
<th>表1</th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>因素</td>
<td>变量名</td>
<td>赋值说明</td>
</tr>
<tr>
<td>年龄（岁）</td>
<td>X1</td>
<td>&lt;45=1,45~=2,55~=3,65~=4</td>
</tr>
<tr>
<td>高血压史</td>
<td>X2</td>
<td>无=0,有=1</td>
</tr>
<tr>
<td>高血压家族史</td>
<td>X3</td>
<td>无=0,有=1</td>
</tr>
<tr>
<td>吸烟</td>
<td>X4</td>
<td>不吸=0,吸=1</td>
</tr>
<tr>
<td>高血脂史</td>
<td>X5</td>
<td>无=0,有=1</td>
</tr>
<tr>
<td>动物脂肪摄入</td>
<td>X6</td>
<td>低=0,高=1</td>
</tr>
<tr>
<td>体重指数（BMI）</td>
<td>X7</td>
<td>&lt;24~=1,24~=2,26~=3</td>
</tr>
<tr>
<td>A型性格</td>
<td>X8</td>
<td>否=0,是=1</td>
</tr>
<tr>
<td>冠心病</td>
<td>Y</td>
<td>对照=0,病例=1</td>
</tr>
</tbody>
</table>
</div>
<div class="table-container">
<table>
<thead>
<tr>
<th>表2</th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>序号</td>
<td>X1</td>
<td>X2</td>
<td>X3</td>
<td>…</td>
<td>X7</td>
<td>X8</td>
<td>Y</td>
</tr>
<tr>
<td>1</td>
<td>3</td>
<td>1</td>
<td>0</td>
<td>…</td>
<td>1</td>
<td>1</td>
<td>0</td>
</tr>
<tr>
<td>2</td>
<td>2</td>
<td>0</td>
<td>1</td>
<td>…</td>
<td>1</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td>3</td>
<td>2</td>
<td>1</td>
<td>0</td>
<td>…</td>
<td>1</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
<tr>
<td>54</td>
<td>3</td>
<td>1</td>
<td>1</td>
<td>…</td>
<td>3</td>
<td>1</td>
<td>1</td>
</tr>
</tbody>
</table>
</div>
<p>（原始数据已放github上）</p>
<p>计算过程如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">No &lt;- <span class="number">1</span>:<span class="number">54</span></div><div class="line">X1 &lt;- c(<span class="number">3</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">4</span>,<span class="number">3</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">3</span>,<span class="number">3</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">3</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">3</span>)</div><div class="line">X2 &lt;- c(<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>)</div><div class="line">X3 &lt;- c(<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>)</div><div class="line">X4 &lt;- c(<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>)</div><div class="line">X5 &lt;- c(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>)</div><div class="line">X6 &lt;- c(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>)</div><div class="line">X7 &lt;- c(<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">3</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">3</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">3</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">3</span>,<span class="number">3</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">3</span>)</div><div class="line">X8 &lt;- c(<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>)</div><div class="line">Y &lt;- c(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>)</div><div class="line">data2 &lt;- data.frame(No,X1,X2,X3,X4,X5,X6,X7,X8,Y)</div><div class="line">y.glm &lt;- glm(Y~X1+X2+X5+X6+X7+X8,family=binomial,data=data2)</div><div class="line">summary(y.glm)</div><div class="line">y.step2 &lt;- step(y.glm)</div><div class="line">summary(y.step2)</div><div class="line">y.glm2 &lt;- glm(Y~X1+X5+X6+X8,family=binomial,data=data2)</div><div class="line">summary(y.glm2)</div></pre></td></tr></table></figure>
<p>计算结果如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line">&gt; summary(y.glm)</div><div class="line"></div><div class="line">Call:</div><div class="line">glm(formula = Y ~ X1 + X2 + X5 + X6 + X7 + X8, family = binomial, </div><div class="line">    data = data2)</div><div class="line"></div><div class="line">Deviance Residuals: </div><div class="line">    Min       1Q   Median       3Q      Max  </div><div class="line">-2.3631  -0.6437  -0.2306   0.5883   2.2950  </div><div class="line"></div><div class="line">Coefficients:</div><div class="line">            Estimate Std. Error z value Pr(&gt;|z|)   </div><div class="line">(Intercept)  -5.0195     1.6820  -2.984  0.00284 **</div><div class="line">X1            0.7242     0.4883   1.483  0.13805   </div><div class="line">X2            1.1076     0.8171   1.356  0.17524   </div><div class="line">X5            1.2089     0.7808   1.548  0.12158   </div><div class="line">X6            3.3788     1.3397   2.522  0.01167 * </div><div class="line">X7            0.2881     0.5714   0.504  0.61419   </div><div class="line">X8            1.9090     0.8973   2.128  0.03338 * </div><div class="line">---</div><div class="line">Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</div><div class="line"></div><div class="line">(Dispersion parameter for binomial family taken to be 1)</div><div class="line"></div><div class="line">    Null deviance: 74.786  on 53  degrees of freedom</div><div class="line">Residual deviance: 43.907  on 47  degrees of freedom</div><div class="line">AIC: 57.907</div><div class="line"></div><div class="line">Number of Fisher Scoring iterations: 5</div></pre></td></tr></table></figure>
<p>从结果来看，X6，X8这2项的P值小于0.05，现在再对这2项进行回归拟合，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"></div></pre></td></tr></table></figure>
<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><ol>
<li>孙振球. 医学统计学.第4版[M]. 人民卫生出版社, 2014.</li>
<li>王斌会. 多元统计分析及R语言建模[M]. 暨南大学出版社, 2010.</li>
<li><a href="https://zhuanlan.zhihu.com/p/44591359" target="_blank" rel="external">逻辑回归Logistics regression公式推导</a></li>
<li></li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2017/06/08/BioStatistics/生物统计-10相关分析/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/06/08/BioStatistics/生物统计-10相关分析/" itemprop="url">相关分析笔记</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-06-08T12:02:00+08:00">
                2017-06-08
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/生物统计/" itemprop="url" rel="index">
                    <span itemprop="name">生物统计</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  7,861
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  31
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="直线相关（Linear-correlation）"><a href="#直线相关（Linear-correlation）" class="headerlink" title="直线相关（Linear correlation）"></a>直线相关（Linear correlation）</h2><h2 id="变量之间的关系"><a href="#变量之间的关系" class="headerlink" title="变量之间的关系"></a>变量之间的关系</h2><p>变量之间的关系有两种，一种是变量间存在着完全确定的有关系，这类变量间的关系称为函数关系；另一类是变量间关系不存在完全的确定性，不能用精确的数学公式来表示，这些变量间都存在着十分密切的关系，但不能由一个或几个变量的值精确地求出求出另一个变量的值，这些变量间的关系称为相关关系，存在相关关系的变量是相关变量。</p>
<h3 id="直线相关的概念"><a href="#直线相关的概念" class="headerlink" title="直线相关的概念"></a>直线相关的概念</h3><p>对于两变量关系的研究，有时并不需要由X估计Y，也就是说我们有时候并不需要考虑直线回归的问题，而是考虑两个变量之间是否有明确的直线相关关系，例如为了研究向量元素锰在胆固醇合成中的作用，探讨大刀肝脏中胆固醇含量和锰含量之间是否存在直线关系？这种关系表现为随着锰含量的增加，胆固醇的是增加还是减少呢？像这类判断两个数值变量之间有元直线相关关系，并回答相关的方向和相关程度如何时，可以采用相关分析。</p>
<h2 id="回归与相关的区别与联系"><a href="#回归与相关的区别与联系" class="headerlink" title="回归与相关的区别与联系"></a>回归与相关的区别与联系</h2><h3 id="两者的区别"><a href="#两者的区别" class="headerlink" title="两者的区别"></a>两者的区别</h3><p>回归和相关都是研究两个变量相互关系的分析方法。相关分析研究两个变量之间相关的方向和相关的密切程度。但是相关分析不能指出两变量相互关系的具体形式，也无法从一个变量的变化来推测另一个变量的变化关系。</p>
<p>回归方程则是通过一定的数学方程来反映变量之间相互关系的具体形式，以便从一个已知量来推测另一个未知量。为估算预测提供一个重要的方法。具体区别有：</p>
<ol>
<li><p>相关分析中变量之间处于平等的地位；回归分析中，因变量处在被解释的地位，自变量用于预测因变量的变化；</p>
</li>
<li><p>相关分析中不必确定自变量和因变量，所涉及的变量可以都是随机变量；而回归分析则必须事先确定具有相关关系的变量中，哪个是因变量，哪个是因变量。一般来说，回归分析中因变量是随机变量，而把自变量作为研究时给定的非随机变量；</p>
</li>
<li><p>相关分析研究变量之间相关的方向和相关的程度，但相关分析不能根据一个变量的变化来推测另一个变量的变化情况；回归分析是研究变量之间相互关系的具体表现形式，根据变量之间的联系确定一个相关的数学表达式，从而可以从已知量来推测未知量。</p>
</li>
<li><p>对两个变量来说，相关分析中只能计算出一个相关系数；而回归分析中有时可以根据研究目的的不同建立两个不同的回归方程。</p>
</li>
</ol>
<h3 id="两者的联系"><a href="#两者的联系" class="headerlink" title="两者的联系"></a>两者的联系</h3><p>相关分析与回归分析是广义相关分析的两个阶段,两者有着密切的联系 ：</p>
<ol>
<li>相关分析是回归分析的基础和前提，回归分析则是相关分析的深入和继续。相关分析需要依靠回归分析来表现变量之间数量相关的具体形式，而回归分析则需要依靠相关分析来表现变量之间数量变化的相关程度。只有当变量之间存在高度相关时，进行回归分析寻求其相关的具体形式才有意义。如果在没有对变量之间是否相关以及相关方向和程度做出正确判断之前，就进行回归分析，很容易造成“虚假回归”。</li>
<li>由于相关分析只研究变量之间相关的方向和程度，不能推断变量之间相互关系的具体形式，也无法从一个变量的变化来推测另一个变量的变化情况，因此，在具体应用过程中，只有把相关分析和回归分析结合起来，才能达到研究和分析的目的。</li>
</ol>
<p>相关分析与回归分析都是研究变量相互关系的分析方法，相关分析是回归分析的基础，而回归分析则是认识变量之间相关程度的具体形式。</p>
<h2 id="直线相关的类别"><a href="#直线相关的类别" class="headerlink" title="直线相关的类别"></a>直线相关的类别</h2><p>直线相关（linear correlation）又称简单相关（simple correlation），用于双变量正态分布（bivariate normal distribution）资料，直线在养的性质可由散点图直观的说明，看下图：</p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/professional/180719/K48HE5gGC4.png?imageslim" alt="mark"></p>
<p>第1张图和第2张图的散点呈椭圆形分布，若两变量X、Y同时增大或减小，变化趋势是同向的，称为正相关（positive correlation），反之，X、Y间呈反向变化，则是负相关（negative correlation），第5和第6张图中，散点基本上在一条直线上，若X、Y是同向变化，称为完全正相关（perfect positive correlation），反之，X、Y呈反向变化，称为完全负相关（perfect negative correlation），再看第第3、4、7、8这四张图，散点分布为圆形等一些形状，两变量之间没有直线相关关系，称为零相关（zero correlation）。正相关或负相关并不一定表示一个变量的改变是另一个变量变化的原因，有可能同受另一个因素的影响，因此，相关关系并不一定是因果关系，打个比方吧，某个地区每年七八月份溺水死亡的人数与雪糕的销量呈现正相关的关系，我们不能推断出来，是雪糕的销售与溺水死亡之间存在着因果关系，因为它们都受同一个因素的影响，就是天气，天气热，雪糕的销量自然高，下水游泳的人也多。</p>
<h2 id="Pearson相关系数"><a href="#Pearson相关系数" class="headerlink" title="Pearson相关系数"></a>Pearson相关系数</h2><p><strong>相关系数（coefficient of correlation）</strong>又称<strong>Pearson积差相关系数（coefficient of product-moment correlation）</strong>，以符号r表示样本相关系数，符号$\rho​$表示其总体相关系数，它用来说明直线关系的两个变量间相关的密切程度与相关方向。</p>
<p>如果$(x_{1},y_{1}),\cdots,(x_{n},y_{n})$为相应于这两个变量x和y的n个观侧值对子，那么Pearson相关系数的总体和样本形式分别如下所示：</p>
<p>总体相关系数$\rho$的计算公式如下所示：</p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/professional/180719/el118fDdkL.png?imageslim" alt="mark"></p>
<p>样本相关系数r的计算公式如下所示：</p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/professional/180719/c8EjkLii84.png?imageslim" alt="mark"></p>
<p>相关系数没有单位，其值为$-1\leq r \leq 1$，r值为正，表示正相关，r值为负表示负相关，r的绝对值等于1为完全相关，r=0为零相关，在生物界，由于影响因素众多，因此很少完全相关，注意：这里的r实际上是就总体相关系数$\rho$来说的，r是$\rho$的估计值。</p>
<p>上面的这两个公式反应了两个变量之间的关系。</p>
<ol>
<li>两个变量正线性相关。这时当x（相对于其样本均值）较大时，多数的y（相对于其样本均值）也应该较大；而当x相对于均值较小时，多数的y也应该相对于均值较小，无论在哪种情况下，分子中的$(X-\bar{X})$的符号和$(Y-\bar{Y})$的符号相同的就多，这样就得到一个较大的正值（但不会超过1）。通常来说，当r的值在0.75以上表示很强的相关，介于0.3到0.7之间为适中的相关性，而在0.25以下为很弱的相关性。</li>
<li>两个变量负线性相关。这时当x（相对于其样本均值）较大时，多数的y相对于其样本均较小；而当x相对于均值较小时，多数的y也应该相对于均值较大，而分子中的$(X-\bar{X})$的符号和$(X-\bar{X})$的符号相反的就多，这样就得到一个较大的负值（但不会小于-1）。</li>
<li>两个变量不线性相关。这时分子中的大于零的项和小于零的项的个数差不多，大小也不会差很多，这样公式的结果就是一个接近于0的数目。</li>
</ol>
<h2 id="Pearson相关系数的计算"><a href="#Pearson相关系数的计算" class="headerlink" title="Pearson相关系数的计算"></a>Pearson相关系数的计算</h2><p>现在看一个案例，这个案例来源于《医学统计学》（第四版，孙振球）的第九章，具体内容如下所示：</p>
<p>某医师测量了15名正常成年人的体重（kg）与CT双肾总体积（ml）的大小，数据如下表所示，据引回答，两变量是否有关联？其方向与密切程度如何？</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>编号</th>
<th>体重（kg）</th>
<th>双肾总体积（ml）</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>43</td>
<td>217</td>
</tr>
<tr>
<td>2</td>
<td>74</td>
<td>316.18</td>
</tr>
<tr>
<td>3</td>
<td>51</td>
<td>231.11</td>
</tr>
<tr>
<td>4</td>
<td>58</td>
<td>220.96</td>
</tr>
<tr>
<td>5</td>
<td>50</td>
<td>254.7</td>
</tr>
<tr>
<td>6</td>
<td>65</td>
<td>293.84</td>
</tr>
<tr>
<td>7</td>
<td>54</td>
<td>263.28</td>
</tr>
<tr>
<td>8</td>
<td>57</td>
<td>271.73</td>
</tr>
<tr>
<td>9</td>
<td>67</td>
<td>263.46</td>
</tr>
<tr>
<td>10</td>
<td>69</td>
<td>276.53</td>
</tr>
<tr>
<td>11</td>
<td>80</td>
<td>341.15</td>
</tr>
<tr>
<td>12</td>
<td>48</td>
<td>261</td>
</tr>
<tr>
<td>13</td>
<td>38</td>
<td>213.2</td>
</tr>
<tr>
<td>14</td>
<td>85</td>
<td>315.12</td>
</tr>
<tr>
<td>15</td>
<td>54</td>
<td>252.08</td>
</tr>
</tbody>
</table>
</div>
<p>计算过程如下所示：</p>
<p>先绘制出散点图，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">weight &lt;-c(<span class="number">43</span>,<span class="number">74</span>,<span class="number">51</span>,<span class="number">58</span>,<span class="number">50</span>,<span class="number">65</span>,<span class="number">54</span>,<span class="number">57</span>,<span class="number">67</span>,<span class="number">69</span>,<span class="number">80</span>,<span class="number">48</span>,<span class="number">38</span>,<span class="number">85</span>,<span class="number">54</span>)</div><div class="line">area &lt;-c(<span class="number">217</span>,<span class="number">316.18</span>,<span class="number">231.11</span>,<span class="number">220.96</span>,<span class="number">254.7</span>,<span class="number">293.84</span>,<span class="number">263.28</span>,<span class="number">271.73</span>,<span class="number">263.46</span>,<span class="number">276.53</span>,<span class="number">341.15</span>,<span class="number">261</span>,<span class="number">213.2</span>,<span class="number">315.12</span>,<span class="number">252.08</span>)</div><div class="line">plot(weight,area)</div></pre></td></tr></table></figure>
<p><img src="http://ortxpw68f.bkt.clouddn.com/professional/180719/L2gaj7AA3c.png?imageslim" alt="mark"></p>
<h3 id="cor-函数"><a href="#cor-函数" class="headerlink" title="cor()函数"></a>cor()函数</h3><p>现在计算一下相关系数，用<code>cor()</code>函数即可，<code>cor()</code>函数的用法为：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">cor(x,use=, mehtod= )</div><div class="line">其中，x是数据集，它可以是矩阵，可以是数据框</div><div class="line">use指定缺失数据的处理方式，可选的方式为all.obs（假设不存在缺失数据），everything（遇到缺失数据时，相关系数的计算结果将被设为missing),complete.obs（行删除）以及pairwise.complete.obs（成对删除，pairwise deletion）</div><div class="line">method：指定的相关系数的类型，可选类型为pearson、spearman或kendall</div></pre></td></tr></table></figure>
<p>现在我们计算的是线性相关，使用的method参数为pearson（默认参数应时pearso，因此method参数可加不加），如果是直接计算两个变量的相关关系，也可以不使用数据框形式，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; cor(weight,area)</div><div class="line">[<span class="number">1</span>] <span class="number">0.8754715</span></div></pre></td></tr></table></figure>
<h3 id="相关系数的统计推断"><a href="#相关系数的统计推断" class="headerlink" title="相关系数的统计推断"></a>相关系数的统计推断</h3><h4 id="相关系数的假设检验"><a href="#相关系数的假设检验" class="headerlink" title="相关系数的假设检验"></a>相关系数的假设检验</h4><p>从同一总体中抽出的不同样本会得到不同的样本相关系数，所以要判断X、Y之间是否确有直线相关关系，就要检验r是否来自于$rho\neq 0$的总体，因为即使从$\rho=0$的总体作随机抽样，由于抽样误差的影响，所得的r值也常不等于零。因此，当计算出r值后，接着要做$\rho=0$的假设检验，常用t检验，检验统计量t值的计算公式如下所示：</p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/professional/180719/3KF6Jc3GCE.png?imageslim" alt="mark"></p>
<p>其中，分母为相关系数的标准误，求得t值后，查t值表就可以得到p值，这个过程现在用软件就可以计算，现在我们计算以下前面的那个案例，也就浊对于所得到的r值，检验CT双肾总体积与体重是否有直线相关关系？</p>
<p>它的假设检验如下所示：</p>
<p>$H_{0}:\rho=0$，即CT双肾减少呢体积与体重之间无直线相关关系</p>
<p>$H_{1}:\rho\neq 0$，即CT双肾减少呢体积与体重之间有直线相关关系</p>
<p>$\alpha=0.05$，在本例中，n=15，r=0.8754，根据公式（二），可得</p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/professional/180719/de0a8CKeCF.png?imageslim" alt="mark"></p>
<p>按$\nu=13$，查t值表可知，p&lt;0.001，按$\alpha=0.05$的检验水准，拒绝$H_{0}$，接受$H_{1}$，可以认为CT双肾总体积与体重之间存在正相关，现在用R来计算一下，此时使用<code>cor.test</code>函数，<code>cor.test()</code>函数的使用为<code>cor.test(x,y,alternative=,method=)</code>，参数如下所示：</p>
<ul>
<li><p>alternative用来指定进行双侧检验或单侧检验（取值为”two.side”、”less”,”greater”）；</p>
</li>
<li><p>method用于指定要计算的类型（”pearson”、”kendall”或”spearman”），</p>
</li>
</ul>
<p>当研究的假设为总体的相关系数小于0时，使用alternative=”less”参数，当研究的假设为总体的相关系数大于0时，使用alternative=”greater”参数，默认性下是使用alternative=”two.side”，表示总体相关系数不等于零，这个案例的计算结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">&gt; cor.test(weight,area)</div><div class="line"></div><div class="line">	Pearson<span class="string">'s product-moment correlation</span></div><div class="line"><span class="string"></span></div><div class="line"><span class="string">data:  weight and area</span></div><div class="line"><span class="string">t = 6.5317, df = 13, p-value = 1.907e-05</span></div><div class="line"><span class="string">alternative hypothesis: true correlation is not equal to 0</span></div><div class="line"><span class="string">95 percent confidence interval:</span></div><div class="line"><span class="string"> 0.6585492 0.9580681</span></div><div class="line"><span class="string">sample estimates:</span></div><div class="line"><span class="string">      cor </span></div><div class="line"><span class="string">0.8754715</span></div></pre></td></tr></table></figure>
<p>现在我们看一下这个结果，在这个结果中，我们可以得到这些信息：</p>
<ol>
<li>对总体相关系数进行t检验，发现t值为6.5317，p值远远小于0.001，因此拒绝原假设，接受备选假设，也就是说，可以认为CT双肾总体积与体重之间存在正相关；</li>
<li>总体相关系数的95%置信区间为(0.6585492, 0.9580681)。</li>
</ol>
<h3 id="决定系数"><a href="#决定系数" class="headerlink" title="决定系数"></a>决定系数</h3><p>直线回归与相关分析中，还有一个非常重要的统计量，称为决定系数（coefficient of determination），定义为回归平方与总平方和之比（这里可以看一下<a href="http://rvdsd.top/2017/06/07/BioStatistics/%E7%94%9F%E7%89%A9%E7%BB%9F%E8%AE%A1-08%E7%BA%BF%E6%80%A7%E5%9B%9E%E5%BD%92/">《线性回归笔记》</a>），计算公式如下所示：</p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/professional/180719/jib3eBE2I6.png?imageslim" alt="mark"></p>
<p>为了方便描述，在双变量分析和多变量分析中，决定系数都用$R^2$表示，但是对于双变量分析矾，$R^2$就等于$r^2$，具体公式就是公式（一）。</p>
<p>$R^2$的聚会在0到1之间且无单位，其数值大小反映了回归贡献的相对程度，也就是在Y的总变异中，回归关系所能解释的百分比，公式三也说明了，当$SS_{总}$固定不变时，回归平方和的大小决定了相关系数r绝对值的大小，回归平方和越接近于总平方和，则r的绝对值越接近于1，说明相关的实际效果越好，在前面的案例中，15名成年人CT双肾总体积与体重之间的直线相关系数r=0.875，那么$R^2$=0.7656，表示在这批数据中，体重可解释双肾体积变异性的76.56%，另外约23%的变异不能用体重来解释，决定系数除了作为相关或回归拟合效果的概括统计量外，还可以利用它对回归或相关作假设检验，其中对直线回归的拟合优度检验就等价于对总体回归系数的假设检验，检验统计量为：</p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/professional/180719/dLEAe6Lkbj.png?imageslim" alt="mark"></p>
<p>将此F统计量开平方根，就等于相对公式（二）中的相关系数做假设检验的t统计量，这又验证了相关与回归的假设检验是等价的。</p>
<h2 id="多元线性相关分析"><a href="#多元线性相关分析" class="headerlink" title="多元线性相关分析"></a>多元线性相关分析</h2><p>在相关分析中，研究较多的是两个变量之间的关系，称为简单相关，当涉及的变量为三个或三个以上时，称为偏相关或复相关，实际上偏相关（复相关）是对简单相关的一种推广。在有些情况下，我们只想了解两变量之间有元线性相关关系，并不需要建立它们之间的回归模型，也不需要区分自变量和因变量，这时候就可以使用较为方便的相关分析方法。</p>
<h3 id="矩阵相关分析"><a href="#矩阵相关分析" class="headerlink" title="矩阵相关分析"></a>矩阵相关分析</h3><p>设$x_{1},x_{2},\cdots,x_{n}$来自正态总体$N_{p}(\mu,\sum)$容量为n的样本，样本资料矩阵为：</p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/professional/180720/H36IHG218a.png?imageslim" alt="mark"></p>
<p>此时，任意两个变量间的相关系数构成的矩阵为：</p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/professional/180720/JAIFDed7eG.png?imageslim" alt="mark"></p>
<p>其中，$r_ij$为任意两个变量之间的简单相关系数，即：</p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/professional/180720/I6jmgkE985.png?imageslim" alt="mark"></p>
<h3 id="多元相关分析案例"><a href="#多元相关分析案例" class="headerlink" title="多元相关分析案例"></a>多元相关分析案例</h3><p>现在看一个案例，这个案例的数据来源于《医学统计学》第四版.孙振球，案例描述如下：</p>
<p>27名糖尿病患者的血清总胆固醇、甘油三酯、空腹胰岛素、糖化血红蛋白、空腹血糖的测量值位于下表中，试计算这几个变量两两之间的相关系数。</p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/professional/180719/aG3BEk29fH.png?imageslim" alt="mark"></p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/professional/180719/abbIG27Ajm.png?imageslim" alt="mark"></p>
<p>第一步：计算两两变量之间的相关系数，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">mlr &lt;- read.table(<span class="string">"https://raw.githubusercontent.com/20170505a/raw_data/master/data_szq_1501.csv"</span>,header=<span class="literal">T</span>,sep=<span class="string">","</span>) <span class="comment"># 原始数据集</span></div><div class="line">cor(mlr[<span class="number">2</span>:<span class="number">6</span>])</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">&gt; cor(mlr[<span class="number">2</span>:<span class="number">6</span>])</div><div class="line">           X1          X2          X3         X4          Y</div><div class="line">X1  <span class="number">1.0000000</span>  <span class="number">0.63150583</span> -<span class="number">0.35479471</span>  <span class="number">0.4152708</span>  <span class="number">0.5585251</span></div><div class="line">X2  <span class="number">0.6315058</span>  <span class="number">1.00000000</span> -<span class="number">0.03863221</span>  <span class="number">0.2189743</span>  <span class="number">0.4585096</span></div><div class="line">X3 -<span class="number">0.3547947</span> -<span class="number">0.03863221</span>  <span class="number">1.00000000</span> -<span class="number">0.3297787</span> -<span class="number">0.5101213</span></div><div class="line">X4  <span class="number">0.4152708</span>  <span class="number">0.21897432</span> -<span class="number">0.32977870</span>  <span class="number">1.0000000</span>  <span class="number">0.6096420</span></div><div class="line">Y   <span class="number">0.5585251</span>  <span class="number">0.45850963</span> -<span class="number">0.51012130</span>  <span class="number">0.6096420</span>  <span class="number">1.0000000</span></div></pre></td></tr></table></figure>
<p>从上面的结果可以看出来，X4与血糖的高低最为密切，它的r值为0.609，接着是X1，它的r值是0.558。</p>
<p>第二步：绘制出两两间的矩阵散点图，使用<code>pairs()</code>函数，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pairs(mlr[<span class="number">2</span>:<span class="number">6</span>])</div></pre></td></tr></table></figure>
<p><img src="http://ortxpw68f.bkt.clouddn.com/professional/180720/a1cca88Jf2.png?imageslim" alt="mark"></p>
<p>现在看一下相关系数的假设检验，这里用到的包是<code>mvstats</code>，但是这个包不在CRAN上，可能是《多元统计分析及R语言建模》（王斌会 ）自己写的，网上有，下载后安装即可，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">&gt; <span class="keyword">library</span>(mvstats)</div><div class="line">&gt; corr.test(mlr[<span class="number">2</span>:<span class="number">6</span>])</div><div class="line">corr test: </div><div class="line">       X1      X2      X3     X4      Y</div><div class="line">X1  <span class="number">0.000</span>  <span class="number">0.0004</span>  <span class="number">0.0694</span> <span class="number">0.0312</span> <span class="number">0.0025</span></div><div class="line">X2  <span class="number">4.072</span>  <span class="number">0.0000</span>  <span class="number">0.8483</span> <span class="number">0.2725</span> <span class="number">0.0162</span></div><div class="line">X3 -<span class="number">1.897</span> -<span class="number">0.1933</span>  <span class="number">0.0000</span> <span class="number">0.0930</span> <span class="number">0.0066</span></div><div class="line">X4  <span class="number">2.283</span>  <span class="number">1.1221</span> -<span class="number">1.7466</span> <span class="number">0.0000</span> <span class="number">0.0007</span></div><div class="line">Y   <span class="number">3.367</span>  <span class="number">2.5797</span> -<span class="number">2.9655</span> <span class="number">3.8455</span> <span class="number">0.0000</span></div><div class="line">lower is t value，upper is p value</div></pre></td></tr></table></figure>
<p>左下角为t值，右上角为p值，现在把这个表格拆分一下就可以看清楚了，如下所示：</p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/professional/180720/2Ea6fkmf9B.png?imageslim" alt="mark"></p>
<p>左下角是相关系数的t值，右上三解是p值，至于如何查看，还不清楚，略过，有空补上。</p>
<h2 id="Spearman秩相关"><a href="#Spearman秩相关" class="headerlink" title="Spearman秩相关"></a>Spearman秩相关</h2><h3 id="秩相关的使用范围"><a href="#秩相关的使用范围" class="headerlink" title="秩相关的使用范围"></a>秩相关的使用范围</h3><p>秩相关(rank correlation)又称等级相关，是用双变量等级数据作直线相关分析，这类方法对原变量分布不作要求，属于非参数统计法，这种方法适用于下列资料：</p>
<ol>
<li>不服从双变量正态分布而不宜作积差相关分析，这一点从原始数据的基本统计描述中或直观的散点图中就可以看出来；</li>
<li>总体分布型未知，例如限于仪器测量精度，个别样本的具体数值无法读取而出现“超限值”时；</li>
<li>原始数据是等级资料（例如某些药物治疗疾病的结果用恶化，没改善，好转来表示）。</li>
</ol>
<h3 id="秩相关的基本思想"><a href="#秩相关的基本思想" class="headerlink" title="秩相关的基本思想"></a>秩相关的基本思想</h3><p>在秩相关中，使用等级相关系数$r_{s}$来说明两个变量之间直线相关关系的密切程度与相关方向，其基本思想是将n对观察值$X_{i},Y_{i}(i=1,2,\cdots,n)$分别由小到大偏秩（秩就编号的意思，最小的是1，第2小的是2，最后1个是n），用$P_{i}$表示$X_{i}$的秩，用$Q_{i}$表示$Y_{i}$的秩，其中，每对$P_{i},Q_{i}$可能相等，也可能不等，这里考虑用$P_{i}$与$Q_{i}$之差来反映X、Y两变量秩排列一致性的情况，令$d_{i}=P_{i}-Q_{i}$，由于$d_{i}$可正可负，那么$\sum d_{i}$就无法准确地反映$P_{i}$与$Q_{i}$差值的大小，因此取$\sum {d_{i}}^2=\sum(P_{i}-Q_{i})^2$。在n为一定值时，当每对$X_{i},Y_{i}$的秩完全相等时，此为完全正相关，此时，$\sum {d_{i}}^2$有最小值，为0。当每对$X_{i},Y_{i}$的秩完全相反时，此为完全负相关，此时，$\sum {d_{i}}^2$有最大值，最大值如下所示：</p>
<p>$\sum {d_{i}}^2=\sum(P_{i}-Q_{i})^2=\sum[(n+1-i)-i]^2=n(n^2-1)/3$（公式五）</p>
<p>$\sum {d_{i}}^2$从0到其最大值的范围的变化，反映了X、Y两变量的相关程度，为了与积差相关系数r（这个r就是直线相关的相关系数）表示相关程度与方向的形式一致，那么过计算Spearman等级相关的系数$r_{s}$就如下所示：</p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/professional/180719/f66BKgJ424.png?imageslim" alt="mark"></p>
<p>$r_{s}$的值介于-1到1之间，当为正值时，表示正相关，为负表示负相关，等于0表示零相关，样本等级相关系数$r_{s}$是总体等级相关系数$\rho_{s}$的估计值，检验$\rho_{s}$是否不为零可以查表，当n&gt;50时，可以按下面的这个公式计算 检验统计量u，查u表确定p值，公式如下：</p>
<p>$\mu=r_{s} \sqrt{n-1}$（公式七）</p>
<h2 id="秩相关计算案例"><a href="#秩相关计算案例" class="headerlink" title="秩相关计算案例"></a>秩相关计算案例</h2><p>这个案例来源于《医学统计学》（第四版，孙振球），案例描述如下所示：</p>
<p>某省调查了1995年到1999年当地居民18类死因的构成以及每种死因导致的潜在工作损失年数WYPLL的构成，结果见下表，以死因构成为X，WYPLL构成为Y，作等级相关分析。</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>死因类别</th>
<th>死因构成（%）</th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
<td>X</td>
<td>P</td>
<td>Y</td>
<td>Q</td>
<td>d</td>
<td>$d^2$</td>
</tr>
<tr>
<td>(1)</td>
<td>(2)</td>
<td>(3)</td>
<td>(4)</td>
<td>(5)</td>
<td>(6)=(3)-(5)</td>
<td>(7)=(6)^2</td>
</tr>
<tr>
<td>1</td>
<td>0.03</td>
<td>1</td>
<td>0.05</td>
<td>1</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td>2</td>
<td>0.14</td>
<td>2</td>
<td>0.34</td>
<td>2</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td>3</td>
<td>0.2</td>
<td>3</td>
<td>0.93</td>
<td>6</td>
<td>-3</td>
<td>9</td>
</tr>
<tr>
<td>4</td>
<td>0.43</td>
<td>4</td>
<td>0.69</td>
<td>4</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td>5</td>
<td>0.44</td>
<td>5</td>
<td>0.38</td>
<td>3</td>
<td>2</td>
<td>4</td>
</tr>
<tr>
<td>6</td>
<td>0.45</td>
<td>6</td>
<td>0.79</td>
<td>5</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>7</td>
<td>0.47</td>
<td>7</td>
<td>1.19</td>
<td>8</td>
<td>-1</td>
<td>1</td>
</tr>
<tr>
<td>8</td>
<td>0.65</td>
<td>8</td>
<td>4.74</td>
<td>12</td>
<td>-4</td>
<td>16</td>
</tr>
<tr>
<td>9</td>
<td>0.95</td>
<td>9</td>
<td>2.31</td>
<td>9</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td>10</td>
<td>0.96</td>
<td>10</td>
<td>5.95</td>
<td>14</td>
<td>-4</td>
<td>16</td>
</tr>
<tr>
<td>11</td>
<td>2.44</td>
<td>11</td>
<td>1.11</td>
<td>7</td>
<td>4</td>
<td>16</td>
</tr>
<tr>
<td>12</td>
<td>2.69</td>
<td>12</td>
<td>3.53</td>
<td>11</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>13</td>
<td>3.207</td>
<td>13</td>
<td>3.48</td>
<td>10</td>
<td>3</td>
<td>9</td>
</tr>
<tr>
<td>14</td>
<td>7.78</td>
<td>14</td>
<td>5.65</td>
<td>13</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>15</td>
<td>9.82</td>
<td>15</td>
<td>33.95</td>
<td>18</td>
<td>-3</td>
<td>9</td>
</tr>
<tr>
<td>16</td>
<td>18.93</td>
<td>16</td>
<td>17.16</td>
<td>17</td>
<td>-1</td>
<td>1</td>
</tr>
<tr>
<td>17</td>
<td>22.59</td>
<td>17</td>
<td>8.42</td>
<td>15</td>
<td>2</td>
<td>4</td>
</tr>
<tr>
<td>18</td>
<td>27.96</td>
<td>18</td>
<td>9.33</td>
<td>16</td>
<td>2</td>
<td>4</td>
</tr>
</tbody>
</table>
</div>
<p>假设检验：</p>
<p>$H_{0}:\rho_{s}=0$，即死因构成和WYPLL构成之间无直线相关关系</p>
<p>$H_{1}:\rho_{s} \neq0$，即死因构成和WYPLL构成之间有直线相关关系</p>
<p>$\alpha=0.05$</p>
<p>将两变量X、Y的实测值分别从小到大编秩，用$P_{i}$和${Q_{i}}$表示，见上表的(3)、(5)列，每个变量中若有观察值相同的秩，则取平均秩。求每天的秩的差值d、$d^2$，$\sum d^2$，也就是上表的第(6)、(7)栏，按前面的公式（六）计算$r_{s}$，如下所示：</p>
<p><img src="http://ortxpw68f.bkt.clouddn.com/professional/180719/C8GKLGAa77.png?imageslim" alt="mark"></p>
<p>在本例中，n=18，查$r_{s}$的界值表可知，p&lt;0.001，按$\alpha=0.05$的检验水准，拒绝$H_{0}$，接受$H_{1}$，可认为当地居民死因的构成和和各种死因导致的潜在工作损失年数WYPLL的构成存在正相关关系。</p>
<p>现在用R来计算一下，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">death_reason &lt;- c(<span class="number">0.03</span>,<span class="number">0.14</span>,<span class="number">0.2</span>,<span class="number">0.43</span>,<span class="number">0.44</span>,<span class="number">0.45</span>,<span class="number">0.47</span>,<span class="number">0.65</span>,<span class="number">0.95</span>,<span class="number">0.96</span>,<span class="number">2.44</span>,<span class="number">2.69</span>,<span class="number">3.207</span>,<span class="number">7.78</span>,<span class="number">9.82</span>,<span class="number">18.93</span>,<span class="number">22.59</span>,<span class="number">27.96</span>)</div><div class="line">wyypll &lt;-c(<span class="number">0.05</span>,<span class="number">0.34</span>,<span class="number">0.93</span>,<span class="number">0.69</span>,<span class="number">0.38</span>,<span class="number">0.79</span>,<span class="number">1.19</span>,<span class="number">4.74</span>,<span class="number">2.31</span>,<span class="number">5.95</span>,<span class="number">1.11</span>,<span class="number">3.53</span>,<span class="number">3.48</span>,<span class="number">5.65</span>,<span class="number">33.95</span>,<span class="number">17.16</span>,<span class="number">8.42</span>,<span class="number">9.33</span>)</div><div class="line">cor.test(death_reason,wyypll,method=<span class="string">"spearman"</span>)</div></pre></td></tr></table></figure>
<p>计算结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">&gt; cor.test(death_reason,wyypll,method=<span class="string">"spearman"</span>)</div><div class="line"></div><div class="line">	Spearman<span class="string">'s rank correlation rho</span></div><div class="line"><span class="string"></span></div><div class="line"><span class="string">data:  death_reason and wyypll</span></div><div class="line"><span class="string">S = 92, p-value &lt; 2.2e-16</span></div><div class="line"><span class="string">alternative hypothesis: true rho is not equal to 0</span></div><div class="line"><span class="string">sample estimates:</span></div><div class="line"><span class="string">      rho </span></div><div class="line"><span class="string">0.9050568</span></div></pre></td></tr></table></figure>
<p>其中，可以发现p值远小于0.01，因此，可认为当地居民死因的构成和和各种死因导致的潜在工作损失年数WYPLL的构成存在正相关关系。</p>
<h2 id="Spearman与Pearson相关分析的区别"><a href="#Spearman与Pearson相关分析的区别" class="headerlink" title="Spearman与Pearson相关分析的区别"></a>Spearman与Pearson相关分析的区别</h2><p><strong>Pearson相关系数主要用于正态分布资料，Spearman相关系数主要用于非正态分布资料或等级资料</strong>，看一个案例：</p>
<p>例6.1 某疾控中心调查了辖区内公务员的体重指数、血压、总胆固醇、空腹血糖等指标，以了解他们的健康状况。现从中随机抽取20人的体重指数、总胆固醇(mmol/L)、空腹血糖(mmol/L)三个指标，分析这三个指标的相关性(《医学案例统计分析与SAS应用》冯国双，第六章 相关分析及SAS实现，例6-2，P103)。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">bmi &lt;- c(19.49,21.1,20.56,22.15,22.49,19.56,26.64,22.98,25.8,21.88,21.08,25.25,25.59,23.23,24.17,27.44,27.18,27.46,28.93,24.49)</div><div class="line">tc &lt;- c(4.21,4.25,4.34,4.51,4.72,4.79,4.8,4.84,4.97,5.04,5.14,5.23,5.25,5.28,5.83,5.89,6.05,6.07,6.17,6.68)</div><div class="line">fbg &lt;- c(5.1,5.1,5.1,5.7,5.3,5.6,5.4,5.1,5.6,5.7,5.4,5.9,5,5.8,5.9,5.08,5.7,5.9,6.2,5.9)</div><div class="line"></div><div class="line"># 进行正态检验</div><div class="line"></div><div class="line">normality_test &lt;- function(x)&#123;</div><div class="line">  if(!require(nortest))&#123;</div><div class="line">    install.packages(&quot;nortest&quot;)</div><div class="line">  &#125;</div><div class="line">    SW &lt;- c(shapiro.test(x)$statistic,shapiro.test(x)$p.value)</div><div class="line">    KS &lt;- c(lillie.test(x)$statistic,lillie.test(x)$p.value)</div><div class="line">    CM &lt;- c(cvm.test(x)$statistic,cvm.test(x)$p.value)</div><div class="line">    AD &lt;- c(ad.test(x)$statistic,ad.test(x)$p.value)</div><div class="line">    result &lt;- rbind(SW,KS,CM,AD)</div><div class="line">    colnames(result) &lt;- c(&quot;参数&quot;,&quot;P值&quot;)</div><div class="line">    rownames(result) &lt;- c(&quot;Shapiro-Wilk&quot;,&quot;Kolmogorov-Smirnov&quot;,&quot;Cramer-von Mises&quot;,&quot;Anderson-Darling&quot;)</div><div class="line">    return(result)</div><div class="line">&#125;</div><div class="line"></div><div class="line">normality_test(bmi)</div><div class="line">normality_test(tc)</div><div class="line">normality_test(fbg)</div></pre></td></tr></table></figure>
<p>计算结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">&gt; normality_test(bmi)</div><div class="line">Loading required package: nortest</div><div class="line">                         参数       P值</div><div class="line">Shapiro-Wilk       <span class="number">0.95943187</span> <span class="number">0.5325625</span></div><div class="line">Kolmogorov-Smirnov <span class="number">0.08966131</span> <span class="number">0.9429037</span></div><div class="line">Cramer-von Mises   <span class="number">0.03912813</span> <span class="number">0.6800017</span></div><div class="line">Anderson-Darling   <span class="number">0.26621338</span> <span class="number">0.6521088</span></div><div class="line">&gt; normality_test(tc)</div><div class="line">                         参数       P值</div><div class="line">Shapiro-Wilk       <span class="number">0.94642760</span> <span class="number">0.3160935</span></div><div class="line">Kolmogorov-Smirnov <span class="number">0.15632558</span> <span class="number">0.2254919</span></div><div class="line">Cramer-von Mises   <span class="number">0.07256231</span> <span class="number">0.2452443</span></div><div class="line">Anderson-Darling   <span class="number">0.41984856</span> <span class="number">0.2949359</span></div><div class="line">&gt; normality_test(fbg)</div><div class="line">                         参数        P值</div><div class="line">Shapiro-Wilk       <span class="number">0.91658692</span> <span class="number">0.08519076</span></div><div class="line">Kolmogorov-Smirnov <span class="number">0.17996352</span> <span class="number">0.08886482</span></div><div class="line">Cramer-von Mises   <span class="number">0.09973686</span> <span class="number">0.10482513</span></div><div class="line">Anderson-Darling   <span class="number">0.67392089</span> <span class="number">0.06650739</span></div></pre></td></tr></table></figure>
<p>正态检验的结果表明，三个指标采用Shapiro-WIlk、Kolmogorov-Smirnov法，bmi与tc的P值均远远大于0.05，fbg的P值仅略大于0.05，为稳妥起见，下面分别按正态分布与非正态分布进行线性相关分析，即分别采用Pearson与Spearman相关分析。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">cor.test(bmi,tc)</div><div class="line"># </div><div class="line"># Pearson&apos;s product-moment correlation</div><div class="line"># </div><div class="line"># data:  bmi and tc</div><div class="line"># t = 4.3734, df = 18, p-value = 0.0003664</div><div class="line"># alternative hypothesis: true correlation is not equal to 0</div><div class="line"># 95 percent confidence interval:</div><div class="line"># 0.4033506 0.8805849</div><div class="line"># sample estimates:</div><div class="line"># cor </div><div class="line"># 0.717758</div></pre></td></tr></table></figure>
<p>Pearson相关分析结果：bmi与tc间的相关系数是0.718,有统计学意义(P=0.0003664)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">cor.test(bmi,fbg)</div><div class="line"># Pearson&apos;s product-moment correlation</div><div class="line"># </div><div class="line"># data:  bmi and fbg</div><div class="line"># t = 1.8681, df = 18, p-value = 0.07811</div><div class="line"># alternative hypothesis: true correlation is not equal to 0</div><div class="line"># 95 percent confidence interval:</div><div class="line"># -0.04811789  0.71754554</div><div class="line"># sample estimates:</div><div class="line"># cor </div><div class="line"># 0.4029837</div></pre></td></tr></table></figure>
<p>Pearson相关分析结果：bmi与fbg间的相关系数是0.403,无统计学意义(P=0.07811)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">cor.test(tc,fbg)</div><div class="line"># Pearson&apos;s product-moment correlation</div><div class="line"># </div><div class="line"># data:  tc and fbg</div><div class="line"># t = 3.2599, df = 18, p-value = 0.004349</div><div class="line"># alternative hypothesis: true correlation is not equal to 0</div><div class="line"># 95 percent confidence interval:</div><div class="line"># 0.2283232 0.8284398</div><div class="line"># sample estimates:</div><div class="line"># cor </div><div class="line"># 0.6092833</div></pre></td></tr></table></figure>
<p>Pearson相关分析结果：bmi与tc间的相关系数是0.609,有统计学意义(P=0.004349)</p>
<p><strong>接着进行Spearman分析</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">cor.test(bmi,tc,method=c(&quot;spearman&quot;)) # Spearman检验</div><div class="line"># Spearman&apos;s rank correlation rho</div><div class="line"># </div><div class="line"># data:  bmi and tc</div><div class="line"># S = 330, p-value = 0.0002006</div><div class="line"># alternative hypothesis: true rho is not equal to 0</div><div class="line"># sample estimates:</div><div class="line">#       rho </div><div class="line"># 0.7518797</div></pre></td></tr></table></figure>
<p>Spearman相关分析结果：bmi与tc间的相关系数是0.752,有统计学意义(P=0.0002006)</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">cor.test(bmi,fbg,method=c(<span class="string">"spearman"</span>)) <span class="comment"># Spearman检验</span></div><div class="line"><span class="comment"># Spearman's rank correlation rho</span></div><div class="line"><span class="comment"># </span></div><div class="line"><span class="comment"># data:  bmi and fbg</span></div><div class="line"><span class="comment"># S = 859.38, p-value = 0.1259</span></div><div class="line"><span class="comment"># alternative hypothesis: true rho is not equal to 0</span></div><div class="line"><span class="comment"># sample estimates:</span></div><div class="line"><span class="comment"># rho </span></div><div class="line"><span class="comment"># 0.3538517</span></div></pre></td></tr></table></figure>
<p>Spearman相关分析结果：bmi与fbg间的相关系数是0.354,无统计学意义(P=0.1259)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">cor.test(tc,fbg,method=c(&quot;spearman&quot;)) # Spearman检验</div><div class="line"># Spearman&apos;s rank correlation rho</div><div class="line"># </div><div class="line"># data:  tc and fbg</div><div class="line"># S = 564.48, p-value = 0.007919</div><div class="line"># alternative hypothesis: true rho is not equal to 0</div><div class="line"># sample estimates:</div><div class="line"># rho </div><div class="line"># 0.5755785</div></pre></td></tr></table></figure>
<p>Spearman相关分析结果：fbg与tc间的相关系数是0.576,有统计学意义(P=0.007919)</p>
<h2 id="Kendall-τ相关系数"><a href="#Kendall-τ相关系数" class="headerlink" title="Kendall τ相关系数"></a>Kendall τ相关系数</h2><p>Kendall τ相关系数也是一种关于两个变量相关的度量，它的原理是把所有的样本点配对，如果$(x_{1},y_{1}),\cdots,(x_{n},y_{n})$是这两个变量的n个观测值对子。</p>
<p>如果每一个点由x和y组成的坐标(x,y)代表，一对点，就是诸如$(x_{i},y_{i})$和$(x_{j},y_{j})$的点对（这里的i和j不同）；然后看每一对中的x和y的观测值是否同时增加（或减少），比如由点对$(x_{1},y_{1})$和$(x_{2},y_{2})$可以算出乘积$(x_{2}-x_{1})(y_{2}-y_{1})$是否大于0。如果$(x_{2}-x_{1})(y_{2}-y_{1})$大于0，则说明这点中的x和y同时增长或下降。我们就说这两点<strong>协同(concordant)</strong>，如果这个乘积小于0，那么说明这两个点中的x和y并非同时增长或同时下降，我们称这两点<strong>不协同(discordant)</strong>。如果样本中协同的点数目多，两个变量就更加正相关一些；如果样本中不协同的点数目多，两个变量就更加负相关一些；如果既不正相关，也不负相关，则为不相关。</p>
<p>Kendall系统的公式为</p>
<p><img src="http://a4.att.hudong.com/21/34/01200000123509134436340797162_s.jpg" alt=""></p>
<p>其中n是项目的数量，和P的总和，对所有的项目，项目的数量排名后，给予这两个项目的排名。 P也可以被解释为是一致的对数。分母可以解释为总对数。因此，一个高价值的P，大多数是一致的，表明这两个序列是一致的。请注意，并列一双不被视为一致或不一致。如果有大量的关系，总人数的双（分母中的表达τ ）应作相应调整。</p>
<p>该肯德尔系数（τ,或tau）具有下列属性</p>
<p>如果排列双方的排名是完美的（即两个排名是相同的）的系数的价值1。如果两排列之间的分歧排名是完美的（即一个排名是扭转其他）的系数价值-1 。对于所有其他的值在于介于-1和1之间的排列，增加值意味着增加之间的排列的排名。如果排名是完全独立的，该系数已值为0的平均水平。</p>
<p>这种方法用不差对总体做任何假定也可以检验，因此这是一个非参数的检验（所谓非参数方法，就是它不依赖于变量背后的总体分布）。Kendall τ也是在-1和1之间的娄和，也是越接近1或-1就越相关，越接近于0就不相关。<br>和Kendall τ相联系也有零假设是“两个变量独立”的假设检验，即使在正态假定成立时，相对于和Pearson相关系数有关检验，这个检验的效率也很高，在正态假定不那么确定时，与Kendall τ有关的检验对查看两个变量的独立性是非常有用的。</p>
<p>现在我们看一下秩相关分析案例使用Kenall进行计算的结果，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">death_reason &lt;- c(<span class="number">0.03</span>,<span class="number">0.14</span>,<span class="number">0.2</span>,<span class="number">0.43</span>,<span class="number">0.44</span>,<span class="number">0.45</span>,<span class="number">0.47</span>,<span class="number">0.65</span>,<span class="number">0.95</span>,<span class="number">0.96</span>,<span class="number">2.44</span>,<span class="number">2.69</span>,<span class="number">3.207</span>,<span class="number">7.78</span>,<span class="number">9.82</span>,<span class="number">18.93</span>,<span class="number">22.59</span>,<span class="number">27.96</span>)</div><div class="line">wyypll &lt;-c(<span class="number">0.05</span>,<span class="number">0.34</span>,<span class="number">0.93</span>,<span class="number">0.69</span>,<span class="number">0.38</span>,<span class="number">0.79</span>,<span class="number">1.19</span>,<span class="number">4.74</span>,<span class="number">2.31</span>,<span class="number">5.95</span>,<span class="number">1.11</span>,<span class="number">3.53</span>,<span class="number">3.48</span>,<span class="number">5.65</span>,<span class="number">33.95</span>,<span class="number">17.16</span>,<span class="number">8.42</span>,<span class="number">9.33</span>)</div><div class="line">cor.test(death_reason,wyypll,method=<span class="string">"kendall"</span>)</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">&gt; cor.test(death_reason,wyypll,method=<span class="string">"kendall"</span>)</div><div class="line"></div><div class="line">	Kendall<span class="string">'s rank correlation tau</span></div><div class="line"><span class="string"></span></div><div class="line"><span class="string">data:  death_reason and wyypll</span></div><div class="line"><span class="string">T = 133, p-value = 2.522e-06</span></div><div class="line"><span class="string">alternative hypothesis: true tau is not equal to 0</span></div><div class="line"><span class="string">sample estimates:</span></div><div class="line"><span class="string">      tau </span></div><div class="line"><span class="string">0.7385621</span></div></pre></td></tr></table></figure>
<p>从上面的结果我们可以看到，p值几乎为0，τ的相关系数为0.7385621。</p>
<h2 id="关于这三个相关系数的区别"><a href="#关于这三个相关系数的区别" class="headerlink" title="关于这三个相关系数的区别"></a>关于这三个相关系数的区别</h2><p>Pearson相关系数描述的是两个变量的线性关系，而Spearman和Kendall τ这两个非参数度量更为一般的关于单调关系的度量，这是因为一个变量的秩不会被任何对该变量的单调的严格递增的变换所改变，因此，把这两个非参数度量称为关联(association)的度量可能更为合适。</p>
<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><ol>
<li>孙振球. 医学统计学.第3版[M]. 人民卫生出版社, 2010.</li>
<li>DawnGriffiths. 深入浅出统计学[M]. 电子工业出版社, 2012.</li>
<li>王斌会. 多元统计分析及R语言建模[M]. 暨南大学出版社, 2010.</li>
<li>吴喜之. 统计学:从数据到结论(第四版)[J]. 中国统计, 2013(6):2.</li>
<li>冯国双, 罗凤基. 医学案例统计分析与SAS应用[M]. 北京大学医学出版社, 2011.</li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/13/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/13/">13</a><span class="page-number current">14</span><a class="page-number" href="/page/15/">15</a><span class="space">&hellip;</span><a class="page-number" href="/page/18/">18</a><a class="extend next" rel="next" href="/page/15/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">RVDSD</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">176</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">11</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">53</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          <div class="links-of-author motion-element">
            
          </div>

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

<div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">RVDSD</span>

  
</div>



<div class="powered-by">
<i class="fa fa-user-md"></i><span id="busuanzi_container_site_pv">
  本站访客数:<span id="busuanzi_value_site_uv"></span>
</span>
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>

<div class="BbeiAn-info">
	<a target="_blank" href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=41018102000118" style="color:#909090;text-decoration:none;padding-left:30px;no-repeat left center" rel="nofollow">豫公网安备 41018102000118</a>	  <!--这里将图标作为了背景，以使得能和后面的文字在同一行-->
</div>

  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.3</div>




<div class="theme-info">
  <div class="powered-by"></div>
  <span class="post-count">博客全站共659.4k字</span>
</div>

        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.3"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.3"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.3"></script>



  


  




	





  





  












  





  

  

  
  

  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config("");
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="custom_mathjax_source">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->
  


  

  

</body>
</html>
