<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.3" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.3">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.3" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta name="description" content="前言 非参数检验(non-parametric test)是相对于参数检验(parametric test)而言的。如果总体分布为已知的数学形式，用参数检验，反之用非参数检验。当总体分布不能由已知的数学形式表达，没有总体参数时，就无法用参数检验，两个或多个正态总体方差不等，也不能用t检验或F检验的参数检验。对于不满足参数检验条件的数据，一是进行变量变换，使其满足参数检验条件，另外就是用非参数检验">
<meta property="og:type" content="article">
<meta property="og:title" content="非参数检验笔记">
<meta property="og:url" content="http://rvdsd.top/2018/06/23/BioStatistics/生物统计-06非参数检验/index.html">
<meta property="og:site_name" content="RVDSD的个人笔记本">
<meta property="og:description" content="前言 非参数检验(non-parametric test)是相对于参数检验(parametric test)而言的。如果总体分布为已知的数学形式，用参数检验，反之用非参数检验。当总体分布不能由已知的数学形式表达，没有总体参数时，就无法用参数检验，两个或多个正态总体方差不等，也不能用t检验或F检验的参数检验。对于不满足参数检验条件的数据，一是进行变量变换，使其满足参数检验条件，另外就是用非参数检验">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="http://ortxpw68f.bkt.clouddn.com/professional/180819/EhJ1bCk5HA.png?imageslim">
<meta property="og:image" content="http://ortxpw68f.bkt.clouddn.com/professional/180819/3j1H5fkEb9.png?imageslim">
<meta property="og:updated_time" content="2018-10-04T00:34:21.838Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="非参数检验笔记">
<meta name="twitter:description" content="前言 非参数检验(non-parametric test)是相对于参数检验(parametric test)而言的。如果总体分布为已知的数学形式，用参数检验，反之用非参数检验。当总体分布不能由已知的数学形式表达，没有总体参数时，就无法用参数检验，两个或多个正态总体方差不等，也不能用t检验或F检验的参数检验。对于不满足参数检验条件的数据，一是进行变量变换，使其满足参数检验条件，另外就是用非参数检验">
<meta name="twitter:image" content="http://ortxpw68f.bkt.clouddn.com/professional/180819/EhJ1bCk5HA.png?imageslim">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.3',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://rvdsd.top/2018/06/23/BioStatistics/生物统计-06非参数检验/"/>





  <title>非参数检验笔记 | RVDSD的个人笔记本</title><!-- hexo-inject:begin --><!-- hexo-inject:end -->
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">RVDSD的个人笔记本</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">学习过程中的输出</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2018/06/23/BioStatistics/生物统计-06非参数检验/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">非参数检验笔记</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-06-23T12:02:00+08:00">
                2018-06-23
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/生物统计/" itemprop="url" rel="index">
                    <span itemprop="name">生物统计</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  5,564
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  24
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h2 id="前言">前言</h2>
<p>非参数检验(non-parametric test)是相对于参数检验(parametric test)而言的。如果总体分布为已知的数学形式，用参数检验，反之用非参数检验。当总体分布不能由已知的数学形式表达，没有总体参数时，就无法用参数检验，两个或多个正态总体方差不等，也不能用t检验或F检验的参数检验。对于不满足参数检验条件的数据，一是进行变量变换，使其满足参数检验条件，另外就是用非参数检验。非参检验对总体分布不作严格假定，又称任意分布检验(distribution-free test)，《医学统计学》（第三版，孙振球）书中采用的是秩转换的非参数检验，即将数值变量从小到大排列，再计算检验统计量。</p>
<p>非参数检验在总体分布未知时有很大的优越性，在分布未时，如果还假定总体诸如正态分布那样的已知分布，在进行统计推断时就可能产生错误。非参数检验总是比传统检验案例，但是在总体分布形式已经已知时，非参数检验就不如传统方法效率高，这是因为非参数方法利用的利息要少些。往往在传统方法可以拒绝零假设的情况下，非参数检验无法拒绝。用统计的术语来说，在总体分布已知时，传统方法有较大的功效(power)，效率要高；但非参数统计在总体分布未知时，效率往往比假定了错误总体分布时的传统方法要高，有时候要高很多。</p>
<h2 id="秩的概念">秩的概念</h2>
<p>非参数检验中的秩(rank)是最常用的概念，秩就是该数据按照升序排列后，每个观测值的位置。例如我们有下面的数据（样本量为10），其中第一行为数据本身，第二行就是它们的秩，可以看出，3最小，秩为1，13其次，秩为2，而最大的是98，秩为10，我们使用rank(x)表示x的秩，通常也用Ri表示观测值<span class="math inline">\(x_{i}\)</span>的秩，如下所示：</p>
<table>
<thead>
<tr class="header">
<th><span class="math inline">\(x_{i}\)</span></th>
<th>98</th>
<th>67</th>
<th>63</th>
<th>3</th>
<th>38</th>
<th>16</th>
<th>21</th>
<th>53</th>
<th>13</th>
<th>81</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(R_{i}=rank(x_{i})\)</span></td>
<td>10</td>
<td>8</td>
<td>7</td>
<td>1</td>
<td>5</td>
<td>3</td>
<td>4</td>
<td>6</td>
<td>2</td>
<td>9</td>
</tr>
</tbody>
</table>
<h2 id="非参数检验的原理">非参数检验的原理</h2>
<p>如果零假设中确定了一个中位数<span class="math inline">\(M_{0}\)</span>，那么样本点应该以同样的概率出现在<span class="math inline">\(M_{0}\)</span>的两边，也就是说，如果每个样本点送去零假设的中位数，那么得到的差值有些为正，有些为负，如果零假设正确，那么正负符号数目应该差不多，如果差得很多，这就意味着零假设有问题，可以拒绝零假设。这也就是所谓的<strong>符号检验(sign test)</strong>。</p>
<p>这里没有涉及任何总体分布，在零假设下，样本点和<span class="math inline">\(M_{0}\)</span>的差值中负号的个数（记为<span class="math inline">\(S^-\)</span>）应该服从二项分布Bin(n,α)，而正号的个数（记为<span class="math inline">\(S^+\)</span>）䚱服从二项分布Bin(n,1-α)，注意，对于已知对称的分布，由于中位数和均值相等，对中位数的检验等同于对均值的检验，我们通过一个例子来解释符号检验。</p>
<h2 id="单样本的关于总体中位数的符号检验">单样本的关于总体中位数的符号检验</h2>
<p>案例A，质量监督部门对商店里出售的某厂家的西洋参片进行了抽查，对于25包写明为净重100g的西洋参片的称重结果如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180819/EhJ1bCk5HA.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>这里的总体分布未知（我们只是假设未知，其实它的分布是可以计算出来的），用M表示总体中位数，容易计算出，样本中位数为m=98.36，因为人们怀疑厂家包装的西洋参片分量。由于对于重量的总体分布不清楚，决定对其进行符号检验，需要的检验如下所示：</p>
<p><span class="math display">\[H_{0}:M=100\iff H_{1}:M&lt;100\]</span></p>
<p>按照零假设，每个观测值（每包西洋参的净重）大于中位数<span class="math inline">\(M_{0}=100\)</span>的概率和小于100的概率都是0.5，这应该服从二项分布Bin(25,0.5)，容易计算出大于100的只有<span class="math inline">\(S^+=8\)</span>，这样的参数为n=25，p=0.5的二项分布变量小于或等于8的概率为0.05388，这就是p值，历引，对于显著性水平α=0.05，根据这个符号检验，我们没有足够的证据拒绝零假设。在R中计算的过程如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">&gt; pbinom(<span class="number">8</span>,<span class="number">25</span>,<span class="number">0.5</span>)</div><div class="line">[<span class="number">1</span>] <span class="number">0.05387607</span></div><div class="line"><span class="comment"># 或者按另外一种方法：</span></div><div class="line">&gt; raw &lt;-c(<span class="number">99.05</span>,<span class="number">100.25</span>,<span class="number">102.56</span>,<span class="number">99.15</span>,<span class="number">104.89</span>,<span class="number">101.86</span>,<span class="number">96.37</span>,<span class="number">96.79</span>,<span class="number">99.37</span>,</div><div class="line">+         <span class="number">96.9</span>,<span class="number">93.94</span>,<span class="number">92.97</span>,<span class="number">108.28</span>,<span class="number">96.86</span>,<span class="number">93.94</span>,<span class="number">98.27</span>,<span class="number">98.36</span>,<span class="number">100.81</span>,<span class="number">92.99</span>,</div><div class="line">+         <span class="number">103.72</span>,<span class="number">90.66</span>,<span class="number">98.24</span>,<span class="number">97.87</span>,<span class="number">99.21</span>,<span class="number">101.79</span>)</div><div class="line">&gt; pbinom(length(raw[raw&gt;=<span class="number">100</span>]),<span class="number">25</span>,<span class="number">0.5</span>)</div><div class="line">[<span class="number">1</span>] <span class="number">0.05387607</span></div></pre></td></tr></table></figure>
<p>一般来说，根据样本中位数和零假设中的待检验总体中位数<span class="math inline">\(M_{0}\)</span>的比较，我们的检验为下面三种形式之一（记样本中位数为m），如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180819/3j1H5fkEb9.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>这里的关于中位数的符号检验概率，完全可以很容易地推广到关于总体α分位数的符号检验中，如果零假设中确定了一个α分位数<span class="math inline">\(Q_{\alpha0}\)</span></p>
<p>那么，样本点应该以概率α出现在<span class="math inline">\(Q_{\alpha0}\)</span>的左边，或者以概率1-α出现在<span class="math inline">\(Q_{\alpha0}\)</span>的右边，因此样本点减去<span class="math inline">\(Q_{\alpha0}\)</span>差值中铅的个数（记为<span class="math inline">\(S^-\)</span>）应该服从二项分布Bin(n,α)，而正号的个数（记为<span class="math inline">\(S^+\)</span>）应该服从二项分布Bin(n,1-α)。当α=0.5时，总体α分位数就是总体中位数。</p>
<h2 id="单样本的关于对称总体中位数的wilcoxon符号秩检验">单样本的关于对称总体中位数的Wilcoxon符号秩检验</h2>
<p>前面的符号检验仅仅用了样本点和零假设的中位数或α分位数的差的符号，我们可以看到，检验的结果p值大于0.05，但是这种检验方法没有利用这些差的大小，下面介绍的Wilcoxn符号秩检验（Wilcoxon signed-rank test）把差的绝对值的秩分别按照不同的符号相加作为其检验统计量，这里把对总体唯一假定是总体具有对称分布，这种检验方法我们可以看到，它的功效要比前面介绍的高（计算出来的p值小于0.05）。</p>
<h3 id="wilcoxon符号秩检验原理">Wilcoxon符号秩检验原理</h3>
<p>Wilcoxon符号秩检验的原理是这样的，假定<span class="math inline">\(x_{1},x_{2},\cdots,x_{n}\)</span>为来自连续对称总体的一个样本，如果我们的假设检验问题的零假设为中位数（均值）<span class="math inline">\(M=M_{0}\)</span>。那么，对于符号检验而言，只需计算<span class="math inline">\(x_{i}-M_{0}(i=1,2,\cdots,n)\)</span>中有多少正负符号，即可利用二项分布的概率来计算p值。但对于Wilcoxon符号秩检验，则要把<span class="math inline">\(|x_{i}-M_{0}|\)</span>排序，得到<span class="math inline">\(|x_{i}-M_{0}|\)</span>的秩。然后把<span class="math inline">\(x_{i}-M_{0}\)</span>的符号加到相应的秩上面。于是，就可以得到既带有正号的秩，又带有负号的秩，对带负号的秩的绝对值求和，即把满足<span class="math inline">\(x_{i}-M_{0}&lt;0\)</span>的<span class="math inline">\(|x_{i}-M_{0}|\)</span>的秩求和，并用<span class="math inline">\(W^+\)</span>表示。如果<span class="math inline">\(M_{0}\)</span>的确是中位娄和，那么<span class="math inline">\(W^-\)</span>和<span class="math inline">\(W^+\)</span>应该大体上差不多。如果<span class="math inline">\(W^-\)</span>或者<span class="math inline">\(W^+\)</span>过大或过小，则应该怀疑中位数<span class="math inline">\(M=M_{0}\)</span>的零假设。令<span class="math inline">\(W=min(W^-,W^+)\)</span>，则当W太小时，应该拒绝零假设。这个W就是Wilcoxon符号秩检验统计量。</p>
<h2 id="r中的非参数检验函数">R中的非参数检验函数</h2>
<p>在R中进行Wilcoxon检验的函数是<code>wilcoxon.test</code>，使用方法如下所示：</p>
<p>如果总体不服从正态分布，那么T检验就不再适用，此时我们可以利用非参数方法推断中位数。wilcoxon.test函数可实现符号秩检验，如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">x &lt;- rnorm(50,mean=10,sd=5)</div><div class="line">wilcox.test(x,conf.int=T) #指定conf.int让函数返回中位数的置信区间</div><div class="line">wilcox.test(x,mu=1) #指定mu让函数返回中位数为10的检验结果</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">&gt; wilcox.test(x,conf.int=T) #指定conf.int让函数返回中位数的置信区间</div><div class="line"></div><div class="line">	Wilcoxon signed rank test with continuity correction</div><div class="line"></div><div class="line">data:  x</div><div class="line">V = 1271, p-value = 9.93e-10</div><div class="line">alternative hypothesis: true location is not equal to 0</div><div class="line">95 percent confidence interval:</div><div class="line">  9.31246 12.20277</div><div class="line">sample estimates:</div><div class="line">(pseudo)median </div><div class="line">       10.7765 </div><div class="line"></div><div class="line">&gt; wilcox.test(x,mu=1) #指定mu让函数返回中位数为10的检验结果</div><div class="line"></div><div class="line">	Wilcoxon signed rank test with continuity correction</div><div class="line"></div><div class="line">data:  x</div><div class="line">V = 1269, p-value = 1.121e-09</div><div class="line">alternative hypothesis: true location is not equal to 1</div></pre></td></tr></table></figure>
<h2 id="单个样本wilcoxon检验案例">单个样本Wilcoxon检验案例</h2>
<h4 id="案例a">案例A</h4>
<p>现在我们再看一下前面的那个案例A，使用Wilcoxon检验来看一下，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">&gt; raw &lt;-c(<span class="number">99.05</span>,<span class="number">100.25</span>,<span class="number">102.56</span>,<span class="number">99.15</span>,<span class="number">104.89</span>,<span class="number">101.86</span>,<span class="number">96.37</span>,<span class="number">96.79</span>,<span class="number">99.37</span>,</div><div class="line">+         <span class="number">96.9</span>,<span class="number">93.94</span>,<span class="number">92.97</span>,<span class="number">108.28</span>,<span class="number">96.86</span>,<span class="number">93.94</span>,<span class="number">98.27</span>,<span class="number">98.36</span>,<span class="number">100.81</span>,<span class="number">92.99</span>,</div><div class="line">+         <span class="number">103.72</span>,<span class="number">90.66</span>,<span class="number">98.24</span>,<span class="number">97.87</span>,<span class="number">99.21</span>,<span class="number">101.79</span>)</div><div class="line">&gt; wilcox.test(raw,mu=<span class="number">100</span>,alternative = <span class="string">"less"</span>)</div><div class="line"></div><div class="line">	Wilcoxon signed rank test with continuity correction</div><div class="line"></div><div class="line">data:  raw</div><div class="line">V = <span class="number">100</span>, p-value = <span class="number">0.04763</span></div><div class="line">alternative hypothesis: true location is less than <span class="number">100</span></div><div class="line"></div><div class="line">Warning message:</div><div class="line">In wilcox.test.default(raw, mu = <span class="number">100</span>, alternative = <span class="string">"less"</span>) :</div><div class="line">  无法精確計算带连结的p值</div></pre></td></tr></table></figure>
<h4 id="案例b">案例B</h4>
<p>现在再看一个案例B，下面是随机挑选了12袋包装上写的重量是15g的干酵母粉，并进行称重所得到的重量的数据，如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">12.39,15.64,14,14.17,14.08,14.16,13.94,14.61,14.7,12.81,14.12,13.37</div></pre></td></tr></table></figure>
<p>由于总体中位数是14.1，而零假设的总体均值是15，因此我们可以怀疑这种袋装酵母粉不够分量，相应的关于中位数的检验如下所示：</p>
<p><span class="math display">\[H_{0}:M=15\iff H_{1}:M&lt;15\]</span></p>
<p>假定总体是对称分布的，因此可以应用Wilcoxon符号秩检验，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">&gt; raw_b &lt;- c(<span class="number">12.39</span>,<span class="number">15.64</span>,<span class="number">14</span>,<span class="number">14.17</span>,<span class="number">14.08</span>,<span class="number">14.16</span>,<span class="number">13.94</span>,<span class="number">14.61</span>,<span class="number">14.7</span>,<span class="number">12.81</span>,<span class="number">14.12</span>,<span class="number">13.37</span>)</div><div class="line">&gt; wilcox.test(raw_b,m=<span class="number">15</span>,alternative = <span class="string">"less"</span>)</div><div class="line"></div><div class="line">	Wilcoxon signed rank test</div><div class="line"></div><div class="line">data:  raw_b</div><div class="line">V = <span class="number">3</span>, p-value = <span class="number">0.001221</span></div><div class="line">alternative hypothesis: true location is less than <span class="number">15</span></div></pre></td></tr></table></figure>
<h4 id="案例c">案例C</h4>
<p>例8-2 已知某地正常人尿氟含量的中位数为45.30μmol/L 。今在该地某厂随机抽取12名工人，测得尿氟含量见表8-2第（1）栏。问该厂工人的尿氟含量是否高于当地正常人的尿氟含量？（《医学统计学》，第三版，孙振球，P134）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">data82 &lt;- c(44.21,45.30,46.39,49.47,51.05,53.16,53.26,54.37,57.16,67.37,71.05,87.37)</div><div class="line">wilcox.test(data82-45.30)</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">&gt; wilcox.test(data82-45.30)</div><div class="line"></div><div class="line">	Wilcoxon signed rank test with continuity correction</div><div class="line"></div><div class="line">data:  data82 - 45.3</div><div class="line">V = 65, p-value = 0.005099</div><div class="line">alternative hypothesis: true location is not equal to 0</div></pre></td></tr></table></figure>
<p>这个结果与书上有出入，书中提到，p值是小于0.005，则R的计算出来是0.005099，小于0.05，但SPSS的计算结果与R一致。</p>
<h2 id="两个独立样本wilcoxon检验mann-whitney-u检验">两个独立样本Wilcoxon检验（Mann-Whitney U检验）</h2>
<p>如果是比较两个正态总体均值，那么就是使用t检验（检验均值之差为<span class="math inline">\(\mu_{1}-\mu_{2}\)</span>），如果不知道两组数据是否服从哪种特定的总体分布，我们就要考虑比较两组数据的中位数大小，我们需要的唯一定义就是两个总体的分布有类似的形状，但不要求对称。这里介绍的检验的原理很简单，假定第一个样本有m个观测值<span class="math inline">\(x_{1},\cdots,x_{m}\)</span>，第二个有n个观测值，<span class="math inline">\(y_{1},\cdots,y_{n}\)</span>。把两个样本混合之后把这个m+n个观测值按照大小次序排序，然后记下每个观测值在混合排序下面的秩，之后分别把两个样本所得到的秩相加。记第一个样本观测值的秩的和为<span class="math inline">\(W_{x}\)</span>，而第二个样本秩的和为<span class="math inline">\(W_{Y}\)</span>。这两个值可以互相推算，称为Wilcoxon统计量。该统计量的分布和两个总体分布无关，，由此分布可以得到p值。直观上看，如果<span class="math inline">\(W_{x}\)</span>与<span class="math inline">\(W_{Y}\)</span>之中有一个显著地大（或显著地小），则可以选择拒绝零假设。这个检验注称为Wilcoxon秩和检验(Wilcoxon rank-sum test)，也称为Mann-Whitney检验或Mann-Whitney-Wilcoxon检验。之所以有两个名称，这是因为Wilcoxon统计量和由Mann-Whitney导出的检验统计量等价。Mann-Whitney统计量也是一对：<span class="math inline">\(W_{XY}\)</span>和<span class="math inline">\(W_{YX}\)</span>；定义为两个样本中满足<span class="math inline">\(x_{i}&gt;y_{i}\)</span>的数目，而<span class="math inline">\(W_{XY}\)</span>定义为两个样本中满足<span class="math inline">\(x_{i}&lt;y_{i}\)</span>的数目。检验时，一般使用<span class="math inline">\(W=min(W_{XY},W_{YX})\)</span>作为检验统计量。</p>
<p>案例A：（《医学统计学》，第三版，孙振球，P136）</p>
<p>对10例肺癌病人和12例矽肺0期工人用X光片测量肺门横径右侧距RD值（cm），结果如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">肺癌：2.78,3.23,4.2,4.87,5.12,6.21,7.18,8.05,8.56,9.6</div><div class="line">矽肺：3.23,3.5,4.04,4.15,4.28,4.34,4.47,4.64,4.75,4.82,4.95,5.1</div></pre></td></tr></table></figure>
<p>问肺癌病人的RD值是否高于矽肺0期工人的RD值？</p>
<p>思路：第一组数据的样本量为10，中位数是5.665，第二组数据的样本量为12，中位数是4.405，这两个中位数看上去有点差异，令这两组数据的总体中位数分别为<span class="math inline">\(M_{1}\)</span>和<span class="math inline">\(M_{2}\)</span>，现在进行检验，如下所示：</p>
<p><span class="math display">\[H_{0}:M_{1}=M_{2}\iff H_{1}:M_{1}&gt;M_{2}\]</span></p>
<p>计算过程如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">lc &lt;- c(2.78,3.23,4.2,4.87,5.12,6.21,7.18,8.05,8.56,9.6)</div><div class="line">si &lt;- c(3.23,3.5,4.04,4.15,4.28,4.34,4.47,4.64,4.75,4.82,4.95,5.1)</div><div class="line">wilcox.test(lc,si,correct=T)</div></pre></td></tr></table></figure>
<p>从结果中我们可以看到，p值等于0.04318，同时也得到中间结果<span class="math inline">\(W_{XY}=86.5\)</span>，因此哦可以说，对于大于p值的显著必不平都可以拒绝零假设，也就是说，这两组数据的中位数有显著性的差异。</p>
<h2 id="配对wilcoxon符号秩检验">配对Wilcoxon符号秩检验</h2>
<p>例8-1：对12份血清分别用原方法（检测时间20分钟）和新方法（检测时间10分钟）测谷-丙转氨酶，结果见表8-1的（2）、（3）栏。问两法所得结果有无差别？（《医学统计学》，第三版，孙振球，P132） <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">old &lt;- c(60,142,195,80,242,220,190,25,198,38,236,95)</div><div class="line">new &lt;- c(76,152,243,82,240,220,205,38,243,44,190,100)</div><div class="line">wilcox.test(old,new,paired = TRUE)</div></pre></td></tr></table></figure></p>
<p>结果如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">&gt; old &lt;- c(60,142,195,80,242,220,190,25,198,38,236,95)</div><div class="line">&gt; new &lt;- c(76,152,243,82,240,220,205,38,243,44,190,100)</div><div class="line">&gt; wilcox.test(old,new,paired = TRUE)</div><div class="line"></div><div class="line">	Wilcoxon signed rank test with continuity correction</div><div class="line"></div><div class="line">data:  old and new</div><div class="line">V = 11.5, p-value = 0.06175</div><div class="line">alternative hypothesis: true location shift is not equal to 0</div><div class="line"></div><div class="line">Warning messages:</div><div class="line">1: In wilcox.test.default(old, new, paired = TRUE) :</div><div class="line">  无法精確計算带连结的p值</div><div class="line">2: In wilcox.test.default(old, new, paired = TRUE) :</div><div class="line">  有0时无法計算精確的p值</div></pre></td></tr></table></figure>
<h2 id="有序的秩检验">有序的秩检验</h2>
<p>例8-4 39名吸烟工人和40名不吸烟工人的碳氧血红蛋白HbCO(%)含量见表8-6。问吸烟工人的HbCO(%)含量是否高于不吸烟工人的HbCO(%)含量？</p>
<h3 id="例8-4第1种方法wilcox.test检验">例8-4第1种方法：Wilcox.test检验：</h3>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">smoke &lt;- c(1,8,16,10,4)</div><div class="line">no.smoke &lt;-c(2,23,11,4,0)</div><div class="line">rank.c &lt;- c(1:5)</div><div class="line">group1 &lt;- rep(rank.c,smoke)</div><div class="line">group2 &lt;- rep(rank.c,no.smoke)</div><div class="line">data84 &lt;- c(group1,group2)</div><div class="line">group.f &lt;-factor(c(rep(1,length(group1)),rep(2,length(group2))))</div><div class="line">wilcox.test(data84~group.f)</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">&gt; wilcox.test(data84~group.f)</div><div class="line"></div><div class="line">        Wilcoxon rank sum test with continuity correction</div><div class="line"></div><div class="line">data:  data84 by group.f</div><div class="line">W = <span class="number">1137</span>, p-value = <span class="number">0.0002181</span></div><div class="line">alternative hypothesis: true location shift is not equal to <span class="number">0</span></div><div class="line"></div><div class="line">Warning message:</div><div class="line">In wilcox.test.default(x = c(<span class="number">1L</span>, <span class="number">2L</span>, <span class="number">2L</span>, <span class="number">2L</span>, <span class="number">2L</span>, <span class="number">2L</span>, <span class="number">2L</span>, <span class="number">2L</span>, <span class="number">2L</span>,  :</div><div class="line">  无法精確計算带连结的p值</div></pre></td></tr></table></figure>
<h3 id="例8-4第2种方法kruskal检验">例8-4第2种方法：Kruskal检验：</h3>
<p>Kurskal-Wallis检验是Wilcoxon方法（其实是Mann-Whitney检验）用于多于两个样本的时候的升级版。当对两个样本进行比较的时候，Kurskal-Wallis检验与Mann-Whitney检验是等价的。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">kruskal.test(data84~group.f)</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&gt; kruskal.test(data84~group.f)</div><div class="line"></div><div class="line">        Kruskal-Wallis rank sum test</div><div class="line"></div><div class="line">data:  data84 by group.f</div><div class="line">Kruskal-Wallis chi-squared = <span class="number">13.707</span>, df = <span class="number">1</span>, p-value = <span class="number">0.0002137</span></div></pre></td></tr></table></figure>
<h3 id="例8-4第2种方法ridit检验">例8-4第2种方法：Ridit检验:</h3>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">data84 &lt;- matrix(c(1,8,16,10,4,2,23,11,4,0),nrow=5)</div><div class="line">dimnames(data84) &lt;- list(cone=c(&quot;very low&quot;,&quot;low&quot;,&quot;median&quot;,&quot;a bit high&quot;,&quot;high&quot;),</div><div class="line">worker=c(&quot;smoker&quot;,&quot;no-smoker&quot;))</div><div class="line">if(!require(&quot;Ridit&quot;))&#123;</div><div class="line">  install.packages(&quot;Ridit&quot;)</div><div class="line">  library(Ridit)</div><div class="line">&#125;</div><div class="line">ridit(data84,2)</div><div class="line">chisq.test(data84)</div></pre></td></tr></table></figure>
<p>结果如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">&gt; ridit(data84,<span class="number">2</span>)</div><div class="line"></div><div class="line">Ridit Analysis:</div><div class="line"></div><div class="line">Group   Label           Mean Ridit</div><div class="line">-----   -----           ----------</div><div class="line"><span class="number">1</span>       smoker          <span class="number">0.6159</span></div><div class="line"><span class="number">2</span>       no-smoker       <span class="number">0.387</span></div><div class="line"></div><div class="line">Reference: Total of all groups </div><div class="line">chi-squared = <span class="number">13.707</span>, df = <span class="number">1</span>, p-value = <span class="number">0.0002137</span></div><div class="line"></div><div class="line">&gt; chisq.test(data84)</div><div class="line"></div><div class="line">        Pearson<span class="string">'s Chi-squared test</span></div><div class="line"><span class="string"></span></div><div class="line"><span class="string">data:  data84</span></div><div class="line"><span class="string">X-squared = 15.079, df = 4, p-value = 0.004541</span></div><div class="line"><span class="string"></span></div><div class="line"><span class="string">Warning message:</span></div><div class="line"><span class="string">In chisq.test(data84) : Chi-squared近似算法有可能不准</span></div></pre></td></tr></table></figure>
<h2 id="例8-5">例8-5</h2>
<p>用三种药物杀灭钉螺，每批用200只活钉螺，用药后清点每批钉螺的死亡数、再计算死亡率（%），结果见表8-9。问三种药物杀灭钉螺的效果有无差别？</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">drug &lt;-rep(c(&quot;甲药&quot;,&quot;乙药&quot;,&quot;丙药&quot;),each=5)</div><div class="line">data &lt;- c(32.5,35.5,40.5,46,49,16,20.5,22.5,29,36,6.5,9.0,12.5,18,24)</div><div class="line">data85 &lt;- data.frame(drug,data)</div><div class="line">kruskal.test(data85$data~data85$drug)</div></pre></td></tr></table></figure>
<h2 id="例8-6">例8-6</h2>
<p>比较小白鼠接种三种不同菌型伤寒杆菌9D、11C和DSC1后存活日数，结果见表8-10。问小白鼠接种三种不同菌型伤寒杆菌的存活日数有无差别？ <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">mice &lt;- as.factor(c(rep(&quot;9D&quot;,10),rep(&quot;11C&quot;,9),rep(&quot;DSC1&quot;,11)))</div><div class="line">data86 &lt;- c(2,2,2,3,4,4,4,5,7,7,5,5,6,6,6,7,8,10,12,3,5,6,6,6,7,7,9,10,11,11)</div><div class="line">data86 &lt;- data.frame(mice,data)</div><div class="line">kruskal.test(data86$data~data86$mice)</div></pre></td></tr></table></figure></p>
<h2 id="例8-7">例8-7</h2>
<p>四种疾病患者痰液内嗜酸性白细胞的检查结果见表8-11。问四种疾病患者痰液内的嗜酸性白细胞有无差别？注：这道例题与《医学统计学及SAS应用》（上海交通大学）的9.11类似 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">x1 &lt;- c(0,2,9,6)</div><div class="line">x2 &lt;- c(3,5,5,2)</div><div class="line">x3 &lt;- c(5,7,3,2)</div><div class="line">x4 &lt;- c(3,5,3,0)</div><div class="line"> </div><div class="line">freq &lt;- function(x)&#123;</div><div class="line">count &lt;-c()</div><div class="line">for(i in 1:4)&#123;</div><div class="line">count1 &lt;-c(rep(i,x[i]))</div><div class="line">count &lt;- append(count,count1)</div><div class="line">&#125;</div><div class="line">return(count)&#125;</div><div class="line">data87 &lt;-c(freq(x1),freq(x2),freq(x3),freq(x4))</div><div class="line">group &lt;- c(rep(1,sum(x1)),rep(2,sum(x2)),rep(3,sum(x3)),rep(4,sum(x4)))</div><div class="line">kruskal.test(data87~group)</div></pre></td></tr></table></figure></p>
<h2 id="例8-8">例8-8</h2>
<p>对例8-6资料（表8-10）作三个样本间的两两比较，Nemenyi检验。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"># 需要安装下列包：</div><div class="line">if(!require(&quot;pgirmess&quot;))&#123;</div><div class="line">  install.packages(&quot;pgirmess&quot;)</div><div class="line">  library(pgirmess)</div><div class="line">&#125;</div><div class="line">if(!require(&quot;coin&quot;))&#123;</div><div class="line">  install.packages(&quot;coin&quot;)</div><div class="line">  library(coin)</div><div class="line">&#125;</div><div class="line">if(!require(&quot;multcomp&quot;))&#123;</div><div class="line">  install.packages(&quot;multcomp&quot;)</div><div class="line">  library(multcomp)</div><div class="line">&#125;</div><div class="line"></div><div class="line">mice &lt;- as.factor(c(rep(&quot;9D&quot;,10),rep(&quot;11C&quot;,9),rep(&quot;DSC1&quot;,11)))</div><div class="line">data &lt;- c(2,2,2,3,4,4,4,5,7,7,5,5,6,6,6,7,8,10,12,3,5,6,6,6,7,7,9,10,11,11)</div><div class="line">data88 &lt;- data.frame(mice,data)</div><div class="line">kruskal.test(data~mice,data=data88)</div><div class="line">kruskalmc(data~mice, data=data88, probs=0.05) # 使用kruskalmc函数做两两比较，但此方法不能给出具体的值</div><div class="line"># 下面构建函数计算具体的p值</div><div class="line">mult &lt;- oneway_test(data ~ mice, data = data88,</div><div class="line">ytrafo = function(data) trafo(data, numeric_trafo = rank),</div><div class="line">xtrafo = function(data) trafo(data, factor_trafo = function(x)</div><div class="line">model.matrix(~x - 1) %*% t(contrMat(table(x), &quot;Tukey&quot;))),</div><div class="line">teststat = &quot;max&quot;, distribution = approximate(B = 90000)) </div><div class="line">pvalue(mult, method = &quot;single-step&quot;) #计算具体的p值</div></pre></td></tr></table></figure>
<h2 id="例8-9">例8-9</h2>
<p>8名受试对象在相同实验条件下分别接受4种不同频率声音的刺激，他们的反应率（%）资料见表8-12。问4种频率声音刺激的反应率是否有差别？ <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">freA &lt;- c(8.40,11.60,9.40,9.80,8.30,8.60,8.90,7.80)</div><div class="line">freB &lt;- c(9.60,12.70,9.10,8.70,8.00,9.80,9.00,8.20)</div><div class="line">freC &lt;- c(9.80,11.80,10.40,9.90,8.60,9.60,10.60,8.50)</div><div class="line">freD &lt;- c(11.70,12.00,9.80,12.00,8.60,10.60,11.40,10.80)</div><div class="line">matrix89 &lt;- matrix(c(freA,freB,freC,freD),nrow=8,dimnames=list(no=1:8,c(&quot;A&quot;,&quot;B&quot;,&quot;C&quot;,&quot;D&quot;)))</div><div class="line">friedman.test(matrix89)</div></pre></td></tr></table></figure></p>
<p>对两个以上样本进行比较的Kruskal-Wallis 秩和检验 kruskal.test() kruskal.test(formula, data, subset, na.action, …) 例子 为了比较属于同一类的四种不同食谱的营养效果，将25只老鼠随机的氛围4组，每组分别为8只，4只，7只和6只，采用食谱甲乙丙丁喂养，假设其他条件均值相同，12周后测得体重增加量如表所示，在alpha=0.05水平上，检验各食谱的营养效果是否有显著差异。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">food&lt;-data.frame(</div><div class="line">x=c(164, 190, 203, 205, 206, 214, 228, 257,</div><div class="line">185, 197, 201, 231,</div><div class="line">187, 212, 215, 220, 248, 265, 281,</div><div class="line">202, 204, 207, 227, 230, 276),</div><div class="line">g=factor(rep(1:4, c(8,4,7,6)))</div><div class="line">)</div><div class="line">kruskal.test(x~g, data=food)</div></pre></td></tr></table></figure>
<p>另一种写法 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">kruskal.test(food$x, food$g)</div></pre></td></tr></table></figure></p>
<p>或 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">A&lt;-c(164, 190, 203, 205, 206, 214, 228, 257)</div><div class="line">B&lt;-c(185, 197, 201, 231)</div><div class="line">C&lt;-c(187, 212, 215, 220, 248, 265, 281)</div><div class="line">D&lt;-c(202, 204, 207, 227, 230, 276)</div><div class="line">kruskal.test(list(A,B,C,D))</div></pre></td></tr></table></figure></p>
<p>　　利用R做Nemenyi的检验方法有人介绍过，SPSS里面没有现成的方法，需要编程，这里用R来做一下这个检验，原文是在丁香园引用的，参见<a href="http://www.dxy.cn/bbs/thread/26928446#26928446" target="_blank" rel="external">（R语言）秩和检验后两两比较方法之Nemenyi 检验及其他</a>这篇帖子。　　</p>
<p>原题：比较以下三组之间的数据，看有无差异<br>
第一组：293,409,392,213,409,57,97,244,254,352,168； 第二组：441,538,390,589,244,409,72,168,254,374 ； 第三组：807,833,409,914,380,883,254,993,667 ； 将上面三组数据录入data20140501，分两列，第一列为cd，第2列为group，存为csv格式。</p>
<p>源代码如下： <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">datanemenyi &lt;- read.csv(&quot;D:/Tutorial/20151219Statistics/data/rdata/data20140501.csv&quot;) #导入源数据文件  </div><div class="line">str(datanemenyi) #查看数据结构</div><div class="line">datanemenyi$group &lt;- as.factor(datanemenyi$group);datanemenyi #将group转化为因子类型  </div><div class="line">kruskal.test(cd~group, data=datanemenyi)  # Kruskal-Wallis检验，类似于参数检验的ANOVA检验  </div><div class="line"></div><div class="line">library(pgirmess)</div><div class="line">library(coin)  </div><div class="line">library(multcomp) # 安装并加载要用到的包  </div><div class="line">kruskalmc(cd~group, data=datanemenyi, probs=0.05) # 使用kruskalmc函数做两两比较，此法不能给出精确p值  </div><div class="line"></div><div class="line">mult &lt;- oneway_test(cd ~ group, data = datanemenyi,</div><div class="line">   ytrafo = function(data) trafo(data, numeric_trafo = rank),</div><div class="line">  xtrafo = function(data) trafo(data, factor_trafo = function(x)</div><div class="line">  model.matrix(~x - 1) %*% t(contrMat(table(x), &quot;Tukey&quot;))),</div><div class="line">  teststat = &quot;max&quot;, distribution = approximate(B = 90000))</div><div class="line"></div><div class="line">pvalue(mult, method = &quot;single-step&quot;)</div></pre></td></tr></table></figure></p>
<p>这个结果与原代码的运行结果不同</p>
<h2 id="参考资料">参考资料</h2>
<ol style="list-style-type: decimal">
<li>关于Nemenyi检验的方法是参照丁香园的，原贴地址如下，帖子的作者有把写过《医学统计学及SAS应用》之R语言实现这本电子书，下载地址如下:<a href="http://www.dxy.cn/bbs/thread/26928446#26928446" target="_blank" rel="external">Nemenyi检验方法</a></li>
<li><a href="http://d.dxy.cn/detail/6143147" target="_blank" rel="external">《医学统计学及SAS应用》之R语言实现</a></li>
</ol>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2018/06/22/StatQuest/生物统计-StatQuest学习笔记13-LDA/" rel="next" title="StatQuest学习笔记13——LDA">
                <i class="fa fa-chevron-left"></i> StatQuest学习笔记13——LDA
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2018/06/23/StatQuest/生物统计-StatQuest学习笔记14-PCA/" rel="prev" title="StatQuest学习笔记14——PCA">
                StatQuest学习笔记14——PCA <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  
    <div class="comments" id="comments">
      <div id="vcomments"></div>
    </div>
  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">RVDSD</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">200</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">11</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">85</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          <div class="links-of-author motion-element">
            
          </div>

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#前言"><span class="nav-number">1.</span> <span class="nav-text">前言</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#秩的概念"><span class="nav-number">2.</span> <span class="nav-text">秩的概念</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#非参数检验的原理"><span class="nav-number">3.</span> <span class="nav-text">非参数检验的原理</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#单样本的关于总体中位数的符号检验"><span class="nav-number">4.</span> <span class="nav-text">单样本的关于总体中位数的符号检验</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#单样本的关于对称总体中位数的wilcoxon符号秩检验"><span class="nav-number">5.</span> <span class="nav-text">单样本的关于对称总体中位数的Wilcoxon符号秩检验</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#wilcoxon符号秩检验原理"><span class="nav-number">5.1.</span> <span class="nav-text">Wilcoxon符号秩检验原理</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#r中的非参数检验函数"><span class="nav-number">6.</span> <span class="nav-text">R中的非参数检验函数</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#单个样本wilcoxon检验案例"><span class="nav-number">7.</span> <span class="nav-text">单个样本Wilcoxon检验案例</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#案例a"><span class="nav-number">7.0.1.</span> <span class="nav-text">案例A</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#案例b"><span class="nav-number">7.0.2.</span> <span class="nav-text">案例B</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#案例c"><span class="nav-number">7.0.3.</span> <span class="nav-text">案例C</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#两个独立样本wilcoxon检验mann-whitney-u检验"><span class="nav-number">8.</span> <span class="nav-text">两个独立样本Wilcoxon检验（Mann-Whitney U检验）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#配对wilcoxon符号秩检验"><span class="nav-number">9.</span> <span class="nav-text">配对Wilcoxon符号秩检验</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#有序的秩检验"><span class="nav-number">10.</span> <span class="nav-text">有序的秩检验</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#例8-4第1种方法wilcox.test检验"><span class="nav-number">10.1.</span> <span class="nav-text">例8-4第1种方法：Wilcox.test检验：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#例8-4第2种方法kruskal检验"><span class="nav-number">10.2.</span> <span class="nav-text">例8-4第2种方法：Kruskal检验：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#例8-4第2种方法ridit检验"><span class="nav-number">10.3.</span> <span class="nav-text">例8-4第2种方法：Ridit检验:</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#例8-5"><span class="nav-number">11.</span> <span class="nav-text">例8-5</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#例8-6"><span class="nav-number">12.</span> <span class="nav-text">例8-6</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#例8-7"><span class="nav-number">13.</span> <span class="nav-text">例8-7</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#例8-8"><span class="nav-number">14.</span> <span class="nav-text">例8-8</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#例8-9"><span class="nav-number">15.</span> <span class="nav-text">例8-9</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#参考资料"><span class="nav-number">16.</span> <span class="nav-text">参考资料</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

<div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">RVDSD</span>

  
</div>



<div class="powered-by">
<i class="fa fa-user-md"></i><span id="busuanzi_container_site_pv">
  本站访客数:<span id="busuanzi_value_site_uv"></span>
</span>
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>

<div class="BbeiAn-info">
	<a target="_blank" href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=41018102000118" style="color:#909090;text-decoration:none;padding-left:30px;no-repeat left center" rel="nofollow">豫公网安备 41018102000118</a>	  <!--这里将图标作为了背景，以使得能和后面的文字在同一行-->
</div>

  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.3</div>




<div class="theme-info">
  <div class="powered-by"></div>
  <span class="post-count">博客全站共787.8k字</span>
</div>

        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.3"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.3"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.3"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.3"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.3"></script>



  


  




	





  





  












  





  

  

  
  

  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config("");
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="custom_mathjax_source">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->
  


  

  

</body>
</html>
