<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.3" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.3">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.3" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta name="description" content="设计矩阵 在统计学中，一个设计矩阵(design matrix)也被称为模型矩阵(model matrix)或回归矩阵(regressor matrix)，它是一系列解释变量(explanatory variable)值的矩阵，通常命名为X。每行代表一个独立的观测对象，每列代表这个对象相应的变量。一些统计模型中常常会用到设计矩阵，例如广义线性模型(generalized linear model">
<meta property="og:type" content="article">
<meta property="og:title" content="设计矩阵的理解">
<meta property="og:url" content="http://rvdsd.top/2018/09/09/BioStatistics/线性模型/index.html">
<meta property="og:site_name" content="RVDSD的个人笔记本">
<meta property="og:description" content="设计矩阵 在统计学中，一个设计矩阵(design matrix)也被称为模型矩阵(model matrix)或回归矩阵(regressor matrix)，它是一系列解释变量(explanatory variable)值的矩阵，通常命名为X。每行代表一个独立的观测对象，每列代表这个对象相应的变量。一些统计模型中常常会用到设计矩阵，例如广义线性模型(generalized linear model">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="http://ortxpw68f.bkt.clouddn.com/professional/180909/6Ae2G3AdLB.png?imageslim">
<meta property="og:image" content="http://ortxpw68f.bkt.clouddn.com/professional/180909/j2I501aamE.png?imageslim">
<meta property="og:image" content="http://ortxpw68f.bkt.clouddn.com/professional/180909/IA6Hd3fBm1.png?imageslim">
<meta property="og:image" content="http://ortxpw68f.bkt.clouddn.com/professional/180909/HbamFJIE54.png?imageslim">
<meta property="og:image" content="http://ortxpw68f.bkt.clouddn.com/professional/180909/1D44JDKkjj.png?imageslim">
<meta property="og:image" content="http://ortxpw68f.bkt.clouddn.com/professional/180909/K8iedgDHfg.png?imageslim">
<meta property="og:image" content="http://ortxpw68f.bkt.clouddn.com/professional/180909/BB8eCjIlh6.png?imageslim">
<meta property="og:image" content="http://ortxpw68f.bkt.clouddn.com/professional/180909/GL9L4ehl78.png?imageslim">
<meta property="og:updated_time" content="2018-09-09T08:08:07.020Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="设计矩阵的理解">
<meta name="twitter:description" content="设计矩阵 在统计学中，一个设计矩阵(design matrix)也被称为模型矩阵(model matrix)或回归矩阵(regressor matrix)，它是一系列解释变量(explanatory variable)值的矩阵，通常命名为X。每行代表一个独立的观测对象，每列代表这个对象相应的变量。一些统计模型中常常会用到设计矩阵，例如广义线性模型(generalized linear model">
<meta name="twitter:image" content="http://ortxpw68f.bkt.clouddn.com/professional/180909/6Ae2G3AdLB.png?imageslim">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.3',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://rvdsd.top/2018/09/09/BioStatistics/线性模型/"/>





  <title>设计矩阵的理解 | RVDSD的个人笔记本</title><!-- hexo-inject:begin --><!-- hexo-inject:end -->
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">RVDSD的个人笔记本</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">学习过程中的输出</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://rvdsd.top/2018/09/09/BioStatistics/线性模型/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RVDSD">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="RVDSD的个人笔记本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">设计矩阵的理解</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-09-09T12:00:00+08:00">
                2018-09-09
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/生物统计/" itemprop="url" rel="index">
                    <span itemprop="name">生物统计</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  1,933
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  8
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h2 id="设计矩阵">设计矩阵</h2>
<p>在统计学中，一个设计矩阵(design matrix)也被称为模型矩阵(model matrix)或回归矩阵(regressor matrix)，它是一系列解释变量(explanatory variable)值的矩阵，通常命名为X。每行代表一个独立的观测对象，每列代表这个对象相应的变量。一些统计模型中常常会用到设计矩阵，例如广义线性模型(generalized linear models)。这种模型中通常会包含一些哑变量（例如0或1），这些哑变量用于区分不同的分组。设计矩阵的数据是一些解释变量的数据，解释变量用于解释应变量。</p>
<h2 id="设计矩阵举例">设计矩阵举例</h2>
<p>在一个设计矩阵<span class="math inline">\(X\)</span>中，<span class="math inline">\(X_{ij}\)</span>表示矩阵<span class="math inline">\(X\)</span>矩阵中第<span class="math inline">\(j\)</span>列，第<span class="math inline">\(i\)</span>行的一个变量值，在回归模型中，它可以写为<span class="math inline">\(y=X\beta\)</span>这样的形式，其中<span class="math inline">\(X\)</span>就是一个设计矩阵，<span class="math inline">\(\beta\)</span>就是一个模型系数的向量，而<span class="math inline">\(y\)</span>就是预测值的一个向量。我的理解就是，这个向量含有n值的组合，如果是简单线性回归，那么这个向量就是一个值，如果是多元线性回归，那么这个<span class="math inline">\(\beta\)</span>就是多个值组成一个向量，在此，多元线性回归与简单线性回归在本质上是一样的。</p>
<p>一个<span class="math inline">\(n \times p\)</span>的矩阵指的就是n个观测样本，p个变量（也可以理解为特征），如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">matrix(<span class="number">1</span>:<span class="number">12</span>,nrow=<span class="number">2</span>)</div><div class="line"><span class="comment"># [,1] [,2] [,3] [,4] [,5] [,6]</span></div><div class="line"><span class="comment"># [1,]    1    3    5    7    9   11</span></div><div class="line"><span class="comment"># [2,]    2    4    6    8   10   12</span></div></pre></td></tr></table></figure>
<p>在上面的这个矩阵里，n就是2，6就是p，这个矩阵就是<span class="math inline">\(2\times6\)</span>矩阵。而在统计学中，当用设计矩阵（我觉得这样命名，主要是因为这个矩阵是与实验设计有关的）来表示一个实验时，这个n值就是在一个实验中的不同的重复。而列则表示一个样本中要检测的不同变量。例如当我们进行一个问卷调查时，问了10个人4个问题，那么最终在处理数据时，用设计矩阵来表示就是<span class="math inline">\(10 \times 4\)</span>矩阵，这个10表示10个人，4表示4个问题，如果用i表示行（一共有10行），j表示列（一共有4列），那么这个矩阵中的某个值就可以看作是我问了第i个人的第j个问题。</p>
<p>再来看一个案例，这个案例是简单线性回归模型。在这个简单线性回归模型中，它的解释变量只有1个，也就是说，用设计矩阵来表示时，它只有1列，我们先假设它有7行，也就是i=7，用公式来表示这个简单线性模型就是下面的这个样子：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180909/6Ae2G3AdLB.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>其中<span class="math inline">\(\beta_{0}\)</span>表示上面这个方程在y轴上的截矩，而<span class="math inline">\(\beta_{1}\)</span>表示斜率，上面的这个方程用设计矩阵来表示就是下面的这个样子：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180909/j2I501aamE.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>再来看一个多元线性回归的案例，它有两个协变量，分别为w和x，假设我们有7个观测值，用方程来表示这个多元线性回归就是如下所示：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180909/IA6Hd3fBm1.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>用设计矩阵来表示就是下面的这个样子：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180909/HbamFJIE54.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>这个矩阵就是一个<span class="math inline">\(7\times 3\)</span>矩阵。</p>
<p>来看one-way ANOVA的案例。在这个案例中，我们有3个实验组，7个观测值。其中前3个观测值属于1组，第4和第5这两个观测值属于1组，第6和第7这两个观测值属于一组，那么这个模型可以写为下面的公式：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180909/1D44JDKkjj.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>用设计矩阵来表示就是下面的这个样子：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180909/K8iedgDHfg.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>其中<span class="math inline">\(\mu_{i}\)</span>表示第<span class="math inline">\(i\)</span>组的均值。</p>
<p>ANOVA模型通常可以写为每组的参数<span class="math inline">\(\tau_{i}\)</span>与某些参考值的差值。通常这个参考值指提某个组的组。这样在多组进行比较时，例如多个实验组与一个对照组比较时就比较方便。在下面的案例中，我们选择group 1作为参考组，那么上面的这个公式就可以写为下面的这个样子：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180909/BB8eCjIlh6.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>如果写为设计矩阵，就是下面的这个样子：</p>
<div class="figure">
<img src="http://ortxpw68f.bkt.clouddn.com/professional/180909/GL9L4ehl78.png?imageslim" alt="mark">
<p class="caption">mark</p>
</div>
<p>在这个模型中，<span class="math inline">\(\mu\)</span>是参考组的均值，而<span class="math inline">\(\tau_{i}\)</span>则是group i与参考组的差值，上面的矩阵中不含有<span class="math inline">\(\tau_{1}\)</span>是因为它与参考组的差值为0。</p>
<p>当我们使用R中的<code>lm</code>或<code>aov</code>或<code>glm</code>来进行线性描述时，就需要从<code>formula</code>和<code>data</code>参数中来创建一个模型矩阵。</p>
<p>看一个R中的简单线性回归的矩阵，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div></pre></td><td class="code"><pre><div class="line">Formaldehyde</div><div class="line"><span class="comment"># carb optden</span></div><div class="line"><span class="comment"># 1  0.1  0.086</span></div><div class="line"><span class="comment"># 2  0.3  0.269</span></div><div class="line"><span class="comment"># 3  0.5  0.446</span></div><div class="line"><span class="comment"># 4  0.6  0.538</span></div><div class="line"><span class="comment"># 5  0.7  0.626</span></div><div class="line"><span class="comment"># 6  0.9  0.782</span></div><div class="line"></div><div class="line"></div><div class="line">summary(fm1 &lt;- lm(optden ~ carb, Formaldehyde))</div><div class="line"><span class="comment"># </span></div><div class="line"><span class="comment"># Call:</span></div><div class="line"><span class="comment">#   lm(formula = optden ~ carb, data = Formaldehyde)</span></div><div class="line"><span class="comment"># </span></div><div class="line"><span class="comment"># Residuals:</span></div><div class="line"><span class="comment">#   1        2        3        4        5        6 </span></div><div class="line"><span class="comment"># -0.00671  0.00103  0.00277  0.00714  0.00751 -0.01174 </span></div><div class="line"><span class="comment"># </span></div><div class="line"><span class="comment"># Coefficients:</span></div><div class="line"><span class="comment">#   Estimate Std. Error t value Pr(&gt;|t|)    </span></div><div class="line"><span class="comment"># (Intercept)  0.00509    0.00783    0.65     0.55    </span></div><div class="line"><span class="comment"># carb         0.87629    0.01353   64.74  3.4e-07 ***</span></div><div class="line"><span class="comment">#   ---</span></div><div class="line"><span class="comment">#   Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span></div><div class="line"><span class="comment"># </span></div><div class="line"><span class="comment"># Residual standard error: 0.00865 on 4 degrees of freedom</span></div><div class="line"><span class="comment"># Multiple R-squared:  0.999,	Adjusted R-squared:  0.999 </span></div><div class="line"><span class="comment"># F-statistic: 4.19e+03 on 1 and 4 DF,  p-value: 3.41e-07</span></div><div class="line"></div><div class="line">model.matrix(fm1)</div><div class="line"><span class="comment"># (Intercept) carb</span></div><div class="line"><span class="comment"># 1           1  0.1</span></div><div class="line"><span class="comment"># 2           1  0.3</span></div><div class="line"><span class="comment"># 3           1  0.5</span></div><div class="line"><span class="comment"># 4           1  0.6</span></div><div class="line"><span class="comment"># 5           1  0.7</span></div><div class="line"><span class="comment"># 6           1  0.9</span></div><div class="line"><span class="comment"># attr(,"assign")</span></div><div class="line"><span class="comment"># [1] 0 1</span></div></pre></td></tr></table></figure>
<p>我们还可以从一个<code>formula</code>和<code>data</code>中直接创建一个模型矩阵，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">model.matrix(~ carb, Formaldehyde)</div><div class="line"><span class="comment"># (Intercept) carb</span></div><div class="line"><span class="comment"># 1           1  0.1</span></div><div class="line"><span class="comment"># 2           1  0.3</span></div><div class="line"><span class="comment"># 3           1  0.5</span></div><div class="line"><span class="comment"># 4           1  0.6</span></div><div class="line"><span class="comment"># 5           1  0.7</span></div><div class="line"><span class="comment"># 6           1  0.9</span></div><div class="line"><span class="comment"># attr(,"assign")</span></div><div class="line"><span class="comment"># [1] 0 1</span></div></pre></td></tr></table></figure>
<p>在上面的这个公式中，<code>~</code>只有右边的变量，没有左边的变量，因为我们并不需要应变量来研究模型矩阵。双边公式(a two-sided formula)也可以写为单边公式，</p>
<p>再看一个单因素方差分析模型，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">test_aov &lt;- aov(iris$Sepal.Length~iris$Species)</div><div class="line">model.matrix(test_aov)</div><div class="line"><span class="comment"># (Intercept) iris$Speciesversicolor iris$Speciesvirginica</span></div><div class="line"><span class="comment"># 1             1                      0                     0</span></div><div class="line"><span class="comment"># 2             1                      0                     0</span></div><div class="line"><span class="comment"># ....</span></div><div class="line"><span class="comment"># 69            1                      1                     0</span></div><div class="line"><span class="comment"># 70            1                      1                     0</span></div><div class="line"><span class="comment"># 71            1                      1                     0</span></div><div class="line"><span class="comment"># 72 ...</span></div><div class="line"><span class="comment"># 110           1                      0                     1</span></div><div class="line"><span class="comment"># 111           1                      0                     1</span></div><div class="line"><span class="comment"># 112           1                      0                     1</span></div><div class="line"><span class="comment"># 113           1                      0                     1</span></div><div class="line"><span class="comment"># ...</span></div><div class="line"><span class="comment"># attr(,"assign")</span></div><div class="line"><span class="comment"># [1] 0 1 1</span></div><div class="line"><span class="comment"># attr(,"contrasts")</span></div><div class="line"><span class="comment"># attr(,"contrasts")$`iris$Species`</span></div><div class="line"><span class="comment"># [1] "contr.treatment"</span></div></pre></td></tr></table></figure>
<h2 id="线性回归的截矩">线性回归的截矩</h2>
<p>在R中，formula是一个符号表达式对象，它表示的一个或多个自变量（右边）与应变量（左边）的关系，在经典回归或ANOVA中，<code>lm()</code>函数能够闺怨一个formula对象转化为一个设计矩阵X和一个系数向量B，然后通过一定的统计学方法得到向量B的最佳估计。通常公式中的每项都会被转换为X上的一个或多个列。而<code>model.matrix()</code>函数则能将参数转换为设计矩阵X。看一个案例，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Fuel ~ Weight + Displacement</div></pre></td></tr></table></figure>
<p>其中<code>Fuel</code>是一个应变量，<code>Weight</code>和<code>Displacement</code>是自变量。这个公式的拟合过程就是找到下面统计模型的参数，如下所示：</p>
<p><span class="math inline">\(Fuel = \alpha + \beta_{1}Weight + \beta_{2}Displacement + \epsilon\)</span></p>
<p>需要注意的是，这个公式并没有明确地包含α或ε，但是这个截矩在上面的公式中已经隐含了，如果我们添加了<code>1</code>，那么就明确表示截矩存在，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Fuel ~ <span class="number">1</span> + Weight + Displacement    </div><div class="line"><span class="comment">#  明确含有截矩这一项</span></div></pre></td></tr></table></figure>
<p>如果我们要拟合的线性模型中不含截矩，那么此时要添加上0，或者是<code>-1</code>，如下所示：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">Fuel ~ <span class="number">0</span> + Weight + Displacement      </div><div class="line"><span class="comment"># 0表示公式中明确不含截矩</span></div><div class="line">Fuel ~ -<span class="number">1</span> + Weight + Displacement    </div><div class="line"><span class="comment"># -1也有同样的效果</span></div></pre></td></tr></table></figure>
<h2 id="参考资料">参考资料</h2>
<ol style="list-style-type: decimal">
<li><a href="https://en.wikipedia.org/wiki/Design_matrix" target="_blank" rel="external">Design matrix</a></li>
<li><a href="https://science.nature.nps.gov/im/datamgmt/statistics/r/formulas/" target="_blank" rel="external">Statistical Formulas</a></li>
</ol>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2018/09/07/BioStatistics/生物统计-dnorm, pnorm, qnorm, and rnorm/" rel="next" title="dnorm, pnorm, qnorm与rnorm的区别">
                <i class="fa fa-chevron-left"></i> dnorm, pnorm, qnorm与rnorm的区别
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2018/09/12/Tools/MiRSEA包/" rel="prev" title="MiRSEA包">
                MiRSEA包 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  
    <div class="comments" id="comments">
      <div id="vcomments"></div>
    </div>
  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">RVDSD</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">143</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">13</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">38</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          <div class="links-of-author motion-element">
            
          </div>

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#设计矩阵"><span class="nav-number">1.</span> <span class="nav-text">设计矩阵</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#设计矩阵举例"><span class="nav-number">2.</span> <span class="nav-text">设计矩阵举例</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#线性回归的截矩"><span class="nav-number">3.</span> <span class="nav-text">线性回归的截矩</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#参考资料"><span class="nav-number">4.</span> <span class="nav-text">参考资料</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

<div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">RVDSD</span>

  
</div>



<div class="powered-by">
<i class="fa fa-user-md"></i><span id="busuanzi_container_site_pv">
  本站访客数:<span id="busuanzi_value_site_uv"></span>
</span>
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.3</div>




<div class="theme-info">
  <div class="powered-by"></div>
  <span class="post-count">博客全站共548.0k字</span>
</div>

        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.3"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.3"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.3"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.3"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.3"></script>



  


  




	





  





  












  





  

  

  
  

  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config("");
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="custom_mathjax_source">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->
  


  

  

</body>
</html>
